<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for SnapshotShardsServiceIT.java &amp; BlobTableAnalyzerTest.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for SnapshotShardsServiceIT.java &amp; BlobTableAnalyzerTest.java
      </h3>
<h1 align="center">
        34.3%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>SnapshotShardsServiceIT.java (59.74026%)<th>BlobTableAnalyzerTest.java (24.146982%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(20-43)<td><a href="#" name="0">(22-43)</a><td align="center"><font color="#ff0000">21</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(57-63)<td><a href="#" name="1">(94-101)</a><td align="center"><font color="#ce0000">17</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(111-115)<td><a href="#" name="2">(124-129)</a><td align="center"><font color="#910000">12</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(76-82)<td><a href="#" name="3">(106-111)</a><td align="center"><font color="#910000">12</font>
<tr onclick='openModal("#6cc417")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#6cc417"><font color="#6cc417">-</font><td><a href="#" name="4">(84-87)<td><a href="#" name="4">(174-176)</a><td align="center"><font color="#850000">11</font>
<tr onclick='openModal("#151b8d")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#151b8d"><font color="#151b8d">-</font><td><a href="#" name="5">(100-103)<td><a href="#" name="5">(133-138)</a><td align="center"><font color="#790000">10</font>
<tr onclick='openModal("#8c8774")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#8c8774"><font color="#8c8774">-</font><td><a href="#" name="6">(89-97)<td><a href="#" name="6">(218-220)</a><td align="center"><font color="#6d0000">9</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>SnapshotShardsServiceIT.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 /*
2  * Licensed to Elasticsearch under one or more contributor
3  * license agreements. See the NOTICE file distributed with
4  * this work for additional information regarding copyright
5  * ownership. Elasticsearch licenses this file to you under
6  * the Apache License, Version 2.0 (the "License"); you may
7  * not use this file except in compliance with the License.
8  * You may obtain a copy of the License at
9  *
10  *    http://www.apache.org/licenses/LICENSE-2.0
11  *
12  * Unless required by applicable law or agreed to in writing,
13  * software distributed under the License is distributed on an
14  * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
15  * KIND, either express or implied.  See the License for the
16  * specific language governing permissions and limitations
17 <a name="0"></a> * under the License.
18  */
19 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>package org.elasticsearch.snapshots;
20 import io.crate.common.unit.TimeValue;
21 import org.elasticsearch.common.settings.Settings;
22 import org.elasticsearch.common.unit.ByteSizeUnit;
23 import org.elasticsearch.index.snapshots.IndexShardSnapshotStatus;
24 import org.elasticsearch.plugins.Plugin;
25 import org.elasticsearch.snapshots.mockstore.MockRepository;
26 import org.elasticsearch.test.ESIntegTestCase;
27 import org.elasticsearch.test.disruption.NetworkDisruption;
28 import org.elasticsearch.test.transport.MockTransportService;
29 import java.util.ArrayList;
30 import java.util.Collection;
31 import java.util.List;
32 import java.util.concurrent.TimeUnit;
33 import java.util.stream.Collectors;
34 import static org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked;
35 import static org.hamcrest.Matchers.equalTo;
36 import static org.hamcrest.Matchers.everyItem;
37 import static org.hamcrest.Matchers.hasSize;
38 import static org.hamcrest.Matchers.is;
39 import</b></font> static org.hamcrest.Matchers.nullValue;
40 @ESIntegTestCase.ClusterScope(scope = ESIntegTestCase.Scope.TEST, numDataNodes = 0)
41 public class SnapshotShardsServiceIT extends AbstractSnapshotIntegTestCase {
42     @Override
43     protected Collection&lt;Class&lt;? extends Plugin&gt;&gt; nodePlugins() {
44         var plugins = new ArrayList&lt;&gt;(super.nodePlugins());
45         plugins.add(MockRepository.Plugin.class);
46         plugins.add(MockTransportService.TestPlugin.class);
47         return plugins;
48 <a name="1"></a>    }
49     public void testRetryPostingSnapshotStatusMessages() throws Exception {
50         String masterNode = <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>internalCluster().startMasterOnlyNode();
51         String dataNode = internalCluster().startDataOnlyNode();
52         logger.info("--&gt;  creating repository");
53         assertAcked(client().admin().cluster().preparePutRepository("repo")
54                         .setType("mock").setSettings(Settings.builder()
55                                                          .put("location", randomRepoPath</b></font>())
56                                                          .put("compress", randomBoolean())
57                                                          .put("chunk_size", randomIntBetween(100, 1000), ByteSizeUnit.BYTES)));
58         final int shards = between(1, 10);
59         execute("create table doc.test(x integer) clustered into ? shards with (number_of_replicas=0)", new Object[]{shards});
60         ensureGreen();
61         final int numDocs = scaledRandomIntBetween(50, 100);
62         for (int i = 0; i &lt; numDocs; i++) {
63 <a name="3"></a>            execute("insert into doc.test values(?)", new Object[]{i});
64         }
65         <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>logger.info("--&gt; blocking repository");
66         String blockedNode = blockNodeWithIndex("repo", "test");
67         dataNodeClient().admin().cluster().prepareCreateSnapshot("repo", "snapshot")
68             .setWaitForCompletion(false)
69             .setIndices("test")
70 <a name="4"></a>            .get();
71         waitForBlock(blockedNode, "repo", TimeValue.timeValueSeconds</b></font>(60));
72         <font color="#6cc417"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>final SnapshotId snapshotId = client().admin().cluster().prepareGetSnapshots("repo").setSnapshots("snapshot")
73             .get().getSnapshots().get(0).snapshotId();
74 <a name="6"></a>
75         logger.info</b></font>("--&gt; start disrupting cluster");
76         final NetworkDisruption networkDisruption = new NetworkDisruption(new NetworkDisruption.TwoPartitions(masterNode, dataNode),
77                                                                           NetworkDisruption.NetworkDelay.random(<font color="#8c8774"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>random()));
78         internalCluster().setDisruptionScheme(networkDisruption);
79         networkDisruption.startDisrupting();
80         logger.info("--&gt; unblocking repository");
81         unblockNode("repo", blockedNode);
82 <a name="5"></a>        SnapshotShardsService snapshotShardsService = internalCluster</b></font>().getInstance(SnapshotShardsService.class, blockedNode);
83         assertBusy(() -&gt; {
84             final Snapshot snapshot = new Snapshot("repo", snapshotId);
85             List&lt;IndexShardSnapshotStatus.Stage&gt; stages = <font color="#151b8d"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>snapshotShardsService.currentSnapshotShards(snapshot)
86                 .values().stream().map(status -&gt; status.asCopy().getStage()).collect(Collectors.toList());
87             assertThat(stages, hasSize(shards));
88             assertThat(stages, everyItem(equalTo</b></font>(IndexShardSnapshotStatus.Stage.DONE)));
89         }, 30L, TimeUnit.SECONDS);
90         logger.info("--&gt; stop disrupting cluster");
91         networkDisruption.stopDisrupting();
92 <a name="2"></a>        internalCluster().clearDisruptionScheme(true);
93         assertBusy(() -&gt; {
94             <font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>execute("select state, array_length(failures,0) from sys.snapshots where name='snapshot'");
95             assertThat(response.rowCount(), is(1L));
96             assertThat(response.rows()[0][0], is("SUCCESS"));
97             assertThat(response.rows()[0][1], is(nullValue()));
98         }</b></font>, 30L, TimeUnit.SECONDS);
99     }
100 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>BlobTableAnalyzerTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 /*
2  * Licensed to Crate.io GmbH ("Crate") under one or more contributor
3  * license agreements.  See the NOTICE file distributed with this work for
4  * additional information regarding copyright ownership.  Crate licenses
5  * this file to you under the Apache License, Version 2.0 (the "License");
6  * you may not use this file except in compliance with the License.  You may
7  * obtain a copy of the License at
8  *
9  *   http://www.apache.org/licenses/LICENSE-2.0
10  *
11  * Unless required by applicable law or agreed to in writing, software
12  * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
13  * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
14  * License for the specific language governing permissions and limitations
15  * under the License.
16  *
17  * However, if you have executed another commercial license agreement
18  * with Crate these terms will supersede the license and you may use the
19 <a name="0"></a> * software solely pursuant to the terms of the relevant commercial agreement.
20  */
21 <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>package io.crate.analyze;
22 import io.crate.blob.v2.BlobIndicesService;
23 import io.crate.data.Row;
24 import io.crate.data.RowN;
25 import io.crate.exceptions.InvalidRelationName;
26 import io.crate.exceptions.OperationOnInaccessibleRelationException;
27 import io.crate.exceptions.RelationAlreadyExists;
28 import io.crate.exceptions.RelationUnknown;
29 import io.crate.expression.symbol.Symbol;
30 import io.crate.metadata.blob.BlobSchemaInfo;
31 import io.crate.metadata.blob.BlobTableInfo;
32 import io.crate.planner.PlannerContext;
33 import io.crate.planner.node.ddl.CreateBlobTablePlan;
34 import io.crate.planner.operators.SubQueryResults;
35 import io.crate.sql.tree.AlterTable;
36 import io.crate.test.integration.CrateDummyClusterServiceUnitTest;
37 import io.crate.testing.SQLExecutor;
38 import org.elasticsearch.cluster.metadata.IndexMetadata;
39 import org.elasticsearch.common.settings.Settings;
40 import org.junit.Before;
41 import</b></font> org.junit.Test;
42 import java.io.IOException;
43 import java.util.function.Function;
44 import static io.crate.planner.node.ddl.AlterTablePlan.getTableParameter;
45 import static org.hamcrest.Matchers.is;
46 public class BlobTableAnalyzerTest extends CrateDummyClusterServiceUnitTest {
47     private static Function&lt;? super Symbol, Object&gt; EVAL = x -&gt; SymbolEvaluator.evaluate(
48         null,
49         null,
50         x,
51         Row.EMPTY,
52         SubQueryResults.EMPTY
53     );
54     private SQLExecutor e;
55     private PlannerContext plannerContext;
56     @Before
57     public void prepare() throws IOException {
58         e = SQLExecutor.builder(clusterService).addBlobTable("create blob table blobs").build();
59         plannerContext = e.getPlannerContext(clusterService.state());
60     }
61     private Settings buildSettings(AnalyzedCreateBlobTable blobTable, Object... arguments) {
62         return CreateBlobTablePlan.buildSettings(
63             blobTable.createBlobTable(),
64             plannerContext.transactionContext(),
65             plannerContext.nodeContext(),
66             new RowN(arguments),
67             SubQueryResults.EMPTY,
68             new NumberOfShards(clusterService));
69     }
70     @Test(expected = IllegalArgumentException.class)
71     public void testWithInvalidProperty() {
72         AnalyzedCreateBlobTable blobTable = e.analyze("create blob table screenshots with (foobar=1)");
73         buildSettings(blobTable);
74     }
75     @Test(expected = IllegalArgumentException.class)
76     public void testWithMultipleArgsToProperty() {
77         AnalyzedCreateBlobTable blobTable = e.analyze("create blob table screenshots with (number_of_replicas=[1, 2])");
78         buildSettings(blobTable);
79     }
80 <a name="1"></a>
81     @Test
82     public void testCreateBlobTableAutoExpand() {
83         AnalyzedCreateBlobTable analysis = <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>e.analyze(
84             "create blob table screenshots clustered into 10 shards with (number_of_replicas='0-all')");
85         Settings settings = buildSettings(analysis);
86         assertThat(analysis.relationName().name(), is("screenshots"));
87         assertThat(analysis.relationName().schema(), is(BlobSchemaInfo.NAME));
88         assertThat(settings.getAsInt(IndexMetadata.SETTING_NUMBER_OF_SHARDS, 0), is(10));
89         assertThat(settings.get(IndexMetadata.SETTING_AUTO_EXPAND_REPLICAS), is</b></font>("0-all"));
90     }
91 <a name="3"></a>
92     @Test
93     public void testCreateBlobTableDefaultNumberOfShards() {
94         AnalyzedCreateBlobTable analysis = <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>e.analyze("create blob table screenshots");
95         Settings settings = buildSettings(analysis);
96         assertThat(analysis.relationName().name(), is("screenshots"));
97         assertThat(analysis.relationName().schema(), is(BlobSchemaInfo.NAME));
98         assertThat</b></font>(settings.getAsInt(IndexMetadata.SETTING_NUMBER_OF_SHARDS, 0), is(4));
99     }
100     @Test
101     public void testCreateBlobTableRaisesErrorIfAlreadyExists() {
102         expectedException.expect(RelationAlreadyExists.class);
103         e.analyze("create blob table blobs");
104     }
105     @Test
106 <a name="2"></a>    public void testCreateBlobTable() {
107         AnalyzedCreateBlobTable analysis = e.analyze(
108             "create blob table screenshots clustered into 10 shards with (number_of_replicas='0-all')");
109         Settings settings = <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>buildSettings(analysis);
110         assertThat(analysis.relationName().name(), is("screenshots"));
111         assertThat(settings.getAsInt(IndexMetadata.SETTING_NUMBER_OF_SHARDS, 0), is(10));
112         assertThat(settings.get(IndexMetadata.SETTING_AUTO_EXPAND_REPLICAS), is("0-all"));
113     }</b></font>
114 <a name="5"></a>
115     @Test
116     public void testCreateBlobTableWithPath() {
117         AnalyzedCreateBlobTable analysis = <font color="#151b8d"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>e.analyze(
118             "create blob table screenshots with (blobs_path='/tmp/crate_blob_data')");
119         Settings settings = buildSettings(analysis);
120         assertThat(analysis.relationName().name(), is("screenshots"));
121         assertThat(settings.get(BlobIndicesService.SETTING_INDEX_BLOBS_PATH.getKey</b></font>()),
122             is("/tmp/crate_blob_data"));
123     }
124     @Test
125     public void testCreateBlobTableWithPathParameter() {
126         AnalyzedCreateBlobTable analysis = e.analyze(
127             "create blob table screenshots with (blobs_path=?)");
128         Settings settings = buildSettings(analysis, "/tmp/crate_blob_data");
129         assertThat(analysis.relationName().name(), is("screenshots"));
130         assertThat(settings.get(BlobIndicesService.SETTING_INDEX_BLOBS_PATH.getKey()),
131             is("/tmp/crate_blob_data"));
132     }
133     @Test
134     public void testCreateBlobTableWithPathInvalidType() {
135         expectedException.expect(IllegalArgumentException.class);
136         expectedException.expectMessage("Invalid value for argument 'blobs_path'");
137         buildSettings(e.analyze("create blob table screenshots with (blobs_path=1)"));
138     }
139     @Test
140     public void testCreateBlobTableWithPathInvalidParameter() {
141         expectedException.expect(IllegalArgumentException.class);
142         expectedException.expectMessage("Invalid value for argument 'blobs_path'");
143         buildSettings(e.analyze("create blob table screenshots with (blobs_path=?)"), 1);
144     }
145     @Test(expected = InvalidRelationName.class)
146     public void testCreateBlobTableIllegalTableName() {
147         e.analyze("create blob table \"blob.s\"");
148     }
149 <a name="4"></a>
150     @Test
151     public void testDropBlobTable() {
152         <font color="#6cc417"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>AnalyzedDropTable&lt;BlobTableInfo&gt; analysis = e.analyze("drop blob table blobs");
153         assertThat(analysis.table().ident().name(), is("blobs"));
154         assertThat(analysis.table</b></font>().ident().schema(), is(BlobSchemaInfo.NAME));
155     }
156     @Test
157     public void testDropBlobTableWithInvalidSchema() {
158         expectedException.expectMessage("No blob tables in schema `doc`");
159         e.analyze("drop blob table doc.users");
160     }
161     @Test
162     public void testDropBlobTableWithValidSchema() {
163         AnalyzedDropTable&lt;BlobTableInfo&gt; analysis = e.analyze("drop blob table \"blob\".blobs");
164         assertThat(analysis.table().ident().name(), is("blobs"));
165     }
166     @Test(expected = RelationUnknown.class)
167     public void testDropBlobTableThatDoesNotExist() {
168         e.analyze("drop blob table unknown");
169     }
170     @Test
171     public void testDropBlobTableIfExists() {
172         AnalyzedDropTable&lt;BlobTableInfo&gt; analysis = e.analyze("drop blob table if exists blobs");
173         assertThat(analysis.dropIfExists(), is(true));
174         assertThat(analysis.table().ident().fqn(), is("blob.blobs"));
175     }
176     @Test
177     public void testDropNonExistentBlobTableIfExists() {
178         AnalyzedDropTable&lt;BlobTableInfo&gt; analysis = e.analyze("drop blob table if exists unknown");
179         assertThat(analysis.dropIfExists(), is(true));
180     }
181     @Test(expected = IllegalArgumentException.class)
182     public void testAlterBlobTableWithInvalidProperty() {
183         AnalyzedAlterBlobTable analysis = e.analyze("alter blob table blobs set (foobar='2')");
184         AlterTable&lt;Object&gt; alterTable = analysis.alterTable().map(EVAL);
185         getTableParameter(alterTable, TableParameters.ALTER_BLOB_TABLE_PARAMETERS);
186     }
187 <a name="6"></a>
188     @Test
189     public void testAlterBlobTableWithReplicas() {
190         AnalyzedAlterBlobTable analysis = <font color="#8c8774"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>e.analyze("alter blob table blobs set (number_of_replicas=2)");
191         assertThat(analysis.tableInfo().ident().name(), is("blobs"));
192         AlterTable&lt;Object&gt; alterTable = analysis.alterTable</b></font>().map(EVAL);
193         TableParameter parameter = getTableParameter(alterTable, TableParameters.ALTER_BLOB_TABLE_PARAMETERS);
194         assertThat(parameter.settings().getAsInt(IndexMetadata.SETTING_NUMBER_OF_REPLICAS, 0), is(2));
195     }
196     @Test
197     public void testAlterBlobTableWithPath() {
198         expectedException.expect(IllegalArgumentException.class);
199         expectedException.expectMessage("Invalid property \"blobs_path\" passed to [ALTER | CREATE] TABLE statement");
200         AnalyzedAlterBlobTable analysis = e.analyze("alter blob table blobs set (blobs_path=1)");
201         AlterTable&lt;Object&gt; alterTable = analysis.alterTable().map(EVAL);
202         getTableParameter(alterTable, TableParameters.ALTER_BLOB_TABLE_PARAMETERS);
203     }
204     @Test
205     public void testCreateBlobTableWithParams() {
206         AnalyzedCreateBlobTable analysis = e.analyze(
207             "create blob table screenshots clustered into ? shards with (number_of_replicas= ?)");
208         Settings settings = buildSettings(analysis, 2, "0-all");
209         assertThat(analysis.relationName().name(), is("screenshots"));
210         assertThat(analysis.relationName().schema(), is(BlobSchemaInfo.NAME));
211         assertThat(settings.getAsInt(IndexMetadata.SETTING_NUMBER_OF_SHARDS, 0), is(2));
212         assertThat(settings.get(IndexMetadata.SETTING_AUTO_EXPAND_REPLICAS), is("0-all"));
213     }
214     @Test
215     public void testCreateBlobTableWithInvalidShardsParam() {
216         expectedException.expect(IllegalArgumentException.class);
217         expectedException.expectMessage("invalid number 'foo'");
218         buildSettings(e.analyze("create blob table screenshots clustered into ? shards"), "foo");
219     }
220     @Test
221     public void testAlterBlobTableRename() {
222         expectedException.expect(OperationOnInaccessibleRelationException.class);
223         expectedException.expectMessage("The relation \"blob.blobs\" doesn't support or allow ALTER RENAME operations.");
224         e.analyze("alter blob table blobs rename to blobbier");
225     }
226     @Test
227     public void testAlterBlobTableRenameWithExplicitSchema() {
228         expectedException.expect(IllegalArgumentException.class);
229         expectedException.expectMessage("The Schema \"schema\" isn't valid in a [CREATE | ALTER] BLOB TABLE clause");
230         e.analyze("alter blob table schema.blobs rename to blobbier");
231     }
232     @Test
233     public void testAlterBlobTableOpenClose() {
234         expectedException.expect(OperationOnInaccessibleRelationException.class);
235         expectedException.expectMessage("The relation \"blob.blobs\" doesn't support or allow ALTER OPEN/CLOSE operations.");
236         e.analyze("alter blob table blobs close");
237     }
238     @Test
239     public void testAlterBlobTableOpenCloseWithExplicitSchema() {
240         expectedException.expect(IllegalArgumentException.class);
241         expectedException.expectMessage("The Schema \"schema\" isn't valid in a [CREATE | ALTER] BLOB TABLE clause");
242         e.analyze("alter blob table schema.blob close");
243     }
244 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
