
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 41.203400915631136%, Tokens: 10, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-SetCommandsTestBase.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.unified;
2  import static org.junit.Assert.assertArrayEquals;
3  import static org.junit.Assert.assertEquals;
4  import static org.junit.Assert.assertFalse;
5  import static org.junit.Assert.assertNull;
6  import static org.junit.Assert.assertTrue;
7  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START;
8  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START_BINARY;
9  import static redis.clients.jedis.util.AssertUtil.assertByteArrayCollectionContainsAll;
10  import static redis.clients.jedis.util.AssertUtil.assertByteArraySetEquals;
11  import static redis.clients.jedis.util.AssertUtil.assertCollectionContainsAll;
12  import static redis.clients.jedis.util.ByteArrayUtil.byteArrayCollectionRemoveAll;
13  import java.util.Arrays;
14  import java.util.Comparator;
15  import java.util.HashSet;
16  import java.util.List;
17  import java.util.Set;
18  import org.junit.Test;
19  import redis.clients.jedis.params.ScanParams;
20  import redis.clients.jedis.resps.ScanResult;
21  public abstract class SetCommandsTestBase extends UnifiedJedisCommandsTestBase {
22    final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
23    final byte[] bbar = { 0x05, 0x06, 0x07, 0x08 };
24    final byte[] bcar = { 0x09, 0x0A, 0x0B, 0x0C };
25    final byte[] ba = { 0x0A };
26    final byte[] bb = { 0x0B };
27    final byte[] bc = { 0x0C };
28    final byte[] bd = { 0x0D };
29    final byte[] bx = { 0x42 };
30    final byte[] bbar1 = { 0x05, 0x06, 0x07, 0x08, 0x0A };
31    final byte[] bbar2 = { 0x05, 0x06, 0x07, 0x08, 0x0B };
32    final byte[] bbar3 = { 0x05, 0x06, 0x07, 0x08, 0x0C };
33    final byte[] bbarstar = { 0x05, 0x06, 0x07, 0x08, '*' };
34    @Test
35    public void sadd() {
36      long status = jedis.sadd("foo", "a");
37      assertEquals(1, status);
38      status = jedis.sadd("foo", "a");
39      assertEquals(0, status);
40      long bstatus = jedis.sadd(bfoo, ba);
41      assertEquals(1, bstatus);
42      bstatus = jedis.sadd(bfoo, ba);
43      assertEquals(0, bstatus);
44    }
45    @Test
46    public void smembers() {
47      jedis.sadd("foo", "a");
48      jedis.sadd("foo", "b");
49      Set<String> expected = new HashSet<String>();
50      expected.add("a");
51      expected.add("b");
52      Set<String> members = jedis.smembers("foo");
53      assertEquals(expected, members);
54      jedis.sadd(bfoo, ba);
55      jedis.sadd(bfoo, bb);
56      Set<byte[]> bexpected = new HashSet<byte[]>();
57      bexpected.add(bb);
58      bexpected.add(ba);
59      Set<byte[]> bmembers = jedis.smembers(bfoo);
60      assertByteArraySetEquals(bexpected, bmembers);
61    }
62    @Test
63    public void srem() {
64      jedis.sadd("foo", "a");
65      jedis.sadd("foo", "b");
66      long status = jedis.srem("foo", "a");
67      Set<String> expected = new HashSet<String>();
68      expected.add("b");
69      assertEquals(1, status);
70      assertEquals(expected, jedis.smembers("foo"));
71      status = jedis.srem("foo", "bar");
72      assertEquals(0, status);
73      jedis.sadd(bfoo, ba);
74      jedis.sadd(bfoo, bb);
75      long bstatus = jedis.srem(bfoo, ba);
76      Set<byte[]> bexpected = new HashSet<byte[]>();
77      bexpected.add(bb);
78      assertEquals(1, bstatus);
79      assertByteArraySetEquals(bexpected, jedis.smembers(bfoo));
80      bstatus = jedis.srem(bfoo, bbar);
81      assertEquals(0, bstatus);
82    }
83    @Test
84    public void spop() {
85      jedis.sadd("foo", "a");
86      jedis.sadd("foo", "b");
87      String member = jedis.spop("foo");
88      assertTrue("a".equals(member) || "b".equals(member));
89      assertEquals(1, jedis.smembers("foo").size());
90      member = jedis.spop("bar");
91      assertNull(member);
92      jedis.sadd(bfoo, ba);
93      jedis.sadd(bfoo, bb);
94      byte[] bmember = jedis.spop(bfoo);
95      assertTrue(Arrays.equals(ba, bmember) || Arrays.equals(bb, bmember));
96      assertEquals(1, jedis.smembers(bfoo).size());
97      bmember = jedis.spop(bbar);
98      assertNull(bmember);
99    }
100    @Test
101    public void spopWithCount() {
102      jedis.sadd("foo", "a");
103      jedis.sadd("foo", "b");
104      jedis.sadd("foo", "c");
105      Set<String> superSet = new HashSet<String>();
106      superSet.add("c");
107      superSet.add("b");
108      superSet.add("a");
109      Set<String> members = jedis.spop("foo", 2);
110      assertEquals(2, members.size());
111      assertCollectionContainsAll(superSet, members);
112      superSet.removeAll(members);
113      members = jedis.spop("foo", 2);
114      assertEquals(1, members.size());
115      assertEquals(superSet, members);
116      assertTrue(jedis.spop("foo", 2).isEmpty());
117      jedis.sadd(bfoo, ba);
118      jedis.sadd(bfoo, bb);
119      jedis.sadd(bfoo, bc);
120      Set<byte[]> bsuperSet = new HashSet<byte[]>();
121      bsuperSet.add(bc);
122      bsuperSet.add(bb);
123      bsuperSet.add(ba);
124      Set<byte[]> bmembers = jedis.spop(bfoo, 2);
125      assertEquals(2, bmembers.size());
126      assertByteArrayCollectionContainsAll(bsuperSet, bmembers);
127      byteArrayCollectionRemoveAll(bsuperSet, bmembers);
128      bmembers = jedis.spop(bfoo, 2);
129      assertEquals(1, bmembers.size());
130      assertByteArraySetEquals(bsuperSet, bmembers);
131      assertTrue(jedis.spop(bfoo, 2).isEmpty());
132    }
133    @Test
134    public void smove() {
135      jedis.sadd("foo", "a");
136      jedis.sadd("foo", "b");
137      jedis.sadd("bar", "c");
138      long status = jedis.smove("foo", "bar", "a");
139      Set<String> expectedSrc = new HashSet<String>();
140      expectedSrc.add("b");
141      Set<String> expectedDst = new HashSet<String>();
142      expectedDst.add("c");
143      expectedDst.add("a");
144      assertEquals(status, 1);
145      assertEquals(expectedSrc, jedis.smembers("foo"));
146      assertEquals(expectedDst, jedis.smembers("bar"));
147      status = jedis.smove("foo", "bar", "a");
148      assertEquals(status, 0);
149      jedis.sadd(bfoo, ba);
150      jedis.sadd(bfoo, bb);
151      jedis.sadd(bbar, bc);
152      long bstatus = jedis.smove(bfoo, bbar, ba);
153      Set<byte[]> bexpectedSrc = new HashSet<byte[]>();
154      bexpectedSrc.add(bb);
155      Set<byte[]> bexpectedDst = new HashSet<byte[]>();
156      bexpectedDst.add(bc);
157      bexpectedDst.add(ba);
158      assertEquals(bstatus, 1);
159      assertByteArraySetEquals(bexpectedSrc, jedis.smembers(bfoo));
160      assertByteArraySetEquals(bexpectedDst, jedis.smembers(bbar));
161      bstatus = jedis.smove(bfoo, bbar, ba);
162      assertEquals(bstatus, 0);
163    }
164    @Test
165    public void scard() {
166      jedis.sadd("foo", "a");
167      jedis.sadd("foo", "b");
168      long card = jedis.scard("foo");
169      assertEquals(2, card);
170      card = jedis.scard("bar");
171      assertEquals(0, card);
172      jedis.sadd(bfoo, ba);
173      jedis.sadd(bfoo, bb);
174      long bcard = jedis.scard(bfoo);
175      assertEquals(2, bcard);
176      bcard = jedis.scard(bbar);
177      assertEquals(0, bcard);
178    }
179    @Test
180    public void sismember() {
181      jedis.sadd("foo", "a");
182      jedis.sadd("foo", "b");
183      assertTrue(jedis.sismember("foo", "a"));
184      assertFalse(jedis.sismember("foo", "c"));
185      jedis.sadd(bfoo, ba);
186      jedis.sadd(bfoo, bb);
187      assertTrue(jedis.sismember(bfoo, ba));
188      assertFalse(jedis.sismember(bfoo, bc));
189    }
190    @Test
191    public void smismember() {
192      jedis.sadd("foo", "a", "b");
193      assertEquals(Arrays.asList(true, false), jedis.smismember("foo", "a", "c"));
194      jedis.sadd(bfoo, ba, bb);
195      assertEquals(Arrays.asList(true, false), jedis.smismember(bfoo, ba, bc));
196    }
197    @Test
198    public void sinter() {
199      jedis.sadd("foo", "a");
200      jedis.sadd("foo", "b");
201      jedis.sadd("bar", "b");
202      jedis.sadd("bar", "c");
203      Set<String> expected = new HashSet<String>();
204      expected.add("b");
205      Set<String> intersection = jedis.sinter("foo", "bar");
206      assertEquals(expected, intersection);
207      jedis.sadd(bfoo, ba);
208      jedis.sadd(bfoo, bb);
209      jedis.sadd(bbar, bb);
210      jedis.sadd(bbar, bc);
211      Set<byte[]> bexpected = new HashSet<byte[]>();
212      bexpected.add(bb);
213      Set<byte[]> bintersection = jedis.sinter(bfoo, bbar);
214      assertByteArraySetEquals(bexpected, bintersection);
215    }
216    @Test
217    public void sinterstore() {
218      jedis.sadd("foo", "a");
219      jedis.sadd("foo", "b");
220      jedis.sadd("bar", "b");
221      jedis.sadd("bar", "c");
222      Set<String> expected = new HashSet<String>();
223      expected.add("b");
224      long status = jedis.sinterstore("car", "foo", "bar");
225      assertEquals(1, status);
226      assertEquals(expected, jedis.smembers("car"));
227      jedis.sadd(bfoo, ba);
228      jedis.sadd(bfoo, bb);
229      jedis.sadd(bbar, bb);
230      jedis.sadd(bbar, bc);
231      Set<byte[]> bexpected = new HashSet<byte[]>();
232      bexpected.add(bb);
233      long bstatus = jedis.sinterstore(bcar, bfoo, bbar);
234      assertEquals(1, bstatus);
235      assertByteArraySetEquals(bexpected, jedis.smembers(bcar));
236    }
237    @Test
238    public void sintercard() {
239      jedis.sadd("foo", "a");
240      jedis.sadd("foo", "b");
241      jedis.sadd("bar", "a");
242      jedis.sadd("bar", "b");
243      jedis.sadd("bar", "c");
<span onclick='openModal()' class='match'>244      long card = jedis.sintercard("foo", "bar");
245      assertEquals(2, card);
246      long limitedCard = jedis.sintercard(1, "foo", "bar");
247      assertEquals(1, limitedCard);
248      jedis.sadd(bfoo, ba);
249      jedis.sadd(bfoo, bb);
250      jedis.sadd(bbar, ba);
251      jedis.sadd(bbar, bb);
252      jedis.sadd(bbar, bc);
</span>253      long bcard = jedis.sintercard(bfoo, bbar);
254      assertEquals(2, bcard);
255      long blimitedCard = jedis.sintercard(1, bfoo, bbar);
256      assertEquals(1, blimitedCard);
257    }
258    @Test
259    public void sunion() {
260      jedis.sadd("foo", "a");
261      jedis.sadd("foo", "b");
262      jedis.sadd("bar", "b");
263      jedis.sadd("bar", "c");
264      Set<String> expected = new HashSet<String>();
265      expected.add("a");
266      expected.add("b");
267      expected.add("c");
268      Set<String> union = jedis.sunion("foo", "bar");
269      assertEquals(expected, union);
270      jedis.sadd(bfoo, ba);
271      jedis.sadd(bfoo, bb);
272      jedis.sadd(bbar, bb);
273      jedis.sadd(bbar, bc);
274      Set<byte[]> bexpected = new HashSet<byte[]>();
275      bexpected.add(bb);
276      bexpected.add(bc);
277      bexpected.add(ba);
278      Set<byte[]> bunion = jedis.sunion(bfoo, bbar);
279      assertByteArraySetEquals(bexpected, bunion);
280    }
281    @Test
282    public void sunionstore() {
283      jedis.sadd("foo", "a");
284      jedis.sadd("foo", "b");
285      jedis.sadd("bar", "b");
286      jedis.sadd("bar", "c");
287      Set<String> expected = new HashSet<String>();
288      expected.add("a");
289      expected.add("b");
290      expected.add("c");
291      long status = jedis.sunionstore("car", "foo", "bar");
292      assertEquals(3, status);
293      assertEquals(expected, jedis.smembers("car"));
294      jedis.sadd(bfoo, ba);
295      jedis.sadd(bfoo, bb);
296      jedis.sadd(bbar, bb);
297      jedis.sadd(bbar, bc);
298      Set<byte[]> bexpected = new HashSet<byte[]>();
299      bexpected.add(bb);
300      bexpected.add(bc);
301      bexpected.add(ba);
302      long bstatus = jedis.sunionstore(bcar, bfoo, bbar);
303      assertEquals(3, bstatus);
304      assertByteArraySetEquals(bexpected, jedis.smembers(bcar));
305    }
306    @Test
307    public void sdiff() {
308      jedis.sadd("foo", "x");
309      jedis.sadd("foo", "a");
310      jedis.sadd("foo", "b");
311      jedis.sadd("foo", "c");
312      jedis.sadd("bar", "c");
313      jedis.sadd("car", "a");
314      jedis.sadd("car", "d");
315      Set<String> expected = new HashSet<String>();
316      expected.add("x");
317      expected.add("b");
318      Set<String> diff = jedis.sdiff("foo", "bar", "car");
319      assertEquals(expected, diff);
320      jedis.sadd(bfoo, bx);
321      jedis.sadd(bfoo, ba);
322      jedis.sadd(bfoo, bb);
323      jedis.sadd(bfoo, bc);
324      jedis.sadd(bbar, bc);
325      jedis.sadd(bcar, ba);
326      jedis.sadd(bcar, bd);
327      Set<byte[]> bexpected = new HashSet<byte[]>();
328      bexpected.add(bb);
329      bexpected.add(bx);
330      Set<byte[]> bdiff = jedis.sdiff(bfoo, bbar, bcar);
331      assertByteArraySetEquals(bexpected, bdiff);
332    }
333    @Test
334    public void sdiffstore() {
335      jedis.sadd("foo", "x");
336      jedis.sadd("foo", "a");
337      jedis.sadd("foo", "b");
338      jedis.sadd("foo", "c");
339      jedis.sadd("bar", "c");
340      jedis.sadd("car", "a");
341      jedis.sadd("car", "d");
342      Set<String> expected = new HashSet<String>();
343      expected.add("x");
344      expected.add("b");
345      long status = jedis.sdiffstore("tar", "foo", "bar", "car");
346      assertEquals(2, status);
347      assertEquals(expected, jedis.smembers("tar"));
348      jedis.sadd(bfoo, bx);
349      jedis.sadd(bfoo, ba);
350      jedis.sadd(bfoo, bb);
351      jedis.sadd(bfoo, bc);
352      jedis.sadd(bbar, bc);
353      jedis.sadd(bcar, ba);
354      jedis.sadd(bcar, bd);
355      Set<byte[]> bexpected = new HashSet<byte[]>();
356      bexpected.add(bx);
357      bexpected.add(bb);
358      long bstatus = jedis.sdiffstore("tar".getBytes(), bfoo, bbar, bcar);
359      assertEquals(2, bstatus);
360      assertByteArraySetEquals(bexpected, jedis.smembers("tar".getBytes()));
361    }
362    @Test
363    public void srandmember() {
364      jedis.sadd("foo", "a");
365      jedis.sadd("foo", "b");
366      String member = jedis.srandmember("foo");
367      assertTrue("a".equals(member) || "b".equals(member));
368      assertEquals(2, jedis.smembers("foo").size());
369      List<String> members = jedis.srandmember("foo", 2);
370      members.sort(Comparator.naturalOrder());
371      assertEquals( Arrays.asList("a", "b"), members);
372      member = jedis.srandmember("bar");
373      assertNull(member);
374      members = jedis.srandmember("bar", 2);
375      assertEquals(0, members.size());
376      jedis.sadd(bfoo, ba);
377      jedis.sadd(bfoo, bb);
378      byte[] bmember = jedis.srandmember(bfoo);
379      assertTrue(Arrays.equals(ba, bmember) || Arrays.equals(bb, bmember));
380      assertEquals(2, jedis.smembers(bfoo).size());
381      List<byte[]> bmembers = jedis.srandmember(bfoo, 2);
382      assertEquals(2, bmembers.size());
383      bmember = jedis.srandmember(bbar);
384      assertNull(bmember);
385      members = jedis.srandmember("bbar", 2);
386      assertEquals(0, members.size());
387    }
388    @Test
389    public void sscan() {
390      jedis.sadd("foo", "a", "b");
391      ScanResult<String> result = jedis.sscan("foo", SCAN_POINTER_START);
392      assertEquals(SCAN_POINTER_START, result.getCursor());
393      assertFalse(result.getResult().isEmpty());
394      jedis.sadd(bfoo, ba, bb);
395      ScanResult<byte[]> bResult = jedis.sscan(bfoo, SCAN_POINTER_START_BINARY);
396      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
397      assertFalse(bResult.getResult().isEmpty());
398    }
399    @Test
400    public void sscanMatch() {
401      ScanParams params = new ScanParams();
402      params.match("a*");
403      jedis.sadd("foo", "b", "a", "aa");
404      ScanResult<String> result = jedis.sscan("foo", SCAN_POINTER_START, params);
405      assertEquals(SCAN_POINTER_START, result.getCursor());
406      assertFalse(result.getResult().isEmpty());
407      params = new ScanParams();
408      params.match(bbarstar);
409      jedis.sadd(bfoo, bbar1, bbar2, bbar3);
410      ScanResult<byte[]> bResult = jedis.sscan(bfoo, SCAN_POINTER_START_BINARY, params);
411      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
412      assertFalse(bResult.getResult().isEmpty());
413    }
414    @Test
415    public void sscanCount() {
416      ScanParams params = new ScanParams();
417      params.count(2);
418      jedis.sadd("foo", "a1", "a2", "a3", "a4", "a5");
419      ScanResult<String> result = jedis.sscan("foo", SCAN_POINTER_START, params);
420      assertFalse(result.getResult().isEmpty());
421      params = new ScanParams();
422      params.count(2);
423      jedis.sadd(bfoo, bbar1, bbar2, bbar3);
424      ScanResult<byte[]> bResult = jedis.sscan(bfoo, SCAN_POINTER_START_BINARY, params);
425      assertFalse(bResult.getResult().isEmpty());
426    }
427  }
</code></pre>
        </div>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-GeoCommandsTestBase.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.unified;
2  import static org.junit.Assert.*;
3  import static redis.clients.jedis.util.AssertUtil.assertByteArrayListEquals;
4  import java.util.ArrayList;
5  import java.util.HashMap;
6  import java.util.List;
7  import java.util.Map;
8  import org.junit.Test;
9  import redis.clients.jedis.GeoCoordinate;
10  import redis.clients.jedis.args.GeoUnit;
11  import redis.clients.jedis.params.GeoSearchParam;
12  import redis.clients.jedis.resps.GeoRadiusResponse;
13  import redis.clients.jedis.params.GeoAddParams;
14  import redis.clients.jedis.params.GeoRadiusParam;
15  import redis.clients.jedis.params.GeoRadiusStoreParam;
16  import redis.clients.jedis.util.SafeEncoder;
17  public abstract class GeoCommandsTestBase extends UnifiedJedisCommandsTestBase {
18    protected final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
19    protected final byte[] bA = { 0x0A };
20    protected final byte[] bB = { 0x0B };
21    protected final byte[] bC = { 0x0C };
22    protected final byte[] bD = { 0x0D };
23    protected final byte[] bNotexist = { 0x0F };
24    private static final double EPSILON = 1e-5;
25    @Test
26    public void geoadd() {
27      assertEquals(1, jedis.geoadd("foo", 1, 2, "a"));
28      assertEquals(0, jedis.geoadd("foo", 2, 3, "a"));
29      Map<String, GeoCoordinate> coordinateMap = new HashMap<>();
30      coordinateMap.put("a", new GeoCoordinate(3, 4));
31      coordinateMap.put("b", new GeoCoordinate(2, 3));
32      coordinateMap.put("c", new GeoCoordinate(3.314, 2.3241));
33      assertEquals(2, jedis.geoadd("foo", coordinateMap));
34      assertEquals(1, jedis.geoadd(bfoo, 1, 2, bA));
35      assertEquals(0, jedis.geoadd(bfoo, 2, 3, bA));
36      Map<byte[], GeoCoordinate> bcoordinateMap = new HashMap<>();
37      bcoordinateMap.put(bA, new GeoCoordinate(3, 4));
38      bcoordinateMap.put(bB, new GeoCoordinate(2, 3));
39      bcoordinateMap.put(bC, new GeoCoordinate(3.314, 2.3241));
40      assertEquals(2, jedis.geoadd(bfoo, bcoordinateMap));
41    }
42    @Test
43    public void geoaddWithParams() {
44      assertEquals(1, jedis.geoadd("foo", 1, 2, "a"));
45      Map<String, GeoCoordinate> coordinateMap = new HashMap<>();
46      coordinateMap.put("a", new GeoCoordinate(3, 4));
47      assertEquals(0, jedis.geoadd("foo", GeoAddParams.geoAddParams().nx(), coordinateMap));
48      assertEquals(1, jedis.geoadd("foo", GeoAddParams.geoAddParams().xx().ch(), coordinateMap));
49      coordinateMap.clear();
50      coordinateMap.put("b", new GeoCoordinate(6, 7));
51      assertEquals(0, jedis.geoadd("foo", GeoAddParams.geoAddParams().xx(), coordinateMap));
52      assertEquals(1, jedis.geoadd("foo", GeoAddParams.geoAddParams().nx(), coordinateMap));
53      assertEquals(1, jedis.geoadd(bfoo, 1, 2, bA));
54      Map<byte[], GeoCoordinate> bcoordinateMap = new HashMap<>();
55      bcoordinateMap.put(bA, new GeoCoordinate(3, 4));
56      assertEquals(0, jedis.geoadd(bfoo, GeoAddParams.geoAddParams().nx(), bcoordinateMap));
57      assertEquals(1, jedis.geoadd(bfoo, GeoAddParams.geoAddParams().xx().ch(), bcoordinateMap));
58      bcoordinateMap.clear();
59      bcoordinateMap.put(bB, new GeoCoordinate(6, 7));
60      assertEquals(0, jedis.geoadd(bfoo, GeoAddParams.geoAddParams().xx(), bcoordinateMap));
61      assertEquals(1, jedis.geoadd(bfoo, GeoAddParams.geoAddParams().nx(), bcoordinateMap));
62    }
63    @Test
64    public void geodist() {
65      prepareGeoData();
66      Double dist = jedis.geodist("foo", "a", "b");
67      assertEquals(157149, dist.intValue());
68      dist = jedis.geodist("foo", "a", "b", GeoUnit.KM);
69      assertEquals(157, dist.intValue());
70      dist = jedis.geodist("foo", "a", "b", GeoUnit.MI);
71      assertEquals(97, dist.intValue());
72      dist = jedis.geodist("foo", "a", "b", GeoUnit.FT);
73      assertEquals(515583, dist.intValue());
74      dist = jedis.geodist(bfoo, bA, bB);
75      assertEquals(157149, dist.intValue());
76      dist = jedis.geodist(bfoo, bA, bB, GeoUnit.KM);
77      assertEquals(157, dist.intValue());
78      dist = jedis.geodist(bfoo, bA, bB, GeoUnit.MI);
79      assertEquals(97, dist.intValue());
80      dist = jedis.geodist(bfoo, bA, bB, GeoUnit.FT);
81      assertEquals(515583, dist.intValue());
82    }
83    @Test
84    public void geohash() {
85      prepareGeoData();
86      List<String> hashes = jedis.geohash("foo", "a", "b", "notexist");
87      assertEquals(3, hashes.size());
88      assertEquals("s0dnu20t9j0", hashes.get(0));
89      assertEquals("s093jd0k720", hashes.get(1));
90      assertNull(hashes.get(2));
91      List<byte[]> bhashes = jedis.geohash(bfoo, bA, bB, bNotexist);
92      assertEquals(3, bhashes.size());
93      assertArrayEquals(SafeEncoder.encode("s0dnu20t9j0"), bhashes.get(0));
94      assertArrayEquals(SafeEncoder.encode("s093jd0k720"), bhashes.get(1));
95      assertNull(bhashes.get(2));
96    }
97    @Test
98    public void geopos() {
99      prepareGeoData();
100      List<GeoCoordinate> coordinates = jedis.geopos("foo", "a", "b", "notexist");
101      assertEquals(3, coordinates.size());
102      assertEquals(3.0, coordinates.get(0).getLongitude(), EPSILON);
103      assertEquals(4.0, coordinates.get(0).getLatitude(), EPSILON);
104      assertEquals(2.0, coordinates.get(1).getLongitude(), EPSILON);
105      assertEquals(3.0, coordinates.get(1).getLatitude(), EPSILON);
106      assertNull(coordinates.get(2));
107      List<GeoCoordinate> bcoordinates = jedis.geopos(bfoo, bA, bB, bNotexist);
108      assertEquals(3, bcoordinates.size());
109      assertEquals(3.0, bcoordinates.get(0).getLongitude(), EPSILON);
110      assertEquals(4.0, bcoordinates.get(0).getLatitude(), EPSILON);
111      assertEquals(2.0, bcoordinates.get(1).getLongitude(), EPSILON);
112      assertEquals(3.0, bcoordinates.get(1).getLatitude(), EPSILON);
113      assertNull(bcoordinates.get(2));
114    }
115    @Test
116    public void georadius() {
117      Map<String, GeoCoordinate> coordinateMap = new HashMap<>();
118      coordinateMap.put("Palermo", new GeoCoordinate(13.361389, 38.115556));
119      coordinateMap.put("Catania", new GeoCoordinate(15.087269, 37.502669));
120      jedis.geoadd("Sicily", coordinateMap);
121      List<GeoRadiusResponse> members = jedis.georadius("Sicily", 15, 37, 200, GeoUnit.KM);
122      assertEquals(2, members.size());
123      members = jedis.georadius("Sicily", 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
124          .sortDescending());
125      assertEquals(2, members.size());
126      assertEquals("Catania", members.get(1).getMemberByString());
127      assertEquals("Palermo", members.get(0).getMemberByString());
128      members = jedis.georadius("Sicily", 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
129          .sortAscending().count(1));
130      assertEquals(1, members.size());
131      members = jedis.georadius("Sicily", 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
132          .sortAscending().count(1).withCoord().withDist().withHash());
133      assertEquals(1, members.size());
134      GeoRadiusResponse response = members.get(0);
135      assertEquals(56.4413, response.getDistance(), EPSILON);
136      assertEquals(15.087269, response.getCoordinate().getLongitude(), EPSILON);
137      assertEquals(37.502669, response.getCoordinate().getLatitude(), EPSILON);
138      assertEquals(3479447370796909L, response.getRawScore());
139      members = jedis.georadius("Sicily", 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
140          .sortAscending().count(1).withHash());
141      assertEquals(1, members.size());
142      response = members.get(0);
143      assertEquals(3479447370796909L, response.getRawScore());
144      members = jedis.georadius("Sicily", 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
145          .sortDescending().count(1, true));
146      assertEquals(1, members.size());
147      response = members.get(0);
148      assertTrue(coordinateMap.containsKey(response.getMemberByString()));
149    }
150    @Test
151    public void georadiusStore() {
152      Map<String, GeoCoordinate> coordinateMap = new HashMap<>();
153      coordinateMap.put("Palermo", new GeoCoordinate(13.361389, 38.115556));
154      coordinateMap.put("Catania", new GeoCoordinate(15.087269, 37.502669));
155      jedis.geoadd("Sicily", coordinateMap);
156      long size = jedis.georadiusStore("Sicily", 15, 37, 200, GeoUnit.KM,
157        GeoRadiusParam.geoRadiusParam(),
158        GeoRadiusStoreParam.geoRadiusStoreParam().store("SicilyStore"));
159      assertEquals(2, size);
160      List<String> expected = new ArrayList<>();
161      expected.add("Palermo");
162      expected.add("Catania");
163      assertEquals(expected, jedis.zrange("SicilyStore", 0, -1));
164    }
165    @Test
166    public void georadiusReadonly() {
167      Map<String, GeoCoordinate> coordinateMap = new HashMap<>();
168      coordinateMap.put("Palermo", new GeoCoordinate(13.361389, 38.115556));
169      coordinateMap.put("Catania", new GeoCoordinate(15.087269, 37.502669));
170      jedis.geoadd("Sicily", coordinateMap);
171      List<GeoRadiusResponse> members = jedis.georadiusReadonly("Sicily", 15, 37, 200, GeoUnit.KM);
172      assertEquals(2, members.size());
173      members = jedis.georadiusReadonly("Sicily", 15, 37, 200, GeoUnit.KM,
174          GeoRadiusParam.geoRadiusParam().sortAscending());
175      assertEquals(2, members.size());
176      assertEquals("Catania", members.get(0).getMemberByString());
177      assertEquals("Palermo", members.get(1).getMemberByString());
178      members = jedis.georadiusReadonly("Sicily", 15, 37, 200, GeoUnit.KM,
179          GeoRadiusParam.geoRadiusParam().sortAscending().count(1));
180      assertEquals(1, members.size());
181      members = jedis.georadiusReadonly("Sicily", 15, 37, 200, GeoUnit.KM,
182          GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
183      assertEquals(1, members.size());
184      GeoRadiusResponse response = members.get(0);
185      assertEquals(56.4413, response.getDistance(), EPSILON);
186      assertEquals(15.087269, response.getCoordinate().getLongitude(), EPSILON);
187      assertEquals(37.502669, response.getCoordinate().getLatitude(), EPSILON);
188    }
189    @Test
190    public void georadiusBinary() {
191      Map<byte[], GeoCoordinate> bcoordinateMap = new HashMap<>();
192      bcoordinateMap.put(bA, new GeoCoordinate(13.361389, 38.115556));
193      bcoordinateMap.put(bB, new GeoCoordinate(15.087269, 37.502669));
194      jedis.geoadd(bfoo, bcoordinateMap);
195      List<GeoRadiusResponse> members = jedis.georadius(bfoo, 15, 37, 200, GeoUnit.KM);
196      assertEquals(2, members.size());
197      members = jedis.georadius(bfoo, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
198          .sortAscending());
199      assertEquals(2, members.size());
200      assertArrayEquals(bB, members.get(0).getMember());
201      assertArrayEquals(bA, members.get(1).getMember());
202      members = jedis.georadius(bfoo, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
203          .sortAscending().count(1));
204      assertEquals(1, members.size());
205      members = jedis.georadius(bfoo, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
206          .sortAscending().count(1).withCoord().withDist());
207      assertEquals(1, members.size());
208      GeoRadiusResponse response = members.get(0);
209      assertEquals(56.4413, response.getDistance(), EPSILON);
210      assertEquals(15.087269, response.getCoordinate().getLongitude(), EPSILON);
211      assertEquals(37.502669, response.getCoordinate().getLatitude(), EPSILON);
212    }
213    @Test
214    public void georadiusStoreBinary() {
215      Map<byte[], GeoCoordinate> bcoordinateMap = new HashMap<>();
216      bcoordinateMap.put(bA, new GeoCoordinate(13.361389, 38.115556));
217      bcoordinateMap.put(bB, new GeoCoordinate(15.087269, 37.502669));
218      jedis.geoadd(bfoo, bcoordinateMap);
219      long size = jedis.georadiusStore(bfoo, 15, 37, 200, GeoUnit.KM,
220        GeoRadiusParam.geoRadiusParam(),
221        GeoRadiusStoreParam.geoRadiusStoreParam().store("SicilyStore"));
222      assertEquals(2, size);
223      List<byte[]> bexpected = new ArrayList<>();
224      bexpected.add(bA);
225      bexpected.add(bB);
226      assertByteArrayListEquals(bexpected, jedis.zrange("SicilyStore".getBytes(), 0, -1));
227    }
228    @Test
229    public void georadiusReadonlyBinary() {
230      Map<byte[], GeoCoordinate> bcoordinateMap = new HashMap<>();
231      bcoordinateMap.put(bA, new GeoCoordinate(13.361389, 38.115556));
232      bcoordinateMap.put(bB, new GeoCoordinate(15.087269, 37.502669));
233      jedis.geoadd(bfoo, bcoordinateMap);
234      List<GeoRadiusResponse> members = jedis.georadiusReadonly(bfoo, 15, 37, 200, GeoUnit.KM);
235      assertEquals(2, members.size());
236      members = jedis.georadiusReadonly(bfoo, 15, 37, 200, GeoUnit.KM,
237          GeoRadiusParam.geoRadiusParam().sortAscending());
238      assertEquals(2, members.size());
239      assertArrayEquals(bB, members.get(0).getMember());
240      assertArrayEquals(bA, members.get(1).getMember());
241      members = jedis.georadiusReadonly(bfoo, 15, 37, 200, GeoUnit.KM,
242          GeoRadiusParam.geoRadiusParam().sortAscending().count(1));
243      assertEquals(1, members.size());
244      members = jedis.georadiusReadonly(bfoo, 15, 37, 200, GeoUnit.KM,
245          GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
246      assertEquals(1, members.size());
247      GeoRadiusResponse response = members.get(0);
248      assertEquals(56.4413, response.getDistance(), EPSILON);
249      assertEquals(15.087269, response.getCoordinate().getLongitude(), EPSILON);
250      assertEquals(37.502669, response.getCoordinate().getLatitude(), EPSILON);
251    }
252    @Test
253    public void georadiusByMember() {
254      jedis.geoadd("Sicily", 13.583333, 37.316667, "Agrigento");
255      jedis.geoadd("Sicily", 13.361389, 38.115556, "Palermo");
256      jedis.geoadd("Sicily", 15.087269, 37.502669, "Catania");
257      List<GeoRadiusResponse> members = jedis.georadiusByMember("Sicily", "Agrigento", 100,
258        GeoUnit.KM);
259      assertEquals(2, members.size());
260      members = jedis.georadiusByMember("Sicily", "Agrigento", 100, GeoUnit.KM, GeoRadiusParam
261          .geoRadiusParam().sortAscending());
262      assertEquals(2, members.size());
263      assertEquals("Agrigento", members.get(0).getMemberByString());
264      assertEquals("Palermo", members.get(1).getMemberByString());
265      members = jedis.georadiusByMember("Sicily", "Agrigento", 100, GeoUnit.KM, GeoRadiusParam
266          .geoRadiusParam().sortAscending().count(1).withCoord().withDist());
267      assertEquals(1, members.size());
268      GeoRadiusResponse member = members.get(0);
269      assertEquals("Agrigento", member.getMemberByString());
270      assertEquals(0, member.getDistance(), EPSILON);
271      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
272      assertEquals(37.316667, member.getCoordinate().getLatitude(), EPSILON);
273    }
274    @Test
275    public void georadiusByMemberStore() {
276      jedis.geoadd("Sicily", 13.583333, 37.316667, "Agrigento");
277      jedis.geoadd("Sicily", 13.361389, 38.115556, "Palermo");
278      jedis.geoadd("Sicily", 15.087269, 37.502669, "Catania");
279      long size = jedis.georadiusByMemberStore("Sicily", "Agrigento", 100, GeoUnit.KM,
280        GeoRadiusParam.geoRadiusParam(),
281        GeoRadiusStoreParam.geoRadiusStoreParam().store("SicilyStore"));
282      assertEquals(2, size);
283      List<String> expected = new ArrayList<>();
284      expected.add("Agrigento");
285      expected.add("Palermo");
286      assertEquals(expected, jedis.zrange("SicilyStore", 0, -1));
287    }
288    @Test
289    public void georadiusByMemberReadonly() {
290      jedis.geoadd("Sicily", 13.583333, 37.316667, "Agrigento");
291      jedis.geoadd("Sicily", 13.361389, 38.115556, "Palermo");
292      jedis.geoadd("Sicily", 15.087269, 37.502669, "Catania");
293      List<GeoRadiusResponse> members = jedis.georadiusByMemberReadonly("Sicily", "Agrigento", 100,
294        GeoUnit.KM);
295      assertEquals(2, members.size());
296      members = jedis.georadiusByMemberReadonly("Sicily", "Agrigento", 100, GeoUnit.KM,
297        GeoRadiusParam.geoRadiusParam().sortAscending());
298      assertEquals(2, members.size());
299      assertEquals("Agrigento", members.get(0).getMemberByString());
300      assertEquals("Palermo", members.get(1).getMemberByString());
301      members = jedis.georadiusByMemberReadonly("Sicily", "Agrigento", 100, GeoUnit.KM,
302        GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
303      assertEquals(1, members.size());
304      GeoRadiusResponse member = members.get(0);
305      assertEquals("Agrigento", member.getMemberByString());
306      assertEquals(0, member.getDistance(), EPSILON);
307      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
308      assertEquals(37.316667, member.getCoordinate().getLatitude(), EPSILON);
309    }
310    @Test
311    public void georadiusByMemberBinary() {
312      jedis.geoadd(bfoo, 13.583333, 37.316667, bA);
313      jedis.geoadd(bfoo, 13.361389, 38.115556, bB);
314      jedis.geoadd(bfoo, 15.087269, 37.502669, bC);
315      List<GeoRadiusResponse> members = jedis.georadiusByMember(bfoo, bA, 100, GeoUnit.KM);
316      assertEquals(2, members.size());
317      members = jedis.georadiusByMember(bfoo, bA, 100, GeoUnit.KM,
318          GeoRadiusParam.geoRadiusParam().sortAscending());
319      assertEquals(2, members.size());
320      assertArrayEquals(bA, members.get(0).getMember());
321      assertArrayEquals(bB, members.get(1).getMember());
322      members = jedis.georadiusByMember(bfoo, bA, 100, GeoUnit.KM,
323          GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
324      assertEquals(1, members.size());
325      GeoRadiusResponse member = members.get(0);
326      assertArrayEquals(bA, member.getMember());
327      assertEquals(0, member.getDistance(), EPSILON);
328      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
329      assertEquals(37.316667, member.getCoordinate().getLatitude(), EPSILON);
330    }
331    @Test
332    public void georadiusByMemberStoreBinary() {
333      jedis.geoadd(bfoo, 13.583333, 37.316667, bA);
334      jedis.geoadd(bfoo, 13.361389, 38.115556, bB);
335      jedis.geoadd(bfoo, 15.087269, 37.502669, bC);
336      assertEquals(2, jedis.georadiusByMemberStore(bfoo, bA, 100, GeoUnit.KM,
337          GeoRadiusParam.geoRadiusParam(),
338          GeoRadiusStoreParam.geoRadiusStoreParam().store("SicilyStore")));
339      List<byte[]> bexpected = new ArrayList<>();
340      bexpected.add(bA);
341      bexpected.add(bB);
342      assertByteArrayListEquals(bexpected, jedis.zrange("SicilyStore".getBytes(), 0, -1));
343    }
344    @Test
345    public void georadiusByMemberReadonlyBinary() {
346      jedis.geoadd(bfoo, 13.583333, 37.316667, bA);
347      jedis.geoadd(bfoo, 13.361389, 38.115556, bB);
348      jedis.geoadd(bfoo, 15.087269, 37.502669, bC);
349      List<GeoRadiusResponse> members = jedis.georadiusByMemberReadonly(bfoo, bA, 100, GeoUnit.KM);
350      assertEquals(2, members.size());
351      members = jedis.georadiusByMemberReadonly(bfoo, bA, 100, GeoUnit.KM,
352          GeoRadiusParam.geoRadiusParam().sortAscending());
353      assertEquals(2, members.size());
354      assertArrayEquals(bA, members.get(0).getMember());
355      assertArrayEquals(bB, members.get(1).getMember());
356      members = jedis.georadiusByMemberReadonly(bfoo, bA, 100, GeoUnit.KM,
357          GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
<span onclick='openModal()' class='match'>358      assertEquals(1, members.size());
359      GeoRadiusResponse member = members.get(0);
360      assertArrayEquals(bA, member.getMember());
361      assertEquals(0, member.getDistance(), EPSILON);
362      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
</span>363      assertEquals(37.316667, member.getCoordinate().getLatitude(), EPSILON);
364    }
365    @Test
366    public void geosearch() {
367      jedis.geoadd("barcelona", 2.1909389952632d, 41.433791470673d, "place1");
368      jedis.geoadd("barcelona", 2.1873744593677d, 41.406342043777d, "place2");
369      jedis.geoadd("barcelona", 2.583333d, 41.316667d, "place3");
370      List<GeoRadiusResponse> members = jedis.geosearch("barcelona",
371              new GeoCoordinate(2.191d,41.433d), 1000, GeoUnit.M);
372      assertEquals(1, members.size());
373      assertEquals("place1", members.get(0).getMemberByString());
374      members = jedis.geosearch("barcelona", new GeoSearchParam().byRadius(3000, GeoUnit.M)
375              .fromLonLat(2.191d,41.433d).desc());
376      assertEquals(2, members.size());
377      assertEquals("place2", members.get(0).getMemberByString());
378      members = jedis.geosearch("barcelona","place3", 100, GeoUnit.KM);
379      assertEquals(3, members.size());
380      members = jedis.geosearch("barcelona", new GeoSearchParam().fromMember("place1")
381              .byRadius(100, GeoUnit.KM).withDist().withCoord().withHash().count(2));
382      assertEquals(2, members.size());
383      assertEquals("place1", members.get(0).getMemberByString());
384      GeoRadiusResponse res2 = members.get(1);
385      assertEquals("place2", res2.getMemberByString());
386      assertEquals(3.0674157, res2.getDistance(), 5);
387      assertEquals(new GeoCoordinate(2.187376320362091, 41.40634178640635), res2.getCoordinate());
388      members = jedis.geosearch("barcelona","place3", 100, 100, GeoUnit.KM);
389      assertEquals(3, members.size());
390      members = jedis.geosearch("barcelona", new GeoSearchParam().fromMember("place3")
391              .byBox(100, 100, GeoUnit.KM).asc().count(1, true));
392      assertEquals(1, members.size());
393      members = jedis.geosearch("barcelona", new GeoCoordinate(2.191, 41.433),
394              1, 1, GeoUnit.KM);
395      assertEquals(1, members.size());
396      members = jedis.geosearch("barcelona", new GeoSearchParam().byBox(1,1, GeoUnit.KM)
397              .fromLonLat(2.191, 41.433).withDist().withCoord());
398      assertEquals(1, members.size());
399      assertEquals("place1", members.get(0).getMemberByString());
400      assertEquals(0.0881, members.get(0).getDistance(), 10);
401      assertEquals(new GeoCoordinate(2.19093829393386841, 41.43379028184083523), members.get(0).getCoordinate());
402    }
403    @Test
404    public void geosearchNegative() {
405      try {
406        jedis.geosearch("barcelona", new GeoSearchParam()
407                .byRadius(3000, GeoUnit.M).byBox(300, 300, GeoUnit.M));
408        fail();
409      } catch (redis.clients.jedis.exceptions.JedisDataException ignored) { }
410      try {
411        jedis.geosearch("barcelona", new GeoSearchParam()
412                .fromMember("foobar"));
413        fail();
414      } catch (java.lang.IllegalArgumentException ignored) { }
415      try {
416        jedis.geosearch("barcelona", new GeoSearchParam()
417                .fromMember("foobar").fromLonLat(10,10));
418        fail();
419      } catch (java.lang.IllegalArgumentException ignored) { }
420      try {
421        jedis.geosearch("barcelona", new GeoSearchParam()
422                .byRadius(10, GeoUnit.MI));
423        fail();
424      } catch (redis.clients.jedis.exceptions.JedisDataException ignored) { }
425    }
426    @Test
427    public void geosearchstore() {
428      jedis.geoadd("barcelona", 2.1909389952632d, 41.433791470673d, "place1");
429      jedis.geoadd("barcelona", 2.1873744593677d, 41.406342043777d, "place2");
430      jedis.geoadd("barcelona", 2.583333d, 41.316667d, "place3");
431      long members = jedis.geosearchStore("tel-aviv", "barcelona", new GeoCoordinate(2.191d,41.433d),
432              1000, GeoUnit.M);
433      assertEquals(1, members);
434      List<String> expected = new ArrayList<>();
435      expected.add("place1");
436      assertEquals(expected, jedis.zrange("tel-aviv", 0, -1));
437      members = jedis.geosearchStore("tel-aviv","barcelona", new GeoSearchParam()
438              .byRadius(3000, GeoUnit.M)
439              .fromLonLat(new GeoCoordinate(2.191d,41.433d)));
440      assertEquals(2, members);
441      assertEquals(2, members);
442      members = jedis.geosearchStore("tel-aviv", "barcelona","place3", 100, GeoUnit.KM);
443      assertEquals(3, members);
444      members = jedis.geosearchStore("tel-aviv","barcelona","place3", 100, 100, GeoUnit.KM);
445      assertEquals(3, members);
446      members = jedis.geosearchStore("tel-aviv","barcelona", new GeoCoordinate(2.191, 41.433),
447              1, 1, GeoUnit.KM);
448      assertEquals(1, members);
449    }
450    @Test
451    public void geosearchstoreWithdist() {
452      jedis.geoadd("barcelona", 2.1909389952632d, 41.433791470673d, "place1");
453      jedis.geoadd("barcelona", 2.1873744593677d, 41.406342043777d, "place2");
454      long members = jedis.geosearchStoreStoreDist("tel-aviv","barcelona", new GeoSearchParam().byRadius(3000, GeoUnit.M)
455              .fromLonLat(2.191d,41.433d));
456      assertEquals(2, members);
457      assertEquals(88.05060698409301, jedis.zscore("tel-aviv", "place1"), 5);
458    }
459    private void prepareGeoData() {
460      Map<String, GeoCoordinate> coordinateMap = new HashMap<>();
461      coordinateMap.put("a", new GeoCoordinate(3, 4));
462      coordinateMap.put("b", new GeoCoordinate(2, 3));
463      coordinateMap.put("c", new GeoCoordinate(3.314, 2.3241));
464      assertEquals(3, jedis.geoadd("foo", coordinateMap));
465      Map<byte[], GeoCoordinate> bcoordinateMap = new HashMap<>();
466      bcoordinateMap.put(bA, new GeoCoordinate(3, 4));
467      bcoordinateMap.put(bB, new GeoCoordinate(2, 3));
468      bcoordinateMap.put(bC, new GeoCoordinate(3.314, 2.3241));
469      assertEquals(3, jedis.geoadd(bfoo, bcoordinateMap));
470    }
471  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-SetCommandsTestBase.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-GeoCommandsTestBase.java</div>
                </div>
                <div class="column column_space"><pre><code>244      long card = jedis.sintercard("foo", "bar");
245      assertEquals(2, card);
246      long limitedCard = jedis.sintercard(1, "foo", "bar");
247      assertEquals(1, limitedCard);
248      jedis.sadd(bfoo, ba);
249      jedis.sadd(bfoo, bb);
250      jedis.sadd(bbar, ba);
251      jedis.sadd(bbar, bb);
252      jedis.sadd(bbar, bc);
</pre></code></div>
                <div class="column column_space"><pre><code>358      assertEquals(1, members.size());
359      GeoRadiusResponse member = members.get(0);
360      assertArrayEquals(bA, member.getMember());
361      assertEquals(0, member.getDistance(), EPSILON);
362      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    