
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 15, <button onclick='openModal()' class='match'>CODE CLONE</button></h2>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ListCommandsTest.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.jedis;
2  import static org.junit.Assert.assertArrayEquals;
3  import static org.junit.Assert.assertEquals;
4  import static org.junit.Assert.assertNotNull;
5  import static org.junit.Assert.assertNull;
6  import static org.junit.Assert.assertTrue;
7  import static org.junit.Assert.fail;
8  import static redis.clients.jedis.util.AssertUtil.assertByteArrayListEquals;
9  import java.util.ArrayList;
10  import java.util.Arrays;
11  import java.util.Collections;
12  import java.util.List;
13  import org.junit.Test;
14  import org.slf4j.Logger;
15  import org.slf4j.LoggerFactory;
16  import redis.clients.jedis.Jedis;
17  import redis.clients.jedis.args.ListPosition;
18  import redis.clients.jedis.args.ListDirection;
19  import redis.clients.jedis.exceptions.JedisDataException;
20  import redis.clients.jedis.params.LPosParams;
21  import redis.clients.jedis.util.KeyValue;
22  public class ListCommandsTest extends JedisCommandsTestBase {
23    private final Logger logger = LoggerFactory.getLogger(getClass());
24    final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
25    final byte[] bfoo1 = { 0x01, 0x02, 0x03, 0x04, 0x05 };
26    final byte[] bbar = { 0x05, 0x06, 0x07, 0x08 };
27    final byte[] bcar = { 0x09, 0x0A, 0x0B, 0x0C };
28    final byte[] bA = { 0x0A };
29    final byte[] bB = { 0x0B };
30    final byte[] bC = { 0x0C };
31    final byte[] b1 = { 0x01 };
32    final byte[] b2 = { 0x02 };
33    final byte[] b3 = { 0x03 };
34    final byte[] bhello = { 0x04, 0x02 };
35    final byte[] bx = { 0x02, 0x04 };
36    final byte[] bdst = { 0x11, 0x12, 0x13, 0x14 };
37    @Test
38    public void rpush() {
39      assertEquals(1, jedis.rpush(&quot;foo&quot;, &quot;bar&quot;));
40      assertEquals(2, jedis.rpush(&quot;foo&quot;, &quot;foo&quot;));
41      assertEquals(4, jedis.rpush(&quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;));
42      assertEquals(1, jedis.rpush(bfoo, bbar));
43      assertEquals(2, jedis.rpush(bfoo, bfoo));
44      assertEquals(4, jedis.rpush(bfoo, bbar, bfoo));
45    }
46    @Test
47    public void lpush() {
48      assertEquals(1, jedis.lpush(&quot;foo&quot;, &quot;bar&quot;));
49      assertEquals(2, jedis.lpush(&quot;foo&quot;, &quot;foo&quot;));
50      assertEquals(4, jedis.lpush(&quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;));
51      assertEquals(1, jedis.lpush(bfoo, bbar));
52      assertEquals(2, jedis.lpush(bfoo, bfoo));
53      assertEquals(4, jedis.lpush(bfoo, bbar, bfoo));
54    }
55    @Test
56    public void llen() {
57      assertEquals(0, jedis.llen(&quot;foo&quot;));
58      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
59      jedis.lpush(&quot;foo&quot;, &quot;car&quot;);
60      assertEquals(2, jedis.llen(&quot;foo&quot;));
61      assertEquals(0, jedis.llen(bfoo));
62      jedis.lpush(bfoo, bbar);
63      jedis.lpush(bfoo, bcar);
<span onclick='openModal()' class='match'>64      assertEquals(2, jedis.llen(bfoo));
65    }
66    @Test
67    public void llenNotOnList() {
</span>68      try {
69        jedis.set(&quot;foo&quot;, &quot;bar&quot;);
70        jedis.llen(&quot;foo&quot;);
71        fail(&quot;JedisDataException expected&quot;);
72      } catch (final JedisDataException e) {
73      }
74      try {
75        jedis.set(bfoo, bbar);
76        jedis.llen(bfoo);
77        fail(&quot;JedisDataException expected&quot;);
78      } catch (final JedisDataException e) {
79      }
80    }
81    @Test
82    public void lrange() {
83      jedis.rpush(&quot;foo&quot;, &quot;a&quot;);
84      jedis.rpush(&quot;foo&quot;, &quot;b&quot;);
85      jedis.rpush(&quot;foo&quot;, &quot;c&quot;);
86      List&lt;String&gt; expected = new ArrayList&lt;String&gt;();
87      expected.add(&quot;a&quot;);
88      expected.add(&quot;b&quot;);
89      expected.add(&quot;c&quot;);
90      List&lt;String&gt; range = jedis.lrange(&quot;foo&quot;, 0, 2);
91      assertEquals(expected, range);
92      range = jedis.lrange(&quot;foo&quot;, 0, 20);
93      assertEquals(expected, range);
94      expected = new ArrayList&lt;String&gt;();
95      expected.add(&quot;b&quot;);
96      expected.add(&quot;c&quot;);
97      range = jedis.lrange(&quot;foo&quot;, 1, 2);
98      assertEquals(expected, range);
99      range = jedis.lrange(&quot;foo&quot;, 2, 1);
100      assertEquals(Collections.&lt;String&gt; emptyList(), range);
101      jedis.rpush(bfoo, bA);
102      jedis.rpush(bfoo, bB);
103      jedis.rpush(bfoo, bC);
104      List&lt;byte[]&gt; bexpected = new ArrayList&lt;byte[]&gt;();
105      bexpected.add(bA);
106      bexpected.add(bB);
107      bexpected.add(bC);
108      List&lt;byte[]&gt; brange = jedis.lrange(bfoo, 0, 2);
109      assertByteArrayListEquals(bexpected, brange);
110      brange = jedis.lrange(bfoo, 0, 20);
111      assertByteArrayListEquals(bexpected, brange);
112      bexpected = new ArrayList&lt;byte[]&gt;();
113      bexpected.add(bB);
114      bexpected.add(bC);
115      brange = jedis.lrange(bfoo, 1, 2);
116      assertByteArrayListEquals(bexpected, brange);
117      brange = jedis.lrange(bfoo, 2, 1);
118      assertByteArrayListEquals(Collections.&lt;byte[]&gt; emptyList(), brange);
119    }
120    @Test
121    public void ltrim() {
122      jedis.lpush(&quot;foo&quot;, &quot;1&quot;);
123      jedis.lpush(&quot;foo&quot;, &quot;2&quot;);
124      jedis.lpush(&quot;foo&quot;, &quot;3&quot;);
125      String status = jedis.ltrim(&quot;foo&quot;, 0, 1);
126      List&lt;String&gt; expected = new ArrayList&lt;String&gt;();
127      expected.add(&quot;3&quot;);
128      expected.add(&quot;2&quot;);
129      assertEquals(&quot;OK&quot;, status);
130      assertEquals(2, jedis.llen(&quot;foo&quot;));
131      assertEquals(expected, jedis.lrange(&quot;foo&quot;, 0, 100));
132      jedis.lpush(bfoo, b1);
133      jedis.lpush(bfoo, b2);
134      jedis.lpush(bfoo, b3);
135      String bstatus = jedis.ltrim(bfoo, 0, 1);
136      List&lt;byte[]&gt; bexpected = new ArrayList&lt;byte[]&gt;();
137      bexpected.add(b3);
138      bexpected.add(b2);
139      assertEquals(&quot;OK&quot;, bstatus);
140      assertEquals(2, jedis.llen(bfoo));
141      assertByteArrayListEquals(bexpected, jedis.lrange(bfoo, 0, 100));
142    }
143    @Test
144    public void lset() {
145      jedis.lpush(&quot;foo&quot;, &quot;1&quot;);
146      jedis.lpush(&quot;foo&quot;, &quot;2&quot;);
147      jedis.lpush(&quot;foo&quot;, &quot;3&quot;);
148      List&lt;String&gt; expected = new ArrayList&lt;String&gt;();
149      expected.add(&quot;3&quot;);
150      expected.add(&quot;bar&quot;);
151      expected.add(&quot;1&quot;);
152      String status = jedis.lset(&quot;foo&quot;, 1, &quot;bar&quot;);
153      assertEquals(&quot;OK&quot;, status);
154      assertEquals(expected, jedis.lrange(&quot;foo&quot;, 0, 100));
155      jedis.lpush(bfoo, b1);
156      jedis.lpush(bfoo, b2);
157      jedis.lpush(bfoo, b3);
158      List&lt;byte[]&gt; bexpected = new ArrayList&lt;byte[]&gt;();
159      bexpected.add(b3);
160      bexpected.add(bbar);
161      bexpected.add(b1);
162      String bstatus = jedis.lset(bfoo, 1, bbar);
163      assertEquals(&quot;OK&quot;, bstatus);
164      assertByteArrayListEquals(bexpected, jedis.lrange(bfoo, 0, 100));
165    }
166    @Test
167    public void lindex() {
168      jedis.lpush(&quot;foo&quot;, &quot;1&quot;);
169      jedis.lpush(&quot;foo&quot;, &quot;2&quot;);
170      jedis.lpush(&quot;foo&quot;, &quot;3&quot;);
171      assertEquals(&quot;3&quot;, jedis.lindex(&quot;foo&quot;, 0));
172      assertNull(jedis.lindex(&quot;foo&quot;, 100));
173      jedis.lpush(bfoo, b1);
174      jedis.lpush(bfoo, b2);
175      jedis.lpush(bfoo, b3);
176      assertArrayEquals(b3, jedis.lindex(bfoo, 0));
177      assertNull(jedis.lindex(bfoo, 100));
178    }
179    @Test
180    public void lrem() {
181      jedis.lpush(&quot;foo&quot;, &quot;hello&quot;);
182      jedis.lpush(&quot;foo&quot;, &quot;hello&quot;);
183      jedis.lpush(&quot;foo&quot;, &quot;x&quot;);
184      jedis.lpush(&quot;foo&quot;, &quot;hello&quot;);
185      jedis.lpush(&quot;foo&quot;, &quot;c&quot;);
186      jedis.lpush(&quot;foo&quot;, &quot;b&quot;);
187      jedis.lpush(&quot;foo&quot;, &quot;a&quot;);
188      List&lt;String&gt; expected = new ArrayList&lt;String&gt;();
189      expected.add(&quot;a&quot;);
190      expected.add(&quot;b&quot;);
191      expected.add(&quot;c&quot;);
192      expected.add(&quot;hello&quot;);
193      expected.add(&quot;x&quot;);
194      assertEquals(2, jedis.lrem(&quot;foo&quot;, -2, &quot;hello&quot;));
195      assertEquals(expected, jedis.lrange(&quot;foo&quot;, 0, 1000));
196      assertEquals(0, jedis.lrem(&quot;bar&quot;, 100, &quot;foo&quot;));
197      jedis.lpush(bfoo, bhello);
198      jedis.lpush(bfoo, bhello);
199      jedis.lpush(bfoo, bx);
200      jedis.lpush(bfoo, bhello);
201      jedis.lpush(bfoo, bC);
202      jedis.lpush(bfoo, bB);
203      jedis.lpush(bfoo, bA);
204      List&lt;byte[]&gt; bexpected = new ArrayList&lt;byte[]&gt;();
205      bexpected.add(bA);
206      bexpected.add(bB);
207      bexpected.add(bC);
208      bexpected.add(bhello);
209      bexpected.add(bx);
210      assertEquals(2, jedis.lrem(bfoo, -2, bhello));
211      assertByteArrayListEquals(bexpected, jedis.lrange(bfoo, 0, 1000));
212      assertEquals(0, jedis.lrem(bbar, 100, bfoo));
213    }
214    @Test
215    public void lpop() {
216      assertNull(jedis.lpop(&quot;foo&quot;));
217      assertNull(jedis.lpop(&quot;foo&quot;, 0));
218      jedis.rpush(&quot;foo&quot;, &quot;a&quot;);
219      jedis.rpush(&quot;foo&quot;, &quot;b&quot;);
220      jedis.rpush(&quot;foo&quot;, &quot;c&quot;);
221      assertEquals(&quot;a&quot;, jedis.lpop(&quot;foo&quot;));
222      assertEquals(Arrays.asList(&quot;b&quot;, &quot;c&quot;), jedis.lpop(&quot;foo&quot;, 10));
223      assertNull(jedis.lpop(&quot;foo&quot;));
224      assertNull(jedis.lpop(&quot;foo&quot;, 1));
225      assertNull(jedis.lpop(bfoo));
226      assertNull(jedis.lpop(bfoo, 0));
227      jedis.rpush(bfoo, bA);
228      jedis.rpush(bfoo, bB);
229      jedis.rpush(bfoo, bC);
230      assertArrayEquals(bA, jedis.lpop(bfoo));
231      assertByteArrayListEquals(Arrays.asList(bB, bC), jedis.lpop(bfoo, 10));
232      assertNull(jedis.lpop(bfoo));
233      assertNull(jedis.lpop(bfoo, 1));
234    }
235    @Test
236    public void rpop() {
237      assertNull(jedis.rpop(&quot;foo&quot;));
238      assertNull(jedis.rpop(&quot;foo&quot;, 0));
239      jedis.rpush(&quot;foo&quot;, &quot;a&quot;);
240      jedis.rpush(&quot;foo&quot;, &quot;b&quot;);
241      jedis.rpush(&quot;foo&quot;, &quot;c&quot;);
242      assertEquals(&quot;c&quot;, jedis.rpop(&quot;foo&quot;));
243      assertEquals(Arrays.asList(&quot;b&quot;, &quot;a&quot;), jedis.rpop(&quot;foo&quot;, 10));
244      assertNull(jedis.rpop(&quot;foo&quot;));
245      assertNull(jedis.rpop(&quot;foo&quot;, 1));
246      assertNull(jedis.rpop(bfoo));
247      assertNull(jedis.rpop(bfoo, 0));
248      jedis.rpush(bfoo, bA);
249      jedis.rpush(bfoo, bB);
250      jedis.rpush(bfoo, bC);
251      assertArrayEquals(bC, jedis.rpop(bfoo));
252      assertByteArrayListEquals(Arrays.asList(bB, bA), jedis.rpop(bfoo, 10));
253      assertNull(jedis.rpop(bfoo));
254      assertNull(jedis.rpop(bfoo, 1));
255    }
256    @Test
257    public void rpoplpush() {
258      jedis.rpush(&quot;foo&quot;, &quot;a&quot;);
259      jedis.rpush(&quot;foo&quot;, &quot;b&quot;);
260      jedis.rpush(&quot;foo&quot;, &quot;c&quot;);
261      jedis.rpush(&quot;dst&quot;, &quot;foo&quot;);
262      jedis.rpush(&quot;dst&quot;, &quot;bar&quot;);
263      String element = jedis.rpoplpush(&quot;foo&quot;, &quot;dst&quot;);
264      assertEquals(&quot;c&quot;, element);
265      List&lt;String&gt; srcExpected = new ArrayList&lt;String&gt;();
266      srcExpected.add(&quot;a&quot;);
267      srcExpected.add(&quot;b&quot;);
268      List&lt;String&gt; dstExpected = new ArrayList&lt;String&gt;();
269      dstExpected.add(&quot;c&quot;);
270      dstExpected.add(&quot;foo&quot;);
271      dstExpected.add(&quot;bar&quot;);
272      assertEquals(srcExpected, jedis.lrange(&quot;foo&quot;, 0, 1000));
273      assertEquals(dstExpected, jedis.lrange(&quot;dst&quot;, 0, 1000));
274      jedis.rpush(bfoo, bA);
275      jedis.rpush(bfoo, bB);
276      jedis.rpush(bfoo, bC);
277      jedis.rpush(bdst, bfoo);
278      jedis.rpush(bdst, bbar);
279      byte[] belement = jedis.rpoplpush(bfoo, bdst);
280      assertArrayEquals(bC, belement);
281      List&lt;byte[]&gt; bsrcExpected = new ArrayList&lt;byte[]&gt;();
282      bsrcExpected.add(bA);
283      bsrcExpected.add(bB);
284      List&lt;byte[]&gt; bdstExpected = new ArrayList&lt;byte[]&gt;();
285      bdstExpected.add(bC);
286      bdstExpected.add(bfoo);
287      bdstExpected.add(bbar);
288      assertByteArrayListEquals(bsrcExpected, jedis.lrange(bfoo, 0, 1000));
289      assertByteArrayListEquals(bdstExpected, jedis.lrange(bdst, 0, 1000));
290    }
291    @Test
292    public void blpop() throws InterruptedException {
293      List&lt;String&gt; result = jedis.blpop(1, &quot;foo&quot;);
294      assertNull(result);
295      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
296      result = jedis.blpop(1, &quot;foo&quot;);
297      assertNotNull(result);
298      assertEquals(2, result.size());
299      assertEquals(&quot;foo&quot;, result.get(0));
300      assertEquals(&quot;bar&quot;, result.get(1));
301      result = jedis.blpop(1, &quot;foo&quot;, &quot;foo1&quot;);
302      assertNull(result);
303      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
304      jedis.lpush(&quot;foo1&quot;, &quot;bar1&quot;);
305      result = jedis.blpop(1, &quot;foo1&quot;, &quot;foo&quot;);
306      assertNotNull(result);
307      assertEquals(2, result.size());
308      assertEquals(&quot;foo1&quot;, result.get(0));
309      assertEquals(&quot;bar1&quot;, result.get(1));
310      jedis.lpush(bfoo, bbar);
311      List&lt;byte[]&gt; bresult = jedis.blpop(1, bfoo);
312      assertNotNull(bresult);
313      assertEquals(2, bresult.size());
314      assertArrayEquals(bfoo, bresult.get(0));
315      assertArrayEquals(bbar, bresult.get(1));
316      bresult = jedis.blpop(1, bfoo, bfoo1);
317      assertNull(bresult);
318      jedis.lpush(bfoo, bbar);
319      jedis.lpush(bfoo1, bcar);
320      bresult = jedis.blpop(1, bfoo, bfoo1);
321      assertNotNull(bresult);
322      assertEquals(2, bresult.size());
323      assertArrayEquals(bfoo, bresult.get(0));
324      assertArrayEquals(bbar, bresult.get(1));
325    }
326    @Test
327    public void blpopDouble() throws InterruptedException {
328      KeyValue&lt;String, String&gt; result = jedis.blpop(0.1, &quot;foo&quot;);
329      assertNull(result);
330      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
331      result = jedis.blpop(3.2, &quot;foo&quot;);
332      assertNotNull(result);
333      assertEquals(&quot;foo&quot;, result.getKey());
334      assertEquals(&quot;bar&quot;, result.getValue());
335      result = jedis.blpop(0.18, &quot;foo&quot;, &quot;foo1&quot;);
336      assertNull(result);
337      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
338      jedis.lpush(&quot;foo1&quot;, &quot;bar1&quot;);
339      result = jedis.blpop(1d, &quot;foo1&quot;, &quot;foo&quot;);
340      assertNotNull(result);
341      assertEquals(&quot;foo1&quot;, result.getKey());
342      assertEquals(&quot;bar1&quot;, result.getValue());
343      jedis.lpush(bfoo, bbar);
344      KeyValue&lt;byte[], byte[]&gt; bresult = jedis.blpop(3.12, bfoo);
345      assertNotNull(bresult);
346      assertArrayEquals(bfoo, bresult.getKey());
347      assertArrayEquals(bbar, bresult.getValue());
348      bresult = jedis.blpop(0.11, bfoo, bfoo1);
349      assertNull(bresult);
350      jedis.lpush(bfoo, bbar);
351      jedis.lpush(bfoo1, bcar);
352      bresult = jedis.blpop(1d, bfoo, bfoo1);
353      assertNotNull(bresult);
354      assertArrayEquals(bfoo, bresult.getKey());
355      assertArrayEquals(bbar, bresult.getValue());
356    }
357    @Test
358    public void blpopDoubleWithSleep() {
359      long startMillis, totalMillis;
360      startMillis = System.currentTimeMillis();
361      KeyValue&lt;String, String&gt; result = jedis.blpop(0.04, &quot;foo&quot;);
362      totalMillis = System.currentTimeMillis() - startMillis;
363      assertTrue(&quot;TotalMillis=&quot; + totalMillis, totalMillis &lt; 200);
364      assertNull(result);
365      startMillis = System.currentTimeMillis();
366      new Thread(() -&gt; {
367        try {
368          Thread.sleep(30);
369        } catch(InterruptedException e) {
370          logger.error(&quot;&quot;, e);
371        }
372        try (Jedis j = createJedis()) {
373          j.lpush(&quot;foo&quot;, &quot;bar&quot;);
374        }
375      }).start();
376      result = jedis.blpop(1.2, &quot;foo&quot;);
377      totalMillis = System.currentTimeMillis() - startMillis;
378      assertTrue(&quot;TotalMillis=&quot; + totalMillis, totalMillis &lt; 200);
379      assertNotNull(result);
380      assertEquals(&quot;foo&quot;, result.getKey());
381      assertEquals(&quot;bar&quot;, result.getValue());
382    }
383    @Test
384    public void brpop() throws InterruptedException {
385      List&lt;String&gt; result = jedis.brpop(1, &quot;foo&quot;);
386      assertNull(result);
387      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
388      result = jedis.brpop(1, &quot;foo&quot;);
389      assertNotNull(result);
390      assertEquals(2, result.size());
391      assertEquals(&quot;foo&quot;, result.get(0));
392      assertEquals(&quot;bar&quot;, result.get(1));
393      result = jedis.brpop(1, &quot;foo&quot;, &quot;foo1&quot;);
394      assertNull(result);
395      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
396      jedis.lpush(&quot;foo1&quot;, &quot;bar1&quot;);
397      result = jedis.brpop(1, &quot;foo1&quot;, &quot;foo&quot;);
398      assertNotNull(result);
399      assertEquals(2, result.size());
400      assertEquals(&quot;foo1&quot;, result.get(0));
401      assertEquals(&quot;bar1&quot;, result.get(1));
402      jedis.lpush(bfoo, bbar);
403      List&lt;byte[]&gt; bresult = jedis.brpop(1, bfoo);
404      assertNotNull(bresult);
405      assertEquals(2, bresult.size());
406      assertArrayEquals(bfoo, bresult.get(0));
407      assertArrayEquals(bbar, bresult.get(1));
408      bresult = jedis.brpop(1, bfoo, bfoo1);
409      assertNull(bresult);
410      jedis.lpush(bfoo, bbar);
411      jedis.lpush(bfoo1, bcar);
412      bresult = jedis.brpop(1, bfoo, bfoo1);
413      assertNotNull(bresult);
414      assertEquals(2, bresult.size());
415      assertArrayEquals(bfoo, bresult.get(0));
416      assertArrayEquals(bbar, bresult.get(1));
417    }
418    @Test
419    public void brpopDouble() throws InterruptedException {
420      KeyValue&lt;String, String&gt; result = jedis.brpop(0.1, &quot;foo&quot;);
421      assertNull(result);
422      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
423      result = jedis.brpop(3.2, &quot;foo&quot;);
424      assertNotNull(result);
425      assertEquals(&quot;foo&quot;, result.getKey());
426      assertEquals(&quot;bar&quot;, result.getValue());
427      result = jedis.brpop(0.18, &quot;foo&quot;, &quot;foo1&quot;);
428      assertNull(result);
429      jedis.lpush(&quot;foo&quot;, &quot;bar&quot;);
430      jedis.lpush(&quot;foo1&quot;, &quot;bar1&quot;);
431      result = jedis.brpop(1d, &quot;foo1&quot;, &quot;foo&quot;);
432      assertNotNull(result);
433      assertEquals(&quot;foo1&quot;, result.getKey());
434      assertEquals(&quot;bar1&quot;, result.getValue());
435      jedis.lpush(bfoo, bbar);
436      KeyValue&lt;byte[], byte[]&gt; bresult = jedis.brpop(3.12, bfoo);
437      assertNotNull(bresult);
438      assertArrayEquals(bfoo, bresult.getKey());
439      assertArrayEquals(bbar, bresult.getValue());
440      bresult = jedis.brpop(0.11, bfoo, bfoo1);
441      assertNull(bresult);
442      jedis.lpush(bfoo, bbar);
443      jedis.lpush(bfoo1, bcar);
444      bresult = jedis.brpop(1d, bfoo, bfoo1);
445      assertNotNull(bresult);
446      assertArrayEquals(bfoo, bresult.getKey());
447      assertArrayEquals(bbar, bresult.getValue());
448    }
449    @Test
450    public void brpopDoubleWithSleep() {
451      long startMillis, totalMillis;
452      startMillis = System.currentTimeMillis();
453      KeyValue&lt;String, String&gt; result = jedis.brpop(0.04, &quot;foo&quot;);
454      totalMillis = System.currentTimeMillis() - startMillis;
455      assertTrue(&quot;TotalMillis=&quot; + totalMillis, totalMillis &lt; 200);
456      assertNull(result);
457      startMillis = System.currentTimeMillis();
458      new Thread(() -&gt; {
459        try {
460          Thread.sleep(30);
461        } catch(InterruptedException e) {
462          logger.error(&quot;&quot;, e);
463        }
464        try (Jedis j = createJedis()) {
465          j.lpush(&quot;foo&quot;, &quot;bar&quot;);
466        }
467      }).start();
468      result = jedis.brpop(1.2, &quot;foo&quot;);
469      totalMillis = System.currentTimeMillis() - startMillis;
470      assertTrue(&quot;TotalMillis=&quot; + totalMillis, totalMillis &lt; 200);
471      assertNotNull(result);
472      assertEquals(&quot;foo&quot;, result.getKey());
473      assertEquals(&quot;bar&quot;, result.getValue());
474    }
475    @Test
476    public void lpushx() {
477      assertEquals(0, jedis.lpushx(&quot;foo&quot;, &quot;bar&quot;));
478      jedis.lpush(&quot;foo&quot;, &quot;a&quot;);
479      assertEquals(2, jedis.lpushx(&quot;foo&quot;, &quot;b&quot;));
480      assertEquals(0, jedis.lpushx(bfoo, bbar));
481      jedis.lpush(bfoo, bA);
482      assertEquals(2, jedis.lpushx(bfoo, bB));
483    }
484    @Test
485    public void rpushx() {
486      assertEquals(0, jedis.rpushx(&quot;foo&quot;, &quot;bar&quot;));
487      jedis.lpush(&quot;foo&quot;, &quot;a&quot;);
488      assertEquals(2, jedis.rpushx(&quot;foo&quot;, &quot;b&quot;));
489      assertEquals(0, jedis.rpushx(bfoo, bbar));
490      jedis.lpush(bfoo, bA);
491      assertEquals(2, jedis.rpushx(bfoo, bB));
492    }
493    @Test
494    public void linsert() {
495      assertEquals(0, jedis.linsert(&quot;foo&quot;, ListPosition.BEFORE, &quot;bar&quot;, &quot;car&quot;));
496      jedis.lpush(&quot;foo&quot;, &quot;a&quot;);
497      assertEquals(2, jedis.linsert(&quot;foo&quot;, ListPosition.AFTER, &quot;a&quot;, &quot;b&quot;));
498      List&lt;String&gt; expected = new ArrayList&lt;String&gt;();
499      expected.add(&quot;a&quot;);
500      expected.add(&quot;b&quot;);
501      assertEquals(expected, jedis.lrange(&quot;foo&quot;, 0, 100));
502      assertEquals(-1, jedis.linsert(&quot;foo&quot;, ListPosition.BEFORE, &quot;bar&quot;, &quot;car&quot;));
503      assertEquals(0, jedis.linsert(bfoo, ListPosition.BEFORE, bbar, bcar));
504      jedis.lpush(bfoo, bA);
505      assertEquals(2, jedis.linsert(bfoo, ListPosition.AFTER, bA, bB));
506      List&lt;byte[]&gt; bexpected = new ArrayList&lt;byte[]&gt;();
507      bexpected.add(bA);
508      bexpected.add(bB);
509      assertByteArrayListEquals(bexpected, jedis.lrange(bfoo, 0, 100));
510      assertEquals(-1, jedis.linsert(bfoo, ListPosition.BEFORE, bbar, bcar));
511    }
512    @Test
513    public void brpoplpush() {
514      new Thread(new Runnable() {
515        @Override
516        public void run() {
517          try {
518            Thread.sleep(100);
519          } catch (InterruptedException e) {
520            logger.error(&quot;&quot;, e);
521          }
522          try (Jedis j = createJedis()) {
523            j.lpush(&quot;foo&quot;, &quot;a&quot;);
524          }
525        }
526      }).start();
527      String element = jedis.brpoplpush(&quot;foo&quot;, &quot;bar&quot;, 0);
528      assertEquals(&quot;a&quot;, element);
529      assertEquals(1, jedis.llen(&quot;bar&quot;));
530      assertEquals(&quot;a&quot;, jedis.lrange(&quot;bar&quot;, 0, -1).get(0));
531      new Thread(new Runnable() {
532        @Override
533        public void run() {
534          try {
535            Thread.sleep(100);
536          } catch (InterruptedException e) {
537            logger.error(&quot;&quot;, e);
538          }
539          try (Jedis j = createJedis()) {
540            j.lpush(bfoo, bA);
541          }
542        }
543      }).start();
544      byte[] belement = jedis.brpoplpush(bfoo, bbar, 0);
545      assertArrayEquals(bA, belement);
546      assertEquals(1, jedis.llen(&quot;bar&quot;));
547      assertArrayEquals(bA, jedis.lrange(bbar, 0, -1).get(0));
548    }
549    @Test
550    public void lpos() {
551      jedis.rpush(&quot;foo&quot;, &quot;a&quot;);
552      jedis.rpush(&quot;foo&quot;, &quot;b&quot;);
553      jedis.rpush(&quot;foo&quot;, &quot;c&quot;);
554      Long pos = jedis.lpos(&quot;foo&quot;, &quot;b&quot;);
555      assertEquals(1, pos.intValue());
556      pos = jedis.lpos(&quot;foo&quot;, &quot;d&quot;);
557      assertNull(pos);
558      jedis.rpush(&quot;foo&quot;, &quot;a&quot;);
559      jedis.rpush(&quot;foo&quot;, &quot;b&quot;);
560      jedis.rpush(&quot;foo&quot;, &quot;b&quot;);
561      pos = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams());
562      assertEquals(1, pos.intValue());
563      pos = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(3));
564      assertEquals(5, pos.intValue());
565      pos = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(-2));
566      assertEquals(4, pos.intValue());
567      pos = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(-5));
568      assertNull(pos);
569      pos = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(1).maxlen(2));
570      assertEquals(1, pos.intValue());
571      pos = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(2).maxlen(2));
572      assertNull(pos);
573      pos = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(-2).maxlen(2));
574      assertEquals(4, pos.intValue());
575      List&lt;Long&gt; expected = new ArrayList&lt;Long&gt;();
576      expected.add(1L);
577      expected.add(4L);
578      expected.add(5L);
579      List&lt;Long&gt; posList = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams(), 2);
580      assertEquals(expected.subList(0, 2), posList);
581      posList = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams(), 0);
582      assertEquals(expected, posList);
583      posList = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(2), 0);
584      assertEquals(expected.subList(1, 3), posList);
585      posList = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(2).maxlen(5), 0);
586      assertEquals(expected.subList(1, 2), posList);
587      Collections.reverse(expected);
588      posList = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(-2), 0);
589      assertEquals(expected.subList(1, 3), posList);
590      posList = jedis.lpos(&quot;foo&quot;, &quot;b&quot;, LPosParams.lPosParams().rank(-1).maxlen(5), 2);
591      assertEquals(expected.subList(0, 2), posList);
592      jedis.rpush(bfoo, bA);
593      jedis.rpush(bfoo, bB);
594      jedis.rpush(bfoo, bC);
595      pos = jedis.lpos(bfoo, bB);
596      assertEquals(1, pos.intValue());
597      pos = jedis.lpos(bfoo, b3);
598      assertNull(pos);
599      jedis.rpush(bfoo, bA);
600      jedis.rpush(bfoo, bB);
601      jedis.rpush(bfoo, bA);
602      pos = jedis.lpos(bfoo, bB, LPosParams.lPosParams().rank(2));
603      assertEquals(4, pos.intValue());
604      pos = jedis.lpos(bfoo, bB, LPosParams.lPosParams().rank(-2).maxlen(5));
605      assertEquals(1, pos.intValue());
606      expected.clear();
607      expected.add(0L);
608      expected.add(3L);
609      expected.add(5L);
610      posList = jedis.lpos(bfoo, bA, LPosParams.lPosParams().maxlen(6), 0);
611      assertEquals(expected, posList);
612      posList = jedis.lpos(bfoo, bA, LPosParams.lPosParams().maxlen(6).rank(2), 1);
613      assertEquals(expected.subList(1, 2), posList);
614    }
615    @Test
616    public void lmove() {
617      jedis.rpush(&quot;foo&quot;, &quot;bar1&quot;, &quot;bar2&quot;, &quot;bar3&quot;);
618      assertEquals(&quot;bar3&quot;, jedis.lmove(&quot;foo&quot;, &quot;bar&quot;, ListDirection.RIGHT, ListDirection.LEFT));
619      assertEquals(Collections.singletonList(&quot;bar3&quot;), jedis.lrange(&quot;bar&quot;, 0, -1));
620      assertEquals(Arrays.asList(&quot;bar1&quot;, &quot;bar2&quot;), jedis.lrange(&quot;foo&quot;, 0, -1));
621      jedis.rpush(bfoo, b1, b2, b3);
622      assertArrayEquals(b3, jedis.lmove(bfoo, bbar, ListDirection.RIGHT, ListDirection.LEFT));
623      assertByteArrayListEquals(Collections.singletonList(b3), jedis.lrange(bbar, 0, -1));
624      assertByteArrayListEquals(Arrays.asList(b1, b2), jedis.lrange(bfoo, 0, -1));
625    }
626    @Test
627    public void blmove() {
628      new Thread(() -&gt; {
629        try {
630          Thread.sleep(100);
631        } catch (InterruptedException e) {
632          logger.error(&quot;&quot;, e);
633        }
634        try (Jedis j = createJedis()) {
635          j.rpush(&quot;foo&quot;, &quot;bar1&quot;, &quot;bar2&quot;, &quot;bar3&quot;);
636        }
637      }).start();
638      assertEquals(&quot;bar3&quot;, jedis.blmove(&quot;foo&quot;, &quot;bar&quot;, ListDirection.RIGHT, ListDirection.LEFT, 0));
639      assertEquals(Collections.singletonList(&quot;bar3&quot;), jedis.lrange(&quot;bar&quot;, 0, -1));
640      assertEquals(Arrays.asList(&quot;bar1&quot;, &quot;bar2&quot;), jedis.lrange(&quot;foo&quot;, 0, -1));
641      new Thread(() -&gt; {
642        try {
643          Thread.sleep(100);
644        } catch (InterruptedException e) {
645          logger.error(&quot;&quot;, e);
646        }
647        try (Jedis j = createJedis()) {
648          j.rpush(bfoo, b1, b2, b3);
649        }
650      }).start();
651      assertArrayEquals(b3, jedis.blmove(bfoo, bbar, ListDirection.RIGHT, ListDirection.LEFT, 0));
652      assertByteArrayListEquals(Collections.singletonList(b3), jedis.lrange(bbar, 0, -1));
653      assertByteArrayListEquals(Arrays.asList(b1, b2), jedis.lrange(bfoo, 0, -1));
654    }
655    @Test
656    public void lmpop() {
657      String mylist1 = &quot;mylist1&quot;;
658      String mylist2 = &quot;mylist2&quot;;
659      jedis.lpush(mylist1, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;, &quot;five&quot;);
660      jedis.lpush(mylist2, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;, &quot;five&quot;);
661      KeyValue&lt;String, List&lt;String&gt;&gt; elements = jedis.lmpop(ListDirection.LEFT, mylist1, mylist2);
662      assertEquals(mylist1, elements.getKey());
663      assertEquals(1, elements.getValue().size());
664      elements = jedis.lmpop(ListDirection.LEFT, 5, mylist1, mylist2);
665      assertEquals(mylist1, elements.getKey());
666      assertEquals(4, elements.getValue().size());
667      elements = jedis.lmpop(ListDirection.RIGHT, 100, mylist1, mylist2);
668      assertEquals(mylist2, elements.getKey());
669      assertEquals(5, elements.getValue().size());
670      elements = jedis.lmpop(ListDirection.RIGHT, mylist1, mylist2);
671      assertNull(elements);
672    }
673    @Test
674    public void blmpopSimple() {
675      String mylist1 = &quot;mylist1&quot;;
676      String mylist2 = &quot;mylist2&quot;;
677      jedis.lpush(mylist1, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;, &quot;five&quot;);
678      jedis.lpush(mylist2, &quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;, &quot;five&quot;);
679      KeyValue&lt;String, List&lt;String&gt;&gt; elements = jedis.blmpop(1L, ListDirection.LEFT, mylist1, mylist2);
680      assertEquals(mylist1, elements.getKey());
681      assertEquals(1, elements.getValue().size());
682      elements = jedis.blmpop(1L, ListDirection.LEFT, 5, mylist1, mylist2);
683      assertEquals(mylist1, elements.getKey());
684      assertEquals(4, elements.getValue().size());
685      elements = jedis.blmpop(1L, ListDirection.RIGHT, 100, mylist1, mylist2);
686      assertEquals(mylist2, elements.getKey());
687      assertEquals(5, elements.getValue().size());
688      elements = jedis.blmpop(1L, ListDirection.RIGHT, mylist1, mylist2);
689      assertNull(elements);
690    }
691  }
</code></pre>
        </div>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-HashesCommandsTest.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.jedis;
2  import static org.junit.Assert.assertArrayEquals;
3  import static org.junit.Assert.assertEquals;
4  import static org.junit.Assert.assertFalse;
5  import static org.junit.Assert.assertTrue;
6  import static org.junit.Assert.assertNull;
7  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START;
8  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START_BINARY;
9  import java.util.ArrayList;
10  import java.util.Collections;
11  import java.util.HashMap;
12  import java.util.LinkedHashMap;
13  import java.util.LinkedHashSet;
14  import java.util.List;
15  import java.util.Map;
16  import java.util.Set;
17  import org.junit.Test;
18  import redis.clients.jedis.Pipeline;
19  import redis.clients.jedis.Response;
20  import redis.clients.jedis.params.ScanParams;
21  import redis.clients.jedis.resps.ScanResult;
22  import redis.clients.jedis.util.AssertUtil;
23  import redis.clients.jedis.util.JedisByteHashMap;
24  public class HashesCommandsTest extends JedisCommandsTestBase {
25    final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
26    final byte[] bbar = { 0x05, 0x06, 0x07, 0x08 };
27    final byte[] bcar = { 0x09, 0x0A, 0x0B, 0x0C };
28    final byte[] bbar1 = { 0x05, 0x06, 0x07, 0x08, 0x0A };
29    final byte[] bbar2 = { 0x05, 0x06, 0x07, 0x08, 0x0B };
30    final byte[] bbar3 = { 0x05, 0x06, 0x07, 0x08, 0x0C };
31    final byte[] bbarstar = { 0x05, 0x06, 0x07, 0x08, &#x27;*&#x27; };
32    @Test
33    public void hset() {
34      assertEquals(1, jedis.hset(&quot;foo&quot;, &quot;bar&quot;, &quot;car&quot;));
35      assertEquals(0, jedis.hset(&quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;));
36      assertEquals(1, jedis.hset(bfoo, bbar, bcar));
37      assertEquals(0, jedis.hset(bfoo, bbar, bfoo));
38    }
39    @Test
40    public void hget() {
41      jedis.hset(&quot;foo&quot;, &quot;bar&quot;, &quot;car&quot;);
42      assertNull(jedis.hget(&quot;bar&quot;, &quot;foo&quot;));
43      assertNull(jedis.hget(&quot;foo&quot;, &quot;car&quot;));
44      assertEquals(&quot;car&quot;, jedis.hget(&quot;foo&quot;, &quot;bar&quot;));
45      jedis.hset(bfoo, bbar, bcar);
46      assertNull(jedis.hget(bbar, bfoo));
47      assertNull(jedis.hget(bfoo, bcar));
48      assertArrayEquals(bcar, jedis.hget(bfoo, bbar));
49    }
50    @Test
51    public void hsetnx() {
52      assertEquals(1, jedis.hsetnx(&quot;foo&quot;, &quot;bar&quot;, &quot;car&quot;));
53      assertEquals(&quot;car&quot;, jedis.hget(&quot;foo&quot;, &quot;bar&quot;));
54      assertEquals(0, jedis.hsetnx(&quot;foo&quot;, &quot;bar&quot;, &quot;foo&quot;));
55      assertEquals(&quot;car&quot;, jedis.hget(&quot;foo&quot;, &quot;bar&quot;));
56      assertEquals(1, jedis.hsetnx(&quot;foo&quot;, &quot;car&quot;, &quot;bar&quot;));
57      assertEquals(&quot;bar&quot;, jedis.hget(&quot;foo&quot;, &quot;car&quot;));
58      assertEquals(1, jedis.hsetnx(bfoo, bbar, bcar));
59      assertArrayEquals(bcar, jedis.hget(bfoo, bbar));
60      assertEquals(0, jedis.hsetnx(bfoo, bbar, bfoo));
61      assertArrayEquals(bcar, jedis.hget(bfoo, bbar));
62      assertEquals(1, jedis.hsetnx(bfoo, bcar, bbar));
63      assertArrayEquals(bbar, jedis.hget(bfoo, bcar));
64    }
65    @Test
66    public void hmset() {
67      Map&lt;String, String&gt; hash = new HashMap&lt;String, String&gt;();
68      hash.put(&quot;bar&quot;, &quot;car&quot;);
69      hash.put(&quot;car&quot;, &quot;bar&quot;);
70      assertEquals(&quot;OK&quot;, jedis.hmset(&quot;foo&quot;, hash));
71      assertEquals(&quot;car&quot;, jedis.hget(&quot;foo&quot;, &quot;bar&quot;));
72      assertEquals(&quot;bar&quot;, jedis.hget(&quot;foo&quot;, &quot;car&quot;));
73      Map&lt;byte[], byte[]&gt; bhash = new HashMap&lt;byte[], byte[]&gt;();
74      bhash.put(bbar, bcar);
75      bhash.put(bcar, bbar);
76      assertEquals(&quot;OK&quot;, jedis.hmset(bfoo, bhash));
77      assertArrayEquals(bcar, jedis.hget(bfoo, bbar));
78      assertArrayEquals(bbar, jedis.hget(bfoo, bcar));
79    }
80    @Test
81    public void hsetVariadic() {
82      Map&lt;String, String&gt; hash = new HashMap&lt;String, String&gt;();
83      hash.put(&quot;bar&quot;, &quot;car&quot;);
84      hash.put(&quot;car&quot;, &quot;bar&quot;);
85      assertEquals(2, jedis.hset(&quot;foo&quot;, hash));
86      assertEquals(&quot;car&quot;, jedis.hget(&quot;foo&quot;, &quot;bar&quot;));
87      assertEquals(&quot;bar&quot;, jedis.hget(&quot;foo&quot;, &quot;car&quot;));
88      Map&lt;byte[], byte[]&gt; bhash = new HashMap&lt;byte[], byte[]&gt;();
89      bhash.put(bbar, bcar);
90      bhash.put(bcar, bbar);
91      assertEquals(2, jedis.hset(bfoo, bhash));
92      assertArrayEquals(bcar, jedis.hget(bfoo, bbar));
93      assertArrayEquals(bbar, jedis.hget(bfoo, bcar));
94    }
95    @Test
96    public void hmget() {
97      Map&lt;String, String&gt; hash = new HashMap&lt;String, String&gt;();
98      hash.put(&quot;bar&quot;, &quot;car&quot;);
99      hash.put(&quot;car&quot;, &quot;bar&quot;);
100      jedis.hmset(&quot;foo&quot;, hash);
101      List&lt;String&gt; values = jedis.hmget(&quot;foo&quot;, &quot;bar&quot;, &quot;car&quot;, &quot;foo&quot;);
102      List&lt;String&gt; expected = new ArrayList&lt;String&gt;();
103      expected.add(&quot;car&quot;);
104      expected.add(&quot;bar&quot;);
105      expected.add(null);
106      assertEquals(expected, values);
107      Map&lt;byte[], byte[]&gt; bhash = new HashMap&lt;byte[], byte[]&gt;();
108      bhash.put(bbar, bcar);
109      bhash.put(bcar, bbar);
110      jedis.hmset(bfoo, bhash);
111      List&lt;byte[]&gt; bvalues = jedis.hmget(bfoo, bbar, bcar, bfoo);
112      List&lt;byte[]&gt; bexpected = new ArrayList&lt;byte[]&gt;();
113      bexpected.add(bcar);
114      bexpected.add(bbar);
115      bexpected.add(null);
116      AssertUtil.assertByteArrayListEquals(bexpected, bvalues);
117    }
118    @Test
119    public void hincrBy() {
120      assertEquals(1, jedis.hincrBy(&quot;foo&quot;, &quot;bar&quot;, 1));
121      assertEquals(0, jedis.hincrBy(&quot;foo&quot;, &quot;bar&quot;, -1));
122      assertEquals(-10, jedis.hincrBy(&quot;foo&quot;, &quot;bar&quot;, -10));
123      assertEquals(1, jedis.hincrBy(bfoo, bbar, 1));
124      assertEquals(0, jedis.hincrBy(bfoo, bbar, -1));
125      assertEquals(-10, jedis.hincrBy(bfoo, bbar, -10));
126    }
127    @Test
128    public void hincrByFloat() {
129      assertEquals(1.5d, jedis.hincrByFloat(&quot;foo&quot;, &quot;bar&quot;, 1.5d), 0);
130      assertEquals(0d, jedis.hincrByFloat(&quot;foo&quot;, &quot;bar&quot;, -1.5d), 0);
131      assertEquals(-10.7d, jedis.hincrByFloat(&quot;foo&quot;, &quot;bar&quot;, -10.7d), 0);
132      assertEquals(1.5d, jedis.hincrByFloat(bfoo, bbar, 1.5d), 0d);
133      assertEquals(0d, jedis.hincrByFloat(bfoo, bbar, -1.5d), 0d);
134      assertEquals(-10.7d, jedis.hincrByFloat(bfoo, bbar, -10.7d), 0d);
135    }
136    @Test
137    public void hexists() {
138      Map&lt;String, String&gt; hash = new HashMap&lt;String, String&gt;();
139      hash.put(&quot;bar&quot;, &quot;car&quot;);
140      hash.put(&quot;car&quot;, &quot;bar&quot;);
141      jedis.hmset(&quot;foo&quot;, hash);
142      assertFalse(jedis.hexists(&quot;bar&quot;, &quot;foo&quot;));
143      assertFalse(jedis.hexists(&quot;foo&quot;, &quot;foo&quot;));
144      assertTrue(jedis.hexists(&quot;foo&quot;, &quot;bar&quot;));
145      Map&lt;byte[], byte[]&gt; bhash = new HashMap&lt;byte[], byte[]&gt;();
146      bhash.put(bbar, bcar);
147      bhash.put(bcar, bbar);
148      jedis.hmset(bfoo, bhash);
149      assertFalse(jedis.hexists(bbar, bfoo));
150      assertFalse(jedis.hexists(bfoo, bfoo));
151      assertTrue(jedis.hexists(bfoo, bbar));
152    }
153    @Test
154    public void hdel() {
155      Map&lt;String, String&gt; hash = new HashMap&lt;&gt;();
156      hash.put(&quot;bar&quot;, &quot;car&quot;);
157      hash.put(&quot;car&quot;, &quot;bar&quot;);
158      jedis.hmset(&quot;foo&quot;, hash);
159      assertEquals(0, jedis.hdel(&quot;bar&quot;, &quot;foo&quot;));
160      assertEquals(0, jedis.hdel(&quot;foo&quot;, &quot;foo&quot;));
161      assertEquals(1, jedis.hdel(&quot;foo&quot;, &quot;bar&quot;));
162      assertNull(jedis.hget(&quot;foo&quot;, &quot;bar&quot;));
163      Map&lt;byte[], byte[]&gt; bhash = new HashMap&lt;&gt;();
164      bhash.put(bbar, bcar);
165      bhash.put(bcar, bbar);
166      jedis.hmset(bfoo, bhash);
167      assertEquals(0, jedis.hdel(bbar, bfoo));
168      assertEquals(0, jedis.hdel(bfoo, bfoo));
169      assertEquals(1, jedis.hdel(bfoo, bbar));
170      assertNull(jedis.hget(bfoo, bbar));
171      jedis.hmset(&quot;foo&quot;, hash);
172      assertEquals(2, jedis.hdel(&quot;foo&quot;, &quot;bar&quot;, &quot;car&quot;, &quot;dne&quot;));
173      jedis.hmset(bfoo, bhash);
174      assertEquals(2, jedis.hdel(bfoo, bbar, bcar, bbar1));
175    }
176    @Test
177    public void hlen() {
178      Map&lt;String, String&gt; hash = new HashMap&lt;String, String&gt;();
179      hash.put(&quot;bar&quot;, &quot;car&quot;);
180      hash.put(&quot;car&quot;, &quot;bar&quot;);
181      jedis.hmset(&quot;foo&quot;, hash);
182      assertEquals(0, jedis.hlen(&quot;bar&quot;));
183      assertEquals(2, jedis.hlen(&quot;foo&quot;));
184      Map&lt;byte[], byte[]&gt; bhash = new HashMap&lt;byte[], byte[]&gt;();
185      bhash.put(bbar, bcar);
186      bhash.put(bcar, bbar);
187      jedis.hmset(bfoo, bhash);
188      assertEquals(0, jedis.hlen(bbar));
<span onclick='openModal()' class='match'>189      assertEquals(2, jedis.hlen(bfoo));
190    }
191    @Test
192    public void hkeys() {
</span>193      Map&lt;String, String&gt; hash = new LinkedHashMap&lt;String, String&gt;();
194      hash.put(&quot;bar&quot;, &quot;car&quot;);
195      hash.put(&quot;car&quot;, &quot;bar&quot;);
196      jedis.hmset(&quot;foo&quot;, hash);
197      Set&lt;String&gt; keys = jedis.hkeys(&quot;foo&quot;);
198      Set&lt;String&gt; expected = new LinkedHashSet&lt;String&gt;();
199      expected.add(&quot;bar&quot;);
200      expected.add(&quot;car&quot;);
201      assertEquals(expected, keys);
202      Map&lt;byte[], byte[]&gt; bhash = new LinkedHashMap&lt;byte[], byte[]&gt;();
203      bhash.put(bbar, bcar);
204      bhash.put(bcar, bbar);
205      jedis.hmset(bfoo, bhash);
206      Set&lt;byte[]&gt; bkeys = jedis.hkeys(bfoo);
207      Set&lt;byte[]&gt; bexpected = new LinkedHashSet&lt;byte[]&gt;();
208      bexpected.add(bbar);
209      bexpected.add(bcar);
210      AssertUtil.assertByteArraySetEquals(bexpected, bkeys);
211    }
212    @Test
213    public void hvals() {
214      Map&lt;String, String&gt; hash = new LinkedHashMap&lt;String, String&gt;();
215      hash.put(&quot;bar&quot;, &quot;car&quot;);
216      hash.put(&quot;car&quot;, &quot;bar&quot;);
217      jedis.hmset(&quot;foo&quot;, hash);
218      List&lt;String&gt; vals = jedis.hvals(&quot;foo&quot;);
219      assertEquals(2, vals.size());
220      AssertUtil.assertCollectionContains(vals, &quot;bar&quot;);
221      AssertUtil.assertCollectionContains(vals, &quot;car&quot;);
222      Map&lt;byte[], byte[]&gt; bhash = new LinkedHashMap&lt;byte[], byte[]&gt;();
223      bhash.put(bbar, bcar);
224      bhash.put(bcar, bbar);
225      jedis.hmset(bfoo, bhash);
226      List&lt;byte[]&gt; bvals = jedis.hvals(bfoo);
227      assertEquals(2, bvals.size());
228      AssertUtil.assertByteArrayCollectionContains(bvals, bbar);
229      AssertUtil.assertByteArrayCollectionContains(bvals, bcar);
230    }
231    @Test
232    public void hgetAll() {
233      Map&lt;String, String&gt; h = new HashMap&lt;String, String&gt;();
234      h.put(&quot;bar&quot;, &quot;car&quot;);
235      h.put(&quot;car&quot;, &quot;bar&quot;);
236      jedis.hmset(&quot;foo&quot;, h);
237      Map&lt;String, String&gt; hash = jedis.hgetAll(&quot;foo&quot;);
238      assertEquals(2, hash.size());
239      assertEquals(&quot;car&quot;, hash.get(&quot;bar&quot;));
240      assertEquals(&quot;bar&quot;, hash.get(&quot;car&quot;));
241      Map&lt;byte[], byte[]&gt; bh = new HashMap&lt;byte[], byte[]&gt;();
242      bh.put(bbar, bcar);
243      bh.put(bcar, bbar);
244      jedis.hmset(bfoo, bh);
245      Map&lt;byte[], byte[]&gt; bhash = jedis.hgetAll(bfoo);
246      assertEquals(2, bhash.size());
247      assertArrayEquals(bcar, bhash.get(bbar));
248      assertArrayEquals(bbar, bhash.get(bcar));
249    }
250    @Test
251    public void hgetAllPipeline() {
252      Map&lt;byte[], byte[]&gt; bh = new HashMap&lt;byte[], byte[]&gt;();
253      bh.put(bbar, bcar);
254      bh.put(bcar, bbar);
255      jedis.hmset(bfoo, bh);
256      Pipeline pipeline = jedis.pipelined();
257      Response&lt;Map&lt;byte[], byte[]&gt;&gt; bhashResponse = pipeline.hgetAll(bfoo);
258      pipeline.sync();
259      Map&lt;byte[], byte[]&gt; bhash = bhashResponse.get();
260      assertEquals(2, bhash.size());
261      assertArrayEquals(bcar, bhash.get(bbar));
262      assertArrayEquals(bbar, bhash.get(bcar));
263    }
264    @Test
265    public void hscan() {
266      jedis.hset(&quot;foo&quot;, &quot;b&quot;, &quot;b&quot;);
267      jedis.hset(&quot;foo&quot;, &quot;a&quot;, &quot;a&quot;);
268      ScanResult&lt;Map.Entry&lt;String, String&gt;&gt; result = jedis.hscan(&quot;foo&quot;, SCAN_POINTER_START);
269      assertEquals(SCAN_POINTER_START, result.getCursor());
270      assertFalse(result.getResult().isEmpty());
271      jedis.hset(bfoo, bbar, bcar);
272      ScanResult&lt;Map.Entry&lt;byte[], byte[]&gt;&gt; bResult = jedis.hscan(bfoo, SCAN_POINTER_START_BINARY);
273      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
274      assertFalse(bResult.getResult().isEmpty());
275    }
276    @Test
277    public void hscanMatch() {
278      ScanParams params = new ScanParams();
279      params.match(&quot;a*&quot;);
280      jedis.hset(&quot;foo&quot;, &quot;b&quot;, &quot;b&quot;);
281      jedis.hset(&quot;foo&quot;, &quot;a&quot;, &quot;a&quot;);
282      jedis.hset(&quot;foo&quot;, &quot;aa&quot;, &quot;aa&quot;);
283      ScanResult&lt;Map.Entry&lt;String, String&gt;&gt; result = jedis.hscan(&quot;foo&quot;, SCAN_POINTER_START, params);
284      assertEquals(SCAN_POINTER_START, result.getCursor());
285      assertFalse(result.getResult().isEmpty());
286      params = new ScanParams();
287      params.match(bbarstar);
288      jedis.hset(bfoo, bbar, bcar);
289      jedis.hset(bfoo, bbar1, bcar);
290      jedis.hset(bfoo, bbar2, bcar);
291      jedis.hset(bfoo, bbar3, bcar);
292      ScanResult&lt;Map.Entry&lt;byte[], byte[]&gt;&gt; bResult = jedis.hscan(bfoo, SCAN_POINTER_START_BINARY,
293        params);
294      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
295      assertFalse(bResult.getResult().isEmpty());
296    }
297    @Test
298    public void hscanCount() {
299      ScanParams params = new ScanParams();
300      params.count(2);
301      for (int i = 0; i &lt; 10; i++) {
302        jedis.hset(&quot;foo&quot;, &quot;a&quot; + i, &quot;a&quot; + i);
303      }
304      ScanResult&lt;Map.Entry&lt;String, String&gt;&gt; result = jedis.hscan(&quot;foo&quot;, SCAN_POINTER_START, params);
305      assertFalse(result.getResult().isEmpty());
306      params = new ScanParams();
307      params.count(2);
308      jedis.hset(bfoo, bbar, bcar);
309      jedis.hset(bfoo, bbar1, bcar);
310      jedis.hset(bfoo, bbar2, bcar);
311      jedis.hset(bfoo, bbar3, bcar);
312      ScanResult&lt;Map.Entry&lt;byte[], byte[]&gt;&gt; bResult = jedis.hscan(bfoo, SCAN_POINTER_START_BINARY,
313        params);
314      assertFalse(bResult.getResult().isEmpty());
315    }
316    @Test
317    public void testHstrLen_EmptyHash() {
318      Long response = jedis.hstrlen(&quot;myhash&quot;, &quot;k1&quot;);
319      assertEquals(0l, response.longValue());
320    }
321    @Test
322    public void testHstrLen() {
323      Map&lt;String, String&gt; values = new HashMap&lt;&gt;();
324      values.put(&quot;key&quot;, &quot;value&quot;);
325      jedis.hmset(&quot;myhash&quot;, values);
326      Long response = jedis.hstrlen(&quot;myhash&quot;, &quot;key&quot;);
327      assertEquals(5l, response.longValue());
328    }
329    @Test
330    public void testBinaryHstrLen() {
331      Map&lt;byte[], byte[]&gt; values = new HashMap&lt;&gt;();
332      values.put(bbar, bcar);
333      jedis.hmset(bfoo, values);
334      Long response = jedis.hstrlen(bfoo, bbar);
335      assertEquals(4l, response.longValue());
336    }
337    @Test
338    public void hrandfield() {
339      assertNull(jedis.hrandfield(&quot;foo&quot;));
340      assertEquals(Collections.emptyList(), jedis.hrandfield(&quot;foo&quot;, 1));
341      assertEquals(Collections.emptyList(), jedis.hrandfieldWithValues(&quot;foo&quot;, 1));
342      assertEquals(Collections.emptyList(), jedis.hrandfieldWithValues(&quot;foo&quot;, -1));
343      Map&lt;String, String&gt; hash = new LinkedHashMap&lt;&gt;();
344      hash.put(&quot;bar&quot;, &quot;bar&quot;);
345      hash.put(&quot;car&quot;, &quot;car&quot;);
346      hash.put(&quot;bar1&quot;, &quot;bar1&quot;);
347      jedis.hset(&quot;foo&quot;, hash);
348      assertTrue(hash.containsKey(jedis.hrandfield(&quot;foo&quot;)));
349      assertEquals(2, jedis.hrandfield(&quot;foo&quot;, 2).size());
350      List&lt;Map.Entry&lt;String, String&gt;&gt; actual = jedis.hrandfieldWithValues(&quot;foo&quot;, 2);
351      assertEquals(2, actual.size());
352      actual.forEach(e -&gt; assertEquals(hash.get(e.getKey()), e.getValue()));
353      actual = jedis.hrandfieldWithValues(&quot;foo&quot;, 5);
354      assertEquals(3, actual.size());
355      actual.forEach(e -&gt; assertEquals(hash.get(e.getKey()), e.getValue()));
356      actual = jedis.hrandfieldWithValues(&quot;foo&quot;, -5);
357      assertEquals(5, actual.size());
358      actual.forEach(e -&gt; assertEquals(hash.get(e.getKey()), e.getValue()));
359      assertNull(jedis.hrandfield(bfoo));
360      assertEquals(Collections.emptyList(), jedis.hrandfield(bfoo, 1));
361      assertEquals(Collections.emptyList(), jedis.hrandfieldWithValues(bfoo, 1));
362      assertEquals(Collections.emptyList(), jedis.hrandfieldWithValues(bfoo, -1));
363      Map&lt;byte[], byte[]&gt; bhash = new JedisByteHashMap();
364      bhash.put(bbar, bbar);
365      bhash.put(bcar, bcar);
366      bhash.put(bbar1, bbar1);
367      jedis.hset(bfoo, bhash);
368      assertTrue(bhash.containsKey(jedis.hrandfield(bfoo)));
369      assertEquals(2, jedis.hrandfield(bfoo, 2).size());
370      List&lt;Map.Entry&lt;byte[], byte[]&gt;&gt; bactual = jedis.hrandfieldWithValues(bfoo, 2);
371      assertEquals(2, bactual.size());
372      bactual.forEach(e -&gt; assertArrayEquals(bhash.get(e.getKey()), e.getValue()));
373      bactual = jedis.hrandfieldWithValues(bfoo, 5);
374      assertEquals(3, bactual.size());
375      bactual.forEach(e -&gt; assertArrayEquals(bhash.get(e.getKey()), e.getValue()));
376      bactual = jedis.hrandfieldWithValues(bfoo, -5);
377      assertEquals(5, bactual.size());
378      bactual.forEach(e -&gt; assertArrayEquals(bhash.get(e.getKey()), e.getValue()));
379    }
380  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ListCommandsTest.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-HashesCommandsTest.java</div>
                </div>
                <div class="column column_space"><pre><code>64      assertEquals(2, jedis.llen(bfoo));
65    }
66    @Test
67    public void llenNotOnList() {
</pre></code></div>
                <div class="column column_space"><pre><code>189      assertEquals(2, jedis.hlen(bfoo));
190    }
191    @Test
192    public void hkeys() {
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    