
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 21, <button onclick='openModal()' class='match'>CODE CLONE</button></h2>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ControlCommandsTest.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.jedis;
2  import static org.hamcrest.MatcherAssert.assertThat;
3  import static org.hamcrest.Matchers.greaterThan;
4  import static org.junit.Assert.assertArrayEquals;
5  import static org.junit.Assert.assertEquals;
6  import static org.junit.Assert.assertFalse;
7  import static org.junit.Assert.assertNotNull;
8  import static org.junit.Assert.assertNull;
9  import static org.junit.Assert.assertThrows;
10  import static org.junit.Assert.assertTrue;
11  import java.util.HashSet;
12  import java.util.List;
13  import java.util.Map;
14  import java.util.Set;
15  import java.util.concurrent.Callable;
16  import java.util.concurrent.ExecutionException;
17  import java.util.concurrent.ExecutorService;
18  import java.util.concurrent.Executors;
19  import java.util.concurrent.Future;
20  import java.util.concurrent.TimeUnit;
21  import org.hamcrest.MatcherAssert;
22  import org.hamcrest.Matchers;
23  import org.junit.Test;
24  import redis.clients.jedis.DefaultJedisClientConfig;
25  import redis.clients.jedis.Jedis;
26  import redis.clients.jedis.JedisMonitor;
27  import redis.clients.jedis.Protocol;
28  import redis.clients.jedis.args.ClientPauseMode;
29  import redis.clients.jedis.exceptions.JedisDataException;
30  import redis.clients.jedis.HostAndPorts;
31  import redis.clients.jedis.params.CommandListFilterByParams;
32  import redis.clients.jedis.params.LolwutParams;
33  import redis.clients.jedis.resps.CommandDocument;
34  import redis.clients.jedis.resps.CommandInfo;
35  import redis.clients.jedis.util.AssertUtil;
36  import redis.clients.jedis.util.KeyValue;
37  import redis.clients.jedis.util.SafeEncoder;
38  public class ControlCommandsTest extends JedisCommandsTestBase {
39    @Test
40    public void save() {
41      try {
42        String status = jedis.save();
43        assertEquals(&quot;OK&quot;, status);
44      } catch (JedisDataException e) {
45        assertTrue(&quot;ERR Background save already in progress&quot;.equalsIgnoreCase(e.getMessage()));
46      }
47    }
48    @Test
49    public void bgsave() {
50      try {
51        String status = jedis.bgsave();
52        assertEquals(&quot;Background saving started&quot;, status);
53      } catch (JedisDataException e) {
54        assertTrue(&quot;ERR Background save already in progress&quot;.equalsIgnoreCase(e.getMessage()));
55      }
56    }
57    @Test
58    public void bgsaveSchedule() {
59      Set&lt;String&gt; responses = new HashSet&lt;&gt;();
60      responses.add(&quot;OK&quot;);
61      responses.add(&quot;Background saving scheduled&quot;);
62      responses.add(&quot;Background saving started&quot;);
63      String status = jedis.bgsaveSchedule();
64      assertTrue(responses.contains(status));
65    }
66    @Test
67    public void bgrewriteaof() {
68      String scheduled = &quot;Background append only file rewriting scheduled&quot;;
69      String started = &quot;Background append only file rewriting started&quot;;
70      String status = jedis.bgrewriteaof();
71      boolean ok = status.equals(scheduled) || status.equals(started);
72      assertTrue(ok);
73    }
74    @Test
75    public void lastsave() throws InterruptedException {
76      long saved = jedis.lastsave();
77      assertTrue(saved &gt; 0);
78    }
79    @Test
80    public void info() {
81      String info = jedis.info();
82      assertNotNull(info);
83      info = jedis.info(&quot;server&quot;);
84      assertNotNull(info);
85    }
86    @Test
87    public void readonly() {
88      try {
89        jedis.readonly();
90      } catch (JedisDataException e) {
91        assertTrue(&quot;ERR This instance has cluster support disabled&quot;.equalsIgnoreCase(e.getMessage()));
92      }
93    }
94    @Test
95    public void readwrite() {
96      try {
97        jedis.readwrite();
98      } catch (JedisDataException e) {
99        assertTrue(&quot;ERR This instance has cluster support disabled&quot;.equalsIgnoreCase(e.getMessage()));
100      }
101    }
102    @Test
103    public void roleMaster() {
104      try (Jedis master = new Jedis(HostAndPorts.getRedisServers().get(0),
105          DefaultJedisClientConfig.builder().password(&quot;foobared&quot;).build())) {
106        List&lt;Object&gt; role = master.role();
107        assertEquals(&quot;master&quot;, role.get(0));
108        assertTrue(role.get(1) instanceof Long);
109        assertTrue(role.get(2) instanceof List);
110        List&lt;Object&gt; brole = master.roleBinary();
111        assertArrayEquals(&quot;master&quot;.getBytes(), (byte[]) brole.get(0));
112        assertTrue(brole.get(1) instanceof Long);
113        assertTrue(brole.get(2) instanceof List);
114      }
115    }
116    @Test
117    public void roleSlave() {
118      try (Jedis slave = new Jedis(HostAndPorts.getRedisServers().get(4),
119          DefaultJedisClientConfig.builder().password(&quot;foobared&quot;).build())) {
120        List&lt;Object&gt; role = slave.role();
121        assertEquals(&quot;slave&quot;, role.get(0));
122        assertEquals((long) HostAndPorts.getRedisServers().get(0).getPort(), role.get(2));
123        assertEquals(&quot;connected&quot;, role.get(3));
124        assertTrue(role.get(4) instanceof Long);
125        List&lt;Object&gt; brole = slave.roleBinary();
126        assertArrayEquals(&quot;slave&quot;.getBytes(), (byte[]) brole.get(0));
127        assertEquals((long) HostAndPorts.getRedisServers().get(0).getPort(), brole.get(2));
<span onclick='openModal()' class='match'>128        assertArrayEquals(&quot;connected&quot;.getBytes(), (byte[]) brole.get(3));
129        assertTrue(brole.get(4) instanceof Long);
</span>130      }
131    }
132    @Test
133    public void roleSentinel() {
134      try (Jedis sentinel = new Jedis(HostAndPorts.getSentinelServers().get(0))) {
135        List&lt;Object&gt; role = sentinel.role();
136        assertEquals(&quot;sentinel&quot;, role.get(0));
137        assertTrue(role.get(1) instanceof List);
138        AssertUtil.assertCollectionContains((List) role.get(1), &quot;mymaster&quot;);
139        List&lt;Object&gt; brole = sentinel.roleBinary();
140        assertArrayEquals(&quot;sentinel&quot;.getBytes(), (byte[]) brole.get(0));
141        assertTrue(brole.get(1) instanceof List);
142        AssertUtil.assertByteArrayCollectionContains((List) brole.get(1), &quot;mymaster&quot;.getBytes());
143      }
144    }
145    @Test
146    public void monitor() {
147      new Thread(new Runnable() {
148        @Override
149        public void run() {
150          try {
151            Thread.sleep(100);
152          } catch (InterruptedException e) {
153          }
154          Jedis j = new Jedis();
155          j.auth(&quot;foobared&quot;);
156          for (int i = 0; i &lt; 5; i++) {
157            j.incr(&quot;foobared&quot;);
158          }
159          j.disconnect();
160        }
161      }).start();
162      jedis.monitor(new JedisMonitor() {
163        private int count = 0;
164        @Override
165        public void onCommand(String command) {
166          if (command.contains(&quot;INCR&quot;)) {
167            count++;
168          }
169          if (count == 5) {
170            client.disconnect();
171          }
172        }
173      });
174    }
175    @Test
176    public void configGet() {
177      Map&lt;String, String&gt; info = jedis.configGet(&quot;m*&quot;);
178      assertNotNull(info);
179      assertFalse(info.isEmpty());
180      Map&lt;byte[], byte[]&gt; infoBinary = jedis.configGet(&quot;m*&quot;.getBytes());
181      assertNotNull(infoBinary);
182      assertFalse(infoBinary.isEmpty());
183    }
184    @Test
185    public void configSet() {
186      Map&lt;String, String&gt; info = jedis.configGet(&quot;maxmemory&quot;);
187      String memory = info.get(&quot;maxmemory&quot;);
188      assertNotNull(memory);
189      assertEquals(&quot;OK&quot;, jedis.configSet(&quot;maxmemory&quot;, &quot;200&quot;));
190      assertEquals(&quot;OK&quot;, jedis.configSet(&quot;maxmemory&quot;, memory));
191    }
192    @Test
193    public void configSetBinary() {
194      byte[] maxmemory = SafeEncoder.encode(&quot;maxmemory&quot;);
195      Map&lt;byte[], byte[]&gt; info = jedis.configGet(maxmemory);
196      byte[] memory = info.get(maxmemory);
197      assertNotNull(memory);
198      assertEquals(&quot;OK&quot;, jedis.configSet(maxmemory, Protocol.toByteArray(200)));
199      assertEquals(&quot;OK&quot;, jedis.configSet(maxmemory, memory));
200    }
201    @Test
202    public void configGetSetMulti() {
203      String[] params = new String[]{&quot;hash-max-listpack-entries&quot;, &quot;set-max-intset-entries&quot;, &quot;zset-max-listpack-entries&quot;};
204      Map&lt;String, String&gt; info = jedis.configGet(params);
205      assertEquals(3, info.size());
206      assertEquals(&quot;OK&quot;, jedis.configSet(info));
207      byte[][] bparams = new byte[][]{SafeEncoder.encode(&quot;hash-max-listpack-entries&quot;),
208        SafeEncoder.encode(&quot;set-max-intset-entries&quot;), SafeEncoder.encode(&quot;zset-max-listpack-entries&quot;)};
209      Map&lt;byte[], byte[]&gt; binfo = jedis.configGet(bparams);
210      assertEquals(3, binfo.size());
211      assertEquals(&quot;OK&quot;, jedis.configSetBinary(binfo));
212    }
213    @Test
214    public void waitReplicas() {
215      assertEquals(1, jedis.waitReplicas(1, 100));
216    }
217    @Test
218    public void waitAof() {
219      assertEquals(KeyValue.of(0L, 0L), jedis.waitAOF(0L, 0L, 100L));
220    }
221    @Test
222    public void clientPause() throws InterruptedException, ExecutionException {
223      ExecutorService executorService = Executors.newFixedThreadPool(2);
224      try (Jedis jedisToPause1 = createJedis(); Jedis jedisToPause2 = createJedis();) {
225        jedis.clientPause(1000L);
226        Future&lt;Long&gt; latency1 = executorService.submit(new Callable&lt;Long&gt;() {
227          @Override
228          public Long call() throws Exception {
229            long startMillis = System.currentTimeMillis();
230            assertEquals(&quot;PONG&quot;, jedisToPause1.ping());
231            return System.currentTimeMillis() - startMillis;
232          }
233        });
234        Future&lt;Long&gt; latency2 = executorService.submit(new Callable&lt;Long&gt;() {
235          @Override
236          public Long call() throws Exception {
237            long startMillis = System.currentTimeMillis();
238            assertEquals(&quot;PONG&quot;, jedisToPause2.ping());
239            return System.currentTimeMillis() - startMillis;
240          }
241        });
242        assertThat(latency1.get(), greaterThan(100L));
243        assertThat(latency2.get(), greaterThan(100L));
244      } finally {
245        executorService.shutdown();
246        if (!executorService.awaitTermination(2, TimeUnit.SECONDS)) {
247          executorService.shutdownNow();
248        }
249      }
250    }
251    @Test
252    public void clientPauseAll() throws InterruptedException, ExecutionException {
253      ExecutorService executorService = Executors.newFixedThreadPool(1);
254      try (Jedis jedisPause = createJedis()) {
255        jedis.clientPause(1000L, ClientPauseMode.ALL);
256        Future&lt;Long&gt; latency = executorService.submit(new Callable&lt;Long&gt;() {
257          @Override
258          public Long call() throws Exception {
259            long startMillis = System.currentTimeMillis();
260            jedisPause.get(&quot;key&quot;);
261            return System.currentTimeMillis() - startMillis;
262          }
263        });
264        assertThat(latency.get(), greaterThan(100L));
265      } finally {
266        executorService.shutdown();
267        if (!executorService.awaitTermination(5, TimeUnit.SECONDS)) {
268          executorService.shutdownNow();
269        }
270      }
271    }
272    @Test
273    public void clientPauseWrite() throws InterruptedException, ExecutionException {
274      ExecutorService executorService = Executors.newFixedThreadPool(2);
275      try (Jedis jedisRead = createJedis(); Jedis jedisWrite = createJedis();) {
276        jedis.clientPause(1000L, ClientPauseMode.WRITE);
277        Future&lt;Long&gt; latencyRead = executorService.submit(new Callable&lt;Long&gt;() {
278          @Override
279          public Long call() throws Exception {
280            long startMillis = System.currentTimeMillis();
281            jedisRead.get(&quot;key&quot;);
282            return System.currentTimeMillis() - startMillis;
283          }
284        });
285        Future&lt;Long&gt; latencyWrite = executorService.submit(new Callable&lt;Long&gt;() {
286          @Override
287          public Long call() throws Exception {
288            long startMillis = System.currentTimeMillis();
289            jedisWrite.set(&quot;key&quot;, &quot;value&quot;);
290            return System.currentTimeMillis() - startMillis;
291          }
292        });
293        assertThat(latencyRead.get(), Matchers.lessThan(100L));
294        assertThat(latencyWrite.get(), Matchers.greaterThan(100L));
295      } finally {
296        executorService.shutdown();
297        if (!executorService.awaitTermination(5, TimeUnit.SECONDS)) {
298          executorService.shutdownNow();
299        }
300      }
301    }
302    @Test
303    public void clientUnpause() {
304      assertEquals(&quot;OK&quot;, jedis.clientUnpause());
305    }
306    @Test
307    public void clientNoEvict() {
308      assertEquals(&quot;OK&quot;, jedis.clientNoEvictOn());
309      assertEquals(&quot;OK&quot;, jedis.clientNoEvictOff());
310    }
311    @Test
312    public void clientNoTouch() {
313      assertEquals(&quot;OK&quot;, jedis.clientNoTouchOn());
314      assertEquals(&quot;OK&quot;, jedis.clientNoTouchOff());
315    }
316    @Test
317    public void memoryDoctorString() {
318      String memoryInfo = jedis.memoryDoctor();
319      assertNotNull(memoryInfo);
320    }
321    @Test
322    public void memoryDoctorBinary() {
323      byte[] memoryInfo = jedis.memoryDoctorBinary();
324      assertNotNull(memoryInfo);
325    }
326    @Test
327    public void memoryUsageString() {
328      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
329      assertThat(jedis.memoryUsage(&quot;foo&quot;), greaterThan(20l));
330      jedis.lpush(&quot;foobar&quot;, &quot;fo&quot;, &quot;ba&quot;, &quot;sha&quot;);
331      assertThat(jedis.memoryUsage(&quot;foobar&quot;, 2), greaterThan(36l));
332      assertNull(jedis.memoryUsage(&quot;roo&quot;, 2));
333    }
334    @Test
335    public void memoryUsageBinary() {
336      byte[] bfoo = {0x01, 0x02, 0x03, 0x04};
337      byte[] bbar = {0x05, 0x06, 0x07, 0x08};
338      byte[] bfoobar = {0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08};
339      jedis.set(bfoo, bbar);
340      assertThat(jedis.memoryUsage(bfoo), greaterThan(20l));
341      jedis.lpush(bfoobar, new byte[]{0x01, 0x02}, new byte[]{0x05, 0x06}, new byte[]{0x00});
342      assertThat(jedis.memoryUsage(bfoobar, 2), greaterThan(40l));
343      assertNull(jedis.memoryUsage(&quot;roo&quot;, 2));
344    }
345    @Test
346    public void memoryPurge() {
347       String memoryPurge = jedis.memoryPurge();
348       assertNotNull(memoryPurge);
349    }
350    @Test
351    public void memoryStats() {
352      Map&lt;String, Object&gt; stats = jedis.memoryStats();
353      assertNotNull(stats);
354    }
355    @Test
356    public void latencyDoctor() {
357      String report = jedis.latencyDoctor();
358      assertNotNull(report);
359    }
360    @Test
361    public void commandCount() {
362      assertTrue(jedis.commandCount() &gt; 100);
363    }
364    @Test
365    public void commandDocs() {
366      Map&lt;String, CommandDocument&gt; docs = jedis.commandDocs(&quot;SORT&quot;, &quot;SET&quot;);
367      CommandDocument sortDoc = docs.get(&quot;sort&quot;);
368      assertEquals(&quot;generic&quot;, sortDoc.getGroup());
369      MatcherAssert.assertThat(sortDoc.getSummary(), Matchers.isOneOf(
370          &quot;Sort the elements in a list, set or sorted set&quot;,
371          &quot;Sorts the elements in a list, a set, or a sorted set, optionally storing the result.&quot;));
372      assertNull(sortDoc.getHistory());
373      CommandDocument setDoc = docs.get(&quot;set&quot;);
374      assertEquals(&quot;1.0.0&quot;, setDoc.getSince());
375      assertEquals(&quot;O(1)&quot;, setDoc.getComplexity());
376      assertEquals(&quot;2.6.12: Added the `EX`, `PX`, `NX` and `XX` options.&quot;, setDoc.getHistory().get(0));
377    }
378    @Test
379    public void commandGetKeys() {
380      List&lt;String&gt; keys = jedis.commandGetKeys(&quot;SORT&quot;, &quot;mylist&quot;, &quot;ALPHA&quot;, &quot;STORE&quot;, &quot;outlist&quot;);
381      assertEquals(2, keys.size());
382      List&lt;KeyValue&lt;String, List&lt;String&gt;&gt;&gt; keySandFlags = jedis.commandGetKeysAndFlags(&quot;SET&quot;, &quot;k1&quot;, &quot;v1&quot;);
383      assertEquals(&quot;k1&quot;, keySandFlags.get(0).getKey());
384      assertEquals(2, keySandFlags.get(0).getValue().size());
385    }
386    @Test
387    public void commandInfo() {
388      Map&lt;String, CommandInfo&gt; infos = jedis.commandInfo(&quot;GET&quot;, &quot;foo&quot;, &quot;SET&quot;);
389      CommandInfo getInfo = infos.get(&quot;get&quot;);
390      assertEquals(2, getInfo.getArity());
391      assertEquals(2, getInfo.getFlags().size());
392      assertEquals(1, getInfo.getFirstKey());
393      assertEquals(1, getInfo.getLastKey());
394      assertEquals(1, getInfo.getStep());
395      assertNull(infos.get(&quot;foo&quot;)); 
396      CommandInfo setInfo = infos.get(&quot;set&quot;);
397      assertEquals(3, setInfo.getAclCategories().size());
398      assertEquals(0, setInfo.getTips().size());
399      assertEquals(0, setInfo.getSubcommands().size());
400    }
401    @Test
402    public void commandList() {
403      List&lt;String&gt; commands = jedis.commandList();
404      assertTrue(commands.size() &gt; 100);
405      commands = jedis.commandListFilterBy(CommandListFilterByParams.commandListFilterByParams().filterByModule(&quot;JSON&quot;));
406      assertEquals(0, commands.size()); 
407      commands = jedis.commandListFilterBy(CommandListFilterByParams.commandListFilterByParams().filterByAclCat(&quot;admin&quot;));
408      assertTrue(commands.size() &gt; 10);
409      commands = jedis.commandListFilterBy(CommandListFilterByParams.commandListFilterByParams().filterByPattern(&quot;a*&quot;));
410      assertTrue(commands.size() &gt; 10);
411      assertThrows(IllegalArgumentException.class, () -&gt;
412          jedis.commandListFilterBy(CommandListFilterByParams.commandListFilterByParams()));
413    }
414    @Test
415    public void lolwut() {
416      assertNotNull(jedis.lolwut());
417      assertNotNull(jedis.lolwut(new LolwutParams().version(5)));
418      assertNotNull(jedis.lolwut(new LolwutParams().version(5).optionalArguments()));
419    }
420  }
</code></pre>
        </div>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ControlCommandsTest.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.jedis;
2  import static org.hamcrest.MatcherAssert.assertThat;
3  import static org.hamcrest.Matchers.greaterThan;
4  import static org.junit.Assert.assertArrayEquals;
5  import static org.junit.Assert.assertEquals;
6  import static org.junit.Assert.assertFalse;
7  import static org.junit.Assert.assertNotNull;
8  import static org.junit.Assert.assertNull;
9  import static org.junit.Assert.assertThrows;
10  import static org.junit.Assert.assertTrue;
11  import java.util.HashSet;
12  import java.util.List;
13  import java.util.Map;
14  import java.util.Set;
15  import java.util.concurrent.Callable;
16  import java.util.concurrent.ExecutionException;
17  import java.util.concurrent.ExecutorService;
18  import java.util.concurrent.Executors;
19  import java.util.concurrent.Future;
20  import java.util.concurrent.TimeUnit;
21  import org.hamcrest.MatcherAssert;
22  import org.hamcrest.Matchers;
23  import org.junit.Test;
24  import redis.clients.jedis.DefaultJedisClientConfig;
25  import redis.clients.jedis.Jedis;
26  import redis.clients.jedis.JedisMonitor;
27  import redis.clients.jedis.Protocol;
28  import redis.clients.jedis.args.ClientPauseMode;
29  import redis.clients.jedis.exceptions.JedisDataException;
30  import redis.clients.jedis.HostAndPorts;
31  import redis.clients.jedis.params.CommandListFilterByParams;
32  import redis.clients.jedis.params.LolwutParams;
33  import redis.clients.jedis.resps.CommandDocument;
34  import redis.clients.jedis.resps.CommandInfo;
35  import redis.clients.jedis.util.AssertUtil;
36  import redis.clients.jedis.util.KeyValue;
37  import redis.clients.jedis.util.SafeEncoder;
38  public class ControlCommandsTest extends JedisCommandsTestBase {
39    @Test
40    public void save() {
41      try {
42        String status = jedis.save();
43        assertEquals(&quot;OK&quot;, status);
44      } catch (JedisDataException e) {
45        assertTrue(&quot;ERR Background save already in progress&quot;.equalsIgnoreCase(e.getMessage()));
46      }
47    }
48    @Test
49    public void bgsave() {
50      try {
51        String status = jedis.bgsave();
52        assertEquals(&quot;Background saving started&quot;, status);
53      } catch (JedisDataException e) {
54        assertTrue(&quot;ERR Background save already in progress&quot;.equalsIgnoreCase(e.getMessage()));
55      }
56    }
57    @Test
58    public void bgsaveSchedule() {
59      Set&lt;String&gt; responses = new HashSet&lt;&gt;();
60      responses.add(&quot;OK&quot;);
61      responses.add(&quot;Background saving scheduled&quot;);
62      responses.add(&quot;Background saving started&quot;);
63      String status = jedis.bgsaveSchedule();
64      assertTrue(responses.contains(status));
65    }
66    @Test
67    public void bgrewriteaof() {
68      String scheduled = &quot;Background append only file rewriting scheduled&quot;;
69      String started = &quot;Background append only file rewriting started&quot;;
70      String status = jedis.bgrewriteaof();
71      boolean ok = status.equals(scheduled) || status.equals(started);
72      assertTrue(ok);
73    }
74    @Test
75    public void lastsave() throws InterruptedException {
76      long saved = jedis.lastsave();
77      assertTrue(saved &gt; 0);
78    }
79    @Test
80    public void info() {
81      String info = jedis.info();
82      assertNotNull(info);
83      info = jedis.info(&quot;server&quot;);
84      assertNotNull(info);
85    }
86    @Test
87    public void readonly() {
88      try {
89        jedis.readonly();
90      } catch (JedisDataException e) {
91        assertTrue(&quot;ERR This instance has cluster support disabled&quot;.equalsIgnoreCase(e.getMessage()));
92      }
93    }
94    @Test
95    public void readwrite() {
96      try {
97        jedis.readwrite();
98      } catch (JedisDataException e) {
99        assertTrue(&quot;ERR This instance has cluster support disabled&quot;.equalsIgnoreCase(e.getMessage()));
100      }
101    }
102    @Test
103    public void roleMaster() {
104      try (Jedis master = new Jedis(HostAndPorts.getRedisServers().get(0),
105          DefaultJedisClientConfig.builder().password(&quot;foobared&quot;).build())) {
106        List&lt;Object&gt; role = master.role();
107        assertEquals(&quot;master&quot;, role.get(0));
108        assertTrue(role.get(1) instanceof Long);
109        assertTrue(role.get(2) instanceof List);
110        List&lt;Object&gt; brole = master.roleBinary();
111        assertArrayEquals(&quot;master&quot;.getBytes(), (byte[]) brole.get(0));
112        assertTrue(brole.get(1) instanceof Long);
113        assertTrue(brole.get(2) instanceof List);
114      }
115    }
116    @Test
117    public void roleSlave() {
118      try (Jedis slave = new Jedis(HostAndPorts.getRedisServers().get(4),
119          DefaultJedisClientConfig.builder().password(&quot;foobared&quot;).build())) {
120        List&lt;Object&gt; role = slave.role();
121        assertEquals(&quot;slave&quot;, role.get(0));
122        assertEquals((long) HostAndPorts.getRedisServers().get(0).getPort(), role.get(2));
123        assertEquals(&quot;connected&quot;, role.get(3));
124        assertTrue(role.get(4) instanceof Long);
125        List&lt;Object&gt; brole = slave.roleBinary();
126        assertArrayEquals(&quot;slave&quot;.getBytes(), (byte[]) brole.get(0));
127        assertEquals((long) HostAndPorts.getRedisServers().get(0).getPort(), brole.get(2));
128        assertArrayEquals(&quot;connected&quot;.getBytes(), (byte[]) brole.get(3));
129        assertTrue(brole.get(4) instanceof Long);
130      }
131    }
132    @Test
133    public void roleSentinel() {
134      try (Jedis sentinel = new Jedis(HostAndPorts.getSentinelServers().get(0))) {
135        List&lt;Object&gt; role = sentinel.role();
136        assertEquals(&quot;sentinel&quot;, role.get(0));
137        assertTrue(role.get(1) instanceof List);
138        AssertUtil.assertCollectionContains((List) role.get(1), &quot;mymaster&quot;);
139        List&lt;Object&gt; brole = sentinel.roleBinary();
<span onclick='openModal()' class='match'>140        assertArrayEquals(&quot;sentinel&quot;.getBytes(), (byte[]) brole.get(0));
141        assertTrue(brole.get(1) instanceof List);
</span>142        AssertUtil.assertByteArrayCollectionContains((List) brole.get(1), &quot;mymaster&quot;.getBytes());
143      }
144    }
145    @Test
146    public void monitor() {
147      new Thread(new Runnable() {
148        @Override
149        public void run() {
150          try {
151            Thread.sleep(100);
152          } catch (InterruptedException e) {
153          }
154          Jedis j = new Jedis();
155          j.auth(&quot;foobared&quot;);
156          for (int i = 0; i &lt; 5; i++) {
157            j.incr(&quot;foobared&quot;);
158          }
159          j.disconnect();
160        }
161      }).start();
162      jedis.monitor(new JedisMonitor() {
163        private int count = 0;
164        @Override
165        public void onCommand(String command) {
166          if (command.contains(&quot;INCR&quot;)) {
167            count++;
168          }
169          if (count == 5) {
170            client.disconnect();
171          }
172        }
173      });
174    }
175    @Test
176    public void configGet() {
177      Map&lt;String, String&gt; info = jedis.configGet(&quot;m*&quot;);
178      assertNotNull(info);
179      assertFalse(info.isEmpty());
180      Map&lt;byte[], byte[]&gt; infoBinary = jedis.configGet(&quot;m*&quot;.getBytes());
181      assertNotNull(infoBinary);
182      assertFalse(infoBinary.isEmpty());
183    }
184    @Test
185    public void configSet() {
186      Map&lt;String, String&gt; info = jedis.configGet(&quot;maxmemory&quot;);
187      String memory = info.get(&quot;maxmemory&quot;);
188      assertNotNull(memory);
189      assertEquals(&quot;OK&quot;, jedis.configSet(&quot;maxmemory&quot;, &quot;200&quot;));
190      assertEquals(&quot;OK&quot;, jedis.configSet(&quot;maxmemory&quot;, memory));
191    }
192    @Test
193    public void configSetBinary() {
194      byte[] maxmemory = SafeEncoder.encode(&quot;maxmemory&quot;);
195      Map&lt;byte[], byte[]&gt; info = jedis.configGet(maxmemory);
196      byte[] memory = info.get(maxmemory);
197      assertNotNull(memory);
198      assertEquals(&quot;OK&quot;, jedis.configSet(maxmemory, Protocol.toByteArray(200)));
199      assertEquals(&quot;OK&quot;, jedis.configSet(maxmemory, memory));
200    }
201    @Test
202    public void configGetSetMulti() {
203      String[] params = new String[]{&quot;hash-max-listpack-entries&quot;, &quot;set-max-intset-entries&quot;, &quot;zset-max-listpack-entries&quot;};
204      Map&lt;String, String&gt; info = jedis.configGet(params);
205      assertEquals(3, info.size());
206      assertEquals(&quot;OK&quot;, jedis.configSet(info));
207      byte[][] bparams = new byte[][]{SafeEncoder.encode(&quot;hash-max-listpack-entries&quot;),
208        SafeEncoder.encode(&quot;set-max-intset-entries&quot;), SafeEncoder.encode(&quot;zset-max-listpack-entries&quot;)};
209      Map&lt;byte[], byte[]&gt; binfo = jedis.configGet(bparams);
210      assertEquals(3, binfo.size());
211      assertEquals(&quot;OK&quot;, jedis.configSetBinary(binfo));
212    }
213    @Test
214    public void waitReplicas() {
215      assertEquals(1, jedis.waitReplicas(1, 100));
216    }
217    @Test
218    public void waitAof() {
219      assertEquals(KeyValue.of(0L, 0L), jedis.waitAOF(0L, 0L, 100L));
220    }
221    @Test
222    public void clientPause() throws InterruptedException, ExecutionException {
223      ExecutorService executorService = Executors.newFixedThreadPool(2);
224      try (Jedis jedisToPause1 = createJedis(); Jedis jedisToPause2 = createJedis();) {
225        jedis.clientPause(1000L);
226        Future&lt;Long&gt; latency1 = executorService.submit(new Callable&lt;Long&gt;() {
227          @Override
228          public Long call() throws Exception {
229            long startMillis = System.currentTimeMillis();
230            assertEquals(&quot;PONG&quot;, jedisToPause1.ping());
231            return System.currentTimeMillis() - startMillis;
232          }
233        });
234        Future&lt;Long&gt; latency2 = executorService.submit(new Callable&lt;Long&gt;() {
235          @Override
236          public Long call() throws Exception {
237            long startMillis = System.currentTimeMillis();
238            assertEquals(&quot;PONG&quot;, jedisToPause2.ping());
239            return System.currentTimeMillis() - startMillis;
240          }
241        });
242        assertThat(latency1.get(), greaterThan(100L));
243        assertThat(latency2.get(), greaterThan(100L));
244      } finally {
245        executorService.shutdown();
246        if (!executorService.awaitTermination(2, TimeUnit.SECONDS)) {
247          executorService.shutdownNow();
248        }
249      }
250    }
251    @Test
252    public void clientPauseAll() throws InterruptedException, ExecutionException {
253      ExecutorService executorService = Executors.newFixedThreadPool(1);
254      try (Jedis jedisPause = createJedis()) {
255        jedis.clientPause(1000L, ClientPauseMode.ALL);
256        Future&lt;Long&gt; latency = executorService.submit(new Callable&lt;Long&gt;() {
257          @Override
258          public Long call() throws Exception {
259            long startMillis = System.currentTimeMillis();
260            jedisPause.get(&quot;key&quot;);
261            return System.currentTimeMillis() - startMillis;
262          }
263        });
264        assertThat(latency.get(), greaterThan(100L));
265      } finally {
266        executorService.shutdown();
267        if (!executorService.awaitTermination(5, TimeUnit.SECONDS)) {
268          executorService.shutdownNow();
269        }
270      }
271    }
272    @Test
273    public void clientPauseWrite() throws InterruptedException, ExecutionException {
274      ExecutorService executorService = Executors.newFixedThreadPool(2);
275      try (Jedis jedisRead = createJedis(); Jedis jedisWrite = createJedis();) {
276        jedis.clientPause(1000L, ClientPauseMode.WRITE);
277        Future&lt;Long&gt; latencyRead = executorService.submit(new Callable&lt;Long&gt;() {
278          @Override
279          public Long call() throws Exception {
280            long startMillis = System.currentTimeMillis();
281            jedisRead.get(&quot;key&quot;);
282            return System.currentTimeMillis() - startMillis;
283          }
284        });
285        Future&lt;Long&gt; latencyWrite = executorService.submit(new Callable&lt;Long&gt;() {
286          @Override
287          public Long call() throws Exception {
288            long startMillis = System.currentTimeMillis();
289            jedisWrite.set(&quot;key&quot;, &quot;value&quot;);
290            return System.currentTimeMillis() - startMillis;
291          }
292        });
293        assertThat(latencyRead.get(), Matchers.lessThan(100L));
294        assertThat(latencyWrite.get(), Matchers.greaterThan(100L));
295      } finally {
296        executorService.shutdown();
297        if (!executorService.awaitTermination(5, TimeUnit.SECONDS)) {
298          executorService.shutdownNow();
299        }
300      }
301    }
302    @Test
303    public void clientUnpause() {
304      assertEquals(&quot;OK&quot;, jedis.clientUnpause());
305    }
306    @Test
307    public void clientNoEvict() {
308      assertEquals(&quot;OK&quot;, jedis.clientNoEvictOn());
309      assertEquals(&quot;OK&quot;, jedis.clientNoEvictOff());
310    }
311    @Test
312    public void clientNoTouch() {
313      assertEquals(&quot;OK&quot;, jedis.clientNoTouchOn());
314      assertEquals(&quot;OK&quot;, jedis.clientNoTouchOff());
315    }
316    @Test
317    public void memoryDoctorString() {
318      String memoryInfo = jedis.memoryDoctor();
319      assertNotNull(memoryInfo);
320    }
321    @Test
322    public void memoryDoctorBinary() {
323      byte[] memoryInfo = jedis.memoryDoctorBinary();
324      assertNotNull(memoryInfo);
325    }
326    @Test
327    public void memoryUsageString() {
328      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
329      assertThat(jedis.memoryUsage(&quot;foo&quot;), greaterThan(20l));
330      jedis.lpush(&quot;foobar&quot;, &quot;fo&quot;, &quot;ba&quot;, &quot;sha&quot;);
331      assertThat(jedis.memoryUsage(&quot;foobar&quot;, 2), greaterThan(36l));
332      assertNull(jedis.memoryUsage(&quot;roo&quot;, 2));
333    }
334    @Test
335    public void memoryUsageBinary() {
336      byte[] bfoo = {0x01, 0x02, 0x03, 0x04};
337      byte[] bbar = {0x05, 0x06, 0x07, 0x08};
338      byte[] bfoobar = {0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08};
339      jedis.set(bfoo, bbar);
340      assertThat(jedis.memoryUsage(bfoo), greaterThan(20l));
341      jedis.lpush(bfoobar, new byte[]{0x01, 0x02}, new byte[]{0x05, 0x06}, new byte[]{0x00});
342      assertThat(jedis.memoryUsage(bfoobar, 2), greaterThan(40l));
343      assertNull(jedis.memoryUsage(&quot;roo&quot;, 2));
344    }
345    @Test
346    public void memoryPurge() {
347       String memoryPurge = jedis.memoryPurge();
348       assertNotNull(memoryPurge);
349    }
350    @Test
351    public void memoryStats() {
352      Map&lt;String, Object&gt; stats = jedis.memoryStats();
353      assertNotNull(stats);
354    }
355    @Test
356    public void latencyDoctor() {
357      String report = jedis.latencyDoctor();
358      assertNotNull(report);
359    }
360    @Test
361    public void commandCount() {
362      assertTrue(jedis.commandCount() &gt; 100);
363    }
364    @Test
365    public void commandDocs() {
366      Map&lt;String, CommandDocument&gt; docs = jedis.commandDocs(&quot;SORT&quot;, &quot;SET&quot;);
367      CommandDocument sortDoc = docs.get(&quot;sort&quot;);
368      assertEquals(&quot;generic&quot;, sortDoc.getGroup());
369      MatcherAssert.assertThat(sortDoc.getSummary(), Matchers.isOneOf(
370          &quot;Sort the elements in a list, set or sorted set&quot;,
371          &quot;Sorts the elements in a list, a set, or a sorted set, optionally storing the result.&quot;));
372      assertNull(sortDoc.getHistory());
373      CommandDocument setDoc = docs.get(&quot;set&quot;);
374      assertEquals(&quot;1.0.0&quot;, setDoc.getSince());
375      assertEquals(&quot;O(1)&quot;, setDoc.getComplexity());
376      assertEquals(&quot;2.6.12: Added the `EX`, `PX`, `NX` and `XX` options.&quot;, setDoc.getHistory().get(0));
377    }
378    @Test
379    public void commandGetKeys() {
380      List&lt;String&gt; keys = jedis.commandGetKeys(&quot;SORT&quot;, &quot;mylist&quot;, &quot;ALPHA&quot;, &quot;STORE&quot;, &quot;outlist&quot;);
381      assertEquals(2, keys.size());
382      List&lt;KeyValue&lt;String, List&lt;String&gt;&gt;&gt; keySandFlags = jedis.commandGetKeysAndFlags(&quot;SET&quot;, &quot;k1&quot;, &quot;v1&quot;);
383      assertEquals(&quot;k1&quot;, keySandFlags.get(0).getKey());
384      assertEquals(2, keySandFlags.get(0).getValue().size());
385    }
386    @Test
387    public void commandInfo() {
388      Map&lt;String, CommandInfo&gt; infos = jedis.commandInfo(&quot;GET&quot;, &quot;foo&quot;, &quot;SET&quot;);
389      CommandInfo getInfo = infos.get(&quot;get&quot;);
390      assertEquals(2, getInfo.getArity());
391      assertEquals(2, getInfo.getFlags().size());
392      assertEquals(1, getInfo.getFirstKey());
393      assertEquals(1, getInfo.getLastKey());
394      assertEquals(1, getInfo.getStep());
395      assertNull(infos.get(&quot;foo&quot;)); 
396      CommandInfo setInfo = infos.get(&quot;set&quot;);
397      assertEquals(3, setInfo.getAclCategories().size());
398      assertEquals(0, setInfo.getTips().size());
399      assertEquals(0, setInfo.getSubcommands().size());
400    }
401    @Test
402    public void commandList() {
403      List&lt;String&gt; commands = jedis.commandList();
404      assertTrue(commands.size() &gt; 100);
405      commands = jedis.commandListFilterBy(CommandListFilterByParams.commandListFilterByParams().filterByModule(&quot;JSON&quot;));
406      assertEquals(0, commands.size()); 
407      commands = jedis.commandListFilterBy(CommandListFilterByParams.commandListFilterByParams().filterByAclCat(&quot;admin&quot;));
408      assertTrue(commands.size() &gt; 10);
409      commands = jedis.commandListFilterBy(CommandListFilterByParams.commandListFilterByParams().filterByPattern(&quot;a*&quot;));
410      assertTrue(commands.size() &gt; 10);
411      assertThrows(IllegalArgumentException.class, () -&gt;
412          jedis.commandListFilterBy(CommandListFilterByParams.commandListFilterByParams()));
413    }
414    @Test
415    public void lolwut() {
416      assertNotNull(jedis.lolwut());
417      assertNotNull(jedis.lolwut(new LolwutParams().version(5)));
418      assertNotNull(jedis.lolwut(new LolwutParams().version(5).optionalArguments()));
419    }
420  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ControlCommandsTest.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ControlCommandsTest.java</div>
                </div>
                <div class="column column_space"><pre><code>128        assertArrayEquals(&quot;connected&quot;.getBytes(), (byte[]) brole.get(3));
129        assertTrue(brole.get(4) instanceof Long);
</pre></code></div>
                <div class="column column_space"><pre><code>140        assertArrayEquals(&quot;sentinel&quot;.getBytes(), (byte[]) brole.get(0));
141        assertTrue(brole.get(1) instanceof List);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    