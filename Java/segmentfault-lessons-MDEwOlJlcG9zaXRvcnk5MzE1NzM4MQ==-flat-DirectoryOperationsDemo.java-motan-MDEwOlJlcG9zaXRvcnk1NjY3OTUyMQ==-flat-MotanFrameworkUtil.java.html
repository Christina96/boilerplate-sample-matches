
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 6.582278481012659%, Tokens: 13</h2>
        <div class="column">
            <h3>segmentfault-lessons-MDEwOlJlcG9zaXRvcnk5MzE1NzM4MQ==-flat-DirectoryOperationsDemo.java</h3>
            <pre><code><span onclick='openModal()' class='match'>1  package com.segmentfault.deep.in.java.newfilesystem;
2  import java.io.File;
3  import java.io.IOException;
4  import java.nio.file.FileSystems;
5  import java.nio.file.Files;
6  import java.nio.file.Path;
7  import java.nio.file.Paths;
8  import java.util.stream.Stream;
9  public class DirectoryOperationsDemo {
10      public static void main(String[] args) {
11          String classPath = System.getProperty("java.class.path");
</span>12          Stream.of(classPath.split(File.pathSeparator))
13                  .map(Paths::get) 
14                  .filter(Files::isDirectory) 
15                  .filter(Files::isReadable)
16                  .filter(Files::isWritable)
17                  .map(Path::toString)        
18                  .map(dirPath -> Paths.get(dirPath, "parent-dir", "sub-dir"))  
19                  .forEach(newDir -> {
20                      try {
21                          Path newDirectory = Files.createDirectories(newDir);
22                          System.out.printf("新的目录[%s] 已被创建!\n", newDirectory);
23                      } catch (IOException e) {
24                          e.printStackTrace();
25                      }
26                  });
27      }
28  }
</code></pre>
        </div>
        <div class="column">
            <h3>motan-MDEwOlJlcG9zaXRvcnk1NjY3OTUyMQ==-flat-MotanFrameworkUtil.java</h3>
            <pre><code><span onclick='openModal()' class='match'>1  package com.weibo.api.motan.util;
2  import com.weibo.api.motan.common.MotanConstants;
3  import com.weibo.api.motan.common.URLParamType;
4  import com.weibo.api.motan.config.ProtocolConfig;
5  import com.weibo.api.motan.config.RegistryConfig;
6  import com.weibo.api.motan.rpc.*;
7  import org.apache.commons.lang3.StringUtils;
8  import java.util.Map;
9  public class MotanFrameworkUtil {
10      public static String getServiceKey(Request request) {
11          String version = getVersionFromRequest(request);
</span>12          String group = getGroupFromRequest(request);
13          return getServiceKey(group, request.getInterfaceName(), version);
14      }
15      public static String getGroupFromRequest(Request request) {
16          return getValueFromRequest(request, URLParamType.group.name(), URLParamType.group.getValue());
17      }
18      public static String getVersionFromRequest(Request request) {
19          return getValueFromRequest(request, URLParamType.version.name(), URLParamType.version.getValue());
20      }
21      public static String getRemoteIpFromRequest(Request request) {
22          String rip = getValueFromRequest(request, MotanConstants.X_FORWARDED_FOR, null);
23          if (rip == null) {
24              rip = getValueFromRequest(request, URLParamType.host.getName(), null);
25          }
26          return rip;
27      }
28      public static String getValueFromRequest(Request request, String key, String defaultValue) {
29          String value = defaultValue;
30          if (request.getAttachments() != null && request.getAttachments().containsKey(key)) {
31              value = request.getAttachments().get(key);
32          }
33          return value;
34      }
35      public static String getServiceKey(URL url) {
36          return getServiceKey(url.getGroup(), url.getPath(), url.getVersion());
37      }
38      public static String getProtocolKey(URL url) {
39          return url.getProtocol() + MotanConstants.PROTOCOL_SEPARATOR + url.getServerPortStr() + MotanConstants.PATH_SEPARATOR
40                  + url.getGroup() + MotanConstants.PATH_SEPARATOR + url.getPath() + MotanConstants.PATH_SEPARATOR + url.getVersion();
41      }
42      public static String toString(Request request) {
43          return "requestId=" + request.getRequestId() + " interface=" + request.getInterfaceName() + " method=" + request.getMethodName()
44                  + "(" + request.getParamtersDesc() + ")";
45      }
46      public static String toStringWithRemoteIp(Request request) {
47          return toString(request) + " remoteIp=" + getRemoteIpFromRequest(request);
48      }
49      public static String getFullMethodString(Request request) {
50          return request.getInterfaceName() + "." + request.getMethodName() + "("
51                  + request.getParamtersDesc() + ")";
52      }
53      public static String getGroupMethodString(Request request) {
54          return getGroupFromRequest(request) + "_" + getFullMethodString(request);
55      }
56      public static String getModuleOrGroup(Map<String, String> map, String defaultValue) {
57          if (map != null) {
58              String module = map.get(URLParamType.module.getName());
59              if (module == null) {
60                  module = map.get(URLParamType.group.getName());
61              }
62              if (module != null) {
63                  return module;
64              }
65          }
66          return defaultValue;
67      }
68      public static boolean checkIfCanShareServiceChannel(URL source, URL target) {
69          if (!StringUtils.equals(source.getProtocol(), target.getProtocol())) {
70              return false;
71          }
72          if (!StringUtils.equals(source.getParameter(URLParamType.codec.getName()), target.getParameter(URLParamType.codec.getName()))) {
73              return false;
74          }
75          if (!StringUtils.equals(source.getParameter(URLParamType.serialize.getName()),
76                  target.getParameter(URLParamType.serialize.getName()))) {
77              return false;
78          }
79          if (!StringUtils.equals(source.getParameter(URLParamType.maxContentLength.getName()),
80                  target.getParameter(URLParamType.maxContentLength.getName()))) {
81              return false;
82          }
83          if (!StringUtils.equals(source.getParameter(URLParamType.maxServerConnection.getName()),
84                  target.getParameter(URLParamType.maxServerConnection.getName()))) {
85              return false;
86          }
87          if (!StringUtils.equals(source.getParameter(URLParamType.maxWorkerThread.getName()),
88                  target.getParameter(URLParamType.maxWorkerThread.getName()))) {
89              return false;
90          }
91          if (!StringUtils.equals(source.getParameter(URLParamType.workerQueueSize.getName()),
92                  target.getParameter(URLParamType.workerQueueSize.getName()))) {
93              return false;
94          }
95          if (!StringUtils.equals(source.getParameter(URLParamType.heartbeatFactory.getName()),
96                  target.getParameter(URLParamType.heartbeatFactory.getName()))) {
97              return false;
98          }
99          return StringUtils.equals(source.getParameter(URLParamType.providerProtectedStrategy.getName()),
100                  target.getParameter(URLParamType.providerProtectedStrategy.getName()));
101      }
102      public static boolean checkIfCanShallClientChannel(URL source, URL target) {
103          if (!StringUtils.equals(source.getProtocol(), target.getProtocol())) {
104              return false;
105          }
106          if (!StringUtils.equals(source.getParameter(URLParamType.codec.getName()), target.getParameter(URLParamType.codec.getName()))) {
107              return false;
108          }
109          if (!StringUtils.equals(source.getParameter(URLParamType.serialize.getName()),
110                  target.getParameter(URLParamType.serialize.getName()))) {
111              return false;
112          }
113          if (!StringUtils.equals(source.getParameter(URLParamType.maxContentLength.getName()),
114                  target.getParameter(URLParamType.maxContentLength.getName()))) {
115              return false;
116          }
117          if (!StringUtils.equals(source.getParameter(URLParamType.maxClientConnection.getName()),
118                  target.getParameter(URLParamType.maxClientConnection.getName()))) {
119              return false;
120          }
121          return StringUtils.equals(source.getParameter(URLParamType.heartbeatFactory.getName()),
122                  target.getParameter(URLParamType.heartbeatFactory.getName()));
123      }
124      private static String getServiceKey(String group, String interfaceName, String version) {
125          return group + MotanConstants.PATH_SEPARATOR + interfaceName + MotanConstants.PATH_SEPARATOR + version;
126      }
127      public static ProtocolConfig getDefaultProtocolConfig() {
128          ProtocolConfig pc = new ProtocolConfig();
129          pc.setId("motan");
130          pc.setName("motan");
131          return pc;
132      }
133      public static RegistryConfig getDefaultRegistryConfig() {
134          RegistryConfig local = new RegistryConfig();
135          local.setRegProtocol("local");
136          return local;
137      }
138      public static String removeAsyncSuffix(String path) {
139          if (path != null && path.endsWith(MotanConstants.ASYNC_SUFFIX)) {
140              return path.substring(0, path.length() - MotanConstants.ASYNC_SUFFIX.length());
141          }
142          return path;
143      }
144      public static DefaultResponse buildErrorResponse(Request request, Exception e) {
145          return buildErrorResponse(request.getRequestId(), request.getRpcProtocolVersion(), e);
146      }
147      public static DefaultResponse buildErrorResponse(long requestId, byte version, Exception e) {
148          DefaultResponse response = new DefaultResponse();
149          response.setRequestId(requestId);
150          response.setRpcProtocolVersion(version);
151          response.setException(e);
152          return response;
153      }
154      public static void logEvent(Request request, String event) {
155          if (MotanSwitcherUtil.switcherIsOpenWithDefault(MotanConstants.MOTAN_TRACE_INFO_SWITCHER, false)) {
156              logEvent(request, event, System.currentTimeMillis());
157          }
158      }
159      public static void logEvent(Request request, String event, long time) {
160          if (!(request instanceof Traceable)) {
161              return;
162          }
163          TraceableContext context = ((Traceable) request).getTraceableContext();
164          if (MotanConstants.TRACE_CSEND.equals(event)) {
165              context.setSendTime(time);
166              return;
167          }
168          if (MotanConstants.TRACE_SRECEIVE.equals(event)) {
169              context.setReceiveTime(time);
170              return;
171          }
172          if (MotanSwitcherUtil.switcherIsOpenWithDefault(MotanConstants.MOTAN_TRACE_INFO_SWITCHER, false)) {
173              context.addTraceInfo(event, String.valueOf(time));
174          }
175      }
176      public static void logEvent(Response response, String event) {
177          if (MotanSwitcherUtil.switcherIsOpenWithDefault(MotanConstants.MOTAN_TRACE_INFO_SWITCHER, false)) {
178              logEvent(response, event, System.currentTimeMillis());
179          }
180      }
181      public static void logEvent(Response response, String event, long time) {
182          if (!(response instanceof Traceable)) {
183              return;
184          }
185          TraceableContext context = ((Traceable) response).getTraceableContext();
186          if (MotanConstants.TRACE_SSEND.equals(event)) {
187              context.setSendTime(time);
188              return;
189          }
190          if (MotanConstants.TRACE_CRECEIVE.equals(event)) {
191              context.setReceiveTime(time);
192              return;
193          }
194          if (MotanSwitcherUtil.switcherIsOpenWithDefault(MotanConstants.MOTAN_TRACE_INFO_SWITCHER, false)) {
195              context.addTraceInfo(event, String.valueOf(time));
196          }
197      }
198  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from segmentfault-lessons-MDEwOlJlcG9zaXRvcnk5MzE1NzM4MQ==-flat-DirectoryOperationsDemo.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from motan-MDEwOlJlcG9zaXRvcnk1NjY3OTUyMQ==-flat-MotanFrameworkUtil.java</div>
                </div>
                <div class="column column_space"><pre><code>1  package com.segmentfault.deep.in.java.newfilesystem;
2  import java.io.File;
3  import java.io.IOException;
4  import java.nio.file.FileSystems;
5  import java.nio.file.Files;
6  import java.nio.file.Path;
7  import java.nio.file.Paths;
8  import java.util.stream.Stream;
9  public class DirectoryOperationsDemo {
10      public static void main(String[] args) {
11          String classPath = System.getProperty("java.class.path");
</pre></code></div>
                <div class="column column_space"><pre><code>1  package com.weibo.api.motan.util;
2  import com.weibo.api.motan.common.MotanConstants;
3  import com.weibo.api.motan.common.URLParamType;
4  import com.weibo.api.motan.config.ProtocolConfig;
5  import com.weibo.api.motan.config.RegistryConfig;
6  import com.weibo.api.motan.rpc.*;
7  import org.apache.commons.lang3.StringUtils;
8  import java.util.Map;
9  public class MotanFrameworkUtil {
10      public static String getServiceKey(Request request) {
11          String version = getVersionFromRequest(request);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    