
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 5.588822355289421%, Tokens: 14, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>BungeeCord-MDEwOlJlcG9zaXRvcnk2MDg0MjEw-flat-ChatComponentTransformer.java</h3>
            <pre><code><span onclick='openModal()' class='match'>1  package net.md_5.bungee.util;
2  import com.google.common.base.Preconditions;
3  import com.google.common.collect.Lists;
4  import java.util.List;
5  import java.util.regex.Pattern;
6  import lombok.AccessLevel;
7  import lombok.NoArgsConstructor;
8  import net.md_5.bungee.api.chat.BaseComponent;
9  import net.md_5.bungee.api.chat.ScoreComponent;
10  import net.md_5.bungee.api.chat.TextComponent;
11  import net.md_5.bungee.api.chat.hover.content.Content;
12  import net.md_5.bungee.api.connection.ProxiedPlayer;
13  import net.md_5.bungee.api.score.Score;
14  import net.md_5.bungee.protocol.ProtocolConstants;
</span>15  @NoArgsConstructor(access = AccessLevel.PRIVATE)
16  public final class ChatComponentTransformer
17  {
18      private static final ChatComponentTransformer INSTANCE = new ChatComponentTransformer();
19      private static final Pattern SELECTOR_PATTERN = Pattern.compile( "^@([pares])(?:\\[([^ ]*)\\])?$" );
20      public BaseComponent[] legacyHoverTransform(ProxiedPlayer player, BaseComponent... components)
21      {
22          if ( player.getPendingConnection().getVersion() < ProtocolConstants.MINECRAFT_1_16 )
23          {
24              for ( int i = 0; i < components.length; i++ )
25              {
26                  BaseComponent next = components[i];
27                  if ( next.getHoverEvent() == null || next.getHoverEvent().isLegacy() )
28                  {
29                      continue;
30                  }
31                  next = next.duplicate();
32                  next.getHoverEvent().setLegacy( true );
33                  if ( next.getHoverEvent().getContents().size() > 1 )
34                  {
35                      Content exception = next.getHoverEvent().getContents().get( 0 );
36                      next.getHoverEvent().getContents().clear();
37                      next.getHoverEvent().getContents().add( exception );
38                  }
39                  components[i] = next;
40              }
41          }
42          return components;
43      }
44      public static ChatComponentTransformer getInstance()
45      {
46          return INSTANCE;
47      }
48      public BaseComponent[] transform(ProxiedPlayer player, BaseComponent... components)
49      {
50          return transform( player, false, components );
51      }
52      public BaseComponent[] transform(ProxiedPlayer player, boolean transformHover, BaseComponent... components)
53      {
54          if ( components == null || components.length < 1 || ( components.length == 1 && components[0] == null ) )
55          {
56              return new BaseComponent[]
57              {
58                  new TextComponent( "" )
59              };
60          }
61          if ( transformHover )
62          {
63              components = legacyHoverTransform( player, components );
64          }
65          for ( BaseComponent root : components )
66          {
67              if ( root.getExtra() != null && !root.getExtra().isEmpty() )
68              {
69                  List<BaseComponent> list = Lists.newArrayList( transform( player, transformHover, root.getExtra().toArray( new BaseComponent[ 0 ] ) ) );
70                  root.setExtra( list );
71              }
72              if ( root instanceof ScoreComponent )
73              {
74                  transformScoreComponent( player, (ScoreComponent) root );
75              }
76          }
77          return components;
78      }
79      private void transformScoreComponent(ProxiedPlayer player, ScoreComponent component)
80      {
81          Preconditions.checkArgument( !isSelectorPattern( component.getName() ), "Cannot transform entity selector patterns" );
82          if ( component.getValue() != null && !component.getValue().isEmpty() )
83          {
84              return; 
85          }
86          if ( component.getName().equals( "*" ) )
87          {
88              component.setName( player.getName() );
89          }
90          if ( player.getScoreboard().getObjective( component.getObjective() ) != null )
91          {
92              Score score = player.getScoreboard().getScore( component.getName() );
93              if ( score != null )
94              {
95                  component.setValue( Integer.toString( score.getValue() ) );
96              }
97          }
98      }
99      public boolean isSelectorPattern(String pattern)
100      {
101          return SELECTOR_PATTERN.matcher( pattern ).matches();
102      }
103  }
</code></pre>
        </div>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ClientCommandsTest.java</h3>
            <pre><code><span onclick='openModal()' class='match'>1  package redis.clients.jedis.commands.jedis;
2  import static org.junit.Assert.assertArrayEquals;
3  import static org.junit.Assert.assertEquals;
4  import static org.junit.Assert.assertNotNull;
5  import static org.junit.Assert.assertTrue;
6  import static org.junit.Assert.fail;
7  import static redis.clients.jedis.params.ClientKillParams.SkipMe;
8  import java.util.concurrent.ExecutionException;
9  import java.util.concurrent.Executors;
10  import java.util.concurrent.Future;
11  import java.util.concurrent.TimeUnit;
12  import java.util.concurrent.TimeoutException;
13  import java.util.regex.Matcher;
14  import java.util.regex.Pattern;
</span>15  import org.junit.After;
16  import org.junit.Before;
17  import org.junit.Test;
18  import redis.clients.jedis.Jedis;
19  import redis.clients.jedis.args.ClientAttributeOption;
20  import redis.clients.jedis.args.ClientType;
21  import redis.clients.jedis.args.UnblockType;
22  import redis.clients.jedis.exceptions.JedisConnectionException;
23  import redis.clients.jedis.params.ClientKillParams;
24  public class ClientCommandsTest extends JedisCommandsTestBase {
25    private final String clientName = "fancy_jedis_name";
26    private final Pattern pattern = Pattern.compile("\\bname=" + clientName + "\\b");
27    private Jedis client;
28    @Before
29    @Override
30    public void setUp() throws Exception {
31      super.setUp();
32      client = new Jedis(hnp.getHost(), hnp.getPort(), 500);
33      client.auth("foobared");
34      client.clientSetname(clientName);
35    }
36    @After
37    @Override
38    public void tearDown() throws Exception {
39      client.close();
40      super.tearDown();
41    }
42    @Test
43    public void nameString() {
44      String name = "string";
45      client.clientSetname(name);
46      assertEquals(name, client.clientGetname());
47    }
48    @Test
49    public void nameBinary() {
50      byte[] name = "binary".getBytes();
51      client.clientSetname(name);
52      assertArrayEquals(name, client.clientGetnameBinary());
53    }
54    @Test
55    public void clientSetInfoDefault() {
56      String libName = "jedis";
57      String libVersion = "999.999.999";
58      assertEquals("OK", client.clientSetInfo(ClientAttributeOption.LIB_NAME, libName));
59      assertEquals("OK", client.clientSetInfo(ClientAttributeOption.LIB_VER, libVersion));
60      String info = client.clientInfo();
61      assertTrue(info.contains("lib-name=jedis"));
62      assertTrue(info.contains("lib-ver=999.999.999"));
63    }
64    @Test
65    public void clientId() {
66      long clientId = client.clientId();
67      String info = findInClientList();
68      Matcher matcher = Pattern.compile("\\bid=(\\d+)\\b").matcher(info);
69      matcher.find();
70      assertEquals(clientId, Long.parseLong(matcher.group(1)));
71    }
72    @Test
73    public void clientIdmultipleConnection() {
74      try (Jedis client2 = new Jedis(hnp.getHost(), hnp.getPort(), 500)) {
75        client2.auth("foobared");
76        client2.clientSetname("fancy_jedis_another_name");
77        assertTrue(client.clientId() < client2.clientId());
78      }
79    }
80    @Test
81    public void clientIdReconnect() {
82      long clientIdInitial = client.clientId();
83      client.disconnect();
84      client.connect();
85      client.auth("foobared");
86      long clientIdAfterReconnect = client.clientId();
87      assertTrue(clientIdInitial < clientIdAfterReconnect);
88    }
89    @Test
90    public void clientUnblock() throws InterruptedException, TimeoutException {
91      long clientId = client.clientId();
92      assertEquals(0, jedis.clientUnblock(clientId, UnblockType.ERROR));
93      Future<?> future = Executors.newSingleThreadExecutor().submit(() -> client.brpop(100000, "foo"));
94      try {
95        TimeUnit.MILLISECONDS.sleep(500);
96        assertEquals(1, jedis.clientUnblock(clientId, UnblockType.ERROR));
97        future.get(1, TimeUnit.SECONDS);
98      } catch (ExecutionException e) {
99        assertEquals("redis.clients.jedis.exceptions.JedisDataException: UNBLOCKED client unblocked via CLIENT UNBLOCK", e.getMessage());
100      }
101    }
102    @Test
103    public void killIdString() {
104      String info = findInClientList();
105      Matcher matcher = Pattern.compile("\\bid=(\\d+)\\b").matcher(info);
106      matcher.find();
107      String id = matcher.group(1);
108      assertEquals(1, jedis.clientKill(new ClientKillParams().id(id)));
109      assertDisconnected(client);
110    }
111    @Test
112    public void killIdBinary() {
113      String info = findInClientList();
114      Matcher matcher = Pattern.compile("\\bid=(\\d+)\\b").matcher(info);
115      matcher.find();
116      byte[] id = matcher.group(1).getBytes();
117      assertEquals(1, jedis.clientKill(new ClientKillParams().id(id)));
118      assertDisconnected(client);
119    }
120    @Test
121    public void killTypeNormal() {
122      long clients = jedis.clientKill(new ClientKillParams().type(ClientType.NORMAL));
123      assertTrue(clients > 0);
124      assertDisconnected(client);
125    }
126    @Test
127    public void killSkipmeNo() {
128      jedis.clientKill(new ClientKillParams().type(ClientType.NORMAL).skipMe(SkipMe.NO));
129      assertDisconnected(client);
130      assertDisconnected(jedis);
131    }
132    @Test
133    public void killSkipmeYesNo() {
134      jedis.clientKill(new ClientKillParams().type(ClientType.NORMAL).skipMe(SkipMe.YES));
135      assertDisconnected(client);
136      assertEquals(1, jedis.clientKill(new ClientKillParams().type(ClientType.NORMAL).skipMe(SkipMe.NO)));
137      assertDisconnected(jedis);
138    }
139    @Test
140    public void killAddrString() {
141      String info = findInClientList();
142      Matcher matcher = Pattern.compile("\\baddr=(\\S+)\\b").matcher(info);
143      matcher.find();
144      String addr = matcher.group(1);
145      assertEquals(1, jedis.clientKill(new ClientKillParams().addr(addr)));
146      assertDisconnected(client);
147    }
148    @Test
149    public void killAddrBinary() {
150      String info = findInClientList();
151      Matcher matcher = Pattern.compile("\\baddr=(\\S+)\\b").matcher(info);
152      matcher.find();
153      String addr = matcher.group(1);
154      assertEquals(1, jedis.clientKill(new ClientKillParams().addr(addr)));
155      assertDisconnected(client);
156    }
157    @Test
158    public void killLAddr() {
159      String info = findInClientList();
160      Matcher matcher = Pattern.compile("\\bladdr=(\\S+)\\b").matcher(info);
161      matcher.find();
162      String laddr = matcher.group(1);
163      long clients = jedis.clientKill(new ClientKillParams().laddr(laddr));
164      assertTrue(clients >= 1);
165      assertDisconnected(client);
166    }
167    @Test
168    public void killAddrIpPort() {
169      String info = findInClientList();
170      Matcher matcher = Pattern.compile("\\baddr=(\\S+)\\b").matcher(info);
171      matcher.find();
172      String addr = matcher.group(1);
173      int lastColon = addr.lastIndexOf(":");
174      String[] hp = new String[]{addr.substring(0, lastColon), addr.substring(lastColon + 1)};
175      assertEquals(1, jedis.clientKill(new ClientKillParams().addr(hp[0], Integer.parseInt(hp[1]))));
176      assertDisconnected(client);
177    }
178    @Test
179    public void killUser() {
180      Jedis client2 = new Jedis(hnp.getHost(), hnp.getPort(), 500);
181      client.aclSetUser("test_kill", "on", "+acl", ">password1");
182      try {
183        client2.auth("test_kill", "password1");
184        assertEquals(1, jedis.clientKill(new ClientKillParams().user("test_kill")));
185        assertDisconnected(client2);
186      } finally {
187        jedis.aclDelUser("test_kill");
188      }
189    }
190    @Test
191    public void clientInfo() {
192      String info = client.clientInfo();
193      assertNotNull(info);
194      assertEquals(1, info.split("\n").length);
195      assertTrue(info.contains(clientName));
196    }
197    @Test
198    public void clientListWithClientId() {
199      long id = client.clientId();
200      String listInfo = jedis.clientList(id);
201      assertNotNull(listInfo);
202      assertTrue(listInfo.contains(clientName));
203    }
204    @Test
205    public void listWithType() {
206      assertTrue(client.clientList(ClientType.NORMAL).split("\\n").length > 1);
207      assertEquals(0, client.clientList(ClientType.MASTER).length());
208      assertEquals(1, client.clientList(ClientType.SLAVE).split("\\n").length);
209      assertEquals(1, client.clientList(ClientType.REPLICA).split("\\n").length);
210      assertEquals(1, client.clientList(ClientType.PUBSUB).split("\\n").length);
211    }
212    private void assertDisconnected(Jedis j) {
213      try {
214        j.ping();
215        fail("Jedis connection should be disconnected");
216      } catch (JedisConnectionException jce) {
217      }
218    }
219    private String findInClientList() {
220      for (String clientInfo : jedis.clientList().split("\n")) {
221        if (pattern.matcher(clientInfo).find()) {
222          return clientInfo;
223        }
224      }
225      return null;
226    }
227  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from BungeeCord-MDEwOlJlcG9zaXRvcnk2MDg0MjEw-flat-ChatComponentTransformer.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ClientCommandsTest.java</div>
                </div>
                <div class="column column_space"><pre><code>1  package net.md_5.bungee.util;
2  import com.google.common.base.Preconditions;
3  import com.google.common.collect.Lists;
4  import java.util.List;
5  import java.util.regex.Pattern;
6  import lombok.AccessLevel;
7  import lombok.NoArgsConstructor;
8  import net.md_5.bungee.api.chat.BaseComponent;
9  import net.md_5.bungee.api.chat.ScoreComponent;
10  import net.md_5.bungee.api.chat.TextComponent;
11  import net.md_5.bungee.api.chat.hover.content.Content;
12  import net.md_5.bungee.api.connection.ProxiedPlayer;
13  import net.md_5.bungee.api.score.Score;
14  import net.md_5.bungee.protocol.ProtocolConstants;
</pre></code></div>
                <div class="column column_space"><pre><code>1  package redis.clients.jedis.commands.jedis;
2  import static org.junit.Assert.assertArrayEquals;
3  import static org.junit.Assert.assertEquals;
4  import static org.junit.Assert.assertNotNull;
5  import static org.junit.Assert.assertTrue;
6  import static org.junit.Assert.fail;
7  import static redis.clients.jedis.params.ClientKillParams.SkipMe;
8  import java.util.concurrent.ExecutionException;
9  import java.util.concurrent.Executors;
10  import java.util.concurrent.Future;
11  import java.util.concurrent.TimeUnit;
12  import java.util.concurrent.TimeoutException;
13  import java.util.regex.Matcher;
14  import java.util.regex.Pattern;
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    