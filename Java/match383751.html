<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for AggregationProjection.java &amp; TextFieldMapper.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for AggregationProjection.java &amp; TextFieldMapper.java
      </h3>
<h1 align="center">
        24.4%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>AggregationProjection.java (31.081081%)<th>TextFieldMapper.java (20.175438%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(87-97)<td><a href="#" name="0">(190-200)</a><td align="center"><font color="#ff0000">14</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(30-48)<td><a href="#" name="1">(22-40)</a><td align="center"><font color="#ec0000">13</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(79-86)<td><a href="#" name="2">(178-185)</a><td align="center"><font color="#b60000">10</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(105-108)<td><a href="#" name="3">(167-171)</a><td align="center"><font color="#a30000">9</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>AggregationProjection.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 package io.crate.execution.dsl.projection;
2 import io.crate.common.collections.Lists2;
3 import io.crate.common.collections.MapBuilder;
4 import io.crate.expression.symbol.AggregateMode;
5 <a name="1"></a>import io.crate.expression.symbol.Aggregation;
6 import io.crate.expression.symbol.SelectSymbol;
7 import io.crate.expression.symbol.Symbol;
8 <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>import io.crate.expression.symbol.SymbolVisitors;
9 import io.crate.expression.symbol.Symbols;
10 import io.crate.metadata.RowGranularity;
11 import org.elasticsearch.common.io.stream.StreamInput;
12 import org.elasticsearch.common.io.stream.StreamOutput;
13 import java.io.IOException;
14 import java.util.ArrayList;
15 import java.util.List;
16 import java.util.Map;
17 import java.util.Objects;
18 public class AggregationProjection extends Projection {
19     private final RowGranularity contextGranularity;
20     private final AggregateMode mode</b></font>;
21     private final List&lt;Aggregation&gt; aggregations;
22     public AggregationProjection(StreamInput in) throws IOException {
23         int size = in.readVInt();
24         aggregations = new ArrayList&lt;&gt;(size);
25         for (int i = 0; i &lt; size; i++) {
26             aggregations.add((Aggregation) Symbols.fromStream(in));
27         }
28         contextGranularity = RowGranularity.fromStream(in);
29         mode = AggregateMode.readFrom(in);
30     }
31     public AggregationProjection(List&lt;Aggregation&gt; aggregations, RowGranularity contextGranularity, AggregateMode mode) {
32         assert aggregations != null : "aggregations must not be null";
33         assert aggregations.stream().noneMatch(s -&gt;
34             SymbolVisitors.any(Symbols.IS_COLUMN.or(x -&gt; x instanceof SelectSymbol), s))
35             : "Cannot operate on Reference, Field or SelectSymbol symbols: " + aggregations;
36         this.contextGranularity = contextGranularity;
37         this.mode = mode;
38         this.aggregations = aggregations;
39     }
40     @Override
41     public RowGranularity requiredGranularity() {
42         return contextGranularity;
43     }
44 <a name="2"></a>
45     public List&lt;Aggregation&gt; aggregations() {
46         return aggregations;
47     <font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}
48     @Override
49     public ProjectionType projectionType() {
50         return ProjectionType.AGGREGATION;
51 <a name="0"></a>    }
52     @</b></font>Override
53     public &lt;C, R&gt; R accept(ProjectionVisitor&lt;C, R&gt; visitor, C context) <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>{
54         return visitor.visitAggregationProjection(this, context);
55     }
56     @Override
57     public List&lt;? extends Symbol&gt; outputs() {
58         return aggregations;
59     }
60     @Override
61     public void writeTo(StreamOutput out</b></font>) throws IOException {
62         Symbols.toStream(aggregations, out);
63         RowGranularity.toStream(contextGranularity, out);
64         AggregateMode.writeTo(mode, out);
65     }
66 <a name="3"></a>
67     @Override
68     public boolean equals(Object o) {
69         <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>if (this == o) {
70             return true;
71         }
72         if (o == null || getClass() != o.getClass()) {</b></font>
73             return false;
74         }
75         AggregationProjection that = (AggregationProjection) o;
76         return contextGranularity == that.contextGranularity &amp;&amp;
77                mode == that.mode &amp;&amp;
78                Objects.equals(aggregations, that.aggregations);
79     }
80     @Override
81     public int hashCode() {
82         return Objects.hash(super.hashCode(), contextGranularity, mode, aggregations);
83     }
84     public AggregateMode mode() {
85         return mode;
86     }
87     @Override
88     public Map&lt;String, Object&gt; mapRepresentation() {
89         return MapBuilder.&lt;String, Object&gt;newMapBuilder()
90             .put("type", "HashAggregation")
91             .put("aggregations", '[' + Lists2.joinOn(", ", aggregations, Aggregation::toString) + ']')
92             .map();
93     }
94 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>TextFieldMapper.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <a name="1"></a>
2 package org.elasticsearch.index.mapper;
3 <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>import static org.elasticsearch.index.mapper.TypeParsers.parseTextField;
4 import java.io.IOException;
5 import java.util.List;
6 import java.util.Map;
7 import org.apache.lucene.document.Field;
8 import org.apache.lucene.document.FieldType;
9 import org.apache.lucene.index.IndexOptions;
10 import org.apache.lucene.index.IndexableField;
11 import org.elasticsearch.common.settings.Settings;
12 import org.elasticsearch.common.xcontent.XContentBuilder;
13 public class TextFieldMapper extends FieldMapper {
14     public static final String CONTENT_TYPE = "text";
15     public static final String FAST_PHRASE_SUFFIX = "._index_phrase"</b></font>;
16     public static class Defaults {
17         public static final int FIELDDATA_MIN_SEGMENT_SIZE = 0;
18         public static final int INDEX_PREFIX_MIN_CHARS = 2;
19         public static final int INDEX_PREFIX_MAX_CHARS = 5;
20         public static final FieldType FIELD_TYPE = new FieldType();
21         static {
22             FIELD_TYPE.setTokenized(true);
23             FIELD_TYPE.setStored(false);
24             FIELD_TYPE.setStoreTermVectors(false);
25             FIELD_TYPE.setOmitNorms(false);
26             FIELD_TYPE.setIndexOptions(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS);
27             FIELD_TYPE.freeze();
28         }
29         public static final int POSITION_INCREMENT_GAP = 100;
30     }
31     public static class Builder extends FieldMapper.Builder&lt;Builder&gt; {
32         public Builder(String name) {
33             super(name, Defaults.FIELD_TYPE);
34             builder = this;
35         }
36         @Override
37         public Builder docValues(boolean docValues) {
38             if (docValues) {
39                 throw new IllegalArgumentException("[text] fields do not support doc values");
40             }
41             return super.docValues(docValues);
42         }
43         private TextFieldType buildFieldType(BuilderContext context) {
44             TextFieldType ft = new TextFieldType(
45                 buildFullName(context),
46                 indexed,
47                 fieldType.indexOptions().compareTo(IndexOptions.DOCS_AND_FREQS_AND_POSITIONS) &gt;= 0);
48             ft.setIndexAnalyzer(indexAnalyzer);
49             ft.setSearchAnalyzer(searchAnalyzer);
50             ft.setSearchQuoteAnalyzer(searchQuoteAnalyzer);
51             return ft;
52         }
53         @Override
54         public TextFieldMapper build(BuilderContext context) {
55             TextFieldType tft = buildFieldType(context);
56             return new TextFieldMapper(
57                 name,
58                 position,
59                 defaultExpression,
60                 fieldType,
61                 tft,
62                 context.indexSettings(),
63                 multiFieldsBuilder.build(this, context),
64                 copyTo
65             );
66         }
67     }
68     public static class TypeParser implements Mapper.TypeParser {
69         @Override
70         public Mapper.Builder parse(String fieldName, Map&lt;String, Object&gt; node, ParserContext parserContext) throws MapperParsingException {
71             TextFieldMapper.Builder builder = new TextFieldMapper.Builder(fieldName);
72             builder.indexAnalyzer(parserContext.getIndexAnalyzers().getDefaultIndexAnalyzer());
73             builder.searchAnalyzer(parserContext.getIndexAnalyzers().getDefaultSearchAnalyzer());
74             builder.searchQuoteAnalyzer(parserContext.getIndexAnalyzers().getDefaultSearchQuoteAnalyzer());
75             parseTextField(builder, fieldName, node, parserContext);
76             return builder;
77         }
78     }
79     public static final class TextFieldType extends StringFieldType {
80         public TextFieldType(String name, boolean indexed, boolean hasPositions) {
81             super(name, indexed, false);
82             this.hasPositions = hasPositions;
83         }
84         public TextFieldType(String name) {
85             this(name, true, true);
86         }
87         @Override
88         public String typeName() {
89             return CONTENT_TYPE;
90         }
91     }
92     protected TextFieldMapper(String simpleName,
93                               Integer position,
94                               String defaultExpression,
95                               FieldType fieldType,
96                               TextFieldType mappedFieldType,
97                               Settings indexSettings,
98                               MultiFields multiFields,
99                               CopyTo copyTo) {
100         super(simpleName, position, defaultExpression, fieldType, mappedFieldType, indexSettings, multiFields, copyTo);
101         assert mappedFieldType.hasDocValues() == false;
102     }
103     @Override
104     protected TextFieldMapper clone() {
105         return (TextFieldMapper) super.clone();
106     }
107     @Override
108     protected void parseCreateField(ParseContext context, List&lt;IndexableField&gt; fields) throws IOException {
109         final String value;
110         if (context.externalValueSet()) {
111             value = context.externalValue().toString();
112         } else {
113 <a name="3"></a>            value = context.parser().textOrNull();
114         }
115         <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>if (value == null) {
116             return;
117         }
118         if (fieldType.indexOptions() != IndexOptions.NONE || fieldType.stored()) {</b></font>
119             Field field = new Field(fieldType().name(), value, fieldType);
120             fields.add(field);
121             if (fieldType.omitNorms()) {
122 <a name="2"></a>                createFieldNamesField(context, fields);
123             }
124         }
125     <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}
126     @Override
127     protected String contentType() {
128         return CONTENT_TYPE;
129     }
130     @</b></font>Override
131     protected void mergeOptions(FieldMapper other, List&lt;String&gt; conflicts) {
132 <a name="0"></a>    }
133     @Override
134     public TextFieldType fieldType() <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>{
135         return (TextFieldType) super.fieldType();
136     }
137     @Override
138     protected boolean docValuesByDefault() {
139         return false;
140     }
141     @Override
142     protected void doXContentBody(XContentBuilder builder</b></font>, boolean includeDefaults, Params params) throws IOException {
143         super.doXContentBody(builder, includeDefaults, params);
144         doXContentAnalyzers(builder, includeDefaults);
145     }
146 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
