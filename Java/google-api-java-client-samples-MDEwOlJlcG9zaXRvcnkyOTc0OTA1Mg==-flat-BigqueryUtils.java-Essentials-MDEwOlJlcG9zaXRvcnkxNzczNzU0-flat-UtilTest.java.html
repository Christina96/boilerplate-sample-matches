
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 4.1166380789022305%, Tokens: 12</h2>
        <div class="column">
            <h3>google-api-java-client-samples-MDEwOlJlcG9zaXRvcnkyOTc0OTA1Mg==-flat-BigqueryUtils.java</h3>
            <pre><code>1  package com.google.api.client.sample.bigquery.appengine.dashboard;
2  import com.google.api.client.util.Preconditions;
3  import com.google.api.services.bigquery.Bigquery;
4  import com.google.api.services.bigquery.model.Job;
5  import com.google.api.services.bigquery.model.JobConfiguration;
6  import com.google.api.services.bigquery.model.JobConfigurationQuery;
7  import com.google.api.services.bigquery.model.JobReference;
8  import com.google.api.services.bigquery.model.Table;
9  import com.google.api.services.bigquery.model.TableDataList;
10  import com.google.api.services.bigquery.model.TableFieldSchema;
11  import com.google.api.services.bigquery.model.TableReference;
12  import com.google.api.services.bigquery.model.TableRow;
<span onclick='openModal()' class='match'>13  import com.google.appengine.api.taskqueue.Queue;
14  import com.google.appengine.api.taskqueue.QueueFactory;
15  import com.google.appengine.api.taskqueue.RetryOptions;
16  import com.google.appengine.api.taskqueue.TaskOptions;
17  import com.google.common.base.Joiner;
18  import java.io.IOException;
19  import java.util.List;
20  import java.util.concurrent.Callable;
21  import java.util.logging.Logger;
22  import javax.servlet.http.HttpServletResponse;
23  public class BigqueryUtils {
24    private static final Logger log = Logger.getLogger(BigqueryUtils.class.getName());
</span>25    static final String projectId =
26        System.getProperty("com.google.api.client.sample.bigquery.appengine.dashboard.projectId");
27    private final String userId;
28    final Bigquery bigquery;
29    private Job job;
30    public BigqueryUtils(String userId) throws IOException {
31      this(userId, null);
32    }
33    public BigqueryUtils(String userId, final String jobId) throws IOException {
34      this.userId = userId;
35      bigquery = ServiceUtils.loadBigqueryClient(userId);
36      if (jobId != null) {
37        job = tryToDo(new Callable<Job>() {
38          @Override
39          public Job call() throws Exception {
40            return bigquery.jobs().get(projectId, jobId).execute();
41          }
42        });
43        if (job == null) {
44          throw new SampleDashboardException(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,
45              "Wasn't able to get a job for jobId " + jobId);
46        }
47      }
48    }
49    public void beginQuery() throws SampleDashboardException {
50      final Job queryJob = makeJob(buildExampleQuery());
51      job = tryToDo(new Callable<Job>() {
52        @Override
53        public Job call() throws Exception {
54          return bigquery.jobs().insert(projectId, queryJob).execute();
55        }
56      });
57      Preconditions.checkNotNull(job);
58      enqueueWaitingTask();
59    }
60    public boolean jobSucceeded() {
61      return (job != null && job.getStatus().getErrorResult() == null);
62    }
63    public String getJobErrorMessage() {
64      if (job != null && job.getStatus().getErrorResult() != null) {
65        return job.getStatus().getErrorResult().getMessage();
66      }
67      return "";
68    }
69    public boolean jobIsDone() {
70      String status = getJobStatus();
71      return (status != null && ("DONE").equalsIgnoreCase(status));
72    }
73    public String getJobStatus() {
74      return (job != null) ? job.getStatus().getState() : null;
75    }
76    public List<TableFieldSchema> getSchemaFieldNames() throws SampleDashboardException {
77      if (job != null) {
78        final TableReference tableReference = job.getConfiguration().getQuery().getDestinationTable();
79        Table table = tryToDo(new Callable<Table>() {
80          @Override
81          public Table call() throws IOException {
82            return bigquery.tables().get(tableReference.getProjectId(), tableReference.getDatasetId(),
83                tableReference.getTableId()).execute();
84          }
85        });
86        Preconditions.checkNotNull(table);
87        Preconditions.checkNotNull(table.getSchema());
88        Preconditions.checkNotNull(table.getSchema().getFields());
89        return table.getSchema().getFields();
90      }
91      return null;
92    }
93    public List<TableRow> getTableData() throws SampleDashboardException {
94      if (job != null) {
95        final TableReference tableReference = job.getConfiguration().getQuery().getDestinationTable();
96        TableDataList tableDataList = tryToDo(new Callable<TableDataList>() {
97          @Override
98          public TableDataList call() throws IOException {
99            return bigquery.tabledata().list(tableReference.getProjectId(),
100                tableReference.getDatasetId(), tableReference.getTableId()).execute();
101          }
102        });
103        Preconditions.checkNotNull(tableDataList);
104        Preconditions.checkNotNull(tableDataList.getRows());
105        return tableDataList.getRows();
106      }
107      return null;
108    }
109    public void enqueueWaitingTask() {
110      TaskOptions options = TaskOptions.Builder.withDefaults();
111      options.param("jobId", job.getJobReference().getJobId());
112      options.param("userId", userId);
113      options.url("/task");
114      options.countdownMillis(1000);
115      options.retryOptions(RetryOptions.Builder.withTaskRetryLimit(0));
116      Queue queue = QueueFactory.getDefaultQueue();
117      queue.add(options);
118    }
119    public static String buildExampleQuery() {
120      String[] west = {"WA", "OR", "CA", "AK", "HI", "ID", "MT", "WY", "NV", "UT", "CO", "AZ", "NM"};
121      String[] south = {"OK", "TX", "AR", "LA", "TN", "MS", "AL", "KY", "GA", "FL", "SC", "NC", "VA",
122                  "WV", "MD", "DC", "DE"};
123      String[] midwest = {"ND", "SD", "NE", "KS", "MN", "IA", "MO", "WI", "IL", "IN", "MI", "OH"};
124      String[] northeast = {"NY", "PA", "NJ", "CT", "RI", "MA", "VT", "NH", "ME"};
125      Joiner joiner = Joiner.on("', '");
126      String query = "SELECT IF (state IN ('" + joiner.join(west) + "'), 'West', \n\t"
127          + "IF (state IN ('" + joiner.join(south) + "'), 'South', \n\t" + "IF (state IN ('"
128          + joiner.join(midwest) + "'), 'Midwest', \n\t" + "IF (state IN ('" + joiner.join(northeast)
129          + "'), 'Northeast', 'None')))) "
130          + "as region, \naverage_mother_age, \naverage_father_age, \nstate, \nyear \n"
131          + "FROM (SELECT year, \n\t\tstate, \n\t\tSUM(mother_age)/COUNT(mother_age) as "
132          + "average_mother_age, \n\t\tSUM(father_age)/COUNT(father_age) as average_father_age \n\t"
133          + "FROM publicdata:samples.natality \n\tWHERE father_age < 99 \n\tGROUP BY year, state) \n"
134          + "ORDER BY year, region;";
135      return query;
136    }
137    private Job makeJob(String query) {
138      JobConfigurationQuery jobconfigurationquery = new JobConfigurationQuery();
139      jobconfigurationquery.setQuery(query);
140      jobconfigurationquery.setCreateDisposition("CREATE_IF_NEEDED");
141      JobConfiguration jobconfiguration = new JobConfiguration();
142      jobconfiguration.setQuery(jobconfigurationquery);
143      JobReference jobreference = new JobReference();
144      jobreference.setProjectId(projectId);
145      Job newJob = new Job();
146      newJob.setConfiguration(jobconfiguration);
147      newJob.setJobReference(jobreference);
148      return newJob;
149    }
150    private <T> T tryToDo(Callable<T> callback) throws SampleDashboardException {
151      int retries = 3;
152      int currentTry = 0;
153      SampleDashboardException sdex = null;
154      while (currentTry < retries) {
155        currentTry++;
156        try {
157          return callback.call();
158        } catch (Exception ex) {
159          sdex = new SampleDashboardException(ex);
160          log.warning("Caught exception (" + sdex.getStatusCode() + "): " + ex);
161        }
162      }
163      throw Preconditions.checkNotNull(sdex);
164    }
165  }
</code></pre>
        </div>
        <div class="column">
            <h3>Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-UtilTest.java</h3>
            <pre><code>1  package com.earth2me.essentials;
<span onclick='openModal()' class='match'>2  import com.earth2me.essentials.utils.DateUtil;
3  import com.earth2me.essentials.utils.LocationUtil;
4  import java.io.IOException;
5  import java.util.Calendar;
6  import java.util.GregorianCalendar;
7  import java.util.HashSet;
8  import java.util.Set;
9  import junit.framework.TestCase;
10  import org.bukkit.World.Environment;
11  import org.bukkit.plugin.InvalidDescriptionException;
12  public class UtilTest extends TestCase
13  {
14  	private final Essentials ess;
</span>15  	private final FakeServer server;
16  	public UtilTest()
17  	{
18  		server = new FakeServer();
19  		server.createWorld("testWorld", Environment.NORMAL);
20  		ess = new Essentials(server);
21  		try
22  		{
23  			ess.setupForTesting(server);
24  		}
25  		catch (InvalidDescriptionException ex)
26  		{
27  			fail("InvalidDescriptionException");
28  		}
29  		catch (IOException ex)
30  		{
31  			fail("IOException");
32  		}
33  	}
34  	public void testSafeLocation()
35  	{
36  		Set<String> testSet = new HashSet<String>();
37  		int count = 0;
38  		int x, y, z, origX, origY, origZ;
39  		x = y = z = origX = origY = origZ = 0;
40  		int i = 0;
41  		while (true)
42  		{
43  			testSet.add(x + ":" + y + ":" + z);
44  			count++;
45  			i++;
46  			if (i >= LocationUtil.VOLUME.length)
47  			{
48  				break;
49  			}
50  			x = origX + LocationUtil.VOLUME[i].x;
51  			y = origY + LocationUtil.VOLUME[i].y;
52  			z = origZ + LocationUtil.VOLUME[i].z;
53  		}
54  		assertTrue(testSet.contains("0:0:0"));
55  		assertTrue(testSet.contains("3:3:3"));
56  		assertEquals(testSet.size(), count);
57  		int diameter = LocationUtil.RADIUS * 2 + 1;
58  		assertEquals(diameter * diameter * diameter, count);
59  	}
60  	public void testFDDnow()
61  	{
62  		Calendar c = new GregorianCalendar();
63  		String resp = DateUtil.formatDateDiff(c, c);
64  		assertEquals(resp, "now");
65  	}
66  	public void testFDDfuture()
67  	{
68  		Calendar a, b;
69  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
70  		b = new GregorianCalendar(2010, 1, 1, 10, 0, 1);
71  		assertEquals("1 second", DateUtil.formatDateDiff(a, b));
72  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
73  		b = new GregorianCalendar(2010, 1, 1, 10, 0, 2);
74  		assertEquals("2 seconds", DateUtil.formatDateDiff(a, b));
75  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
76  		b = new GregorianCalendar(2010, 1, 1, 10, 0, 3);
77  		assertEquals("3 seconds", DateUtil.formatDateDiff(a, b));
78  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
79  		b = new GregorianCalendar(2010, 1, 1, 10, 1, 0);
80  		assertEquals("1 minute", DateUtil.formatDateDiff(a, b));
81  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
82  		b = new GregorianCalendar(2010, 1, 1, 10, 2, 0);
83  		assertEquals("2 minutes", DateUtil.formatDateDiff(a, b));
84  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
85  		b = new GregorianCalendar(2010, 1, 1, 10, 3, 0);
86  		assertEquals("3 minutes", DateUtil.formatDateDiff(a, b));
87  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
88  		b = new GregorianCalendar(2010, 1, 1, 11, 0, 0);
89  		assertEquals("1 hour", DateUtil.formatDateDiff(a, b));
90  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
91  		b = new GregorianCalendar(2010, 1, 1, 12, 0, 0);
92  		assertEquals("2 hours", DateUtil.formatDateDiff(a, b));
93  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
94  		b = new GregorianCalendar(2010, 1, 1, 13, 0, 0);
95  		assertEquals("3 hours", DateUtil.formatDateDiff(a, b));
96  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
97  		b = new GregorianCalendar(2010, 1, 2, 10, 0, 0);
98  		assertEquals("1 day", DateUtil.formatDateDiff(a, b));
99  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
100  		b = new GregorianCalendar(2010, 1, 3, 10, 0, 0);
101  		assertEquals("2 days", DateUtil.formatDateDiff(a, b));
102  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
103  		b = new GregorianCalendar(2010, 1, 4, 10, 0, 0);
104  		assertEquals("3 days", DateUtil.formatDateDiff(a, b));
105  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
106  		b = new GregorianCalendar(2010, 2, 1, 10, 0, 0);
107  		assertEquals("1 month", DateUtil.formatDateDiff(a, b));
108  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
109  		b = new GregorianCalendar(2010, 3, 1, 10, 0, 0);
110  		assertEquals("2 months", DateUtil.formatDateDiff(a, b));
111  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
112  		b = new GregorianCalendar(2010, 4, 1, 10, 0, 0);
113  		assertEquals("3 months", DateUtil.formatDateDiff(a, b));
114  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
115  		b = new GregorianCalendar(2011, 1, 1, 10, 0, 0);
116  		assertEquals("1 year", DateUtil.formatDateDiff(a, b));
117  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
118  		b = new GregorianCalendar(2012, 1, 1, 10, 0, 0);
119  		assertEquals("2 years", DateUtil.formatDateDiff(a, b));
120  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
121  		b = new GregorianCalendar(2013, 1, 1, 10, 0, 0);
122  		assertEquals("3 years", DateUtil.formatDateDiff(a, b));
123  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
124  		b = new GregorianCalendar(2011, 4, 5, 23, 38, 12);
125  		assertEquals("1 year 3 months 4 days", DateUtil.formatDateDiff(a, b));
126  		a = new GregorianCalendar(2010, 9, 17, 23, 45, 45);
127  		b = new GregorianCalendar(2015, 3, 7, 10, 0, 0);
128  		assertEquals("4 years 5 months 20 days", DateUtil.formatDateDiff(a, b));
129  		a = new GregorianCalendar(2011, 4, 31, 10, 0, 0);
130  		b = new GregorianCalendar(2011, 4, 31, 10, 5, 0);
131  		assertEquals("5 minutes", DateUtil.formatDateDiff(a, b));
132  	}
133  	public void testFDDpast()
134  	{
135  		Calendar a, b;
136  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
137  		b = new GregorianCalendar(2010, 1, 1, 9, 59, 59);
138  		assertEquals("1 second", DateUtil.formatDateDiff(a, b));
139  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
140  		b = new GregorianCalendar(2010, 1, 1, 9, 59, 58);
141  		assertEquals("2 seconds", DateUtil.formatDateDiff(a, b));
142  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
143  		b = new GregorianCalendar(2010, 1, 1, 9, 59, 57);
144  		assertEquals("3 seconds", DateUtil.formatDateDiff(a, b));
145  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
146  		b = new GregorianCalendar(2010, 1, 1, 9, 59, 0);
147  		assertEquals("1 minute", DateUtil.formatDateDiff(a, b));
148  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
149  		b = new GregorianCalendar(2010, 1, 1, 9, 58, 0);
150  		assertEquals("2 minutes", DateUtil.formatDateDiff(a, b));
151  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
152  		b = new GregorianCalendar(2010, 1, 1, 9, 57, 0);
153  		assertEquals("3 minutes", DateUtil.formatDateDiff(a, b));
154  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
155  		b = new GregorianCalendar(2010, 1, 1, 9, 0, 0);
156  		assertEquals("1 hour", DateUtil.formatDateDiff(a, b));
157  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
158  		b = new GregorianCalendar(2010, 1, 1, 8, 0, 0);
159  		assertEquals("2 hours", DateUtil.formatDateDiff(a, b));
160  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
161  		b = new GregorianCalendar(2010, 1, 1, 7, 0, 0);
162  		assertEquals("3 hours", DateUtil.formatDateDiff(a, b));
163  		a = new GregorianCalendar(2010, 1, 5, 10, 0, 0);
164  		b = new GregorianCalendar(2010, 1, 4, 10, 0, 0);
165  		assertEquals("1 day", DateUtil.formatDateDiff(a, b));
166  		a = new GregorianCalendar(2010, 1, 5, 10, 0, 0);
167  		b = new GregorianCalendar(2010, 1, 3, 10, 0, 0);
168  		assertEquals("2 days", DateUtil.formatDateDiff(a, b));
169  		a = new GregorianCalendar(2010, 1, 5, 10, 0, 0);
170  		b = new GregorianCalendar(2010, 1, 2, 10, 0, 0);
171  		assertEquals("3 days", DateUtil.formatDateDiff(a, b));
172  		a = new GregorianCalendar(2010, 5, 1, 10, 0, 0);
173  		b = new GregorianCalendar(2010, 4, 1, 10, 0, 0);
174  		assertEquals("1 month", DateUtil.formatDateDiff(a, b));
175  		a = new GregorianCalendar(2010, 5, 1, 10, 0, 0);
176  		b = new GregorianCalendar(2010, 3, 1, 10, 0, 0);
177  		assertEquals("2 months", DateUtil.formatDateDiff(a, b));
178  		a = new GregorianCalendar(2010, 5, 1, 10, 0, 0);
179  		b = new GregorianCalendar(2010, 2, 1, 10, 0, 0);
180  		assertEquals("3 months", DateUtil.formatDateDiff(a, b));
181  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
182  		b = new GregorianCalendar(2009, 1, 1, 10, 0, 0);
183  		assertEquals("1 year", DateUtil.formatDateDiff(a, b));
184  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
185  		b = new GregorianCalendar(2008, 1, 1, 10, 0, 0);
186  		assertEquals("2 years", DateUtil.formatDateDiff(a, b));
187  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
188  		b = new GregorianCalendar(2007, 1, 1, 10, 0, 0);
189  		assertEquals("3 years", DateUtil.formatDateDiff(a, b));
190  		a = new GregorianCalendar(2010, 1, 1, 10, 0, 0);
191  		b = new GregorianCalendar(2009, 4, 5, 23, 38, 12);
192  		assertEquals("8 months 26 days 10 hours", DateUtil.formatDateDiff(a, b));
193  		a = new GregorianCalendar(2010, 9, 17, 23, 45, 45);
194  		b = new GregorianCalendar(2000, 3, 7, 10, 0, 0);
195  		assertEquals("10 years 6 months 10 days", DateUtil.formatDateDiff(a, b));
196  	}
197  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from google-api-java-client-samples-MDEwOlJlcG9zaXRvcnkyOTc0OTA1Mg==-flat-BigqueryUtils.java</div>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-UtilTest.java</div>
                <div class="column column_space"><pre><code>13  import com.google.appengine.api.taskqueue.Queue;
14  import com.google.appengine.api.taskqueue.QueueFactory;
15  import com.google.appengine.api.taskqueue.RetryOptions;
16  import com.google.appengine.api.taskqueue.TaskOptions;
17  import com.google.common.base.Joiner;
18  import java.io.IOException;
19  import java.util.List;
20  import java.util.concurrent.Callable;
21  import java.util.logging.Logger;
22  import javax.servlet.http.HttpServletResponse;
23  public class BigqueryUtils {
24    private static final Logger log = Logger.getLogger(BigqueryUtils.class.getName());
</pre></code></div>
                <div class="column column_space"><pre><code>2  import com.earth2me.essentials.utils.DateUtil;
3  import com.earth2me.essentials.utils.LocationUtil;
4  import java.io.IOException;
5  import java.util.Calendar;
6  import java.util.GregorianCalendar;
7  import java.util.HashSet;
8  import java.util.Set;
9  import junit.framework.TestCase;
10  import org.bukkit.World.Environment;
11  import org.bukkit.plugin.InvalidDescriptionException;
12  public class UtilTest extends TestCase
13  {
14  	private final Essentials ess;
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    