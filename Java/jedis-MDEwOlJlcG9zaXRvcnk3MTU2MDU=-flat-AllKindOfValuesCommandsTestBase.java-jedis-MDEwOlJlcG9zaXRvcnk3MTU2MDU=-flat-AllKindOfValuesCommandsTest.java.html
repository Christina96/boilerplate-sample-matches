
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 429, <button onclick='openModal()' class='match'>CODE CLONE</button></h2>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-AllKindOfValuesCommandsTestBase.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.unified;
2  import static org.hamcrest.MatcherAssert.assertThat;
3  import static org.junit.Assert.assertArrayEquals;
4  import static org.junit.Assert.assertEquals;
5  import static org.junit.Assert.assertFalse;
6  import static org.junit.Assert.assertTrue;
7  import static org.junit.Assert.assertNotNull;
8  import static org.junit.Assert.assertNull;
9  import static org.junit.Assert.fail;
10  import static redis.clients.jedis.Protocol.Command.BLPOP;
11  import static redis.clients.jedis.Protocol.Command.GET;
12  import static redis.clients.jedis.Protocol.Command.HGETALL;
13  import static redis.clients.jedis.Protocol.Command.LRANGE;
14  import static redis.clients.jedis.Protocol.Command.PING;
15  import static redis.clients.jedis.Protocol.Command.RPUSH;
16  import static redis.clients.jedis.Protocol.Command.SET;
17  import static redis.clients.jedis.Protocol.Command.XINFO;
18  import static redis.clients.jedis.util.SafeEncoder.encode;
19  import static redis.clients.jedis.util.SafeEncoder.encodeObject;
20  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START;
21  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START_BINARY;
22  import java.util.ArrayList;
23  import java.util.Arrays;
24  import java.util.Collections;
25  import java.util.HashMap;
26  import java.util.HashSet;
27  import java.util.List;
28  import java.util.Set;
29  import org.hamcrest.Matchers;
30  import org.junit.Assume;
31  import org.junit.Test;
32  import redis.clients.jedis.RedisProtocol;
33  import redis.clients.jedis.ScanIteration;
34  import redis.clients.jedis.StreamEntryID;
35  import redis.clients.jedis.args.ExpiryOption;
36  import redis.clients.jedis.params.ScanParams;
37  import redis.clients.jedis.resps.ScanResult;
38  import redis.clients.jedis.params.RestoreParams;
39  import redis.clients.jedis.exceptions.JedisDataException;
40  import redis.clients.jedis.params.SetParams;
41  import redis.clients.jedis.util.AssertUtil;
42  import redis.clients.jedis.util.KeyValue;
43  import redis.clients.jedis.util.RedisProtocolUtil;
44  import redis.clients.jedis.util.SafeEncoder;
45  public abstract class AllKindOfValuesCommandsTestBase extends UnifiedJedisCommandsTestBase {
46    protected final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
47    protected final byte[] bfoo1 = { 0x01, 0x02, 0x03, 0x04, 0x0A };
48    protected final byte[] bfoo2 = { 0x01, 0x02, 0x03, 0x04, 0x0B };
49    protected final byte[] bfoo3 = { 0x01, 0x02, 0x03, 0x04, 0x0C };
50    protected final byte[] bbar = { 0x05, 0x06, 0x07, 0x08 };
51    protected final byte[] bbar1 = { 0x05, 0x06, 0x07, 0x08, 0x0A };
52    protected final byte[] bbar2 = { 0x05, 0x06, 0x07, 0x08, 0x0B };
53    protected final byte[] bbar3 = { 0x05, 0x06, 0x07, 0x08, 0x0C };
54    protected final byte[] bfoobar = { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08 };
55    protected final byte[] bfoostar = { 0x01, 0x02, 0x03, 0x04, &#x27;*&#x27; };
56    protected final byte[] bbarstar = { 0x05, 0x06, 0x07, 0x08, &#x27;*&#x27; };
57    protected final byte[] bnx = { 0x6E, 0x78 };
58    protected final byte[] bex = { 0x65, 0x78 };
59    final int expireSeconds = 2;
60    @Test
61    public void exists() {
62      String status = jedis.set(&quot;foo&quot;, &quot;bar&quot;);
63      assertEquals(&quot;OK&quot;, status);
64      status = jedis.set(bfoo, bbar);
65      assertEquals(&quot;OK&quot;, status);
66      assertTrue(jedis.exists(&quot;foo&quot;));
67      assertTrue(jedis.exists(bfoo));
68      assertEquals(1L, jedis.del(&quot;foo&quot;));
69      assertEquals(1L, jedis.del(bfoo));
70      assertFalse(jedis.exists(&quot;foo&quot;));
71      assertFalse(jedis.exists(bfoo));
72    }
73    @Test
74    public void existsMany() {
75      String status = jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
76      assertEquals(&quot;OK&quot;, status);
77      status = jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
78      assertEquals(&quot;OK&quot;, status);
79      assertEquals(2L, jedis.exists(&quot;foo1&quot;, &quot;foo2&quot;));
80      assertEquals(1L, jedis.del(&quot;foo1&quot;));
81      assertEquals(1L, jedis.exists(&quot;foo1&quot;, &quot;foo2&quot;));
82    }
83    @Test
84    public void del() {
85      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
86      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
87      jedis.set(&quot;foo3&quot;, &quot;bar3&quot;);
88      assertEquals(3L, jedis.del(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
89      assertFalse(jedis.exists(&quot;foo1&quot;));
90      assertFalse(jedis.exists(&quot;foo2&quot;));
91      assertFalse(jedis.exists(&quot;foo3&quot;));
92      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
93      assertEquals(1L, jedis.del(&quot;foo1&quot;, &quot;foo2&quot;));
94      assertEquals(0L, jedis.del(&quot;foo1&quot;, &quot;foo2&quot;));
95      jedis.set(bfoo1, bbar1);
96      jedis.set(bfoo2, bbar2);
97      jedis.set(bfoo3, bbar3);
98      assertEquals(3L, jedis.del(bfoo1, bfoo2, bfoo3));
99      assertFalse(jedis.exists(bfoo1));
100      assertFalse(jedis.exists(bfoo2));
101      assertFalse(jedis.exists(bfoo3));
102      jedis.set(bfoo1, bbar1);
103      assertEquals(1, jedis.del(bfoo1, bfoo2));
104      assertEquals(0, jedis.del(bfoo1, bfoo2));
105    }
106    @Test
107    public void unlink() {
108      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
109      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
110      jedis.set(&quot;foo3&quot;, &quot;bar3&quot;);
111      assertEquals(3, jedis.unlink(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
112      assertEquals(0, jedis.exists(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
113      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
114      assertEquals(1, jedis.unlink(&quot;foo1&quot;, &quot;foo2&quot;));
115      assertEquals(0, jedis.unlink(&quot;foo1&quot;, &quot;foo2&quot;));
116      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
117      assertEquals(1, jedis.unlink(&quot;foo&quot;));
118      assertFalse(jedis.exists(&quot;foo&quot;));
119      jedis.set(bfoo1, bbar1);
120      jedis.set(bfoo2, bbar2);
121      jedis.set(bfoo3, bbar3);
122      assertEquals(3, jedis.unlink(bfoo1, bfoo2, bfoo3));
123      assertEquals(0, jedis.exists(bfoo1, bfoo2, bfoo3));
124      jedis.set(bfoo1, bbar1);
125      assertEquals(1, jedis.unlink(bfoo1, bfoo2));
126      assertEquals(0, jedis.unlink(bfoo1, bfoo2));
127      jedis.set(bfoo, bbar);
128      assertEquals(1, jedis.unlink(bfoo));
129      assertFalse(jedis.exists(bfoo));
130    }
131    @Test
132    public void type() {
133      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
134      assertEquals(&quot;string&quot;, jedis.type(&quot;foo&quot;));
135      jedis.set(bfoo, bbar);
136      assertEquals(&quot;string&quot;, jedis.type(bfoo));
137    }
138    @Test
139    public void keys() {
140      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
141      jedis.set(&quot;foobar&quot;, &quot;bar&quot;);
142      Set&lt;String&gt; keys = jedis.keys(&quot;foo*&quot;);
143      AssertUtil.assertCollectionContains(keys, &quot;foo&quot;);
144      AssertUtil.assertCollectionContains(keys, &quot;foobar&quot;);
145      assertEquals(Collections.emptySet(), jedis.keys(&quot;bar*&quot;));
146      jedis.set(bfoo, bbar);
147      jedis.set(bfoobar, bbar);
148      Set&lt;byte[]&gt; bkeys = jedis.keys(bfoostar);
149      AssertUtil.assertByteArrayCollectionContains(bkeys, bfoo);
150      AssertUtil.assertByteArrayCollectionContains(bkeys, bfoobar);
151      assertEquals(Collections.emptySet(), jedis.keys(bbarstar));
152    }
153    @Test
154    public void randomKey() {
155      assertNull(jedis.randomKey());
156      for (int i = 0; i &lt; 100; i++) {
157        jedis.set(&quot;foo&quot; + i, &quot;bar&quot;+i);
158      }
159      String key = jedis.randomKey();
160      assertNotNull(key);
161      assertTrue(key.startsWith(&quot;foo&quot;));
162      assertEquals(key.replace(&quot;foo&quot;, &quot;bar&quot;), jedis.get(key));
163    }
164    @Test
165    public void rename() {
166      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
167      String status = jedis.rename(&quot;foo&quot;, &quot;bar&quot;);
168      assertEquals(&quot;OK&quot;, status);
169      assertNull(jedis.get(&quot;foo&quot;));
170      assertEquals(&quot;bar&quot;, jedis.get(&quot;bar&quot;));
171      jedis.set(bfoo, bbar);
172      String bstatus = jedis.rename(bfoo, bbar);
173      assertEquals(&quot;OK&quot;, bstatus);
174      assertNull(jedis.get(bfoo));
175      assertArrayEquals(bbar, jedis.get(bbar));
176    }
177    @Test
178    public void renameOldAndNewAreTheSame() {
179      assertEquals(&quot;OK&quot;, jedis.set(&quot;foo&quot;, &quot;bar&quot;));
180      assertEquals(&quot;OK&quot;, jedis.rename(&quot;foo&quot;, &quot;foo&quot;));
181      assertEquals(&quot;OK&quot;, jedis.set(bfoo, bbar));
182      assertEquals(&quot;OK&quot;, jedis.rename(bfoo, bfoo));
183    }
184    @Test
185    public void renamenx() {
186      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
187      assertEquals(1, jedis.renamenx(&quot;foo&quot;, &quot;bar&quot;));
188      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
189      assertEquals(0, jedis.renamenx(&quot;foo&quot;, &quot;bar&quot;));
190      jedis.set(bfoo, bbar);
191      assertEquals(1, jedis.renamenx(bfoo, bbar));
192      jedis.set(bfoo, bbar);
193      assertEquals(0, jedis.renamenx(bfoo, bbar));
194    }
195    @Test
196    public void dbSize() {
197      assertEquals(0, jedis.dbSize());
198      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
199      assertEquals(1, jedis.dbSize());
200      jedis.set(bfoo, bbar);
201      assertEquals(2, jedis.dbSize());
202    }
203    @Test
204    public void expire() {
205      assertEquals(0, jedis.expire(&quot;foo&quot;, 20L));
206      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
207      assertEquals(1, jedis.expire(&quot;foo&quot;, 20L));
208      assertEquals(0, jedis.expire(&quot;foo&quot;, 20L, ExpiryOption.NX));
209      assertEquals(0, jedis.expire(bfoo, 20L));
210      jedis.set(bfoo, bbar);
211      assertEquals(1, jedis.expire(bfoo, 20L));
212      assertEquals(0, jedis.expire(bfoo, 20L, ExpiryOption.NX));
213    }
214    @Test
215    public void expireAt() {
216      long unixTime = (System.currentTimeMillis() / 1000L) + 20;
217      assertEquals(0, jedis.expireAt(&quot;foo&quot;, unixTime));
218      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
219      unixTime = (System.currentTimeMillis() / 1000L) + 20;
220      assertEquals(1, jedis.expireAt(&quot;foo&quot;, unixTime));
221      assertEquals(1, jedis.expireAt(&quot;foo&quot;, unixTime, ExpiryOption.XX));
222      assertEquals(0, jedis.expireAt(bfoo, unixTime));
223      jedis.set(bfoo, bbar);
224      unixTime = (System.currentTimeMillis() / 1000L) + 20;
225      assertEquals(1, jedis.expireAt(bfoo, unixTime));
226      assertEquals(1, jedis.expireAt(bfoo, unixTime, ExpiryOption.XX));
227    }
228    @Test
229    public void expireTime() {
230      long unixTime;
231      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
232      unixTime = (System.currentTimeMillis() / 1000L) + 20;
233      jedis.expireAt(&quot;foo&quot;, unixTime);
234      assertEquals(unixTime, jedis.expireTime(&quot;foo&quot;), 0.0001);
235      jedis.set(bfoo, bbar);
236      unixTime = (System.currentTimeMillis() / 1000L) + 20;
237      jedis.expireAt(bfoo, unixTime);
238      assertEquals(unixTime, jedis.expireTime(bfoo), 0.0001);
239    }
240    @Test
241    public void ttl() {
242      assertEquals(-2, jedis.ttl(&quot;foo&quot;));
243      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
244      assertEquals(-1, jedis.ttl(&quot;foo&quot;));
245      jedis.expire(&quot;foo&quot;, 20);
246      long ttl = jedis.ttl(&quot;foo&quot;);
247      assertTrue(ttl &gt;= 0 &amp;&amp; ttl &lt;= 20);
248      assertEquals(-2, jedis.ttl(bfoo));
249      jedis.set(bfoo, bbar);
250      assertEquals(-1, jedis.ttl(bfoo));
251      jedis.expire(bfoo, 20);
252      long bttl = jedis.ttl(bfoo);
253      assertTrue(bttl &gt;= 0 &amp;&amp; bttl &lt;= 20);
254    }
255    @Test
256    public void touch() throws Exception {
257      assertEquals(0, jedis.touch(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
258      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
259      Thread.sleep(1100); 
260      assertTrue(jedis.objectIdletime(&quot;foo1&quot;) &gt; 0);
261      assertEquals(1, jedis.touch(&quot;foo1&quot;));
262      assertEquals(0L, jedis.objectIdletime(&quot;foo1&quot;).longValue());
263      assertEquals(1, jedis.touch(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
264      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
265      jedis.set(&quot;foo3&quot;, &quot;bar3&quot;);
266      assertEquals(3, jedis.touch(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
267      assertEquals(0, jedis.touch(bfoo1, bfoo2, bfoo3));
268      jedis.set(bfoo1, bbar1);
269      Thread.sleep(1100); 
270      assertTrue(jedis.objectIdletime(bfoo1) &gt; 0);
271      assertEquals(1, jedis.touch(bfoo1));
272      assertEquals(0L, jedis.objectIdletime(bfoo1).longValue());
273      assertEquals(1, jedis.touch(bfoo1, bfoo2, bfoo3));
274      jedis.set(bfoo2, bbar2);
275      jedis.set(bfoo3, bbar3);
276      assertEquals(3, jedis.touch(bfoo1, bfoo2, bfoo3));
277    }
278    @Test
279    public void persist() {
280      jedis.setex(&quot;foo&quot;, 60 * 60, &quot;bar&quot;);
281      assertTrue(jedis.ttl(&quot;foo&quot;) &gt; 0);
282      assertEquals(1, jedis.persist(&quot;foo&quot;));
283      assertEquals(-1, jedis.ttl(&quot;foo&quot;));
284      jedis.setex(bfoo, 60 * 60, bbar);
285      assertTrue(jedis.ttl(bfoo) &gt; 0);
286      assertEquals(1, jedis.persist(bfoo));
287      assertEquals(-1, jedis.ttl(bfoo));
288    }
289    @Test
290    public void dumpAndRestore() {
291      jedis.set(&quot;foo1&quot;, &quot;bar&quot;);
292      byte[] sv = jedis.dump(&quot;foo1&quot;);
293      jedis.restore(&quot;foo2&quot;, 0, sv);
294      assertEquals(&quot;bar&quot;, jedis.get(&quot;foo2&quot;));
295      jedis.set(bfoo1, bbar);
296      sv = jedis.dump(bfoo1);
297      jedis.restore(bfoo2, 0, sv);
298      assertArrayEquals(bbar, jedis.get(bfoo2));
299    }
300    @Test
301    public void restoreParams() {
302      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
303      jedis.set(&quot;from&quot;, &quot;a&quot;);
304      byte[] serialized = jedis.dump(&quot;from&quot;);
305      try {
306        jedis.restore(&quot;foo&quot;, 0, serialized);
307        fail(&quot;Simple restore on a existing key should fail&quot;);
308      } catch (JedisDataException e) {
309      }
310      try {
311        jedis.restore(&quot;foo&quot;, 0, serialized, RestoreParams.restoreParams());
312        fail(&quot;Simple restore on a existing key should fail&quot;);
313      } catch (JedisDataException e) {
314      }
315      assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
316      jedis.restore(&quot;foo&quot;, 1000, serialized, RestoreParams.restoreParams().replace());
317      assertEquals(&quot;a&quot;, jedis.get(&quot;foo&quot;));
318      assertTrue(jedis.pttl(&quot;foo&quot;) &lt;= 1000);
319      jedis.restore(&quot;bar&quot;, System.currentTimeMillis() + 1000, serialized, RestoreParams.restoreParams().replace().absTtl());
320      assertTrue(jedis.pttl(&quot;bar&quot;) &lt;= 1000);
321      jedis.restore(&quot;bar1&quot;, 1000, serialized, RestoreParams.restoreParams().replace().idleTime(1000));
322      assertEquals(1000, jedis.objectIdletime(&quot;bar1&quot;).longValue());
323    }
324    @Test
325    public void pexpire() {
326      assertEquals(0, jedis.pexpire(&quot;foo&quot;, 10000));
327      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
328      assertEquals(1, jedis.pexpire(&quot;foo1&quot;, 10000));
329      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
330      assertEquals(1, jedis.pexpire(&quot;foo2&quot;, 200000000000L));
331      assertEquals(0, jedis.pexpire(&quot;foo2&quot;, 10000000, ExpiryOption.NX));
332      assertEquals(1, jedis.pexpire(&quot;foo2&quot;, 10000000, ExpiryOption.XX));
333      assertEquals(0, jedis.pexpire(&quot;foo2&quot;, 10000, ExpiryOption.GT));
334      assertEquals(1, jedis.pexpire(&quot;foo2&quot;, 10000, ExpiryOption.LT));
335      long pttl = jedis.pttl(&quot;foo2&quot;);
336      assertTrue(pttl &gt; 100L);
337      assertEquals(0, jedis.pexpire(bfoo, 10000));
338      jedis.set(bfoo, bbar);
339      assertEquals(1, jedis.pexpire(bfoo, 10000));
340      assertEquals(0, jedis.pexpire(bfoo, 10000, ExpiryOption.NX));
341    }
342    @Test
343    public void pexpireAt() {
344      long unixTime = (System.currentTimeMillis()) + 10000;
345      assertEquals(0, jedis.pexpireAt(&quot;foo&quot;, unixTime));
346      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
347      assertEquals(1, jedis.pexpireAt(&quot;foo&quot;, unixTime));
348      assertEquals(0, jedis.pexpireAt(bfoo, unixTime));
349      jedis.set(bfoo, bbar);
350      assertEquals(1, jedis.pexpireAt(bfoo, unixTime));
351    }
352    @Test
353    public void pexpireTime() {
354      long unixTime = (System.currentTimeMillis()) + 10000;
355      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
356      jedis.pexpireAt(&quot;foo&quot;, unixTime);
357      assertEquals(unixTime, jedis.pexpireTime(&quot;foo&quot;), 0.0001);
358      jedis.set(bfoo, bbar);
359      jedis.pexpireAt(bfoo, unixTime);
360      assertEquals(unixTime, jedis.pexpireTime(bfoo), 0.0001);
361    }
362    @Test
363    public void pttl() {
364      assertEquals(-2, jedis.pttl(&quot;foo&quot;));
365      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
366      assertEquals(-1, jedis.pttl(&quot;foo&quot;));
367      jedis.pexpire(&quot;foo&quot;, 20000);
368      long pttl = jedis.pttl(&quot;foo&quot;);
369      assertTrue(pttl &gt;= 0 &amp;&amp; pttl &lt;= 20000);
370      assertEquals(-2, jedis.pttl(bfoo));
371      jedis.set(bfoo, bbar);
372      assertEquals(-1, jedis.pttl(bfoo));
373      jedis.pexpire(bfoo, 20000);
374      pttl = jedis.pttl(bfoo);
375      assertTrue(pttl &gt;= 0 &amp;&amp; pttl &lt;= 20000);
376    }
377    @Test
378    public void psetex() {
379      long pttl;
380      jedis.psetex(&quot;foo&quot;, 200000000000L, &quot;bar&quot;);
381      pttl = jedis.pttl(&quot;foo&quot;);
382      assertTrue(pttl &gt; 100000000000L);
383      jedis.psetex(bfoo, 200000000000L, bbar);
384      pttl = jedis.pttl(bfoo);
385      assertTrue(pttl &gt; 100000000000L);
386    }
387    @Test
388    public void scan() {
389      jedis.set(&quot;b&quot;, &quot;b&quot;);
390      jedis.set(&quot;a&quot;, &quot;a&quot;);
391      ScanResult&lt;String&gt; result = jedis.scan(SCAN_POINTER_START);
392      assertEquals(SCAN_POINTER_START, result.getCursor());
393      assertFalse(result.getResult().isEmpty());
394      ScanResult&lt;byte[]&gt; bResult = jedis.scan(SCAN_POINTER_START_BINARY);
395      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
396      assertFalse(bResult.getResult().isEmpty());
397    }
398    @Test
399    public void scanMatch() {
400      ScanParams params = new ScanParams();
401      params.match(&quot;a*&quot;);
402      jedis.set(&quot;b&quot;, &quot;b&quot;);
403      jedis.set(&quot;a&quot;, &quot;a&quot;);
404      jedis.set(&quot;aa&quot;, &quot;aa&quot;);
405      ScanResult&lt;String&gt; result = jedis.scan(SCAN_POINTER_START, params);
406      assertEquals(SCAN_POINTER_START, result.getCursor());
407      assertFalse(result.getResult().isEmpty());
408      params = new ScanParams();
409      params.match(bfoostar);
410      jedis.set(bfoo1, bbar);
411      jedis.set(bfoo2, bbar);
412      jedis.set(bfoo3, bbar);
413      ScanResult&lt;byte[]&gt; bResult = jedis.scan(SCAN_POINTER_START_BINARY, params);
414      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
415      assertFalse(bResult.getResult().isEmpty());
416    }
417    @Test
418    public void scanCount() {
419      ScanParams params = new ScanParams();
420      params.count(2);
421      for (int i = 0; i &lt; 10; i++) {
422        jedis.set(&quot;a&quot; + i, &quot;a&quot; + i);
423      }
424      ScanResult&lt;String&gt; result = jedis.scan(SCAN_POINTER_START, params);
425      assertFalse(result.getResult().isEmpty());
426      params = new ScanParams();
427      params.count(2);
428      jedis.set(bfoo1, bbar);
429      jedis.set(bfoo2, bbar);
430      jedis.set(bfoo3, bbar);
431      ScanResult&lt;byte[]&gt; bResult = jedis.scan(SCAN_POINTER_START_BINARY, params);
432      assertFalse(bResult.getResult().isEmpty());
433    }
434    @Test
435    public void scanType() {
436      ScanParams noParams = new ScanParams();
437      ScanParams pagingParams = new ScanParams().count(4);
438      jedis.set(&quot;a&quot;, &quot;a&quot;);
439      jedis.hset(&quot;b&quot;, &quot;b&quot;, &quot;b&quot;);
440      jedis.set(&quot;c&quot;, &quot;c&quot;);
441      jedis.sadd(&quot;d&quot;, &quot;d&quot;);
442      jedis.set(&quot;e&quot;, &quot;e&quot;);
443      jedis.zadd(&quot;f&quot;, 0d, &quot;f&quot;);
444      jedis.set(&quot;g&quot;, &quot;g&quot;);
445      ScanResult&lt;String&gt; scanResult;
446      scanResult = jedis.scan(SCAN_POINTER_START, pagingParams, &quot;string&quot;);
447      assertFalse(scanResult.isCompleteIteration());
448      int page1Count = scanResult.getResult().size();
449      scanResult = jedis.scan(scanResult.getCursor(), pagingParams, &quot;string&quot;);
450      assertTrue(scanResult.isCompleteIteration());
451      int page2Count = scanResult.getResult().size();
452      assertEquals(4, page1Count + page2Count);
453      scanResult = jedis.scan(SCAN_POINTER_START, noParams, &quot;hash&quot;);
454      assertEquals(Collections.singletonList(&quot;b&quot;), scanResult.getResult());
455      scanResult = jedis.scan(SCAN_POINTER_START, noParams, &quot;set&quot;);
456      assertEquals(Collections.singletonList(&quot;d&quot;), scanResult.getResult());
457      scanResult = jedis.scan(SCAN_POINTER_START, noParams, &quot;zset&quot;);
458      assertEquals(Collections.singletonList(&quot;f&quot;), scanResult.getResult());
459      final byte[] string = &quot;string&quot;.getBytes();
460      final byte[] hash = &quot;hash&quot;.getBytes();
461      final byte[] set = &quot;set&quot;.getBytes();
462      final byte[] zset = &quot;zset&quot;.getBytes();
463      ScanResult&lt;byte[]&gt; binaryResult;
464      jedis.set(&quot;a&quot;, &quot;a&quot;);
465      jedis.hset(&quot;b&quot;, &quot;b&quot;, &quot;b&quot;);
466      jedis.set(&quot;c&quot;, &quot;c&quot;);
467      jedis.sadd(&quot;d&quot;, &quot;d&quot;);
468      jedis.set(&quot;e&quot;, &quot;e&quot;);
469      jedis.zadd(&quot;f&quot;, 0d, &quot;f&quot;);
470      jedis.set(&quot;g&quot;, &quot;g&quot;);
471      binaryResult = jedis.scan(SCAN_POINTER_START_BINARY, pagingParams, string);
472      assertFalse(binaryResult.isCompleteIteration());
473      page1Count = binaryResult.getResult().size();
474      binaryResult = jedis.scan(binaryResult.getCursorAsBytes(), pagingParams, string);
475      assertTrue(binaryResult.isCompleteIteration());
476      page2Count = binaryResult.getResult().size();
477      assertEquals(4, page1Count + page2Count);
478      binaryResult = jedis.scan(SCAN_POINTER_START_BINARY, noParams, hash);
479      AssertUtil.assertByteArrayListEquals(Collections.singletonList(new byte[]{98}), binaryResult.getResult());
480      binaryResult = jedis.scan(SCAN_POINTER_START_BINARY, noParams, set);
481      AssertUtil.assertByteArrayListEquals(Collections.singletonList(new byte[]{100}), binaryResult.getResult());
482      binaryResult = jedis.scan(SCAN_POINTER_START_BINARY, noParams, zset);
483      AssertUtil.assertByteArrayListEquals(Collections.singletonList(new byte[]{102}), binaryResult.getResult());
484    }
485    @Test
486    public void scanIsCompleteIteration() {
487      for (int i = 0; i &lt; 100; i++) {
488        jedis.set(&quot;a&quot; + i, &quot;a&quot; + i);
489      }
490      ScanResult&lt;String&gt; result = jedis.scan(SCAN_POINTER_START);
491      assertFalse(result.isCompleteIteration());
492      result = scanCompletely(result.getCursor());
493      assertNotNull(result);
494      assertTrue(result.isCompleteIteration());
495    }
496    private ScanResult&lt;String&gt; scanCompletely(String cursor) {
497      ScanResult&lt;String&gt; scanResult;
498      do {
499        scanResult = jedis.scan(cursor);
<span onclick='openModal()' class='match'>500        cursor = scanResult.getCursor();
501      } while (!SCAN_POINTER_START.equals(scanResult.getCursor()));
502      return scanResult;
503    }
504    @Test
505    public void setNxExAndGet() {
506      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;, SetParams.setParams().nx().ex(expireSeconds)));
507      assertEquals(&quot;world&quot;, jedis.get(&quot;hello&quot;));
508      assertNull(jedis.set(&quot;hello&quot;, &quot;bar&quot;, SetParams.setParams().nx().ex(expireSeconds)));
509      assertEquals(&quot;world&quot;, jedis.get(&quot;hello&quot;));
510      long ttl = jedis.ttl(&quot;hello&quot;);
511      assertTrue(ttl &gt; 0 &amp;&amp; ttl &lt;= expireSeconds);
512      byte[] bworld = { 0x77, 0x6F, 0x72, 0x6C, 0x64 };
513      byte[] bhello = { 0x68, 0x65, 0x6C, 0x6C, 0x6F };
514      assertEquals(&quot;OK&quot;, jedis.set(bworld, bhello, SetParams.setParams().nx().ex(expireSeconds)));
515      assertArrayEquals(bhello, jedis.get(bworld));
516      assertNull(jedis.set(bworld, bbar, SetParams.setParams().nx().ex(expireSeconds)));
517      assertArrayEquals(bhello, jedis.get(bworld));
518      long bttl = jedis.ttl(bworld);
519      assertTrue(bttl &gt; 0 &amp;&amp; bttl &lt;= expireSeconds);
520    }
521    @Test
522    public void setGetOptionTest() {
523      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;));
524      assertEquals(&quot;world&quot;, jedis.setGet(&quot;hello&quot;, &quot;jedis&quot;));
525      assertEquals(&quot;jedis&quot;, jedis.get(&quot;hello&quot;));
526      assertNull(jedis.setGet(&quot;key&quot;, &quot;value&quot;));
527    }
528    @Test
529    public void setGet() {
530      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;));
531      assertEquals(&quot;world&quot;, jedis.setGet(&quot;hello&quot;, &quot;jedis&quot;, SetParams.setParams()));
532      assertEquals(&quot;jedis&quot;, jedis.get(&quot;hello&quot;));
533      assertNull(jedis.setGet(&quot;key&quot;, &quot;value&quot;, SetParams.setParams()));
534    }
535    @Test
536    public void sendCommandTest() {
537      Object obj = jedis.sendCommand(SET, &quot;x&quot;, &quot;1&quot;);
538      String returnValue = encode((byte[]) obj);
</span>539      assertEquals(&quot;OK&quot;, returnValue);
540      obj = jedis.sendCommand(GET, &quot;x&quot;);
541      returnValue = encode((byte[]) obj);
542      assertEquals(&quot;1&quot;, returnValue);
543      jedis.sendCommand(RPUSH, &quot;foo&quot;, &quot;a&quot;);
544      jedis.sendCommand(RPUSH, &quot;foo&quot;, &quot;b&quot;);
545      jedis.sendCommand(RPUSH, &quot;foo&quot;, &quot;c&quot;);
546      obj = jedis.sendCommand(LRANGE, &quot;foo&quot;, &quot;0&quot;, &quot;2&quot;);
547      List&lt;byte[]&gt; list = (List&lt;byte[]&gt;) obj;
548      List&lt;byte[]&gt; expected = new ArrayList&lt;&gt;(3);
549      expected.add(&quot;a&quot;.getBytes());
550      expected.add(&quot;b&quot;.getBytes());
551      expected.add(&quot;c&quot;.getBytes());
552      for (int i = 0; i &lt; 3; i++)
553        assertArrayEquals(expected.get(i), list.get(i));
554      assertEquals(&quot;PONG&quot;, encode((byte[]) jedis.sendCommand(PING)));
555    }
556    @Test
557    public void sendBlockingCommandTest() {
558      assertNull(jedis.sendBlockingCommand(BLPOP, &quot;foo&quot;, Long.toString(1L)));
559      jedis.sendCommand(RPUSH, &quot;foo&quot;, &quot;bar&quot;);
560      assertEquals(Arrays.asList(&quot;foo&quot;, &quot;bar&quot;),
561        encodeObject(jedis.sendBlockingCommand(BLPOP, &quot;foo&quot;, Long.toString(1L))));
562      assertNull(jedis.sendBlockingCommand(BLPOP, &quot;foo&quot;, Long.toString(1L)));
563    }
564    @Test
565    public void encodeCompleteResponsePing() {
566      assertEquals(&quot;PONG&quot;, SafeEncoder.encodeObject(jedis.sendCommand(PING)));
567    }
568    @Test
569    public void encodeCompleteResponseHgetall() {
570      Assume.assumeFalse(RedisProtocolUtil.getRedisProtocol() == RedisProtocol.RESP3);
571      HashMap&lt;String, String&gt; entries = new HashMap&lt;&gt;();
572      entries.put(&quot;foo&quot;, &quot;bar&quot;);
573      entries.put(&quot;foo2&quot;, &quot;bar2&quot;);
574      jedis.hset(&quot;hash:test:encode&quot;, entries);
575      List encodeObj = (List) SafeEncoder.encodeObject(jedis.sendCommand(HGETALL, &quot;hash:test:encode&quot;));
576      assertEquals(4, encodeObj.size());
577      entries.forEach((k, v) -&gt; {
578        assertThat((Iterable&lt;String&gt;) encodeObj, Matchers.hasItem(k));
579        assertEquals(v, findValueFromMapAsList(encodeObj, k));
580      });
581    }
582    @Test
583    public void encodeCompleteResponseHgetallResp3() {
584      Assume.assumeTrue(RedisProtocolUtil.getRedisProtocol() == RedisProtocol.RESP3);
585      HashMap&lt;String, String&gt; entries = new HashMap&lt;&gt;();
586      entries.put(&quot;foo&quot;, &quot;bar&quot;);
587      entries.put(&quot;foo2&quot;, &quot;bar2&quot;);
588      jedis.hset(&quot;hash:test:encode&quot;, entries);
589      List&lt;KeyValue&gt; encodeObj = (List&lt;KeyValue&gt;) SafeEncoder.encodeObject(jedis.sendCommand(HGETALL, &quot;hash:test:encode&quot;));
590      assertEquals(2, encodeObj.size());
591      encodeObj.forEach(kv -&gt; {
592        assertThat(entries, Matchers.hasEntry(kv.getKey(), kv.getValue()));
593      });
594    }
595    @Test
596    public void encodeCompleteResponseXinfoStream() {
597      Assume.assumeFalse(RedisProtocolUtil.getRedisProtocol() == RedisProtocol.RESP3);
598      HashMap&lt;String, String&gt; entry = new HashMap&lt;&gt;();
599      entry.put(&quot;foo&quot;, &quot;bar&quot;);
600      StreamEntryID entryID = jedis.xadd(&quot;mystream&quot;, StreamEntryID.NEW_ENTRY, entry);
601      jedis.xgroupCreate(&quot;mystream&quot;, &quot;mygroup&quot;, null, false);
602      Object obj = jedis.sendCommand(XINFO, &quot;STREAM&quot;, &quot;mystream&quot;);
603      List encodeObj = (List) SafeEncoder.encodeObject(obj);
604      assertThat(encodeObj.size(), Matchers.greaterThanOrEqualTo(14));
605      assertEquals(&quot;must have even number of elements&quot;, 0, encodeObj.size() % 2); 
606      assertEquals(1L, findValueFromMapAsList(encodeObj, &quot;length&quot;));
607      assertEquals(entryID.toString(), findValueFromMapAsList(encodeObj, &quot;last-generated-id&quot;));
608      List&lt;String&gt; entryAsList = new ArrayList&lt;&gt;(2);
609      entryAsList.add(&quot;foo&quot;);
610      entryAsList.add(&quot;bar&quot;);
611      assertEquals(entryAsList, ((List) findValueFromMapAsList(encodeObj, &quot;first-entry&quot;)).get(1));
612      assertEquals(entryAsList, ((List) findValueFromMapAsList(encodeObj, &quot;last-entry&quot;)).get(1));
613    }
614    @Test
615    public void encodeCompleteResponseXinfoStreamResp3() {
616      Assume.assumeTrue(RedisProtocolUtil.getRedisProtocol() == RedisProtocol.RESP3);
617      HashMap&lt;String, String&gt; entry = new HashMap&lt;&gt;();
618      entry.put(&quot;foo&quot;, &quot;bar&quot;);
619      StreamEntryID entryID = jedis.xadd(&quot;mystream&quot;, StreamEntryID.NEW_ENTRY, entry);
620      jedis.xgroupCreate(&quot;mystream&quot;, &quot;mygroup&quot;, null, false);
621      Object obj = jedis.sendCommand(XINFO, &quot;STREAM&quot;, &quot;mystream&quot;);
622      List&lt;KeyValue&gt; encodeObj = (List&lt;KeyValue&gt;) SafeEncoder.encodeObject(obj);
623      assertThat(encodeObj.size(), Matchers.greaterThanOrEqualTo(7));
624      assertEquals(1L, findValueFromMapAsKeyValueList(encodeObj, &quot;length&quot;));
625      assertEquals(entryID.toString(), findValueFromMapAsKeyValueList(encodeObj, &quot;last-generated-id&quot;));
626      List&lt;String&gt; entryAsList = new ArrayList&lt;&gt;(2);
627      entryAsList.add(&quot;foo&quot;);
628      entryAsList.add(&quot;bar&quot;);
629      assertEquals(entryAsList, ((List) findValueFromMapAsKeyValueList(encodeObj, &quot;first-entry&quot;)).get(1));
630      assertEquals(entryAsList, ((List) findValueFromMapAsKeyValueList(encodeObj, &quot;last-entry&quot;)).get(1));
631    }
632    private Object findValueFromMapAsList(List list, Object key) {
633      for (int i = 0; i &lt; list.size(); i += 2) {
634        if (key.equals(list.get(i))) {
635          return list.get(i + 1);
636        }
637      }
638      return null;
639    }
640    private Object findValueFromMapAsKeyValueList(List&lt;KeyValue&gt; list, Object key) {
641      for (KeyValue kv : list) {
642        if (key.equals(kv.getKey())) {
643          return kv.getValue();
644        }
645      }
646      return null;
647    }
648    @Test
649    public void copy() {
650      assertFalse(jedis.copy(&quot;unknown&quot;, &quot;foo&quot;, false));
651      jedis.set(&quot;foo1&quot;, &quot;bar&quot;);
652      assertTrue(jedis.copy(&quot;foo1&quot;, &quot;foo2&quot;, false));
653      assertEquals(&quot;bar&quot;, jedis.get(&quot;foo2&quot;));
654      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
655      assertTrue(jedis.copy(&quot;foo1&quot;, &quot;foo2&quot;, true));
656      assertEquals(&quot;bar1&quot;, jedis.get(&quot;foo2&quot;));
657      assertFalse(jedis.copy(bfoobar, bfoo, false));
658      jedis.set(bfoo1, bbar);
659      assertTrue(jedis.copy(bfoo1, bfoo2, false));
660      assertArrayEquals(bbar, jedis.get(bfoo2));
661      jedis.set(bfoo1, bbar1);
662      assertTrue(jedis.copy(bfoo1, bfoo2, true));
663      assertArrayEquals(bbar1, jedis.get(bfoo2));
664    }
665    @Test
666    public void scanIteration() {
667      Set&lt;String&gt; allIn = new HashSet&lt;&gt;(26 * 26);
668      char[] arr = new char[2];
669      for (int i = 0; i &lt; 26; i++) {
670        arr[0] = (char) (&#x27;a&#x27; + i);
671        for (int j = 0; j &lt; 26; j++) {
672          arr[1] = (char) (&#x27;a&#x27; + j);
673          String str = new String(arr);
674          jedis.incr(str);
675          allIn.add(str);
676        }
677      }
678      Set&lt;String&gt; allScan = new HashSet&lt;&gt;();
679      ScanIteration scan = jedis.scanIteration(10, &quot;*&quot;);
680      while (!scan.isIterationCompleted()) {
681        ScanResult&lt;String&gt; batch = scan.nextBatch();
682        allScan.addAll(batch.getResult());
683      }
684      assertEquals(allIn, allScan);
685    }
686  }
</code></pre>
        </div>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-AllKindOfValuesCommandsTest.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.jedis;
2  import static org.hamcrest.MatcherAssert.assertThat;
3  import static org.junit.Assert.*;
4  import static redis.clients.jedis.Protocol.Command.BLPOP;
5  import static redis.clients.jedis.Protocol.Command.HGETALL;
6  import static redis.clients.jedis.Protocol.Command.GET;
7  import static redis.clients.jedis.Protocol.Command.LRANGE;
8  import static redis.clients.jedis.Protocol.Command.PING;
9  import static redis.clients.jedis.Protocol.Command.RPUSH;
10  import static redis.clients.jedis.Protocol.Command.SET;
11  import static redis.clients.jedis.Protocol.Command.XINFO;
12  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START;
13  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START_BINARY;
14  import java.util.*;
15  import org.hamcrest.Matchers;
16  import org.junit.Assume;
17  import org.junit.Test;
18  import redis.clients.jedis.HostAndPort;
19  import redis.clients.jedis.Jedis;
20  import redis.clients.jedis.args.ExpiryOption;
21  import redis.clients.jedis.params.ScanParams;
22  import redis.clients.jedis.resps.ScanResult;
23  import redis.clients.jedis.StreamEntryID;
24  import redis.clients.jedis.args.FlushMode;
25  import redis.clients.jedis.params.RestoreParams;
26  import redis.clients.jedis.HostAndPorts;
27  import redis.clients.jedis.RedisProtocol;
28  import redis.clients.jedis.util.SafeEncoder;
29  import redis.clients.jedis.exceptions.JedisDataException;
30  import redis.clients.jedis.params.SetParams;
31  import redis.clients.jedis.util.AssertUtil;
32  import redis.clients.jedis.util.KeyValue;
33  import redis.clients.jedis.util.RedisProtocolUtil;
34  public class AllKindOfValuesCommandsTest extends JedisCommandsTestBase {
35    final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
36    final byte[] bfoo1 = { 0x01, 0x02, 0x03, 0x04, 0x0A };
37    final byte[] bfoo2 = { 0x01, 0x02, 0x03, 0x04, 0x0B };
38    final byte[] bfoo3 = { 0x01, 0x02, 0x03, 0x04, 0x0C };
39    final byte[] bbar = { 0x05, 0x06, 0x07, 0x08 };
40    final byte[] bbar1 = { 0x05, 0x06, 0x07, 0x08, 0x0A };
41    final byte[] bbar2 = { 0x05, 0x06, 0x07, 0x08, 0x0B };
42    final byte[] bbar3 = { 0x05, 0x06, 0x07, 0x08, 0x0C };
43    final byte[] bfoobar = { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08 };
44    final byte[] bfoostar = { 0x01, 0x02, 0x03, 0x04, &#x27;*&#x27; };
45    final byte[] bbarstar = { 0x05, 0x06, 0x07, 0x08, &#x27;*&#x27; };
46    final byte[] bnx = { 0x6E, 0x78 };
47    final byte[] bex = { 0x65, 0x78 };
48    final int expireSeconds = 2;
49    private static final HostAndPort lfuHnp = HostAndPorts.getRedisServers().get(7);
50    @Test
51    public void ping() {
52      String status = jedis.ping();
53      assertEquals(&quot;PONG&quot;, status);
54    }
55    @Test
56    public void pingWithMessage() {
57      String argument = &quot;message&quot;;
58      assertEquals(argument, jedis.ping(argument));
59      assertArrayEquals(bfoobar, jedis.ping(bfoobar));
60    }
61    @Test
62    public void exists() {
63      String status = jedis.set(&quot;foo&quot;, &quot;bar&quot;);
64      assertEquals(&quot;OK&quot;, status);
65      status = jedis.set(bfoo, bbar);
66      assertEquals(&quot;OK&quot;, status);
67      assertTrue(jedis.exists(&quot;foo&quot;));
68      assertTrue(jedis.exists(bfoo));
69      assertEquals(1L, jedis.del(&quot;foo&quot;));
70      assertEquals(1L, jedis.del(bfoo));
71      assertFalse(jedis.exists(&quot;foo&quot;));
72      assertFalse(jedis.exists(bfoo));
73    }
74    @Test
75    public void existsMany() {
76      String status = jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
77      assertEquals(&quot;OK&quot;, status);
78      status = jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
79      assertEquals(&quot;OK&quot;, status);
80      assertEquals(2L, jedis.exists(&quot;foo1&quot;, &quot;foo2&quot;));
81      assertEquals(1L, jedis.del(&quot;foo1&quot;));
82      assertEquals(1L, jedis.exists(&quot;foo1&quot;, &quot;foo2&quot;));
83    }
84    @Test
85    public void del() {
86      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
87      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
88      jedis.set(&quot;foo3&quot;, &quot;bar3&quot;);
89      assertEquals(3L, jedis.del(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
90      assertFalse(jedis.exists(&quot;foo1&quot;));
91      assertFalse(jedis.exists(&quot;foo2&quot;));
92      assertFalse(jedis.exists(&quot;foo3&quot;));
93      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
94      assertEquals(1L, jedis.del(&quot;foo1&quot;, &quot;foo2&quot;));
95      assertEquals(0L, jedis.del(&quot;foo1&quot;, &quot;foo2&quot;));
96      jedis.set(bfoo1, bbar1);
97      jedis.set(bfoo2, bbar2);
98      jedis.set(bfoo3, bbar3);
99      assertEquals(3L, jedis.del(bfoo1, bfoo2, bfoo3));
100      assertFalse(jedis.exists(bfoo1));
101      assertFalse(jedis.exists(bfoo2));
102      assertFalse(jedis.exists(bfoo3));
103      jedis.set(bfoo1, bbar1);
104      assertEquals(1, jedis.del(bfoo1, bfoo2));
105      assertEquals(0, jedis.del(bfoo1, bfoo2));
106    }
107    @Test
108    public void unlink() {
109      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
110      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
111      jedis.set(&quot;foo3&quot;, &quot;bar3&quot;);
112      assertEquals(3, jedis.unlink(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
113      assertEquals(0, jedis.exists(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
114      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
115      assertEquals(1, jedis.unlink(&quot;foo1&quot;, &quot;foo2&quot;));
116      assertEquals(0, jedis.unlink(&quot;foo1&quot;, &quot;foo2&quot;));
117      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
118      assertEquals(1, jedis.unlink(&quot;foo&quot;));
119      assertFalse(jedis.exists(&quot;foo&quot;));
120      jedis.set(bfoo1, bbar1);
121      jedis.set(bfoo2, bbar2);
122      jedis.set(bfoo3, bbar3);
123      assertEquals(3, jedis.unlink(bfoo1, bfoo2, bfoo3));
124      assertEquals(0, jedis.exists(bfoo1, bfoo2, bfoo3));
125      jedis.set(bfoo1, bbar1);
126      assertEquals(1, jedis.unlink(bfoo1, bfoo2));
127      assertEquals(0, jedis.unlink(bfoo1, bfoo2));
128      jedis.set(bfoo, bbar);
129      assertEquals(1, jedis.unlink(bfoo));
130      assertFalse(jedis.exists(bfoo));
131    }
132    @Test
133    public void type() {
134      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
135      assertEquals(&quot;string&quot;, jedis.type(&quot;foo&quot;));
136      jedis.set(bfoo, bbar);
137      assertEquals(&quot;string&quot;, jedis.type(bfoo));
138    }
139    @Test
140    public void keys() {
141      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
142      jedis.set(&quot;foobar&quot;, &quot;bar&quot;);
143      Set&lt;String&gt; keys = jedis.keys(&quot;foo*&quot;);
144      AssertUtil.assertCollectionContains(keys, &quot;foo&quot;);
145      AssertUtil.assertCollectionContains(keys, &quot;foobar&quot;);
146      assertEquals(Collections.emptySet(), jedis.keys(&quot;bar*&quot;));
147      jedis.set(bfoo, bbar);
148      jedis.set(bfoobar, bbar);
149      Set&lt;byte[]&gt; bkeys = jedis.keys(bfoostar);
150      AssertUtil.assertByteArrayCollectionContains(bkeys, bfoo);
151      AssertUtil.assertByteArrayCollectionContains(bkeys, bfoobar);
152      assertEquals(Collections.emptySet(), jedis.keys(bbarstar));
153    }
154    @Test
155    public void randomKey() {
156      assertNull(jedis.randomKey());
157      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
158      assertEquals(&quot;foo&quot;, jedis.randomKey());
159      jedis.set(&quot;bar&quot;, &quot;foo&quot;);
160      String randomkey = jedis.randomKey();
161      assertTrue(randomkey.equals(&quot;foo&quot;) || randomkey.equals(&quot;bar&quot;));
162      jedis.del(&quot;foo&quot;);
163      jedis.del(&quot;bar&quot;);
164      assertNull(jedis.randomKey());
165      jedis.set(bfoo, bbar);
166      assertArrayEquals(bfoo, jedis.randomBinaryKey());
167      jedis.set(bbar, bfoo);
168      byte[] randomBkey = jedis.randomBinaryKey();
169      assertTrue(Arrays.equals(randomBkey, bfoo) || Arrays.equals(randomBkey, bbar));
170    }
171    @Test
172    public void rename() {
173      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
174      String status = jedis.rename(&quot;foo&quot;, &quot;bar&quot;);
175      assertEquals(&quot;OK&quot;, status);
176      assertNull(jedis.get(&quot;foo&quot;));
177      assertEquals(&quot;bar&quot;, jedis.get(&quot;bar&quot;));
178      jedis.set(bfoo, bbar);
179      String bstatus = jedis.rename(bfoo, bbar);
180      assertEquals(&quot;OK&quot;, bstatus);
181      assertNull(jedis.get(bfoo));
182      assertArrayEquals(bbar, jedis.get(bbar));
183    }
184    @Test
185    public void renameOldAndNewAreTheSame() {
186      assertEquals(&quot;OK&quot;, jedis.set(&quot;foo&quot;, &quot;bar&quot;));
187      assertEquals(&quot;OK&quot;, jedis.rename(&quot;foo&quot;, &quot;foo&quot;));
188      assertEquals(&quot;OK&quot;, jedis.set(bfoo, bbar));
189      assertEquals(&quot;OK&quot;, jedis.rename(bfoo, bfoo));
190    }
191    @Test
192    public void renamenx() {
193      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
194      assertEquals(1, jedis.renamenx(&quot;foo&quot;, &quot;bar&quot;));
195      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
196      assertEquals(0, jedis.renamenx(&quot;foo&quot;, &quot;bar&quot;));
197      jedis.set(bfoo, bbar);
198      assertEquals(1, jedis.renamenx(bfoo, bbar));
199      jedis.set(bfoo, bbar);
200      assertEquals(0, jedis.renamenx(bfoo, bbar));
201    }
202    @Test
203    public void dbSize() {
204      assertEquals(0, jedis.dbSize());
205      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
206      assertEquals(1, jedis.dbSize());
207      jedis.set(bfoo, bbar);
208      assertEquals(2, jedis.dbSize());
209    }
210    @Test
211    public void expire() {
212      assertEquals(0, jedis.expire(&quot;foo&quot;, 20L));
213      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
214      assertEquals(1, jedis.expire(&quot;foo&quot;, 20L));
215      assertEquals(0, jedis.expire(&quot;foo&quot;, 20L, ExpiryOption.NX));
216      assertEquals(0, jedis.expire(bfoo, 20L));
217      jedis.set(bfoo, bbar);
218      assertEquals(1, jedis.expire(bfoo, 20L));
219      assertEquals(0, jedis.expire(bfoo, 20L, ExpiryOption.NX));
220    }
221    @Test
222    public void expireAt() {
223      long unixTime = (System.currentTimeMillis() / 1000L) + 20;
224      assertEquals(0, jedis.expireAt(&quot;foo&quot;, unixTime));
225      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
226      unixTime = (System.currentTimeMillis() / 1000L) + 20;
227      assertEquals(1, jedis.expireAt(&quot;foo&quot;, unixTime));
228      assertEquals(1, jedis.expireAt(&quot;foo&quot;, unixTime, ExpiryOption.XX));
229      assertEquals(0, jedis.expireAt(bfoo, unixTime));
230      jedis.set(bfoo, bbar);
231      unixTime = (System.currentTimeMillis() / 1000L) + 20;
232      assertEquals(1, jedis.expireAt(bfoo, unixTime));
233      assertEquals(1, jedis.expireAt(bfoo, unixTime, ExpiryOption.XX));
234    }
235    @Test
236    public void expireTime() {
237      long unixTime;
238      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
239      unixTime = (System.currentTimeMillis() / 1000L) + 20;
240      jedis.expireAt(&quot;foo&quot;, unixTime);
241      assertEquals(unixTime, jedis.expireTime(&quot;foo&quot;), 0.0001);
242      jedis.set(bfoo, bbar);
243      unixTime = (System.currentTimeMillis() / 1000L) + 20;
244      jedis.expireAt(bfoo, unixTime);
245      assertEquals(unixTime, jedis.expireTime(bfoo), 0.0001);
246    }
247    @Test
248    public void ttl() {
249      assertEquals(-2, jedis.ttl(&quot;foo&quot;));
250      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
251      assertEquals(-1, jedis.ttl(&quot;foo&quot;));
252      jedis.expire(&quot;foo&quot;, 20);
253      long ttl = jedis.ttl(&quot;foo&quot;);
254      assertTrue(ttl &gt;= 0 &amp;&amp; ttl &lt;= 20);
255      assertEquals(-2, jedis.ttl(bfoo));
256      jedis.set(bfoo, bbar);
257      assertEquals(-1, jedis.ttl(bfoo));
258      jedis.expire(bfoo, 20);
259      long bttl = jedis.ttl(bfoo);
260      assertTrue(bttl &gt;= 0 &amp;&amp; bttl &lt;= 20);
261    }
262    @Test
263    public void touch() throws Exception {
264      assertEquals(0, jedis.touch(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
265      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
266      Thread.sleep(1100); 
267      assertTrue(jedis.objectIdletime(&quot;foo1&quot;) &gt; 0);
268      assertEquals(1, jedis.touch(&quot;foo1&quot;));
269      assertEquals(0L, jedis.objectIdletime(&quot;foo1&quot;).longValue());
270      assertEquals(1, jedis.touch(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
271      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
272      jedis.set(&quot;foo3&quot;, &quot;bar3&quot;);
273      assertEquals(3, jedis.touch(&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;));
274      assertEquals(0, jedis.touch(bfoo1, bfoo2, bfoo3));
275      jedis.set(bfoo1, bbar1);
276      Thread.sleep(1100); 
277      assertTrue(jedis.objectIdletime(bfoo1) &gt; 0);
278      assertEquals(1, jedis.touch(bfoo1));
279      assertEquals(0L, jedis.objectIdletime(bfoo1).longValue());
280      assertEquals(1, jedis.touch(bfoo1, bfoo2, bfoo3));
281      jedis.set(bfoo2, bbar2);
282      jedis.set(bfoo3, bbar3);
283      assertEquals(3, jedis.touch(bfoo1, bfoo2, bfoo3));
284    }
285    @Test
286    public void select() {
287      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
288      String status = jedis.select(1);
289      assertEquals(&quot;OK&quot;, status);
290      assertNull(jedis.get(&quot;foo&quot;));
291      status = jedis.select(0);
292      assertEquals(&quot;OK&quot;, status);
293      assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
294      jedis.set(bfoo, bbar);
295      String bstatus = jedis.select(1);
296      assertEquals(&quot;OK&quot;, bstatus);
297      assertNull(jedis.get(bfoo));
298      bstatus = jedis.select(0);
299      assertEquals(&quot;OK&quot;, bstatus);
300      assertArrayEquals(bbar, jedis.get(bfoo));
301    }
302    @Test
303    public void getDB() {
304      assertEquals(0, jedis.getDB());
305      jedis.select(1);
306      assertEquals(1, jedis.getDB());
307    }
308    @Test
309    public void move() {
310      assertEquals(0, jedis.move(&quot;foo&quot;, 1));
311      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
312      assertEquals(1, jedis.move(&quot;foo&quot;, 1));
313      assertNull(jedis.get(&quot;foo&quot;));
314      jedis.select(1);
315      assertEquals(&quot;bar&quot;, jedis.get(&quot;foo&quot;));
316      jedis.select(0);
317      assertEquals(0, jedis.move(bfoo, 1));
318      jedis.set(bfoo, bbar);
319      assertEquals(1, jedis.move(bfoo, 1));
320      assertNull(jedis.get(bfoo));
321      jedis.select(1);
322      assertArrayEquals(bbar, jedis.get(bfoo));
323    }
324    @Test
325    public void swapDB() {
326      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
327      jedis.select(1);
328      assertNull(jedis.get(&quot;foo1&quot;));
329      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
330      String status = jedis.swapDB(0, 1);
331      assertEquals(&quot;OK&quot;, status);
332      assertEquals(&quot;bar1&quot;, jedis.get(&quot;foo1&quot;));
333      assertNull(jedis.get(&quot;foo2&quot;));
334      jedis.select(0);
335      assertNull(jedis.get(&quot;foo1&quot;));
336      assertEquals(&quot;bar2&quot;, jedis.get(&quot;foo2&quot;));
337      jedis.set(bfoo1, bbar1);
338      jedis.select(1);
339      assertArrayEquals(null, jedis.get(bfoo1));
340      jedis.set(bfoo2, bbar2);
341      status = jedis.swapDB(0, 1);
342      assertEquals(&quot;OK&quot;, status);
343      assertArrayEquals(bbar1, jedis.get(bfoo1));
344      assertArrayEquals(null, jedis.get(bfoo2));
345      jedis.select(0);
346      assertArrayEquals(null, jedis.get(bfoo1));
347      assertArrayEquals(bbar2, jedis.get(bfoo2));
348    }
349    @Test
350    public void flushDB() {
351      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
352      assertEquals(1, jedis.dbSize());
353      jedis.set(&quot;bar&quot;, &quot;foo&quot;);
354      jedis.move(&quot;bar&quot;, 1);
355      String status = jedis.flushDB();
356      assertEquals(&quot;OK&quot;, status);
357      assertEquals(0, jedis.dbSize());
358      jedis.select(1);
359      assertEquals(1, jedis.dbSize());
360      assertEquals(&quot;OK&quot;, jedis.flushDB(FlushMode.SYNC));
361      assertEquals(0, jedis.dbSize());
362      jedis.select(0);
363      jedis.set(bfoo, bbar);
364      assertEquals(1, jedis.dbSize());
365      jedis.set(bbar, bfoo);
366      jedis.move(bbar, 1);
367      String bstatus = jedis.flushDB();
368      assertEquals(&quot;OK&quot;, bstatus);
369      assertEquals(0, jedis.dbSize());
370      jedis.select(1);
371      assertEquals(1, jedis.dbSize());
372      assertEquals(&quot;OK&quot;, jedis.flushDB(FlushMode.ASYNC));
373      assertEquals(0, jedis.dbSize());
374    }
375    @Test
376    public void flushAll() {
377      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
378      assertEquals(1, jedis.dbSize());
379      jedis.set(&quot;bar&quot;, &quot;foo&quot;);
380      jedis.move(&quot;bar&quot;, 1);
381      String status = jedis.flushAll();
382      assertEquals(&quot;OK&quot;, status);
383      assertEquals(0, jedis.dbSize());
384      jedis.select(1);
385      assertEquals(0, jedis.dbSize());
386      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
387      assertEquals(1, jedis.dbSize());
388      assertEquals(&quot;OK&quot;, jedis.flushAll(FlushMode.SYNC));
389      assertEquals(0, jedis.dbSize());
390      jedis.select(0);
391      jedis.set(bfoo, bbar);
392      assertEquals(1, jedis.dbSize());
393      jedis.set(bbar, bfoo);
394      jedis.move(bbar, 1);
395      String bstatus = jedis.flushAll();
396      assertEquals(&quot;OK&quot;, bstatus);
397      assertEquals(0, jedis.dbSize());
398      jedis.select(1);
399      assertEquals(0, jedis.dbSize());
400      jedis.set(bfoo, bbar);
401      assertEquals(1, jedis.dbSize());
402      assertEquals(&quot;OK&quot;, jedis.flushAll(FlushMode.ASYNC));
403      assertEquals(0, jedis.dbSize());
404    }
405    @Test
406    public void persist() {
407      jedis.setex(&quot;foo&quot;, 60 * 60, &quot;bar&quot;);
408      assertTrue(jedis.ttl(&quot;foo&quot;) &gt; 0);
409      assertEquals(1, jedis.persist(&quot;foo&quot;));
410      assertEquals(-1, jedis.ttl(&quot;foo&quot;));
411      jedis.setex(bfoo, 60 * 60, bbar);
412      assertTrue(jedis.ttl(bfoo) &gt; 0);
413      assertEquals(1, jedis.persist(bfoo));
414      assertEquals(-1, jedis.ttl(bfoo));
415    }
416    @Test
417    public void echo() {
418      String result = jedis.echo(&quot;hello world&quot;);
419      assertEquals(&quot;hello world&quot;, result);
420      byte[] bresult = jedis.echo(SafeEncoder.encode(&quot;hello world&quot;));
421      assertArrayEquals(SafeEncoder.encode(&quot;hello world&quot;), bresult);
422    }
423    @Test
424    public void dumpAndRestore() {
425      jedis.set(&quot;foo1&quot;, &quot;bar&quot;);
426      byte[] sv = jedis.dump(&quot;foo1&quot;);
427      jedis.restore(&quot;foo2&quot;, 0, sv);
428      assertEquals(&quot;bar&quot;, jedis.get(&quot;foo2&quot;));
429      jedis.set(bfoo1, bbar);
430      sv = jedis.dump(bfoo1);
431      jedis.restore(bfoo2, 0, sv);
432      assertArrayEquals(bbar, jedis.get(bfoo2));
433    }
434    @Test
435    public void restoreParams() {
436      Jedis jedis2 = new Jedis(hnp.getHost(), 6380, 500);
437      jedis2.auth(&quot;foobared&quot;);
438      jedis2.flushAll();
439      jedis2.set(&quot;foo&quot;, &quot;bar&quot;);
440      jedis.set(&quot;from&quot;, &quot;a&quot;);
441      byte[] serialized = jedis.dump(&quot;from&quot;);
442      try {
443        jedis2.restore(&quot;foo&quot;, 0, serialized);
444        fail(&quot;Simple restore on a existing key should fail&quot;);
445      } catch (JedisDataException e) {
446      }
447      try {
448        jedis2.restore(&quot;foo&quot;, 0, serialized, RestoreParams.restoreParams());
449        fail(&quot;Simple restore on a existing key should fail&quot;);
450      } catch (JedisDataException e) {
451      }
452      assertEquals(&quot;bar&quot;, jedis2.get(&quot;foo&quot;));
453      jedis2.restore(&quot;foo&quot;, 1000, serialized, RestoreParams.restoreParams().replace());
454      assertEquals(&quot;a&quot;, jedis2.get(&quot;foo&quot;));
455      assertTrue(jedis2.pttl(&quot;foo&quot;) &lt;= 1000);
456      jedis2.restore(&quot;bar&quot;, System.currentTimeMillis() + 1000, serialized, RestoreParams.restoreParams().replace().absTtl());
457      assertTrue(jedis2.pttl(&quot;bar&quot;) &lt;= 1000);
458      jedis2.restore(&quot;bar1&quot;, 1000, serialized, RestoreParams.restoreParams().replace().idleTime(1000));
459      assertEquals(1000, jedis2.objectIdletime(&quot;bar1&quot;).longValue());
460      jedis2.close();
461      Jedis lfuJedis = new Jedis(lfuHnp.getHost(), lfuHnp.getPort(), 500);
462      lfuJedis.restore(&quot;bar1&quot;, 1000, serialized, RestoreParams.restoreParams().replace().frequency(90));
463      assertEquals(90, lfuJedis.objectFreq(&quot;bar1&quot;).longValue());
464      lfuJedis.close();
465    }
466    @Test
467    public void pexpire() {
468      assertEquals(0, jedis.pexpire(&quot;foo&quot;, 10000));
469      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
470      assertEquals(1, jedis.pexpire(&quot;foo1&quot;, 10000));
471      jedis.set(&quot;foo2&quot;, &quot;bar2&quot;);
472      assertEquals(1, jedis.pexpire(&quot;foo2&quot;, 200000000000L));
473      assertEquals(0, jedis.pexpire(&quot;foo2&quot;, 10000000, ExpiryOption.NX));
474      assertEquals(1, jedis.pexpire(&quot;foo2&quot;, 10000000, ExpiryOption.XX));
475      assertEquals(0, jedis.pexpire(&quot;foo2&quot;, 10000, ExpiryOption.GT));
476      assertEquals(1, jedis.pexpire(&quot;foo2&quot;, 10000, ExpiryOption.LT));
477      long pttl = jedis.pttl(&quot;foo2&quot;);
478      assertTrue(pttl &gt; 100L);
479      assertEquals(0, jedis.pexpire(bfoo, 10000));
480      jedis.set(bfoo, bbar);
481      assertEquals(1, jedis.pexpire(bfoo, 10000));
482      assertEquals(0, jedis.pexpire(bfoo, 10000, ExpiryOption.NX));
483    }
484    @Test
485    public void pexpireAt() {
486      long unixTime = (System.currentTimeMillis()) + 10000;
487      assertEquals(0, jedis.pexpireAt(&quot;foo&quot;, unixTime));
488      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
489      assertEquals(1, jedis.pexpireAt(&quot;foo&quot;, unixTime));
490      assertEquals(0, jedis.pexpireAt(bfoo, unixTime));
491      jedis.set(bfoo, bbar);
492      assertEquals(1, jedis.pexpireAt(bfoo, unixTime));
493    }
494    @Test
495    public void pexpireTime() {
496      long unixTime = (System.currentTimeMillis()) + 10000;
497      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
498      jedis.pexpireAt(&quot;foo&quot;, unixTime);
499      assertEquals(unixTime, jedis.pexpireTime(&quot;foo&quot;), 0.0001);
500      jedis.set(bfoo, bbar);
501      jedis.pexpireAt(bfoo, unixTime);
502      assertEquals(unixTime, jedis.pexpireTime(bfoo), 0.0001);
503    }
504    @Test
505    public void pttl() {
506      assertEquals(-2, jedis.pttl(&quot;foo&quot;));
507      jedis.set(&quot;foo&quot;, &quot;bar&quot;);
508      assertEquals(-1, jedis.pttl(&quot;foo&quot;));
509      jedis.pexpire(&quot;foo&quot;, 20000);
510      long pttl = jedis.pttl(&quot;foo&quot;);
511      assertTrue(pttl &gt;= 0 &amp;&amp; pttl &lt;= 20000);
512      assertEquals(-2, jedis.pttl(bfoo));
513      jedis.set(bfoo, bbar);
514      assertEquals(-1, jedis.pttl(bfoo));
515      jedis.pexpire(bfoo, 20000);
516      pttl = jedis.pttl(bfoo);
517      assertTrue(pttl &gt;= 0 &amp;&amp; pttl &lt;= 20000);
518    }
519    @Test
520    public void psetex() {
521      long pttl;
522      jedis.psetex(&quot;foo&quot;, 200000000000L, &quot;bar&quot;);
523      pttl = jedis.pttl(&quot;foo&quot;);
524      assertTrue(pttl &gt; 100000000000L);
525      jedis.psetex(bfoo, 200000000000L, bbar);
526      pttl = jedis.pttl(bfoo);
527      assertTrue(pttl &gt; 100000000000L);
528    }
529    @Test
530    public void scan() {
531      jedis.set(&quot;b&quot;, &quot;b&quot;);
532      jedis.set(&quot;a&quot;, &quot;a&quot;);
533      ScanResult&lt;String&gt; result = jedis.scan(SCAN_POINTER_START);
534      assertEquals(SCAN_POINTER_START, result.getCursor());
535      assertFalse(result.getResult().isEmpty());
536      ScanResult&lt;byte[]&gt; bResult = jedis.scan(SCAN_POINTER_START_BINARY);
537      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
538      assertFalse(bResult.getResult().isEmpty());
539    }
540    @Test
541    public void scanMatch() {
542      ScanParams params = new ScanParams();
543      params.match(&quot;a*&quot;);
544      jedis.set(&quot;b&quot;, &quot;b&quot;);
545      jedis.set(&quot;a&quot;, &quot;a&quot;);
546      jedis.set(&quot;aa&quot;, &quot;aa&quot;);
547      ScanResult&lt;String&gt; result = jedis.scan(SCAN_POINTER_START, params);
548      assertEquals(SCAN_POINTER_START, result.getCursor());
549      assertFalse(result.getResult().isEmpty());
550      params = new ScanParams();
551      params.match(bfoostar);
552      jedis.set(bfoo1, bbar);
553      jedis.set(bfoo2, bbar);
554      jedis.set(bfoo3, bbar);
555      ScanResult&lt;byte[]&gt; bResult = jedis.scan(SCAN_POINTER_START_BINARY, params);
556      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
557      assertFalse(bResult.getResult().isEmpty());
558    }
559    @Test
560    public void scanCount() {
561      ScanParams params = new ScanParams();
562      params.count(2);
563      for (int i = 0; i &lt; 10; i++) {
564        jedis.set(&quot;a&quot; + i, &quot;a&quot; + i);
565      }
566      ScanResult&lt;String&gt; result = jedis.scan(SCAN_POINTER_START, params);
567      assertFalse(result.getResult().isEmpty());
568      params = new ScanParams();
569      params.count(2);
570      jedis.set(bfoo1, bbar);
571      jedis.set(bfoo2, bbar);
572      jedis.set(bfoo3, bbar);
573      ScanResult&lt;byte[]&gt; bResult = jedis.scan(SCAN_POINTER_START_BINARY, params);
574      assertFalse(bResult.getResult().isEmpty());
575    }
576    @Test
577    public void scanType() {
578      ScanParams noParams = new ScanParams();
579      ScanParams pagingParams = new ScanParams().count(4);
580      jedis.set(&quot;a&quot;, &quot;a&quot;);
581      jedis.hset(&quot;b&quot;, &quot;b&quot;, &quot;b&quot;);
582      jedis.set(&quot;c&quot;, &quot;c&quot;);
583      jedis.sadd(&quot;d&quot;, &quot;d&quot;);
584      jedis.set(&quot;e&quot;, &quot;e&quot;);
585      jedis.zadd(&quot;f&quot;, 0d, &quot;f&quot;);
586      jedis.set(&quot;g&quot;, &quot;g&quot;);
587      ScanResult&lt;String&gt; scanResult;
588      scanResult = jedis.scan(SCAN_POINTER_START, pagingParams, &quot;string&quot;);
589      assertFalse(scanResult.isCompleteIteration());
590      int page1Count = scanResult.getResult().size();
591      scanResult = jedis.scan(scanResult.getCursor(), pagingParams, &quot;string&quot;);
592      assertTrue(scanResult.isCompleteIteration());
593      int page2Count = scanResult.getResult().size();
594      assertEquals(4, page1Count + page2Count);
595      scanResult = jedis.scan(SCAN_POINTER_START, noParams, &quot;hash&quot;);
596      assertEquals(Collections.singletonList(&quot;b&quot;), scanResult.getResult());
597      scanResult = jedis.scan(SCAN_POINTER_START, noParams, &quot;set&quot;);
598      assertEquals(Collections.singletonList(&quot;d&quot;), scanResult.getResult());
599      scanResult = jedis.scan(SCAN_POINTER_START, noParams, &quot;zset&quot;);
600      assertEquals(Collections.singletonList(&quot;f&quot;), scanResult.getResult());
601      final byte[] string = &quot;string&quot;.getBytes();
602      final byte[] hash = &quot;hash&quot;.getBytes();
603      final byte[] set = &quot;set&quot;.getBytes();
604      final byte[] zset = &quot;zset&quot;.getBytes();
605      ScanResult&lt;byte[]&gt; binaryResult;
606      jedis.set(&quot;a&quot;, &quot;a&quot;);
607      jedis.hset(&quot;b&quot;, &quot;b&quot;, &quot;b&quot;);
608      jedis.set(&quot;c&quot;, &quot;c&quot;);
609      jedis.sadd(&quot;d&quot;, &quot;d&quot;);
610      jedis.set(&quot;e&quot;, &quot;e&quot;);
611      jedis.zadd(&quot;f&quot;, 0d, &quot;f&quot;);
612      jedis.set(&quot;g&quot;, &quot;g&quot;);
613      binaryResult = jedis.scan(SCAN_POINTER_START_BINARY, pagingParams, string);
614      assertFalse(binaryResult.isCompleteIteration());
615      page1Count = binaryResult.getResult().size();
616      binaryResult = jedis.scan(binaryResult.getCursorAsBytes(), pagingParams, string);
617      assertTrue(binaryResult.isCompleteIteration());
618      page2Count = binaryResult.getResult().size();
619      assertEquals(4, page1Count + page2Count);
620      binaryResult = jedis.scan(SCAN_POINTER_START_BINARY, noParams, hash);
621      AssertUtil.assertByteArrayListEquals(Collections.singletonList(new byte[]{98}), binaryResult.getResult());
622      binaryResult = jedis.scan(SCAN_POINTER_START_BINARY, noParams, set);
623      AssertUtil.assertByteArrayListEquals(Collections.singletonList(new byte[]{100}), binaryResult.getResult());
624      binaryResult = jedis.scan(SCAN_POINTER_START_BINARY, noParams, zset);
625      AssertUtil.assertByteArrayListEquals(Collections.singletonList(new byte[]{102}), binaryResult.getResult());
626    }
627    @Test
628    public void scanIsCompleteIteration() {
629      for (int i = 0; i &lt; 100; i++) {
630        jedis.set(&quot;a&quot; + i, &quot;a&quot; + i);
631      }
632      ScanResult&lt;String&gt; result = jedis.scan(SCAN_POINTER_START);
633      assertFalse(result.isCompleteIteration());
634      result = scanCompletely(result.getCursor());
635      assertNotNull(result);
636      assertTrue(result.isCompleteIteration());
637    }
638    private ScanResult&lt;String&gt; scanCompletely(String cursor) {
639      ScanResult&lt;String&gt; scanResult;
640      do {
641        scanResult = jedis.scan(cursor);
<span onclick='openModal()' class='match'>642        cursor = scanResult.getCursor();
643      } while (!SCAN_POINTER_START.equals(scanResult.getCursor()));
644      return scanResult;
645    }
646    @Test
647    public void setNxExAndGet() {
648      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;, SetParams.setParams().nx().ex(expireSeconds)));
649      assertEquals(&quot;world&quot;, jedis.get(&quot;hello&quot;));
650      assertNull(jedis.set(&quot;hello&quot;, &quot;bar&quot;, SetParams.setParams().nx().ex(expireSeconds)));
651      assertEquals(&quot;world&quot;, jedis.get(&quot;hello&quot;));
652      long ttl = jedis.ttl(&quot;hello&quot;);
653      assertTrue(ttl &gt; 0 &amp;&amp; ttl &lt;= expireSeconds);
654      byte[] bworld = { 0x77, 0x6F, 0x72, 0x6C, 0x64 };
655      byte[] bhello = { 0x68, 0x65, 0x6C, 0x6C, 0x6F };
656      assertEquals(&quot;OK&quot;, jedis.set(bworld, bhello, SetParams.setParams().nx().ex(expireSeconds)));
657      assertArrayEquals(bhello, jedis.get(bworld));
658      assertNull(jedis.set(bworld, bbar, SetParams.setParams().nx().ex(expireSeconds)));
659      assertArrayEquals(bhello, jedis.get(bworld));
660      long bttl = jedis.ttl(bworld);
661      assertTrue(bttl &gt; 0 &amp;&amp; bttl &lt;= expireSeconds);
662    }
663    @Test
664    public void setGetOptionTest() {
665      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;));
666      assertEquals(&quot;world&quot;, jedis.setGet(&quot;hello&quot;, &quot;jedis&quot;));
667      assertEquals(&quot;jedis&quot;, jedis.get(&quot;hello&quot;));
668      assertNull(jedis.setGet(&quot;key&quot;, &quot;value&quot;));
669    }
670    @Test
671    public void setGet() {
672      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;));
673      assertEquals(&quot;world&quot;, jedis.setGet(&quot;hello&quot;, &quot;jedis&quot;, SetParams.setParams()));
674      assertEquals(&quot;jedis&quot;, jedis.get(&quot;hello&quot;));
675      assertNull(jedis.setGet(&quot;key&quot;, &quot;value&quot;, SetParams.setParams()));
676    }
677    @Test
678    public void sendCommandTest() {
679      Object obj = jedis.sendCommand(SET, &quot;x&quot;, &quot;1&quot;);
680      String returnValue = SafeEncoder.encode((byte[]) obj);
</span>681      assertEquals(&quot;OK&quot;, returnValue);
682      obj = jedis.sendCommand(GET, &quot;x&quot;);
683      returnValue = SafeEncoder.encode((byte[]) obj);
684      assertEquals(&quot;1&quot;, returnValue);
685      jedis.sendCommand(RPUSH, &quot;foo&quot;, &quot;a&quot;);
686      jedis.sendCommand(RPUSH, &quot;foo&quot;, &quot;b&quot;);
687      jedis.sendCommand(RPUSH, &quot;foo&quot;, &quot;c&quot;);
688      obj = jedis.sendCommand(LRANGE, &quot;foo&quot;, &quot;0&quot;, &quot;2&quot;);
689      List&lt;byte[]&gt; list = (List&lt;byte[]&gt;) obj;
690      List&lt;byte[]&gt; expected = new ArrayList&lt;&gt;(3);
691      expected.add(&quot;a&quot;.getBytes());
692      expected.add(&quot;b&quot;.getBytes());
693      expected.add(&quot;c&quot;.getBytes());
694      for (int i = 0; i &lt; 3; i++)
695        assertArrayEquals(expected.get(i), list.get(i));
696      assertEquals(&quot;PONG&quot;, SafeEncoder.encode((byte[]) jedis.sendCommand(PING)));
697    }
698    @Test
699    public void sendBlockingCommandTest() {
700      assertNull(jedis.sendBlockingCommand(BLPOP, &quot;foo&quot;, Long.toString(1L)));
701      jedis.sendCommand(RPUSH, &quot;foo&quot;, &quot;bar&quot;);
702      assertEquals(Arrays.asList(&quot;foo&quot;, &quot;bar&quot;),
703        SafeEncoder.encodeObject(jedis.sendBlockingCommand(BLPOP, &quot;foo&quot;, Long.toString(1L))));
704      assertNull(jedis.sendBlockingCommand(BLPOP, &quot;foo&quot;, Long.toString(1L)));
705    }
706    @Test
707    public void encodeCompleteResponsePing() {
708      assertEquals(&quot;PONG&quot;, SafeEncoder.encodeObject(jedis.sendCommand(PING)));
709    }
710    @Test
711    public void encodeCompleteResponseHgetall() {
712      Assume.assumeFalse(RedisProtocolUtil.getRedisProtocol() == RedisProtocol.RESP3);
713      HashMap&lt;String, String&gt; entries = new HashMap&lt;&gt;();
714      entries.put(&quot;foo&quot;, &quot;bar&quot;);
715      entries.put(&quot;foo2&quot;, &quot;bar2&quot;);
716      jedis.hset(&quot;hash:test:encode&quot;, entries);
717      List encodeObj = (List) SafeEncoder.encodeObject(jedis.sendCommand(HGETALL, &quot;hash:test:encode&quot;));
718      assertEquals(4, encodeObj.size());
719      entries.forEach((k, v) -&gt; {
720        assertThat((Iterable&lt;String&gt;) encodeObj, Matchers.hasItem(k));
721        assertEquals(v, findValueFromMapAsList(encodeObj, k));
722      });
723    }
724    @Test
725    public void encodeCompleteResponseHgetallResp3() {
726      Assume.assumeTrue(RedisProtocolUtil.getRedisProtocol() == RedisProtocol.RESP3);
727      HashMap&lt;String, String&gt; entries = new HashMap&lt;&gt;();
728      entries.put(&quot;foo&quot;, &quot;bar&quot;);
729      entries.put(&quot;foo2&quot;, &quot;bar2&quot;);
730      jedis.hset(&quot;hash:test:encode&quot;, entries);
731      List&lt;KeyValue&gt; encodeObj = (List&lt;KeyValue&gt;) SafeEncoder.encodeObject(jedis.sendCommand(HGETALL, &quot;hash:test:encode&quot;));
732      assertEquals(2, encodeObj.size());
733      encodeObj.forEach(kv -&gt; {
734        assertThat(entries, Matchers.hasEntry(kv.getKey(), kv.getValue()));
735      });
736    }
737    @Test
738    public void encodeCompleteResponseXinfoStream() {
739      Assume.assumeFalse(RedisProtocolUtil.getRedisProtocol() == RedisProtocol.RESP3);
740      HashMap&lt;String, String&gt; entry = new HashMap&lt;&gt;();
741      entry.put(&quot;foo&quot;, &quot;bar&quot;);
742      StreamEntryID entryID = jedis.xadd(&quot;mystream&quot;, StreamEntryID.NEW_ENTRY, entry);
743      jedis.xgroupCreate(&quot;mystream&quot;, &quot;mygroup&quot;, null, false);
744      Object obj = jedis.sendCommand(XINFO, &quot;STREAM&quot;, &quot;mystream&quot;);
745      List encodeObj = (List) SafeEncoder.encodeObject(obj);
746      assertThat(encodeObj.size(), Matchers.greaterThanOrEqualTo(14));
747      assertEquals(&quot;must have even number of elements&quot;, 0, encodeObj.size() % 2); 
748      assertEquals(1L, findValueFromMapAsList(encodeObj, &quot;length&quot;));
749      assertEquals(entryID.toString(), findValueFromMapAsList(encodeObj, &quot;last-generated-id&quot;));
750      List&lt;String&gt; entryAsList = new ArrayList&lt;&gt;(2);
751      entryAsList.add(&quot;foo&quot;);
752      entryAsList.add(&quot;bar&quot;);
753      assertEquals(entryAsList, ((List) findValueFromMapAsList(encodeObj, &quot;first-entry&quot;)).get(1));
754      assertEquals(entryAsList, ((List) findValueFromMapAsList(encodeObj, &quot;last-entry&quot;)).get(1));
755    }
756    @Test
757    public void encodeCompleteResponseXinfoStreamResp3() {
758      Assume.assumeTrue(RedisProtocolUtil.getRedisProtocol() == RedisProtocol.RESP3);
759      HashMap&lt;String, String&gt; entry = new HashMap&lt;&gt;();
760      entry.put(&quot;foo&quot;, &quot;bar&quot;);
761      StreamEntryID entryID = jedis.xadd(&quot;mystream&quot;, StreamEntryID.NEW_ENTRY, entry);
762      jedis.xgroupCreate(&quot;mystream&quot;, &quot;mygroup&quot;, null, false);
763      Object obj = jedis.sendCommand(XINFO, &quot;STREAM&quot;, &quot;mystream&quot;);
764      List&lt;KeyValue&gt; encodeObj = (List&lt;KeyValue&gt;) SafeEncoder.encodeObject(obj);
765      assertThat(encodeObj.size(), Matchers.greaterThanOrEqualTo(7));
766      assertEquals(1L, findValueFromMapAsKeyValueList(encodeObj, &quot;length&quot;));
767      assertEquals(entryID.toString(), findValueFromMapAsKeyValueList(encodeObj, &quot;last-generated-id&quot;));
768      List&lt;String&gt; entryAsList = new ArrayList&lt;&gt;(2);
769      entryAsList.add(&quot;foo&quot;);
770      entryAsList.add(&quot;bar&quot;);
771      assertEquals(entryAsList, ((List) findValueFromMapAsKeyValueList(encodeObj, &quot;first-entry&quot;)).get(1));
772      assertEquals(entryAsList, ((List) findValueFromMapAsKeyValueList(encodeObj, &quot;last-entry&quot;)).get(1));
773    }
774    private Object findValueFromMapAsList(List list, Object key) {
775      for (int i = 0; i &lt; list.size(); i += 2) {
776        if (key.equals(list.get(i))) {
777          return list.get(i + 1);
778        }
779      }
780      return null;
781    }
782    private Object findValueFromMapAsKeyValueList(List&lt;KeyValue&gt; list, Object key) {
783      for (KeyValue kv : list) {
784        if (key.equals(kv.getKey())) {
785          return kv.getValue();
786        }
787      }
788      return null;
789    }
790    @Test
791    public void copy() {
792      assertFalse(jedis.copy(&quot;unknown&quot;, &quot;foo&quot;, false));
793      jedis.set(&quot;foo1&quot;, &quot;bar&quot;);
794      assertTrue(jedis.copy(&quot;foo1&quot;, &quot;foo2&quot;, false));
795      assertEquals(&quot;bar&quot;, jedis.get(&quot;foo2&quot;));
796      assertTrue(jedis.copy(&quot;foo1&quot;, &quot;foo3&quot;, 2, false));
797      jedis.select(2);
798      assertEquals(&quot;bar&quot;, jedis.get(&quot;foo3&quot;));
799      jedis.select(0); 
800      jedis.set(&quot;foo1&quot;, &quot;bar1&quot;);
801      assertTrue(jedis.copy(&quot;foo1&quot;, &quot;foo2&quot;, true));
802      assertEquals(&quot;bar1&quot;, jedis.get(&quot;foo2&quot;));
803      assertFalse(jedis.copy(bfoobar, bfoo, false));
804      jedis.set(bfoo1, bbar);
805      assertTrue(jedis.copy(bfoo1, bfoo2, false));
806      assertArrayEquals(bbar, jedis.get(bfoo2));
807      assertTrue(jedis.copy(bfoo1, bfoo3, 3, false));
808      jedis.select(3);
809      assertArrayEquals(bbar, jedis.get(bfoo3));
810      jedis.select(0); 
811      jedis.set(bfoo1, bbar1);
812      assertTrue(jedis.copy(bfoo1, bfoo2, true));
813      assertArrayEquals(bbar1, jedis.get(bfoo2));
814    }
815  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-AllKindOfValuesCommandsTestBase.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-AllKindOfValuesCommandsTest.java</div>
                </div>
                <div class="column column_space"><pre><code>500        cursor = scanResult.getCursor();
501      } while (!SCAN_POINTER_START.equals(scanResult.getCursor()));
502      return scanResult;
503    }
504    @Test
505    public void setNxExAndGet() {
506      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;, SetParams.setParams().nx().ex(expireSeconds)));
507      assertEquals(&quot;world&quot;, jedis.get(&quot;hello&quot;));
508      assertNull(jedis.set(&quot;hello&quot;, &quot;bar&quot;, SetParams.setParams().nx().ex(expireSeconds)));
509      assertEquals(&quot;world&quot;, jedis.get(&quot;hello&quot;));
510      long ttl = jedis.ttl(&quot;hello&quot;);
511      assertTrue(ttl &gt; 0 &amp;&amp; ttl &lt;= expireSeconds);
512      byte[] bworld = { 0x77, 0x6F, 0x72, 0x6C, 0x64 };
513      byte[] bhello = { 0x68, 0x65, 0x6C, 0x6C, 0x6F };
514      assertEquals(&quot;OK&quot;, jedis.set(bworld, bhello, SetParams.setParams().nx().ex(expireSeconds)));
515      assertArrayEquals(bhello, jedis.get(bworld));
516      assertNull(jedis.set(bworld, bbar, SetParams.setParams().nx().ex(expireSeconds)));
517      assertArrayEquals(bhello, jedis.get(bworld));
518      long bttl = jedis.ttl(bworld);
519      assertTrue(bttl &gt; 0 &amp;&amp; bttl &lt;= expireSeconds);
520    }
521    @Test
522    public void setGetOptionTest() {
523      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;));
524      assertEquals(&quot;world&quot;, jedis.setGet(&quot;hello&quot;, &quot;jedis&quot;));
525      assertEquals(&quot;jedis&quot;, jedis.get(&quot;hello&quot;));
526      assertNull(jedis.setGet(&quot;key&quot;, &quot;value&quot;));
527    }
528    @Test
529    public void setGet() {
530      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;));
531      assertEquals(&quot;world&quot;, jedis.setGet(&quot;hello&quot;, &quot;jedis&quot;, SetParams.setParams()));
532      assertEquals(&quot;jedis&quot;, jedis.get(&quot;hello&quot;));
533      assertNull(jedis.setGet(&quot;key&quot;, &quot;value&quot;, SetParams.setParams()));
534    }
535    @Test
536    public void sendCommandTest() {
537      Object obj = jedis.sendCommand(SET, &quot;x&quot;, &quot;1&quot;);
538      String returnValue = encode((byte[]) obj);
</pre></code></div>
                <div class="column column_space"><pre><code>642        cursor = scanResult.getCursor();
643      } while (!SCAN_POINTER_START.equals(scanResult.getCursor()));
644      return scanResult;
645    }
646    @Test
647    public void setNxExAndGet() {
648      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;, SetParams.setParams().nx().ex(expireSeconds)));
649      assertEquals(&quot;world&quot;, jedis.get(&quot;hello&quot;));
650      assertNull(jedis.set(&quot;hello&quot;, &quot;bar&quot;, SetParams.setParams().nx().ex(expireSeconds)));
651      assertEquals(&quot;world&quot;, jedis.get(&quot;hello&quot;));
652      long ttl = jedis.ttl(&quot;hello&quot;);
653      assertTrue(ttl &gt; 0 &amp;&amp; ttl &lt;= expireSeconds);
654      byte[] bworld = { 0x77, 0x6F, 0x72, 0x6C, 0x64 };
655      byte[] bhello = { 0x68, 0x65, 0x6C, 0x6C, 0x6F };
656      assertEquals(&quot;OK&quot;, jedis.set(bworld, bhello, SetParams.setParams().nx().ex(expireSeconds)));
657      assertArrayEquals(bhello, jedis.get(bworld));
658      assertNull(jedis.set(bworld, bbar, SetParams.setParams().nx().ex(expireSeconds)));
659      assertArrayEquals(bhello, jedis.get(bworld));
660      long bttl = jedis.ttl(bworld);
661      assertTrue(bttl &gt; 0 &amp;&amp; bttl &lt;= expireSeconds);
662    }
663    @Test
664    public void setGetOptionTest() {
665      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;));
666      assertEquals(&quot;world&quot;, jedis.setGet(&quot;hello&quot;, &quot;jedis&quot;));
667      assertEquals(&quot;jedis&quot;, jedis.get(&quot;hello&quot;));
668      assertNull(jedis.setGet(&quot;key&quot;, &quot;value&quot;));
669    }
670    @Test
671    public void setGet() {
672      assertEquals(&quot;OK&quot;, jedis.set(&quot;hello&quot;, &quot;world&quot;));
673      assertEquals(&quot;world&quot;, jedis.setGet(&quot;hello&quot;, &quot;jedis&quot;, SetParams.setParams()));
674      assertEquals(&quot;jedis&quot;, jedis.get(&quot;hello&quot;));
675      assertNull(jedis.setGet(&quot;key&quot;, &quot;value&quot;, SetParams.setParams()));
676    }
677    @Test
678    public void sendCommandTest() {
679      Object obj = jedis.sendCommand(SET, &quot;x&quot;, &quot;1&quot;);
680      String returnValue = SafeEncoder.encode((byte[]) obj);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    