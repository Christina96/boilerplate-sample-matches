
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 4.694835680751173%, Tokens: 10, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>BungeeCord-MDEwOlJlcG9zaXRvcnk2MDg0MjEw-flat-ColouredWriter.java</h3>
            <pre><code><span onclick='openModal()' class='match'>1  package net.md_5.bungee.log;
2  import java.io.IOException;
3  import java.util.logging.Handler;
4  import java.util.logging.LogRecord;
5  import java.util.regex.Pattern;
6  import jline.console.ConsoleReader;
7  import lombok.Data;
8  import net.md_5.bungee.api.ChatColor;
9  import org.fusesource.jansi.Ansi;
10  import org.fusesource.jansi.Ansi.Erase;
</span>11  public class ColouredWriter extends Handler
12  {
13      @Data
14      private static class ReplacementSpecification
15      {
16          private final Pattern pattern;
17          private final String replacement;
18      }
19      private static ReplacementSpecification compile(ChatColor color, String ansi)
20      {
21          return new ReplacementSpecification( Pattern.compile( "(?i)" + color.toString() ), ansi );
22      }
23      private static final ReplacementSpecification[] REPLACEMENTS = new ReplacementSpecification[]
24      {
25          compile( ChatColor.BLACK, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.BLACK ).boldOff().toString() ),
26          compile( ChatColor.DARK_BLUE, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.BLUE ).boldOff().toString() ),
27          compile( ChatColor.DARK_GREEN, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.GREEN ).boldOff().toString() ),
28          compile( ChatColor.DARK_AQUA, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.CYAN ).boldOff().toString() ),
29          compile( ChatColor.DARK_RED, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.RED ).boldOff().toString() ),
30          compile( ChatColor.DARK_PURPLE, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.MAGENTA ).boldOff().toString() ),
31          compile( ChatColor.GOLD, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.YELLOW ).boldOff().toString() ),
32          compile( ChatColor.GRAY, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.WHITE ).boldOff().toString() ),
33          compile( ChatColor.DARK_GRAY, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.BLACK ).bold().toString() ),
34          compile( ChatColor.BLUE, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.BLUE ).bold().toString() ),
35          compile( ChatColor.GREEN, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.GREEN ).bold().toString() ),
36          compile( ChatColor.AQUA, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.CYAN ).bold().toString() ),
37          compile( ChatColor.RED, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.RED ).bold().toString() ),
38          compile( ChatColor.LIGHT_PURPLE, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.MAGENTA ).bold().toString() ),
39          compile( ChatColor.YELLOW, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.YELLOW ).bold().toString() ),
40          compile( ChatColor.WHITE, Ansi.ansi().a( Ansi.Attribute.RESET ).fg( Ansi.Color.WHITE ).bold().toString() ),
41          compile( ChatColor.MAGIC, Ansi.ansi().a( Ansi.Attribute.BLINK_SLOW ).toString() ),
42          compile( ChatColor.BOLD, Ansi.ansi().a( Ansi.Attribute.UNDERLINE_DOUBLE ).toString() ),
43          compile( ChatColor.STRIKETHROUGH, Ansi.ansi().a( Ansi.Attribute.STRIKETHROUGH_ON ).toString() ),
44          compile( ChatColor.UNDERLINE, Ansi.ansi().a( Ansi.Attribute.UNDERLINE ).toString() ),
45          compile( ChatColor.ITALIC, Ansi.ansi().a( Ansi.Attribute.ITALIC ).toString() ),
46          compile( ChatColor.RESET, Ansi.ansi().a( Ansi.Attribute.RESET ).toString() ),
47      };
48      private final ConsoleReader console;
49      public ColouredWriter(ConsoleReader console)
50      {
51          this.console = console;
52      }
53      public void print(String s)
54      {
55          for ( ReplacementSpecification replacement : REPLACEMENTS )
56          {
57              s = replacement.pattern.matcher( s ).replaceAll( replacement.replacement );
58          }
59          try
60          {
61              console.print( Ansi.ansi().eraseLine( Erase.ALL ).toString() + ConsoleReader.RESET_LINE + s + Ansi.ansi().reset().toString() );
62              console.drawLine();
63              console.flush();
64          } catch ( IOException ex )
65          {
66          }
67      }
68      @Override
69      public void publish(LogRecord record)
70      {
71          if ( isLoggable( record ) )
72          {
73              print( getFormatter().format( record ) );
74          }
75      }
76      @Override
77      public void flush()
78      {
79      }
80      @Override
81      public void close() throws SecurityException
82      {
83      }
84  }
</code></pre>
        </div>
        <div class="column">
            <h3>Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-Commandbalancetop.java</h3>
            <pre><code><span onclick='openModal()' class='match'>1  package com.earth2me.essentials.commands;
2  import com.earth2me.essentials.CommandSource;
3  import static com.earth2me.essentials.I18n.tl;
4  import com.earth2me.essentials.User;
5  import com.earth2me.essentials.textreader.SimpleTextInput;
6  import com.earth2me.essentials.textreader.TextPager;
7  import com.earth2me.essentials.utils.NumberUtil;
8  import java.math.BigDecimal;
9  import java.text.DateFormat;
10  import java.util.*;
</span>11  import java.util.Map.Entry;
12  import java.util.concurrent.locks.ReentrantReadWriteLock;
13  import org.bukkit.Server;
14  public class Commandbalancetop extends EssentialsCommand
15  {
16  	public Commandbalancetop()
17  	{
18  		super("balancetop");
19  	}
20  	private static final int CACHETIME = 2 * 60 * 1000;
21  	public static final int MINUSERS = 50;
22  	private static final SimpleTextInput cache = new SimpleTextInput();
23  	private static long cacheage = 0;
24  	private static final ReentrantReadWriteLock lock = new ReentrantReadWriteLock();
25  	@Override
26  	protected void run(final Server server, final CommandSource sender, final String commandLabel, final String[] args) throws Exception
27  	{
28  		int page = 0;
29  		boolean force = false;
30  		if (args.length > 0)
31  		{
32  			try
33  			{
34  				page = Integer.parseInt(args[0]);
35  			}
36  			catch (NumberFormatException ex)
37  			{
38  				if (args[0].equalsIgnoreCase("force")
39  					&& (!sender.isPlayer() || ess.getUser(sender.getPlayer()).isAuthorized("essentials.balancetop.force")))
40  				{
41  					force = true;
42  				}
43  			}
44  		}
45  		if (!force && lock.readLock().tryLock())
46  		{
47  			try
48  			{
49  				if (cacheage > System.currentTimeMillis() - CACHETIME)
50  				{
51  					outputCache(sender, commandLabel, page);
52  					return;
53  				}
54  				if (ess.getUserMap().getUniqueUsers() > MINUSERS)
55  				{
56  					sender.sendMessage(tl("orderBalances", ess.getUserMap().getUniqueUsers()));
57  				}
58  			}
59  			finally
60  			{
61  				lock.readLock().unlock();
62  			}
63  			ess.runTaskAsynchronously(new Viewer(sender, commandLabel, page, force));
64  		}
65  		else
66  		{
67  			if (ess.getUserMap().getUniqueUsers() > MINUSERS)
68  			{
69  				sender.sendMessage(tl("orderBalances", ess.getUserMap().getUniqueUsers()));
70  			}
71  			ess.runTaskAsynchronously(new Viewer(sender, commandLabel, page, force));
72  		}
73  	}
74  	private static void outputCache(final CommandSource sender, String command,  int page)
75  	{
76  		final Calendar cal = Calendar.getInstance();
77  		cal.setTimeInMillis(cacheage);
78  		final DateFormat format = DateFormat.getDateTimeInstance(DateFormat.SHORT, DateFormat.SHORT);
79  		sender.sendMessage(tl("balanceTop", format.format(cal.getTime())));
80  		new TextPager(cache).showPage(Integer.toString(page), null, "balancetop", sender);
81  	}
82  	private class Calculator implements Runnable
83  	{
84  		private final transient Viewer viewer;
85  		private final boolean force;
86  		public Calculator(final Viewer viewer, final boolean force)
87  		{
88  			this.viewer = viewer;
89  			this.force = force;
90  		}
91  		@Override
92  		public void run()
93  		{
94  			lock.writeLock().lock();
95  			try
96  			{
97  				if (force || cacheage <= System.currentTimeMillis() - CACHETIME)
98  				{
99  					cache.getLines().clear();
100  					final Map<String, BigDecimal> balances = new HashMap<String, BigDecimal>();
101  					BigDecimal totalMoney = BigDecimal.ZERO;
102  					if (ess.getSettings().isEcoDisabled())
103  					{
104  						if (ess.getSettings().isDebug())
105  						{
106  							ess.getLogger().info("Internal economy functions disabled, aborting baltop.");
107  						}
108  					}
109  					else
110  					{
111  						for (UUID u : ess.getUserMap().getAllUniqueUsers())
112  						{
113  							final User user = ess.getUserMap().getUser(u);
114  							if (user != null)
115  							{
116  								final BigDecimal userMoney = user.getMoney();
117  								user.updateMoneyCache(userMoney);
118  								totalMoney = totalMoney.add(userMoney);
119  								final String name = user.isHidden() ? user.getName() : user.getDisplayName();
120  								balances.put(name, userMoney);
121  							}
122  						}
123  					}
124  					final List<Map.Entry<String, BigDecimal>> sortedEntries = new ArrayList<Map.Entry<String, BigDecimal>>(balances.entrySet());
125  					Collections.sort(sortedEntries, new Comparator<Map.Entry<String, BigDecimal>>()
126  					{
127  						@Override
128  						public int compare(final Entry<String, BigDecimal> entry1, final Entry<String, BigDecimal> entry2)
129  						{
130  							return entry2.getValue().compareTo(entry1.getValue());
131  						}
132  					});
133  					cache.getLines().add(tl("serverTotal", NumberUtil.displayCurrency(totalMoney, ess)));
134  					int pos = 1;
135  					for (Map.Entry<String, BigDecimal> entry : sortedEntries)
136  					{
137  						cache.getLines().add(pos + ". " + entry.getKey() + ", " + NumberUtil.displayCurrency(entry.getValue(), ess));
138  						pos++;
139  					}
140  					cacheage = System.currentTimeMillis();
141  				}
142  			}
143  			finally
144  			{
145  				lock.writeLock().unlock();
146  			}
147  			ess.runTaskAsynchronously(viewer);
148  		}
149  	}
150  	private class Viewer implements Runnable
151  	{
152  		private final transient CommandSource sender;
153  		private final transient int page;
154  		private final transient boolean force;
155  		private final transient String commandLabel;
156  		public Viewer(final CommandSource sender, final String commandLabel, final int page, final boolean force)
157  		{
158  			this.sender = sender;
159  			this.page = page;
160  			this.force = force;
161  			this.commandLabel = commandLabel;
162  		}
163  		@Override
164  		public void run()
165  		{
166  			lock.readLock().lock();
167  			try
168  			{
169  				if (!force && cacheage > System.currentTimeMillis() - CACHETIME)
170  				{
171  					outputCache(sender, commandLabel, page);
172  					return;
173  				}
174  			}
175  			finally
176  			{
177  				lock.readLock().unlock();
178  			}
179  			ess.runTaskAsynchronously(new Calculator(new Viewer(sender, commandLabel, page, false), force));
180  		}
181  	}
182  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from BungeeCord-MDEwOlJlcG9zaXRvcnk2MDg0MjEw-flat-ColouredWriter.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-Commandbalancetop.java</div>
                </div>
                <div class="column column_space"><pre><code>1  package net.md_5.bungee.log;
2  import java.io.IOException;
3  import java.util.logging.Handler;
4  import java.util.logging.LogRecord;
5  import java.util.regex.Pattern;
6  import jline.console.ConsoleReader;
7  import lombok.Data;
8  import net.md_5.bungee.api.ChatColor;
9  import org.fusesource.jansi.Ansi;
10  import org.fusesource.jansi.Ansi.Erase;
</pre></code></div>
                <div class="column column_space"><pre><code>1  package com.earth2me.essentials.commands;
2  import com.earth2me.essentials.CommandSource;
3  import static com.earth2me.essentials.I18n.tl;
4  import com.earth2me.essentials.User;
5  import com.earth2me.essentials.textreader.SimpleTextInput;
6  import com.earth2me.essentials.textreader.TextPager;
7  import com.earth2me.essentials.utils.NumberUtil;
8  import java.math.BigDecimal;
9  import java.text.DateFormat;
10  import java.util.*;
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    