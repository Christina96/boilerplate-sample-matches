<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for ForwardingLoadingCacheTest_1.java & CompactHashMapTest.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for ForwardingLoadingCacheTest_1.java & CompactHashMapTest.java
      </h3>
      <h1 align="center">
        14.0%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>ForwardingLoadingCacheTest_1.java (15.827338%)<TH>CompactHashMapTest.java (12.571428%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match412961-0.html#0',2,'match412961-1.html#0',3)" NAME="0">(67-71)<TD><A HREF="javascript:ZweiFrames('match412961-0.html#0',2,'match412961-1.html#0',3)" NAME="0">(120-126)</A><TD ALIGN=center><FONT COLOR="#ff0000">13</FONT>
<TR><TD BGCOLOR="#f63526"><FONT COLOR="#f63526">-</FONT><TD><A HREF="javascript:ZweiFrames('match412961-0.html#1',2,'match412961-1.html#1',3)" NAME="1">(57-61)<TD><A HREF="javascript:ZweiFrames('match412961-0.html#1',2,'match412961-1.html#1',3)" NAME="1">(106-112)</A><TD ALIGN=center><FONT COLOR="#b00000">9</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>ForwardingLoadingCacheTest_1.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2009 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.google.common.cache;

import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

import com.google.common.collect.ImmutableList;
import com.google.common.collect.ImmutableMap;
import java.util.concurrent.ExecutionException;
import junit.framework.TestCase;

/**
 * Unit test for {@link ForwardingLoadingCache}.
 *
 * @author Charles Fry
 */
public class ForwardingLoadingCacheTest extends TestCase {
  private LoadingCache&lt;String, Boolean&gt; forward;
  private LoadingCache&lt;String, Boolean&gt; mock;

  @SuppressWarnings({&quot;unchecked&quot;, &quot;DoNotMock&quot;}) // mock
  @Override
  public void setUp() throws Exception {
    super.setUp();
    /*
     * Class parameters must be raw, so we can't create a proxy with generic
     * type arguments. The created proxy only records calls and returns null, so
     * the type is irrelevant at runtime.
     */
    mock = mock(LoadingCache.class);
    forward =
        new ForwardingLoadingCache&lt;String, Boolean&gt;() {
          @Override
          protected LoadingCache&lt;String, Boolean&gt; delegate() {
            return mock;
          }
        };
<A NAME="1"></A>  }

  public void testGet() throws ExecutionException {
    <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match412961-1.html#1',3,'match412961-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>when(mock.get(&quot;key&quot;)).thenReturn(Boolean.TRUE);
    assertSame(Boolean.TRUE, forward.get(&quot;key&quot;));
  }

  public void testGetUnchecked() {</B></FONT>
    when(mock.getUnchecked(&quot;key&quot;)).thenReturn(Boolean.TRUE);
    assertSame(Boolean.TRUE, forward.getUnchecked(&quot;key&quot;));
<A NAME="0"></A>  }

  public void testGetAll() throws ExecutionException {
    <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match412961-1.html#0',3,'match412961-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>when(mock.getAll(ImmutableList.of(&quot;key&quot;))).thenReturn(ImmutableMap.of(&quot;key&quot;, Boolean.TRUE));
    assertEquals(ImmutableMap.of(&quot;key&quot;, Boolean.TRUE), forward.getAll(ImmutableList.of(&quot;key&quot;)));
  }

  public void testApply() {</B></FONT>
    when(mock.apply(&quot;key&quot;)).thenReturn(Boolean.TRUE);
    assertSame(Boolean.TRUE, forward.apply(&quot;key&quot;));
  }

  public void testInvalidate() {
    forward.invalidate(&quot;key&quot;);
    verify(mock).invalidate(&quot;key&quot;);
  }

  public void testRefresh() throws ExecutionException {
    forward.refresh(&quot;key&quot;);
    verify(mock).refresh(&quot;key&quot;);
  }

  public void testInvalidateAll() {
    forward.invalidateAll();
    verify(mock).invalidateAll();
  }

  public void testSize() {
    when(mock.size()).thenReturn(0L);
    long unused = forward.size();
  }

  public void testStats() {
    when(mock.stats()).thenReturn(null);
    assertNull(forward.stats());
  }

  public void testAsMap() {
    when(mock.asMap()).thenReturn(null);
    assertNull(forward.asMap());
  }

  public void testCleanUp() {
    forward.cleanUp();
    verify(mock).cleanUp();
  }

  /** Make sure that all methods are forwarded. */
  private static class OnlyGet&lt;K, V&gt; extends ForwardingLoadingCache&lt;K, V&gt; {
    @Override
    protected LoadingCache&lt;K, V&gt; delegate() {
      return null;
    }
  }
}
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>CompactHashMapTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2012 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.google.common.collect;

import static com.google.common.collect.Iterables.getOnlyElement;
import static com.google.common.truth.Truth.assertThat;

import com.google.common.collect.testing.MapTestSuiteBuilder;
import com.google.common.collect.testing.TestStringMapGenerator;
import com.google.common.collect.testing.features.CollectionFeature;
import com.google.common.collect.testing.features.CollectionSize;
import com.google.common.collect.testing.features.MapFeature;
import java.util.Map;
import java.util.Map.Entry;
import junit.framework.Test;
import junit.framework.TestCase;
import junit.framework.TestSuite;

/**
 * Tests for {@code CompactHashMap}.
 *
 * @author Louis Wasserman
 */
public class CompactHashMapTest extends TestCase {
  public static Test suite() {
    TestSuite suite = new TestSuite();
    suite.addTest(
        MapTestSuiteBuilder.using(
                new TestStringMapGenerator() {
                  @Override
                  protected Map&lt;String, String&gt; create(Entry&lt;String, String&gt;[] entries) {
                    Map&lt;String, String&gt; map = CompactHashMap.create();
                    for (Entry&lt;String, String&gt; entry : entries) {
                      map.put(entry.getKey(), entry.getValue());
                    }
                    return map;
                  }
                })
            .named(&quot;CompactHashMap&quot;)
            .withFeatures(
                CollectionSize.ANY,
                MapFeature.GENERAL_PURPOSE,
                MapFeature.ALLOWS_NULL_KEYS,
                MapFeature.ALLOWS_NULL_VALUES,
                CollectionFeature.SERIALIZABLE,
                CollectionFeature.SUPPORTS_ITERATOR_REMOVE)
            .createTestSuite());
    suite.addTest(
        MapTestSuiteBuilder.using(
                new TestStringMapGenerator() {
                  @Override
                  protected Map&lt;String, String&gt; create(Entry&lt;String, String&gt;[] entries) {
                    CompactHashMap&lt;String, String&gt; map = CompactHashMap.create();
                    map.convertToHashFloodingResistantImplementation();
                    for (Entry&lt;String, String&gt; entry : entries) {
                      map.put(entry.getKey(), entry.getValue());
                    }
                    return map;
                  }
                })
            .named(&quot;CompactHashMap with flooding resistance&quot;)
            .withFeatures(
                CollectionSize.ANY,
                MapFeature.GENERAL_PURPOSE,
                MapFeature.ALLOWS_NULL_KEYS,
                MapFeature.ALLOWS_NULL_VALUES,
                CollectionFeature.SERIALIZABLE,
                CollectionFeature.SUPPORTS_ITERATOR_REMOVE)
            .createTestSuite());
    suite.addTestSuite(CompactHashMapTest.class);
    return suite;
  }

  public void testTrimToSize() {
    CompactHashMap&lt;Integer, String&gt; map = CompactHashMap.createWithExpectedSize(100);
    for (int i = 0; i &lt; 10; i++) {
      map.put(i, Integer.toString(i));
    }
    map.trimToSize();
    assertThat(map.entries).hasLength(10);
    assertThat(map.keys).hasLength(10);
    assertThat(map.values).hasLength(10);
    assertEquals(10, map.size());
    for (int i = 0; i &lt; 10; i++) {
      assertEquals(Integer.toString(i), map.get(i));
    }
  }

<A NAME="1"></A>  public void testEntrySetValueAfterRemoved() {
    CompactHashMap&lt;Integer, String&gt; map = CompactHashMap.create();
    map.put(1, &quot;1&quot;);
    Entry&lt;Integer, String&gt; entry = getOnlyElement(<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match412961-0.html#1',2,'match412961-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>map.entrySet());
    map.remove(1);
    entry.setValue(&quot;one&quot;);
    assertThat(map).containsEntry(1, &quot;one&quot;);
  }

  public void testAllocArraysDefault() {</B></FONT>
    CompactHashMap&lt;Integer, String&gt; map = CompactHashMap.create();
    assertThat(map.needsAllocArrays()).isTrue();
    assertThat(map.entries).isNull();
    assertThat(map.keys).isNull();
<A NAME="0"></A>    assertThat(map.values).isNull();

    map.put(1, &quot;1&quot;);
    <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match412961-0.html#0',2,'match412961-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>assertThat(map.needsAllocArrays()).isFalse();
    assertThat(map.entries).hasLength(CompactHashing.DEFAULT_SIZE);
    assertThat(map.keys).hasLength(CompactHashing.DEFAULT_SIZE);
    assertThat(map.values).hasLength(CompactHashing.DEFAULT_SIZE);
  }

  public void testAllocArraysExpectedSize() {</B></FONT>
    for (int i = 0; i &lt;= CompactHashing.DEFAULT_SIZE; i++) {
      CompactHashMap&lt;Integer, String&gt; map = CompactHashMap.createWithExpectedSize(i);
      assertThat(map.needsAllocArrays()).isTrue();
      assertThat(map.entries).isNull();
      assertThat(map.keys).isNull();
      assertThat(map.values).isNull();

      map.put(1, &quot;1&quot;);
      assertThat(map.needsAllocArrays()).isFalse();
      int expectedSize = Math.max(1, i);
      assertThat(map.entries).hasLength(expectedSize);
      assertThat(map.keys).hasLength(expectedSize);
      assertThat(map.values).hasLength(expectedSize);
    }
  }

}
</PRE>
</div>
  </div>
</body>
</html>
