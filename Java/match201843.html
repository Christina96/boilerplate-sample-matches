<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for DateFormatterTest.java &amp; ZlibTest.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for DateFormatterTest.java &amp; ZlibTest.java
      </h3>
<h1 align="center">
        14.2%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>DateFormatterTest.java (29.74359%)<th>ZlibTest.java (9.400324%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(135-141)<td><a href="#" name="0">(428-435)</a><td align="center"><font color="#ff0000">15</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(120-127)<td><a href="#" name="1">(317-326)</a><td align="center"><font color="#dd0000">13</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(107-114)<td><a href="#" name="2">(338-347)</a><td align="center"><font color="#cc0000">12</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(85-92)<td><a href="#" name="3">(404-411)</a><td align="center"><font color="#990000">9</font>
<tr onclick='openModal("#6cc417")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#6cc417"><font color="#6cc417">-</font><td><a href="#" name="4">(37-42)<td><a href="#" name="4">(396-403)</a><td align="center"><font color="#990000">9</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>DateFormatterTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 package io.netty.handler.codec;
2 import org.junit.jupiter.api.Test;
3 import java.util.Calendar;
4 import java.util.Date;
5 import static io.netty.handler.codec.DateFormatter.*;
6 import static org.junit.jupiter.api.Assertions.assertEquals;
7 import static org.junit.jupiter.api.Assertions.assertNull;
8 public class DateFormatterTest {
9     private static final long TIMESTAMP = 784111777000L;
10     private static final Date DATE = new Date(TIMESTAMP);
11 <a name="4"></a>
12     @Test
13     public void testParseWithSingleDigitDay() {
14         <font color="#6cc417"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>assertEquals(DATE, parseHttpDate("Sun, 6 Nov 1994 08:49:37 GMT"));
15     }
16     @Test
17     public void testParseWithDoubleDigitDay() {
18         assertEquals(DATE, parseHttpDate</b></font>("Sun, 06 Nov 1994 08:49:37 GMT"));
19     }
20     @Test
21     public void testParseWithDashSeparatorSingleDigitDay() {
22         assertEquals(DATE, parseHttpDate("Sunday, 6-Nov-94 08:49:37 GMT"));
23     }
24     @Test
25     public void testParseWithDashSeparatorDoubleDigitDay() {
26         assertEquals(DATE, parseHttpDate("Sunday, 06-Nov-94 08:49:37 GMT"));
27     }
28     @Test
29     public void testParseWithoutGMT() {
30         assertEquals(DATE, parseHttpDate("Sun Nov 06 08:49:37 1994"));
31     }
32     @Test
33     public void testParseWithFunkyTimezone() {
34         assertEquals(DATE, parseHttpDate("Sun Nov 06 08:49:37 1994 -0000"));
35     }
36     @Test
37     public void testParseWithSingleDigitHourMinutesAndSecond() {
38         assertEquals(DATE, parseHttpDate("Sunday, 06-Nov-94 8:49:37 GMT"));
39     }
40     @Test
41     public void testParseWithSingleDigitTime() {
42         assertEquals(DATE, parseHttpDate("Sunday, 06 Nov 1994 8:49:37 GMT"));
43         Date _08_09_37 = new Date(TIMESTAMP - 40 * 60 * 1000);
44         assertEquals(_08_09_37, parseHttpDate("Sunday, 06 Nov 1994 8:9:37 GMT"));
45         assertEquals(_08_09_37, parseHttpDate("Sunday, 06 Nov 1994 8:09:37 GMT"));
46         Date _08_09_07 = new Date(TIMESTAMP - (40 * 60 + 30) * 1000);
47         assertEquals(_08_09_07, parseHttpDate("Sunday, 06 Nov 1994 8:9:7 GMT"));
48         assertEquals(_08_09_07, parseHttpDate("Sunday, 06 Nov 1994 8:9:07 GMT"));
49     }
50 <a name="3"></a>
51     @Test
52     public void testParseMidnight() {
53         assertEquals(new Date(784080000000L), <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>parseHttpDate("Sunday, 06 Nov 1994 00:00:00 GMT"));
54     }
55     @Test
56     public void testParseInvalidInput() {
57         assertNull(parseHttpDate("Sun, Nov 1994 08:49:37 GMT"));
58         assertNull</b></font>(parseHttpDate("Sun, 06 1994 08:49:37 GMT"));
59         assertNull(parseHttpDate("Sun, 06 Nov 08:49:37 GMT"));
60         assertNull(parseHttpDate("Sun, 06 Nov 1994 :49:37 GMT"));
61         assertNull(parseHttpDate("Sun, 06 Nov 1994 49:37 GMT"));
62         assertNull(parseHttpDate("Sun, 06 Nov 1994 08::37 GMT"));
63         assertNull(parseHttpDate("Sun, 06 Nov 1994 08:37 GMT"));
64         assertNull(parseHttpDate("Sun, 06 Nov 1994 08:49: GMT"));
65         assertNull(parseHttpDate("Sun, 06 Nov 1994 08:49 GMT"));
66         //invalid value
67         assertNull(parseHttpDate("Sun, 06 FOO 1994 08:49:37 GMT"));
68         assertNull(parseHttpDate("Sun, 36 Nov 1994 08:49:37 GMT"));
69         assertNull(parseHttpDate("Sun, 06 Nov 1994 28:49:37 GMT"));
70 <a name="2"></a>        assertNull(parseHttpDate("Sun, 06 Nov 1994 08:69:37 GMT"));
71         assertNull(parseHttpDate("Sun, 06 Nov 1994 08:49:67 GMT"));
72         //wrong number of digits in timestamp
73         assertNull(<font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>parseHttpDate("Sunday, 06 Nov 1994 0:0:000 GMT"));
74         assertNull(parseHttpDate("Sunday, 06 Nov 1994 0:000:0 GMT"));
75         assertNull(parseHttpDate("Sunday, 06 Nov 1994 000:0:0 GMT"));
76     }
77     @Test
78     public void testFormat() {
79         assertEquals("Sun, 06 Nov 1994 08:49:37 GMT", format</b></font>(DATE));
80     }
81 <a name="1"></a>    @Test
82     public void testAppend() {
83         StringBuilder sb = new StringBuilder();
84         <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>append(DATE, sb);
85         assertEquals("Sun, 06 Nov 1994 08:49:37 GMT", sb.toString());
86     }
87     @Test
88     public void testParseAllMonths() {
89         assertEquals(Calendar.JANUARY, getMonth(parseHttpDate("Sun, 06 Jan 1994 08:49:37 GMT")));
90         assertEquals(Calendar.FEBRUARY, getMonth</b></font>(parseHttpDate("Sun, 06 Feb 1994 08:49:37 GMT")));
91         assertEquals(Calendar.MARCH, getMonth(parseHttpDate("Sun, 06 Mar 1994 08:49:37 GMT")));
92         assertEquals(Calendar.APRIL, getMonth(parseHttpDate("Sun, 06 Apr 1994 08:49:37 GMT")));
93         assertEquals(Calendar.MAY, getMonth(parseHttpDate("Sun, 06 May 1994 08:49:37 GMT")));
94         assertEquals(Calendar.JUNE, getMonth(parseHttpDate("Sun, 06 Jun 1994 08:49:37 GMT")));
95 <a name="0"></a>        assertEquals(Calendar.JULY, getMonth(parseHttpDate("Sun, 06 Jul 1994 08:49:37 GMT")));
96         assertEquals(Calendar.AUGUST, getMonth(parseHttpDate("Sun, 06 Aug 1994 08:49:37 GMT")));
97         assertEquals(Calendar.SEPTEMBER, getMonth(parseHttpDate("Sun, 06 Sep 1994 08:49:37 GMT")));
98         <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>assertEquals(Calendar.OCTOBER, getMonth(parseHttpDate("Sun Oct 06 08:49:37 1994")));
99         assertEquals(Calendar.NOVEMBER, getMonth(parseHttpDate("Sun Nov 06 08:49:37 1994")));
100         assertEquals(Calendar.DECEMBER, getMonth(parseHttpDate("Sun Dec 06 08:49:37 1994")));
101     }
102     private static int getMonth(Date referenceDate) {
103         Calendar cal = Calendar.getInstance()</b></font>;
104         cal.setTime(referenceDate);
105         return cal.get(Calendar.MONTH);
106     }
107 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>ZlibTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 /*
2  * Copyright 2013 The Netty Project
3  *
4  * The Netty Project licenses this file to you under the Apache License,
5  * version 2.0 (the "License"); you may not use this file except in compliance
6  * with the License. You may obtain a copy of the License at:
7  *
8  *   https://www.apache.org/licenses/LICENSE-2.0
9  *
10  * Unless required by applicable law or agreed to in writing, software
11  * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
12  * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
13  * License for the specific language governing permissions and limitations
14  * under the License.
15  */
16 package io.netty.handler.codec.compression;
17 import io.netty.buffer.AbstractByteBufAllocator;
18 import io.netty.buffer.ByteBuf;
19 import io.netty.buffer.ByteBufAllocator;
20 import io.netty.buffer.ByteBufInputStream;
21 import io.netty.buffer.Unpooled;
22 import io.netty.channel.embedded.EmbeddedChannel;
23 import io.netty.util.CharsetUtil;
24 import io.netty.util.ReferenceCountUtil;
25 import io.netty.util.internal.EmptyArrays;
26 import io.netty.util.internal.PlatformDependent;
27 import org.junit.jupiter.api.Test;
28 import org.junit.jupiter.api.function.Executable;
29 import java.io.ByteArrayOutputStream;
30 import java.io.IOException;
31 import java.io.OutputStream;
32 import java.util.Random;
33 import java.util.zip.DeflaterOutputStream;
34 import java.util.zip.GZIPInputStream;
35 import java.util.zip.GZIPOutputStream;
36 import static org.junit.jupiter.api.Assertions.assertEquals;
37 import static org.junit.jupiter.api.Assertions.assertFalse;
38 import static org.junit.jupiter.api.Assertions.assertNull;
39 import static org.junit.jupiter.api.Assertions.assertThrows;
40 import static org.junit.jupiter.api.Assertions.assertTrue;
41 public abstract class ZlibTest {
42     private static final byte[] BYTES_SMALL = new byte[128];
43     private static final byte[] BYTES_LARGE = new byte[1024 * 1024];
44     private static final byte[] BYTES_LARGE2 = ("&lt;!--?xml version=\"1.0\" encoding=\"ISO-8859-1\"?--&gt;\n" +
45             "&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" " +
46             "\"https://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"&gt;\n" +
47             "&lt;html xmlns=\"https://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\"&gt;&lt;head&gt;\n" +
48             "    &lt;title&gt;Apache Tomcat&lt;/title&gt;\n" +
49             "&lt;/head&gt;\n" +
50             '\n' +
51             "&lt;body&gt;\n" +
52             "&lt;h1&gt;It works !&lt;/h1&gt;\n" +
53             '\n' +
54             "&lt;p&gt;If you're seeing this page via a web browser, it means you've setup Tomcat successfully." +
55             " Congratulations!&lt;/p&gt;\n" +
56             " \n" +
57             "&lt;p&gt;This is the default Tomcat home page." +
58             " It can be found on the local filesystem at: &lt;code&gt;/var/lib/tomcat7/webapps/ROOT/index.html&lt;/code&gt;&lt;/p&gt;\n" +
59             '\n' +
60             "&lt;p&gt;Tomcat7 veterans might be pleased to learn that this system instance of Tomcat is installed with" +
61             " &lt;code&gt;CATALINA_HOME&lt;/code&gt; in &lt;code&gt;/usr/share/tomcat7&lt;/code&gt; and &lt;code&gt;CATALINA_BASE&lt;/code&gt; in" +
62             " &lt;code&gt;/var/lib/tomcat7&lt;/code&gt;, following the rules from" +
63             " &lt;code&gt;/usr/share/doc/tomcat7-common/RUNNING.txt.gz&lt;/code&gt;.&lt;/p&gt;\n" +
64             '\n' +
65             "&lt;p&gt;You might consider installing the following packages, if you haven't already done so:&lt;/p&gt;\n" +
66             '\n' +
67             "&lt;p&gt;&lt;b&gt;tomcat7-docs&lt;/b&gt;: This package installs a web application that allows to browse the Tomcat 7" +
68             " documentation locally. Once installed, you can access it by clicking &lt;a href=\"docs/\"&gt;here&lt;/a&gt;.&lt;/p&gt;\n" +
69             '\n' +
70             "&lt;p&gt;&lt;b&gt;tomcat7-examples&lt;/b&gt;: This package installs a web application that allows to access the Tomcat" +
71             " 7 Servlet and JSP examples. Once installed, you can access it by clicking" +
72             " &lt;a href=\"examples/\"&gt;here&lt;/a&gt;.&lt;/p&gt;\n" +
73             '\n' +
74             "&lt;p&gt;&lt;b&gt;tomcat7-admin&lt;/b&gt;: This package installs two web applications that can help managing this Tomcat" +
75             " instance. Once installed, you can access the &lt;a href=\"manager/html\"&gt;manager webapp&lt;/a&gt; and" +
76             " the &lt;a href=\"host-manager/html\"&gt;host-manager webapp&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;\n" +
77             '\n' +
78             "&lt;/p&gt;&lt;p&gt;NOTE: For security reasons, using the manager webapp is restricted" +
79             " to users with role \"manager\"." +
80             " The host-manager webapp is restricted to users with role \"admin\". Users are " +
81             "defined in &lt;code&gt;/etc/tomcat7/tomcat-users.xml&lt;/code&gt;.&lt;/p&gt;\n" +
82             '\n' +
83             '\n' +
84             '\n' +
85             "&lt;/body&gt;&lt;/html&gt;").getBytes(CharsetUtil.UTF_8);
86     static {
87         Random rand = PlatformDependent.threadLocalRandom();
88         rand.nextBytes(BYTES_SMALL);
89         rand.nextBytes(BYTES_LARGE);
90     }
91     protected ZlibDecoder createDecoder(ZlibWrapper wrapper) {
92         return createDecoder(wrapper, 0);
93     }
94     protected abstract ZlibEncoder createEncoder(ZlibWrapper wrapper);
95     protected abstract ZlibDecoder createDecoder(ZlibWrapper wrapper, int maxAllocation);
96     @Test
97     public void testGZIP2() throws Exception {
98         byte[] bytes = "message".getBytes(CharsetUtil.UTF_8);
99         ByteBuf data = Unpooled.wrappedBuffer(bytes);
100         ByteBuf deflatedData = Unpooled.wrappedBuffer(gzip(bytes));
101         EmbeddedChannel chDecoderGZip = new EmbeddedChannel(createDecoder(ZlibWrapper.GZIP));
102         try {
103             while (deflatedData.isReadable()) {
104                 chDecoderGZip.writeInbound(deflatedData.readRetainedSlice(1));
105             }
106             deflatedData.release();
107             assertTrue(chDecoderGZip.finish());
108             ByteBuf buf = Unpooled.buffer();
109             for (;;) {
110                 ByteBuf b = chDecoderGZip.readInbound();
111                 if (b == null) {
112                     break;
113                 }
114                 buf.writeBytes(b);
115                 b.release();
116             }
117             assertEquals(buf, data);
118             assertNull(chDecoderGZip.readInbound());
119             data.release();
120             buf.release();
121         } finally {
122             dispose(chDecoderGZip);
123         }
124     }
125     @Test
126     public void testGZIP3() throws Exception {
127         byte[] bytes = "Foo".getBytes(CharsetUtil.UTF_8);
128         ByteBuf data = Unpooled.wrappedBuffer(bytes);
129         ByteBuf deflatedData = Unpooled.wrappedBuffer(
130                 new byte[]{
131                         31, -117,                         8,                         2,                         0, 0, 0, 0,                         0,                         7,                         -66, -77,                         115, -53, -49, 7, 0,                         -63, 35, 62, -76,                         3, 0, 0, 0                 }
132         );
133         EmbeddedChannel chDecoderGZip = new EmbeddedChannel(createDecoder(ZlibWrapper.GZIP));
134         try {
135             while (deflatedData.isReadable()) {
136                 chDecoderGZip.writeInbound(deflatedData.readRetainedSlice(1));
137             }
138             deflatedData.release();
139             assertTrue(chDecoderGZip.finish());
140             ByteBuf buf = Unpooled.buffer();
141             for (;;) {
142                 ByteBuf b = chDecoderGZip.readInbound();
143                 if (b == null) {
144                     break;
145                 }
146                 buf.writeBytes(b);
147                 b.release();
148             }
149             assertEquals(buf, data);
150             assertNull(chDecoderGZip.readInbound());
151             data.release();
152             buf.release();
153         } finally {
154             dispose(chDecoderGZip);
155         }
156     }
157     private void testCompress0(ZlibWrapper encoderWrapper, ZlibWrapper decoderWrapper, ByteBuf data) throws Exception {
158         EmbeddedChannel chEncoder = new EmbeddedChannel(createEncoder(encoderWrapper));
159         EmbeddedChannel chDecoderZlib = new EmbeddedChannel(createDecoder(decoderWrapper));
160         try {
161             chEncoder.writeOutbound(data.retain());
162             chEncoder.flush();
163             data.resetReaderIndex();
164             for (;;) {
165                 ByteBuf deflatedData = chEncoder.readOutbound();
166                 if (deflatedData == null) {
167                     break;
168                 }
169                 chDecoderZlib.writeInbound(deflatedData);
170             }
171             byte[] decompressed = new byte[data.readableBytes()];
172             int offset = 0;
173             for (;;) {
174                 ByteBuf buf = chDecoderZlib.readInbound();
175                 if (buf == null) {
176                     break;
177                 }
178                 int length = buf.readableBytes();
179                 buf.readBytes(decompressed, offset, length);
180                 offset += length;
181                 buf.release();
182                 if (offset == decompressed.length) {
183                     break;
184                 }
185             }
186             assertEquals(data, Unpooled.wrappedBuffer(decompressed));
187             assertNull(chDecoderZlib.readInbound());
188             assertTrue(chEncoder.finish());
189             for (;;) {
190                 Object msg = chEncoder.readOutbound();
191                 if (msg == null) {
192                     break;
193                 }
194                 ReferenceCountUtil.release(msg);
195             }
196             assertFalse(chDecoderZlib.finish());
197             data.release();
198         } finally {
199             dispose(chEncoder);
200             dispose(chDecoderZlib);
201         }
202     }
203     private void testCompressNone(ZlibWrapper encoderWrapper, ZlibWrapper decoderWrapper) throws Exception {
204         EmbeddedChannel chEncoder = new EmbeddedChannel(createEncoder(encoderWrapper));
205         EmbeddedChannel chDecoderZlib = new EmbeddedChannel(createDecoder(decoderWrapper));
206         try {
207             assertTrue(chEncoder.finish());
208             for (;;) {
209                 ByteBuf deflatedData = chEncoder.readOutbound();
210                 if (deflatedData == null) {
211                     break;
212                 }
213                 chDecoderZlib.writeInbound(deflatedData);
214             }
215             boolean decoded = false;
216             for (;;) {
217                 ByteBuf buf = chDecoderZlib.readInbound();
218                 if (buf == null) {
219                     break;
220                 }
221                 buf.release();
222                 decoded = true;
223             }
224             assertFalse(decoded, "should decode nothing");
225             assertFalse(chDecoderZlib.finish());
226         } finally {
227             dispose(chEncoder);
228             dispose(chDecoderZlib);
229         }
230     }
231     private static void dispose(EmbeddedChannel ch) {
232         if (ch.finish()) {
233             for (;;) {
234                 Object msg = ch.readInbound();
235                 if (msg == null) {
236                     break;
237                 }
238                 ReferenceCountUtil.release(msg);
239             }
240             for (;;) {
241                 Object msg = ch.readOutbound();
242                 if (msg == null) {
243                     break;
244                 }
245                 ReferenceCountUtil.release(msg);
246             }
247         }
248     }
249     private void testDecompressOnly(ZlibWrapper decoderWrapper, byte[] compressed, byte[] data) throws Exception {
250         EmbeddedChannel chDecoder = new EmbeddedChannel(createDecoder(decoderWrapper));
251         chDecoder.writeInbound(Unpooled.copiedBuffer(compressed));
252         assertTrue(chDecoder.finish());
253         ByteBuf decoded = Unpooled.buffer(data.length);
254         for (;;) {
255             ByteBuf buf = chDecoder.readInbound();
256             if (buf == null) {
257                 break;
258             }
259             decoded.writeBytes(buf);
260             buf.release();
261         }
262         assertEquals(Unpooled.copiedBuffer(data), decoded);
263         decoded.release();
264     }
265     private void testCompressSmall(ZlibWrapper encoderWrapper, ZlibWrapper decoderWrapper) throws Exception {
266         testCompress0(encoderWrapper, decoderWrapper, Unpooled.wrappedBuffer(BYTES_SMALL));
267         testCompress0(encoderWrapper, decoderWrapper,
268                 Unpooled.directBuffer(BYTES_SMALL.length).writeBytes(BYTES_SMALL));
269     }
270 <a name="1"></a>
271     private void testCompressLarge(ZlibWrapper encoderWrapper, ZlibWrapper decoderWrapper) throws Exception {
272         testCompress0(encoderWrapper, decoderWrapper, Unpooled.wrappedBuffer(BYTES_LARGE));
273         <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>testCompress0(encoderWrapper, decoderWrapper,
274                 Unpooled.directBuffer(BYTES_LARGE.length).writeBytes(BYTES_LARGE));
275     }
276     @Test
277     public void testZLIB() throws Exception {
278         testCompressNone(ZlibWrapper.ZLIB, ZlibWrapper.ZLIB);
279         testCompressSmall(ZlibWrapper.ZLIB, ZlibWrapper.ZLIB);
280         testCompressLarge(ZlibWrapper.ZLIB, ZlibWrapper.ZLIB);
281         testDecompressOnly(ZlibWrapper.ZLIB, deflate</b></font>(BYTES_LARGE2), BYTES_LARGE2);
282     }
283     @Test
284     public void testNONE() throws Exception {
285         testCompressNone(ZlibWrapper.NONE, ZlibWrapper.NONE);
286         testCompressSmall(ZlibWrapper.NONE, ZlibWrapper.NONE);
287         testCompressLarge(ZlibWrapper.NONE, ZlibWrapper.NONE);
288     }
289 <a name="2"></a>
290     @Test
291     public void testGZIP() throws Exception {
292         <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>testCompressNone(ZlibWrapper.GZIP, ZlibWrapper.GZIP);
293         testCompressSmall(ZlibWrapper.GZIP, ZlibWrapper.GZIP);
294         testCompressLarge(ZlibWrapper.GZIP, ZlibWrapper.GZIP);
295         testDecompressOnly(ZlibWrapper.GZIP, gzip(BYTES_LARGE2), BYTES_LARGE2);
296     }
297     @Test
298     public void testGZIPCompressOnly() throws Exception {
299         testGZIPCompressOnly0(null);         testGZIPCompressOnly0</b></font>(EmptyArrays.EMPTY_BYTES);         testGZIPCompressOnly0(BYTES_SMALL);
300         testGZIPCompressOnly0(BYTES_LARGE);
301     }
302     private void testGZIPCompressOnly0(byte[] data) throws IOException {
303         EmbeddedChannel chEncoder = new EmbeddedChannel(createEncoder(ZlibWrapper.GZIP));
304         if (data != null) {
305             chEncoder.writeOutbound(Unpooled.wrappedBuffer(data));
306         }
307         assertTrue(chEncoder.finish());
308         ByteBuf encoded = Unpooled.buffer();
309         for (;;) {
310             ByteBuf buf = chEncoder.readOutbound();
311             if (buf == null) {
312                 break;
313             }
314             encoded.writeBytes(buf);
315             buf.release();
316         }
317         ByteBuf decoded = Unpooled.buffer();
318         GZIPInputStream stream = new GZIPInputStream(new ByteBufInputStream(encoded, true));
319         try {
320             byte[] buf = new byte[8192];
321             for (;;) {
322                 int readBytes = stream.read(buf);
323                 if (readBytes &lt; 0) {
324                     break;
325                 }
326                 decoded.writeBytes(buf, 0, readBytes);
327             }
328         } finally {
329             stream.close();
330         }
331         if (data != null) {
332             assertEquals(Unpooled.wrappedBuffer(data), decoded);
333         } else {
334             assertFalse(decoded.isReadable());
335         }
336         decoded.release();
337     }
338 <a name="4"></a>    @Test
339     public void testZLIB_OR_NONE() throws Exception {
340         testCompressNone(ZlibWrapper.NONE, ZlibWrapper.ZLIB_OR_NONE);
341         <font color="#6cc417"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>testCompressSmall(ZlibWrapper.NONE, ZlibWrapper.ZLIB_OR_NONE);
342         testCompressLarge(ZlibWrapper.NONE, ZlibWrapper.ZLIB_OR_NONE);
343     }
344     @Test
345 <a name="3"></a>    public void testZLIB_OR_NONE2() throws Exception {
346         testCompressNone(ZlibWrapper.ZLIB, ZlibWrapper.ZLIB_OR_NONE);
347         testCompressSmall</b></font>(ZlibWrapper.ZLIB, ZlibWrapper.ZLIB_OR_NONE);
348         <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>testCompressLarge(ZlibWrapper.ZLIB, ZlibWrapper.ZLIB_OR_NONE);
349     }
350     @Test
351     public void testZLIB_OR_NONE3() throws Exception {
352         testCompressNone(ZlibWrapper.GZIP, ZlibWrapper.ZLIB_OR_NONE);
353         testCompressSmall(ZlibWrapper.GZIP, ZlibWrapper.ZLIB_OR_NONE);
354         testCompressLarge</b></font>(ZlibWrapper.GZIP, ZlibWrapper.ZLIB_OR_NONE);
355     }
356     @Test
357     public void testMaxAllocation() throws Exception {
358         int maxAllocation = 1024;
359         ZlibDecoder decoder = createDecoder(ZlibWrapper.ZLIB, maxAllocation);
360         final EmbeddedChannel chDecoder = new EmbeddedChannel(decoder);
361         TestByteBufAllocator alloc = new TestByteBufAllocator(chDecoder.alloc());
362         chDecoder.config().setAllocator(alloc);
363         DecompressionException e = assertThrows(DecompressionException.class, new Executable() {
364             @Override
365             public void execute() throws Throwable {
366 <a name="0"></a>                chDecoder.writeInbound(Unpooled.wrappedBuffer(deflate(BYTES_LARGE)));
367             }
368         });
369         <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>assertTrue(e.getMessage().startsWith("Decompression buffer has reached maximum size"));
370         assertEquals(maxAllocation, alloc.getMaxAllocation());
371         assertTrue(decoder.isClosed());
372         assertFalse(chDecoder.finish());
373     }
374     private static byte[] gzip(byte[] bytes) throws IOException {
375         ByteArrayOutputStream out = new ByteArrayOutputStream()</b></font>;
376         GZIPOutputStream stream = new GZIPOutputStream(out);
377         stream.write(bytes);
378         stream.close();
379         return out.toByteArray();
380     }
381     private static byte[] deflate(byte[] bytes) throws IOException {
382         ByteArrayOutputStream out = new ByteArrayOutputStream();
383         OutputStream stream = new DeflaterOutputStream(out);
384         stream.write(bytes);
385         stream.close();
386         return out.toByteArray();
387     }
388     private static final class TestByteBufAllocator extends AbstractByteBufAllocator {
389         private final ByteBufAllocator wrapped;
390         private int maxAllocation;
391         TestByteBufAllocator(ByteBufAllocator wrapped) {
392             this.wrapped = wrapped;
393         }
394         public int getMaxAllocation() {
395             return maxAllocation;
396         }
397         @Override
398         public boolean isDirectBufferPooled() {
399             return wrapped.isDirectBufferPooled();
400         }
401         @Override
402         protected ByteBuf newHeapBuffer(int initialCapacity, int maxCapacity) {
403             maxAllocation = Math.max(maxAllocation, maxCapacity);
404             return wrapped.heapBuffer(initialCapacity, maxCapacity);
405         }
406         @Override
407         protected ByteBuf newDirectBuffer(int initialCapacity, int maxCapacity) {
408             maxAllocation = Math.max(maxAllocation, maxCapacity);
409             return wrapped.directBuffer(initialCapacity, maxCapacity);
410         }
411     }
412 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
