
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 8.494208494208493%, Tokens: 11</h2>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ByteArrayComparatorTest.java</h3>
            <pre><code>1  package redis.clients.jedis.util;
2  import static org.junit.Assert.assertTrue;
3  import org.junit.Test;
4  public class ByteArrayComparatorTest {
5    @Test
6    public void test() {
<span onclick='openModal()' class='match'>7      byte[] foo = SafeEncoder.encode("foo");
8      byte[] foo2 = SafeEncoder.encode("foo");
9      byte[] bar = SafeEncoder.encode("bar");
10      assertTrue(ByteArrayComparator.compare(foo, foo2) == 0);
11      assertTrue(ByteArrayComparator.compare(foo, bar) > 0);
12      assertTrue(ByteArrayComparator.compare(bar, foo) < 0);
</span>13    }
14    @Test
15    public void testPrefix() {
16      byte[] foo = SafeEncoder.encode("foo");
17      byte[] fooo = SafeEncoder.encode("fooo");
18      assertTrue(ByteArrayComparator.compare(foo, fooo) < 0);
19      assertTrue(ByteArrayComparator.compare(fooo, foo) > 0);
20    }
21  }
</code></pre>
        </div>
        <div class="column">
            <h3>motan-MDEwOlJlcG9zaXRvcnk1NjY3OTUyMQ==-flat-BaseSerializeTest.java</h3>
            <pre><code>1  package com.weibo.api.motan.serialize;
2  import com.weibo.api.motan.codec.Serialization;
3  import java.io.IOException;
4  import java.io.Serializable;
5  import java.sql.Timestamp;
6  import java.util.HashMap;
7  import java.util.Map;
8  import static org.junit.Assert.*;
9  public class BaseSerializeTest {
10      Serialization serialization;
11      public BaseSerializeTest(Serialization serialization) {
12          this.serialization = serialization;
13      }
14      public void test() throws Exception {
15          testCompatibility(serialization);
16          testHessianBug(serialization);
17          testHessianDeserializeException(serialization);
18          testHessianTimeStampBug(serialization);
19          testSerialization(serialization);
20          testSerializeMulti(serialization);
21      }
22      public static void testCompatibility(Serialization serialization) throws Exception {
23          SubModel.SerializationObject1 test1 = new SubModel.SerializationObject1();
24          SubModel.SerializationObject1 result = serialization.deserialize(serialization.serialize(test1), SubModel.SerializationObject1.class);
25          assertEquals(test1.a, result.a);
26          assertEquals(test1.b, result.b);
27      }
28      public static void testSerialization(Serialization serialization) throws IOException {
29          Model model = new Model();
30          model.add("world1", new SubModel("hello1", 1));
31          model.add("world2", new SubModel("hello2", 2));
32          model.add("world3", new SubModel("hello3", 2));
33          Model result = serialization.deserialize(serialization.serialize(model), Model.class);
34          assertNotNull(result);
35          assertEquals(model.toString(), result.toString());
36          UserAttentions user = new UserAttentions();
37          user.setAddTimes(null);
38          UserAttentions userResult = serialization.deserialize(serialization.serialize(user), UserAttentions.class);
39          assertNull(userResult.getAddTimes());
40      }
41      public static void testHessianBug(Serialization serialization) throws Exception {
42          UserAttentions ua1 = new UserAttentions(1234L, new long[]{}, new long[]{}, 0, 0L);
43          UserAttentions ua2 = new UserAttentions(1234L, new long[]{}, new long[]{}, 0);
44          byte[] bytes1 = serialization.serialize(ua1);
45          byte[] bytes2 = serialization.serialize(ua2);
46          assertEquals(bytes1.length, bytes2.length);
47          UserAttentions result = serialization.deserialize(bytes1, UserAttentions.class);
48          assertEquals(ua2.getUid(), result.getUid());
49      }
50      public static void testHessianTimeStampBug(Serialization serialization) throws Exception {
51          UserAttentions ua = new UserAttentions(1234L, new long[]{}, new long[]{}, 0, 0L);
<span onclick='openModal()' class='match'>52          Timestamp timestamp = ua.getTimeStamp();
53          byte[] b = serialization.serialize(ua);
54          UserAttentions result = serialization.deserialize(b, UserAttentions.class);
55          assertEquals(result.getTimeStamp().getTime(), timestamp.getTime());
56          ua.setTimeStamp(null);
</span>57          b = serialization.serialize(ua);
58          result = serialization.deserialize(b, UserAttentions.class);
59          assertNull(result.getTimeStamp());
60      }
61      public static void testHessianDeserializeException(Serialization serialization) throws Exception {
62          UserAttentions user = new UserAttentions();
63          user.setAddTimes(null);
64          try {
65              serialization.deserialize(serialization.serialize(user), UnModel.class);
66          } catch (Exception e) {
67              e.printStackTrace();
68          }
69      }
70      public static void testSerializeMulti(Serialization serialization) throws Exception {
71          Object[] objects = new Object[]{"123", 456, true, 45.67f};
72          byte[] bytes = serialization.serializeMulti(objects);
73          Class[] classes = new Class[objects.length];
74          for (int i = 0; i < objects.length; i++) {
75              classes[i] = objects[i].getClass();
76          }
77          Object[] newObjs = serialization.deserializeMulti(bytes, classes);
78          for (int i = 0; i < objects.length; i++) {
79              assertEquals(objects[i], newObjs[i]);
80          }
81      }
82      public static class UnModel {
83      }
84      public static class Model implements Serializable {
85          private static final long serialVersionUID = -6654784635984161860L;
86          private Map<String, SubModel> map = new HashMap<String, SubModel>();
87          private Integer index = 10;
88          public void add(String key, SubModel value) {
89              map.put(key, value);
90          }
91          public String toString() {
92              StringBuilder builder = new StringBuilder();
93              builder.append(index).append("\n");
94              for (Map.Entry<String, SubModel> entry : map.entrySet()) {
95                  builder.append(entry.getKey()).append("     ").append(entry.getValue().toString()).append("\n");
96              }
97              return builder.toString();
98          }
99          public Map<String, SubModel> getMap() {
100              return map;
101          }
102          public Integer getIndex() {
103              return index;
104          }
105      }
106      public static class SubModel implements java.io.Serializable {
107          private static final long serialVersionUID = 4797257086799637170L;
108          private String name;
109          private int age;
110          private long[] addTimes = null; 
111          public SubModel(String name, int age) {
112              this.name = name;
113              this.age = age;
114          }
115          public SubModel() {
116          }
117          public String getName() {
118              return name;
119          }
120          public void setName(String name) {
121              this.name = name;
122          }
123          public int getAge() {
124              return age;
125          }
126          public void setAge(int age) {
127              this.age = age;
128          }
129          public String toString() {
130              return name + ":" + age;
131          }
132          public long[] getAddTimes() {
133              return addTimes;
134          }
135          public void setAddTimes(long[] addTimes) {
136              this.addTimes = addTimes;
137          }
138          public static class SerializationObject1 implements Serializable {
139              private static final long serialVersionUID = -4917299054507959821L;
140              public int a = 10;
141              public long b = 20;
142          }
143          public static class SerializationObject2 implements Serializable {
144              private static final long serialVersionUID = 302091199018752193L;
145              public int a = 10;
146              public int c = 30;
147          }
148      }
149  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ByteArrayComparatorTest.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from motan-MDEwOlJlcG9zaXRvcnk1NjY3OTUyMQ==-flat-BaseSerializeTest.java</div>
                </div>
                <div class="column column_space"><pre><code>7      byte[] foo = SafeEncoder.encode("foo");
8      byte[] foo2 = SafeEncoder.encode("foo");
9      byte[] bar = SafeEncoder.encode("bar");
10      assertTrue(ByteArrayComparator.compare(foo, foo2) == 0);
11      assertTrue(ByteArrayComparator.compare(foo, bar) > 0);
12      assertTrue(ByteArrayComparator.compare(bar, foo) < 0);
</pre></code></div>
                <div class="column column_space"><pre><code>52          Timestamp timestamp = ua.getTimeStamp();
53          byte[] b = serialization.serialize(ua);
54          UserAttentions result = serialization.deserialize(b, UserAttentions.class);
55          assertEquals(result.getTimeStamp().getTime(), timestamp.getTime());
56          ua.setTimeStamp(null);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    