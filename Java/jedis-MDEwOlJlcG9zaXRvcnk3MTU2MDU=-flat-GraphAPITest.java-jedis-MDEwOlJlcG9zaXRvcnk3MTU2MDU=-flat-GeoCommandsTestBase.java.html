
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 17, <button onclick='openModal()' class='match'>CODE CLONE</button></h2>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-GraphAPITest.java</h3>
            <pre><code>1  package redis.clients.jedis.modules.graph;
2  import static org.junit.Assert.assertEquals;
3  import static org.junit.Assert.assertFalse;
4  import static org.junit.Assert.assertNotNull;
5  import static org.junit.Assert.assertNull;
6  import static org.junit.Assert.assertTrue;
7  import static org.junit.Assert.fail;
8  import java.util.*;
9  import org.junit.After;
10  import org.junit.Assert;
11  import org.junit.BeforeClass;
12  import org.junit.Test;
13  import redis.clients.jedis.graph.Header;
14  import redis.clients.jedis.graph.Record;
15  import redis.clients.jedis.graph.ResultSet;
16  import redis.clients.jedis.graph.Statistics;
17  import redis.clients.jedis.graph.entities.*;
18  import redis.clients.jedis.modules.RedisModuleCommandsTestBase;
19  public class GraphAPITest extends RedisModuleCommandsTestBase {
20    @BeforeClass
21    public static void prepare() {
22      RedisModuleCommandsTestBase.prepare();
23    }
24    @After
25    @Override
26    public void tearDown() throws Exception {
27      client.graphDelete(&quot;social&quot;);
28      super.tearDown();
29    }
30      @Test
31      public void testCreateNode() {
32          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;CREATE ({name:&#x27;roi&#x27;,age:32})&quot;);
33          Statistics stats = resultSet.getStatistics();
34          assertEquals(1, stats.nodesCreated());
35          assertEquals(0, stats.nodesDeleted());
36          assertEquals(0, stats.relationshipsCreated());
37          assertEquals(0, stats.relationshipsDeleted());
38          assertEquals(2, stats.propertiesSet());
39          assertNotNull(stats.queryIntervalExecutionTime());
40          assertEquals(0, resultSet.size());
41          assertFalse(resultSet.iterator().hasNext());
42          try {
43              resultSet.iterator().next();
44              fail();
45          } catch (NoSuchElementException ignored) {
46          }
47      }
48      @Test
49      public void testCreateLabeledNode() {
50          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;CREATE (:human{name:&#x27;danny&#x27;,age:12})&quot;);
51          Statistics stats = resultSet.getStatistics();
52          assertEquals(1, stats.nodesCreated());
53          assertEquals(2, stats.propertiesSet());
54          assertNotNull(stats.queryIntervalExecutionTime());
55          assertEquals(0, resultSet.size());
56          assertFalse(resultSet.iterator().hasNext());
57      }
58      @Test
59      public void testConnectNodes() {
60          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
61          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
62          ResultSet resultSet = client.graphQuery(&quot;social&quot;,
63                  &quot;MATCH (a:person), (b:person) WHERE (a.name = &#x27;roi&#x27; AND b.name=&#x27;amit&#x27;)  CREATE (a)-[:knows]-&gt;(b)&quot;);
64          Statistics stats = resultSet.getStatistics();
65          assertEquals(0, stats.nodesCreated());
66          assertEquals(1, stats.relationshipsCreated());
67          assertEquals(0, stats.relationshipsDeleted());
68          assertEquals(0, stats.propertiesSet());
69          assertNotNull(stats.queryIntervalExecutionTime());
70          assertEquals(0, resultSet.size());
71          assertFalse(resultSet.iterator().hasNext());
72      }
73      @Test
74      public void testDeleteNodes() {
75          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
76          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
77          ResultSet deleteResult = client.graphQuery(&quot;social&quot;, &quot;MATCH (a:person) WHERE (a.name = &#x27;roi&#x27;) DELETE a&quot;);
78          Statistics delStats = deleteResult.getStatistics();
79          assertEquals(0, delStats.nodesCreated());
80          assertEquals(1, delStats.nodesDeleted());
81          assertEquals(0, delStats.relationshipsCreated());
82          assertEquals(0, delStats.relationshipsDeleted());
83          assertEquals(0, delStats.propertiesSet());
84          assertNotNull(delStats.queryIntervalExecutionTime());
85          assertEquals(0, deleteResult.size());
86          assertFalse(deleteResult.iterator().hasNext());
87          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
88          assertNotNull(client.graphQuery(&quot;social&quot;,
89                  &quot;MATCH (a:person), (b:person) WHERE (a.name = &#x27;roi&#x27; AND b.name=&#x27;amit&#x27;)  CREATE (a)-[:knows]-&gt;(a)&quot;));
90          deleteResult = client.graphQuery(&quot;social&quot;, &quot;MATCH (a:person) WHERE (a.name = &#x27;roi&#x27;) DELETE a&quot;);
91          assertEquals(0, delStats.nodesCreated());
92          assertEquals(1, delStats.nodesDeleted());
93          assertEquals(0, delStats.relationshipsCreated());
94          assertEquals(0, delStats.relationshipsDeleted());
95          assertEquals(0, delStats.propertiesSet());
96          assertNotNull(delStats.queryIntervalExecutionTime());
97          assertEquals(0, deleteResult.size());
98          assertFalse(deleteResult.iterator().hasNext());
99      }
100      @Test
101      public void testDeleteRelationship() {
102          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
103          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
104          assertNotNull(client.graphQuery(&quot;social&quot;,
105                  &quot;MATCH (a:person), (b:person) WHERE (a.name = &#x27;roi&#x27; AND b.name=&#x27;amit&#x27;)  CREATE (a)-[:knows]-&gt;(a)&quot;));
106          ResultSet deleteResult = client.graphQuery(&quot;social&quot;,
107                  &quot;MATCH (a:person)-[e]-&gt;() WHERE (a.name = &#x27;roi&#x27;) DELETE e&quot;);
108          Statistics delStats = deleteResult.getStatistics();
109          assertEquals(0, delStats.nodesCreated());
110          assertEquals(0, delStats.nodesDeleted());
111          assertEquals(0, delStats.relationshipsCreated());
112          assertEquals(1, delStats.relationshipsDeleted());
113          assertEquals(0, delStats.propertiesSet());
114          assertNotNull(delStats.queryIntervalExecutionTime());
115          assertEquals(0, deleteResult.size());
116          assertFalse(deleteResult.iterator().hasNext());
117      }
118      @Test
119      public void testIndex() {
120          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
121          ResultSet createIndexResult = client.graphQuery(&quot;social&quot;, &quot;CREATE INDEX ON :person(age)&quot;);
122          assertFalse(createIndexResult.iterator().hasNext());
123          assertEquals(1, createIndexResult.getStatistics().indicesCreated());
124          ResultSet createNonExistingIndexResult = client.graphQuery(&quot;social&quot;, &quot;CREATE INDEX ON :person(age1)&quot;);
125          assertFalse(createNonExistingIndexResult.iterator().hasNext());
126          assertEquals(1, createNonExistingIndexResult.getStatistics().indicesCreated());
127          ResultSet createExistingIndexResult = client.graphQuery(&quot;social&quot;, &quot;CREATE INDEX ON :person(age)&quot;);
128          assertFalse(createExistingIndexResult.iterator().hasNext());
129          assertEquals(0, createExistingIndexResult.getStatistics().indicesCreated());
130          ResultSet deleteExistingIndexResult = client.graphQuery(&quot;social&quot;, &quot;DROP INDEX ON :person(age)&quot;);
131          assertFalse(deleteExistingIndexResult.iterator().hasNext());
132          assertEquals(1, deleteExistingIndexResult.getStatistics().indicesDeleted());
133      }
134      @Test
135      public void testHeader() {
136          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
137          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
138          assertNotNull(client.graphQuery(&quot;social&quot;,
139                  &quot;MATCH (a:person), (b:person) WHERE (a.name = &#x27;roi&#x27; AND b.name=&#x27;amit&#x27;)  CREATE (a)-[:knows]-&gt;(a)&quot;));
140          ResultSet queryResult = client.graphQuery(&quot;social&quot;, &quot;MATCH (a:person)-[r:knows]-&gt;(b:person) RETURN a,r, a.age&quot;);
141          Header header = queryResult.getHeader();
142          assertNotNull(header);
143          assertEquals(&quot;HeaderImpl{&quot;
144                  + &quot;schemaTypes=[SCALAR, SCALAR, SCALAR], &quot;
145                  + &quot;schemaNames=[a, r, a.age]}&quot;, header.toString());
146          List&lt;String&gt; schemaNames = header.getSchemaNames();
147          assertNotNull(schemaNames);
148          assertEquals(3, schemaNames.size());
149          assertEquals(&quot;a&quot;, schemaNames.get(0));
150          assertEquals(&quot;r&quot;, schemaNames.get(1));
151          assertEquals(&quot;a.age&quot;, schemaNames.get(2));
152      }
153      @Test
154      public void testRecord() {
155          String name = &quot;roi&quot;;
156          int age = 32;
157          double doubleValue = 3.14;
158          boolean boolValue = true;
159          String place = &quot;TLV&quot;;
160          int since = 2000;
161          Property&lt;String&gt; nameProperty = new Property&lt;&gt;(&quot;name&quot;, name);
162          Property&lt;Integer&gt; ageProperty = new Property&lt;&gt;(&quot;age&quot;, age);
163          Property&lt;Double&gt; doubleProperty = new Property&lt;&gt;(&quot;doubleValue&quot;, doubleValue);
164          Property&lt;Boolean&gt; trueBooleanProperty = new Property&lt;&gt;(&quot;boolValue&quot;, true);
165          Property&lt;Boolean&gt; falseBooleanProperty = new Property&lt;&gt;(&quot;boolValue&quot;, false);
166          Property&lt;String&gt; placeProperty = new Property&lt;&gt;(&quot;place&quot;, place);
167          Property&lt;Integer&gt; sinceProperty = new Property&lt;&gt;(&quot;since&quot;, since);
168          Node expectedNode = new Node();
169          expectedNode.setId(0);
170          expectedNode.addLabel(&quot;person&quot;);
171          expectedNode.addProperty(nameProperty);
172          expectedNode.addProperty(ageProperty);
173          expectedNode.addProperty(doubleProperty);
174          expectedNode.addProperty(trueBooleanProperty);
175          assertEquals(
176                  &quot;Node{labels=[person], id=0, &quot;
177                          + &quot;propertyMap={name=Property{name=&#x27;name&#x27;, value=roi}, &quot;
178                          + &quot;boolValue=Property{name=&#x27;boolValue&#x27;, value=true}, &quot;
179                          + &quot;doubleValue=Property{name=&#x27;doubleValue&#x27;, value=3.14}, &quot;
180                          + &quot;age=Property{name=&#x27;age&#x27;, value=32}}}&quot;,
181                  expectedNode.toString());
182          Edge expectedEdge = new Edge();
183          expectedEdge.setId(0);
184          expectedEdge.setSource(0);
185          expectedEdge.setDestination(1);
186          expectedEdge.setRelationshipType(&quot;knows&quot;);
187          expectedEdge.addProperty(placeProperty);
188          expectedEdge.addProperty(sinceProperty);
189          expectedEdge.addProperty(doubleProperty);
190          expectedEdge.addProperty(falseBooleanProperty);
191          assertEquals(&quot;Edge{relationshipType=&#x27;knows&#x27;, source=0, destination=1, id=0, &quot;
192                  + &quot;propertyMap={boolValue=Property{name=&#x27;boolValue&#x27;, value=false}, &quot;
193                  + &quot;place=Property{name=&#x27;place&#x27;, value=TLV}, &quot;
194                  + &quot;doubleValue=Property{name=&#x27;doubleValue&#x27;, value=3.14}, &quot;
195                  + &quot;since=Property{name=&#x27;since&#x27;, value=2000}}}&quot;, expectedEdge.toString());
196          Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();
197          params.put(&quot;name&quot;, name);
198          params.put(&quot;age&quot;, age);
199          params.put(&quot;boolValue&quot;, boolValue);
200          params.put(&quot;doubleValue&quot;, doubleValue);
201          assertNotNull(client.graphQuery(&quot;social&quot;,
202                  &quot;CREATE (:person{name:$name,age:$age, doubleValue:$doubleValue, boolValue:$boolValue})&quot;, params));
203          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
204          assertNotNull(
205                  client.graphQuery(&quot;social&quot;, &quot;MATCH (a:person), (b:person) WHERE (a.name = &#x27;roi&#x27; AND b.name=&#x27;amit&#x27;)  &quot; +
206                          &quot;CREATE (a)-[:knows{place:&#x27;TLV&#x27;, since:2000,doubleValue:3.14, boolValue:false}]-&gt;(b)&quot;));
207          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH (a:person)-[r:knows]-&gt;(b:person) RETURN a,r, &quot; +
208                  &quot;a.name, a.age, a.doubleValue, a.boolValue, &quot; +
209                  &quot;r.place, r.since, r.doubleValue, r.boolValue&quot;);
210          assertNotNull(resultSet);
211          Statistics stats = resultSet.getStatistics();
212          assertEquals(0, stats.nodesCreated());
213          assertEquals(0, stats.nodesDeleted());
214          assertEquals(0, stats.labelsAdded());
215          assertEquals(0, stats.propertiesSet());
216          assertEquals(0, stats.relationshipsCreated());
217          assertEquals(0, stats.relationshipsDeleted());
218          assertNotNull(stats.queryIntervalExecutionTime());
219          assertFalse(stats.queryIntervalExecutionTime().isEmpty());
220          assertEquals(1, resultSet.size());
221          Iterator&lt;Record&gt; iterator = resultSet.iterator();
222          assertTrue(iterator.hasNext());
223          Record record = iterator.next();
224          assertFalse(iterator.hasNext());
225          Node node = record.getValue(0);
226          assertNotNull(node);
227          assertEquals(expectedNode, node);
228          node = record.getValue(&quot;a&quot;);
229          assertEquals(expectedNode, node);
230          Edge edge = record.getValue(1);
231          assertNotNull(edge);
232          assertEquals(expectedEdge, edge);
233          edge = record.getValue(&quot;r&quot;);
234          assertEquals(expectedEdge, edge);
235          assertEquals(Arrays.asList(&quot;a&quot;, &quot;r&quot;, &quot;a.name&quot;, &quot;a.age&quot;, &quot;a.doubleValue&quot;, &quot;a.boolValue&quot;,
236                  &quot;r.place&quot;, &quot;r.since&quot;, &quot;r.doubleValue&quot;, &quot;r.boolValue&quot;), record.keys());
237          assertEquals(Arrays.asList(expectedNode, expectedEdge,
238                  name, (long) age, doubleValue, true,
239                  place, (long) since, doubleValue, false),
240                  record.values());
241          Node a = record.getValue(&quot;a&quot;);
242          for (String propertyName : expectedNode.getEntityPropertyNames()) {
243              assertEquals(expectedNode.getProperty(propertyName), a.getProperty(propertyName));
244          }
245          assertEquals(&quot;roi&quot;, record.getString(2));
246          assertEquals(&quot;32&quot;, record.getString(3));
247          assertEquals(32L, ((Long) record.getValue(3)).longValue());
248          assertEquals(32L, ((Long) record.getValue(&quot;a.age&quot;)).longValue());
249          assertEquals(&quot;roi&quot;, record.getString(&quot;a.name&quot;));
250          assertEquals(&quot;32&quot;, record.getString(&quot;a.age&quot;));
251      }
252      @Test
253      public void testAdditionToProcedures() {
254          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
255          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
256          assertNotNull(client.graphQuery(&quot;social&quot;,
257                  &quot;MATCH (a:person), (b:person) WHERE (a.name = &#x27;roi&#x27; AND b.name=&#x27;amit&#x27;)  CREATE (a)-[:knows]-&gt;(b)&quot;));
258          Property&lt;String&gt; nameProperty = new Property&lt;&gt;(&quot;name&quot;, &quot;roi&quot;);
259          Property&lt;Integer&gt; ageProperty = new Property&lt;&gt;(&quot;age&quot;, 32);
260          Property&lt;String&gt; lastNameProperty = new Property&lt;&gt;(&quot;lastName&quot;, &quot;a&quot;);
261          Node expectedNode = new Node();
262          expectedNode.setId(0);
263          expectedNode.addLabel(&quot;person&quot;);
264          expectedNode.addProperty(nameProperty);
265          expectedNode.addProperty(ageProperty);
266          Edge expectedEdge = new Edge();
267          expectedEdge.setId(0);
268          expectedEdge.setSource(0);
269          expectedEdge.setDestination(1);
270          expectedEdge.setRelationshipType(&quot;knows&quot;);
271          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH (a:person)-[r:knows]-&gt;(b:person) RETURN a,r&quot;);
272          assertNotNull(resultSet.getHeader());
273          Header header = resultSet.getHeader();
274          List&lt;String&gt; schemaNames = header.getSchemaNames();
275          assertNotNull(schemaNames);
276          assertEquals(2, schemaNames.size());
277          assertEquals(&quot;a&quot;, schemaNames.get(0));
278          assertEquals(&quot;r&quot;, schemaNames.get(1));
279          assertEquals(1, resultSet.size());
280          Iterator&lt;Record&gt; iterator = resultSet.iterator();
281          assertTrue(iterator.hasNext());
282          Record record = iterator.next();
283          assertFalse(iterator.hasNext());
284          assertEquals(Arrays.asList(&quot;a&quot;, &quot;r&quot;), record.keys());
285          assertEquals(Arrays.asList(expectedNode, expectedEdge), record.values());
286          expectedNode.removeProperty(&quot;name&quot;);
287          expectedNode.removeProperty(&quot;age&quot;);
288          expectedNode.addProperty(lastNameProperty);
289          expectedNode.removeLabel(&quot;person&quot;);
290          expectedNode.addLabel(&quot;worker&quot;);
291          expectedNode.setId(2);
292          expectedEdge.setRelationshipType(&quot;worksWith&quot;);
293          expectedEdge.setSource(2);
294          expectedEdge.setDestination(3);
295          expectedEdge.setId(1);
296          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:worker{lastName:&#x27;a&#x27;})&quot;));
297          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:worker{lastName:&#x27;b&#x27;})&quot;));
298          assertNotNull(client.graphQuery(&quot;social&quot;,
299                  &quot;MATCH (a:worker), (b:worker) WHERE (a.lastName = &#x27;a&#x27; AND b.lastName=&#x27;b&#x27;)  CREATE (a)-[:worksWith]-&gt;(b)&quot;));
300          resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH (a:worker)-[r:worksWith]-&gt;(b:worker) RETURN a,r&quot;);
301          assertNotNull(resultSet.getHeader());
302          header = resultSet.getHeader();
303          schemaNames = header.getSchemaNames();
304          assertNotNull(schemaNames);
305          assertEquals(2, schemaNames.size());
306          assertEquals(&quot;a&quot;, schemaNames.get(0));
307          assertEquals(&quot;r&quot;, schemaNames.get(1));
308          assertEquals(1, resultSet.size());
309          iterator = resultSet.iterator();
310          assertTrue(iterator.hasNext());
311          record = iterator.next();
312          assertFalse(iterator.hasNext());
313          assertEquals(Arrays.asList(&quot;a&quot;, &quot;r&quot;), record.keys());
314          assertEquals(Arrays.asList(expectedNode, expectedEdge), record.values());
315      }
316      @Test
317      public void testEscapedQuery() {
318          Map&lt;String, Object&gt; params1 = new HashMap&lt;String, Object&gt;();
319          params1.put(&quot;s1&quot;, &quot;S\&quot;&#x27;&quot;);
320          params1.put(&quot;s2&quot;, &quot;S&#x27;\&quot;&quot;);
321          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:escaped{s1:$s1,s2:$s2})&quot;, params1));
322          Map&lt;String, Object&gt; params2 = new HashMap&lt;String, Object&gt;();
323          params2.put(&quot;s1&quot;, &quot;S\&quot;&#x27;&quot;);
324          params2.put(&quot;s2&quot;, &quot;S&#x27;\&quot;&quot;);
325          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;MATCH (n) where n.s1=$s1 and n.s2=$s2 RETURN n&quot;, params2));
326          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;MATCH (n) where n.s1=&#x27;S\&quot;&#x27; RETURN n&quot;));
327      }
328      @Test
329      public void testArraySupport() {
330          Node expectedANode = new Node();
331          expectedANode.setId(0);
332          expectedANode.addLabel(&quot;person&quot;);
333          Property&lt;String&gt; aNameProperty = new Property&lt;&gt;(&quot;name&quot;, &quot;a&quot;);
334          Property&lt;Integer&gt; aAgeProperty = new Property&lt;&gt;(&quot;age&quot;, 32);
335          Property&lt;List&lt;Long&gt;&gt; aListProperty = new Property&lt;&gt;(&quot;array&quot;, Arrays.asList(0L, 1L, 2L));
336          expectedANode.addProperty(aNameProperty);
337          expectedANode.addProperty(aAgeProperty);
338          expectedANode.addProperty(aListProperty);
339          Node expectedBNode = new Node();
340          expectedBNode.setId(1);
341          expectedBNode.addLabel(&quot;person&quot;);
342          Property&lt;String&gt; bNameProperty = new Property&lt;&gt;(&quot;name&quot;, &quot;b&quot;);
343          Property&lt;Integer&gt; bAgeProperty = new Property&lt;&gt;(&quot;age&quot;, 30);
344          Property&lt;List&lt;Long&gt;&gt; bListProperty = new Property&lt;&gt;(&quot;array&quot;, Arrays.asList(3L, 4L, 5L));
345          expectedBNode.addProperty(bNameProperty);
346          expectedBNode.addProperty(bAgeProperty);
347          expectedBNode.addProperty(bListProperty);
348          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;a&#x27;,age:32,array:[0,1,2]})&quot;));
349          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;b&#x27;,age:30,array:[3,4,5]})&quot;));
350          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;WITH [0,1,2] as x return x&quot;);
351          assertNotNull(resultSet.getHeader());
352          Header header = resultSet.getHeader();
353          List&lt;String&gt; schemaNames = header.getSchemaNames();
354          assertNotNull(schemaNames);
355          assertEquals(1, schemaNames.size());
356          assertEquals(&quot;x&quot;, schemaNames.get(0));
357          assertEquals(1, resultSet.size());
358          Iterator&lt;Record&gt; iterator = resultSet.iterator();
359          assertTrue(iterator.hasNext());
360          Record record = iterator.next();
361          assertFalse(iterator.hasNext());
362          assertEquals(Arrays.asList(&quot;x&quot;), record.keys());
363          List&lt;Long&gt; x = record.getValue(&quot;x&quot;);
364          assertEquals(Arrays.asList(0L, 1L, 2L), x);
365          resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH(n) return collect(n) as x&quot;);
366          assertNotNull(resultSet.getHeader());
367          header = resultSet.getHeader();
368          schemaNames = header.getSchemaNames();
369          assertNotNull(schemaNames);
370          assertEquals(1, schemaNames.size());
371          assertEquals(&quot;x&quot;, schemaNames.get(0));
372          assertEquals(1, resultSet.size());
373          iterator = resultSet.iterator();
374          assertTrue(iterator.hasNext());
375          record = iterator.next();
376          assertFalse(iterator.hasNext());
377          assertEquals(Arrays.asList(&quot;x&quot;), record.keys());
378          x = record.getValue(&quot;x&quot;);
379          assertEquals(Arrays.asList(expectedANode, expectedBNode), x);
380          resultSet = client.graphQuery(&quot;social&quot;, &quot;unwind([0,1,2]) as x return x&quot;);
381          assertNotNull(resultSet.getHeader());
382          header = resultSet.getHeader();
383          schemaNames = header.getSchemaNames();
384          assertNotNull(schemaNames);
385          assertEquals(1, schemaNames.size());
386          assertEquals(&quot;x&quot;, schemaNames.get(0));
387          assertEquals(3, resultSet.size());
388          iterator = resultSet.iterator();
389          for (long i = 0; i &lt; 3; i++) {
390              assertTrue(iterator.hasNext());
391              record = iterator.next();
392              assertEquals(Arrays.asList(&quot;x&quot;), record.keys());
393              assertEquals(i, (long) record.getValue(&quot;x&quot;));
394          }
395      }
396      @Test
397      public void testPath() {
398          List&lt;Node&gt; nodes = new ArrayList&lt;&gt;(3);
399          for (int i = 0; i &lt; 3; i++) {
400              Node node = new Node();
401              node.setId(i);
402              node.addLabel(&quot;L1&quot;);
403              nodes.add(node);
404          }
405          List&lt;Edge&gt; edges = new ArrayList&lt;&gt;(2);
406          for (int i = 0; i &lt; 2; i++) {
407              Edge edge = new Edge();
408              edge.setId(i);
409              edge.setRelationshipType(&quot;R1&quot;);
410              edge.setSource(i);
411              edge.setDestination(i + 1);
412              edges.add(edge);
413          }
414          Set&lt;Path&gt; expectedPaths = new HashSet&lt;&gt;();
415          Path path01 = new PathBuilder(2).append(nodes.get(0)).append(edges.get(0)).append(nodes.get(1)).build();
416          Path path12 = new PathBuilder(2).append(nodes.get(1)).append(edges.get(1)).append(nodes.get(2)).build();
417          Path path02 = new PathBuilder(3).append(nodes.get(0)).append(edges.get(0)).append(nodes.get(1))
418                  .append(edges.get(1)).append(nodes.get(2)).build();
419          expectedPaths.add(path01);
420          expectedPaths.add(path12);
421          expectedPaths.add(path02);
422          client.graphQuery(&quot;social&quot;, &quot;CREATE (:L1)-[:R1]-&gt;(:L1)-[:R1]-&gt;(:L1)&quot;);
423          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH p = (:L1)-[:R1*]-&gt;(:L1) RETURN p&quot;);
424          assertEquals(expectedPaths.size(), resultSet.size());
425          Iterator&lt;Record&gt; iterator = resultSet.iterator();
426          for (int i = 0; i &lt; resultSet.size(); i++) {
427              Path p = iterator.next().getValue(&quot;p&quot;);
428              assertTrue(expectedPaths.contains(p));
429              expectedPaths.remove(p);
430          }
431      }
432      @Test
433      public void testNullGraphEntities() {
434          assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:L)-[:E]-&gt;(:L2)&quot;));
435          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;OPTIONAL MATCH (a:NONEXISTENT)-[e]-&gt;(b) RETURN a, e, b&quot;);
436          assertEquals(1, resultSet.size());
437          Iterator&lt;Record&gt; iterator = resultSet.iterator();
438          assertTrue(iterator.hasNext());
439          Record record = iterator.next();
440          assertFalse(iterator.hasNext());
441          assertEquals(Arrays.asList(null, null, null), record.values());
442          resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH (a) OPTIONAL MATCH (a)-[e]-&gt;(b) RETURN a, e, b ORDER BY ID(a)&quot;);
443          assertEquals(2, resultSet.size());
444          iterator = resultSet.iterator();
445          record = iterator.next();
446          assertEquals(3, record.size());
447          assertNotNull(record.getValue(0));
448          assertNotNull(record.getValue(1));
449          assertNotNull(record.getValue(2));
450          record = iterator.next();
451          assertEquals(3, record.size());
452          assertNotNull(record.getValue(0));
453          assertNull(record.getValue(1));
454          assertNull(record.getValue(2));
455          resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH (a) OPTIONAL MATCH p = (a)-[e]-&gt;(b) RETURN p&quot;);
456          assertEquals(2, resultSet.size());
457          iterator = resultSet.iterator();
458          record = iterator.next();
459          assertEquals(1, record.size());
460          assertNotNull(record.getValue(0));
461          record = iterator.next();
462          assertEquals(1, record.size());
463          assertNull(record.getValue(0));
464      }
465      @Test
466      public void test64bitnumber() {
467          long value = 1L &lt;&lt; 40;
468          Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();
469          params.put(&quot;val&quot;, value);
470          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;CREATE (n {val:$val}) RETURN n.val&quot;, params);
471          assertEquals(1, resultSet.size());
472          Record r = resultSet.iterator().next();
473          assertEquals(Long.valueOf(value), r.getValue(0));
474      }
475      @Test
476      public void testCachedExecution() {
477          client.graphQuery(&quot;social&quot;, &quot;CREATE (:N {val:1}), (:N {val:2})&quot;);
478          Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();
479          params.put(&quot;val&quot;, 1L);
480          ResultSet resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH (n:N {val:$val}) RETURN n.val&quot;, params);
481          assertEquals(1, resultSet.size());
482          Record r = resultSet.iterator().next();
483          assertEquals(params.get(&quot;val&quot;), r.getValue(0));
484          assertFalse(resultSet.getStatistics().cachedExecution());
485          for (int i = 0; i &lt; 64; i++) {
486              resultSet = client.graphQuery(&quot;social&quot;, &quot;MATCH (n:N {val:$val}) RETURN n.val&quot;, params);
487          }
488          assertEquals(1, resultSet.size());
489          r = resultSet.iterator().next();
490          assertEquals(params.get(&quot;val&quot;), r.getValue(0));
491          assertTrue(resultSet.getStatistics().cachedExecution());
492      }
493      @Test
494      public void testMapDataType() {
495          Map&lt;String, Object&gt; expected = new HashMap&lt;&gt;();
496          expected.put(&quot;a&quot;, (long) 1);
497          expected.put(&quot;b&quot;, &quot;str&quot;);
498          expected.put(&quot;c&quot;, null);
499          List&lt;Object&gt; d = new ArrayList&lt;&gt;();
500          d.add((long) 1);
501          d.add((long) 2);
502          d.add((long) 3);
503          expected.put(&quot;d&quot;, d);
504          expected.put(&quot;e&quot;, true);
505          Map&lt;String, Object&gt; f = new HashMap&lt;&gt;();
506          f.put(&quot;x&quot;, (long) 1);
507          f.put(&quot;y&quot;, (long) 2);
508          expected.put(&quot;f&quot;, f);
509          ResultSet res = client.graphQuery(&quot;social&quot;, &quot;RETURN {a:1, b:&#x27;str&#x27;, c:NULL, d:[1,2,3], e:True, f:{x:1, y:2}}&quot;);
510          assertEquals(1, res.size());
511          Record r = res.iterator().next();
512          Map&lt;String, Object&gt; actual = r.getValue(0);
513          assertEquals(expected, actual);
514      }
515      @Test
516      public void testGeoPointLatLon() {
517          ResultSet rs = client.graphQuery(&quot;social&quot;, &quot;CREATE (:restaurant&quot;
518                  + &quot; {location: point({latitude:30.27822306, longitude:-97.75134723})})&quot;);
519          assertEquals(1, rs.getStatistics().nodesCreated());
520          assertEquals(1, rs.getStatistics().propertiesSet());
521          assertTestGeoPoint();
522      }
523      @Test
524      public void testGeoPointLonLat() {
525          ResultSet rs = client.graphQuery(&quot;social&quot;, &quot;CREATE (:restaurant&quot;
526                  + &quot; {location: point({longitude:-97.75134723, latitude:30.27822306})})&quot;);
527          assertEquals(1, rs.getStatistics().nodesCreated());
528          assertEquals(1, rs.getStatistics().propertiesSet());
529          assertTestGeoPoint();
530      }
531      private void assertTestGeoPoint() {
532          ResultSet results = client.graphQuery(&quot;social&quot;, &quot;MATCH (restaurant) RETURN restaurant&quot;);
533          assertEquals(1, results.size());
534          Record record = results.iterator().next();
535          assertEquals(1, record.size());
536          assertEquals(Collections.singletonList(&quot;restaurant&quot;), record.keys());
537          Node node = record.getValue(0);
538          Property&lt;?&gt; property = node.getProperty(&quot;location&quot;);
539          assertEquals(new Point(30.27822306, -97.75134723), property.getValue());
540      }
541      @Test
542      public void timeoutArgument() {
543          ResultSet rs = client.graphQuery(&quot;social&quot;, &quot;UNWIND range(0,100) AS x WITH x AS x WHERE x = 100 RETURN x&quot;, 1L);
544          assertEquals(1, rs.size());
545          Record r = rs.iterator().next();
546          assertEquals(Long.valueOf(100), r.getValue(0));
547      }
548      @Test
549      public void testCachedExecutionReadOnly() {
550          client.graphQuery(&quot;social&quot;, &quot;CREATE (:N {val:1}), (:N {val:2})&quot;);
551          Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();
552          params.put(&quot;val&quot;, 1L);
553          ResultSet resultSet =   client.graphReadonlyQuery(&quot;social&quot;, &quot;MATCH (n:N {val:$val}) RETURN n.val&quot;, params);
554          assertEquals(1, resultSet.size());
555          Record r = resultSet.iterator().next();
<span onclick='openModal()' class='match'>556          assertEquals(params.get(&quot;val&quot;), r.getValue(0));
557          assertFalse(resultSet.getStatistics().cachedExecution());
</span>558          for (int i = 0; i &lt; 64; i++) {
559              resultSet =   client.graphReadonlyQuery(&quot;social&quot;, &quot;MATCH (n:N {val:$val}) RETURN n.val&quot;, params);
560          }
561          assertEquals(1, resultSet.size());
562          r = resultSet.iterator().next();
563          assertEquals(params.get(&quot;val&quot;), r.getValue(0));
564          assertTrue(resultSet.getStatistics().cachedExecution());
565      }
566      @Test
567      public void testSimpleReadOnly() {
568          client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;filipe&#x27;,age:30})&quot;);
569          ResultSet rsRo = client.graphReadonlyQuery(&quot;social&quot;, &quot;MATCH (a:person) WHERE (a.name = &#x27;filipe&#x27;) RETURN a.age&quot;);
570          assertEquals(1, rsRo.size());
571          Record r = rsRo.iterator().next();
572          assertEquals(Long.valueOf(30), r.getValue(0));
573      }
574    @Test
575    public void profile() {
576      assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
577      assertNotNull(client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
578      List&lt;String&gt; profile = client.graphProfile(&quot;social&quot;,
579          &quot;MATCH (a:person), (b:person) WHERE (a.name = &#x27;roi&#x27; AND b.name=&#x27;amit&#x27;)  CREATE (a)-[:knows]-&gt;(b)&quot;);
580      assertFalse(profile.isEmpty());
581      profile.forEach(Assert::assertNotNull);
582    }
583    @Test
584    public void explain() {
585      assertNotNull(client.graphProfile(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
586      assertNotNull(client.graphProfile(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
587      List&lt;String&gt; explain = client.graphExplain(&quot;social&quot;,
588          &quot;MATCH (a:person), (b:person) WHERE (a.name = &#x27;roi&#x27; AND b.name=&#x27;amit&#x27;)  CREATE (a)-[:knows]-&gt;(b)&quot;);
589      assertFalse(explain.isEmpty());
590      explain.forEach(Assert::assertNotNull);
591    }
592    @Test
593    public void slowlog() {
594      assertNotNull(client.graphProfile(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;roi&#x27;,age:32})&quot;));
595      assertNotNull(client.graphProfile(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;amit&#x27;,age:30})&quot;));
596      List&lt;List&lt;Object&gt;&gt; slowlogs = client.graphSlowlog(&quot;social&quot;);
597      assertEquals(2, slowlogs.size());
598      slowlogs.forEach(sl -&gt; assertFalse(sl.isEmpty()));
599      slowlogs.forEach(sl -&gt; sl.forEach(Assert::assertNotNull));
600    }
601    @Test
602    public void list() {
603      assertEquals(Collections.emptyList(), client.graphList());
604      client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;filipe&#x27;,age:30})&quot;);
605      assertEquals(Collections.singletonList(&quot;social&quot;), client.graphList());
606    }
607    @Test
608    public void config() {
609      client.graphQuery(&quot;social&quot;, &quot;CREATE (:person{name:&#x27;filipe&#x27;,age:30})&quot;);
610      final String name = &quot;RESULTSET_SIZE&quot;;
611      final Object existingValue = client.graphConfigGet(name).get(name);
612      assertEquals(&quot;OK&quot;, client.graphConfigSet(name, 250L));
613      assertEquals(Collections.singletonMap(name, 250L), client.graphConfigGet(name));
614      client.graphConfigSet(name, existingValue != null ? existingValue : -1);
615    }
616  }
</code></pre>
        </div>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-GeoCommandsTestBase.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.unified;
2  import static org.junit.Assert.*;
3  import static redis.clients.jedis.util.AssertUtil.assertByteArrayListEquals;
4  import java.util.ArrayList;
5  import java.util.HashMap;
6  import java.util.List;
7  import java.util.Map;
8  import org.junit.Test;
9  import redis.clients.jedis.GeoCoordinate;
10  import redis.clients.jedis.args.GeoUnit;
11  import redis.clients.jedis.params.GeoSearchParam;
12  import redis.clients.jedis.resps.GeoRadiusResponse;
13  import redis.clients.jedis.params.GeoAddParams;
14  import redis.clients.jedis.params.GeoRadiusParam;
15  import redis.clients.jedis.params.GeoRadiusStoreParam;
16  import redis.clients.jedis.util.SafeEncoder;
17  public abstract class GeoCommandsTestBase extends UnifiedJedisCommandsTestBase {
18    protected final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
19    protected final byte[] bA = { 0x0A };
20    protected final byte[] bB = { 0x0B };
21    protected final byte[] bC = { 0x0C };
22    protected final byte[] bD = { 0x0D };
23    protected final byte[] bNotexist = { 0x0F };
24    private static final double EPSILON = 1e-5;
25    @Test
26    public void geoadd() {
27      assertEquals(1, jedis.geoadd(&quot;foo&quot;, 1, 2, &quot;a&quot;));
28      assertEquals(0, jedis.geoadd(&quot;foo&quot;, 2, 3, &quot;a&quot;));
29      Map&lt;String, GeoCoordinate&gt; coordinateMap = new HashMap&lt;&gt;();
30      coordinateMap.put(&quot;a&quot;, new GeoCoordinate(3, 4));
31      coordinateMap.put(&quot;b&quot;, new GeoCoordinate(2, 3));
32      coordinateMap.put(&quot;c&quot;, new GeoCoordinate(3.314, 2.3241));
33      assertEquals(2, jedis.geoadd(&quot;foo&quot;, coordinateMap));
34      assertEquals(1, jedis.geoadd(bfoo, 1, 2, bA));
35      assertEquals(0, jedis.geoadd(bfoo, 2, 3, bA));
36      Map&lt;byte[], GeoCoordinate&gt; bcoordinateMap = new HashMap&lt;&gt;();
37      bcoordinateMap.put(bA, new GeoCoordinate(3, 4));
38      bcoordinateMap.put(bB, new GeoCoordinate(2, 3));
39      bcoordinateMap.put(bC, new GeoCoordinate(3.314, 2.3241));
40      assertEquals(2, jedis.geoadd(bfoo, bcoordinateMap));
41    }
42    @Test
43    public void geoaddWithParams() {
44      assertEquals(1, jedis.geoadd(&quot;foo&quot;, 1, 2, &quot;a&quot;));
45      Map&lt;String, GeoCoordinate&gt; coordinateMap = new HashMap&lt;&gt;();
46      coordinateMap.put(&quot;a&quot;, new GeoCoordinate(3, 4));
47      assertEquals(0, jedis.geoadd(&quot;foo&quot;, GeoAddParams.geoAddParams().nx(), coordinateMap));
48      assertEquals(1, jedis.geoadd(&quot;foo&quot;, GeoAddParams.geoAddParams().xx().ch(), coordinateMap));
49      coordinateMap.clear();
50      coordinateMap.put(&quot;b&quot;, new GeoCoordinate(6, 7));
51      assertEquals(0, jedis.geoadd(&quot;foo&quot;, GeoAddParams.geoAddParams().xx(), coordinateMap));
52      assertEquals(1, jedis.geoadd(&quot;foo&quot;, GeoAddParams.geoAddParams().nx(), coordinateMap));
53      assertEquals(1, jedis.geoadd(bfoo, 1, 2, bA));
54      Map&lt;byte[], GeoCoordinate&gt; bcoordinateMap = new HashMap&lt;&gt;();
55      bcoordinateMap.put(bA, new GeoCoordinate(3, 4));
56      assertEquals(0, jedis.geoadd(bfoo, GeoAddParams.geoAddParams().nx(), bcoordinateMap));
57      assertEquals(1, jedis.geoadd(bfoo, GeoAddParams.geoAddParams().xx().ch(), bcoordinateMap));
58      bcoordinateMap.clear();
59      bcoordinateMap.put(bB, new GeoCoordinate(6, 7));
60      assertEquals(0, jedis.geoadd(bfoo, GeoAddParams.geoAddParams().xx(), bcoordinateMap));
61      assertEquals(1, jedis.geoadd(bfoo, GeoAddParams.geoAddParams().nx(), bcoordinateMap));
62    }
63    @Test
64    public void geodist() {
65      prepareGeoData();
66      Double dist = jedis.geodist(&quot;foo&quot;, &quot;a&quot;, &quot;b&quot;);
67      assertEquals(157149, dist.intValue());
68      dist = jedis.geodist(&quot;foo&quot;, &quot;a&quot;, &quot;b&quot;, GeoUnit.KM);
69      assertEquals(157, dist.intValue());
70      dist = jedis.geodist(&quot;foo&quot;, &quot;a&quot;, &quot;b&quot;, GeoUnit.MI);
71      assertEquals(97, dist.intValue());
72      dist = jedis.geodist(&quot;foo&quot;, &quot;a&quot;, &quot;b&quot;, GeoUnit.FT);
73      assertEquals(515583, dist.intValue());
74      dist = jedis.geodist(bfoo, bA, bB);
75      assertEquals(157149, dist.intValue());
76      dist = jedis.geodist(bfoo, bA, bB, GeoUnit.KM);
77      assertEquals(157, dist.intValue());
78      dist = jedis.geodist(bfoo, bA, bB, GeoUnit.MI);
79      assertEquals(97, dist.intValue());
80      dist = jedis.geodist(bfoo, bA, bB, GeoUnit.FT);
81      assertEquals(515583, dist.intValue());
82    }
83    @Test
84    public void geohash() {
85      prepareGeoData();
86      List&lt;String&gt; hashes = jedis.geohash(&quot;foo&quot;, &quot;a&quot;, &quot;b&quot;, &quot;notexist&quot;);
87      assertEquals(3, hashes.size());
88      assertEquals(&quot;s0dnu20t9j0&quot;, hashes.get(0));
89      assertEquals(&quot;s093jd0k720&quot;, hashes.get(1));
90      assertNull(hashes.get(2));
91      List&lt;byte[]&gt; bhashes = jedis.geohash(bfoo, bA, bB, bNotexist);
92      assertEquals(3, bhashes.size());
93      assertArrayEquals(SafeEncoder.encode(&quot;s0dnu20t9j0&quot;), bhashes.get(0));
<span onclick='openModal()' class='match'>94      assertArrayEquals(SafeEncoder.encode(&quot;s093jd0k720&quot;), bhashes.get(1));
95      assertNull(bhashes.get(2));
</span>96    }
97    @Test
98    public void geopos() {
99      prepareGeoData();
100      List&lt;GeoCoordinate&gt; coordinates = jedis.geopos(&quot;foo&quot;, &quot;a&quot;, &quot;b&quot;, &quot;notexist&quot;);
101      assertEquals(3, coordinates.size());
102      assertEquals(3.0, coordinates.get(0).getLongitude(), EPSILON);
103      assertEquals(4.0, coordinates.get(0).getLatitude(), EPSILON);
104      assertEquals(2.0, coordinates.get(1).getLongitude(), EPSILON);
105      assertEquals(3.0, coordinates.get(1).getLatitude(), EPSILON);
106      assertNull(coordinates.get(2));
107      List&lt;GeoCoordinate&gt; bcoordinates = jedis.geopos(bfoo, bA, bB, bNotexist);
108      assertEquals(3, bcoordinates.size());
109      assertEquals(3.0, bcoordinates.get(0).getLongitude(), EPSILON);
110      assertEquals(4.0, bcoordinates.get(0).getLatitude(), EPSILON);
111      assertEquals(2.0, bcoordinates.get(1).getLongitude(), EPSILON);
112      assertEquals(3.0, bcoordinates.get(1).getLatitude(), EPSILON);
113      assertNull(bcoordinates.get(2));
114    }
115    @Test
116    public void georadius() {
117      Map&lt;String, GeoCoordinate&gt; coordinateMap = new HashMap&lt;&gt;();
118      coordinateMap.put(&quot;Palermo&quot;, new GeoCoordinate(13.361389, 38.115556));
119      coordinateMap.put(&quot;Catania&quot;, new GeoCoordinate(15.087269, 37.502669));
120      jedis.geoadd(&quot;Sicily&quot;, coordinateMap);
121      List&lt;GeoRadiusResponse&gt; members = jedis.georadius(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM);
122      assertEquals(2, members.size());
123      members = jedis.georadius(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
124          .sortDescending());
125      assertEquals(2, members.size());
126      assertEquals(&quot;Catania&quot;, members.get(1).getMemberByString());
127      assertEquals(&quot;Palermo&quot;, members.get(0).getMemberByString());
128      members = jedis.georadius(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
129          .sortAscending().count(1));
130      assertEquals(1, members.size());
131      members = jedis.georadius(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
132          .sortAscending().count(1).withCoord().withDist().withHash());
133      assertEquals(1, members.size());
134      GeoRadiusResponse response = members.get(0);
135      assertEquals(56.4413, response.getDistance(), EPSILON);
136      assertEquals(15.087269, response.getCoordinate().getLongitude(), EPSILON);
137      assertEquals(37.502669, response.getCoordinate().getLatitude(), EPSILON);
138      assertEquals(3479447370796909L, response.getRawScore());
139      members = jedis.georadius(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
140          .sortAscending().count(1).withHash());
141      assertEquals(1, members.size());
142      response = members.get(0);
143      assertEquals(3479447370796909L, response.getRawScore());
144      members = jedis.georadius(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
145          .sortDescending().count(1, true));
146      assertEquals(1, members.size());
147      response = members.get(0);
148      assertTrue(coordinateMap.containsKey(response.getMemberByString()));
149    }
150    @Test
151    public void georadiusStore() {
152      Map&lt;String, GeoCoordinate&gt; coordinateMap = new HashMap&lt;&gt;();
153      coordinateMap.put(&quot;Palermo&quot;, new GeoCoordinate(13.361389, 38.115556));
154      coordinateMap.put(&quot;Catania&quot;, new GeoCoordinate(15.087269, 37.502669));
155      jedis.geoadd(&quot;Sicily&quot;, coordinateMap);
156      long size = jedis.georadiusStore(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM,
157        GeoRadiusParam.geoRadiusParam(),
158        GeoRadiusStoreParam.geoRadiusStoreParam().store(&quot;SicilyStore&quot;));
159      assertEquals(2, size);
160      List&lt;String&gt; expected = new ArrayList&lt;&gt;();
161      expected.add(&quot;Palermo&quot;);
162      expected.add(&quot;Catania&quot;);
163      assertEquals(expected, jedis.zrange(&quot;SicilyStore&quot;, 0, -1));
164    }
165    @Test
166    public void georadiusReadonly() {
167      Map&lt;String, GeoCoordinate&gt; coordinateMap = new HashMap&lt;&gt;();
168      coordinateMap.put(&quot;Palermo&quot;, new GeoCoordinate(13.361389, 38.115556));
169      coordinateMap.put(&quot;Catania&quot;, new GeoCoordinate(15.087269, 37.502669));
170      jedis.geoadd(&quot;Sicily&quot;, coordinateMap);
171      List&lt;GeoRadiusResponse&gt; members = jedis.georadiusReadonly(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM);
172      assertEquals(2, members.size());
173      members = jedis.georadiusReadonly(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM,
174          GeoRadiusParam.geoRadiusParam().sortAscending());
175      assertEquals(2, members.size());
176      assertEquals(&quot;Catania&quot;, members.get(0).getMemberByString());
177      assertEquals(&quot;Palermo&quot;, members.get(1).getMemberByString());
178      members = jedis.georadiusReadonly(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM,
179          GeoRadiusParam.geoRadiusParam().sortAscending().count(1));
180      assertEquals(1, members.size());
181      members = jedis.georadiusReadonly(&quot;Sicily&quot;, 15, 37, 200, GeoUnit.KM,
182          GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
183      assertEquals(1, members.size());
184      GeoRadiusResponse response = members.get(0);
185      assertEquals(56.4413, response.getDistance(), EPSILON);
186      assertEquals(15.087269, response.getCoordinate().getLongitude(), EPSILON);
187      assertEquals(37.502669, response.getCoordinate().getLatitude(), EPSILON);
188    }
189    @Test
190    public void georadiusBinary() {
191      Map&lt;byte[], GeoCoordinate&gt; bcoordinateMap = new HashMap&lt;&gt;();
192      bcoordinateMap.put(bA, new GeoCoordinate(13.361389, 38.115556));
193      bcoordinateMap.put(bB, new GeoCoordinate(15.087269, 37.502669));
194      jedis.geoadd(bfoo, bcoordinateMap);
195      List&lt;GeoRadiusResponse&gt; members = jedis.georadius(bfoo, 15, 37, 200, GeoUnit.KM);
196      assertEquals(2, members.size());
197      members = jedis.georadius(bfoo, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
198          .sortAscending());
199      assertEquals(2, members.size());
200      assertArrayEquals(bB, members.get(0).getMember());
201      assertArrayEquals(bA, members.get(1).getMember());
202      members = jedis.georadius(bfoo, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
203          .sortAscending().count(1));
204      assertEquals(1, members.size());
205      members = jedis.georadius(bfoo, 15, 37, 200, GeoUnit.KM, GeoRadiusParam.geoRadiusParam()
206          .sortAscending().count(1).withCoord().withDist());
207      assertEquals(1, members.size());
208      GeoRadiusResponse response = members.get(0);
209      assertEquals(56.4413, response.getDistance(), EPSILON);
210      assertEquals(15.087269, response.getCoordinate().getLongitude(), EPSILON);
211      assertEquals(37.502669, response.getCoordinate().getLatitude(), EPSILON);
212    }
213    @Test
214    public void georadiusStoreBinary() {
215      Map&lt;byte[], GeoCoordinate&gt; bcoordinateMap = new HashMap&lt;&gt;();
216      bcoordinateMap.put(bA, new GeoCoordinate(13.361389, 38.115556));
217      bcoordinateMap.put(bB, new GeoCoordinate(15.087269, 37.502669));
218      jedis.geoadd(bfoo, bcoordinateMap);
219      long size = jedis.georadiusStore(bfoo, 15, 37, 200, GeoUnit.KM,
220        GeoRadiusParam.geoRadiusParam(),
221        GeoRadiusStoreParam.geoRadiusStoreParam().store(&quot;SicilyStore&quot;));
222      assertEquals(2, size);
223      List&lt;byte[]&gt; bexpected = new ArrayList&lt;&gt;();
224      bexpected.add(bA);
225      bexpected.add(bB);
226      assertByteArrayListEquals(bexpected, jedis.zrange(&quot;SicilyStore&quot;.getBytes(), 0, -1));
227    }
228    @Test
229    public void georadiusReadonlyBinary() {
230      Map&lt;byte[], GeoCoordinate&gt; bcoordinateMap = new HashMap&lt;&gt;();
231      bcoordinateMap.put(bA, new GeoCoordinate(13.361389, 38.115556));
232      bcoordinateMap.put(bB, new GeoCoordinate(15.087269, 37.502669));
233      jedis.geoadd(bfoo, bcoordinateMap);
234      List&lt;GeoRadiusResponse&gt; members = jedis.georadiusReadonly(bfoo, 15, 37, 200, GeoUnit.KM);
235      assertEquals(2, members.size());
236      members = jedis.georadiusReadonly(bfoo, 15, 37, 200, GeoUnit.KM,
237          GeoRadiusParam.geoRadiusParam().sortAscending());
238      assertEquals(2, members.size());
239      assertArrayEquals(bB, members.get(0).getMember());
240      assertArrayEquals(bA, members.get(1).getMember());
241      members = jedis.georadiusReadonly(bfoo, 15, 37, 200, GeoUnit.KM,
242          GeoRadiusParam.geoRadiusParam().sortAscending().count(1));
243      assertEquals(1, members.size());
244      members = jedis.georadiusReadonly(bfoo, 15, 37, 200, GeoUnit.KM,
245          GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
246      assertEquals(1, members.size());
247      GeoRadiusResponse response = members.get(0);
248      assertEquals(56.4413, response.getDistance(), EPSILON);
249      assertEquals(15.087269, response.getCoordinate().getLongitude(), EPSILON);
250      assertEquals(37.502669, response.getCoordinate().getLatitude(), EPSILON);
251    }
252    @Test
253    public void georadiusByMember() {
254      jedis.geoadd(&quot;Sicily&quot;, 13.583333, 37.316667, &quot;Agrigento&quot;);
255      jedis.geoadd(&quot;Sicily&quot;, 13.361389, 38.115556, &quot;Palermo&quot;);
256      jedis.geoadd(&quot;Sicily&quot;, 15.087269, 37.502669, &quot;Catania&quot;);
257      List&lt;GeoRadiusResponse&gt; members = jedis.georadiusByMember(&quot;Sicily&quot;, &quot;Agrigento&quot;, 100,
258        GeoUnit.KM);
259      assertEquals(2, members.size());
260      members = jedis.georadiusByMember(&quot;Sicily&quot;, &quot;Agrigento&quot;, 100, GeoUnit.KM, GeoRadiusParam
261          .geoRadiusParam().sortAscending());
262      assertEquals(2, members.size());
263      assertEquals(&quot;Agrigento&quot;, members.get(0).getMemberByString());
264      assertEquals(&quot;Palermo&quot;, members.get(1).getMemberByString());
265      members = jedis.georadiusByMember(&quot;Sicily&quot;, &quot;Agrigento&quot;, 100, GeoUnit.KM, GeoRadiusParam
266          .geoRadiusParam().sortAscending().count(1).withCoord().withDist());
267      assertEquals(1, members.size());
268      GeoRadiusResponse member = members.get(0);
269      assertEquals(&quot;Agrigento&quot;, member.getMemberByString());
270      assertEquals(0, member.getDistance(), EPSILON);
271      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
272      assertEquals(37.316667, member.getCoordinate().getLatitude(), EPSILON);
273    }
274    @Test
275    public void georadiusByMemberStore() {
276      jedis.geoadd(&quot;Sicily&quot;, 13.583333, 37.316667, &quot;Agrigento&quot;);
277      jedis.geoadd(&quot;Sicily&quot;, 13.361389, 38.115556, &quot;Palermo&quot;);
278      jedis.geoadd(&quot;Sicily&quot;, 15.087269, 37.502669, &quot;Catania&quot;);
279      long size = jedis.georadiusByMemberStore(&quot;Sicily&quot;, &quot;Agrigento&quot;, 100, GeoUnit.KM,
280        GeoRadiusParam.geoRadiusParam(),
281        GeoRadiusStoreParam.geoRadiusStoreParam().store(&quot;SicilyStore&quot;));
282      assertEquals(2, size);
283      List&lt;String&gt; expected = new ArrayList&lt;&gt;();
284      expected.add(&quot;Agrigento&quot;);
285      expected.add(&quot;Palermo&quot;);
286      assertEquals(expected, jedis.zrange(&quot;SicilyStore&quot;, 0, -1));
287    }
288    @Test
289    public void georadiusByMemberReadonly() {
290      jedis.geoadd(&quot;Sicily&quot;, 13.583333, 37.316667, &quot;Agrigento&quot;);
291      jedis.geoadd(&quot;Sicily&quot;, 13.361389, 38.115556, &quot;Palermo&quot;);
292      jedis.geoadd(&quot;Sicily&quot;, 15.087269, 37.502669, &quot;Catania&quot;);
293      List&lt;GeoRadiusResponse&gt; members = jedis.georadiusByMemberReadonly(&quot;Sicily&quot;, &quot;Agrigento&quot;, 100,
294        GeoUnit.KM);
295      assertEquals(2, members.size());
296      members = jedis.georadiusByMemberReadonly(&quot;Sicily&quot;, &quot;Agrigento&quot;, 100, GeoUnit.KM,
297        GeoRadiusParam.geoRadiusParam().sortAscending());
298      assertEquals(2, members.size());
299      assertEquals(&quot;Agrigento&quot;, members.get(0).getMemberByString());
300      assertEquals(&quot;Palermo&quot;, members.get(1).getMemberByString());
301      members = jedis.georadiusByMemberReadonly(&quot;Sicily&quot;, &quot;Agrigento&quot;, 100, GeoUnit.KM,
302        GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
303      assertEquals(1, members.size());
304      GeoRadiusResponse member = members.get(0);
305      assertEquals(&quot;Agrigento&quot;, member.getMemberByString());
306      assertEquals(0, member.getDistance(), EPSILON);
307      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
308      assertEquals(37.316667, member.getCoordinate().getLatitude(), EPSILON);
309    }
310    @Test
311    public void georadiusByMemberBinary() {
312      jedis.geoadd(bfoo, 13.583333, 37.316667, bA);
313      jedis.geoadd(bfoo, 13.361389, 38.115556, bB);
314      jedis.geoadd(bfoo, 15.087269, 37.502669, bC);
315      List&lt;GeoRadiusResponse&gt; members = jedis.georadiusByMember(bfoo, bA, 100, GeoUnit.KM);
316      assertEquals(2, members.size());
317      members = jedis.georadiusByMember(bfoo, bA, 100, GeoUnit.KM,
318          GeoRadiusParam.geoRadiusParam().sortAscending());
319      assertEquals(2, members.size());
320      assertArrayEquals(bA, members.get(0).getMember());
321      assertArrayEquals(bB, members.get(1).getMember());
322      members = jedis.georadiusByMember(bfoo, bA, 100, GeoUnit.KM,
323          GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
324      assertEquals(1, members.size());
325      GeoRadiusResponse member = members.get(0);
326      assertArrayEquals(bA, member.getMember());
327      assertEquals(0, member.getDistance(), EPSILON);
328      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
329      assertEquals(37.316667, member.getCoordinate().getLatitude(), EPSILON);
330    }
331    @Test
332    public void georadiusByMemberStoreBinary() {
333      jedis.geoadd(bfoo, 13.583333, 37.316667, bA);
334      jedis.geoadd(bfoo, 13.361389, 38.115556, bB);
335      jedis.geoadd(bfoo, 15.087269, 37.502669, bC);
336      assertEquals(2, jedis.georadiusByMemberStore(bfoo, bA, 100, GeoUnit.KM,
337          GeoRadiusParam.geoRadiusParam(),
338          GeoRadiusStoreParam.geoRadiusStoreParam().store(&quot;SicilyStore&quot;)));
339      List&lt;byte[]&gt; bexpected = new ArrayList&lt;&gt;();
340      bexpected.add(bA);
341      bexpected.add(bB);
342      assertByteArrayListEquals(bexpected, jedis.zrange(&quot;SicilyStore&quot;.getBytes(), 0, -1));
343    }
344    @Test
345    public void georadiusByMemberReadonlyBinary() {
346      jedis.geoadd(bfoo, 13.583333, 37.316667, bA);
347      jedis.geoadd(bfoo, 13.361389, 38.115556, bB);
348      jedis.geoadd(bfoo, 15.087269, 37.502669, bC);
349      List&lt;GeoRadiusResponse&gt; members = jedis.georadiusByMemberReadonly(bfoo, bA, 100, GeoUnit.KM);
350      assertEquals(2, members.size());
351      members = jedis.georadiusByMemberReadonly(bfoo, bA, 100, GeoUnit.KM,
352          GeoRadiusParam.geoRadiusParam().sortAscending());
353      assertEquals(2, members.size());
354      assertArrayEquals(bA, members.get(0).getMember());
355      assertArrayEquals(bB, members.get(1).getMember());
356      members = jedis.georadiusByMemberReadonly(bfoo, bA, 100, GeoUnit.KM,
357          GeoRadiusParam.geoRadiusParam().sortAscending().count(1).withCoord().withDist());
358      assertEquals(1, members.size());
359      GeoRadiusResponse member = members.get(0);
360      assertArrayEquals(bA, member.getMember());
361      assertEquals(0, member.getDistance(), EPSILON);
362      assertEquals(13.583333, member.getCoordinate().getLongitude(), EPSILON);
363      assertEquals(37.316667, member.getCoordinate().getLatitude(), EPSILON);
364    }
365    @Test
366    public void geosearch() {
367      jedis.geoadd(&quot;barcelona&quot;, 2.1909389952632d, 41.433791470673d, &quot;place1&quot;);
368      jedis.geoadd(&quot;barcelona&quot;, 2.1873744593677d, 41.406342043777d, &quot;place2&quot;);
369      jedis.geoadd(&quot;barcelona&quot;, 2.583333d, 41.316667d, &quot;place3&quot;);
370      List&lt;GeoRadiusResponse&gt; members = jedis.geosearch(&quot;barcelona&quot;,
371              new GeoCoordinate(2.191d,41.433d), 1000, GeoUnit.M);
372      assertEquals(1, members.size());
373      assertEquals(&quot;place1&quot;, members.get(0).getMemberByString());
374      members = jedis.geosearch(&quot;barcelona&quot;, new GeoSearchParam().byRadius(3000, GeoUnit.M)
375              .fromLonLat(2.191d,41.433d).desc());
376      assertEquals(2, members.size());
377      assertEquals(&quot;place2&quot;, members.get(0).getMemberByString());
378      members = jedis.geosearch(&quot;barcelona&quot;,&quot;place3&quot;, 100, GeoUnit.KM);
379      assertEquals(3, members.size());
380      members = jedis.geosearch(&quot;barcelona&quot;, new GeoSearchParam().fromMember(&quot;place1&quot;)
381              .byRadius(100, GeoUnit.KM).withDist().withCoord().withHash().count(2));
382      assertEquals(2, members.size());
383      assertEquals(&quot;place1&quot;, members.get(0).getMemberByString());
384      GeoRadiusResponse res2 = members.get(1);
385      assertEquals(&quot;place2&quot;, res2.getMemberByString());
386      assertEquals(3.0674157, res2.getDistance(), 5);
387      assertEquals(new GeoCoordinate(2.187376320362091, 41.40634178640635), res2.getCoordinate());
388      members = jedis.geosearch(&quot;barcelona&quot;,&quot;place3&quot;, 100, 100, GeoUnit.KM);
389      assertEquals(3, members.size());
390      members = jedis.geosearch(&quot;barcelona&quot;, new GeoSearchParam().fromMember(&quot;place3&quot;)
391              .byBox(100, 100, GeoUnit.KM).asc().count(1, true));
392      assertEquals(1, members.size());
393      members = jedis.geosearch(&quot;barcelona&quot;, new GeoCoordinate(2.191, 41.433),
394              1, 1, GeoUnit.KM);
395      assertEquals(1, members.size());
396      members = jedis.geosearch(&quot;barcelona&quot;, new GeoSearchParam().byBox(1,1, GeoUnit.KM)
397              .fromLonLat(2.191, 41.433).withDist().withCoord());
398      assertEquals(1, members.size());
399      assertEquals(&quot;place1&quot;, members.get(0).getMemberByString());
400      assertEquals(0.0881, members.get(0).getDistance(), 10);
401      assertEquals(new GeoCoordinate(2.19093829393386841, 41.43379028184083523), members.get(0).getCoordinate());
402    }
403    @Test
404    public void geosearchNegative() {
405      try {
406        jedis.geosearch(&quot;barcelona&quot;, new GeoSearchParam()
407                .byRadius(3000, GeoUnit.M).byBox(300, 300, GeoUnit.M));
408        fail();
409      } catch (redis.clients.jedis.exceptions.JedisDataException ignored) { }
410      try {
411        jedis.geosearch(&quot;barcelona&quot;, new GeoSearchParam()
412                .fromMember(&quot;foobar&quot;));
413        fail();
414      } catch (java.lang.IllegalArgumentException ignored) { }
415      try {
416        jedis.geosearch(&quot;barcelona&quot;, new GeoSearchParam()
417                .fromMember(&quot;foobar&quot;).fromLonLat(10,10));
418        fail();
419      } catch (java.lang.IllegalArgumentException ignored) { }
420      try {
421        jedis.geosearch(&quot;barcelona&quot;, new GeoSearchParam()
422                .byRadius(10, GeoUnit.MI));
423        fail();
424      } catch (redis.clients.jedis.exceptions.JedisDataException ignored) { }
425    }
426    @Test
427    public void geosearchstore() {
428      jedis.geoadd(&quot;barcelona&quot;, 2.1909389952632d, 41.433791470673d, &quot;place1&quot;);
429      jedis.geoadd(&quot;barcelona&quot;, 2.1873744593677d, 41.406342043777d, &quot;place2&quot;);
430      jedis.geoadd(&quot;barcelona&quot;, 2.583333d, 41.316667d, &quot;place3&quot;);
431      long members = jedis.geosearchStore(&quot;tel-aviv&quot;, &quot;barcelona&quot;, new GeoCoordinate(2.191d,41.433d),
432              1000, GeoUnit.M);
433      assertEquals(1, members);
434      List&lt;String&gt; expected = new ArrayList&lt;&gt;();
435      expected.add(&quot;place1&quot;);
436      assertEquals(expected, jedis.zrange(&quot;tel-aviv&quot;, 0, -1));
437      members = jedis.geosearchStore(&quot;tel-aviv&quot;,&quot;barcelona&quot;, new GeoSearchParam()
438              .byRadius(3000, GeoUnit.M)
439              .fromLonLat(new GeoCoordinate(2.191d,41.433d)));
440      assertEquals(2, members);
441      assertEquals(2, members);
442      members = jedis.geosearchStore(&quot;tel-aviv&quot;, &quot;barcelona&quot;,&quot;place3&quot;, 100, GeoUnit.KM);
443      assertEquals(3, members);
444      members = jedis.geosearchStore(&quot;tel-aviv&quot;,&quot;barcelona&quot;,&quot;place3&quot;, 100, 100, GeoUnit.KM);
445      assertEquals(3, members);
446      members = jedis.geosearchStore(&quot;tel-aviv&quot;,&quot;barcelona&quot;, new GeoCoordinate(2.191, 41.433),
447              1, 1, GeoUnit.KM);
448      assertEquals(1, members);
449    }
450    @Test
451    public void geosearchstoreWithdist() {
452      jedis.geoadd(&quot;barcelona&quot;, 2.1909389952632d, 41.433791470673d, &quot;place1&quot;);
453      jedis.geoadd(&quot;barcelona&quot;, 2.1873744593677d, 41.406342043777d, &quot;place2&quot;);
454      long members = jedis.geosearchStoreStoreDist(&quot;tel-aviv&quot;,&quot;barcelona&quot;, new GeoSearchParam().byRadius(3000, GeoUnit.M)
455              .fromLonLat(2.191d,41.433d));
456      assertEquals(2, members);
457      assertEquals(88.05060698409301, jedis.zscore(&quot;tel-aviv&quot;, &quot;place1&quot;), 5);
458    }
459    private void prepareGeoData() {
460      Map&lt;String, GeoCoordinate&gt; coordinateMap = new HashMap&lt;&gt;();
461      coordinateMap.put(&quot;a&quot;, new GeoCoordinate(3, 4));
462      coordinateMap.put(&quot;b&quot;, new GeoCoordinate(2, 3));
463      coordinateMap.put(&quot;c&quot;, new GeoCoordinate(3.314, 2.3241));
464      assertEquals(3, jedis.geoadd(&quot;foo&quot;, coordinateMap));
465      Map&lt;byte[], GeoCoordinate&gt; bcoordinateMap = new HashMap&lt;&gt;();
466      bcoordinateMap.put(bA, new GeoCoordinate(3, 4));
467      bcoordinateMap.put(bB, new GeoCoordinate(2, 3));
468      bcoordinateMap.put(bC, new GeoCoordinate(3.314, 2.3241));
469      assertEquals(3, jedis.geoadd(bfoo, bcoordinateMap));
470    }
471  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-GraphAPITest.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-GeoCommandsTestBase.java</div>
                </div>
                <div class="column column_space"><pre><code>556          assertEquals(params.get(&quot;val&quot;), r.getValue(0));
557          assertFalse(resultSet.getStatistics().cachedExecution());
</pre></code></div>
                <div class="column column_space"><pre><code>94      assertArrayEquals(SafeEncoder.encode(&quot;s093jd0k720&quot;), bhashes.get(1));
95      assertNull(bhashes.get(2));
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    