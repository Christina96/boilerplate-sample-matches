
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 12.213740458015266%, Tokens: 10, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-Warps.java</h3>
            <pre><code>1  package com.earth2me.essentials;
2  import static com.earth2me.essentials.I18n.tl;
3  import com.earth2me.essentials.commands.WarpNotFoundException;
4  import com.earth2me.essentials.utils.StringUtil;
5  import java.io.File;
6  import java.io.IOException;
7  import java.util.*;
8  import java.util.logging.Level;
9  import java.util.logging.Logger;
10  import net.ess3.api.InvalidNameException;
11  import net.ess3.api.InvalidWorldException;
12  import org.bukkit.Location;
13  import org.bukkit.Server;
14  public class Warps implements IConf, net.ess3.api.IWarps
15  {
16  	private static final Logger logger = Logger.getLogger("Essentials");
17  	private final Map<StringIgnoreCase, EssentialsConf> warpPoints = new HashMap<StringIgnoreCase, EssentialsConf>();
18  	private final File warpsFolder;
19  	private final Server server;
20  	public Warps(Server server, File dataFolder)
21  	{
22  		this.server = server;
23  		warpsFolder = new File(dataFolder, "warps");
24  		if (!warpsFolder.exists())
25  		{
26  			warpsFolder.mkdirs();
27  		}
<span onclick='openModal()' class='match'>28  		reloadConfig();
29  	}
30  	@Override
31  	public boolean isEmpty()
32  	{
33  		return warpPoints.isEmpty();
34  	}
35  	@Override
36  	public Collection<String> getList()
37  	{
38  		final List<String> keys = new ArrayList<String>();
</span>39  		for (StringIgnoreCase stringIgnoreCase : warpPoints.keySet())
40  		{
41  			keys.add(stringIgnoreCase.getString());
42  		}
43  		Collections.sort(keys, String.CASE_INSENSITIVE_ORDER);
44  		return keys;
45  	}
46  	@Override
47  	public Location getWarp(String warp) throws WarpNotFoundException, InvalidWorldException
48  	{
49  		EssentialsConf conf = warpPoints.get(new StringIgnoreCase(warp));
50  		if (conf == null)
51  		{
52  			throw new WarpNotFoundException();
53  		}
54  		return conf.getLocation(null, server);
55  	}
56  	@Override
57  	public void setWarp(String name, Location loc) throws Exception
58  	{
59  		String filename = StringUtil.sanitizeFileName(name);
60  		EssentialsConf conf = warpPoints.get(new StringIgnoreCase(name));
61  		if (conf == null)
62  		{
63  			File confFile = new File(warpsFolder, filename + ".yml");
64  			if (confFile.exists())
65  			{
66  				throw new Exception(tl("similarWarpExist"));
67  			}
68  			conf = new EssentialsConf(confFile);
69  			warpPoints.put(new StringIgnoreCase(name), conf);
70  		}
71  		conf.setProperty(null, loc);
72  		conf.setProperty("name", name);
73  		try
74  		{
75  			conf.saveWithError();
76  		}
77  		catch (IOException ex)
78  		{
79  			throw new IOException(tl("invalidWarpName"));
80  		}
81  	}
82  	@Override
83  	public void removeWarp(String name) throws Exception
84  	{
85  		EssentialsConf conf = warpPoints.get(new StringIgnoreCase(name));
86  		if (conf == null)
87  		{
88  			throw new Exception(tl("warpNotExist"));
89  		}
90  		if (!conf.getFile().delete())
91  		{
92  			throw new Exception(tl("warpDeleteError"));
93  		}
94  		warpPoints.remove(new StringIgnoreCase(name));
95  	}
96  	@Override
97  	public final void reloadConfig()
98  	{
99  		warpPoints.clear();
100  		File[] listOfFiles = warpsFolder.listFiles();
101  		if (listOfFiles.length >= 1)
102  		{
103  			for (int i = 0; i < listOfFiles.length; i++)
104  			{
105  				String filename = listOfFiles[i].getName();
106  				if (listOfFiles[i].isFile() && filename.endsWith(".yml"))
107  				{
108  					try
109  					{
110  						EssentialsConf conf = new EssentialsConf(listOfFiles[i]);
111  						conf.load();
112  						String name = conf.getString("name");
113  						if (name != null)
114  						{
115  							warpPoints.put(new StringIgnoreCase(name), conf);
116  						}
117  					}
118  					catch (Exception ex)
119  					{
120  						logger.log(Level.WARNING, tl("loadWarpError", filename), ex);
121  					}
122  				}
123  			}
124  		}
125  	}
126  	@Override
127  	public File getWarpFile(String name) throws InvalidNameException
128  	{
129  		throw new UnsupportedOperationException("Not supported yet.");
130  	}
131  	@Override
132  	public int getCount()
133  	{
134  		return getList().size();
135  	}
136  	private static class StringIgnoreCase
137  	{
138  		private final String string;
139  		public StringIgnoreCase(String string)
140  		{
141  			this.string = string;
142  		}
143  		@Override
144  		public int hashCode()
145  		{
146  			return getString().toLowerCase(Locale.ENGLISH).hashCode();
147  		}
148  		@Override
149  		public boolean equals(Object o)
150  		{
151  			if (o instanceof StringIgnoreCase)
152  			{
153  				return getString().equalsIgnoreCase(((StringIgnoreCase)o).getString());
154  			}
155  			return false;
156  		}
157  		public String getString()
158  		{
159  			return string;
160  		}
161  	}
162  }
</code></pre>
        </div>
        <div class="column">
            <h3>motan-MDEwOlJlcG9zaXRvcnk1NjY3OTUyMQ==-flat-Netty4HttpServer.java</h3>
            <pre><code>1  package com.weibo.api.motan.transport.netty4.http;
2  import io.netty.bootstrap.ServerBootstrap;
3  import io.netty.channel.Channel;
4  import io.netty.channel.ChannelFuture;
5  import io.netty.channel.ChannelInitializer;
6  import io.netty.channel.ChannelOption;
7  import io.netty.channel.EventLoopGroup;
8  import io.netty.channel.nio.NioEventLoopGroup;
9  import io.netty.channel.socket.SocketChannel;
10  import io.netty.channel.socket.nio.NioServerSocketChannel;
11  import io.netty.handler.codec.http.HttpObjectAggregator;
12  import io.netty.handler.codec.http.HttpRequestDecoder;
13  import io.netty.handler.codec.http.HttpResponseEncoder;
14  import io.netty.handler.stream.ChunkedWriteHandler;
15  import java.util.concurrent.ArrayBlockingQueue;
16  import java.util.concurrent.ThreadPoolExecutor;
17  import java.util.concurrent.TimeUnit;
18  import com.weibo.api.motan.common.ChannelState;
19  import com.weibo.api.motan.common.MotanConstants;
20  import com.weibo.api.motan.common.URLParamType;
21  import com.weibo.api.motan.exception.MotanFrameworkException;
22  import com.weibo.api.motan.rpc.Request;
23  import com.weibo.api.motan.rpc.Response;
24  import com.weibo.api.motan.rpc.URL;
25  import com.weibo.api.motan.transport.AbstractServer;
26  import com.weibo.api.motan.transport.MessageHandler;
27  import com.weibo.api.motan.transport.TransportException;
28  import com.weibo.api.motan.util.LoggerUtil;
29  import com.weibo.api.motan.util.StatisticCallback;
30  import com.weibo.api.motan.util.StatsUtil;
31  public class Netty4HttpServer extends AbstractServer implements StatisticCallback {
32      private MessageHandler messageHandler;
33      private URL url;
34      private Channel channel;
35      private EventLoopGroup bossGroup;
36      private EventLoopGroup workerGroup;
37      public Netty4HttpServer(URL url, MessageHandler messageHandler) {
38          this.url = url;
39          this.messageHandler = messageHandler;
40      }
41      @Override
42      public boolean open() {
43          if (isAvailable()) {
44              return true;
45          }
46          if (channel != null) {
47              channel.close();
48          }
49          if (bossGroup == null) {
50              bossGroup = new NioEventLoopGroup();
51              workerGroup = new NioEventLoopGroup();
52          }
53          boolean shareChannel = url.getBooleanParameter(URLParamType.shareChannel.getName(), URLParamType.shareChannel.getBooleanValue());
54          int maxServerConnection =
55                  url.getIntParameter(URLParamType.maxServerConnection.getName(), URLParamType.maxServerConnection.getIntValue());
56          int workerQueueSize = url.getIntParameter(URLParamType.workerQueueSize.getName(), 500);
57          int minWorkerThread = 0, maxWorkerThread = 0;
58          if (shareChannel) {
59              minWorkerThread = url.getIntParameter(URLParamType.minWorkerThread.getName(), MotanConstants.NETTY_SHARECHANNEL_MIN_WORKDER);
60              maxWorkerThread = url.getIntParameter(URLParamType.maxWorkerThread.getName(), MotanConstants.NETTY_SHARECHANNEL_MAX_WORKDER);
61          } else {
62              minWorkerThread =
63                      url.getIntParameter(URLParamType.minWorkerThread.getName(), MotanConstants.NETTY_NOT_SHARECHANNEL_MIN_WORKDER);
64              maxWorkerThread =
65                      url.getIntParameter(URLParamType.maxWorkerThread.getName(), MotanConstants.NETTY_NOT_SHARECHANNEL_MAX_WORKDER);
66          }
67          final int maxContentLength = url.getIntParameter(URLParamType.maxContentLength.getName(), URLParamType.maxContentLength.getIntValue());
68          final NettyHttpRequestHandler handler =
69                  new NettyHttpRequestHandler(this, messageHandler, new ThreadPoolExecutor(minWorkerThread, maxWorkerThread, 15,
70                          TimeUnit.SECONDS, new ArrayBlockingQueue<Runnable>(workerQueueSize)));
71          ServerBootstrap b = new ServerBootstrap();
72          b.group(bossGroup, workerGroup).channel(NioServerSocketChannel.class).childHandler(new ChannelInitializer<SocketChannel>() {
73              @Override
74              public void initChannel(SocketChannel ch) throws Exception {
75                  ch.pipeline().addLast("http-decoder", new HttpRequestDecoder());
76                  ch.pipeline().addLast("http-aggregator", new HttpObjectAggregator(maxContentLength));
77                  ch.pipeline().addLast("http-encoder", new HttpResponseEncoder());
78                  ch.pipeline().addLast("http-chunked", new ChunkedWriteHandler());
79                  ch.pipeline().addLast("serverHandler", handler);
80              }
81          }).option(ChannelOption.SO_BACKLOG, 1024).childOption(ChannelOption.SO_KEEPALIVE, false);
82          ChannelFuture f;
83          try {
84              f = b.bind(url.getPort()).sync();
85              channel = f.channel();
86          } catch (InterruptedException e) {
87              LoggerUtil.error("init http server fail.", e);
88              return false;
89          }
90          state = ChannelState.ALIVE;
91          StatsUtil.registryStatisticCallback(this);
92          LoggerUtil.info("Netty4HttpServer ServerChannel finish Open: url=" + url);
93          return true;
94      }
95      @Override
96      public void close() {
97          close(0);
98      }
99      @Override
100      public boolean isAvailable() {
<span onclick='openModal()' class='match'>101          return state.isAliveState();
102      }
103      @Override
104      public boolean isBound() {
105          return channel != null && channel.isActive();
106      }
107      @Override
108      public Response request(Request request) throws TransportException {
</span>109          throw new MotanFrameworkException("Netty4HttpServer request(Request request) method unsupport: url: " + url);
110      }
111      @Override
112      public void close(int timeout) {
113          if (state.isCloseState()) {
114              LoggerUtil.info("NettyServer close fail: already close, url={}", url.getUri());
115              return;
116          }
117          if (state.isUnInitState()) {
118              LoggerUtil.info("NettyServer close Fail: don't need to close because node is unInit state: url={}",
119                      url.getUri());
120              return;
121          }
122          if (channel != null) {
123              channel.close();
124              workerGroup.shutdownGracefully();
125              bossGroup.shutdownGracefully();
126              workerGroup = null;
127              bossGroup = null;
128          }
129          state = ChannelState.CLOSE;
130          StatsUtil.unRegistryStatisticCallback(this);
131      }
132      @Override
133      public boolean isClosed() {
134          return state.isCloseState();
135      }
136      @Override
137      public String statisticCallback() {
138          return null;
139      }
140      @Override
141      public URL getUrl() {
142          return url;
143      }
144  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-Warps.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from motan-MDEwOlJlcG9zaXRvcnk1NjY3OTUyMQ==-flat-Netty4HttpServer.java</div>
                </div>
                <div class="column column_space"><pre><code>28  		reloadConfig();
29  	}
30  	@Override
31  	public boolean isEmpty()
32  	{
33  		return warpPoints.isEmpty();
34  	}
35  	@Override
36  	public Collection<String> getList()
37  	{
38  		final List<String> keys = new ArrayList<String>();
</pre></code></div>
                <div class="column column_space"><pre><code>101          return state.isAliveState();
102      }
103      @Override
104      public boolean isBound() {
105          return channel != null && channel.isActive();
106      }
107      @Override
108      public Response request(Request request) throws TransportException {
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    