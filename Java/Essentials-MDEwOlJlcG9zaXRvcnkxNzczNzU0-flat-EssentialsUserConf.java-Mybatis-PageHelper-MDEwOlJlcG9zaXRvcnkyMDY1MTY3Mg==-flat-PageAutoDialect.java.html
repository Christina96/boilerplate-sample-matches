
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 5.0%, Tokens: 10, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-EssentialsUserConf.java</h3>
            <pre><code>1  package com.earth2me.essentials;
<span onclick='openModal()' class='match'>2  import com.google.common.base.Charsets;
3  import com.google.common.io.Files;
4  import java.io.File;
5  import java.io.IOException;
6  import java.util.Locale;
7  import java.util.UUID;
8  import java.util.logging.Level;
9  import org.bukkit.Bukkit;
10  public class EssentialsUserConf extends EssentialsConf
11  {
12  	public final String username;
</span>13  	public final UUID uuid;
14  	public EssentialsUserConf(final String username, final UUID uuid, final File configFile)
15  	{
16  		super(configFile);
17  		this.username = username;
18  		this.uuid = uuid;
19  	}
20  	@Override
21  	public boolean legacyFileExists()
22  	{
23  		final File file = new File(configFile.getParentFile(), username + ".yml");
24  		return file.exists();
25  	}
26  	@Override
27  	public void convertLegacyFile()
28  	{
29  		final File file = new File(configFile.getParentFile(), username + ".yml");
30  		try
31  		{
32  			Files.move(file, new File(configFile.getParentFile(), uuid + ".yml"));
33  		}
34  		catch (IOException ex)
35  		{
36  			Bukkit.getLogger().log(Level.WARNING, "Failed to migrate user: " + username, ex);
37  		}
38  		setProperty("lastAccountName", username);
39  	}
40  	private File getAltFile()
41  	{
42  		final UUID fn = UUID.nameUUIDFromBytes(("OfflinePlayer:" + username.toLowerCase(Locale.ENGLISH)).getBytes(Charsets.UTF_8));
43  		return new File(configFile.getParentFile(), fn.toString() + ".yml");
44  	}
45  	@Override
46  	public boolean altFileExists()
47  	{
48  		if (username.equals(username.toLowerCase()))
49  		{
50  			return false;
51  		}
52  		return getAltFile().exists();
53  	}
54  	@Override
55  	public void convertAltFile()
56  	{
57  		try
58  		{
59  			Files.move(getAltFile(), new File(configFile.getParentFile(), uuid + ".yml"));
60  		}
61  		catch (IOException ex)
62  		{
63  			Bukkit.getLogger().log(Level.WARNING, "Failed to migrate user: " + username, ex);
64  		}
65  	}
66  }
</code></pre>
        </div>
        <div class="column">
            <h3>Mybatis-PageHelper-MDEwOlJlcG9zaXRvcnkyMDY1MTY3Mg==-flat-PageAutoDialect.java</h3>
            <pre><code>1  package com.github.pagehelper.page;
2  import com.github.pagehelper.AutoDialect;
3  import com.github.pagehelper.Dialect;
4  import com.github.pagehelper.PageException;
5  import com.github.pagehelper.PageProperties;
6  import com.github.pagehelper.dialect.AbstractHelperDialect;
7  import com.github.pagehelper.dialect.auto.*;
8  import com.github.pagehelper.dialect.helper.*;
9  import com.github.pagehelper.util.StringUtil;
10  import org.apache.ibatis.mapping.MappedStatement;
<span onclick='openModal()' class='match'>11  import javax.sql.DataSource;
12  import java.sql.Connection;
13  import java.sql.SQLException;
14  import java.util.HashMap;
15  import java.util.Map;
16  import java.util.Properties;
17  import java.util.concurrent.ConcurrentHashMap;
18  import java.util.concurrent.locks.ReentrantLock;
19  public class PageAutoDialect {
20      private static Map<String, Class<? extends Dialect>> dialectAliasMap = new HashMap<String, Class<? extends Dialect>>();
</span>21      private static Map<String, Class<? extends AutoDialect>> autoDialectMap = new HashMap<String, Class<? extends AutoDialect>>();
22      public static void registerDialectAlias(String alias, Class<? extends Dialect> dialectClass) {
23          dialectAliasMap.put(alias, dialectClass);
24      }
25      static {
26          registerDialectAlias("hsqldb", HsqldbDialect.class);
27          registerDialectAlias("h2", HsqldbDialect.class);
28          registerDialectAlias("phoenix", HsqldbDialect.class);
29          registerDialectAlias("postgresql", PostgreSqlDialect.class);
30          registerDialectAlias("mysql", MySqlDialect.class);
31          registerDialectAlias("mariadb", MySqlDialect.class);
32          registerDialectAlias("sqlite", MySqlDialect.class);
33          registerDialectAlias("herddb", HerdDBDialect.class);
34          registerDialectAlias("oracle", OracleDialect.class);
35          registerDialectAlias("oracle9i", Oracle9iDialect.class);
36          registerDialectAlias("db2", Db2Dialect.class);
37          registerDialectAlias("as400", AS400Dialect.class);
38          registerDialectAlias("informix", InformixDialect.class);
39          registerDialectAlias("informix-sqli", InformixDialect.class);
40          registerDialectAlias("sqlserver", SqlServerDialect.class);
41          registerDialectAlias("sqlserver2012", SqlServer2012Dialect.class);
42          registerDialectAlias("derby", SqlServer2012Dialect.class);
43          registerDialectAlias("dm", OracleDialect.class);
44          registerDialectAlias("edb", OracleDialect.class);
45          registerDialectAlias("oscar", OscarDialect.class);
46          registerDialectAlias("clickhouse", MySqlDialect.class);
47          registerDialectAlias("highgo", HsqldbDialect.class);
48          registerDialectAlias("xugu", HsqldbDialect.class);
49          registerDialectAlias("impala", HsqldbDialect.class);
50          registerDialectAlias("firebirdsql", FirebirdDialect.class);
51          registerDialectAlias("kingbase", PostgreSqlDialect.class);
52          registerDialectAlias("kingbase8", PostgreSqlDialect.class);
53          registerDialectAlias("xcloud", CirroDataDialect.class);
54          registerDialectAlias("opengauss",PostgreSqlDialect.class);
55          registerAutoDialectAlias("old", DefaultAutoDialect.class);
56          registerAutoDialectAlias("hikari", HikariAutoDialect.class);
57          registerAutoDialectAlias("druid", DruidAutoDialect.class);
58          registerAutoDialectAlias("tomcat-jdbc", TomcatAutoDialect.class);
59          registerAutoDialectAlias("dbcp", DbcpAutoDialect.class);
60          registerAutoDialectAlias("c3p0", C3P0AutoDialect.class);
61          registerAutoDialectAlias("default", DataSourceNegotiationAutoDialect.class);
62      }
63      public static void registerAutoDialectAlias(String alias, Class<? extends AutoDialect> autoDialectClass) {
64          autoDialectMap.put(alias, autoDialectClass);
65      }
66      private boolean autoDialect = true;
67      private Properties properties;
68      private Map<Object, AbstractHelperDialect> urlDialectMap = new ConcurrentHashMap<Object, AbstractHelperDialect>();
69      private ReentrantLock lock = new ReentrantLock();
70      private AbstractHelperDialect delegate;
71      private ThreadLocal<AbstractHelperDialect> dialectThreadLocal = new ThreadLocal<AbstractHelperDialect>();
72      private AutoDialect autoDialectDelegate;
73      public static String fromJdbcUrl(String jdbcUrl) {
74          final String url = jdbcUrl.toLowerCase();
75          for (String dialect : dialectAliasMap.keySet()) {
76              if (url.contains(":" + dialect.toLowerCase() + ":")) {
77                  return dialect;
78              }
79          }
80          return null;
81      }
82      public AbstractHelperDialect getDelegate() {
83          if (delegate != null) {
84              return delegate;
85          }
86          return dialectThreadLocal.get();
87      }
88      public void clearDelegate() {
89          dialectThreadLocal.remove();
90      }
91      public static Class resloveDialectClass(String className) throws Exception {
92          if (dialectAliasMap.containsKey(className.toLowerCase())) {
93              return dialectAliasMap.get(className.toLowerCase());
94          } else {
95              return Class.forName(className);
96          }
97      }
98      public static AbstractHelperDialect instanceDialect(String dialectClass, Properties properties) {
99          AbstractHelperDialect dialect;
100          if (StringUtil.isEmpty(dialectClass)) {
101              throw new PageException("使用 PageHelper 分页插件时，必须设置 helper 属性");
102          }
103          try {
104              Class sqlDialectClass = resloveDialectClass(dialectClass);
105              if (AbstractHelperDialect.class.isAssignableFrom(sqlDialectClass)) {
106                  dialect = (AbstractHelperDialect) sqlDialectClass.newInstance();
107              } else {
108                  throw new PageException("使用 PageHelper 时，方言必须是实现 " + AbstractHelperDialect.class.getCanonicalName() + " 接口的实现类!");
109              }
110          } catch (Exception e) {
111              throw new PageException("初始化 helper [" + dialectClass + "]时出错:" + e.getMessage(), e);
112          }
113          dialect.setProperties(properties);
114          return dialect;
115      }
116      public void initDelegateDialect(MappedStatement ms, String dialectClass) {
117          if (StringUtil.isNotEmpty(dialectClass)) {
118              AbstractHelperDialect dialect = urlDialectMap.get(dialectClass);
119              if (dialect == null) {
120                  lock.lock();
121                  try {
122                      if ((dialect = urlDialectMap.get(dialectClass)) == null) {
123                          dialect = instanceDialect(dialectClass, properties);
124                          urlDialectMap.put(dialectClass, dialect);
125                      }
126                  } finally {
127                      lock.unlock();
128                  }
129              }
130              dialectThreadLocal.set(dialect);
131          } else if (delegate == null) {
132              if (autoDialect) {
133                  this.delegate = autoGetDialect(ms);
134              } else {
135                  dialectThreadLocal.set(autoGetDialect(ms));
136              }
137          }
138      }
139      public AbstractHelperDialect autoGetDialect(MappedStatement ms) {
140          DataSource dataSource = ms.getConfiguration().getEnvironment().getDataSource();
141          Object dialectKey = autoDialectDelegate.extractDialectKey(ms, dataSource, properties);
142          if (dialectKey == null) {
143              return autoDialectDelegate.extractDialect(dialectKey, ms, dataSource, properties);
144          } else if (!urlDialectMap.containsKey(dialectKey)) {
145              lock.lock();
146              try {
147                  if (!urlDialectMap.containsKey(dialectKey)) {
148                      urlDialectMap.put(dialectKey, autoDialectDelegate.extractDialect(dialectKey, ms, dataSource, properties));
149                  }
150              } finally {
151                  lock.unlock();
152              }
153          }
154          return urlDialectMap.get(dialectKey);
155      }
156      private void initAutoDialectClass(Properties properties) {
157          String autoDialectClassStr = properties.getProperty("autoDialectClass");
158          if (StringUtil.isNotEmpty(autoDialectClassStr)) {
159              try {
160                  Class<? extends AutoDialect> autoDialectClass;
161                  if (autoDialectMap.containsKey(autoDialectClassStr)) {
162                      autoDialectClass = autoDialectMap.get(autoDialectClassStr);
163                  } else {
164                      autoDialectClass = (Class<AutoDialect>) Class.forName(autoDialectClassStr);
165                  }
166                  this.autoDialectDelegate = autoDialectClass.getConstructor().newInstance();
167                  if (this.autoDialectDelegate instanceof PageProperties) {
168                      ((PageProperties) this.autoDialectDelegate).setProperties(properties);
169                  }
170              } catch (ClassNotFoundException e) {
171                  throw new IllegalArgumentException("请确保 autoDialectClass 配置的 AutoDialect 实现类(" + autoDialectClassStr + ")存在!", e);
172              } catch (Exception e) {
173                  throw new RuntimeException(autoDialectClassStr + " 类必须提供无参的构造方法", e);
174              }
175          } else {
176              this.autoDialectDelegate = new DataSourceNegotiationAutoDialect();
177          }
178      }
179      private void initDialectAlias(Properties properties) {
180          String dialectAlias = properties.getProperty("dialectAlias");
181          if (StringUtil.isNotEmpty(dialectAlias)) {
182              String[] alias = dialectAlias.split(";");
183              for (int i = 0; i < alias.length; i++) {
184                  String[] kv = alias[i].split("=");
185                  if (kv.length != 2) {
186                      throw new IllegalArgumentException("dialectAlias 参数配置错误，" +
187                              "请按照 alias1=xx.dialectClass;alias2=dialectClass2 的形式进行配置!");
188                  }
189                  for (int j = 0; j < kv.length; j++) {
190                      try {
191                          Class<? extends Dialect> diallectClass = (Class<? extends Dialect>) Class.forName(kv[1]);
192                          registerDialectAlias(kv[0], diallectClass);
193                      } catch (ClassNotFoundException e) {
194                          throw new IllegalArgumentException("请确保 dialectAlias 配置的 Dialect 实现类存在!", e);
195                      }
196                  }
197              }
198          }
199      }
200      public void setProperties(Properties properties) {
201          initAutoDialectClass(properties);
202          String useSqlserver2012 = properties.getProperty("useSqlserver2012");
203          if (StringUtil.isNotEmpty(useSqlserver2012) && Boolean.parseBoolean(useSqlserver2012)) {
204              registerDialectAlias("sqlserver", SqlServer2012Dialect.class);
205              registerDialectAlias("sqlserver2008", SqlServerDialect.class);
206          }
207          initDialectAlias(properties);
208          String dialect = properties.getProperty("helperDialect");
209          String runtimeDialect = properties.getProperty("autoRuntimeDialect");
210          if (StringUtil.isNotEmpty(runtimeDialect) && "TRUE".equalsIgnoreCase(runtimeDialect)) {
211              this.autoDialect = false;
212              this.properties = properties;
213          }
214          else if (StringUtil.isEmpty(dialect)) {
215              autoDialect = true;
216              this.properties = properties;
217          }
218          else {
219              autoDialect = false;
220              this.delegate = instanceDialect(dialect, properties);
221          }
222      }
223  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-EssentialsUserConf.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Mybatis-PageHelper-MDEwOlJlcG9zaXRvcnkyMDY1MTY3Mg==-flat-PageAutoDialect.java</div>
                </div>
                <div class="column column_space"><pre><code>2  import com.google.common.base.Charsets;
3  import com.google.common.io.Files;
4  import java.io.File;
5  import java.io.IOException;
6  import java.util.Locale;
7  import java.util.UUID;
8  import java.util.logging.Level;
9  import org.bukkit.Bukkit;
10  public class EssentialsUserConf extends EssentialsConf
11  {
12  	public final String username;
</pre></code></div>
                <div class="column column_space"><pre><code>11  import javax.sql.DataSource;
12  import java.sql.Connection;
13  import java.sql.SQLException;
14  import java.util.HashMap;
15  import java.util.Map;
16  import java.util.Properties;
17  import java.util.concurrent.ConcurrentHashMap;
18  import java.util.concurrent.locks.ReentrantLock;
19  public class PageAutoDialect {
20      private static Map<String, Class<? extends Dialect>> dialectAliasMap = new HashMap<String, Class<? extends Dialect>>();
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    