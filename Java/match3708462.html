<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for SortingTopNProjector.java &amp; Planner.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for SortingTopNProjector.java &amp; Planner.java
      </h3>
<h1 align="center">
        5.2%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>SortingTopNProjector.java (40.384617%)<th>Planner.java (2.8225806%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(22-35)<td><a href="#" name="0">(22-34)</a><td align="center"><font color="#ff0000">12</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(52-59)<td><a href="#" name="1">(160-167)</a><td align="center"><font color="#bf0000">9</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>SortingTopNProjector.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>package io.crate.execution.engine.sort;
2 import io.crate.breaker.RowAccounting;
3 import io.crate.data.BatchIterator;
4 import io.crate.data.Bucket;
5 import io.crate.data.CollectingBatchIterator;
6 import io.crate.data.Input;
7 import io.crate.data.Projector;
8 import io.crate.data.Row;
9 import io.crate.execution.engine.collect.CollectExpression;
10 import java.util.Collection;
11 import java.util.Comparator;
12 import</b></font> java.util.stream.Collector;
13 public class SortingTopNProjector implements Projector {
14     private final Collector&lt;Row, ?, Bucket&gt; collector;
15     public SortingTopNProjector(<font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>RowAccounting&lt;Object[]&gt; rowAccounting,
16                                 Collection&lt;? extends Input&lt;?&gt;&gt; inputs,
17                                 Iterable&lt;? extends CollectExpression&lt;Row, ?&gt;&gt; collectExpressions,
18                                 int numOutputs,
19                                 Comparator&lt;Object[]&gt; ordering,
20                                 int limit,
21                                 int offset,
22                                 int unboundedCollectorThreshold) {</b></font>
23         if ((limit + offset) &gt; unboundedCollectorThreshold) {
24             collector = new UnboundedSortingTopNCollector(
25                 rowAccounting,
26                 inputs,
27                 collectExpressions,
28                 numOutputs,
29                 ordering,
30                 unboundedCollectorThreshold,
31                 limit,
32                 offset
33             );
34         } else {
35             collector = new BoundedSortingTopNCollector(
36                 rowAccounting,
37                 inputs,
38                 collectExpressions,
39                 numOutputs,
40                 ordering,
41                 limit,
42                 offset
43             );
44         }
45     }
46     @Override
47     public BatchIterator&lt;Row&gt; apply(BatchIterator&lt;Row&gt; batchIterator) {
48         return CollectingBatchIterator.newInstance(batchIterator, collector);
49     }
50     @Override
51     public boolean providesIndependentScroll() {
52         return true;
53     }
54 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>Planner.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>package io.crate.planner;
2 import io.crate.analyze.AnalyzedAlterBlobTable;
3 import io.crate.analyze.AnalyzedAlterTable;
4 import io.crate.analyze.AnalyzedAlterTableAddColumn;
5 import io.crate.analyze.AnalyzedAlterTableDropCheckConstraint;
6 import io.crate.analyze.AnalyzedAlterTableOpenClose;
7 import io.crate.analyze.AnalyzedAlterTableRename;
8 import io.crate.analyze.AnalyzedAlterUser;
9 import io.crate.analyze.AnalyzedAnalyze;
10 import io.crate.analyze.AnalyzedBegin;
11 import io.crate.analyze.AnalyzedCommit;
12 import</b></font> io.crate.analyze.AnalyzedCopyFrom;
13 import io.crate.analyze.AnalyzedCopyTo;
14 import io.crate.analyze.AnalyzedCreateAnalyzer;
15 import io.crate.analyze.AnalyzedCreateBlobTable;
16 import io.crate.analyze.AnalyzedCreateFunction;
17 import io.crate.analyze.AnalyzedCreateRepository;
18 import io.crate.analyze.AnalyzedCreateSnapshot;
19 import io.crate.analyze.AnalyzedCreateTable;
20 import io.crate.analyze.AnalyzedCreateTableAs;
21 import io.crate.analyze.AnalyzedCreateUser;
22 import io.crate.analyze.AnalyzedDeallocate;
23 import io.crate.analyze.AnalyzedDecommissionNode;
24 import io.crate.analyze.AnalyzedDeleteStatement;
25 import io.crate.analyze.AnalyzedDiscard;
26 import io.crate.analyze.AnalyzedDropAnalyzer;
27 import io.crate.analyze.AnalyzedDropFunction;
28 import io.crate.analyze.AnalyzedDropRepository;
29 import io.crate.analyze.AnalyzedDropSnapshot;
30 import io.crate.analyze.AnalyzedDropTable;
31 import io.crate.analyze.AnalyzedDropUser;
32 import io.crate.analyze.AnalyzedDropView;
33 import io.crate.analyze.AnalyzedGCDanglingArtifacts;
34 import io.crate.analyze.AnalyzedInsertStatement;
35 import io.crate.analyze.AnalyzedKill;
36 import io.crate.analyze.AnalyzedOptimizeTable;
37 import io.crate.analyze.AnalyzedPromoteReplica;
38 import io.crate.analyze.AnalyzedRefreshTable;
39 import io.crate.analyze.AnalyzedRerouteAllocateReplicaShard;
40 import io.crate.analyze.AnalyzedRerouteCancelShard;
41 import io.crate.analyze.AnalyzedRerouteMoveShard;
42 import io.crate.analyze.AnalyzedRerouteRetryFailed;
43 import io.crate.analyze.AnalyzedResetStatement;
44 import io.crate.analyze.AnalyzedRestoreSnapshot;
45 import io.crate.analyze.AnalyzedSetLicenseStatement;
46 import io.crate.analyze.AnalyzedSetSessionAuthorizationStatement;
47 import io.crate.analyze.AnalyzedSetStatement;
48 import io.crate.analyze.AnalyzedSetTransaction;
49 import io.crate.analyze.AnalyzedShowCreateTable;
50 import io.crate.analyze.AnalyzedStatement;
51 import io.crate.analyze.AnalyzedStatementVisitor;
52 import io.crate.analyze.AnalyzedSwapTable;
53 import io.crate.analyze.AnalyzedUpdateStatement;
54 import io.crate.analyze.CreateViewStmt;
55 import io.crate.analyze.DCLStatement;
56 import io.crate.analyze.ExplainAnalyzedStatement;
57 import io.crate.analyze.NumberOfShards;
58 import io.crate.analyze.relations.AnalyzedRelation;
59 import io.crate.user.UserManager;
60 import io.crate.execution.ddl.tables.TableCreator;
61 import io.crate.metadata.NodeContext;
62 import io.crate.metadata.Schemas;
63 import io.crate.metadata.settings.session.SessionSettingRegistry;
64 import io.crate.planner.consumer.CreateTableAsPlanner;
65 import io.crate.planner.consumer.UpdatePlanner;
66 import io.crate.planner.node.dcl.GenericDCLPlan;
67 import io.crate.planner.node.ddl.AlterBlobTablePlan;
68 import io.crate.planner.node.ddl.AlterTableAddColumnPlan;
69 import io.crate.planner.node.ddl.AlterTableDropCheckConstraintPlan;
70 import io.crate.planner.node.ddl.AlterTableOpenClosePlan;
71 import io.crate.planner.node.ddl.AlterTablePlan;
72 import io.crate.planner.node.ddl.AlterTableRenameTablePlan;
73 import io.crate.planner.node.ddl.AlterUserPlan;
74 import io.crate.planner.node.ddl.CreateAnalyzerPlan;
75 import io.crate.planner.node.ddl.CreateBlobTablePlan;
76 import io.crate.planner.node.ddl.CreateFunctionPlan;
77 import io.crate.planner.node.ddl.CreateRepositoryPlan;
78 import io.crate.planner.node.ddl.CreateSnapshotPlan;
79 import io.crate.planner.node.ddl.CreateTablePlan;
80 import io.crate.planner.node.ddl.CreateUserPlan;
81 import io.crate.planner.node.ddl.DropAnalyzerPlan;
82 import io.crate.planner.node.ddl.DropFunctionPlan;
83 import io.crate.planner.node.ddl.DropRepositoryPlan;
84 import io.crate.planner.node.ddl.DropSnapshotPlan;
85 import io.crate.planner.node.ddl.DropTablePlan;
86 import io.crate.planner.node.ddl.DropUserPlan;
87 import io.crate.planner.node.ddl.OptimizeTablePlan;
88 import io.crate.planner.node.ddl.RefreshTablePlan;
89 import io.crate.planner.node.ddl.ResetSettingsPlan;
90 import io.crate.planner.node.ddl.RestoreSnapshotPlan;
91 import io.crate.planner.node.ddl.UpdateSettingsPlan;
92 import io.crate.planner.node.management.AlterTableReroutePlan;
93 import io.crate.planner.node.management.ExplainPlan;
94 import io.crate.planner.node.management.KillPlan;
95 import io.crate.planner.node.management.RerouteRetryFailedPlan;
96 import io.crate.planner.node.management.ShowCreateTablePlan;
97 import io.crate.planner.operators.LogicalPlanner;
98 import io.crate.planner.statement.CopyFromPlan;
99 import io.crate.planner.statement.CopyToPlan;
100 import io.crate.planner.statement.DeletePlanner;
101 import io.crate.planner.statement.SetLicensePlan;
102 import io.crate.planner.statement.SetSessionAuthorizationPlan;
103 import io.crate.planner.statement.SetSessionPlan;
104 import io.crate.profile.ProfilingContext;
105 import io.crate.profile.Timer;
106 import io.crate.sql.tree.SetSessionAuthorizationStatement;
107 import io.crate.statistics.TableStats;
108 import org.apache.logging.log4j.LogManager;
109 import org.apache.logging.log4j.Logger;
110 import org.elasticsearch.cluster.ClusterState;
111 import org.elasticsearch.cluster.routing.allocation.decider.AwarenessAllocationDecider;
112 import org.elasticsearch.cluster.service.ClusterService;
113 import org.elasticsearch.common.inject.Inject;
114 import org.elasticsearch.common.inject.Singleton;
115 import org.elasticsearch.common.settings.Settings;
116 import java.util.List;
117 import java.util.Locale;
118 @Singleton
119 public class Planner extends AnalyzedStatementVisitor&lt;PlannerContext, Plan&gt; {
120     private static final Logger LOGGER = LogManager.getLogger(Planner.class);
121     private final ClusterService clusterService;
122     private final TableStats tableStats;
123     private final LogicalPlanner logicalPlanner;
124     private final NumberOfShards numberOfShards;
125     private final TableCreator tableCreator;
126     private final Schemas schemas;
127     private final UserManager userManager;
128     private final SessionSettingRegistry sessionSettingRegistry;
129     private List&lt;String&gt; awarenessAttributes;
130 <a name="1"></a>
131     @Inject
132     public Planner(Settings settings,
133                    <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>ClusterService clusterService,
134                    NodeContext nodeCtx,
135                    TableStats tableStats,
136                    NumberOfShards numberOfShards,
137                    TableCreator tableCreator,
138                    Schemas schemas,
139                    UserManager userManager,
140                    SessionSettingRegistry sessionSettingRegistry) {</b></font>
141         this.clusterService = clusterService;
142         this.tableStats = tableStats;
143         this.logicalPlanner = new LogicalPlanner(nodeCtx, tableStats, () -&gt; clusterService.state().nodes().getMinNodeVersion());
144         this.numberOfShards = numberOfShards;
145         this.tableCreator = tableCreator;
146         this.schemas = schemas;
147         this.userManager = userManager;
148         this.sessionSettingRegistry = sessionSettingRegistry;
149         initAwarenessAttributes(settings);
150     }
151     private void initAwarenessAttributes(Settings settings) {
152         awarenessAttributes =
153             AwarenessAllocationDecider.CLUSTER_ROUTING_ALLOCATION_AWARENESS_ATTRIBUTE_SETTING.get(settings);
154         clusterService.getClusterSettings().addSettingsUpdateConsumer(
155             AwarenessAllocationDecider.CLUSTER_ROUTING_ALLOCATION_AWARENESS_ATTRIBUTE_SETTING,
156             this::setAwarenessAttributes);
157     }
158     private void setAwarenessAttributes(List&lt;String&gt; awarenessAttributes) {
159         this.awarenessAttributes = awarenessAttributes;
160     }
161     public List&lt;String&gt; getAwarenessAttributes() {
162         return awarenessAttributes;
163     }
164     public ClusterState currentClusterState() {
165         return clusterService.state();
166     }
167     public Plan plan(AnalyzedStatement analyzedStatement, PlannerContext plannerContext) {
168         return analyzedStatement.accept(this, plannerContext);
169     }
170     @Override
171     protected Plan visitAnalyzedStatement(AnalyzedStatement analyzedStatement, PlannerContext context) {
172         throw new UnsupportedOperationException(String.format(Locale.ENGLISH,
173                                                               "Cannot create Plan from AnalyzedStatement \"%s\"  - not supported.", analyzedStatement));
174     }
175     @Override
176     public Plan visitAnalyze(AnalyzedAnalyze analyzedAnalyze, PlannerContext context) {
177         return new AnalyzePlan();
178     }
179     @Override
180     public Plan visitBegin(AnalyzedBegin analyzedBegin, PlannerContext context) {
181         return NoopPlan.INSTANCE;
182     }
183     @Override
184     public Plan visitCommit(AnalyzedCommit analyzedCommit, PlannerContext context) {
185         return NoopPlan.INSTANCE;
186     }
187     @Override
188     public Plan visitSelectStatement(AnalyzedRelation relation, PlannerContext context) {
189         return logicalPlanner.plan(relation, context);
190     }
191     @Override
192     public Plan visitSwapTable(AnalyzedSwapTable swapTable, PlannerContext context) {
193         return new SwapTablePlan(swapTable);
194     }
195     @Override
196     public Plan visitGCDanglingArtifacts(AnalyzedGCDanglingArtifacts gcDanglingArtifacts, PlannerContext context) {
197         return new GCDangingArtifactsPlan();
198     }
199     @Override
200     public Plan visitDecommissionNode(AnalyzedDecommissionNode decommissionNode, PlannerContext context) {
201         return new DecommissionNodePlan(decommissionNode);
202     }
203     @Override
204     protected Plan visitAnalyzedInsertStatement(AnalyzedInsertStatement statement, PlannerContext context) {
205         return logicalPlanner.plan(statement, context);
206     }
207     @Override
208     public Plan visitAnalyzedUpdateStatement(AnalyzedUpdateStatement update, PlannerContext context) {
209         return UpdatePlanner.plan(
210             update, context, new SubqueryPlanner(s -&gt; logicalPlanner.planSubSelect(s, context)));
211     }
212     @Override
213     protected Plan visitAnalyzedDeleteStatement(AnalyzedDeleteStatement statement, PlannerContext context) {
214         return DeletePlanner.planDelete(
215             statement,
216             new SubqueryPlanner(s -&gt; logicalPlanner.planSubSelect(s, context)),
217             context
218         );
219     }
220     @Override
221     protected Plan visitCopyFromStatement(AnalyzedCopyFrom analysis, PlannerContext context) {
222         return new CopyFromPlan(analysis);
223     }
224     @Override
225     protected Plan visitCopyToStatement(AnalyzedCopyTo analysis, PlannerContext context) {
226         return new CopyToPlan(analysis, tableStats);
227     }
228     @Override
229     public Plan visitShowCreateTableAnalyzedStatement(AnalyzedShowCreateTable statement, PlannerContext context) {
230         return new ShowCreateTablePlan(statement);
231     }
232     @Override
233     protected Plan visitCreateRepositoryAnalyzedStatement(AnalyzedCreateRepository analysis,
234                                                           PlannerContext context) {
235         return new CreateRepositoryPlan(analysis);
236     }
237     @Override
238     public Plan visitDropRepositoryAnalyzedStatement(AnalyzedDropRepository analysis,
239                                                      PlannerContext context) {
240         return new DropRepositoryPlan(analysis);
241     }
242     @Override
243     public Plan visitCreateSnapshotAnalyzedStatement(AnalyzedCreateSnapshot analysis,
244                                                      PlannerContext context) {
245         return new CreateSnapshotPlan(analysis);
246     }
247     @Override
248     public Plan visitDropSnapshotAnalyzedStatement(AnalyzedDropSnapshot analysis,
249                                                    PlannerContext context) {
250         return new DropSnapshotPlan(analysis);
251     }
252     @Override
253     public Plan visitDCLStatement(DCLStatement statement, PlannerContext context) {
254         return new GenericDCLPlan(statement);
255     }
256     @Override
257     public Plan visitDropTable(AnalyzedDropTable&lt;?&gt; dropTable, PlannerContext context) {
258         return new DropTablePlan(dropTable);
259     }
260     @Override
261     public Plan visitCreateTable(AnalyzedCreateTable createTable, PlannerContext context) {
262         return new CreateTablePlan(createTable, numberOfShards, tableCreator, schemas);
263     }
264     @Override
265     public Plan visitCreateTableAs(AnalyzedCreateTableAs createTableAs, PlannerContext context) {
266         return CreateTableAsPlanner.plan(
267             createTableAs, numberOfShards, tableCreator, schemas, context, logicalPlanner
268         );
269     }
270     @Override
271     public Plan visitAlterTable(AnalyzedAlterTable alterTable, PlannerContext context) {
272         return new AlterTablePlan(alterTable);
273     }
274     @Override
275     public Plan visitAnalyzedAlterBlobTable(AnalyzedAlterBlobTable analysis,
276                                             PlannerContext context) {
277         return new AlterBlobTablePlan(analysis);
278     }
279     @Override
280     public Plan visitAnalyzedCreateBlobTable(AnalyzedCreateBlobTable analysis,
281                                              PlannerContext context) {
282         return new CreateBlobTablePlan(analysis, numberOfShards);
283     }
284     public Plan visitRefreshTableStatement(AnalyzedRefreshTable analysis, PlannerContext context) {
285         return new RefreshTablePlan(analysis);
286     }
287     @Override
288     public Plan visitAnalyzedAlterTableRename(AnalyzedAlterTableRename analysis,
289                                               PlannerContext context) {
290         return new AlterTableRenameTablePlan(analysis);
291     }
292     @Override
293     public Plan visitAnalyzedAlterTableOpenClose(AnalyzedAlterTableOpenClose analysis,
294                                                  PlannerContext context) {
295         return new AlterTableOpenClosePlan(analysis);
296     }
297     @Override
298     protected Plan visitAnalyzedCreateUser(AnalyzedCreateUser analysis,
299                                            PlannerContext context) {
300         return new CreateUserPlan(analysis, userManager);
301     }
302     @Override
303     public Plan visitAnalyzedAlterUser(AnalyzedAlterUser analysis, PlannerContext context) {
304         return new AlterUserPlan(analysis, userManager);
305     }
306     @Override
307     protected Plan visitDropUser(AnalyzedDropUser analysis, PlannerContext context) {
308         return new DropUserPlan(analysis, userManager);
309     }
310     protected Plan visitCreateAnalyzerStatement(AnalyzedCreateAnalyzer analysis, PlannerContext context) {
311         return new CreateAnalyzerPlan(analysis);
312     }
313     @Override
314     public Plan visitAlterTableAddColumn(AnalyzedAlterTableAddColumn alterTableAddColumn,
315                                          PlannerContext context) {
316         return new AlterTableAddColumnPlan(alterTableAddColumn);
317     }
318     @Override
319     public Plan visitAlterTableDropCheckConstraint(AnalyzedAlterTableDropCheckConstraint dropCheckConstraint,
320                                                    PlannerContext context) {
321         return new AlterTableDropCheckConstraintPlan(dropCheckConstraint);
322     }
323     @Override
324     protected Plan visitCreateFunction(AnalyzedCreateFunction analysis,
325                                        PlannerContext context) {
326         return new CreateFunctionPlan(analysis);
327     }
328     @Override
329     public Plan visitDropFunction(AnalyzedDropFunction analysis, PlannerContext context) {
330         return new DropFunctionPlan(analysis);
331     }
332     @Override
333     protected Plan visitDropAnalyzerStatement(AnalyzedDropAnalyzer analysis, PlannerContext context) {
334         return new DropAnalyzerPlan(analysis);
335     }
336     @Override
337     public Plan visitResetAnalyzedStatement(AnalyzedResetStatement resetStatement, PlannerContext context) {
338         if (resetStatement.settingsToRemove().isEmpty()) {
339             return NoopPlan.INSTANCE;
340         }
341         return new ResetSettingsPlan(resetStatement);
342     }
343     @Override
344     public Plan visitRestoreSnapshotAnalyzedStatement(AnalyzedRestoreSnapshot analysis, PlannerContext context) {
345         return new RestoreSnapshotPlan(analysis);
346     }
347     @Override
348     public Plan visitSetStatement(AnalyzedSetStatement setStatement, PlannerContext context) {
349         switch (setStatement.scope()) {
350             case LICENSE:
351                 throw new AssertionError(
352                     "`AnalyzedSetStatement` with scope `LICENSE` should have been converted to `AnalyzedSetLicenseStatement` by the analyzer");
353             case LOCAL:
354                 LOGGER.info(
355                     "SET LOCAL `{}` statement will be ignored. " +
356                     "CrateDB has no transactions, so any `SET LOCAL` change would be dropped in the next statement.", setStatement.settings());
357                 return NoopPlan.INSTANCE;
358             case SESSION:
359                 return new SetSessionPlan(setStatement.settings(), sessionSettingRegistry);
360             case GLOBAL:
361             default:
362                 return new UpdateSettingsPlan(setStatement.settings(), setStatement.isPersistent());
363         }
364     }
365     @Override
366     public Plan visitSetSessionAuthorizationStatement(AnalyzedSetSessionAuthorizationStatement analysis,
367                                                       PlannerContext context) {
368         if (analysis.scope() == SetSessionAuthorizationStatement.Scope.LOCAL) {
369             LOGGER.info(
370                 "SET LOCAL SESSION AUTHORIZATION 'username' statement will be ignored. " +
371                 "CrateDB has no transactions, so any `SET LOCAL` change would be dropped in the next statement.");
372             return NoopPlan.INSTANCE;
373         } else {
374             return new SetSessionAuthorizationPlan(analysis, userManager);
375         }
376     }
377     @Override
378     public Plan visitSetTransaction(AnalyzedSetTransaction setTransaction, PlannerContext context) {
379         LOGGER.info("'SET TRANSACTION' statement is ignored. CrateDB doesn't support transactions");
380         return NoopPlan.INSTANCE;
381     }
382     @Override
383     public Plan visitSetLicenseStatement(AnalyzedSetLicenseStatement setLicenseAnalyzedStatement, PlannerContext context) {
384         return new SetLicensePlan(setLicenseAnalyzedStatement);
385     }
386     @Override
387     public Plan visitKillAnalyzedStatement(AnalyzedKill analysis, PlannerContext context) {
388         return new KillPlan(analysis.jobId());
389     }
390     @Override
391     public Plan visitDeallocateAnalyzedStatement(AnalyzedDeallocate analysis, PlannerContext context) {
392         return NoopPlan.INSTANCE;
393     }
394     @Override
395     public Plan visitDiscard(AnalyzedDiscard discard, PlannerContext context) {
396         return NoopPlan.INSTANCE;
397     }
398     @Override
399     public Plan visitExplainStatement(ExplainAnalyzedStatement explainAnalyzedStatement, PlannerContext context) {
400         ProfilingContext ctx = explainAnalyzedStatement.context();
401         if (ctx == null) {
402             return new ExplainPlan(explainAnalyzedStatement.statement().accept(this, context), null);
403         } else {
404             Timer timer = ctx.createAndStartTimer(ExplainPlan.Phase.Plan.name());
405             Plan subPlan = explainAnalyzedStatement.statement().accept(this, context);
406             ctx.stopTimerAndStoreDuration(timer);
407             return new ExplainPlan(subPlan, ctx);
408         }
409     }
410     @Override
411     public Plan visitCreateViewStmt(CreateViewStmt createViewStmt, PlannerContext context) {
412         return new CreateViewPlan(createViewStmt);
413     }
414     @Override
415     public Plan visitDropView(AnalyzedDropView dropView, PlannerContext context) {
416         return new DropViewPlan(dropView);
417     }
418     @Override
419     public Plan visitOptimizeTableStatement(AnalyzedOptimizeTable analysis, PlannerContext context) {
420         return new OptimizeTablePlan(analysis);
421     }
422     @Override
423     protected Plan visitRerouteMoveShard(AnalyzedRerouteMoveShard analysis, PlannerContext context) {
424         return new AlterTableReroutePlan(analysis);
425     }
426     @Override
427     protected Plan visitRerouteAllocateReplicaShard(AnalyzedRerouteAllocateReplicaShard analysis,
428                                                     PlannerContext context) {
429         return new AlterTableReroutePlan(analysis);
430     }
431     @Override
432     protected Plan visitRerouteCancelShard(AnalyzedRerouteCancelShard analysis, PlannerContext context) {
433         return new AlterTableReroutePlan(analysis);
434     }
435     @Override
436     public Plan visitReroutePromoteReplica(AnalyzedPromoteReplica analysis, PlannerContext context) {
437         return new AlterTableReroutePlan(analysis);
438     }
439     @Override
440     public Plan visitRerouteRetryFailedStatement(AnalyzedRerouteRetryFailed analysis, PlannerContext context) {
441         return new RerouteRetryFailedPlan();
442     }
443 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
