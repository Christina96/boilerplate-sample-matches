
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 6.358381502890173%, Tokens: 11, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>Mybatis-PageHelper-MDEwOlJlcG9zaXRvcnkyMDY1MTY3Mg==-flat-IPageTest.java</h3>
            <pre><code>1  package com.github.pagehelper.test.basic;
2  import com.github.pagehelper.IPage;
3  import com.github.pagehelper.Page;
4  import com.github.pagehelper.mapper.UserMapper;
5  import com.github.pagehelper.model.User;
6  import com.github.pagehelper.model.UserQueryModel;
7  import com.github.pagehelper.util.MybatisHelper;
8  import org.apache.ibatis.session.SqlSession;
9  import org.junit.Test;
10  import java.util.List;
11  import static org.junit.Assert.assertEquals;
12  public class IPageTest {
13      @Test
14      public void testIPage() {
15          SqlSession sqlSession = MybatisHelper.getSqlSession();
16          UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
17          try {
18              UserIPage queryModel = new UserIPage();
<span onclick='openModal()' class='match'>19              queryModel.setPageNum(1);
20              queryModel.setPageSize(10);
21              queryModel.setOrderBy("id desc");
22              List<User> list = userMapper.selectByQueryModel(queryModel);
23              assertEquals(10, list.size());
24              assertEquals(183, ((Page<?>) list).getTotal());
25              queryModel.setPageNum(2);
26              queryModel.setOrderBy(null);
</span>27              list = userMapper.selectByQueryModel(queryModel);
28              assertEquals(10, list.size());
29              assertEquals(183, ((Page<?>) list).getTotal());
30              queryModel.setPageNum(null);
31              queryModel.setPageSize(null);
32              queryModel.setOrderBy("id asc");
33              list = userMapper.selectByQueryModel(queryModel);
34              assertEquals(1, list.get(0).getId());
35              assertEquals(183, list.size());
36              assertEquals(183, ((Page<?>) list).getTotal());
37          } finally {
38              sqlSession.close();
39          }
40      }
41      public static class UserIPage extends UserQueryModel implements IPage {
42      }
43  }
</code></pre>
        </div>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-JedisPoolTest.java</h3>
            <pre><code>1  package redis.clients.jedis;
2  import static org.junit.Assert.assertEquals;
3  import static org.junit.Assert.assertNull;
4  import static org.junit.Assert.assertSame;
5  import static org.junit.Assert.assertTrue;
6  import static org.junit.Assert.fail;
7  import java.net.URI;
8  import java.net.URISyntaxException;
9  import java.util.concurrent.atomic.AtomicInteger;
10  import org.apache.commons.pool2.PooledObject;
11  import org.apache.commons.pool2.PooledObjectFactory;
12  import org.apache.commons.pool2.impl.DefaultPooledObject;
13  import org.apache.commons.pool2.impl.GenericObjectPoolConfig;
14  import org.junit.Assert;
15  import org.junit.Test;
16  import redis.clients.jedis.exceptions.InvalidURIException;
17  import redis.clients.jedis.exceptions.JedisConnectionException;
18  import redis.clients.jedis.exceptions.JedisException;
19  public class JedisPoolTest {
20    private static final HostAndPort hnp = HostAndPorts.getRedisServers().get(0);
21    @Test
22    public void checkConnections() {
23      JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000);
24      try (Jedis jedis = pool.getResource()) {
25        jedis.auth("foobared");
26        jedis.set("foo", "bar");
27        assertEquals("bar", jedis.get("foo"));
28      }
29      pool.close();
30      assertTrue(pool.isClosed());
31    }
32    @Test
33    public void checkResourceWithConfig() {
34      try (JedisPool pool = new JedisPool(HostAndPorts.getRedisServers().get(7),
35          DefaultJedisClientConfig.builder().socketTimeoutMillis(5000).build())) {
36        try (Jedis jedis = pool.getResource()) {
37          assertEquals("PONG", jedis.ping());
38          assertEquals(5000, jedis.getClient().getSoTimeout());
39          jedis.close();
40        }
41      }
42    }
43    @Test
44    public void checkCloseableConnections() throws Exception {
45      JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000);
46      try (Jedis jedis = pool.getResource()) {
47        jedis.auth("foobared");
48        jedis.set("foo", "bar");
49        assertEquals("bar", jedis.get("foo"));
50      }
51      pool.close();
52      assertTrue(pool.isClosed());
53    }
54    @Test
55    public void checkConnectionWithDefaultHostAndPort() {
56      JedisPool pool = new JedisPool(new JedisPoolConfig());
57      try (Jedis jedis = pool.getResource()) {
58        jedis.auth("foobared");
59        jedis.set("foo", "bar");
60        assertEquals("bar", jedis.get("foo"));
61      }
62      pool.close();
63      assertTrue(pool.isClosed());
64    }
65    @Test
66    public void checkResourceIsClosableAndReusable() {
67      GenericObjectPoolConfig<Jedis> config = new GenericObjectPoolConfig<>();
68      config.setMaxTotal(1);
69      config.setBlockWhenExhausted(false);
70      try (JedisPool pool = new JedisPool(config, hnp.getHost(), hnp.getPort(), 2000, "foobared", 0,
71          "closable-resuable-pool", false, null, null, null)) {
72        Jedis jedis = pool.getResource();
73        jedis.set("hello", "jedis");
74        jedis.close();
75        Jedis jedis2 = pool.getResource();
76        assertEquals(jedis, jedis2);
77        assertEquals("jedis", jedis2.get("hello"));
78        jedis2.close();
79      }
80    }
81    @Test
82    public void checkPoolRepairedWhenJedisIsBroken() {
83      JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort());
84      try (Jedis jedis = pool.getResource()) {
85        jedis.auth("foobared");
86        jedis.set("foo", "0");
87        jedis.disconnect();
88      }
89      try (Jedis jedis = pool.getResource()) {
90        jedis.auth("foobared");
91        jedis.incr("foo");
92      }
93      pool.close();
94      assertTrue(pool.isClosed());
95    }
96    @Test(expected = JedisException.class)
97    public void checkPoolOverflow() {
98      GenericObjectPoolConfig<Jedis> config = new GenericObjectPoolConfig<>();
99      config.setMaxTotal(1);
100      config.setBlockWhenExhausted(false);
101      try (JedisPool pool = new JedisPool(config, hnp.getHost(), hnp.getPort());
102          Jedis jedis = pool.getResource()) {
103        jedis.auth("foobared");
104        try (Jedis jedis2 = pool.getResource()) {
105          jedis2.auth("foobared");
106        }
107      }
108    }
109    @Test
110    public void securePool() {
111      JedisPoolConfig config = new JedisPoolConfig();
112      config.setTestOnBorrow(true);
113      JedisPool pool = new JedisPool(config, hnp.getHost(), hnp.getPort(), 2000, "foobared");
114      try (Jedis jedis = pool.getResource()) {
115        jedis.set("foo", "bar");
116      }
117      pool.close();
118      assertTrue(pool.isClosed());
119    }
120    @Test
121    public void nonDefaultDatabase() {
122      try (JedisPool pool0 = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000,
123          "foobared"); Jedis jedis0 = pool0.getResource()) {
124        jedis0.set("foo", "bar");
125        assertEquals("bar", jedis0.get("foo"));
126      }
127      try (JedisPool pool1 = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000,
128          "foobared", 1); Jedis jedis1 = pool1.getResource()) {
129        assertNull(jedis1.get("foo"));
130      }
131    }
132    @Test
133    public void startWithUrlString() {
134      try (Jedis j = new Jedis("localhost", 6380)) {
135        j.auth("foobared");
136        j.select(2);
137        j.set("foo", "bar");
138      }
139      try (JedisPool pool = new JedisPool("redis:&bsol;&bsol;:foobared@localhost:6380/2");
140          Jedis jedis = pool.getResource()) {
141        assertEquals("PONG", jedis.ping());
142        assertEquals("bar", jedis.get("foo"));
143      }
144    }
145    @Test
146    public void startWithUrl() throws URISyntaxException {
147      try (Jedis j = new Jedis("localhost", 6380)) {
148        j.auth("foobared");
149        j.select(2);
150        j.set("foo", "bar");
151      }
152      try (JedisPool pool = new JedisPool(new URI("redis:&bsol;&bsol;:foobared@localhost:6380/2"));
153          Jedis jedis = pool.getResource()) {
154        assertEquals("bar", jedis.get("foo"));
155      }
156    }
157    @Test(expected = InvalidURIException.class)
158    public void shouldThrowInvalidURIExceptionForInvalidURI() throws URISyntaxException {
159      new JedisPool(new URI("localhost:6380")).close();
160    }
161    @Test
162    public void allowUrlWithNoDBAndNoPassword() throws URISyntaxException {
163      new JedisPool("redis:&bsol;&bsol;localhost:6380").close();
164      new JedisPool(new URI("redis:&bsol;&bsol;localhost:6380")).close();
165    }
166    @Test
167    public void selectDatabaseOnActivation() {
168      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000,
169          "foobared")) {
170        Jedis jedis0 = pool.getResource();
171        assertEquals(0, jedis0.getDB());
172        jedis0.select(1);
173        assertEquals(1, jedis0.getDB());
174        jedis0.close();
175        Jedis jedis1 = pool.getResource();
176        assertTrue("Jedis instance was not reused", jedis1 == jedis0);
177        assertEquals(0, jedis1.getDB());
178        jedis1.close();
179      }
180    }
181    @Test
182    public void customClientName() {
183      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000,
184          "foobared", 0, "my_shiny_client_name"); Jedis jedis = pool.getResource()) {
185        assertEquals("my_shiny_client_name", jedis.clientGetname());
186      }
187    }
188    @Test
189    public void invalidClientName() {
190      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000,
191          "foobared", 0, "invalid client name"); Jedis jedis = pool.getResource()) {
192      } catch (Exception e) {
193        if (!e.getMessage().startsWith("client info cannot contain space")) {
194          Assert.fail("invalid client name test fail");
195        }
196      }
197    }
198    @Test
199    public void returnResourceDestroysResourceOnException() {
200      class CrashingJedis extends Jedis {
201        @Override
202        public void resetState() {
203          throw new RuntimeException();
204        }
205      }
206      final AtomicInteger destroyed = new AtomicInteger(0);
207      class CrashingJedisPooledObjectFactory implements PooledObjectFactory<Jedis> {
208        @Override
209        public PooledObject<Jedis> makeObject() throws Exception {
210          return new DefaultPooledObject<Jedis>(new CrashingJedis());
211        }
212        @Override
213        public void destroyObject(PooledObject<Jedis> p) throws Exception {
214          destroyed.incrementAndGet();
215        }
216        @Override
217        public boolean validateObject(PooledObject<Jedis> p) {
218          return true;
219        }
220        @Override
221        public void activateObject(PooledObject<Jedis> p) throws Exception {
222        }
223        @Override
224        public void passivateObject(PooledObject<Jedis> p) throws Exception {
225        }
226      }
227      GenericObjectPoolConfig<Jedis> config = new GenericObjectPoolConfig<>();
228      config.setMaxTotal(1);
229      JedisPool pool = new JedisPool(config, new CrashingJedisPooledObjectFactory());
230      Jedis crashingJedis = pool.getResource();
231      try {
232        crashingJedis.close();
233      } catch (Exception ignored) {
234      }
235      assertEquals(1, destroyed.get());
236    }
237    @Test
238    public void returnResourceShouldResetState() {
239      GenericObjectPoolConfig<Jedis> config = new GenericObjectPoolConfig<>();
240      config.setMaxTotal(1);
241      config.setBlockWhenExhausted(false);
242      JedisPool pool = new JedisPool(config, hnp.getHost(), hnp.getPort(), 2000, "foobared");
243      Jedis jedis = pool.getResource();
244      try {
245        jedis.set("hello", "jedis");
246        Transaction t = jedis.multi();
247        t.set("hello", "world");
248      } finally {
249        jedis.close();
250      }
251      Jedis jedis2 = pool.getResource();
252      try {
253        assertTrue(jedis == jedis2);
254        assertEquals("jedis", jedis2.get("hello"));
255      } finally {
256        jedis2.close();
257      }
258      pool.close();
259      assertTrue(pool.isClosed());
260    }
261    @Test
262    public void getNumActiveWhenPoolIsClosed() {
263      JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000,
264          "foobared", 0, "my_shiny_client_name");
265      try (Jedis j = pool.getResource()) {
266        j.ping();
267      }
268      pool.close();
269      assertEquals(0, pool.getNumActive());
270    }
271    @Test
272    public void getNumActiveReturnsTheCorrectNumber() {
273      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000)) {
274        Jedis jedis = pool.getResource();
275        jedis.auth("foobared");
276        jedis.set("foo", "bar");
<span onclick='openModal()' class='match'>277        assertEquals("bar", jedis.get("foo"));
278        assertEquals(1, pool.getNumActive());
279        Jedis jedis2 = pool.getResource();
280        jedis.auth("foobared");
281        jedis.set("foo", "bar");
282        assertEquals(2, pool.getNumActive());
283        jedis.close();
284        assertEquals(1, pool.getNumActive());
</span>285        jedis2.close();
286        assertEquals(0, pool.getNumActive());
287      }
288    }
289    @Test
290    public void testAddObject() {
291      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000)) {
292        pool.addObjects(1);
293        assertEquals(1, pool.getNumIdle());
294      }
295    }
296    @Test
297    public void closeResourceTwice() {
298      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000)) {
299        Jedis j = pool.getResource();
300        j.auth("foobared");
301        j.ping();
302        j.close();
303        j.close();
304      }
305    }
306    @Test
307    public void closeBrokenResourceTwice() {
308      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000)) {
309        Jedis j = pool.getResource();
310        try {
311          j.getClient().getOne();
312          fail();
313        } catch (Exception e) {
314          assertTrue(e instanceof JedisConnectionException);
315        }
316        assertTrue(j.isBroken());
317        j.close();
318        j.close();
319      }
320    }
321    @Test
322    public void testCloseConnectionOnMakeObject() {
323      JedisPoolConfig config = new JedisPoolConfig();
324      config.setTestOnBorrow(true);
325      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), hnp.getHost(), hnp.getPort(), 2000,
326          "wrong pass"); Jedis jedis = new Jedis("redis:&bsol;&bsol;:foobared@localhost:6379/")) {
327        int currentClientCount = getClientCount(jedis.clientList());
328        try {
329          pool.getResource();
330          fail("Should throw exception as password is incorrect.");
331        } catch (Exception e) {
332          assertEquals(currentClientCount, getClientCount(jedis.clientList()));
333        }
334      }
335    }
336    private int getClientCount(final String clientList) {
337      return clientList.split("\n").length;
338    }
339    @Test
340    public void testResetInvalidCredentials() {
341      DefaultRedisCredentialsProvider credentialsProvider
342          = new DefaultRedisCredentialsProvider(new DefaultRedisCredentials(null, "foobared"));
343      JedisFactory factory = new JedisFactory(hnp, DefaultJedisClientConfig.builder()
344          .credentialsProvider(credentialsProvider).clientName("my_shiny_client_name").build());
345      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), factory)) {
346        Jedis obj1_ref;
347        try (Jedis obj1_1 = pool.getResource()) {
348          obj1_ref = obj1_1;
349          obj1_1.set("foo", "bar");
350          assertEquals("bar", obj1_1.get("foo"));
351          assertEquals(1, pool.getNumActive());
352        }
353        assertEquals(0, pool.getNumActive());
354        try (Jedis obj1_2 = pool.getResource()) {
355          assertSame(obj1_ref, obj1_2);
356          assertEquals(1, pool.getNumActive());
357          credentialsProvider.setCredentials(new DefaultRedisCredentials(null, "wrong password"));
358          try (Jedis obj2 = pool.getResource()) {
359            fail("Should not get resource from pool");
360          } catch (JedisException e) { }
361          assertEquals(1, pool.getNumActive());
362        }
363        assertEquals(0, pool.getNumActive());
364      }
365    }
366    @Test
367    public void testResetValidCredentials() {
368      DefaultRedisCredentialsProvider credentialsProvider
369          = new DefaultRedisCredentialsProvider(new DefaultRedisCredentials(null, "bad password"));
370      JedisFactory factory = new JedisFactory(hnp, DefaultJedisClientConfig.builder()
371          .credentialsProvider(credentialsProvider).clientName("my_shiny_client_name").build());
372      try (JedisPool pool = new JedisPool(new JedisPoolConfig(), factory)) {
373        try (Jedis obj1 = pool.getResource()) {
374          fail("Should not get resource from pool");
375        } catch (JedisException e) { }
376        assertEquals(0, pool.getNumActive());
377        credentialsProvider.setCredentials(new DefaultRedisCredentials(null, "foobared"));
378        try (Jedis obj2 = pool.getResource()) {
379          obj2.set("foo", "bar");
380          assertEquals("bar", obj2.get("foo"));
381        }
382      }
383    }
384  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Mybatis-PageHelper-MDEwOlJlcG9zaXRvcnkyMDY1MTY3Mg==-flat-IPageTest.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-JedisPoolTest.java</div>
                </div>
                <div class="column column_space"><pre><code>19              queryModel.setPageNum(1);
20              queryModel.setPageSize(10);
21              queryModel.setOrderBy("id desc");
22              List<User> list = userMapper.selectByQueryModel(queryModel);
23              assertEquals(10, list.size());
24              assertEquals(183, ((Page<?>) list).getTotal());
25              queryModel.setPageNum(2);
26              queryModel.setOrderBy(null);
</pre></code></div>
                <div class="column column_space"><pre><code>277        assertEquals("bar", jedis.get("foo"));
278        assertEquals(1, pool.getNumActive());
279        Jedis jedis2 = pool.getResource();
280        jedis.auth("foobared");
281        jedis.set("foo", "bar");
282        assertEquals(2, pool.getNumActive());
283        jedis.close();
284        assertEquals(1, pool.getNumActive());
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    