<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for ExecutionSequencerTest.java &amp; LinkedListMultimapTest.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for ExecutionSequencerTest.java &amp; LinkedListMultimapTest.java
      </h3>
<h1 align="center">
        21.5%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>ExecutionSequencerTest.java (22.37443%)<th>LinkedListMultimapTest.java (20.704226%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(15-39)<td><a href="#" name="0">(17-41)</a><td align="center"><font color="#ff0000">23</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(129-151)<td><a href="#" name="1">(324-335)</a><td align="center"><font color="#d20000">19</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(102-119)<td><a href="#" name="2">(207-218)</a><td align="center"><font color="#c70000">18</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(82-92)<td><a href="#" name="3">(225-234)</a><td align="center"><font color="#bc0000">17</font>
<tr onclick='openModal("#6cc417")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#6cc417"><font color="#6cc417">-</font><td><a href="#" name="4">(412-417)<td><a href="#" name="4">(248-254)</a><td align="center"><font color="#a60000">15</font>
<tr onclick='openModal("#151b8d")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#151b8d"><font color="#151b8d">-</font><td><a href="#" name="5">(68-76)<td><a href="#" name="5">(119-127)</a><td align="center"><font color="#9b0000">14</font>
<tr onclick='openModal("#8c8774")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#8c8774"><font color="#8c8774">-</font><td><a href="#" name="6">(266-273)<td><a href="#" name="6">(95-107)</a><td align="center"><font color="#900000">13</font>
<tr onclick='openModal("#38a4a5")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#38a4a5"><font color="#38a4a5">-</font><td><a href="#" name="7">(295-301)<td><a href="#" name="7">(131-136)</a><td align="center"><font color="#6e0000">10</font>
<tr onclick='openModal("#c58917")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#c58917"><font color="#c58917">-</font><td><a href="#" name="8">(240-245)<td><a href="#" name="8">(173-177)</a><td align="center"><font color="#630000">9</font>
<tr onclick='openModal("#83a33a")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#83a33a"><font color="#83a33a">-</font><td><a href="#" name="9">(222-226)<td><a href="#" name="9">(161-165)</a><td align="center"><font color="#630000">9</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>ExecutionSequencerTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>package com.google.common.util.concurrent;
2 import static com.google.common.truth.Truth.assertThat;
3 import static com.google.common.util.concurrent.Futures.allAsList;
4 import static com.google.common.util.concurrent.Futures.getDone;
5 import static com.google.common.util.concurrent.MoreExecutors.directExecutor;
6 import static java.util.concurrent.TimeUnit.SECONDS;
7 import com.google.common.annotations.GwtIncompatible;
8 import com.google.common.base.Function;
9 import com.google.common.testing.GcFinalization;
10 import com.google.common.testing.TestLogHandler;
11 import com.google.j2objc.annotations.J2ObjCIncompatible;
12 import java.lang.ref.WeakReference;
13 import java.util.ArrayList;
14 import java.util.List;
15 import java.util.concurrent.Callable;
16 import java.util.concurrent.CountDownLatch;
17 import java.util.concurrent.Executor;
18 import java.util.concurrent.ExecutorService;
19 import java.util.concurrent.Executors;
20 import java.util.concurrent.Future;
21 import java.util.concurrent.TimeUnit;
22 import java.util.logging.Logger;
23 import</b></font> junit.framework.TestCase;
24 public class ExecutionSequencerTest extends TestCase {
25   ExecutorService executor;
26   private ExecutionSequencer serializer;
27   private SettableFuture&lt;Void&gt; firstFuture;
28   private TestCallable firstCallable;
29   @Override
30   public void setUp() throws Exception {
31     executor = Executors.newCachedThreadPool();
32     serializer = ExecutionSequencer.create();
33     firstFuture = SettableFuture.create();
34     firstCallable = new TestCallable(firstFuture);
35   }
36   @Override
37   public void tearDown() throws Exception {
38     executor.shutdown();
39   }
40   public void testCallableStartsAfterFirstFutureCompletes() {
41     @SuppressWarnings({"unused", "nullness"})
42 <a name="5"></a>    Future&lt;?&gt; possiblyIgnoredError = serializer.submitAsync(firstCallable, directExecutor());
43     TestCallable secondCallable = new TestCallable(Futures.&lt;Void&gt;immediateFuture(null));
44     @SuppressWarnings({"unused", "nullness"})
45     Future&lt;?&gt; possiblyIgnoredError1 = <font color="#151b8d"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>serializer.submitAsync(secondCallable, directExecutor());
46     assertThat(firstCallable.called).isTrue();
47     assertThat(secondCallable.called).isFalse();
48     firstFuture.set(null);
49     assertThat(secondCallable.called).isTrue();
50   }
51   public void testCancellationDoesNotViolateSerialization() {
52     @SuppressWarnings({"unused", "nullness"})</b></font>
53     Future&lt;?&gt; possiblyIgnoredError = serializer.submitAsync(firstCallable, directExecutor());
54     TestCallable secondCallable = new TestCallable(Futures.&lt;Void&gt;immediateFuture(null));
55 <a name="3"></a>    ListenableFuture&lt;Void&gt; secondFuture = serializer.submitAsync(secondCallable, directExecutor());
56     TestCallable thirdCallable = new TestCallable(Futures.&lt;Void&gt;immediateFuture(null));
57     @SuppressWarnings({"unused", "nullness"})
58     Future&lt;?&gt; possiblyIgnoredError1 = <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>serializer.submitAsync(thirdCallable, directExecutor());
59     secondFuture.cancel(true);
60     assertThat(secondCallable.called).isFalse();
61     assertThat(thirdCallable.called).isFalse();
62     firstFuture.set(null);
63     assertThat(secondCallable.called).isFalse();
64     assertThat(thirdCallable.called).isTrue();
65   }
66   public void testCancellationMultipleThreads() throws Exception {
67     final BlockingCallable blockingCallable = new BlockingCallable()</b></font>;
68     ListenableFuture&lt;Void&gt; unused = serializer.submit(blockingCallable, executor);
69     ListenableFuture&lt;Boolean&gt; future2 =
70         serializer.submit(
71             new Callable&lt;Boolean&gt;() {
72               @Override
73               public Boolean call() {
74 <a name="2"></a>                return blockingCallable.isRunning();
75               }
76             },
77             <font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>directExecutor());
78     blockingCallable.waitForStart();
79     assertThat(future2.isDone()).isFalse();
80     blockingCallable.stop();
81     executor.shutdown();
82     assertThat(executor.awaitTermination(10, TimeUnit.SECONDS)).isTrue();
83     assertThat(getDone(future2)).isFalse();
84   }
85   public void testSecondTaskWaitsForFirstEvenIfCancelled() throws Exception {
86     final BlockingCallable blockingCallable = new BlockingCallable()</b></font>;
87     ListenableFuture&lt;Void&gt; future1 = serializer.submit(blockingCallable, executor);
88     ListenableFuture&lt;Boolean&gt; future2 =
89         serializer.submit(
90             new Callable&lt;Boolean&gt;() {
91               @Override
92               public Boolean call() {
93 <a name="1"></a>                return blockingCallable.isRunning();
94               }
95             },
96             <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>directExecutor());
97     blockingCallable.waitForStart();
98     future1.cancel(false);
99     assertThat(future2.isDone()).isFalse();
100     blockingCallable.stop();
101     executor.shutdown();
102     assertThat(executor.awaitTermination(10, TimeUnit.SECONDS)).isTrue();
103     assertThat(getDone(future2)).isFalse();
104   }
105   @GwtIncompatible
106   @</b></font>J2ObjCIncompatible   @AndroidIncompatible
107   public void testCancellationWithReferencedObject() throws Exception {
108     Object toBeGCed = new Object();
109     WeakReference&lt;Object&gt; ref = new WeakReference&lt;&gt;(toBeGCed);
110     final SettableFuture&lt;Void&gt; settableFuture = SettableFuture.create();
111     ListenableFuture&lt;?&gt; ignored =
112         serializer.submitAsync(
113             new AsyncCallable&lt;Void&gt;() {
114               @Override
115               public ListenableFuture&lt;Void&gt; call() {
116                 return settableFuture;
117               }
118             },
119             directExecutor());
120     serializer.submit(toStringCallable(toBeGCed), directExecutor()).cancel(true);
121     toBeGCed = null;
122     GcFinalization.awaitClear(ref);
123   }
124   private static Callable&lt;String&gt; toStringCallable(final Object object) {
125     return new Callable&lt;String&gt;() {
126       @Override
127       public String call() {
128         return object.toString();
129       }
130     };
131   }
132   public void testCancellationDuringReentrancy() throws Exception {
133     TestLogHandler logHandler = new TestLogHandler();
134     Logger.getLogger(AbstractFuture.class.getName()).addHandler(logHandler);
135     List&lt;Future&lt;?&gt;&gt; results = new ArrayList&lt;&gt;();
136     final Runnable[] manualExecutorTask = new Runnable[1];
137     Executor manualExecutor =
138         new Executor() {
139           @Override
140           public void execute(Runnable task) {
141             manualExecutorTask[0] = task;
142           }
143         };
144     results.add(serializer.submit(Callables.returning(null), manualExecutor));
145     final Future&lt;?&gt;[] thingToCancel = new Future&lt;?&gt;[1];
146     results.add(
147         serializer.submit(
148             new Callable&lt;Void&gt;() {
149               @Override
150               public Void call() {
151                 thingToCancel[0].cancel(false);
152                 return null;
153               }
154             },
155             directExecutor()));
156     thingToCancel[0] = serializer.submit(Callables.returning(null), directExecutor());
157     results.add(thingToCancel[0]);
158     for (int i = 0; i &lt; 5; i++) {
159       results.add(serializer.submit(Callables.returning(null), directExecutor()));
160     }
161     manualExecutorTask[0].run();
162     for (Future&lt;?&gt; result : results) {
163       if (!result.isCancelled()) {
164         result.get(10, SECONDS);
165       }
166 <a name="9"></a>          }
167     <font color="#83a33a"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>assertThat(logHandler.getStoredLogRecords()).isEmpty();
168   }
169   public void testAvoidsStackOverflow_manySubmitted() throws Exception {
170     final SettableFuture&lt;Void&gt; settableFuture = SettableFuture.create</b></font>();
171     ArrayList&lt;ListenableFuture&lt;Void&gt;&gt; results = new ArrayList&lt;&gt;(50_001);
172     results.add(
173         serializer.submitAsync(
174             new AsyncCallable&lt;Void&gt;() {
175               @Override
176               public ListenableFuture&lt;Void&gt; call() {
177                 return settableFuture;
178               }
179             },
180             directExecutor()));
181 <a name="8"></a>    for (int i = 0; i &lt; 50_000; i++) {
182       results.add(serializer.submit(Callables.&lt;Void&gt;returning(null), directExecutor()));
183     }
184     <font color="#c58917"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>settableFuture.set(null);
185     getDone(allAsList(results));
186   }
187   public void testAvoidsStackOverflow_manyCancelled() throws Exception {
188     final SettableFuture&lt;Void&gt; settableFuture = SettableFuture.create</b></font>();
189     ListenableFuture&lt;Void&gt; unused =
190         serializer.submitAsync(
191             new AsyncCallable&lt;Void&gt;() {
192               @Override
193               public ListenableFuture&lt;Void&gt; call() {
194                 return settableFuture;
195               }
196             },
197             directExecutor());
198     for (int i = 0; i &lt; 50_000; i++) {
199       serializer.submit(Callables.&lt;Void&gt;returning(null), directExecutor()).cancel(true);
200     }
201     ListenableFuture&lt;Integer&gt; stackDepthCheck =
202         serializer.submit(
203             new Callable&lt;Integer&gt;() {
204               @Override
205               public Integer call() {
206 <a name="6"></a>                return Thread.currentThread().getStackTrace().length;
207               }
208             },
209             <font color="#8c8774"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>directExecutor());
210     settableFuture.set(null);
211     assertThat(getDone(stackDepthCheck))
212         .isLessThan(Thread.currentThread().getStackTrace().length + 100);
213   }
214   public void testAvoidsStackOverflow_alternatingCancelledAndSubmitted() throws Exception {
215     final SettableFuture&lt;Void&gt; settableFuture = SettableFuture.create</b></font>();
216     ListenableFuture&lt;Void&gt; unused =
217         serializer.submitAsync(
218             new AsyncCallable&lt;Void&gt;() {
219               @Override
220               public ListenableFuture&lt;Void&gt; call() {
221                 return settableFuture;
222               }
223             },
224             directExecutor());
225     for (int i = 0; i &lt; 25_000; i++) {
226       serializer.submit(Callables.&lt;Void&gt;returning(null), directExecutor()).cancel(true);
227       unused = serializer.submit(Callables.&lt;Void&gt;returning(null), directExecutor());
228     }
229     ListenableFuture&lt;Integer&gt; stackDepthCheck =
230         serializer.submit(
231             new Callable&lt;Integer&gt;() {
232               @Override
233               public Integer call() {
234 <a name="7"></a>                return Thread.currentThread().getStackTrace().length;
235               }
236             },
237             <font color="#38a4a5"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>directExecutor());
238     settableFuture.set(null);
239     assertThat(getDone(stackDepthCheck))
240         .isLessThan(Thread.currentThread().getStackTrace().length + 100);
241   }
242   pri</b></font>vate static Function&lt;Integer, Integer&gt; add(final int delta) {
243     return new Function&lt;Integer, Integer&gt;() {
244       @Override
245       public Integer apply(Integer input) {
246         return input + delta;
247       }
248     };
249   }
250   private static AsyncCallable&lt;Integer&gt; asyncAdd(
251       final ListenableFuture&lt;Integer&gt; future, final int delta, final Executor executor) {
252     return new AsyncCallable&lt;Integer&gt;() {
253       @Override
254       public ListenableFuture&lt;Integer&gt; call() throws Exception {
255         return Futures.transform(future, add(delta), executor);
256       }
257     };
258   }
259   private static final class LongHolder {
260     long count;
261   }
262   private static final int ITERATION_COUNT = 50_000;
263   private static final int DIRECT_EXECUTIONS_PER_THREAD = 100;
264   @GwtIncompatible   public void testAvoidsStackOverflow_multipleThreads() throws Exception {
265     final LongHolder holder = new LongHolder();
266     final ArrayList&lt;ListenableFuture&lt;Integer&gt;&gt; lengthChecks = new ArrayList&lt;&gt;();
267     final List&lt;Integer&gt; completeLengthChecks;
268     final int baseStackDepth;
269     ExecutorService service = Executors.newFixedThreadPool(5);
270     try {
271       baseStackDepth =
272           serializer
273               .submit(
274                   new Callable&lt;Integer&gt;() {
275                     @Override
276                     public Integer call() {
277                       return Thread.currentThread().getStackTrace().length;
278                     }
279                   },
280                   service)
281               .get();
282       final SettableFuture&lt;Void&gt; settableFuture = SettableFuture.create();
283       ListenableFuture&lt;?&gt; unused =
284           serializer.submitAsync(
285               new AsyncCallable&lt;Void&gt;() {
286                 @Override
287                 public ListenableFuture&lt;Void&gt; call() {
288                   return settableFuture;
289                 }
290               },
291               directExecutor());
292       for (int i = 0; i &lt; 50_000; i++) {
293         if (i % DIRECT_EXECUTIONS_PER_THREAD == 0) {
294           unused =
295               serializer.submit(
296                   new Callable&lt;Void&gt;() {
297                     @Override
298                     public Void call() {
299                       holder.count++;
300                       return null;
301                     }
302                   },
303                   service);
304         } else if (i % DIRECT_EXECUTIONS_PER_THREAD == DIRECT_EXECUTIONS_PER_THREAD - 1) {
305           lengthChecks.add(
306               serializer.submit(
307                   new Callable&lt;Integer&gt;() {
308                     @Override
309                     public Integer call() {
310                       holder.count++;
311                       return Thread.currentThread().getStackTrace().length;
312                     }
313                   },
314                   directExecutor()));
315         } else {
316           unused =
317               serializer.submit(
318                   new Callable&lt;Void&gt;() {
319                     @Override
320                     public Void call() {
321                       holder.count++;
322                       return null;
323                     }
324                   },
325                   directExecutor());
326         }
327       }
328       settableFuture.set(null);
329       completeLengthChecks = allAsList(lengthChecks).get();
330     } finally {
331       service.shutdown();
332     }
333     assertThat(holder.count).isEqualTo(ITERATION_COUNT);
334     for (int length : completeLengthChecks) {
335       assertThat(length - baseStackDepth).isLessThan(DIRECT_EXECUTIONS_PER_THREAD / 2);
336     }
337   }
338   @SuppressWarnings("ObjectToString") <a name="4"></a>  public void testToString() {
339     Future&lt;?&gt; unused = serializer.submitAsync(firstCallable, directExecutor());
340     TestCallable secondCallable = new TestCallable(SettableFuture.&lt;Void&gt;create());
341     Future&lt;?&gt; second = <font color="#6cc417"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>serializer.submitAsync(secondCallable, directExecutor());
342     assertThat(secondCallable.called).isFalse();
343     assertThat(second.toString()).contains(secondCallable.toString());
344     firstFuture.set(null);
345     assertThat(second.toString()).contains(secondCallable.future.toString());
346   }</b></font>
347   private static class BlockingCallable implements Callable&lt;Void&gt; {
348     private final CountDownLatch startLatch = new CountDownLatch(1);
349     private final CountDownLatch stopLatch = new CountDownLatch(1);
350     private volatile boolean running = false;
351     @Override
352     public Void call() throws InterruptedException {
353       running = true;
354       startLatch.countDown();
355       stopLatch.await();
356       running = false;
357       return null;
358     }
359     public void waitForStart() throws InterruptedException {
360       startLatch.await();
361     }
362     public void stop() {
363       stopLatch.countDown();
364     }
365     public boolean isRunning() {
366       return running;
367     }
368   }
369   private static final class TestCallable implements AsyncCallable&lt;Void&gt; {
370     private final ListenableFuture&lt;Void&gt; future;
371     private boolean called = false;
372     private TestCallable(ListenableFuture&lt;Void&gt; future) {
373       this.future = future;
374     }
375     @Override
376     public ListenableFuture&lt;Void&gt; call() throws Exception {
377       called = true;
378       return future;
379     }
380   }
381 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>LinkedListMultimapTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>package com.google.common.collect;
2 import static com.google.common.collect.Lists.newArrayList;
3 import static com.google.common.collect.Sets.newHashSet;
4 import static com.google.common.collect.Sets.newLinkedHashSet;
5 import static com.google.common.collect.testing.IteratorFeature.MODIFIABLE;
6 import static com.google.common.collect.testing.IteratorFeature.SUPPORTS_REMOVE;
7 import static com.google.common.collect.testing.IteratorFeature.SUPPORTS_SET;
8 import static com.google.common.truth.Truth.assertThat;
9 import static java.util.Arrays.asList;
10 import com.google.common.annotations.GwtCompatible;
11 import com.google.common.annotations.GwtIncompatible;
12 import com.google.common.collect.testing.IteratorTester;
13 import com.google.common.collect.testing.ListIteratorTester;
14 import com.google.common.collect.testing.features.CollectionFeature;
15 import com.google.common.collect.testing.features.CollectionSize;
16 import com.google.common.collect.testing.features.MapFeature;
17 import com.google.common.collect.testing.google.ListMultimapTestSuiteBuilder;
18 import com.google.common.collect.testing.google.TestStringListMultimapGenerator;
19 import com.google.common.testing.EqualsTester;
20 import java.util.Arrays;
21 import java.util.Collection;
22 import java.util.Collections;
23 import</b></font> java.util.Iterator;
24 import java.util.List;
25 import java.util.ListIterator;
26 import java.util.Map.Entry;
27 import java.util.RandomAccess;
28 import java.util.Set;
29 import junit.framework.Test;
30 import junit.framework.TestCase;
31 import junit.framework.TestSuite;
32 @GwtCompatible(emulated = true)
33 public class LinkedListMultimapTest extends TestCase {
34   @GwtIncompatible   public static Test suite() {
35     TestSuite suite = new TestSuite();
36     suite.addTest(
37         ListMultimapTestSuiteBuilder.using(
38                 new TestStringListMultimapGenerator() {
39                   @Override
40                   protected ListMultimap&lt;String, String&gt; create(Entry&lt;String, String&gt;[] entries) {
41                     ListMultimap&lt;String, String&gt; multimap = LinkedListMultimap.create();
42                     for (Entry&lt;String, String&gt; entry : entries) {
43                       multimap.put(entry.getKey(), entry.getValue());
44                     }
45                     return multimap;
46                   }
47                 })
48             .named("LinkedListMultimap")
49             .withFeatures(
50                 MapFeature.ALLOWS_NULL_KEYS,
51                 MapFeature.ALLOWS_NULL_VALUES,
52                 MapFeature.ALLOWS_ANY_NULL_QUERIES,
53                 MapFeature.GENERAL_PURPOSE,
54                 CollectionFeature.SUPPORTS_ITERATOR_REMOVE,
55                 CollectionFeature.SERIALIZABLE,
56                 CollectionFeature.KNOWN_ORDER,
57                 CollectionSize.ANY)
58             .createTestSuite());
59     suite.addTestSuite(LinkedListMultimapTest.class);
60     return suite;
61   }
62   protected LinkedListMultimap&lt;String, Integer&gt; create() {
63     return LinkedListMultimap.create();
64   }
65 <a name="6"></a>
66   public void testGetRandomAccess() {
67     Multimap&lt;String, Integer&gt; multimap = <font color="#8c8774"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>create();
68     multimap.put("foo", 1);
69     multimap.put("foo", 3);
70     assertFalse(multimap.get("foo") instanceof RandomAccess);
71     assertFalse(multimap.get("bar") instanceof RandomAccess);
72   }
73   public void testRemoveAllRandomAccess() {
74     Multimap&lt;String, Integer&gt; multimap = create</b></font>();
75     multimap.put("foo", 1);
76     multimap.put("foo", 3);
77     assertTrue(multimap.removeAll("foo") instanceof RandomAccess);
78     assertTrue(multimap.removeAll("bar") instanceof RandomAccess);
79   }
80   public void testReplaceValuesRandomAccess() {
81     Multimap&lt;String, Integer&gt; multimap = <font color="#151b8d"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>create();
82     multimap.put("foo", 1);
83     multimap.put("foo", 3);
84     assertTrue(multimap.replaceValues("foo", Arrays.asList(2, 4)) instanceof RandomAccess);
85     assertTrue(multimap.replaceValues("bar", Arrays.asList(2, 4)) instanceof RandomAccess);
86   }
87   public void testCreateFromMultimap() {
88     Multimap&lt;String, Integer&gt; multimap = LinkedListMultimap.create()</b></font>;
89 <a name="7"></a>    multimap.put("foo", 1);
90     multimap.put("bar", 3);
91     multimap.put("foo", 2);
92     LinkedListMultimap&lt;String, Integer&gt; copy = <font color="#38a4a5"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>LinkedListMultimap.create(multimap);
93     assertEquals(multimap, copy);
94     assertThat(copy.entries()).containsExactlyElementsIn(multimap.entries()).inOrder();
95   }
96   public void testCr</b></font>eateFromSize() {
97     LinkedListMultimap&lt;String, Integer&gt; multimap = LinkedListMultimap.create(20);
98     multimap.put("foo", 1);
99     multimap.put("bar", 2);
100     multimap.put("foo", 3);
101     assertEquals(ImmutableList.of(1, 3), multimap.get("foo"));
102   }
103   public void testCreateFromIllegalSize() {
104     try {
105       LinkedListMultimap.create(-20);
106       fail();
107     } catch (IllegalArgumentException expected) {
108     }
109   }
110   public void testLinkedGetAdd() {
111     LinkedListMultimap&lt;String, Integer&gt; map = create();
112     map.put("bar", 1);
113     Collection&lt;Integer&gt; foos = map.get("foo");
114     foos.add(2);
115     foos.add(3);
116 <a name="9"></a>    map.put("bar", 4);
117     map.put("foo", 5);
118     assertEquals("{bar=[1, 4], foo=[2, 3, 5]}", map.toString());
119     <font color="#83a33a"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>assertEquals("[bar=1, foo=2, foo=3, bar=4, foo=5]", map.entries().toString());
120   }
121   public void testLinkedGetInsert() {
122     ListMultimap&lt;String, Integer&gt; map = create</b></font>();
123     map.put("bar", 1);
124     List&lt;Integer&gt; foos = map.get("foo");
125     foos.add(2);
126     foos.add(0, 3);
127 <a name="8"></a>    map.put("bar", 4);
128     map.put("foo", 5);
129     assertEquals("{bar=[1, 4], foo=[3, 2, 5]}", map.toString());
130     <font color="#c58917"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>assertEquals("[bar=1, foo=3, foo=2, bar=4, foo=5]", map.entries().toString());
131   }
132   public void testLinkedPutInOrder() {
133     Multimap&lt;String, Integer&gt; map = create</b></font>();
134     map.put("foo", 1);
135     map.put("bar", 2);
136     map.put("bar", 3);
137     assertEquals("{foo=[1], bar=[2, 3]}", map.toString());
138     assertEquals("[foo=1, bar=2, bar=3]", map.entries().toString());
139   }
140   public void testLinkedPutOutOfOrder() {
141     Multimap&lt;String, Integer&gt; map = create();
142     map.put("bar", 1);
143     map.put("foo", 2);
144     map.put("bar", 3);
145     assertEquals("{bar=[1, 3], foo=[2]}", map.toString());
146     assertEquals("[bar=1, foo=2, bar=3]", map.entries().toString());
147   }
148   public void testLinkedPutAllMultimap() {
149     Multimap&lt;String, Integer&gt; src = create();
150     src.put("bar", 1);
151     src.put("foo", 2);
152     src.put("bar", 3);
153     Multimap&lt;String, Integer&gt; dst = create();
154     dst.putAll(src);
155     assertEquals("{bar=[1, 3], foo=[2]}", dst.toString());
156     assertEquals("[bar=1, foo=2, bar=3]", src.entries().toString());
157   }
158 <a name="2"></a>
159   public void testLinkedReplaceValues() {
160     Multimap&lt;String, Integer&gt; map = create();
161     <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>map.put("bar", 1);
162     map.put("foo", 2);
163     map.put("bar", 3);
164     map.put("bar", 4);
165     assertEquals("{bar=[1, 3, 4], foo=[2]}", map.toString());
166     map.replaceValues("bar", asList(1, 2));
167     assertEquals("[bar=1, foo=2, bar=2]", map.entries().toString());
168     assertEquals("{bar=[1, 2], foo=[2]}", map.toString());
169   }
170   public void testLinkedClear() {
171     ListMultimap&lt;String, Integer&gt; map = create()</b></font>;
172     map.put("foo", 1);
173     map.put("foo", 2);
174     map.put("bar", 3);
175 <a name="3"></a>    List&lt;Integer&gt; foos = map.get("foo");
176     Collection&lt;Integer&gt; values = map.values();
177     assertEquals(asList(1, 2), foos);
178     <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>assertThat(values).containsExactly(1, 2, 3).inOrder();
179     map.clear();
180     assertEquals(Collections.emptyList(), foos);
181     assertThat(values).isEmpty();
182     assertEquals("[]", map.entries().toString());
183     assertEquals("{}", map.toString());
184   }
185   public void testLinkedKeySet() {
186     Multimap&lt;String, Integer&gt; map = create()</b></font>;
187     map.put("bar", 1);
188     map.put("foo", 2);
189     map.put("bar", 3);
190     map.put("bar", 4);
191     assertEquals("[bar, foo]", map.keySet().toString());
192     map.keySet().remove("bar");
193     assertEquals("{foo=[2]}", map.toString());
194   }
195   public void testLinkedKeys() {
196 <a name="4"></a>    Multimap&lt;String, Integer&gt; map = create();
197     map.put("bar", 1);
198     map.put("foo", 2);
199     <font color="#6cc417"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>map.put("bar", 3);
200     map.put("bar", 4);
201     assertEquals("[bar=1, foo=2, bar=3, bar=4]", map.entries().toString());
202     assertThat(map.keys()).containsExactly("bar", "foo", "bar", "bar").inOrder();
203     map.keys().remove("bar");     assertEquals("{foo=[2], bar=[3, 4]}", map.toString());
204   }</b></font>
205   public void testLinkedValues() {
206     Multimap&lt;String, Integer&gt; map = create();
207     map.put("bar", 1);
208     map.put("foo", 2);
209     map.put("bar", 3);
210     map.put("bar", 4);
211     assertEquals("[1, 2, 3, 4]", map.values().toString());
212     map.values().remove(2);
213     assertEquals("{bar=[1, 3, 4]}", map.toString());
214   }
215   public void testLinkedEntries() {
216     Multimap&lt;String, Integer&gt; map = create();
217     map.put("bar", 1);
218     map.put("foo", 2);
219     map.put("bar", 3);
220     Iterator&lt;Entry&lt;String, Integer&gt;&gt; entries = map.entries().iterator();
221     Entry&lt;String, Integer&gt; entry = entries.next();
222     assertEquals("bar", entry.getKey());
223     assertEquals(1, (int) entry.getValue());
224     entry = entries.next();
225     assertEquals("foo", entry.getKey());
226     assertEquals(2, (int) entry.getValue());
227     entry.setValue(4);
228     entry = entries.next();
229     assertEquals("bar", entry.getKey());
230     assertEquals(3, (int) entry.getValue());
231     assertFalse(entries.hasNext());
232     entries.remove();
233     assertEquals("{bar=[1], foo=[4]}", map.toString());
234   }
235   public void testLinkedAsMapEntries() {
236     Multimap&lt;String, Integer&gt; map = create();
237     map.put("bar", 1);
238     map.put("foo", 2);
239     map.put("bar", 3);
240     Iterator&lt;Entry&lt;String, Collection&lt;Integer&gt;&gt;&gt; entries = map.asMap().entrySet().iterator();
241     Entry&lt;String, Collection&lt;Integer&gt;&gt; entry = entries.next();
242     assertEquals("bar", entry.getKey());
243     assertThat(entry.getValue()).containsExactly(1, 3).inOrder();
244     try {
245       entry.setValue(Arrays.&lt;Integer&gt;asList());
246       fail("UnsupportedOperationException expected");
247     } catch (UnsupportedOperationException expected) {
248     }
249     entries.remove();     entry = entries.next();
250     assertEquals("foo", entry.getKey());
251     assertThat(entry.getValue()).contains(2);
252     assertFalse(entries.hasNext());
253     assertEquals("{foo=[2]}", map.toString());
254   }
255   public void testEntriesAfterMultimapUpdate() {
256     ListMultimap&lt;String, Integer&gt; multimap = create();
257     multimap.put("foo", 2);
258     multimap.put("bar", 3);
259     Collection&lt;Entry&lt;String, Integer&gt;&gt; entries = multimap.entries();
260     Iterator&lt;Entry&lt;String, Integer&gt;&gt; iterator = entries.iterator();
261     Entry&lt;String, Integer&gt; entrya = iterator.next();
262     Entry&lt;String, Integer&gt; entryb = iterator.next();
263     assertEquals(2, (int) multimap.get("foo").set(0, 4));
264     assertFalse(multimap.containsEntry("foo", 2));
265 <a name="1"></a>    assertTrue(multimap.containsEntry("foo", 4));
266     assertTrue(multimap.containsEntry("bar", 3));
267     assertEquals(4, (int) entrya.getValue());
268     <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>assertEquals(3, (int) entryb.getValue());
269     assertTrue(multimap.put("foo", 5));
270     assertTrue(multimap.containsEntry("foo", 5));
271     assertTrue(multimap.containsEntry("foo", 4));
272     assertTrue(multimap.containsEntry("bar", 3));
273     assertEquals(4, (int) entrya.getValue());
274     assertEquals(3, (int) entryb.getValue());
275   }
276   @SuppressWarnings("unchecked")
277   @</b></font>GwtIncompatible   public void testEntriesIteration() {
278     List&lt;Entry&lt;String, Integer&gt;&gt; addItems =
279         ImmutableList.of(
280             Maps.immutableEntry("foo", 99),
281             Maps.immutableEntry("foo", 88),
282             Maps.immutableEntry("bar", 77));
283     for (final int startIndex : new int[] {0, 3, 5}) {
284       List&lt;Entry&lt;String, Integer&gt;&gt; list =
285           Lists.newArrayList(
286               Maps.immutableEntry("foo", 2),
287               Maps.immutableEntry("foo", 3),
288               Maps.immutableEntry("bar", 4),
289               Maps.immutableEntry("bar", 5),
290               Maps.immutableEntry("foo", 6));
291       new ListIteratorTester&lt;Entry&lt;String, Integer&gt;&gt;(
292           3, addItems, ImmutableList.of(SUPPORTS_REMOVE), list, startIndex) {
293         private LinkedListMultimap&lt;String, Integer&gt; multimap;
294         @Override
295         protected ListIterator&lt;Entry&lt;String, Integer&gt;&gt; newTargetIterator() {
296           multimap = create();
297           multimap.putAll("foo", asList(2, 3));
298           multimap.putAll("bar", asList(4, 5));
299           multimap.put("foo", 6);
300           return multimap.entries().listIterator(startIndex);
301         }
302         @Override
303         protected void verify(List&lt;Entry&lt;String, Integer&gt;&gt; elements) {
304           assertEquals(elements, multimap.entries());
305         }
306       }.test();
307     }
308   }
309   @GwtIncompatible   public void testKeysIteration() {
310     new IteratorTester&lt;String&gt;(
311         6,
312         MODIFIABLE,
313         newArrayList("foo", "foo", "bar", "bar", "foo"),
314         IteratorTester.KnownOrder.KNOWN_ORDER) {
315       private Multimap&lt;String, Integer&gt; multimap;
316       @Override
317       protected Iterator&lt;String&gt; newTargetIterator() {
318         multimap = create();
319         multimap.putAll("foo", asList(2, 3));
320         multimap.putAll("bar", asList(4, 5));
321         multimap.putAll("foo", asList(6));
322         return multimap.keys().iterator();
323       }
324       @Override
325       protected void verify(List&lt;String&gt; elements) {
326         assertEquals(elements, Lists.newArrayList(multimap.keys()));
327       }
328     }.test();
329   }
330   @GwtIncompatible   public void testValuesIteration() {
331     List&lt;Integer&gt; addItems = ImmutableList.of(99, 88, 77);
332     for (final int startIndex : new int[] {0, 3, 5}) {
333       new ListIteratorTester&lt;Integer&gt;(
334           3,
335           addItems,
336           ImmutableList.of(SUPPORTS_REMOVE, SUPPORTS_SET),
337           Lists.newArrayList(2, 3, 4, 5, 6),
338           startIndex) {
339         private LinkedListMultimap&lt;String, Integer&gt; multimap;
340         @Override
341         protected ListIterator&lt;Integer&gt; newTargetIterator() {
342           multimap = create();
343           multimap.put("bar", 2);
344           multimap.putAll("foo", Arrays.asList(3, 4));
345           multimap.put("bar", 5);
346           multimap.put("foo", 6);
347           return multimap.values().listIterator(startIndex);
348         }
349         @Override
350         protected void verify(List&lt;Integer&gt; elements) {
351           assertEquals(elements, multimap.values());
352         }
353       }.test();
354     }
355   }
356   @GwtIncompatible   public void testKeySetIteration() {
357     new IteratorTester&lt;String&gt;(
358         6,
359         MODIFIABLE,
360         newLinkedHashSet(asList("foo", "bar", "baz", "dog", "cat")),
361         IteratorTester.KnownOrder.KNOWN_ORDER) {
362       private Multimap&lt;String, Integer&gt; multimap;
363       @Override
364       protected Iterator&lt;String&gt; newTargetIterator() {
365         multimap = create();
366         multimap.putAll("foo", asList(2, 3));
367         multimap.putAll("bar", asList(4, 5));
368         multimap.putAll("foo", asList(6));
369         multimap.putAll("baz", asList(7, 8));
370         multimap.putAll("dog", asList(9));
371         multimap.putAll("bar", asList(10, 11));
372         multimap.putAll("cat", asList(12, 13, 14));
373         return multimap.keySet().iterator();
374       }
375       @Override
376       protected void verify(List&lt;String&gt; elements) {
377         assertEquals(newHashSet(elements), multimap.keySet());
378       }
379     }.test();
380   }
381   @SuppressWarnings("unchecked")
382   @GwtIncompatible   public void testAsSetIteration() {
383     Set&lt;Entry&lt;String, Collection&lt;Integer&gt;&gt;&gt; set =
384         Sets.newLinkedHashSet(
385             asList(
386                 Maps.immutableEntry("foo", (Collection&lt;Integer&gt;) asList(2, 3, 6)),
387                 Maps.immutableEntry("bar", (Collection&lt;Integer&gt;) asList(4, 5, 10, 11)),
388                 Maps.immutableEntry("baz", (Collection&lt;Integer&gt;) asList(7, 8)),
389                 Maps.immutableEntry("dog", (Collection&lt;Integer&gt;) asList(9)),
390                 Maps.immutableEntry("cat", (Collection&lt;Integer&gt;) asList(12, 13, 14))));
391     new IteratorTester&lt;Entry&lt;String, Collection&lt;Integer&gt;&gt;&gt;(
392         6, MODIFIABLE, set, IteratorTester.KnownOrder.KNOWN_ORDER) {
393       private Multimap&lt;String, Integer&gt; multimap;
394       @Override
395       protected Iterator&lt;Entry&lt;String, Collection&lt;Integer&gt;&gt;&gt; newTargetIterator() {
396         multimap = create();
397         multimap.putAll("foo", asList(2, 3));
398         multimap.putAll("bar", asList(4, 5));
399         multimap.putAll("foo", asList(6));
400         multimap.putAll("baz", asList(7, 8));
401         multimap.putAll("dog", asList(9));
402         multimap.putAll("bar", asList(10, 11));
403         multimap.putAll("cat", asList(12, 13, 14));
404         return multimap.asMap().entrySet().iterator();
405       }
406       @Override
407       protected void verify(List&lt;Entry&lt;String, Collection&lt;Integer&gt;&gt;&gt; elements) {
408         assertEquals(newHashSet(elements), multimap.asMap().entrySet());
409       }
410     }.test();
411   }
412   public void testEquals() {
413     new EqualsTester()
414         .addEqualityGroup(
415             LinkedListMultimap.create(), LinkedListMultimap.create(), LinkedListMultimap.create(1))
416         .testEquals();
417   }
418 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
