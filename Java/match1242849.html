<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><head><title>Matches for DateFormatFunction.java &amp; UsersPrivilegesMetadata.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for DateFormatFunction.java &amp; UsersPrivilegesMetadata.java
      </h3>
<h1 align="center">
        14.5%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>DateFormatFunction.java (44.628098%)<th>UsersPrivilegesMetadata.java (8.723748%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(44-71)<td><a href="#" name="0">(316-320)</a><td align="center"><font color="#ff0000">17</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(115-126)<td><a href="#" name="1">(383-394)</a><td align="center"><font color="#e10000">15</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(24-38)<td><a href="#" name="2">(38-51)</a><td align="center"><font color="#b40000">12</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(83-88)<td><a href="#" name="3">(66-79)</a><td align="center"><font color="#960000">10</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>DateFormatFunction.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
/*
 * Licensed to Crate.io GmbH ("Crate") under one or more contributor
 * license agreements.  See the NOTICE file distributed with this work for
 * additional information regarding copyright ownership.  Crate licenses
 * this file to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.  You may
 * obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations
 * under the License.
 *
 * However, if you have executed another commercial license agreement
 * with Crate these terms will supersede the license and you may use the
 * software solely pursuant to the terms of the relevant commercial agreement.
 */
<a name="2"></a>
package io.crate.expression.scalar;

<font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>import io.crate.data.Input;
import io.crate.metadata.NodeContext;
import io.crate.metadata.Scalar;
import io.crate.metadata.TransactionContext;
import io.crate.metadata.functions.Signature;
import io.crate.types.DataType;
import io.crate.types.DataTypes;
import org.joda.time.DateTime;
import org.joda.time.DateTimeZone;

import java.util.List;

public class DateFormatFunction extends Scalar&lt;String, Object&gt; {

    public static final String NAME = "date_format"</b></font>;
    public static final String DEFAULT_FORMAT = "%Y-%m-%dT%H:%i:%s.%fZ";

<a name="0"></a>    public static void register(ScalarFunctionModule module) {
        List&lt;DataType&lt;?&gt;&gt; supportedTimestampTypes = List.of(
            DataTypes.TIMESTAMPZ, DataTypes.TIMESTAMP, DataTypes.LONG);
        for (<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>DataType&lt;?&gt; dataType : supportedTimestampTypes) {
            // without format
            module.register(
                Signature.scalar(
                    NAME,
                    dataType.getTypeSignature(),
                    DataTypes.STRING.getTypeSignature()
                ), DateFormatFunction::new
            );

            // with format
            module.register(
                Signature.scalar(
                    NAME,
                    DataTypes.STRING.getTypeSignature(),
                    dataType.getTypeSignature(),
                    DataTypes.STRING.getTypeSignature()
                ), DateFormatFunction::new
            );

            // time zone aware variant
            module.register(
                Signature.scalar(
                    NAME,
                    DataTypes.STRING.getTypeSignature(),
                    DataTypes.STRING.getTypeSignature(),
                    dataType.getTypeSignature(),
                    DataTypes.STRING.getTypeSignature</b></font>()
                ), DateFormatFunction::new
            );
        }
    }

    private final Signature signature;
    private final Signature boundSignature;

<a name="3"></a>    public DateFormatFunction(Signature signature, Signature boundSignature) {
        this.signature = signature;
        this.boundSignature = boundSignature;
    <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}

    @Override
    public String evaluate(TransactionContext txnCtx, NodeContext nodeCtx, Input&lt;Object&gt;... args) {
        String format;
        Input&lt;?&gt; timezoneLiteral = null</b></font>;
        if (args.length == 1) {
            format = DEFAULT_FORMAT;
        } else {
            format = (String) args[0].value();
            if (format == null) {
                return null;
            }
            if (args.length == 3) {
                timezoneLiteral = args[1];
            }
        }
        Object tsValue = args[args.length - 1].value();
        if (tsValue == null) {
            return null;
        }
        Long timestamp = DataTypes.TIMESTAMPZ.sanitizeValue(tsValue);
        DateTimeZone timezone = DateTimeZone.UTC;
        if (timezoneLiteral != null) {
            Object timezoneValue = timezoneLiteral.value();
            if (timezoneValue == null) {
                return null;
            }
            timezone = TimeZoneParser.parseTimeZone((String) timezoneValue);
<a name="1"></a>        }
        DateTime dateTime = new DateTime(timestamp, timezone);
        return TimestampFormatter.format(format, dateTime);
    <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}

    @Override
    public Signature signature() {
        return signature;
    }

    @Override
    public Signature boundSignature() {
        return boundSignature;
    }
}</b></font>
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>UsersPrivilegesMetadata.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
/*
 * Licensed to Crate.io GmbH ("Crate") under one or more contributor
 * license agreements.  See the NOTICE file distributed with this work for
 * additional information regarding copyright ownership.  Crate licenses
 * this file to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.  You may
 * obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations
 * under the License.
 *
 * However, if you have executed another commercial license agreement
 * with Crate these terms will supersede the license and you may use the
 * software solely pursuant to the terms of the relevant commercial agreement.
 */

package io.crate.user.metadata;

import io.crate.common.annotations.VisibleForTesting;
import io.crate.user.Privilege;
import io.crate.user.Privilege.State;
import io.crate.metadata.RelationName;
import io.crate.user.PrivilegeIdent;
import org.elasticsearch.ElasticsearchParseException;
import org.elasticsearch.Version;
import org.elasticsearch.cluster.AbstractNamedDiffable;
import org.elasticsearch.cluster.metadata.Metadata;
import org.elasticsearch.common.io.stream.StreamInput;
import org.elasticsearch.common.io.stream.StreamOutput;
<a name="2"></a>import org.elasticsearch.common.xcontent.XContentBuilder;
import org.elasticsearch.common.xcontent.XContentParser;

<font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>import javax.annotation.Nullable;
import java.io.IOException;
import java.util.Collection;
import java.util.EnumSet;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Iterator;
import java.util.Map;
import java.util.Objects;
import java.util.Set;

public class UsersPrivilegesMetadata extends AbstractNamedDiffable&lt;Metadata.Custom&gt; implements Metadata.Custom {

    public static final String TYPE = "users_privileges"</b></font>;

    /**
     * Returns a copy of {@link UsersPrivilegesMetadata} including a copied list of privileges.
     */
    public static UsersPrivilegesMetadata copyOf(@Nullable UsersPrivilegesMetadata oldMetadata) {
        if (oldMetadata == null) {
            return new UsersPrivilegesMetadata();
        }

        Map&lt;String, Set&lt;Privilege&gt;&gt; userPrivileges = new HashMap&lt;&gt;(oldMetadata.usersPrivileges.size());
        for (Map.Entry&lt;String, Set&lt;Privilege&gt;&gt; entry : oldMetadata.usersPrivileges.entrySet()) {
<a name="3"></a>            userPrivileges.put(entry.getKey(), new HashSet&lt;&gt;(entry.getValue()));
        }
        return new UsersPrivilegesMetadata(userPrivileges);
    <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}

    /**
     * Returns a copy of the {@link UsersPrivilegesMetadata} including a copied list of privileges if at least one
     * privilege was replaced. Otherwise returns the NULL to indicate that nothing was changed.
     * Privileges of class {@link Privilege.Clazz#TABLE} whose idents are matching the given source ident are replaced
     * by a copy where the ident is changed to the given target ident.
     */
    @Nullable
    public static UsersPrivilegesMetadata maybeCopyAndReplaceTableIdents(UsersPrivilegesMetadata oldMetadata,
                                                                         String sourceIdent,
                                                                         String targetIdent) {
        boolean privilegesChanged = false;
        Map&lt;String, Set&lt;Privilege&gt;&gt; userPrivileges = new HashMap&lt;&gt;(oldMetadata.usersPrivileges.size())</b></font>;
        for (Map.Entry&lt;String, Set&lt;Privilege&gt;&gt; entry : oldMetadata.usersPrivileges.entrySet()) {
            Set&lt;Privilege&gt; privileges = new HashSet&lt;&gt;(entry.getValue().size());
            for (Privilege privilege : entry.getValue()) {
                PrivilegeIdent privilegeIdent = privilege.ident();
                if (privilegeIdent.clazz().equals(Privilege.Clazz.TABLE) == false) {
                    privileges.add(privilege);
                    continue;
                }

                String ident = privilegeIdent.ident();
                assert ident != null : "ident must not be null for privilege class 'TABLE'";
                if (ident.equals(sourceIdent)) {
                    privileges.add(new Privilege(privilege.state(), privilegeIdent.type(), privilegeIdent.clazz(),
                        targetIdent, privilege.grantor()));
                    privilegesChanged = true;
                } else {
                    privileges.add(privilege);
                }
            }
            userPrivileges.put(entry.getKey(), privileges);
        }

        if (privilegesChanged) {
            return new UsersPrivilegesMetadata(userPrivileges);
        }
        return null;
    }

    private final Map&lt;String, Set&lt;Privilege&gt;&gt; usersPrivileges;

    @VisibleForTesting
    public UsersPrivilegesMetadata() {
        usersPrivileges = new HashMap&lt;&gt;();
    }

    @VisibleForTesting
    public UsersPrivilegesMetadata(Map&lt;String, Set&lt;Privilege&gt;&gt; usersPrivileges) {
        this.usersPrivileges = usersPrivileges;
    }

    public static UsersPrivilegesMetadata swapPrivileges(UsersPrivilegesMetadata usersPrivileges,
                                                         RelationName source,
                                                         RelationName target) {
        HashMap&lt;String, Set&lt;Privilege&gt;&gt; privilegesByUser = new HashMap&lt;&gt;();
        for (Map.Entry&lt;String, Set&lt;Privilege&gt;&gt; userPrivileges : usersPrivileges.usersPrivileges.entrySet()) {
            String user = userPrivileges.getKey();
            Set&lt;Privilege&gt; privileges = userPrivileges.getValue();
            Set&lt;Privilege&gt; updatedPrivileges = new HashSet&lt;&gt;();
            for (Privilege privilege : privileges) {
                PrivilegeIdent ident = privilege.ident();
                if (ident.clazz() == Privilege.Clazz.TABLE) {
                    if (source.fqn().equals(ident.ident())) {
                        updatedPrivileges.add(
                            new Privilege(privilege.state(), ident.type(), ident.clazz(), target.fqn(), privilege.grantor()));
                    } else if (target.fqn().equals(ident.ident())) {
                        updatedPrivileges.add(
                            new Privilege(privilege.state(), ident.type(), ident.clazz(), source.fqn(), privilege.grantor()));
                    } else {
                        updatedPrivileges.add(privilege);
                    }
                } else {
                    updatedPrivileges.add(privilege);
                }
            }
            privilegesByUser.put(user, updatedPrivileges);
        }
        return new UsersPrivilegesMetadata(privilegesByUser);
    }

    /**
     * Applies the provided privileges to the specified users.
     *
     * NOTE: the provided privileges collection will be mutated
     *
     * @return the number of affected privileges (doesn't count no-ops eg. granting a privilege a user already has)
     */
    public long applyPrivileges(Collection&lt;String&gt; userNames, Iterable&lt;Privilege&gt; newPrivileges) {
        long affectedPrivileges = 0L;
        for (String userName : userNames) {
            affectedPrivileges += applyPrivilegesToUser(userName, newPrivileges);
        }
        return affectedPrivileges;
    }

    private long applyPrivilegesToUser(String userName, Iterable&lt;Privilege&gt; newPrivileges) {
        Set&lt;Privilege&gt; userPrivileges = usersPrivileges.get(userName);
        // privileges set is expected, it must be created on user creation
        assert userPrivileges != null : "privileges must not be null for user=" + userName;

        long affectedCount = 0L;
        for (Privilege newPrivilege : newPrivileges) {
            Iterator&lt;Privilege&gt; iterator = userPrivileges.iterator();
            boolean userHadPrivilegeOnSameObject = false;
            while (iterator.hasNext()) {
                Privilege userPrivilege = iterator.next();
                PrivilegeIdent privilegeIdent = userPrivilege.ident();
                if (privilegeIdent.equals(newPrivilege.ident())) {
                    userHadPrivilegeOnSameObject = true;
                    if (newPrivilege.state().equals(State.REVOKE)) {
                        iterator.remove();
                        affectedCount++;
                        break;
                    } else {
                        // we only want to process a new GRANT/DENY privilege if the user doesn't already have it
                        if (userPrivilege.equals(newPrivilege) == false) {
                            iterator.remove();
                            userPrivileges.add(newPrivilege);
                            affectedCount++;
                        }
                        break;
                    }
                }
            }

            if (userHadPrivilegeOnSameObject == false &amp;&amp; newPrivilege.state().equals(State.REVOKE) == false) {
                // revoking a privilege that was not granted is a no-op
                affectedCount++;
                userPrivileges.add(newPrivilege);
            }
        }

        return affectedCount;
    }

    public long dropTableOrViewPrivileges(String tableOrViewIdent) {
        long affectedPrivileges = 0L;
        for (Set&lt;Privilege&gt; privileges : usersPrivileges.values()) {
            Iterator&lt;Privilege&gt; privilegeIterator = privileges.iterator();
            while (privilegeIterator.hasNext()) {
                Privilege privilege = privilegeIterator.next();
                PrivilegeIdent privilegeIdent = privilege.ident();
                Privilege.Clazz clazz = privilegeIdent.clazz();
                if (clazz.equals(Privilege.Clazz.TABLE) == false &amp;&amp; clazz.equals(Privilege.Clazz.VIEW) == false) {
                    continue;
                }

                String ident = privilegeIdent.ident();
                assert ident != null : "ident must not be null for privilege class 'TABLE'";
                if (ident.equals(tableOrViewIdent)) {
                    privilegeIterator.remove();
                    affectedPrivileges++;
                }
            }
        }
        return affectedPrivileges;
    }

    @Nullable
    public Set&lt;Privilege&gt; getUserPrivileges(String userName) {
        return usersPrivileges.get(userName);
    }

    public void createPrivileges(String userName, Set&lt;Privilege&gt; privileges) {
        usersPrivileges.put(userName, privileges);
    }

    public void dropPrivileges(String userName) {
        usersPrivileges.remove(userName);
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        UsersPrivilegesMetadata that = (UsersPrivilegesMetadata) o;
        return Objects.equals(usersPrivileges, that.usersPrivileges);
    }

    @Override
    public int hashCode() {
        return Objects.hash(usersPrivileges);
    }

    public UsersPrivilegesMetadata(StreamInput in) throws IOException {
        int numUsersPrivileges = in.readVInt();
        usersPrivileges = new HashMap&lt;&gt;(numUsersPrivileges);
        for (int i = 0; i &lt; numUsersPrivileges; i++) {
            String userName = in.readString();
            int numPrivileges = in.readVInt();
            Set&lt;Privilege&gt; privileges = new HashSet&lt;&gt;(numPrivileges);
            for (int j = 0; j &lt; numPrivileges; j++) {
                privileges.add(new Privilege(in));
            }
            usersPrivileges.put(userName, privileges);
        }
    }

    @Override
    public void writeTo(StreamOutput out) throws IOException {
        out.writeVInt(usersPrivileges.size());
        for (Map.Entry&lt;String, Set&lt;Privilege&gt;&gt; entry : usersPrivileges.entrySet()) {
            out.writeString(entry.getKey());
            out.writeVInt(entry.getValue().size());
            for (Privilege privilege : entry.getValue()) {
                privilege.writeTo(out);
            }
        }
    }

    @Override
    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {
        for (Map.Entry&lt;String, Set&lt;Privilege&gt;&gt; entry : usersPrivileges.entrySet()) {
            builder.startArray(entry.getKey());
            for (Privilege privilege : entry.getValue()) {
                privilegeToXContent(privilege, builder);
            }
            builder.endArray();
        }

        return builder;
    }

    public static UsersPrivilegesMetadata fromXContent(XContentParser parser) throws IOException {
        UsersPrivilegesMetadata metadata = new UsersPrivilegesMetadata();
        while (parser.nextToken() == XContentParser.Token.FIELD_NAME) {
            String userName = parser.currentName();
            Set&lt;Privilege&gt; privileges = metadata.getUserPrivileges(userName);
            if (privileges == null) {
                privileges = new HashSet&lt;&gt;();
                metadata.createPrivileges(userName, privileges);
            }
            XContentParser.Token token;
            while ((token = parser.nextToken()) != XContentParser.Token.END_ARRAY) {
                if (token == XContentParser.Token.START_OBJECT) {
                    privilegeFromXContent(parser, privileges);
                }
            }
        }
        return metadata;
    }

    @Override
    public EnumSet&lt;Metadata.XContentContext&gt; context() {
<a name="0"></a>        return EnumSet.of(Metadata.XContentContext.GATEWAY, Metadata.XContentContext.SNAPSHOT);
    }

    private static void privilegeToXContent(Privilege privilege, <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>XContentBuilder builder) throws IOException {
        builder.startObject()
            .field("state", privilege.state().ordinal())
            .field("type", privilege.ident().type().ordinal())
            .field("class", privilege.ident</b></font>().clazz().ordinal())
            .field("ident", privilege.ident().ident())
            .field("grantor", privilege.grantor())
            .endObject();
    }

    private static void privilegeFromXContent(XContentParser parser, Set&lt;Privilege&gt; privileges) throws IOException {
        XContentParser.Token currentToken;
        State state = null;
        Privilege.Type type = null;
        Privilege.Clazz clazz = null;
        String ident = null;
        String grantor = null;
        while ((currentToken = parser.nextToken()) != XContentParser.Token.END_OBJECT) {
            if (currentToken == XContentParser.Token.FIELD_NAME) {
                String currentFieldName = parser.currentName();
                currentToken = parser.nextToken();
                switch (currentFieldName) {
                    case "state":
                        if (currentToken != XContentParser.Token.VALUE_NUMBER) {
                            throw new ElasticsearchParseException(
                                "failed to parse privilege, 'state' value is not a number [{}]", currentToken);
                        }
                        state = State.values()[parser.intValue()];
                        break;
                    case "type":
                        if (currentToken != XContentParser.Token.VALUE_NUMBER) {
                            throw new ElasticsearchParseException(
                                "failed to parse privilege, 'type' value is not a number [{}]", currentToken);
                        }
                        type = Privilege.Type.values()[parser.intValue()];
                        break;
                    case "class":
                        if (currentToken != XContentParser.Token.VALUE_NUMBER) {
                            throw new ElasticsearchParseException(
                                "failed to parse privilege, 'class' value is not a number [{}]", currentToken);
                        }
                        clazz = Privilege.Clazz.values()[parser.intValue()];
                        break;
                    case "ident":
                        if (currentToken != XContentParser.Token.VALUE_STRING
                            &amp;&amp; currentToken != XContentParser.Token.VALUE_NULL) {
                            throw new ElasticsearchParseException(
                                "failed to parse privilege, 'ident' value is not a string or null [{}]", currentToken);
                        }
                        ident = parser.textOrNull();
                        break;
                    case "grantor":
                        if (currentToken != XContentParser.Token.VALUE_STRING) {
                            throw new ElasticsearchParseException(
                                "failed to parse privilege, 'grantor' value is not a string [{}]", currentToken);
                        }
                        grantor = parser.text();
                        break;
                    default:
                        throw new ElasticsearchParseException("failed to parse privilege");
                }
            } else if (currentToken == XContentParser.Token.END_ARRAY) {
                // empty privileges set
                return;
<a name="1"></a>            }
        }
        privileges.add(new Privilege(state, type, clazz, ident, grantor));
    <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}

    @Override
    public String getWriteableName() {
        return TYPE;
    }

    @Override
    public Version getMinimalSupportedVersion() {
        return Version.V_3_0_1;
    }
}</b></font>
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerHTML.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
