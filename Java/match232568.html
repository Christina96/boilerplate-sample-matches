<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for MultisetRemoveTester_1.java & OrderingTest_1.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for MultisetRemoveTester_1.java & OrderingTest_1.java
      </h3>
      <h1 align="center">
        19.0%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>MultisetRemoveTester_1.java (69.85294%)<TH>OrderingTest_1.java (11.0529375%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#0',2,'match232568-1.html#0',3)" NAME="0">(19-44)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#0',2,'match232568-1.html#0',3)" NAME="0">(28-51)</A><TD ALIGN=center><FONT COLOR="#ff0000">20</FONT>
<TR><TD BGCOLOR="#f63526"><FONT COLOR="#f63526">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#1',2,'match232568-1.html#1',3)" NAME="1">(101-107)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#1',2,'match232568-1.html#1',3)" NAME="1">(274-293)</A><TD ALIGN=center><FONT COLOR="#cc0000">16</FONT>
<TR><TD BGCOLOR="#980517"><FONT COLOR="#980517">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#2',2,'match232568-1.html#2',3)" NAME="2">(89-100)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#2',2,'match232568-1.html#2',3)" NAME="2">(476-483)</A><TD ALIGN=center><FONT COLOR="#cc0000">16</FONT>
<TR><TD BGCOLOR="#53858b"><FONT COLOR="#53858b">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#3',2,'match232568-1.html#3',3)" NAME="3">(162-170)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#3',2,'match232568-1.html#3',3)" NAME="3">(521-529)</A><TD ALIGN=center><FONT COLOR="#bf0000">15</FONT>
<TR><TD BGCOLOR="#6cc417"><FONT COLOR="#6cc417">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#4',2,'match232568-1.html#4',3)" NAME="4">(76-86)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#4',2,'match232568-1.html#4',3)" NAME="4">(87-104)</A><TD ALIGN=center><FONT COLOR="#bf0000">15</FONT>
<TR><TD BGCOLOR="#151b8d"><FONT COLOR="#151b8d">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#5',2,'match232568-1.html#5',3)" NAME="5">(59-66)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#5',2,'match232568-1.html#5',3)" NAME="5">(466-473)</A><TD ALIGN=center><FONT COLOR="#bf0000">15</FONT>
<TR><TD BGCOLOR="#8c8774"><FONT COLOR="#8c8774">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#6',2,'match232568-1.html#6',3)" NAME="6">(181-191)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#6',2,'match232568-1.html#6',3)" NAME="6">(448-456)</A><TD ALIGN=center><FONT COLOR="#a50000">13</FONT>
<TR><TD BGCOLOR="#38a4a5"><FONT COLOR="#38a4a5">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#7',2,'match232568-1.html#7',3)" NAME="7">(148-156)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#7',2,'match232568-1.html#7',3)" NAME="7">(487-493)</A><TD ALIGN=center><FONT COLOR="#a50000">13</FONT>
<TR><TD BGCOLOR="#c58917"><FONT COLOR="#c58917">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#8',2,'match232568-1.html#8',3)" NAME="8">(121-129)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#8',2,'match232568-1.html#8',3)" NAME="8">(392-401)</A><TD ALIGN=center><FONT COLOR="#990000">12</FONT>
<TR><TD BGCOLOR="#83a33a"><FONT COLOR="#83a33a">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#9',2,'match232568-1.html#9',3)" NAME="9">(114-119)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#9',2,'match232568-1.html#9',3)" NAME="9">(531-537)</A><TD ALIGN=center><FONT COLOR="#990000">12</FONT>
<TR><TD BGCOLOR="#ad5910"><FONT COLOR="#ad5910">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#10',2,'match232568-1.html#10',3)" NAME="10">(68-73)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#10',2,'match232568-1.html#10',3)" NAME="10">(581-587)</A><TD ALIGN=center><FONT COLOR="#990000">12</FONT>
<TR><TD BGCOLOR="#b041ff"><FONT COLOR="#b041ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#11',2,'match232568-1.html#11',3)" NAME="11">(173-178)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#11',2,'match232568-1.html#11',3)" NAME="11">(629-635)</A><TD ALIGN=center><FONT COLOR="#8c0000">11</FONT>
<TR><TD BGCOLOR="#571b7e"><FONT COLOR="#571b7e">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#12',2,'match232568-1.html#12',3)" NAME="12">(131-137)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#12',2,'match232568-1.html#12',3)" NAME="12">(193-201)</A><TD ALIGN=center><FONT COLOR="#8c0000">11</FONT>
<TR><TD BGCOLOR="#3b9c9c"><FONT COLOR="#3b9c9c">-</FONT><TD><A HREF="javascript:ZweiFrames('match232568-0.html#13',2,'match232568-1.html#13',3)" NAME="13">(50-54)<TD><A HREF="javascript:ZweiFrames('match232568-0.html#13',2,'match232568-1.html#13',3)" NAME="13">(118-122)</A><TD ALIGN=center><FONT COLOR="#720000">9</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>MultisetRemoveTester_1.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2013 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
<A NAME="0"></A>
package com.google.common.collect.testing.google;

<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match232568-1.html#0',3,'match232568-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import static com.google.common.collect.testing.Helpers.assertEmpty;
import static com.google.common.collect.testing.features.CollectionFeature.ALLOWS_NULL_QUERIES;
import static com.google.common.collect.testing.features.CollectionFeature.ALLOWS_NULL_VALUES;
import static com.google.common.collect.testing.features.CollectionFeature.SUPPORTS_REMOVE;
import static com.google.common.collect.testing.features.CollectionSize.SEVERAL;
import static com.google.common.collect.testing.features.CollectionSize.ZERO;

import com.google.common.annotations.GwtCompatible;
import com.google.common.annotations.GwtIncompatible;
import com.google.common.collect.testing.Helpers;
import com.google.common.collect.testing.WrongType;
import com.google.common.collect.testing.features.CollectionFeature;
import com.google.common.collect.testing.features.CollectionSize;
import java.lang.reflect.Method;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import org.junit.Ignore;

/**
 * Tests for {@code Multiset#remove}, {@code Multiset.removeAll}, and {@code Multiset.retainAll} not
 * already covered by the corresponding Collection testers.
 *
 * @author Jared Levy
 */
@GwtCompatible(e</B></FONT>mulated = true)
@Ignore // Affects only Android test runner, which respects JUnit 4 annotations on JUnit 3 tests.
public class MultisetRemoveTester&lt;E&gt; extends AbstractMultisetTester&lt;E&gt; {
<A NAME="13"></A>  @CollectionFeature.Require(SUPPORTS_REMOVE)
  public void testRemoveNegative() {
    try {
      getMultiset().remove(<FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match232568-1.html#13',3,'match232568-top.html#13',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>e0(), -1);
      fail(&quot;Expected IllegalArgumentException&quot;);
    } catch (IllegalArgumentException expected) {
    }
    expectUnchanged</B></FONT>();
  }
<A NAME="5"></A>
  @CollectionFeature.Require(absent = SUPPORTS_REMOVE)
  public void testRemoveUnsupported() {
    <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match232568-1.html#5',3,'match232568-top.html#5',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try {
      getMultiset().remove(e0(), 2);
      fail(&quot;Expected UnsupportedOperationException&quot;);
    } catch (UnsupportedOperationException expected) {
    }
  }
<A NAME="10"></A>
  @CollectionFeature</B></FONT>.Require(SUPPORTS_REMOVE)
  public void testRemoveZeroNoOp() {
    <FONT color="#ad5910"><A HREF="javascript:ZweiFrames('match232568-1.html#10',3,'match232568-top.html#10',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>int originalCount = getMultiset().count(e0());
    assertEquals(&quot;old count&quot;, originalCount, getMultiset().remove(e0(), 0));
    expectUnchanged();
  }

<A NAME="4"></A>  @CollectionSize.Require(absent</B></FONT> = ZERO)
  @CollectionFeature.Require(SUPPORTS_REMOVE)
  public void testRemove_occurrences_present() {
    <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match232568-1.html#4',3,'match232568-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>assertEquals(
        &quot;multiset.remove(present, 2) didn't return the old count&quot;,
        1,
        getMultiset().remove(e0(), 2));
    assertFalse(
        &quot;multiset contains present after multiset.remove(present, 2)&quot;,
        getMultiset().contains(e0()));
    assertEquals(0, getMultiset().count(e0()));
  }

<A NAME="2"></A>  @CollectionSize.Require(SEVERAL)</B></FONT>
  @CollectionFeature.Require(SUPPORTS_REMOVE)
  public void testRemove_some_occurrences_present() {
    <FONT color="#980517"><A HREF="javascript:ZweiFrames('match232568-1.html#2',3,'match232568-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>initThreeCopies();
    assertEquals(
        &quot;multiset.remove(present, 2) didn't return the old count&quot;,
        3,
        getMultiset().remove(e0(), 2));
    assertTrue(
        &quot;multiset contains present after multiset.remove(present, 2)&quot;,
        getMultiset().contains(e0()));
    assertEquals(1, getMultiset().count(e0()));
<A NAME="1"></A>  }

  @CollectionFeature.Require(SU</B></FONT>PPORTS_REMOVE)
  public void testRemove_occurrences_absent() <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match232568-1.html#1',3,'match232568-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
    int distinct = getMultiset().elementSet().size();
    assertEquals(&quot;multiset.remove(absent, 0) didn't return 0&quot;, 0, getMultiset().remove(e3(), 2));
    assertEquals(distinct, getMultiset().elementSet().size());
  }

  @CollectionFeature.Require(absent = SUPPO</B></FONT>RTS_REMOVE)
  public void testRemove_occurrences_unsupported_absent() {
    // notice: we don't care whether it succeeds, or fails with UOE
    try {
<A NAME="9"></A>      assertEquals(
          &quot;multiset.remove(absent, 2) didn't return 0 or throw an exception&quot;,
          0,
          <FONT color="#83a33a"><A HREF="javascript:ZweiFrames('match232568-1.html#9',3,'match232568-top.html#9',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getMultiset().remove(e3(), 2));
    } catch (UnsupportedOperationException ok) {
    }
  }
<A NAME="8"></A>
  @CollectionFeature.Requi</B></FONT>re(SUPPORTS_REMOVE)
  public void testRemove_occurrences_0() {
    int oldCount = <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match232568-1.html#8',3,'match232568-top.html#8',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>getMultiset().count(e0());
    assertEquals(
        &quot;multiset.remove(E, 0) didn't return the old count&quot;,
        oldCount,
        getMultiset().remove(e0(), 0));
  }

<A NAME="12"></A>  @CollectionFeature.Require(SUPPORTS_REMOVE)
  public void testRemove_occurrences_negative() {</B></FONT>
    try {
      getMultiset().remove(<FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match232568-1.html#12',3,'match232568-top.html#12',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>e0(), -1);
      fail(&quot;multiset.remove(E, -1) didn't throw an exception&quot;);
    } catch (IllegalArgumentException required) {
    }
  }

  @CollectionFeature.Require(SUPPO</B></FONT>RTS_REMOVE)
  public void testRemove_occurrences_wrongType() {
    assertEquals(
        &quot;multiset.remove(wrongType, 1) didn't return 0&quot;,
        0,
        getMultiset().remove(WrongType.VALUE, 1));
  }

<A NAME="7"></A>  @CollectionSize.Require(absent = ZERO)
  @CollectionFeature.Require({SUPPORTS_REMOVE, ALLOWS_NULL_VALUES})
  public void testRemove_nullPresent() {
    <FONT color="#38a4a5"><A HREF="javascript:ZweiFrames('match232568-1.html#7',3,'match232568-top.html#7',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>initCollectionWithNullElement();
    assertEquals(1, getMultiset().remove(null, 2));
    assertFalse(
        &quot;multiset contains present after multiset.remove(present, 2)&quot;,
        getMultiset().contains(null));
    assertEquals(0, getMultiset().count(null));
  }

  @CollectionFeature.Re</B></FONT>quire({SUPPORTS_REMOVE, ALLOWS_NULL_QUERIES})
  public void testRemove_nullAbsent() {
    assertEquals(0, getMultiset().remove(null, 2));
<A NAME="3"></A>  }

  @CollectionFeature.Require(value = SUPPORTS_REMOVE, absent = ALLOWS_NULL_QUERIES)
  public void testRemove_nullForbidden() <FONT color="#53858b"><A HREF="javascript:ZweiFrames('match232568-1.html#3',3,'match232568-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
    try {
      getMultiset().remove(null, 2);
      fail(&quot;Expected NullPointerException&quot;);
    } catch (NullPointerException expected) {
    }
  }

<A NAME="11"></A>  @CollectionSize.Require(S</B></FONT>EVERAL)
  @CollectionFeature.Require(SUPPORTS_REMOVE)
  public void testRemoveAllIgnoresCount() {
    <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match232568-1.html#11',3,'match232568-top.html#11',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>initThreeCopies();
    assertTrue(getMultiset().removeAll(Collections.singleton(e0())));
    assertEmpty(getMultiset());
  }

<A NAME="6"></A>  @CollectionSize.Require(S</B></FONT>EVERAL)
  @CollectionFeature.Require(SUPPORTS_REMOVE)
  public void testRetainAllIgnoresCount() {
    <FONT color="#8c8774"><A HREF="javascript:ZweiFrames('match232568-1.html#6',3,'match232568-top.html#6',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>initThreeCopies();
    List&lt;E&gt; contents = Helpers.copyToList(getMultiset());
    assertFalse(getMultiset().retainAll(Collections.singleton(e0())));
    expectContents(contents);
  }

  /**
   * Returns {@link Method} instances for the remove tests that assume multisets support duplicates
   * so that the test of {@code Multisets.forSet()} can suppress them.
   */
  @GwtIncompatible // reflection</B></FONT>
  public static List&lt;Method&gt; getRemoveDuplicateInitializingMethods() {
    return Arrays.asList(
        Helpers.getMethod(MultisetRemoveTester.class, &quot;testRemove_some_occurrences_present&quot;));
  }
}
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>OrderingTest_1.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2007 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.google.common.collect;

import static com.google.common.base.Preconditions.checkArgument;
import static com.google.common.collect.Lists.newArrayList;
import static com.google.common.testing.SerializableTester.reserialize;
import static com.google.common.testing.SerializableTester.reserializeAndAssert;
import static com.google.common.truth.Truth.assertThat;
import static java.util.Arrays.asList;
<A NAME="0"></A>
import com.google.common.annotations.GwtCompatible;
import com.google.common.annotations.GwtIncompatible;
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#0',2,'match232568-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>import com.google.common.base.Function;
import com.google.common.base.Functions;
import com.google.common.collect.Ordering.ArbitraryOrdering;
import com.google.common.collect.Ordering.IncomparableValueException;
import com.google.common.collect.testing.Helpers;
import com.google.common.primitives.Ints;
import com.google.common.testing.EqualsTester;
import com.google.common.testing.NullPointerTester;
import java.util.Arrays;
import java.util.Collections;
import java.util.Comparator;
import java.util.Iterator;
import java.util.List;
import java.util.Random;
import java.util.RandomAccess;
import javax.annotation.CheckForNull;
import junit.framework.TestCase;

/**
 * Unit tests for {@code Ordering}.
 *
 * @author Jesse Wilson
 */
@GwtCompatible(e</B></FONT>mulated = true)
public class OrderingTest extends TestCase {
  // TODO(cpovirk): some of these are inexplicably slow (20-30s) under GWT

  private final Ordering&lt;Number&gt; numberOrdering = new NumberOrdering();

  public void testAllEqual() {
    Ordering&lt;Object&gt; comparator = Ordering.allEqual();
    assertSame(comparator, comparator.reverse());

    assertEquals(0, comparator.compare(null, null));
    assertEquals(0, comparator.compare(new Object(), new Object()));
    assertEquals(0, comparator.compare(&quot;apples&quot;, &quot;oranges&quot;));
    assertSame(comparator, reserialize(comparator));
    assertEquals(&quot;Ordering.allEqual()&quot;, comparator.toString());

    List&lt;String&gt; strings = ImmutableList.of(&quot;b&quot;, &quot;a&quot;, &quot;d&quot;, &quot;c&quot;);
    assertEquals(strings, comparator.sortedCopy(strings));
    assertEquals(strings, comparator.immutableSortedCopy(strings));
  }

  // From https://github.com/google/guava/issues/1342
  public void testComplicatedOrderingExample() {
    Integer nullInt = (Integer) null;
    Ordering&lt;Iterable&lt;Integer&gt;&gt; example =
        Ordering.&lt;Integer&gt;natural().nullsFirst().reverse().lexicographical().reverse().nullsLast();
    List&lt;Integer&gt; list1 = Lists.newArrayList();
    List&lt;Integer&gt; list2 = Lists.newArrayList(1);
    List&lt;Integer&gt; list3 = Lists.newArrayList(1, 1);
    List&lt;Integer&gt; list4 = Lists.newArrayList(1, 2);
    List&lt;Integer&gt; list5 = Lists.newArrayList(1, null, 2);
    List&lt;Integer&gt; list6 = Lists.newArrayList(2);
    List&lt;Integer&gt; list7 = Lists.newArrayList(nullInt);
<A NAME="4"></A>    List&lt;Integer&gt; list8 = Lists.newArrayList(nullInt, nullInt);
    List&lt;List&lt;Integer&gt;&gt; list =
        Lists.newArrayList(list1, list2, list3, list4, list5, list6, list7, list8, null);
    List&lt;List&lt;Integer&gt;&gt; sorted = <FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#4',2,'match232568-top.html#4',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>example.sortedCopy(list);

    // [[null, null], [null], [1, null, 2], [1, 1], [1, 2], [1], [2], [], null]
    assertThat(sorted)
        .containsExactly(
            Lists.newArrayList(nullInt, nullInt),
            Lists.newArrayList(nullInt),
            Lists.newArrayList(1, null, 2),
            Lists.newArrayList(1, 1),
            Lists.newArrayList(1, 2),
            Lists.newArrayList(1),
            Lists.newArrayList(2),
            Lists.newArrayList(),
            null)
        .inOrder();
  }

  public void</B></FONT> testNatural() {
    Ordering&lt;Integer&gt; comparator = Ordering.natural();
    Helpers.testComparator(comparator, Integer.MIN_VALUE, -1, 0, 1, Integer.MAX_VALUE);
    try {
      comparator.compare(1, null);
      fail();
    } catch (NullPointerException expected) {
    }
    try {
      comparator.compare(null, 2);
      fail();
<A NAME="13"></A>    } catch (NullPointerException expected) {
    }
    try {
      <FONT color="#3b9c9c"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#13',2,'match232568-top.html#13',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>comparator.compare(null, null);
      fail();
    } catch (NullPointerException expected) {
    }
    assertSame</B></FONT>(comparator, reserialize(comparator));
    assertEquals(&quot;Ordering.natural()&quot;, comparator.toString());
  }

  public void testFrom() {
    Ordering&lt;String&gt; caseInsensitiveOrdering = Ordering.from(String.CASE_INSENSITIVE_ORDER);
    assertEquals(0, caseInsensitiveOrdering.compare(&quot;A&quot;, &quot;a&quot;));
    assertTrue(caseInsensitiveOrdering.compare(&quot;a&quot;, &quot;B&quot;) &lt; 0);
    assertTrue(caseInsensitiveOrdering.compare(&quot;B&quot;, &quot;a&quot;) &gt; 0);

    @SuppressWarnings(&quot;deprecation&quot;) // test of deprecated method
    Ordering&lt;String&gt; orderingFromOrdering = Ordering.from(Ordering.&lt;String&gt;natural());
    new EqualsTester()
        .addEqualityGroup(caseInsensitiveOrdering, Ordering.from(String.CASE_INSENSITIVE_ORDER))
        .addEqualityGroup(orderingFromOrdering, Ordering.natural())
        .testEquals();
  }

  public void testExplicit_none() {
    Comparator&lt;Integer&gt; c = Ordering.explicit(Collections.&lt;Integer&gt;emptyList());
    try {
      c.compare(0, 0);
      fail();
    } catch (IncomparableValueException expected) {
      assertEquals(0, expected.value);
    }
    reserializeAndAssert(c);
  }

  public void testExplicit_one() {
    Comparator&lt;Integer&gt; c = Ordering.explicit(0);
    assertEquals(0, c.compare(0, 0));
    try {
      c.compare(0, 1);
      fail();
    } catch (IncomparableValueException expected) {
      assertEquals(1, expected.value);
    }
    reserializeAndAssert(c);
    assertEquals(&quot;Ordering.explicit([0])&quot;, c.toString());
  }

  public void testExplicit_two() {
    Comparator&lt;Integer&gt; c = Ordering.explicit(42, 5);
    assertEquals(0, c.compare(5, 5));
    assertTrue(c.compare(5, 42) &gt; 0);
    assertTrue(c.compare(42, 5) &lt; 0);
    try {
      c.compare(5, 666);
      fail();
    } catch (IncomparableValueException expected) {
      assertEquals(666, expected.value);
    }
    new EqualsTester()
        .addEqualityGroup(c, Ordering.explicit(42, 5))
        .addEqualityGroup(Ordering.explicit(5, 42))
        .addEqualityGroup(Ordering.explicit(42))
        .testEquals();
    reserializeAndAssert(c);
  }

  public void testExplicit_sortingExample() {
    Comparator&lt;Integer&gt; c = Ordering.explicit(2, 8, 6, 1, 7, 5, 3, 4, 0, 9);
    List&lt;Integer&gt; list = Arrays.asList(0, 3, 5, 6, 7, 8, 9);
    Collections.sort(list, c);
    assertThat(list).containsExactly(8, 6, 7, 5, 3, 0, 9).inOrder();
    reserializeAndAssert(c);
  }
<A NAME="12"></A>
  public void testExplicit_withDuplicates() {
    try {
      <FONT color="#571b7e"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#12',2,'match232568-top.html#12',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>Ordering.explicit(1, 2, 3, 4, 2);
      fail();
    } catch (IllegalArgumentException expected) {
    }
  }

  // A more limited test than the one that follows, but this one uses the
  // actual public API.
  public void testArbitrary_witho</B></FONT>utCollisions() {
    List&lt;Object&gt; list = Lists.newArrayList();
    for (int i = 0; i &lt; 50; i++) {
      list.add(new Object());
    }

    Ordering&lt;Object&gt; arbitrary = Ordering.arbitrary();
    Collections.sort(list, arbitrary);

    // Now we don't care what order it's put the list in, only that
    // comparing any pair of elements gives the answer we expect.
    Helpers.testComparator(arbitrary, list);

    assertEquals(&quot;Ordering.arbitrary()&quot;, arbitrary.toString());
  }

  public void testArbitrary_withCollisions() {
    List&lt;Integer&gt; list = Lists.newArrayList();
    for (int i = 0; i &lt; 50; i++) {
      list.add(i);
    }

    Ordering&lt;Object&gt; arbitrary =
        new ArbitraryOrdering() {
          @Override
          int identityHashCode(Object object) {
            return ((Integer) object) % 5; // fake tons of collisions!
          }
        };

    // Don't let the elements be in such a predictable order
    list = shuffledCopy(list, new Random(1));

    Collections.sort(list, arbitrary);

    // Now we don't care what order it's put the list in, only that
    // comparing any pair of elements gives the answer we expect.
    Helpers.testComparator(arbitrary, list);
  }

  public void testUsingToString() {
    Ordering&lt;Object&gt; ordering = Ordering.usingToString();
    Helpers.testComparator(ordering, 1, 12, 124, 2);
    assertEquals(&quot;Ordering.usingToString()&quot;, ordering.toString());
    assertSame(ordering, reserialize(ordering));
  }

  // use an enum to get easy serializability
  private enum CharAtFunction implements Function&lt;String, Character&gt; {
    AT0(0),
    AT1(1),
    AT2(2),
    AT3(3),
    AT4(4),
    AT5(5),
    ;

    final int index;

    CharAtFunction(int index) {
      this.index = index;
    }

    @Override
    public Character apply(String string) {
      return string.charAt(index);
    }
  }

  private static Ordering&lt;String&gt; byCharAt(int index) {
<A NAME="1"></A>    return Ordering.natural().onResultOf(CharAtFunction.values()[index]);
  }

  public void testCompound_static() <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#1',2,'match232568-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>{
    Comparator&lt;String&gt; comparator =
        Ordering.compound(
            ImmutableList.of(
                byCharAt(0), byCharAt(1), byCharAt(2), byCharAt(3), byCharAt(4), byCharAt(5)));
    Helpers.testComparator(
        comparator,
        ImmutableList.of(
            &quot;applesauce&quot;,
            &quot;apricot&quot;,
            &quot;artichoke&quot;,
            &quot;banality&quot;,
            &quot;banana&quot;,
            &quot;banquet&quot;,
            &quot;tangelo&quot;,
            &quot;tangerine&quot;));
    reserializeAndAssert(comparator);
  }

  public void testCompo</B></FONT>und_instance() {
    Comparator&lt;String&gt; comparator = byCharAt(1).compound(byCharAt(0));
    Helpers.testComparator(
        comparator,
        ImmutableList.of(&quot;red&quot;, &quot;yellow&quot;, &quot;violet&quot;, &quot;blue&quot;, &quot;indigo&quot;, &quot;green&quot;, &quot;orange&quot;));
  }

  public void testCompound_instance_generics() {
    Ordering&lt;Object&gt; objects = Ordering.explicit((Object) 1);
    Ordering&lt;Number&gt; numbers = Ordering.explicit((Number) 1);
    Ordering&lt;Integer&gt; integers = Ordering.explicit(1);

    // Like by like equals like
    Ordering&lt;Number&gt; a = numbers.compound(numbers);

    // The compound takes the more specific type of the two, regardless of order

    Ordering&lt;Number&gt; b = numbers.compound(objects);
    Ordering&lt;Number&gt; c = objects.compound(numbers);

    Ordering&lt;Integer&gt; d = numbers.compound(integers);
    Ordering&lt;Integer&gt; e = integers.compound(numbers);

    // This works with three levels too (IDEA falsely reports errors as noted
    // below. Both javac and eclipse handle these cases correctly.)

    Ordering&lt;Number&gt; f = numbers.compound(objects).compound(objects); // bad IDEA
    Ordering&lt;Number&gt; g = objects.compound(numbers).compound(objects);
    Ordering&lt;Number&gt; h = objects.compound(objects).compound(numbers);

    Ordering&lt;Number&gt; i = numbers.compound(objects.compound(objects));
    Ordering&lt;Number&gt; j = objects.compound(numbers.compound(objects)); // bad IDEA
    Ordering&lt;Number&gt; k = objects.compound(objects.compound(numbers));

    // You can also arbitrarily assign a more restricted type - not an intended
    // feature, exactly, but unavoidable (I think) and harmless
    Ordering&lt;Integer&gt; l = objects.compound(numbers);

    // This correctly doesn't work:
    // Ordering&lt;Object&gt; m = numbers.compound(objects);

    // Sadly, the following works in javac 1.6, but at least it fails for
    // eclipse, and is *correctly* highlighted red in IDEA.
    // Ordering&lt;Object&gt; n = objects.compound(numbers);
  }

  public void testReverse() {
    Ordering&lt;Number&gt; reverseOrder = numberOrdering.reverse();
    Helpers.testComparator(reverseOrder, Integer.MAX_VALUE, 1, 0, -1, Integer.MIN_VALUE);

    new EqualsTester()
        .addEqualityGroup(reverseOrder, numberOrdering.reverse())
        .addEqualityGroup(Ordering.natural().reverse())
        .addEqualityGroup(Collections.reverseOrder())
        .testEquals();
  }

  public void testReverseOfReverseSameAsForward() {
    // Not guaranteed by spec, but it works, and saves us from testing
    // exhaustively
    assertSame(numberOrdering, numberOrdering.reverse().reverse());
  }

  private enum StringLengthFunction implements Function&lt;String, Integer&gt; {
    StringLength;

    @Override
    public Integer apply(String string) {
      return string.length();
    }
  }

  private static final Ordering&lt;Integer&gt; DECREASING_INTEGER = Ordering.natural().reverse();

  public void testOnResultOf_natural() {
    Comparator&lt;String&gt; comparator =
        Ordering.natural().onResultOf(StringLengthFunction.StringLength);
    assertTrue(comparator.compare(&quot;to&quot;, &quot;be&quot;) == 0);
    assertTrue(comparator.compare(&quot;or&quot;, &quot;not&quot;) &lt; 0);
    assertTrue(comparator.compare(&quot;that&quot;, &quot;to&quot;) &gt; 0);

    new EqualsTester()
        .addEqualityGroup(
            comparator, Ordering.natural().onResultOf(StringLengthFunction.StringLength))
        .addEqualityGroup(DECREASING_INTEGER)
        .testEquals();
    reserializeAndAssert(comparator);
    assertEquals(&quot;Ordering.natural().onResultOf(StringLength)&quot;, comparator.toString());
  }

  public void testOnResultOf_chained() {
    Comparator&lt;String&gt; comparator =
        DECREASING_INTEGER.onResultOf(StringLengthFunction.StringLength);
    assertTrue(comparator.compare(&quot;to&quot;, &quot;be&quot;) == 0);
    assertTrue(comparator.compare(&quot;not&quot;, &quot;or&quot;) &lt; 0);
    assertTrue(comparator.compare(&quot;to&quot;, &quot;that&quot;) &gt; 0);
<A NAME="8"></A>
    new EqualsTester()
        .addEqualityGroup(
            comparator, <FONT color="#c58917"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#8',2,'match232568-top.html#8',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>DECREASING_INTEGER.onResultOf(StringLengthFunction.StringLength))
        .addEqualityGroup(DECREASING_INTEGER.onResultOf(Functions.constant(1)))
        .addEqualityGroup(Ordering.natural())
        .testEquals();
    reserializeAndAssert(comparator);
    assertEquals(&quot;Ordering.natural().reverse().onResultOf(StringLength)&quot;, comparator.toString());
  }

  @SuppressWarnings(&quot;unchecked&quot;) // dang varargs
  public void testLexicographical() {</B></FONT>
    Ordering&lt;String&gt; ordering = Ordering.natural();
    Ordering&lt;Iterable&lt;String&gt;&gt; lexy = ordering.lexicographical();

    ImmutableList&lt;String&gt; empty = ImmutableList.of();
    ImmutableList&lt;String&gt; a = ImmutableList.of(&quot;a&quot;);
    ImmutableList&lt;String&gt; aa = ImmutableList.of(&quot;a&quot;, &quot;a&quot;);
    ImmutableList&lt;String&gt; ab = ImmutableList.of(&quot;a&quot;, &quot;b&quot;);
    ImmutableList&lt;String&gt; b = ImmutableList.of(&quot;b&quot;);

    Helpers.testComparator(lexy, empty, a, aa, ab, b);

    new EqualsTester()
        .addEqualityGroup(lexy, ordering.lexicographical())
        .addEqualityGroup(numberOrdering.lexicographical())
        .addEqualityGroup(Ordering.natural())
        .testEquals();
  }

  public void testNullsFirst() {
    Ordering&lt;Integer&gt; ordering = Ordering.natural().nullsFirst();
    Helpers.testComparator(ordering, null, Integer.MIN_VALUE, 0, 1);

    new EqualsTester()
        .addEqualityGroup(ordering, Ordering.natural().nullsFirst())
        .addEqualityGroup(numberOrdering.nullsFirst())
        .addEqualityGroup(Ordering.natural())
        .testEquals();
  }

  public void testNullsLast() {
    Ordering&lt;Integer&gt; ordering = Ordering.natural().nullsLast();
    Helpers.testComparator(ordering, 0, 1, Integer.MAX_VALUE, null);

    new EqualsTester()
        .addEqualityGroup(ordering, Ordering.natural().nullsLast())
        .addEqualityGroup(numberOrdering.nullsLast())
        .addEqualityGroup(Ordering.natural())
        .testEquals();
  }

  public void testBinarySearch() {
    List&lt;Integer&gt; ints = Lists.newArrayList(0, 2, 3, 5, 7, 9);
    assertEquals(4, numberOrdering.binarySearch(ints, 7));
<A NAME="6"></A>  }

  public void testSortedCopy() {
    List&lt;Integer&gt; unsortedInts = Collections.unmodifiableList(<FONT color="#8c8774"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#6',2,'match232568-top.html#6',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>Arrays.asList(5, 0, 3, null, 0, 9));
    List&lt;Integer&gt; sortedInts = numberOrdering.nullsLast().sortedCopy(unsortedInts);
    assertEquals(Arrays.asList(0, 0, 3, 5, 9, null), sortedInts);

    assertEquals(
        Collections.emptyList(), numberOrdering.sortedCopy(Collections.&lt;Integer&gt;emptyList()));
  }

  public void testImmutab</B></FONT>leSortedCopy() {
    ImmutableList&lt;Integer&gt; unsortedInts = ImmutableList.of(5, 3, 0, 9, 3);
    ImmutableList&lt;Integer&gt; sortedInts = numberOrdering.immutableSortedCopy(unsortedInts);
    assertEquals(Arrays.asList(0, 3, 3, 5, 9), sortedInts);

    assertEquals(
        Collections.&lt;Integer&gt;emptyList(),
<A NAME="5"></A>        numberOrdering.immutableSortedCopy(Collections.&lt;Integer&gt;emptyList()));

    List&lt;Integer&gt; listWithNull = Arrays.asList(5, 3, null, 9);
    <FONT color="#151b8d"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#5',2,'match232568-top.html#5',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>try {
      Ordering.natural().nullsFirst().immutableSortedCopy(listWithNull);
      fail();
    } catch (NullPointerException expected) {
    }
  }

<A NAME="2"></A>  public void t</B></FONT>estIsOrdered() {
    assertFalse(numberOrdering.isOrdered(asList(5, 3, 0, 9)));
    assertFalse(numberOrdering.isOrdered(asList(0, 5, 3, 9)));
    assertTrue(numberOrdering.isOrdered(<FONT color="#980517"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#2',2,'match232568-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>asList(0, 3, 5, 9)));
    assertTrue(numberOrdering.isOrdered(asList(0, 0, 3, 3)));
    assertTrue(numberOrdering.isOrdered(asList(0, 3)));
    assertTrue(numberOrdering.isOrdered(Collections.singleton(1)));
    assertTrue(numberOrdering.isOrdered(Collections.&lt;Integer&gt;emptyList()));
  }

  public void testIsStr</B></FONT>ictlyOrdered() {
<A NAME="7"></A>    assertFalse(numberOrdering.isStrictlyOrdered(asList(5, 3, 0, 9)));
    assertFalse(numberOrdering.isStrictlyOrdered(asList(0, 5, 3, 9)));
    assertTrue(numberOrdering.isStrictlyOrdered(asList(0, 3, 5, 9)));
    assertFalse(numberOrdering.isStrictlyOrdered(<FONT color="#38a4a5"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#7',2,'match232568-top.html#7',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>asList(0, 0, 3, 3)));
    assertTrue(numberOrdering.isStrictlyOrdered(asList(0, 3)));
    assertTrue(numberOrdering.isStrictlyOrdered(Collections.singleton(1)));
    assertTrue(numberOrdering.isStrictlyOrdered(Collections.&lt;Integer&gt;emptyList()));
  }

  public void testLeastOfIter</B></FONT>able_empty_0() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Arrays.&lt;Integer&gt;asList(), 0);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.&lt;Integer&gt;of(), result);
  }

  public void testLeastOfIterator_empty_0() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Iterators.&lt;Integer&gt;emptyIterator(), 0);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.&lt;Integer&gt;of(), result);
  }

  public void testLeastOfIterable_empty_1() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Arrays.&lt;Integer&gt;asList(), 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.&lt;Integer&gt;of(), result);
  }

  public void testLeastOfIterator_empty_1() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Iterators.&lt;Integer&gt;emptyIterator(), 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
<A NAME="3"></A>    assertEquals(ImmutableList.&lt;Integer&gt;of(), result);
  }

  public void testLeastOfIterable_simple_negativeOne() <FONT color="#53858b"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#3',2,'match232568-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>{
    try {
      numberOrdering.leastOf(Arrays.asList(3, 4, 5, -1), -1);
      fail();
    } catch (IllegalArgumentException expected) {
    }
  }
<A NAME="9"></A>
  public void testLeastOfIterator_simple</B></FONT>_negativeOne() {
    try {
      <FONT color="#83a33a"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#9',2,'match232568-top.html#9',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>numberOrdering.leastOf(Iterators.forArray(3, 4, 5, -1), -1);
      fail();
    } catch (IllegalArgumentException expected) {
    }
  }

  public void testLeastOfIterable</B></FONT>_singleton_0() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Arrays.asList(3), 0);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.&lt;Integer&gt;of(), result);
  }

  public void testLeastOfIterator_singleton_0() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Iterators.singletonIterator(3), 0);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.&lt;Integer&gt;of(), result);
  }

  public void testLeastOfIterable_simple_0() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Arrays.asList(3, 4, 5, -1), 0);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.&lt;Integer&gt;of(), result);
  }

  public void testLeastOfIterator_simple_0() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Iterators.forArray(3, 4, 5, -1), 0);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.&lt;Integer&gt;of(), result);
  }

  public void testLeastOfIterable_simple_1() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Arrays.asList(3, 4, 5, -1), 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1), result);
  }

  public void testLeastOfIterator_simple_1() {
    List&lt;Integer&gt; result = numberOrdering.leastOf(Iterators.forArray(3, 4, 5, -1), 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1), result);
  }
<A NAME="10"></A>
  public void testLeastOfIterable_simple_nMinusOne_withNullElement() {
    List&lt;Integer&gt; list = Arrays.asList(3, null, 5, -1);
    <FONT color="#ad5910"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#10',2,'match232568-top.html#10',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>List&lt;Integer&gt; result = Ordering.natural().nullsLast().leastOf(list, list.size() - 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1, 3, 5), result);
  }

  public void testLeastOfIterator_simple_nMinusOne_wit</B></FONT>hNullElement() {
    Iterator&lt;Integer&gt; itr = Iterators.forArray(3, null, 5, -1);
    List&lt;Integer&gt; result = Ordering.natural().nullsLast().leastOf(itr, 3);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1, 3, 5), result);
  }

  public void testLeastOfIterable_simple_nMinusOne() {
    List&lt;Integer&gt; list = Arrays.asList(3, 4, 5, -1);
    List&lt;Integer&gt; result = numberOrdering.leastOf(list, list.size() - 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1, 3, 4), result);
  }

  public void testLeastOfIterator_simple_nMinusOne() {
    List&lt;Integer&gt; list = Arrays.asList(3, 4, 5, -1);
    List&lt;Integer&gt; result = numberOrdering.leastOf(list.iterator(), list.size() - 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1, 3, 4), result);
  }

  public void testLeastOfIterable_simple_n() {
    List&lt;Integer&gt; list = Arrays.asList(3, 4, 5, -1);
    List&lt;Integer&gt; result = numberOrdering.leastOf(list, list.size());
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1, 3, 4, 5), result);
  }

  public void testLeastOfIterator_simple_n() {
    List&lt;Integer&gt; list = Arrays.asList(3, 4, 5, -1);
    List&lt;Integer&gt; result = numberOrdering.leastOf(list.iterator(), list.size());
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1, 3, 4, 5), result);
  }
<A NAME="11"></A>
  public void testLeastOfIterable_simple_n_withNullElement() {
    List&lt;Integer&gt; list = Arrays.asList(3, 4, 5, null, -1);
    List&lt;Integer&gt; result = <FONT color="#b041ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match232568-0.html#11',2,'match232568-top.html#11',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>Ordering.natural().nullsLast().leastOf(list, list.size());
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(Arrays.asList(-1, 3, 4, 5, null), result);
  }

  public void testLeastOfIterator_simple_n_wit</B></FONT>hNullElement() {
    List&lt;Integer&gt; list = Arrays.asList(3, 4, 5, null, -1);
    List&lt;Integer&gt; result = Ordering.natural().nullsLast().leastOf(list.iterator(), list.size());
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(Arrays.asList(-1, 3, 4, 5, null), result);
  }

  public void testLeastOfIterable_simple_nPlusOne() {
    List&lt;Integer&gt; list = Arrays.asList(3, 4, 5, -1);
    List&lt;Integer&gt; result = numberOrdering.leastOf(list, list.size() + 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1, 3, 4, 5), result);
  }

  public void testLeastOfIterator_simple_nPlusOne() {
    List&lt;Integer&gt; list = Arrays.asList(3, 4, 5, -1);
    List&lt;Integer&gt; result = numberOrdering.leastOf(list.iterator(), list.size() + 1);
    assertTrue(result instanceof RandomAccess);
    assertListImmutable(result);
    assertEquals(ImmutableList.of(-1, 3, 4, 5), result);
  }

  public void testLeastOfIterable_ties() {
    Integer foo = new Integer(Integer.MAX_VALUE - 10);
    Integer bar = new Integer(Integer.MAX_VALUE - 10);

    assertNotSame(foo, bar);
    assertEquals(foo, bar);

    List&lt;Integer&gt; list = Arrays.asList(3, foo, bar, -1);
    List&lt;Integer&gt; result = numberOrdering.leastOf(list, list.size());
    assertEquals(ImmutableList.of(-1, 3, foo, bar), result);
  }

  public void testLeastOfIterator_ties() {
    Integer foo = new Integer(Integer.MAX_VALUE - 10);
    Integer bar = new Integer(Integer.MAX_VALUE - 10);

    assertNotSame(foo, bar);
    assertEquals(foo, bar);

    List&lt;Integer&gt; list = Arrays.asList(3, foo, bar, -1);
    List&lt;Integer&gt; result = numberOrdering.leastOf(list.iterator(), list.size());
    assertEquals(ImmutableList.of(-1, 3, foo, bar), result);
  }

  @GwtIncompatible // slow
  public void testLeastOf_reconcileAgainstSortAndSublist() {
    runLeastOfComparison(1000, 300, 20);
  }

  public void testLeastOf_reconcileAgainstSortAndSublistSmall() {
    runLeastOfComparison(10, 30, 2);
  }

  private static void runLeastOfComparison(int iterations, int elements, int seeds) {
    Random random = new Random(42);
    Ordering&lt;Integer&gt; ordering = Ordering.natural();

    for (int i = 0; i &lt; iterations; i++) {
      List&lt;Integer&gt; list = Lists.newArrayList();
      for (int j = 0; j &lt; elements; j++) {
        list.add(random.nextInt(10 * i + j + 1));
      }

      for (int seed = 1; seed &lt; seeds; seed++) {
        int k = random.nextInt(10 * seed);
        assertEquals(ordering.sortedCopy(list).subList(0, k), ordering.leastOf(list, k));
      }
    }
  }

  public void testLeastOfIterableLargeK() {
    List&lt;Integer&gt; list = Arrays.asList(4, 2, 3, 5, 1);
    assertEquals(Arrays.asList(1, 2, 3, 4, 5), Ordering.natural().leastOf(list, Integer.MAX_VALUE));
  }

  public void testLeastOfIteratorLargeK() {
    List&lt;Integer&gt; list = Arrays.asList(4, 2, 3, 5, 1);
    assertEquals(
        Arrays.asList(1, 2, 3, 4, 5),
        Ordering.natural().leastOf(list.iterator(), Integer.MAX_VALUE));
  }

  public void testGreatestOfIterable_simple() {
    /*
     * If greatestOf() promised to be implemented as reverse().leastOf(), this
     * test would be enough. It doesn't... but we'll cheat and act like it does
     * anyway. There's a comment there to remind us to fix this if we change it.
     */
    List&lt;Integer&gt; list = Arrays.asList(3, 1, 3, 2, 4, 2, 4, 3);
    assertEquals(Arrays.asList(4, 4, 3, 3), numberOrdering.greatestOf(list, 4));
  }

  public void testGreatestOfIterator_simple() {
    /*
     * If greatestOf() promised to be implemented as reverse().leastOf(), this
     * test would be enough. It doesn't... but we'll cheat and act like it does
     * anyway. There's a comment there to remind us to fix this if we change it.
     */
    List&lt;Integer&gt; list = Arrays.asList(3, 1, 3, 2, 4, 2, 4, 3);
    assertEquals(Arrays.asList(4, 4, 3, 3), numberOrdering.greatestOf(list.iterator(), 4));
  }

  private static void assertListImmutable(List&lt;Integer&gt; result) {
    try {
      result.set(0, 1);
      fail();
    } catch (UnsupportedOperationException expected) {
      // pass
    }
  }

  public void testIteratorMinAndMax() {
    List&lt;Integer&gt; ints = Lists.newArrayList(5, 3, 0, 9);
    assertEquals(9, (int) numberOrdering.max(ints.iterator()));
    assertEquals(0, (int) numberOrdering.min(ints.iterator()));

    // when the values are the same, the first argument should be returned
    Integer a = new Integer(4);
    Integer b = new Integer(4);
    ints = Lists.newArrayList(a, b, b);
    assertSame(a, numberOrdering.max(ints.iterator()));
    assertSame(a, numberOrdering.min(ints.iterator()));
  }

  public void testIteratorMinExhaustsIterator() {
    List&lt;Integer&gt; ints = Lists.newArrayList(9, 0, 3, 5);
    Iterator&lt;Integer&gt; iterator = ints.iterator();
    assertEquals(0, (int) numberOrdering.min(iterator));
    assertFalse(iterator.hasNext());
  }

  public void testIteratorMaxExhaustsIterator() {
    List&lt;Integer&gt; ints = Lists.newArrayList(9, 0, 3, 5);
    Iterator&lt;Integer&gt; iterator = ints.iterator();
    assertEquals(9, (int) numberOrdering.max(iterator));
    assertFalse(iterator.hasNext());
  }

  public void testIterableMinAndMax() {
    List&lt;Integer&gt; ints = Lists.newArrayList(5, 3, 0, 9);
    assertEquals(9, (int) numberOrdering.max(ints));
    assertEquals(0, (int) numberOrdering.min(ints));

    // when the values are the same, the first argument should be returned
    Integer a = new Integer(4);
    Integer b = new Integer(4);
    ints = Lists.newArrayList(a, b, b);
    assertSame(a, numberOrdering.max(ints));
    assertSame(a, numberOrdering.min(ints));
  }

  public void testVarargsMinAndMax() {
    // try the min and max values in all positions, since some values are proper
    // parameters and others are from the varargs array
    assertEquals(9, (int) numberOrdering.max(9, 3, 0, 5, 8));
    assertEquals(9, (int) numberOrdering.max(5, 9, 0, 3, 8));
    assertEquals(9, (int) numberOrdering.max(5, 3, 9, 0, 8));
    assertEquals(9, (int) numberOrdering.max(5, 3, 0, 9, 8));
    assertEquals(9, (int) numberOrdering.max(5, 3, 0, 8, 9));
    assertEquals(0, (int) numberOrdering.min(0, 3, 5, 9, 8));
    assertEquals(0, (int) numberOrdering.min(5, 0, 3, 9, 8));
    assertEquals(0, (int) numberOrdering.min(5, 3, 0, 9, 8));
    assertEquals(0, (int) numberOrdering.min(5, 3, 9, 0, 8));
    assertEquals(0, (int) numberOrdering.min(5, 3, 0, 9, 0));

    // when the values are the same, the first argument should be returned
    Integer a = new Integer(4);
    Integer b = new Integer(4);
    assertSame(a, numberOrdering.max(a, b, b));
    assertSame(a, numberOrdering.min(a, b, b));
  }

  public void testParameterMinAndMax() {
    assertEquals(5, (int) numberOrdering.max(3, 5));
    assertEquals(5, (int) numberOrdering.max(5, 3));
    assertEquals(3, (int) numberOrdering.min(3, 5));
    assertEquals(3, (int) numberOrdering.min(5, 3));

    // when the values are the same, the first argument should be returned
    Integer a = new Integer(4);
    Integer b = new Integer(4);
    assertSame(a, numberOrdering.max(a, b));
    assertSame(a, numberOrdering.min(a, b));
  }

  private static class NumberOrdering extends Ordering&lt;Number&gt; {
    @Override
    public int compare(Number a, Number b) {
      return ((Double) a.doubleValue()).compareTo(b.doubleValue());
    }

    @Override
    public int hashCode() {
      return NumberOrdering.class.hashCode();
    }

    @Override
    public boolean equals(Object other) {
      return other instanceof NumberOrdering;
    }

    private static final long serialVersionUID = 0;
  }

  /*
   * Now we have monster tests that create hundreds of Orderings using different
   * combinations of methods, then checks compare(), binarySearch() and so
   * forth on each one.
   */

  // should periodically try increasing this, but it makes the test run long
  private static final int RECURSE_DEPTH = 2;

  public void testCombinationsExhaustively_startingFromNatural() {
    testExhaustively(Ordering.&lt;String&gt;natural(), &quot;a&quot;, &quot;b&quot;, &quot;d&quot;);
  }

  @GwtIncompatible // too slow
  public void testCombinationsExhaustively_startingFromExplicit() {
    testExhaustively(Ordering.explicit(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;), &quot;a&quot;, &quot;b&quot;, &quot;d&quot;);
  }

  @GwtIncompatible // too slow
  public void testCombinationsExhaustively_startingFromUsingToString() {
    testExhaustively(Ordering.usingToString(), 1, 12, 2);
  }

  @GwtIncompatible // too slow
  public void testCombinationsExhaustively_startingFromFromComparator() {
    testExhaustively(Ordering.from(String.CASE_INSENSITIVE_ORDER), &quot;A&quot;, &quot;b&quot;, &quot;C&quot;, &quot;d&quot;);
  }

  @GwtIncompatible // too slow
  public void testCombinationsExhaustively_startingFromArbitrary() {
    Ordering&lt;Object&gt; arbitrary = Ordering.arbitrary();
    Object[] array = {1, &quot;foo&quot;, new Object()};

    // There's no way to tell what the order should be except empirically
    Arrays.sort(array, arbitrary);
    testExhaustively(arbitrary, array);
  }

  /**
   * Requires at least 3 elements in {@code strictlyOrderedElements} in order to test the varargs
   * version of min/max.
   */
  private static &lt;T&gt; void testExhaustively(
      Ordering&lt;? super T&gt; ordering, T... strictlyOrderedElements) {
    checkArgument(
        strictlyOrderedElements.length &gt;= 3,
        &quot;strictlyOrderedElements &quot; + &quot;requires at least 3 elements&quot;);
    List&lt;T&gt; list = Arrays.asList(strictlyOrderedElements);

    // for use calling Collection.toArray later
    T[] emptyArray = Platform.newArray(strictlyOrderedElements, 0);

    // shoot me, but I didn't want to deal with wildcards through the whole test
    @SuppressWarnings(&quot;unchecked&quot;)
    Scenario&lt;T&gt; starter = new Scenario&lt;&gt;((Ordering) ordering, list, emptyArray);
    verifyScenario(starter, 0);
  }

  private static &lt;T&gt; void verifyScenario(Scenario&lt;T&gt; scenario, int level) {
    scenario.testCompareTo();
    scenario.testIsOrdered();
    scenario.testMinAndMax();
    scenario.testBinarySearch();
    scenario.testSortedCopy();

    if (level &lt; RECURSE_DEPTH) {
      for (OrderingMutation alteration : OrderingMutation.values()) {
        verifyScenario(alteration.mutate(scenario), level + 1);
      }
    }
  }

  /**
   * An aggregation of an ordering with a list (of size &gt; 1) that should prove to be in strictly
   * increasing order according to that ordering.
   */
  private static class Scenario&lt;T&gt; {
    final Ordering&lt;T&gt; ordering;
    final List&lt;T&gt; strictlyOrderedList;
    final T[] emptyArray;

    Scenario(Ordering&lt;T&gt; ordering, List&lt;T&gt; strictlyOrderedList, T[] emptyArray) {
      this.ordering = ordering;
      this.strictlyOrderedList = strictlyOrderedList;
      this.emptyArray = emptyArray;
    }

    void testCompareTo() {
      Helpers.testComparator(ordering, strictlyOrderedList);
    }

    void testIsOrdered() {
      assertTrue(ordering.isOrdered(strictlyOrderedList));
      assertTrue(ordering.isStrictlyOrdered(strictlyOrderedList));
    }

    @SuppressWarnings(&quot;unchecked&quot;) // generic arrays and unchecked cast
    void testMinAndMax() {
      List&lt;T&gt; shuffledList = Lists.newArrayList(strictlyOrderedList);
      shuffledList = shuffledCopy(shuffledList, new Random(5));

      T min = strictlyOrderedList.get(0);
      T max = strictlyOrderedList.get(strictlyOrderedList.size() - 1);

      T first = shuffledList.get(0);
      T second = shuffledList.get(1);
      T third = shuffledList.get(2);
      T[] rest = shuffledList.subList(3, shuffledList.size()).toArray(emptyArray);

      assertEquals(min, ordering.min(shuffledList));
      assertEquals(min, ordering.min(shuffledList.iterator()));
      assertEquals(min, ordering.min(first, second, third, rest));
      assertEquals(min, ordering.min(min, max));
      assertEquals(min, ordering.min(max, min));

      assertEquals(max, ordering.max(shuffledList));
      assertEquals(max, ordering.max(shuffledList.iterator()));
      assertEquals(max, ordering.max(first, second, third, rest));
      assertEquals(max, ordering.max(min, max));
      assertEquals(max, ordering.max(max, min));
    }

    void testBinarySearch() {
      for (int i = 0; i &lt; strictlyOrderedList.size(); i++) {
        assertEquals(i, ordering.binarySearch(strictlyOrderedList, strictlyOrderedList.get(i)));
      }
      List&lt;T&gt; newList = Lists.newArrayList(strictlyOrderedList);
      T valueNotInList = newList.remove(1);
      assertEquals(-2, ordering.binarySearch(newList, valueNotInList));
    }

    void testSortedCopy() {
      List&lt;T&gt; shuffledList = Lists.newArrayList(strictlyOrderedList);
      shuffledList = shuffledCopy(shuffledList, new Random(5));

      assertEquals(strictlyOrderedList, ordering.sortedCopy(shuffledList));

      if (!strictlyOrderedList.contains(null)) {
        assertEquals(strictlyOrderedList, ordering.immutableSortedCopy(shuffledList));
      }
    }
  }

  /**
   * A means for changing an Ordering into another Ordering. Each instance is responsible for
   * creating the alternate Ordering, and providing a List that is known to be ordered, based on an
   * input List known to be ordered according to the input Ordering.
   */
  private enum OrderingMutation {
    REVERSE {
      @Override
      &lt;T&gt; Scenario&lt;?&gt; mutate(Scenario&lt;T&gt; scenario) {
        List&lt;T&gt; newList = Lists.newArrayList(scenario.strictlyOrderedList);
        Collections.reverse(newList);
        return new Scenario&lt;T&gt;(scenario.ordering.reverse(), newList, scenario.emptyArray);
      }
    },
    NULLS_FIRST {
      @Override
      &lt;T&gt; Scenario&lt;?&gt; mutate(Scenario&lt;T&gt; scenario) {
        @SuppressWarnings(&quot;unchecked&quot;)
        List&lt;T&gt; newList = Lists.newArrayList((T) null);
        for (T t : scenario.strictlyOrderedList) {
          if (t != null) {
            newList.add(t);
          }
        }
        return new Scenario&lt;T&gt;(scenario.ordering.nullsFirst(), newList, scenario.emptyArray);
      }
    },
    NULLS_LAST {
      @Override
      &lt;T&gt; Scenario&lt;?&gt; mutate(Scenario&lt;T&gt; scenario) {
        List&lt;T&gt; newList = Lists.newArrayList();
        for (T t : scenario.strictlyOrderedList) {
          if (t != null) {
            newList.add(t);
          }
        }
        newList.add(null);
        return new Scenario&lt;T&gt;(scenario.ordering.nullsLast(), newList, scenario.emptyArray);
      }
    },
    ON_RESULT_OF {
      @Override
      &lt;T&gt; Scenario&lt;?&gt; mutate(final Scenario&lt;T&gt; scenario) {
        Ordering&lt;Integer&gt; ordering =
            scenario.ordering.onResultOf(
                new Function&lt;Integer, T&gt;() {
                  @Override
                  public T apply(@CheckForNull Integer from) {
                    return scenario.strictlyOrderedList.get(from);
                  }
                });
        List&lt;Integer&gt; list = Lists.newArrayList();
        for (int i = 0; i &lt; scenario.strictlyOrderedList.size(); i++) {
          list.add(i);
        }
        return new Scenario&lt;&gt;(ordering, list, new Integer[0]);
      }
    },
    COMPOUND_THIS_WITH_NATURAL {
      @SuppressWarnings(&quot;unchecked&quot;) // raw array
      @Override
      &lt;T&gt; Scenario&lt;?&gt; mutate(Scenario&lt;T&gt; scenario) {
        List&lt;Composite&lt;T&gt;&gt; composites = Lists.newArrayList();
        for (T t : scenario.strictlyOrderedList) {
          composites.add(new Composite&lt;T&gt;(t, 1));
          composites.add(new Composite&lt;T&gt;(t, 2));
        }
        Ordering&lt;Composite&lt;T&gt;&gt; ordering =
            scenario
                .ordering
                .onResultOf(Composite.&lt;T&gt;getValueFunction())
                .compound(Ordering.natural());
        return new Scenario&lt;Composite&lt;T&gt;&gt;(ordering, composites, new Composite[0]);
      }
    },
    COMPOUND_NATURAL_WITH_THIS {
      @SuppressWarnings(&quot;unchecked&quot;) // raw array
      @Override
      &lt;T&gt; Scenario&lt;?&gt; mutate(Scenario&lt;T&gt; scenario) {
        List&lt;Composite&lt;T&gt;&gt; composites = Lists.newArrayList();
        for (T t : scenario.strictlyOrderedList) {
          composites.add(new Composite&lt;T&gt;(t, 1));
        }
        for (T t : scenario.strictlyOrderedList) {
          composites.add(new Composite&lt;T&gt;(t, 2));
        }
        Ordering&lt;Composite&lt;T&gt;&gt; ordering =
            Ordering.natural()
                .compound(scenario.ordering.onResultOf(Composite.&lt;T&gt;getValueFunction()));
        return new Scenario&lt;Composite&lt;T&gt;&gt;(ordering, composites, new Composite[0]);
      }
    },
    LEXICOGRAPHICAL {
      @SuppressWarnings(&quot;unchecked&quot;) // dang varargs
      @Override
      &lt;T&gt; Scenario&lt;?&gt; mutate(Scenario&lt;T&gt; scenario) {
        List&lt;Iterable&lt;T&gt;&gt; words = Lists.newArrayList();
        words.add(Collections.&lt;T&gt;emptyList());
        for (T t : scenario.strictlyOrderedList) {
          words.add(Arrays.asList(t));
          for (T s : scenario.strictlyOrderedList) {
            words.add(Arrays.asList(t, s));
          }
        }
        return new Scenario&lt;Iterable&lt;T&gt;&gt;(
            scenario.ordering.lexicographical(), words, new Iterable[0]);
      }
    },
    ;

    abstract &lt;T&gt; Scenario&lt;?&gt; mutate(Scenario&lt;T&gt; scenario);
  }

  /**
   * A dummy object we create so that we can have something meaningful to have a compound ordering
   * over.
   */
  private static class Composite&lt;T&gt; implements Comparable&lt;Composite&lt;T&gt;&gt; {
    final T value;
    final int rank;

    Composite(T value, int rank) {
      this.value = value;
      this.rank = rank;
    }

    // natural order is by rank only; the test will compound() this with the
    // order of 't'.
    @Override
    public int compareTo(Composite&lt;T&gt; that) {
      return Ints.compare(rank, that.rank);
    }

    static &lt;T&gt; Function&lt;Composite&lt;T&gt;, T&gt; getValueFunction() {
      return new Function&lt;Composite&lt;T&gt;, T&gt;() {
        @Override
        public T apply(Composite&lt;T&gt; from) {
          return from.value;
        }
      };
    }
  }

  @GwtIncompatible // NullPointerTester
  public void testNullPointerExceptions() {
    NullPointerTester tester = new NullPointerTester();
    tester.testAllPublicStaticMethods(Ordering.class);

    // any Ordering&lt;Object&gt; instance that accepts nulls should be good enough
    tester.testAllPublicInstanceMethods(Ordering.usingToString().nullsFirst());
  }

  private static &lt;T&gt; List&lt;T&gt; shuffledCopy(List&lt;T&gt; in, Random random) {
    List&lt;T&gt; mutable = newArrayList(in);
    List&lt;T&gt; out = newArrayList();
    while (!mutable.isEmpty()) {
      out.add(mutable.remove(random.nextInt(mutable.size())));
    }
    return out;
  }
}
</PRE>
</div>
  </div>
</body>
</html>
