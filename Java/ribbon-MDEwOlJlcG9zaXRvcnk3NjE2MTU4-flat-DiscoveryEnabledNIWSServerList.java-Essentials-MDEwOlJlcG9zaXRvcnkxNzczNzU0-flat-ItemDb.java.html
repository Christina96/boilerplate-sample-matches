
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 4.27807486631016%, Tokens: 12, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>ribbon-MDEwOlJlcG9zaXRvcnk3NjE2MTU4-flat-DiscoveryEnabledNIWSServerList.java</h3>
            <pre><code>1  package com.netflix.niws.loadbalancer;
2  import java.util.ArrayList;
3  import java.util.List;
4  import java.util.Optional;
5  import com.netflix.appinfo.InstanceInfo;
6  import com.netflix.appinfo.InstanceInfo.InstanceStatus;
7  import com.netflix.client.config.ClientConfigFactory;
8  import com.netflix.client.config.CommonClientConfigKey;
<span onclick='openModal()' class='match'>9  import com.netflix.client.config.IClientConfig;
10  import com.netflix.client.config.IClientConfigKey.Keys;
11  import com.netflix.config.ConfigurationManager;
12  import com.netflix.discovery.EurekaClient;
13  import com.netflix.discovery.EurekaClientConfig;
14  import com.netflix.loadbalancer.AbstractServerList;
15  import com.netflix.loadbalancer.DynamicServerListLoadBalancer;
16  import org.slf4j.Logger;
17  import org.slf4j.LoggerFactory;
18  import javax.inject.Provider;
19  public class DiscoveryEnabledNIWSServerList extends AbstractServerList<DiscoveryEnabledServer>{
20      private static final Logger logger = LoggerFactory.getLogger(DiscoveryEnabledNIWSServerList.class);
</span>21      String clientName;
22      String vipAddresses;
23      boolean isSecure = false;
24      boolean prioritizeVipAddressBasedServers = true;
25      String datacenter;
26      String targetRegion;
27      int overridePort = CommonClientConfigKey.Port.defaultValue();
28      boolean shouldUseOverridePort = false;
29      boolean shouldUseIpAddr = false;
30      private final Provider<EurekaClient> eurekaClientProvider;
31      @Deprecated
32      public DiscoveryEnabledNIWSServerList() {
33          this.eurekaClientProvider = new LegacyEurekaClientProvider();
34      }
35      @Deprecated
36      public DiscoveryEnabledNIWSServerList(String vipAddresses) {
37          this(vipAddresses, new LegacyEurekaClientProvider());
38      }
39      @Deprecated
40      public DiscoveryEnabledNIWSServerList(IClientConfig clientConfig) {
41          this(clientConfig, new LegacyEurekaClientProvider());
42      }
43      public DiscoveryEnabledNIWSServerList(String vipAddresses, Provider<EurekaClient> eurekaClientProvider) {
44          this(createClientConfig(vipAddresses), eurekaClientProvider);
45      }
46      public DiscoveryEnabledNIWSServerList(IClientConfig clientConfig, Provider<EurekaClient> eurekaClientProvider) {
47          this.eurekaClientProvider = eurekaClientProvider;
48          initWithNiwsConfig(clientConfig);
49      }
50      @Override
51      public void initWithNiwsConfig(IClientConfig clientConfig) {
52          clientName = clientConfig.getClientName();
53          vipAddresses = clientConfig.resolveDeploymentContextbasedVipAddresses();
54          if (vipAddresses == null &&
55                  ConfigurationManager.getConfigInstance().getBoolean("DiscoveryEnabledNIWSServerList.failFastOnNullVip", true)) {
56              throw new NullPointerException("VIP address for client " + clientName + " is null");
57          }
58          isSecure = clientConfig.get(CommonClientConfigKey.IsSecure, false);
59          prioritizeVipAddressBasedServers = clientConfig.get(CommonClientConfigKey.PrioritizeVipAddressBasedServers, prioritizeVipAddressBasedServers);
60          datacenter = ConfigurationManager.getDeploymentContext().getDeploymentDatacenter();
61          targetRegion = clientConfig.get(CommonClientConfigKey.TargetRegion);
62          shouldUseIpAddr = clientConfig.getOrDefault(CommonClientConfigKey.UseIPAddrForServer);
63          if (clientConfig.get(CommonClientConfigKey.ForceClientPortConfiguration, false)) {
64              if (isSecure) {
65                  final Integer port = clientConfig.get(CommonClientConfigKey.SecurePort);
66                  if (port != null) {
67                      overridePort = port;
68                      shouldUseOverridePort = true;
69                  } else {
70                      logger.warn(clientName + " set to force client port but no secure port is set, so ignoring");
71                  }
72              } else {
73                  final Integer port = clientConfig.get(CommonClientConfigKey.Port);
74                  if (port != null) {
75                      overridePort = port;
76                      shouldUseOverridePort = true;
77                  } else{
78                      logger.warn(clientName + " set to force client port but no port is set, so ignoring");
79                  }
80              }
81          }
82      }
83      @Override
84      public List<DiscoveryEnabledServer> getInitialListOfServers(){
85          return obtainServersViaDiscovery();
86      }
87      @Override
88      public List<DiscoveryEnabledServer> getUpdatedListOfServers(){
89          return obtainServersViaDiscovery();
90      }
91      private List<DiscoveryEnabledServer> obtainServersViaDiscovery() {
92          List<DiscoveryEnabledServer> serverList = new ArrayList<DiscoveryEnabledServer>();
93          if (eurekaClientProvider == null || eurekaClientProvider.get() == null) {
94              logger.warn("EurekaClient has not been initialized yet, returning an empty list");
95              return new ArrayList<DiscoveryEnabledServer>();
96          }
97          EurekaClient eurekaClient = eurekaClientProvider.get();
98          if (vipAddresses!=null){
99              for (String vipAddress : vipAddresses.split(",")) {
100                  List<InstanceInfo> listOfInstanceInfo = eurekaClient.getInstancesByVipAddress(vipAddress, isSecure, targetRegion);
101                  for (InstanceInfo ii : listOfInstanceInfo) {
102                      if (ii.getStatus().equals(InstanceStatus.UP)) {
103                          if(shouldUseOverridePort){
104                              if(logger.isDebugEnabled()){
105                                  logger.debug("Overriding port on client name: " + clientName + " to " + overridePort);
106                              }
107                              InstanceInfo copy = new InstanceInfo(ii);
108                              if(isSecure){
109                                  ii = new InstanceInfo.Builder(copy).setSecurePort(overridePort).build();
110                              }else{
111                                  ii = new InstanceInfo.Builder(copy).setPort(overridePort).build();
112                              }
113                          }
114                          DiscoveryEnabledServer des = createServer(ii, isSecure, shouldUseIpAddr);
115                          serverList.add(des);
116                      }
117                  }
118                  if (serverList.size()>0 && prioritizeVipAddressBasedServers){
119                      break; 
120                  }
121              }
122          }
123          return serverList;
124      }
125      protected DiscoveryEnabledServer createServer(final InstanceInfo instanceInfo, boolean useSecurePort, boolean useIpAddr) {
126          DiscoveryEnabledServer server = new DiscoveryEnabledServer(instanceInfo, useSecurePort, useIpAddr);
127          EurekaClientConfig clientConfig = eurekaClientProvider.get().getEurekaClientConfig();
128          String[] availZones = clientConfig.getAvailabilityZones(clientConfig.getRegion());
129          String instanceZone = InstanceInfo.getZone(availZones, instanceInfo);
130          server.setZone(instanceZone);
131          return server;
132      }
133      public String getVipAddresses() {
134          return vipAddresses;
135      }
136      public void setVipAddresses(String vipAddresses) {
137          this.vipAddresses = vipAddresses;
138      }
139      public String toString(){
140          StringBuilder sb = new StringBuilder("DiscoveryEnabledNIWSServerList:");
141          sb.append("; clientName:").append(clientName);
142          sb.append("; Effective vipAddresses:").append(vipAddresses);
143          sb.append("; isSecure:").append(isSecure);
144          sb.append("; datacenter:").append(datacenter);
145          return sb.toString();
146      }
147      private static IClientConfig createClientConfig(String vipAddresses) {
148          IClientConfig clientConfig = ClientConfigFactory.DEFAULT.newConfig();
149          clientConfig.set(Keys.DeploymentContextBasedVipAddresses, vipAddresses);
150          return clientConfig;
151      }
152  }
</code></pre>
        </div>
        <div class="column">
            <h3>Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-ItemDb.java</h3>
            <pre><code>1  package com.earth2me.essentials;
<span onclick='openModal()' class='match'>2  import static com.earth2me.essentials.I18n.tl;
3  import com.earth2me.essentials.utils.NumberUtil;
4  import com.earth2me.essentials.utils.StringUtil;
5  import java.util.*;
6  import java.util.regex.Matcher;
7  import java.util.regex.Pattern;
8  import net.ess3.api.IEssentials;
9  import org.bukkit.Bukkit;
10  import org.bukkit.Material;
11  import org.bukkit.inventory.ItemStack;
12  public class ItemDb implements IConf, net.ess3.api.IItemDb
13  {
14  	private final transient IEssentials ess;
</span>15  	private final transient Map<String, Integer> items = new HashMap<String, Integer>();
16  	private final transient Map<ItemData, List<String>> names = new HashMap<ItemData, List<String>>();
17  	private final transient Map<ItemData, String> primaryName = new HashMap<ItemData, String>();
18  	private final transient Map<String, Short> durabilities = new HashMap<String, Short>();
19  	private final transient ManagedFile file;
20  	private final transient Pattern splitPattern = Pattern.compile("((.*)[:+',;.](\\d+))");
21  	public ItemDb(final IEssentials ess)
22  	{
23  		this.ess = ess;
24  		file = new ManagedFile("items.csv", ess);
25  	}
26  	@Override
27  	public void reloadConfig()
28  	{
29  		final List<String> lines = file.getLines();
30  		if (lines.isEmpty())
31  		{
32  			return;
33  		}
34  		durabilities.clear();
35  		items.clear();
36  		names.clear();
37  		primaryName.clear();
38  		for (String line : lines)
39  		{
40  			line = line.trim().toLowerCase(Locale.ENGLISH);
41  			if (line.length() > 0 && line.charAt(0) == '#')
42  			{
43  				continue;
44  			}
45  			final String[] parts = line.split("[^a-z0-9]");
46  			if (parts.length < 2)
47  			{
48  				continue;
49  			}
50  			final int numeric = Integer.parseInt(parts[1]);
51  			final short data = parts.length > 2 && !parts[2].equals("0") ? Short.parseShort(parts[2]) : 0;
52  			String itemName = parts[0].toLowerCase(Locale.ENGLISH);
53  			durabilities.put(itemName, data);
54  			items.put(itemName, numeric);
55  			ItemData itemData = new ItemData(numeric, data);
56  			if (names.containsKey(itemData))
57  			{
58  				List<String> nameList = names.get(itemData);
59  				nameList.add(itemName);
60  				Collections.sort(nameList, new LengthCompare());
61  			}
62  			else
63  			{
64  				List<String> nameList = new ArrayList<String>();
65  				nameList.add(itemName);
66  				names.put(itemData, nameList);
67  				primaryName.put(itemData, itemName);
68  			}
69  		}
70  	}
71  	@Override
72  	public ItemStack get(final String id, final int quantity) throws Exception
73  	{
74  		final ItemStack retval = get(id.toLowerCase(Locale.ENGLISH));
75  		retval.setAmount(quantity);
76  		return retval;
77  	}
78  	@Override
79  	public ItemStack get(final String id) throws Exception
80  	{
81  		int itemid = 0;
82  		String itemname = null;
83  		short metaData = 0;
84  		Matcher parts = splitPattern.matcher(id);
85  		if (parts.matches())
86  		{
87  			itemname = parts.group(2);
88  			metaData = Short.parseShort(parts.group(3));
89  		}
90  		else
91  		{
92  			itemname = id;
93  		}
94  		if (NumberUtil.isInt(itemname))
95  		{
96  			itemid = Integer.parseInt(itemname);
97  		}
98  		else if (NumberUtil.isInt(id))
99  		{
100  			itemid = Integer.parseInt(id);
101  		}
102  		else
103  		{
104  			itemname = itemname.toLowerCase(Locale.ENGLISH);
105  		}
106  		if (itemid < 1)
107  		{
108  			if (items.containsKey(itemname))
109  			{
110  				itemid = items.get(itemname);
111  				if (durabilities.containsKey(itemname) && metaData == 0)
112  				{
113  					metaData = durabilities.get(itemname);
114  				}
115  			}
116  			else if (Material.getMaterial(itemname.toUpperCase(Locale.ENGLISH)) != null)
117  			{
118  				Material bMaterial = Material.getMaterial(itemname.toUpperCase(Locale.ENGLISH));
119  				itemid = bMaterial.getId();
120  			}
121  			else
122  			{
123  				try
124  				{
125  					Material bMaterial = Bukkit.getUnsafe().getMaterialFromInternalName(itemname.toLowerCase(Locale.ENGLISH));
126  					itemid = bMaterial.getId();
127  				}
128  				catch (Throwable throwable)
129  				{
130  					throw new Exception(tl("unknownItemName", itemname), throwable);
131  				}
132  			}
133  		}
134  		if (itemid < 1)
135  		{
136  			throw new Exception(tl("unknownItemName", itemname));
137  		}
138  		final Material mat = Material.getMaterial(itemid);
139  		if (mat == null)
140  		{
141  			throw new Exception(tl("unknownItemId", itemid));
142  		}
143  		final ItemStack retval = new ItemStack(mat);
144  		retval.setAmount(mat.getMaxStackSize());
145  		retval.setDurability(metaData);
146  		return retval;
147  	}
148  	@Override
149  	public List<ItemStack> getMatching(User user, String[] args) throws Exception
150  	{
151  		List<ItemStack> is = new ArrayList<ItemStack>();
152  		if (args.length < 1)
153  		{
154  			is.add(user.getBase().getItemInHand());
155  		}
156  		else if (args[0].equalsIgnoreCase("hand"))
157  		{
158  			is.add(user.getBase().getItemInHand());
159  		}
160  		else if (args[0].equalsIgnoreCase("inventory") || args[0].equalsIgnoreCase("invent") || args[0].equalsIgnoreCase("all"))
161  		{
162  			for (ItemStack stack : user.getBase().getInventory().getContents())
163  			{
164  				if (stack == null || stack.getType() == Material.AIR)
165  				{
166  					continue;
167  				}
168  				is.add(stack);
169  			}
170  		}
171  		else if (args[0].equalsIgnoreCase("blocks"))
172  		{
173  			for (ItemStack stack : user.getBase().getInventory().getContents())
174  			{
175  				if (stack == null || stack.getTypeId() > 255 || stack.getType() == Material.AIR)
176  				{
177  					continue;
178  				}
179  				is.add(stack);
180  			}
181  		}
182  		else
183  		{
184  			is.add(get(args[0]));
185  		}
186  		if (is.isEmpty() || is.get(0).getType() == Material.AIR)
187  		{
188  			throw new Exception(tl("itemSellAir"));
189  		}
190  		return is;
191  	}
192  	@Override
193  	public String names(ItemStack item)
194  	{
195  		ItemData itemData = new ItemData(item.getTypeId(), item.getDurability());
196  		List<String> nameList = names.get(itemData);
197  		if (nameList == null)
198  		{
199  			itemData = new ItemData(item.getTypeId(), (short)0);
200  			nameList = names.get(itemData);
201  			if (nameList == null)
202  			{
203  				return null;
204  			}
205  		}
206  		if (nameList.size() > 15)
207  		{
208  			nameList = nameList.subList(0, 14);
209  		}
210  		return StringUtil.joinList(", ", nameList);
211  	}
212  	@Override
213  	public String name(ItemStack item)
214  	{
215  		ItemData itemData = new ItemData(item.getTypeId(), item.getDurability());
216  		String name = primaryName.get(itemData);
217  		if (name == null)
218  		{
219  			itemData = new ItemData(item.getTypeId(), (short)0);
220  			name = primaryName.get(itemData);
221  			if (name == null)
222  			{
223  				return null;
224  			}
225  		}
226  		return name;
227  	}
228  	static class ItemData
229  	{
230  		final private int itemNo;
231  		final private short itemData;
232  		ItemData(final int itemNo, final short itemData)
233  		{
234  			this.itemNo = itemNo;
235  			this.itemData = itemData;
236  		}
237  		public int getItemNo()
238  		{
239  			return itemNo;
240  		}
241  		public short getItemData()
242  		{
243  			return itemData;
244  		}
245  		@Override
246  		public int hashCode()
247  		{
248  			return (31 * itemNo) ^ itemData;
249  		}
250  		@Override
251  		public boolean equals(Object o)
252  		{
253  			if (o == null)
254  			{
255  				return false;
256  			}
257  			if (!(o instanceof ItemData))
258  			{
259  				return false;
260  			}
261  			ItemData pairo = (ItemData)o;
262  			return this.itemNo == pairo.getItemNo()
263  				   && this.itemData == pairo.getItemData();
264  		}
265  	}
266  	class LengthCompare implements java.util.Comparator<String>
267  	{
268  		public LengthCompare()
269  		{
270  			super();
271  		}
272  		@Override
273  		public int compare(String s1, String s2)
274  		{
275  			return s1.length() - s2.length();
276  		}
277  	}
278  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from ribbon-MDEwOlJlcG9zaXRvcnk3NjE2MTU4-flat-DiscoveryEnabledNIWSServerList.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-ItemDb.java</div>
                </div>
                <div class="column column_space"><pre><code>9  import com.netflix.client.config.IClientConfig;
10  import com.netflix.client.config.IClientConfigKey.Keys;
11  import com.netflix.config.ConfigurationManager;
12  import com.netflix.discovery.EurekaClient;
13  import com.netflix.discovery.EurekaClientConfig;
14  import com.netflix.loadbalancer.AbstractServerList;
15  import com.netflix.loadbalancer.DynamicServerListLoadBalancer;
16  import org.slf4j.Logger;
17  import org.slf4j.LoggerFactory;
18  import javax.inject.Provider;
19  public class DiscoveryEnabledNIWSServerList extends AbstractServerList<DiscoveryEnabledServer>{
20      private static final Logger logger = LoggerFactory.getLogger(DiscoveryEnabledNIWSServerList.class);
</pre></code></div>
                <div class="column column_space"><pre><code>2  import static com.earth2me.essentials.I18n.tl;
3  import com.earth2me.essentials.utils.NumberUtil;
4  import com.earth2me.essentials.utils.StringUtil;
5  import java.util.*;
6  import java.util.regex.Matcher;
7  import java.util.regex.Pattern;
8  import net.ess3.api.IEssentials;
9  import org.bukkit.Bukkit;
10  import org.bukkit.Material;
11  import org.bukkit.inventory.ItemStack;
12  public class ItemDb implements IConf, net.ess3.api.IItemDb
13  {
14  	private final transient IEssentials ess;
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    