<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for UdtNetty.java &amp; DatagramUnicastInetTest.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for UdtNetty.java &amp; DatagramUnicastInetTest.java
      </h3>
<h1 align="center">
        10.5%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>UdtNetty.java (17.647058%)<th>DatagramUnicastInetTest.java (7.4733095%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(17-44)<td><a href="#" name="0">(16-41)</a><td align="center"><font color="#ff0000">21</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>UdtNetty.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>package io.netty.test.udt.bench.xfer;
2 import com.yammer.metrics.Metrics;
3 import com.yammer.metrics.core.Counter;
4 import com.yammer.metrics.core.Meter;
5 import io.netty.bootstrap.Bootstrap;
6 import io.netty.channel.ChannelFuture;
7 import io.netty.channel.ChannelHandler;
8 import io.netty.channel.nio.NioEventLoopGroup;
9 import io.netty.channel.udt.nio.NioUdtProvider;
10 import io.netty.test.udt.util.CustomReporter;
11 import io.netty.test.udt.util.EchoMessageHandler;
12 import io.netty.test.udt.util.TrafficControl;
13 import io.netty.test.udt.util.UnitHelp;
14 import io.netty.util.internal.logging.InternalLogger;
15 import io.netty.util.internal.logging.InternalLoggerFactory;
16 import java.net.InetSocketAddress;
17 import java.util.concurrent.Executors;
18 import java.util.concurrent.TimeUnit;
19 import java.util.concurrent.atomic.AtomicBoolean;
20 public final class UdtNetty {
21     privat</b></font>e UdtNetty() {
22     }
23     static final InternalLogger log = InternalLoggerFactory.getInstance(UdtNetty.class);
24     static final int time = 10 * 60 * 1000;
25     static final int size = 64 * 1024;
26     static final Counter benchTime = Metrics.newCounter(UdtNetty.class,
27             "bench time");
28     static final Counter benchSize = Metrics.newCounter(UdtNetty.class,
29             "bench size");
30     static {
31         benchTime.inc(time);
32         benchSize.inc(size);
33     }
34     static final Meter rate = Metrics.newMeter(UdtNetty.class, "rate",
35             "bytes", TimeUnit.SECONDS);
36     static {
37         Runtime.getRuntime().addShutdownHook(new Thread() {
38             @Override
39             public void run() {
40                 try {
41                     TrafficControl.delay(0);
42                 } catch (final Exception e) {
43                     log.error("", e);
44                 }
45             }
46         });
47     }
48     public static void main(final String[] args) throws Exception {
49         log.info("init");
50         TrafficControl.delay(0);
51         final AtomicBoolean isOn = new AtomicBoolean(true);
52         final InetSocketAddress addr1 = UnitHelp.localSocketAddress();
53         final InetSocketAddress addr2 = UnitHelp.localSocketAddress();
54         final ChannelHandler handler1 = new EchoMessageHandler(rate, size);
55         final ChannelHandler handler2 = new EchoMessageHandler(null, size);
56         final NioEventLoopGroup group1 = new NioEventLoopGroup(
57                 1, Executors.defaultThreadFactory(), NioUdtProvider.MESSAGE_PROVIDER);
58         final NioEventLoopGroup group2 = new NioEventLoopGroup(
59                 1, Executors.defaultThreadFactory(), NioUdtProvider.MESSAGE_PROVIDER);
60         final Bootstrap peerBoot1 = new Bootstrap();
61         peerBoot1.group(group1)
62                  .channelFactory(NioUdtProvider.MESSAGE_RENDEZVOUS)
63                  .localAddress(addr1).remoteAddress(addr2).handler(handler1);
64         final Bootstrap peerBoot2 = new Bootstrap();
65         peerBoot2.group(group2)
66                  .channelFactory(NioUdtProvider.MESSAGE_RENDEZVOUS)
67                  .localAddress(addr2).remoteAddress(addr1).handler(handler2);
68         final ChannelFuture peerFuture1 = peerBoot1.connect();
69         final ChannelFuture peerFuture2 = peerBoot2.connect();
70         CustomReporter.enable(3, TimeUnit.SECONDS);
71         Thread.sleep(time);
72         isOn.set(false);
73         Thread.sleep(1000);
74         peerFuture1.channel().close().sync();
75         peerFuture2.channel().close().sync();
76         Thread.sleep(1000);
77         group1.shutdownGracefully();
78         group2.shutdownGracefully();
79         Metrics.defaultRegistry().shutdown();
80         TrafficControl.delay(0);
81         log.info("done");
82     }
83 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>DatagramUnicastInetTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 /*
2  * Copyright 2021 The Netty Project
3  *
4  * The Netty Project licenses this file to you under the Apache License,
5  * version 2.0 (the "License"); you may not use this file except in compliance
6  * with the License. You may obtain a copy of the License at:
7  *
8  *   https://www.apache.org/licenses/LICENSE-2.0
9  *
10  * Unless required by applicable law or agreed to in writing, software
11  * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
12  * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
13 <a name="0"></a> * License for the specific language governing permissions and limitations
14  * under the License.
15  */
16 <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>package io.netty.testsuite.transport.socket;
17 import io.netty.bootstrap.Bootstrap;
18 import io.netty.buffer.ByteBuf;
19 import io.netty.channel.Channel;
20 import io.netty.channel.ChannelFuture;
21 import io.netty.channel.ChannelHandlerAdapter;
22 import io.netty.channel.ChannelHandlerContext;
23 import io.netty.channel.ChannelInitializer;
24 import io.netty.channel.SimpleChannelInboundHandler;
25 import io.netty.channel.socket.DatagramChannel;
26 import io.netty.channel.socket.DatagramPacket;
27 import org.junit.jupiter.api.Test;
28 import org.junit.jupiter.api.TestInfo;
29 import java.net.InetSocketAddress;
30 import java.net.SocketAddress;
31 import java.util.concurrent.CountDownLatch;
32 import java.util.concurrent.atomic.AtomicReference;
33 import static org.junit.jupiter.api.Assertions.assertEquals;
34 import static org.junit.jupiter.api.Assertions.assertNotNull;
35 public class DatagramUnicastInetTest extends DatagramUnicastTest {
36     @Test</b></font>
37     public void testBindWithPortOnly(TestInfo testInfo) throws Throwable {
38         run(testInfo, new Runner&lt;Bootstrap, Bootstrap&gt;() {
39             @Override
40             public void run(Bootstrap bootstrap, Bootstrap bootstrap2) throws Throwable {
41                 testBindWithPortOnly(bootstrap2);
42             }
43         });
44     }
45     private static void testBindWithPortOnly(Bootstrap cb) throws Throwable {
46         Channel channel = null;
47         try {
48             cb.handler(new ChannelHandlerAdapter() { });
49             channel = cb.bind(0).sync().channel();
50         } finally {
51             closeChannel(channel);
52         }
53     }
54     @Override
55     protected boolean isConnected(Channel channel) {
56         return ((DatagramChannel) channel).isConnected();
57     }
58     @Override
59     protected Channel setupClientChannel(Bootstrap cb, final byte[] bytes, final CountDownLatch latch,
60                                          final AtomicReference&lt;Throwable&gt; errorRef) throws Throwable {
61         cb.handler(new SimpleChannelInboundHandler&lt;DatagramPacket&gt;() {
62             @Override
63             public void channelRead0(ChannelHandlerContext ctx, DatagramPacket msg) {
64                 try {
65                     ByteBuf buf = msg.content();
66                     assertEquals(bytes.length, buf.readableBytes());
67                     for (int i = 0; i &lt; bytes.length; i++) {
68                         assertEquals(bytes[i], buf.getByte(buf.readerIndex() + i));
69                     }
70                     InetSocketAddress localAddress = (InetSocketAddress) ctx.channel().localAddress();
71                     if (localAddress.getAddress().isAnyLocalAddress()) {
72                         assertEquals(localAddress.getPort(), msg.recipient().getPort());
73                     } else {
74                         assertEquals(localAddress, msg.recipient());
75                     }
76                 } finally {
77                     latch.countDown();
78                 }
79             }
80             @Override
81             public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {
82                 errorRef.compareAndSet(null, cause);
83             }
84         });
85         return cb.bind(newSocketAddress()).sync().channel();
86     }
87     @Override
88     protected Channel setupServerChannel(Bootstrap sb, final byte[] bytes, final SocketAddress sender,
89                                          final CountDownLatch latch, final AtomicReference&lt;Throwable&gt; errorRef,
90                                          final boolean echo) throws Throwable {
91         sb.handler(new ChannelInitializer&lt;Channel&gt;() {
92             @Override
93             protected void initChannel(Channel ch) {
94                 ch.pipeline().addLast(new SimpleChannelInboundHandler&lt;DatagramPacket&gt;() {
95                     @Override
96                     public void channelRead0(ChannelHandlerContext ctx, DatagramPacket msg) {
97                         try {
98                             if (sender == null) {
99                                 assertNotNull(msg.sender());
100                             } else {
101                                 InetSocketAddress senderAddress = (InetSocketAddress) sender;
102                                 if (senderAddress.getAddress().isAnyLocalAddress()) {
103                                     assertEquals(senderAddress.getPort(), msg.sender().getPort());
104                                 } else {
105                                     assertEquals(sender, msg.sender());
106                                 }
107                             }
108                             ByteBuf buf = msg.content();
109                             assertEquals(bytes.length, buf.readableBytes());
110                             for (int i = 0; i &lt; bytes.length; i++) {
111                                 assertEquals(bytes[i], buf.getByte(buf.readerIndex() + i));
112                             }
113                             assertEquals(ctx.channel().localAddress(), msg.recipient());
114                             if (echo) {
115                                 ctx.writeAndFlush(new DatagramPacket(buf.retainedDuplicate(), msg.sender()));
116                             }
117                         } finally {
118                             latch.countDown();
119                         }
120                     }
121                     @Override
122                     public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {
123                         errorRef.compareAndSet(null, cause);
124                     }
125                 });
126             }
127         });
128         return sb.bind(newSocketAddress()).sync().channel();
129     }
130     @Override
131     protected boolean supportDisconnect() {
132         return true;
133     }
134     @Override
135     protected ChannelFuture write(Channel cc, ByteBuf buf, SocketAddress remote, WrapType wrapType) {
136         switch (wrapType) {
137             case DUP:
138                 return cc.write(new DatagramPacket(buf.retainedDuplicate(), (InetSocketAddress) remote));
139             case SLICE:
140                 return cc.write(new DatagramPacket(buf.retainedSlice(), (InetSocketAddress) remote));
141             case READ_ONLY:
142                 return cc.write(new DatagramPacket(buf.retain().asReadOnly(), (InetSocketAddress) remote));
143             case NONE:
144                 return cc.write(new DatagramPacket(buf.retain(), (InetSocketAddress) remote));
145             default:
146                 throw new Error("unknown wrap type: " + wrapType);
147         }
148     }
149 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
