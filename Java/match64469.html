<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for UnsignedLongTest.java &amp; TreeRangeMapTest_1.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for UnsignedLongTest.java &amp; TreeRangeMapTest_1.java
      </h3>
<h1 align="center">
        31.8%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>UnsignedLongTest.java (53.09381%)<th>TreeRangeMapTest_1.java (22.773973%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(48-64)<td><a href="#" name="0">(596-614)</a><td align="center"><font color="#ff0000">28</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(185-193)<td><a href="#" name="1">(424-433)</a><td align="center"><font color="#9a0000">17</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(172-180)<td><a href="#" name="2">(371-380)</a><td align="center"><font color="#9a0000">17</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(160-169)<td><a href="#" name="3">(358-367)</a><td align="center"><font color="#9a0000">17</font>
<tr onclick='openModal("#6cc417")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#6cc417"><font color="#6cc417">-</font><td><a href="#" name="4">(105-111)<td><a href="#" name="4">(309-317)</a><td align="center"><font color="#9a0000">17</font>
<tr onclick='openModal("#151b8d")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#151b8d"><font color="#151b8d">-</font><td><a href="#" name="5">(250-257)<td><a href="#" name="5">(318-325)</a><td align="center"><font color="#910000">16</font>
<tr onclick='openModal("#8c8774")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#8c8774"><font color="#8c8774">-</font><td><a href="#" name="6">(200-206)<td><a href="#" name="6">(392-398)</a><td align="center"><font color="#7f0000">14</font>
<tr onclick='openModal("#38a4a5")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#38a4a5"><font color="#38a4a5">-</font><td><a href="#" name="7">(94-100)<td><a href="#" name="7">(345-351)</a><td align="center"><font color="#760000">13</font>
<tr onclick='openModal("#c58917")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#c58917"><font color="#c58917">-</font><td><a href="#" name="8">(271-277)<td><a href="#" name="8">(472-478)</a><td align="center"><font color="#6d0000">12</font>
<tr onclick='openModal("#83a33a")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#83a33a"><font color="#83a33a">-</font><td><a href="#" name="9">(258-264)<td><a href="#" name="9">(405-414)</a><td align="center"><font color="#6d0000">12</font>
<tr onclick='openModal("#ad5910")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#ad5910"><font color="#ad5910">-</font><td><a href="#" name="10">(221-226)<td><a href="#" name="10">(671-676)</a><td align="center"><font color="#6d0000">12</font>
<tr onclick='openModal("#b041ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#b041ff"><font color="#b041ff">-</font><td><a href="#" name="11">(124-128)<td><a href="#" name="11">(452-458)</a><td align="center"><font color="#6d0000">12</font>
<tr onclick='openModal("#571b7e")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#571b7e"><font color="#571b7e">-</font><td><a href="#" name="12">(226-231)<td><a href="#" name="12">(414-419)</a><td align="center"><font color="#640000">11</font>
<tr onclick='openModal("#3b9c9c")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#3b9c9c"><font color="#3b9c9c">-</font><td><a href="#" name="13">(137-141)<td><a href="#" name="13">(439-446)</a><td align="center"><font color="#640000">11</font>
<tr onclick='openModal("#842dce")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#842dce"><font color="#842dce">-</font><td><a href="#" name="14">(113-119)<td><a href="#" name="14">(351-357)</a><td align="center"><font color="#640000">11</font>
<tr onclick='openModal("#f52887")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f52887"><font color="#f52887">-</font><td><a href="#" name="15">(17-31)<td><a href="#" name="15">(26-40)</a><td align="center"><font color="#5b0000">10</font>
<tr onclick='openModal("#2981b2")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#2981b2"><font color="#2981b2">-</font><td><a href="#" name="16">(246-249)<td><a href="#" name="16">(620-623)</a><td align="center"><font color="#510000">9</font>
<tr onclick='openModal("#3090c7")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#3090c7"><font color="#3090c7">-</font><td><a href="#" name="17">(196-199)<td><a href="#" name="17">(382-388)</a><td align="center"><font color="#510000">9</font>
<tr onclick='openModal("#800517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#800517"><font color="#800517">-</font><td><a href="#" name="18">(129-134)<td><a href="#" name="18">(465-471)</a><td align="center"><font color="#510000">9</font>
<tr onclick='openModal("#f62817")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f62817"><font color="#f62817">-</font><td><a href="#" name="19">(81-87)<td><a href="#" name="19">(52-56)</a><td align="center"><font color="#510000">9</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>UnsignedLongTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <a name="15"></a>
2 package com.google.common.primitives;
3 <font color="#f52887"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>import com.google.common.annotations.GwtCompatible;
4 import com.google.common.annotations.GwtIncompatible;
5 import com.google.common.collect.ImmutableSet;
6 import com.google.common.testing.EqualsTester;
7 import com.google.common.testing.NullPointerTester;
8 import com.google.common.testing.SerializableTester;
9 import java.math.BigInteger;
10 import junit.framework.TestCase;
11 @</b></font>GwtCompatible(emulated = true)
12 public class UnsignedLongTest extends TestCase {
13   private static final ImmutableSet&lt;Long&gt; TEST_LONGS;
14   private static final ImmutableSet&lt;BigInteger&gt; TEST_BIG_INTEGERS;
15   static {
16     ImmutableSet.Builder&lt;Long&gt; testLongsBuilder = ImmutableSet.builder();
17     ImmutableSet.Builder&lt;BigInteger&gt; testBigIntegersBuilder = ImmutableSet.builder();
18     long floatConversionTest = 0xfffffe8000000002L;
19 <a name="0"></a>    long doubleConversionTest = 0xfffffffffffff402L;
20     for (long i = -3; i &lt;= 3; i++) {
21       <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>testLongsBuilder
22           .add(i)
23           .add(Long.MAX_VALUE + i)
24           .add(Long.MIN_VALUE + i)
25           .add(Integer.MIN_VALUE + i)
26           .add(Integer.MAX_VALUE + i)
27           .add(floatConversionTest + i)
28           .add(doubleConversionTest + i);
29       BigInteger bigI = BigInteger.valueOf(i);
30       testBigIntegersBuilder
31           .add(bigI)
32           .add(BigInteger.valueOf(Long.MAX_VALUE).add(bigI))
33           .add(BigInteger.valueOf(Long.MIN_VALUE).add(bigI))
34           .add(BigInteger.valueOf(Integer.MAX_VALUE).add(bigI))
35           .add(BigInteger.valueOf(Integer.MIN_VALUE).add(bigI))
36           .add(BigInteger.ONE.shiftLeft(63).add(bigI))
37           .add(BigInteger.ONE.shiftLeft</b></font>(64).add(bigI));
38     }
39     TEST_LONGS = testLongsBuilder.build();
40     TEST_BIG_INTEGERS = testBigIntegersBuilder.build();
41   }
42   public void testAsUnsignedAndLongValueAreInverses() {
43     for (long value : TEST_LONGS) {
44       assertEquals(
45           UnsignedLongs.toString(value), value, UnsignedLong.fromLongBits(value).longValue());
46     }
47   }
48   public void testAsUnsignedBigIntegerValue() {
49 <a name="19"></a>    for (long value : TEST_LONGS) {
50       BigInteger expected =
51           (value &gt;= 0)
52               ? <font color="#f62817"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>BigInteger.valueOf(value)
53               : BigInteger.valueOf(value).add(BigInteger.ZERO.setBit(64));
54       assertEquals(
55           UnsignedLongs.toString(value),
56           expected,
57           UnsignedLong.fromLongBits(value).bigIntegerValue());
58     }</b></font>
59   }
60   public void testValueOfLong() {
61 <a name="7"></a>    for (long value : TEST_LONGS) {
62       boolean expectSuccess = value &gt;= 0;
63       try {
64         assertEquals(value, <font color="#38a4a5"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>UnsignedLong.valueOf(value).longValue());
65         assertTrue(expectSuccess);
66       } catch (IllegalArgumentException e) {
67         assertFalse(expectSuccess);
68       }
69     }
70   }</b></font>
71 <a name="4"></a>  public void testValueOfBigInteger() {
72     BigInteger min = BigInteger.ZERO;
73     BigInteger max = UnsignedLong.MAX_VALUE.bigIntegerValue();
74     <font color="#6cc417"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>for (BigInteger big : TEST_BIG_INTEGERS) {
75       boolean expectSuccess = big.compareTo(min) &gt;= 0 &amp;&amp; big.compareTo(max) &lt;= 0;
76       try {
77         assertEquals(big, UnsignedLong.valueOf(big).bigIntegerValue());
78         assertTrue(expectSuccess);
79 <a name="14"></a>      } catch (IllegalArgumentException e) {
80         assertFalse</b></font>(expectSuccess);
81       }
82     <font color="#842dce"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}
83   }
84   public void testToString() {
85     for (long value : TEST_LONGS) {
86       UnsignedLong unsignedValue = UnsignedLong.fromLongBits(value);
87       assertEquals</b></font>(unsignedValue.bigIntegerValue().toString(), unsignedValue.toString());
88     }
89 <a name="11"></a>  }
90   @GwtIncompatible   public void testToStringRadix() <font color="#b041ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>{
91     for (int radix = Character.MIN_RADIX; radix &lt;= Character.MAX_RADIX; radix++) {
92 <a name="18"></a>      for (long l : TEST_LONGS) {
93         UnsignedLong value = UnsignedLong.fromLongBits(l);
94         assertEquals(value.bigIntegerValue</b></font>().toString(radix), value.toString(radix));
95       <font color="#800517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}
96     }
97   }
98   public void testToStringRadixQuick() {
99 <a name="13"></a>    int[] radices = {2, 3, 5, 7, 10, 12, 16, 21, 31, 36}</b></font>;
100     for (int radix : radices) {
101       for (long l : TEST_LONGS) {
102         <font color="#3b9c9c"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>UnsignedLong value = UnsignedLong.fromLongBits(l);
103         assertEquals(value.bigIntegerValue().toString(radix), value.toString(radix));
104       }
105     }
106   }</b></font>
107   @AndroidIncompatible   public void testFloatValue() {
108     for (long value : TEST_LONGS) {
109       UnsignedLong unsignedValue = UnsignedLong.fromLongBits(value);
110       assertEquals(
111           "Float value of " + unsignedValue,
112           unsignedValue.bigIntegerValue().floatValue(),
113           unsignedValue.floatValue(),
114           0.0f);
115     }
116   }
117   public void testDoubleValue() {
118     for (long value : TEST_LONGS) {
119 <a name="3"></a>      UnsignedLong unsignedValue = UnsignedLong.fromLongBits(value);
120       assertEquals(
121           "Double value of " + unsignedValue,
122           <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>unsignedValue.bigIntegerValue().doubleValue(),
123           unsignedValue.doubleValue(),
124           0.0);
125     }
126   }
127   public void testPlus() {
128     for (long a : TEST_LONGS) {
129       for (long b : TEST_LONGS) {
130 <a name="2"></a>        UnsignedLong aUnsigned = UnsignedLong.fromLongBits</b></font>(a);
131         UnsignedLong bUnsigned = UnsignedLong.fromLongBits(b);
132         long expected = aUnsigned.bigIntegerValue().add(bUnsigned.bigIntegerValue()).longValue();
133         UnsignedLong unsignedSum = <font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>aUnsigned.plus(bUnsigned);
134         assertEquals(expected, unsignedSum.longValue());
135       }
136     }
137   }
138   public void testMinus() {
139     for (long a : TEST_LONGS) {
140       for (long b : TEST_LONGS) {</b></font>
141         UnsignedLong aUnsigned = UnsignedLong.fromLongBits(a);
142 <a name="1"></a>        UnsignedLong bUnsigned = UnsignedLong.fromLongBits(b);
143         long expected =
144             aUnsigned.bigIntegerValue().subtract(bUnsigned.bigIntegerValue()).longValue();
145         UnsignedLong unsignedSub = <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>aUnsigned.minus(bUnsigned);
146         assertEquals(expected, unsignedSub.longValue());
147       }
148     }
149   }
150   public void testTimes() {
151     for (long a : TEST_LONGS) {
152 <a name="17"></a>      for (long b : TEST_LONGS) {</b></font>
153         UnsignedLong aUnsigned = UnsignedLong.fromLongBits(a);
154         UnsignedLong bUnsigned = UnsignedLong.fromLongBits(b);
155         <font color="#3090c7"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>long expected =
156 <a name="6"></a>            aUnsigned.bigIntegerValue().multiply(bUnsigned.bigIntegerValue()).longValue();
157         UnsignedLong unsignedMul = aUnsigned.times(bUnsigned);
158         assertEquals(expected, unsignedMul.longValue</b></font>());
159       <font color="#8c8774"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}
160     }
161   }
162   public void testDividedBy() {
163     for (long a : TEST_LONGS) {
164       for (long b : TEST_LONGS) {</b></font>
165         if (b != 0) {
166           UnsignedLong aUnsigned = UnsignedLong.fromLongBits(a);
167           UnsignedLong bUnsigned = UnsignedLong.fromLongBits(b);
168           long expected =
169               aUnsigned.bigIntegerValue().divide(bUnsigned.bigIntegerValue()).longValue();
170           UnsignedLong unsignedDiv = aUnsigned.dividedBy(bUnsigned);
171           assertEquals(expected, unsignedDiv.longValue());
172         }
173       }
174     }
175   }
176 <a name="10"></a>
177   public void testDivideByZeroThrows() {
178     for (long a : TEST_LONGS) {
179       <font color="#ad5910"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>try {
180         UnsignedLong.fromLongBits(a).dividedBy(UnsignedLong.ZERO);
181 <a name="12"></a>        fail("Expected ArithmeticException");
182       } catch (ArithmeticException expected) {
183       }
184     <font color="#571b7e"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}</b></font>
185   }
186   public void testMod() {
187     for (long a : TEST_LONGS) {
188       for (long b : TEST_LONGS) {</b></font>
189         if (b != 0) {
190           UnsignedLong aUnsigned = UnsignedLong.fromLongBits(a);
191           UnsignedLong bUnsigned = UnsignedLong.fromLongBits(b);
192           long expected =
193               aUnsigned.bigIntegerValue().remainder(bUnsigned.bigIntegerValue()).longValue();
194           UnsignedLong unsignedRem = aUnsigned.mod(bUnsigned);
195           assertEquals(expected, unsignedRem.longValue());
196         }
197       }
198     }
199   }
200 <a name="16"></a>
201   public void testModByZero() {
202     for (long a : TEST_LONGS) {
203       <font color="#2981b2"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>try {
204 <a name="5"></a>        UnsignedLong.fromLongBits(a).mod(UnsignedLong.ZERO);
205         fail("Expected ArithmeticException");
206       } catch (ArithmeticException expected) {</b></font>
207       <font color="#151b8d"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}
208     }
209   }
210   public void testCompare() {
211 <a name="9"></a>    for (long a : TEST_LONGS) {
212       for (long b : TEST_LONGS) {
213         UnsignedLong aUnsigned = UnsignedLong.fromLongBits</b></font>(a);
214         <font color="#83a33a"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>UnsignedLong bUnsigned = UnsignedLong.fromLongBits(b);
215         assertEquals(
216             aUnsigned.bigIntegerValue().compareTo(bUnsigned.bigIntegerValue()),
217             aUnsigned.compareTo(bUnsigned));
218       }
219     }
220   }</b></font>
221   @GwtIncompatible   public void testEquals() {
222 <a name="8"></a>    EqualsTester equalsTester = new EqualsTester();
223     for (long a : TEST_LONGS) {
224       BigInteger big =
225           (a &gt;= 0) ? <font color="#c58917"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>BigInteger.valueOf(a) : BigInteger.valueOf(a).add(BigInteger.ZERO.setBit(64));
226       equalsTester.addEqualityGroup(
227           UnsignedLong.fromLongBits(a),
228           UnsignedLong.valueOf(big),
229           UnsignedLong.valueOf(big.toString()),
230           UnsignedLong.valueOf(big.toString(16), 16));
231     }</b></font>
232     equalsTester.testEquals();
233   }
234   public void testIntValue() {
235     for (long a : TEST_LONGS) {
236       UnsignedLong aUnsigned = UnsignedLong.fromLongBits(a);
237       int intValue = aUnsigned.bigIntegerValue().intValue();
238       assertEquals(intValue, aUnsigned.intValue());
239     }
240   }
241   @GwtIncompatible   public void testSerialization() {
242     for (long a : TEST_LONGS) {
243       SerializableTester.reserializeAndAssert(UnsignedLong.fromLongBits(a));
244     }
245   }
246   @GwtIncompatible   public void testNulls() {
247     new NullPointerTester().testAllPublicStaticMethods(UnsignedLong.class);
248   }
249 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>TreeRangeMapTest_1.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 package com.google.common.collect;
2 import static com.google.common.collect.BoundType.OPEN;
3 import static com.google.common.collect.testing.Helpers.mapEntry;
4 import com.google.common.annotations.GwtIncompatible;
5 import com.google.common.collect.testing.MapTestSuiteBuilder;
6 import com.google.common.collect.testing.SampleElements;
7 <a name="15"></a>import com.google.common.collect.testing.TestMapGenerator;
8 import com.google.common.collect.testing.features.CollectionFeature;
9 import com.google.common.collect.testing.features.CollectionSize;
10 <font color="#f52887"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>import com.google.common.collect.testing.features.MapFeature;
11 import java.util.List;
12 import java.util.Map;
13 import java.util.Map.Entry;
14 import java.util.NoSuchElementException;
15 import junit.framework.Test;
16 import junit.framework.TestCase;
17 import junit.framework.TestSuite;
18 @</b></font>GwtIncompatible public class TreeRangeMapTest extends TestCase {
19   public static Test suite() {
20     TestSuite suite = new TestSuite();
21     suite.addTestSuite(TreeRangeMapTest.class);
22     suite.addTest(
23         MapTestSuiteBuilder.using(
24                 new TestMapGenerator&lt;Range&lt;Integer&gt;, String&gt;() {
25                   @Override
26 <a name="19"></a>                  public SampleElements&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; samples() {
27                     return new SampleElements&lt;&gt;(
28                         mapEntry(Range.singleton(0), "banana"),
29                         <font color="#f62817"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>mapEntry(Range.closedOpen(3, 5), "frisbee"),
30                         mapEntry(Range.atMost(-1), "fruitcake"),
31                         mapEntry(Range.open(10, 15), "elephant"),
32                         mapEntry(Range.closed(20, 22), "umbrella"));
33                   }</b></font>
34                   @Override
35                   public Map&lt;Range&lt;Integer&gt;, String&gt; create(Object... elements) {
36                     RangeMap&lt;Integer, String&gt; rangeMap = TreeRangeMap.create();
37                     for (Object o : elements) {
38                       @SuppressWarnings("unchecked")
39                       Entry&lt;Range&lt;Integer&gt;, String&gt; entry = (Entry&lt;Range&lt;Integer&gt;, String&gt;) o;
40                       rangeMap.put(entry.getKey(), entry.getValue());
41                     }
42                     return rangeMap.asMapOfRanges();
43                   }
44                   @SuppressWarnings("unchecked")
45                   @Override
46                   public Entry&lt;Range&lt;Integer&gt;, String&gt;[] createArray(int length) {
47                     return new Entry[length];
48                   }
49                   @Override
50                   public Iterable&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; order(
51                       List&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; insertionOrder) {
52                     return Range.&lt;Integer&gt;rangeLexOrdering().onKeys().sortedCopy(insertionOrder);
53                   }
54                   @SuppressWarnings("unchecked")
55                   @Override
56                   public Range&lt;Integer&gt;[] createKeyArray(int length) {
57                     return new Range[length];
58                   }
59                   @Override
60                   public String[] createValueArray(int length) {
61                     return new String[length];
62                   }
63                 })
64             .named("TreeRangeMap.asMapOfRanges")
65             .withFeatures(
66                 CollectionSize.ANY,
67                 MapFeature.SUPPORTS_REMOVE,
68                 MapFeature.ALLOWS_ANY_NULL_QUERIES,
69                 CollectionFeature.KNOWN_ORDER,
70                 CollectionFeature.SUPPORTS_ITERATOR_REMOVE)
71             .createTestSuite());
72     suite.addTest(
73         MapTestSuiteBuilder.using(
74                 new TestMapGenerator&lt;Range&lt;Integer&gt;, String&gt;() {
75                   @Override
76                   public SampleElements&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; samples() {
77                     return new SampleElements&lt;&gt;(
78                         mapEntry(Range.singleton(0), "banana"),
79                         mapEntry(Range.closedOpen(3, 5), "frisbee"),
80                         mapEntry(Range.atMost(-1), "fruitcake"),
81                         mapEntry(Range.open(10, 15), "elephant"),
82                         mapEntry(Range.closed(20, 22), "umbrella"));
83                   }
84                   @Override
85                   public Map&lt;Range&lt;Integer&gt;, String&gt; create(Object... elements) {
86                     RangeMap&lt;Integer, String&gt; rangeMap = TreeRangeMap.create();
87                     for (Object o : elements) {
88                       @SuppressWarnings("unchecked")
89                       Entry&lt;Range&lt;Integer&gt;, String&gt; entry = (Entry&lt;Range&lt;Integer&gt;, String&gt;) o;
90                       rangeMap.put(entry.getKey(), entry.getValue());
91                     }
92                     return rangeMap.subRangeMap(Range.atMost(22)).asMapOfRanges();
93                   }
94                   @SuppressWarnings("unchecked")
95                   @Override
96                   public Entry&lt;Range&lt;Integer&gt;, String&gt;[] createArray(int length) {
97                     return new Entry[length];
98                   }
99                   @Override
100                   public Iterable&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; order(
101                       List&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; insertionOrder) {
102                     return Range.&lt;Integer&gt;rangeLexOrdering().onKeys().sortedCopy(insertionOrder);
103                   }
104                   @SuppressWarnings("unchecked")
105                   @Override
106                   public Range&lt;Integer&gt;[] createKeyArray(int length) {
107                     return new Range[length];
108                   }
109                   @Override
110                   public String[] createValueArray(int length) {
111                     return new String[length];
112                   }
113                 })
114             .named("TreeRangeMap.subRangeMap.asMapOfRanges")
115             .withFeatures(
116                 CollectionSize.ANY,
117                 MapFeature.SUPPORTS_REMOVE,
118                 MapFeature.ALLOWS_ANY_NULL_QUERIES,
119                 CollectionFeature.KNOWN_ORDER)
120             .createTestSuite());
121     suite.addTest(
122         MapTestSuiteBuilder.using(
123                 new TestMapGenerator&lt;Range&lt;Integer&gt;, String&gt;() {
124                   @Override
125                   public SampleElements&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; samples() {
126                     return new SampleElements&lt;&gt;(
127                         mapEntry(Range.singleton(0), "banana"),
128                         mapEntry(Range.closedOpen(3, 5), "frisbee"),
129                         mapEntry(Range.atMost(-1), "fruitcake"),
130                         mapEntry(Range.open(10, 15), "elephant"),
131                         mapEntry(Range.closed(20, 22), "umbrella"));
132                   }
133                   @Override
134                   public Map&lt;Range&lt;Integer&gt;, String&gt; create(Object... elements) {
135                     RangeMap&lt;Integer, String&gt; rangeMap = TreeRangeMap.create();
136                     for (Object o : elements) {
137                       @SuppressWarnings("unchecked")
138                       Entry&lt;Range&lt;Integer&gt;, String&gt; entry = (Entry&lt;Range&lt;Integer&gt;, String&gt;) o;
139                       rangeMap.put(entry.getKey(), entry.getValue());
140                     }
141                     return rangeMap.asDescendingMapOfRanges();
142                   }
143                   @SuppressWarnings("unchecked")
144                   @Override
145                   public Entry&lt;Range&lt;Integer&gt;, String&gt;[] createArray(int length) {
146                     return new Entry[length];
147                   }
148                   @Override
149                   public Iterable&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; order(
150                       List&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; insertionOrder) {
151                     return Range.&lt;Integer&gt;rangeLexOrdering()
152                         .reverse()
153                         .onKeys()
154                         .sortedCopy(insertionOrder);
155                   }
156                   @SuppressWarnings("unchecked")
157                   @Override
158                   public Range&lt;Integer&gt;[] createKeyArray(int length) {
159                     return new Range[length];
160                   }
161                   @Override
162                   public String[] createValueArray(int length) {
163                     return new String[length];
164                   }
165                 })
166             .named("TreeRangeMap.asDescendingMapOfRanges")
167             .withFeatures(
168                 CollectionSize.ANY,
169                 MapFeature.SUPPORTS_REMOVE,
170                 MapFeature.ALLOWS_ANY_NULL_QUERIES,
171                 CollectionFeature.KNOWN_ORDER,
172                 CollectionFeature.SUPPORTS_ITERATOR_REMOVE)
173             .createTestSuite());
174     suite.addTest(
175         MapTestSuiteBuilder.using(
176                 new TestMapGenerator&lt;Range&lt;Integer&gt;, String&gt;() {
177                   @Override
178                   public SampleElements&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; samples() {
179                     return new SampleElements&lt;&gt;(
180                         mapEntry(Range.singleton(0), "banana"),
181                         mapEntry(Range.closedOpen(3, 5), "frisbee"),
182                         mapEntry(Range.atMost(-1), "fruitcake"),
183                         mapEntry(Range.open(10, 15), "elephant"),
184                         mapEntry(Range.closed(20, 22), "umbrella"));
185                   }
186                   @Override
187                   public Map&lt;Range&lt;Integer&gt;, String&gt; create(Object... elements) {
188                     RangeMap&lt;Integer, String&gt; rangeMap = TreeRangeMap.create();
189                     for (Object o : elements) {
190                       @SuppressWarnings("unchecked")
191                       Entry&lt;Range&lt;Integer&gt;, String&gt; entry = (Entry&lt;Range&lt;Integer&gt;, String&gt;) o;
192                       rangeMap.put(entry.getKey(), entry.getValue());
193                     }
194                     return rangeMap.subRangeMap(Range.atMost(22)).asDescendingMapOfRanges();
195                   }
196                   @SuppressWarnings("unchecked")
197                   @Override
198                   public Entry&lt;Range&lt;Integer&gt;, String&gt;[] createArray(int length) {
199                     return new Entry[length];
200                   }
201                   @Override
202                   public Iterable&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; order(
203                       List&lt;Entry&lt;Range&lt;Integer&gt;, String&gt;&gt; insertionOrder) {
204                     return Range.&lt;Integer&gt;rangeLexOrdering()
205                         .reverse()
206                         .onKeys()
207                         .sortedCopy(insertionOrder);
208                   }
209                   @SuppressWarnings("unchecked")
210                   @Override
211                   public Range&lt;Integer&gt;[] createKeyArray(int length) {
212                     return new Range[length];
213                   }
214                   @Override
215                   public String[] createValueArray(int length) {
216                     return new String[length];
217                   }
218                 })
219             .named("TreeRangeMap.subRangeMap.asDescendingMapOfRanges")
220             .withFeatures(
221                 CollectionSize.ANY,
222                 MapFeature.SUPPORTS_REMOVE,
223                 MapFeature.ALLOWS_ANY_NULL_QUERIES,
224                 CollectionFeature.KNOWN_ORDER)
225             .createTestSuite());
226     return suite;
227   }
228   private static final ImmutableList&lt;Range&lt;Integer&gt;&gt; RANGES;
229   private static final int MIN_BOUND = -1;
230   private static final int MAX_BOUND = 1;
231   static {
232     ImmutableList.Builder&lt;Range&lt;Integer&gt;&gt; builder = ImmutableList.builder();
233     builder.add(Range.&lt;Integer&gt;all());
234     for (int i = MIN_BOUND; i &lt;= MAX_BOUND; i++) {
235       for (BoundType type : BoundType.values()) {
236         builder.add(Range.upTo(i, type));
237         builder.add(Range.downTo(i, type));
238       }
239     }
240     for (int i = MIN_BOUND; i &lt;= MAX_BOUND; i++) {
241       for (int j = i; j &lt;= MAX_BOUND; j++) {
242         for (BoundType lowerType : BoundType.values()) {
243           for (BoundType upperType : BoundType.values()) {
244             if (i == j &amp; lowerType == OPEN &amp; upperType == OPEN) {
245               continue;
246             }
247             builder.add(Range.range(i, lowerType, j, upperType));
248           }
249         }
250       }
251     }
252     RANGES = builder.build();
253 <a name="4"></a>  }
254   public void testSpanSingleRange() {
255     <font color="#6cc417"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>for (Range&lt;Integer&gt; range : RANGES) {
256       RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
257       rangeMap.put(range, 1);
258       try {
259         assertEquals(range, rangeMap.span());
260 <a name="5"></a>        assertFalse(range.isEmpty());
261       } catch (NoSuchElementException e) {
262         assertTrue</b></font>(range.isEmpty());
263       <font color="#151b8d"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}
264     }
265   }
266   public void testSpanTwoRanges() {
267     for (Range&lt;Integer&gt; range1 : RANGES) {
268       for (Range&lt;Integer&gt; range2 : RANGES) {
269         RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create</b></font>();
270         rangeMap.put(range1, 1);
271         rangeMap.put(range2, 2);
272         Range&lt;Integer&gt; expected;
273         if (range1.isEmpty()) {
274           if (range2.isEmpty()) {
275             expected = null;
276           } else {
277             expected = range2;
278           }
279         } else {
280           if (range2.isEmpty()) {
281             expected = range1;
282           } else {
283             expected = range1.span(range2);
284           }
285 <a name="7"></a>        }
286         try {
287           <font color="#38a4a5"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>assertEquals(expected, rangeMap.span());
288           assertNotNull(expected);
289         } catch (NoSuchElementException e) {
290 <a name="14"></a>          assertNull(expected);
291         }
292       }
293     <font color="#842dce"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}</b></font>
294   }
295   public void testAllRangesAlone() {
296 <a name="3"></a>    for (Range&lt;Integer&gt; range : RANGES) {
297       Map&lt;Integer, Integer&gt; model = Maps.newHashMap();
298       putModel</b></font>(model, range, 1);
299       RangeMap&lt;Integer, Integer&gt; test = <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>TreeRangeMap.create();
300       test.put(range, 1);
301       verify(model, test);
302     }
303   }
304   public void testAllRangePairs() {
305     for (Range&lt;Integer&gt; range1 : RANGES) {
306       for (Range&lt;Integer&gt; range2 : RANGES) {
307         Map&lt;Integer, Integer&gt; model = Maps.newHashMap</b></font>();
308 <a name="2"></a>        putModel(model, range1, 1);
309         putModel(model, range2, 2);
310         RangeMap&lt;Integer, Integer&gt; test = TreeRangeMap.create();
311         <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>test.put(range1, 1);
312         test.put(range2, 2);
313         verify(model, test);
314       }
315     }
316   }
317   public void testAllRangeTriples() {
318 <a name="17"></a>    for (Range&lt;Integer&gt; range1 : RANGES) {
319       for (Range&lt;Integer&gt; range2 : RANGES) {</b></font>
320         for (Range&lt;Integer&gt; range3 : RANGES) {
321           <font color="#3090c7"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>Map&lt;Integer, Integer&gt; model = Maps.newHashMap();
322           putModel(model, range1, 1);
323           putModel(model, range2, 2);
324           putModel(model, range3, 3);
325           RangeMap&lt;Integer, Integer&gt; test = TreeRangeMap.create();
326           test.put(range1, 1);
327           test.put</b></font>(range2, 2);
328 <a name="6"></a>          test.put(range3, 3);
329           verify(model, test);
330         }
331       <font color="#8c8774"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}
332     }
333   }
334   public void testPutAll() {
335     for (Range&lt;Integer&gt; range1 : RANGES) {
336       for (Range&lt;Integer&gt; range2 : RANGES) {</b></font>
337         for (Range&lt;Integer&gt; range3 : RANGES) {
338           Map&lt;Integer, Integer&gt; model = Maps.newHashMap();
339           putModel(model, range1, 1);
340 <a name="9"></a>          putModel(model, range2, 2);
341           putModel(model, range3, 3);
342           RangeMap&lt;Integer, Integer&gt; test = TreeRangeMap.create();
343           <font color="#83a33a"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>RangeMap&lt;Integer, Integer&gt; test2 = TreeRangeMap.create();
344           test.put(range1, 1);
345           test2.put(range2, 2);
346           test2.put(range3, 3);
347           test.putAll(test2);
348 <a name="12"></a>          verify(model, test);
349         }
350       }
351     <font color="#571b7e"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}</b></font>
352   }
353   public void testPutAndRemove() {
354     for (Range&lt;Integer&gt; rangeToPut : RANGES) {
355       for (Range&lt;Integer&gt; rangeToRemove : RANGES) {</b></font>
356         Map&lt;Integer, Integer&gt; model = Maps.newHashMap();
357 <a name="1"></a>        putModel(model, rangeToPut, 1);
358         removeModel(model, rangeToRemove);
359         RangeMap&lt;Integer, Integer&gt; test = TreeRangeMap.create();
360         <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>test.put(rangeToPut, 1);
361         test.remove(rangeToRemove);
362         verify(model, test);
363       }
364     }
365   }
366   public void testPutTwoAndRemove() {
367     for (Range&lt;Integer&gt; rangeToPut1 : RANGES) {
368       for (Range&lt;Integer&gt; rangeToPut2 : RANGES) {</b></font>
369         for (Range&lt;Integer&gt; rangeToRemove : RANGES) {
370           Map&lt;Integer, Integer&gt; model = Maps.newHashMap();
371 <a name="13"></a>          putModel(model, rangeToPut1, 1);
372           putModel(model, rangeToPut2, 2);
373           removeModel(model, rangeToRemove);
374           <font color="#3b9c9c"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>RangeMap&lt;Integer, Integer&gt; test = TreeRangeMap.create();
375           test.put(rangeToPut1, 1);
376           test.put(rangeToPut2, 2);
377           test.remove(rangeToRemove);
378           verify(model, test);
379         }
380       }
381     }</b></font>
382   }
383 <a name="11"></a>    public void testPutCoalescingTwoAndRemove() {
384     for (Range&lt;Integer&gt; rangeToPut1 : RANGES) <font color="#b041ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>{
385       for (Range&lt;Integer&gt; rangeToPut2 : RANGES) {
386         for (Range&lt;Integer&gt; rangeToRemove : RANGES) {
387           Map&lt;Integer, Integer&gt; model = Maps.newHashMap();
388           putModel(model, rangeToPut1, 1);
389           putModel(model, rangeToPut2, 2);
390           removeModel</b></font>(model, rangeToRemove);
391           RangeMap&lt;Integer, Integer&gt; test = TreeRangeMap.create();
392           test.putCoalescing(rangeToPut1, 1);
393           test.putCoalescing(rangeToPut2, 2);
394 <a name="18"></a>          test.remove(rangeToRemove);
395           verify(model, test);
396         }
397       <font color="#800517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}
398     }
399   }
400 <a name="8"></a>  public void testPutCoalescing() {
401     RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create()</b></font>;
402     <font color="#c58917"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>rangeMap.putCoalescing(Range.closedOpen(0, 1), 1);
403     rangeMap.putCoalescing(Range.closedOpen(1, 2), 1);
404     rangeMap.putCoalescing(Range.closedOpen(2, 3), 2);
405     assertEquals(
406         ImmutableMap.of(Range.closedOpen(0, 2), 1, Range.closedOpen(2, 3), 2),
407         rangeMap.asMapOfRanges());
408   }</b></font>
409   public void testPutCoalescingEmpty() {
410     RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
411     rangeMap.put(Range.closedOpen(0, 1), 1);
412     rangeMap.put(Range.closedOpen(1, 2), 1);
413     assertEquals(
414         ImmutableMap.of(Range.closedOpen(0, 1), 1, Range.closedOpen(1, 2), 1),
415         rangeMap.asMapOfRanges());
416     rangeMap.putCoalescing(Range.closedOpen(1, 1), 1);     assertEquals(ImmutableMap.of(Range.closedOpen(0, 2), 1), rangeMap.asMapOfRanges());
417   }
418   public void testPutCoalescingSubmapEmpty() {
419     RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
420     rangeMap.put(Range.closedOpen(0, 1), 1);
421     rangeMap.put(Range.closedOpen(1, 2), 1);
422     assertEquals(
423         ImmutableMap.of(Range.closedOpen(0, 1), 1, Range.closedOpen(1, 2), 1),
424         rangeMap.asMapOfRanges());
425     RangeMap&lt;Integer, Integer&gt; subRangeMap = rangeMap.subRangeMap(Range.closedOpen(0, 2));
426     subRangeMap.putCoalescing(Range.closedOpen(1, 1), 1);     assertEquals(ImmutableMap.of(Range.closedOpen(0, 2), 1), subRangeMap.asMapOfRanges());
427     assertEquals(ImmutableMap.of(Range.closedOpen(0, 2), 1), rangeMap.asMapOfRanges());
428   }
429   public void testPutCoalescingComplex() {
430     RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
431     rangeMap.put(Range.closedOpen(0, 1), 1);
432     rangeMap.put(Range.closedOpen(1, 3), 1);
433     rangeMap.put(Range.closedOpen(3, 5), 1);
434     rangeMap.put(Range.closedOpen(7, 10), 2);
435     rangeMap.put(Range.closedOpen(12, 15), 2);
436     rangeMap.put(Range.closedOpen(18, 19), 3);
437     rangeMap.putCoalescing(Range.closedOpen(-5, -4), 0);     rangeMap.putCoalescing(Range.closedOpen(-6, -5), 0); 
438     rangeMap.putCoalescing(Range.closedOpen(2, 4), 1);     rangeMap.putCoalescing(Range.closedOpen(9, 14), 0);     rangeMap.putCoalescing(Range.closedOpen(17, 20), 3); 
439     rangeMap.putCoalescing(Range.closedOpen(22, 23), 4);     rangeMap.putCoalescing(Range.closedOpen(23, 25), 4); 
440     assertEquals(
441         new ImmutableMap.Builder&lt;&gt;()
442             .put(Range.closedOpen(-6, -4), 0)
443             .put(Range.closedOpen(0, 1), 1)             .put(Range.closedOpen(1, 5), 1)
444             .put(Range.closedOpen(7, 9), 2)
445             .put(Range.closedOpen(9, 14), 0)
446             .put(Range.closedOpen(14, 15), 2)
447             .put(Range.closedOpen(17, 20), 3)
448             .put(Range.closedOpen(22, 25), 4)
449             .build(),
450         rangeMap.asMapOfRanges());
451   }
452   public void testSubRangeMapExhaustive() {
453     for (Range&lt;Integer&gt; range1 : RANGES) {
454       for (Range&lt;Integer&gt; range2 : RANGES) {
455         RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
456         rangeMap.put(range1, 1);
457         rangeMap.put(range2, 2);
458         for (Range&lt;Integer&gt; subRange : RANGES) {
459           RangeMap&lt;Integer, Integer&gt; expected = TreeRangeMap.create();
460           for (Entry&lt;Range&lt;Integer&gt;, Integer&gt; entry : rangeMap.asMapOfRanges().entrySet()) {
461             if (entry.getKey().isConnected(subRange)) {
462               expected.put(entry.getKey().intersection(subRange), entry.getValue());
463             }
464           }
465           RangeMap&lt;Integer, Integer&gt; subRangeMap = rangeMap.subRangeMap(subRange);
466           assertEquals(expected, subRangeMap);
467           assertEquals(expected.asMapOfRanges(), subRangeMap.asMapOfRanges());
468           assertEquals(expected.asDescendingMapOfRanges(), subRangeMap.asDescendingMapOfRanges());
469           assertEquals(
470               ImmutableList.copyOf(subRangeMap.asMapOfRanges().entrySet()).reverse(),
471               ImmutableList.copyOf(subRangeMap.asDescendingMapOfRanges().entrySet()));
472           if (!expected.asMapOfRanges().isEmpty()) {
473             assertEquals(expected.span(), subRangeMap.span());
474           }
475           for (int i = MIN_BOUND; i &lt;= MAX_BOUND; i++) {
476             assertEquals(expected.get(i), subRangeMap.get(i));
477           }
478           for (Range&lt;Integer&gt; query : RANGES) {
479             assertEquals(
480                 expected.asMapOfRanges().get(query), subRangeMap.asMapOfRanges().get(query));
481           }
482         }
483       }
484     }
485   }
486   public void testSubSubRangeMap() {
487     RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
488     rangeMap.put(Range.open(3, 7), 1);
489     rangeMap.put(Range.closed(9, 10), 2);
490     rangeMap.put(Range.closed(12, 16), 3);
491     RangeMap&lt;Integer, Integer&gt; sub1 = rangeMap.subRangeMap(Range.closed(5, 11));
492     assertEquals(
493         ImmutableMap.of(Range.closedOpen(5, 7), 1, Range.closed(9, 10), 2), sub1.asMapOfRanges());
494     RangeMap&lt;Integer, Integer&gt; sub2 = sub1.subRangeMap(Range.open(6, 15));
495     assertEquals(
496         ImmutableMap.of(Range.open(6, 7), 1, Range.closed(9, 10), 2), sub2.asMapOfRanges());
497 <a name="0"></a>  }
498   public void testSubRangeMapPut() {
499     RangeMap&lt;Integer, Integer&gt; rangeMap = <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>TreeRangeMap.create();
500     rangeMap.put(Range.open(3, 7), 1);
501     rangeMap.put(Range.closed(9, 10), 2);
502     rangeMap.put(Range.closed(12, 16), 3);
503     RangeMap&lt;Integer, Integer&gt; sub = rangeMap.subRangeMap(Range.closed(5, 11));
504     assertEquals(
505         ImmutableMap.of(Range.closedOpen(5, 7), 1, Range.closed(9, 10), 2), sub.asMapOfRanges());
506     sub.put(Range.closed(7, 9), 4);
507     assertEquals(
508         ImmutableMap.of(
509             Range.closedOpen(5, 7), 1, Range.closed(7, 9), 4, Range.openClosed(9, 10), 2),
510         sub.asMapOfRanges());
511     assertEquals(
512         ImmutableMap.of(
513             Range.open(3, 7),
514             1,
515             Range.closed(7, 9),
516             4,
517             Range.openClosed</b></font>(9, 10),
518             2,
519             Range.closed(12, 16),
520 <a name="16"></a>            3),
521         rangeMap.asMapOfRanges());
522     <font color="#2981b2"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>try {
523       sub.put(Range.open(9, 12), 5);
524       fail("Expected IllegalArgumentException");
525     } catch (IllegalArgumentException expected) {</b></font>
526     }
527     sub = sub.subRangeMap(Range.closedOpen(5, 5));
528     sub.put(Range.closedOpen(5, 5), 6);     assertEquals(
529         ImmutableMap.of(
530             Range.open(3, 7),
531             1,
532             Range.closed(7, 9),
533             4,
534             Range.openClosed(9, 10),
535             2,
536             Range.closed(12, 16),
537             3),
538         rangeMap.asMapOfRanges());
539   }
540   public void testSubRangeMapPutCoalescing() {
541     RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
542     rangeMap.put(Range.open(3, 7), 1);
543     rangeMap.put(Range.closed(9, 10), 2);
544     rangeMap.put(Range.closed(12, 16), 3);
545     RangeMap&lt;Integer, Integer&gt; sub = rangeMap.subRangeMap(Range.closed(5, 11));
546     assertEquals(
547         ImmutableMap.of(Range.closedOpen(5, 7), 1, Range.closed(9, 10), 2), sub.asMapOfRanges());
548     sub.putCoalescing(Range.closed(7, 9), 2);
549     assertEquals(
550         ImmutableMap.of(Range.closedOpen(5, 7), 1, Range.closed(7, 10), 2), sub.asMapOfRanges());
551     assertEquals(
552         ImmutableMap.of(Range.open(3, 7), 1, Range.closed(7, 10), 2, Range.closed(12, 16), 3),
553         rangeMap.asMapOfRanges());
554     sub.putCoalescing(Range.singleton(7), 1);
555     assertEquals(
556         ImmutableMap.of(Range.closed(5, 7), 1, Range.openClosed(7, 10), 2), sub.asMapOfRanges());
557     assertEquals(
558         ImmutableMap.of(
559             Range.open(3, 5),
560             1,
561             Range.closed(5, 7),
562             1,
563             Range.openClosed(7, 10),
564             2,
565             Range.closed(12, 16),
566 <a name="10"></a>            3),
567         rangeMap.asMapOfRanges());
568     <font color="#ad5910"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>try {
569       sub.putCoalescing(Range.open(9, 12), 5);
570       fail("Expected IllegalArgumentException");
571     } catch (IllegalArgumentException expected) {
572     }
573   }</b></font>
574   public void testSubRangeMapRemove() {
575     RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
576     rangeMap.put(Range.open(3, 7), 1);
577     rangeMap.put(Range.closed(9, 10), 2);
578     rangeMap.put(Range.closed(12, 16), 3);
579     RangeMap&lt;Integer, Integer&gt; sub = rangeMap.subRangeMap(Range.closed(5, 11));
580     assertEquals(
581         ImmutableMap.of(Range.closedOpen(5, 7), 1, Range.closed(9, 10), 2), sub.asMapOfRanges());
582     sub.remove(Range.closed(7, 9));
583     assertEquals(
584         ImmutableMap.of(Range.closedOpen(5, 7), 1, Range.openClosed(9, 10), 2),
585         sub.asMapOfRanges());
586     assertEquals(
587         ImmutableMap.of(Range.open(3, 7), 1, Range.openClosed(9, 10), 2, Range.closed(12, 16), 3),
588         rangeMap.asMapOfRanges());
589     sub.remove(Range.closed(3, 9));
590     assertEquals(ImmutableMap.of(Range.openClosed(9, 10), 2), sub.asMapOfRanges());
591     assertEquals(
592         ImmutableMap.of(Range.open(3, 5), 1, Range.openClosed(9, 10), 2, Range.closed(12, 16), 3),
593         rangeMap.asMapOfRanges());
594   }
595   public void testSubRangeMapClear() {
596     RangeMap&lt;Integer, Integer&gt; rangeMap = TreeRangeMap.create();
597     rangeMap.put(Range.open(3, 7), 1);
598     rangeMap.put(Range.closed(9, 10), 2);
599     rangeMap.put(Range.closed(12, 16), 3);
600     RangeMap&lt;Integer, Integer&gt; sub = rangeMap.subRangeMap(Range.closed(5, 11));
601     sub.clear();
602     assertEquals(
603         ImmutableMap.of(Range.open(3, 5), 1, Range.closed(12, 16), 3), rangeMap.asMapOfRanges());
604   }
605   private void verify(Map&lt;Integer, Integer&gt; model, RangeMap&lt;Integer, Integer&gt; test) {
606     for (int i = MIN_BOUND - 1; i &lt;= MAX_BOUND + 1; i++) {
607       assertEquals(model.get(i), test.get(i));
608       Entry&lt;Range&lt;Integer&gt;, Integer&gt; entry = test.getEntry(i);
609       assertEquals(model.containsKey(i), entry != null);
610       if (entry != null) {
611         assertTrue(test.asMapOfRanges().entrySet().contains(entry));
612       }
613     }
614     for (Range&lt;Integer&gt; range : test.asMapOfRanges().keySet()) {
615       assertFalse(range.isEmpty());
616     }
617   }
618   private static void putModel(Map&lt;Integer, Integer&gt; model, Range&lt;Integer&gt; range, int value) {
619     for (int i = MIN_BOUND - 1; i &lt;= MAX_BOUND + 1; i++) {
620       if (range.contains(i)) {
621         model.put(i, value);
622       }
623     }
624   }
625   private static void removeModel(Map&lt;Integer, Integer&gt; model, Range&lt;Integer&gt; range) {
626     for (int i = MIN_BOUND - 1; i &lt;= MAX_BOUND + 1; i++) {
627       if (range.contains(i)) {
628         model.remove(i);
629       }
630     }
631   }
632 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
