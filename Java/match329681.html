<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for FeatureEnumTest_1.java & MapRemoveTester_1.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for FeatureEnumTest_1.java & MapRemoveTester_1.java
      </h3>
      <h1 align="center">
        15.9%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>FeatureEnumTest_1.java (23.4375%)<TH>MapRemoveTester_1.java (12.048193%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match329681-0.html#0',2,'match329681-1.html#0',3)" NAME="0">(37-48)<TD><A HREF="javascript:ZweiFrames('match329681-0.html#0',2,'match329681-1.html#0',3)" NAME="0">(105-113)</A><TD ALIGN=center><FONT COLOR="#ff0000">11</FONT>
<TR><TD BGCOLOR="#f63526"><FONT COLOR="#f63526">-</FONT><TD><A HREF="javascript:ZweiFrames('match329681-0.html#1',2,'match329681-1.html#1',3)" NAME="1">(58-67)<TD><A HREF="javascript:ZweiFrames('match329681-0.html#1',2,'match329681-1.html#1',3)" NAME="1">(50-53)</A><TD ALIGN=center><FONT COLOR="#e70000">10</FONT>
<TR><TD BGCOLOR="#980517"><FONT COLOR="#980517">-</FONT><TD><A HREF="javascript:ZweiFrames('match329681-0.html#2',2,'match329681-1.html#2',3)" NAME="2">(105-113)<TD><A HREF="javascript:ZweiFrames('match329681-0.html#2',2,'match329681-1.html#2',3)" NAME="2">(97-102)</A><TD ALIGN=center><FONT COLOR="#d00000">9</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>FeatureEnumTest_1.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2008 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.google.common.collect.testing.features;

import java.lang.annotation.Annotation;
import java.lang.annotation.Inherited;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.reflect.Method;
import java.util.Locale;
import junit.framework.TestCase;

/**
 * Since annotations have some reusability issues that force copy and paste all over the place, it's
 * worth having a test to ensure that all our Feature enums have their annotations correctly set up.
 *
 * @author George van den Driessche
 */
public class FeatureEnumTest extends TestCase {
<A NAME="0"></A>  private static void assertGoodTesterAnnotation(Class&lt;? extends Annotation&gt; annotationClass) {
    assertNotNull(
        rootLocaleFormat(&quot;%s must be annotated with @TesterAnnotation.&quot;, annotationClass),
        <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match329681-1.html#0',3,'match329681-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>annotationClass.getAnnotation(TesterAnnotation.class));
    final Retention retentionPolicy = annotationClass.getAnnotation(Retention.class);
    assertNotNull(
        rootLocaleFormat(&quot;%s must have a @Retention annotation.&quot;, annotationClass),
        retentionPolicy);
    assertEquals(
        rootLocaleFormat(&quot;%s must have RUNTIME RetentionPolicy.&quot;, annotationClass),
        RetentionPolicy.RUNTIME,
        retentionPolicy.value());
    assertNotNull(
        rootLocaleFormat(&quot;%s must be inherited.&quot;, annotationClass),
        annotationClass.getAnnotation</B></FONT>(Inherited.class));

    for (String propertyName : new String[] {&quot;value&quot;, &quot;absent&quot;}) {
      Method method = null;
      try {
        method = annotationClass.getMethod(propertyName);
      } catch (NoSuchMethodException e) {
<A NAME="1"></A>        fail(
            rootLocaleFormat(&quot;%s must have a property named '%s'.&quot;, annotationClass, propertyName));
      }
      <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match329681-1.html#1',3,'match329681-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>final Class&lt;?&gt; returnType = method.getReturnType();
      assertTrue(
          rootLocaleFormat(&quot;%s.%s() must return an array.&quot;, annotationClass, propertyName),
          returnType.isArray());
      assertSame(
          rootLocaleFormat(
              &quot;%s.%s() must return an array of %s.&quot;,
              annotationClass, propertyName, annotationClass.getDeclaringClass()),
          annotationClass.getDeclaringClass(),
          returnType.getComponentType</B></FONT>());
    }
  }

  // This is public so that tests for Feature enums we haven't yet imagined
  // can reuse it.
  public static &lt;E extends Enum&lt;?&gt; &amp; Feature&lt;?&gt;&gt; void assertGoodFeatureEnum(
      Class&lt;E&gt; featureEnumClass) {
    final Class&lt;?&gt;[] classes = featureEnumClass.getDeclaredClasses();
    for (Class&lt;?&gt; containedClass : classes) {
      if (containedClass.getSimpleName().equals(&quot;Require&quot;)) {
        if (containedClass.isAnnotation()) {
          assertGoodTesterAnnotation(asAnnotation(containedClass));
        } else {
          fail(
              rootLocaleFormat(
                  &quot;Feature enum %s contains a class named &quot;
                      + &quot;'Require' but it is not an annotation.&quot;,
                  featureEnumClass));
        }
        return;
      }
    }
    fail(
        rootLocaleFormat(
            &quot;Feature enum %s should contain an &quot; + &quot;annotation named 'Require'.&quot;,
            featureEnumClass));
  }

  @SuppressWarnings(&quot;unchecked&quot;)
  private static Class&lt;? extends Annotation&gt; asAnnotation(Class&lt;?&gt; clazz) {
    if (clazz.isAnnotation()) {
      return (Class&lt;? extends Annotation&gt;) clazz;
    } else {
      throw new IllegalArgumentException(rootLocaleFormat(&quot;%s is not an annotation.&quot;, clazz));
<A NAME="2"></A>    }
  }

  public void testFeatureEnums() throws Exception <FONT color="#980517"><A HREF="javascript:ZweiFrames('match329681-1.html#2',3,'match329681-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
    assertGoodFeatureEnum(CollectionFeature.class);
    assertGoodFeatureEnum(ListFeature.class);
    assertGoodFeatureEnum(SetFeature.class);
    assertGoodFeatureEnum(CollectionSize.class);
    assertGoodFeatureEnum(MapFeature.class);
  }

  private static S</B></FONT>tring rootLocaleFormat(String format, Object... args) {
    return String.format(Locale.ROOT, format, args);
  }
}
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>MapRemoveTester_1.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2008 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.google.common.collect.testing.testers;

import static com.google.common.collect.testing.features.CollectionSize.SEVERAL;
import static com.google.common.collect.testing.features.CollectionSize.ZERO;
import static com.google.common.collect.testing.features.MapFeature.ALLOWS_NULL_KEYS;
import static com.google.common.collect.testing.features.MapFeature.ALLOWS_NULL_KEY_QUERIES;
import static com.google.common.collect.testing.features.MapFeature.FAILS_FAST_ON_CONCURRENT_MODIFICATION;
import static com.google.common.collect.testing.features.MapFeature.SUPPORTS_REMOVE;

import com.google.common.annotations.GwtCompatible;
import com.google.common.collect.testing.AbstractMapTester;
import com.google.common.collect.testing.WrongType;
import com.google.common.collect.testing.features.CollectionSize;
import com.google.common.collect.testing.features.MapFeature;
import java.util.ConcurrentModificationException;
import java.util.Iterator;
import java.util.Map.Entry;
import org.junit.Ignore;

/**
 * A generic JUnit test which tests {@code remove} operations on a map. Can't be invoked directly;
 * please see {@link com.google.common.collect.testing.MapTestSuiteBuilder}.
 *
 * @author George van den Driessche
 * @author Chris Povirk
 */
@SuppressWarnings(&quot;unchecked&quot;) // too many &quot;unchecked generic array creations&quot;
@GwtCompatible
@Ignore // Affects only Android test runner, which respects JUnit 4 annotations on JUnit 3 tests.
public class MapRemoveTester&lt;K, V&gt; extends AbstractMapTester&lt;K, V&gt; {
<A NAME="1"></A>  @MapFeature.Require(SUPPORTS_REMOVE)
  @CollectionSize.Require(absent = ZERO)
  public void testRemove_present() {
    <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match329681-0.html#1',2,'match329681-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>int initialSize = getMap().size();
    assertEquals(&quot;remove(present) should return the associated value&quot;, v0(), getMap().remove(k0()));
    assertEquals(
        &quot;remove(present) should decrease a map's size by one.&quot;, initialSize - 1, getMap().size</B></FONT>());
    expectMissing(e0());
  }

  @MapFeature.Require({FAILS_FAST_ON_CONCURRENT_MODIFICATION, SUPPORTS_REMOVE})
  @CollectionSize.Require(SEVERAL)
  public void testRemovePresentConcurrentWithEntrySetIteration() {
    try {
      Iterator&lt;Entry&lt;K, V&gt;&gt; iterator = getMap().entrySet().iterator();
      getMap().remove(k0());
      iterator.next();
      fail(&quot;Expected ConcurrentModificationException&quot;);
    } catch (ConcurrentModificationException expected) {
      // success
    }
  }

  @MapFeature.Require({FAILS_FAST_ON_CONCURRENT_MODIFICATION, SUPPORTS_REMOVE})
  @CollectionSize.Require(SEVERAL)
  public void testRemovePresentConcurrentWithKeySetIteration() {
    try {
      Iterator&lt;K&gt; iterator = getMap().keySet().iterator();
      getMap().remove(k0());
      iterator.next();
      fail(&quot;Expected ConcurrentModificationException&quot;);
    } catch (ConcurrentModificationException expected) {
      // success
    }
  }

  @MapFeature.Require({FAILS_FAST_ON_CONCURRENT_MODIFICATION, SUPPORTS_REMOVE})
  @CollectionSize.Require(SEVERAL)
  public void testRemovePresentConcurrentWithValuesIteration() {
    try {
      Iterator&lt;V&gt; iterator = getMap().values().iterator();
      getMap().remove(k0());
      iterator.next();
      fail(&quot;Expected ConcurrentModificationException&quot;);
    } catch (ConcurrentModificationException expected) {
      // success
    }
<A NAME="2"></A>  }

  @MapFeature.Require(SUPPORTS_REMOVE)
  public void testRemove_notPresent() <FONT color="#980517"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match329681-0.html#2',2,'match329681-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>{
    assertNull(&quot;remove(notPresent) should return null&quot;, getMap().remove(k3()));
    expectUnchanged();
  }

<A NAME="0"></A>  @MapFeature.Require({S</B></FONT>UPPORTS_REMOVE, ALLOWS_NULL_KEYS})
  @CollectionSize.Require(absent = ZERO)
  public void testRemove_nullPresent() {
    <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match329681-0.html#0',2,'match329681-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>initMapWithNullKey();

    int initialSize = getMap().size();
    assertEquals(
        &quot;remove(null) should return the associated value&quot;,
        getValueForNullKey(),
        getMap().remove(null));
    assertEquals(
        &quot;remove(present) should decrease a map's size by one.&quot;, initialSize - 1, getMap</B></FONT>().size());
    expectMissing(entry(null, getValueForNullKey()));
  }

  @MapFeature.Require(absent = SUPPORTS_REMOVE)
  @CollectionSize.Require(absent = ZERO)
  public void testRemove_unsupported() {
    try {
      getMap().remove(k0());
      fail(&quot;remove(present) should throw UnsupportedOperationException&quot;);
    } catch (UnsupportedOperationException expected) {
    }
    expectUnchanged();
    assertEquals(&quot;remove(present) should not remove the element&quot;, v0(), get(k0()));
  }

  @MapFeature.Require(absent = SUPPORTS_REMOVE)
  public void testRemove_unsupportedNotPresent() {
    try {
      assertNull(
          &quot;remove(notPresent) should return null or throw UnsupportedOperationException&quot;,
          getMap().remove(k3()));
    } catch (UnsupportedOperationException tolerated) {
    }
    expectUnchanged();
    expectMissing(e3());
  }

  @MapFeature.Require(value = SUPPORTS_REMOVE, absent = ALLOWS_NULL_KEY_QUERIES)
  public void testRemove_nullQueriesNotSupported() {
    try {
      assertNull(
          &quot;remove(null) should return null or throw NullPointerException&quot;, getMap().remove(null));
    } catch (NullPointerException tolerated) {
    }
    expectUnchanged();
  }

  @MapFeature.Require({SUPPORTS_REMOVE, ALLOWS_NULL_KEY_QUERIES})
  public void testRemove_nullSupportedMissing() {
    assertNull(&quot;remove(null) should return null&quot;, getMap().remove(null));
    expectUnchanged();
  }

  @MapFeature.Require(SUPPORTS_REMOVE)
  public void testRemove_wrongType() {
    try {
      assertNull(getMap().remove(WrongType.VALUE));
    } catch (ClassCastException tolerated) {
    }
    expectUnchanged();
  }
}
</PRE>
</div>
  </div>
</body>
</html>
