<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for SortedMultisets.java & EvictingQueueTest_1.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for SortedMultisets.java & EvictingQueueTest_1.java
      </h3>
      <h1 align="center">
        10.6%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>SortedMultisets.java (10.839161%)<TH>EvictingQueueTest_1.java (10.437711%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match630355-0.html#0',2,'match630355-1.html#0',3)" NAME="0">(177-182)<TD><A HREF="javascript:ZweiFrames('match630355-0.html#0',2,'match630355-1.html#0',3)" NAME="0">(173-178)</A><TD ALIGN=center><FONT COLOR="#ff0000">11</FONT>
<TR><TD BGCOLOR="#f63526"><FONT COLOR="#f63526">-</FONT><TD><A HREF="javascript:ZweiFrames('match630355-0.html#1',2,'match630355-1.html#1',3)" NAME="1">(25-39)<TD><A HREF="javascript:ZweiFrames('match630355-0.html#1',2,'match630355-1.html#1',3)" NAME="1">(19-33)</A><TD ALIGN=center><FONT COLOR="#ff0000">11</FONT>
<TR><TD BGCOLOR="#980517"><FONT COLOR="#980517">-</FONT><TD><A HREF="javascript:ZweiFrames('match630355-0.html#2',2,'match630355-1.html#2',3)" NAME="2">(61-65)<TD><A HREF="javascript:ZweiFrames('match630355-0.html#2',2,'match630355-1.html#2',3)" NAME="2">(186-191)</A><TD ALIGN=center><FONT COLOR="#d00000">9</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>SortedMultisets.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2011 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */

package com.google.common.collect;

import static com.google.common.collect.BoundType.CLOSED;
import static com.google.common.collect.BoundType.OPEN;

<A NAME="1"></A>import com.google.common.annotations.GwtCompatible;
import com.google.common.annotations.GwtIncompatible;
import com.google.common.collect.Multiset.Entry;
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match630355-1.html#1',3,'match630355-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import com.google.j2objc.annotations.Weak;
import java.util.Comparator;
import java.util.Iterator;
import java.util.NavigableSet;
import java.util.NoSuchElementException;
import java.util.SortedSet;
import javax.annotation.CheckForNull;
import org.checkerframework.checker.nullness.qual.Nullable;

/**
 * Provides static utility methods for creating and working with {@link SortedMultiset} instances.
 *
 * @author Louis Wasserman
 */
@GwtCompatible(e</B></FONT>mulated = true)
@ElementTypesAreNonnullByDefault
final class SortedMultisets {
  private SortedMultisets() {}

  /** A skeleton implementation for {@link SortedMultiset#elementSet}. */
  @SuppressWarnings(&quot;JdkObsolete&quot;) // TODO(b/6160855): Switch GWT emulations to NavigableSet.
  static class ElementSet&lt;E extends @Nullable Object&gt; extends Multisets.ElementSet&lt;E&gt;
      implements SortedSet&lt;E&gt; {
    @Weak private final SortedMultiset&lt;E&gt; multiset;

    ElementSet(SortedMultiset&lt;E&gt; multiset) {
      this.multiset = multiset;
    }

    @Override
    final SortedMultiset&lt;E&gt; multiset() {
      return multiset;
    }
<A NAME="2"></A>
    @Override
    public Iterator&lt;E&gt; iterator() {
      return <FONT color="#980517"><A HREF="javascript:ZweiFrames('match630355-1.html#2',3,'match630355-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Multisets.elementIterator(multiset().entrySet().iterator());
    }

    @Override
    public Comparator&lt;? super E&gt; comparator() {</B></FONT>
      return multiset().comparator();
    }

    @Override
    public SortedSet&lt;E&gt; subSet(@ParametricNullness E fromElement, @ParametricNullness E toElement) {
      return multiset().subMultiset(fromElement, CLOSED, toElement, OPEN).elementSet();
    }

    @Override
    public SortedSet&lt;E&gt; headSet(@ParametricNullness E toElement) {
      return multiset().headMultiset(toElement, OPEN).elementSet();
    }

    @Override
    public SortedSet&lt;E&gt; tailSet(@ParametricNullness E fromElement) {
      return multiset().tailMultiset(fromElement, CLOSED).elementSet();
    }

    @Override
    @ParametricNullness
    public E first() {
      return getElementOrThrow(multiset().firstEntry());
    }

    @Override
    @ParametricNullness
    public E last() {
      return getElementOrThrow(multiset().lastEntry());
    }
  }

  /** A skeleton navigable implementation for {@link SortedMultiset#elementSet}. */
  @GwtIncompatible // Navigable
  static class NavigableElementSet&lt;E extends @Nullable Object&gt; extends ElementSet&lt;E&gt;
      implements NavigableSet&lt;E&gt; {
    NavigableElementSet(SortedMultiset&lt;E&gt; multiset) {
      super(multiset);
    }

    @Override
    @CheckForNull
    public E lower(@ParametricNullness E e) {
      return getElementOrNull(multiset().headMultiset(e, OPEN).lastEntry());
    }

    @Override
    @CheckForNull
    public E floor(@ParametricNullness E e) {
      return getElementOrNull(multiset().headMultiset(e, CLOSED).lastEntry());
    }

    @Override
    @CheckForNull
    public E ceiling(@ParametricNullness E e) {
      return getElementOrNull(multiset().tailMultiset(e, CLOSED).firstEntry());
    }

    @Override
    @CheckForNull
    public E higher(@ParametricNullness E e) {
      return getElementOrNull(multiset().tailMultiset(e, OPEN).firstEntry());
    }

    @Override
    public NavigableSet&lt;E&gt; descendingSet() {
      return new NavigableElementSet&lt;&gt;(multiset().descendingMultiset());
    }

    @Override
    public Iterator&lt;E&gt; descendingIterator() {
      return descendingSet().iterator();
    }

    @Override
    @CheckForNull
    public E pollFirst() {
      return getElementOrNull(multiset().pollFirstEntry());
    }

    @Override
    @CheckForNull
    public E pollLast() {
      return getElementOrNull(multiset().pollLastEntry());
    }

    @Override
    public NavigableSet&lt;E&gt; subSet(
        @ParametricNullness E fromElement,
        boolean fromInclusive,
        @ParametricNullness E toElement,
        boolean toInclusive) {
      return new NavigableElementSet&lt;&gt;(
          multiset()
              .subMultiset(
                  fromElement, BoundType.forBoolean(fromInclusive),
                  toElement, BoundType.forBoolean(toInclusive)));
    }

    @Override
    public NavigableSet&lt;E&gt; headSet(@ParametricNullness E toElement, boolean inclusive) {
      return new NavigableElementSet&lt;&gt;(
          multiset().headMultiset(toElement, BoundType.forBoolean(inclusive)));
    }

    @Override
    public NavigableSet&lt;E&gt; tailSet(@ParametricNullness E fromElement, boolean inclusive) {
      return new NavigableElementSet&lt;&gt;(
          multiset().tailMultiset(fromElement, BoundType.forBoolean(inclusive)));
<A NAME="0"></A>    }
  }

  private static &lt;E extends @Nullable Object&gt; E getElementOrThrow(@CheckForNull Entry&lt;E&gt; entry) <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match630355-1.html#0',3,'match630355-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
    if (entry == null) {
      throw new NoSuchElementException();
    }
    return entry.getElement();
  }</B></FONT>

  @CheckForNull
  private static &lt;E extends @Nullable Object&gt; E getElementOrNull(@CheckForNull Entry&lt;E&gt; entry) {
    return (entry == null) ? null : entry.getElement();
  }
}
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>EvictingQueueTest_1.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2012 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
<A NAME="1"></A>
package com.google.common.collect;

<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match630355-0.html#1',2,'match630355-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>import com.google.common.annotations.GwtCompatible;
import com.google.common.annotations.GwtIncompatible;
import com.google.common.testing.NullPointerTester;
import com.google.common.testing.SerializableTester;
import java.util.AbstractList;
import java.util.List;
import java.util.NoSuchElementException;
import junit.framework.TestCase;

/**
 * Tests for {@link EvictingQueue}.
 *
 * @author Kurt Alfred Kluever
 */
@GwtCompatible(e</B></FONT>mulated = true)
public class EvictingQueueTest extends TestCase {

  public void testCreateWithNegativeSize() throws Exception {
    try {
      EvictingQueue.create(-1);
      fail();
    } catch (IllegalArgumentException expected) {
    }
  }

  public void testCreateWithZeroSize() throws Exception {
    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(0);
    assertEquals(0, queue.size());

    assertTrue(queue.add(&quot;hi&quot;));
    assertEquals(0, queue.size());

    assertTrue(queue.offer(&quot;hi&quot;));
    assertEquals(0, queue.size());

    assertFalse(queue.remove(&quot;hi&quot;));
    assertEquals(0, queue.size());

    try {
      queue.element();
      fail();
    } catch (NoSuchElementException expected) {
    }

    assertNull(queue.peek());
    assertNull(queue.poll());
    try {
      queue.remove();
      fail();
    } catch (NoSuchElementException expected) {
    }
  }

  public void testRemainingCapacity_maxSize0() {
    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(0);
    assertEquals(0, queue.remainingCapacity());
  }

  public void testRemainingCapacity_maxSize1() {
    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(1);
    assertEquals(1, queue.remainingCapacity());
    queue.add(&quot;hi&quot;);
    assertEquals(0, queue.remainingCapacity());
  }

  public void testRemainingCapacity_maxSize3() {
    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(3);
    assertEquals(3, queue.remainingCapacity());
    queue.add(&quot;hi&quot;);
    assertEquals(2, queue.remainingCapacity());
    queue.add(&quot;hi&quot;);
    assertEquals(1, queue.remainingCapacity());
    queue.add(&quot;hi&quot;);
    assertEquals(0, queue.remainingCapacity());
  }

  public void testEvictingAfterOne() throws Exception {
    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(1);
    assertEquals(0, queue.size());
    assertEquals(1, queue.remainingCapacity());

    assertTrue(queue.add(&quot;hi&quot;));
    assertEquals(&quot;hi&quot;, queue.element());
    assertEquals(&quot;hi&quot;, queue.peek());
    assertEquals(1, queue.size());
    assertEquals(0, queue.remainingCapacity());

    assertTrue(queue.add(&quot;there&quot;));
    assertEquals(&quot;there&quot;, queue.element());
    assertEquals(&quot;there&quot;, queue.peek());
    assertEquals(1, queue.size());
    assertEquals(0, queue.remainingCapacity());

    assertEquals(&quot;there&quot;, queue.remove());
    assertEquals(0, queue.size());
    assertEquals(1, queue.remainingCapacity());
  }

  public void testEvictingAfterThree() throws Exception {
    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(3);
    assertEquals(0, queue.size());
    assertEquals(3, queue.remainingCapacity());

    assertTrue(queue.add(&quot;one&quot;));
    assertTrue(queue.add(&quot;two&quot;));
    assertTrue(queue.add(&quot;three&quot;));
    assertEquals(&quot;one&quot;, queue.element());
    assertEquals(&quot;one&quot;, queue.peek());
    assertEquals(3, queue.size());
    assertEquals(0, queue.remainingCapacity());

    assertTrue(queue.add(&quot;four&quot;));
    assertEquals(&quot;two&quot;, queue.element());
    assertEquals(&quot;two&quot;, queue.peek());
    assertEquals(3, queue.size());
    assertEquals(0, queue.remainingCapacity());

    assertEquals(&quot;two&quot;, queue.remove());
    assertEquals(2, queue.size());
    assertEquals(1, queue.remainingCapacity());
  }

  public void testAddAll() throws Exception {
    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(3);
    assertEquals(0, queue.size());
    assertEquals(3, queue.remainingCapacity());

    assertTrue(queue.addAll(ImmutableList.of(&quot;one&quot;, &quot;two&quot;, &quot;three&quot;)));
    assertEquals(&quot;one&quot;, queue.element());
    assertEquals(&quot;one&quot;, queue.peek());
    assertEquals(3, queue.size());
    assertEquals(0, queue.remainingCapacity());

    assertTrue(queue.addAll(ImmutableList.of(&quot;four&quot;)));
    assertEquals(&quot;two&quot;, queue.element());
    assertEquals(&quot;two&quot;, queue.peek());
    assertEquals(3, queue.size());
    assertEquals(0, queue.remainingCapacity());

    assertEquals(&quot;two&quot;, queue.remove());
    assertEquals(2, queue.size());
    assertEquals(1, queue.remainingCapacity());
  }

  public void testAddAll_largeList() {
    final List&lt;String&gt; list = ImmutableList.of(&quot;one&quot;, &quot;two&quot;, &quot;three&quot;, &quot;four&quot;, &quot;five&quot;);
    List&lt;String&gt; misbehavingList =
        new AbstractList&lt;String&gt;() {
          @Override
          public int size() {
            return list.size();
<A NAME="0"></A>          }

          @Override
          public String get(int index) <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match630355-0.html#0',2,'match630355-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>{
            if (index &lt; 2) {
              throw new AssertionError();
            }
            return list.get(index);
          }</B></FONT>
        };

    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(3);
    assertTrue(queue.addAll(misbehavingList));
<A NAME="2"></A>
    assertEquals(&quot;three&quot;, queue.remove());
    assertEquals(&quot;four&quot;, queue.remove());
    <FONT color="#980517"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match630355-0.html#2',2,'match630355-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>assertEquals(&quot;five&quot;, queue.remove());
    assertTrue(queue.isEmpty());
  }

  @GwtIncompatible // NullPointerTester
  public void testNullPointerExceptions() {</B></FONT>
    NullPointerTester tester = new NullPointerTester();
    tester.testAllPublicStaticMethods(EvictingQueue.class);
    tester.testAllPublicConstructors(EvictingQueue.class);
    EvictingQueue&lt;String&gt; queue = EvictingQueue.create(5);
    // The queue must be non-empty so it throws a NPE correctly
    queue.add(&quot;one&quot;);
    tester.testAllPublicInstanceMethods(queue);
  }

  public void testSerialization() {
    EvictingQueue&lt;String&gt; original = EvictingQueue.create(5);
    original.add(&quot;one&quot;);
    original.add(&quot;two&quot;);
    original.add(&quot;three&quot;);

    EvictingQueue&lt;String&gt; copy = SerializableTester.reserialize(original);
    assertEquals(copy.maxSize, original.maxSize);
    assertEquals(&quot;one&quot;, copy.remove());
    assertEquals(&quot;two&quot;, copy.remove());
    assertEquals(&quot;three&quot;, copy.remove());
    assertTrue(copy.isEmpty());
  }
}
</PRE>
</div>
  </div>
</body>
</html>
