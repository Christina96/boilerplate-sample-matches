
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 6.472491909385113%, Tokens: 10</h2>
        <div class="column">
            <h3>motan-MDEwOlJlcG9zaXRvcnk1NjY3OTUyMQ==-flat-SpringBeanUtil.java</h3>
            <pre><code>1  package com.weibo.api.motan.config.springsupport.util;
<span onclick='openModal()' class='match'>2  import com.weibo.api.motan.common.URLParamType;
3  import com.weibo.api.motan.config.RegistryConfig;
4  import com.weibo.api.motan.util.LoggerUtil;
5  import org.apache.commons.lang3.StringUtils;
6  import org.springframework.beans.factory.BeanFactory;
7  import java.util.ArrayList;
8  import java.util.List;
9  import java.util.Map;
10  public class SpringBeanUtil {
11      public static final String COMMA_SPLIT_PATTERN = "\\s*[,]+\\s*";
</span>12      public static <T> List<T> getMultiBeans(BeanFactory beanFactory, String names, String pattern, Class<T> clazz) {
13          String[] nameArr = names.split(pattern);
14          List<T> beans = new ArrayList<T>();
15          for (String name : nameArr) {
16              if (name != null && name.length() > 0) {
17                  beans.add(beanFactory.getBean(name, clazz));
18              }
19          }
20          return beans;
21      }
22      public static void addRegistryParamBean(RegistryConfig registryConfig, BeanFactory beanFactory) {
23          if (registryConfig.getProxyRegistry() == null) {
24              Map<String, String> addressParams = registryConfig.getAddressParams();
25              String proxyRegistryId = addressParams.get(URLParamType.proxyRegistryId);
26              if (StringUtils.isNotBlank(proxyRegistryId)) {
27                  String identity = registryConfig.getId() + "-" + registryConfig.getName();
28                  RegistryConfig proxyRegistry = beanFactory.getBean(proxyRegistryId, RegistryConfig.class);
29                  if (proxyRegistry != null) {
30                      registryConfig.setProxyRegistry(proxyRegistry);
31                      LoggerUtil.info("add proxy registry bean by address params. proxyRegistryId:" + proxyRegistryId + ", RegistryConfig:" + identity);
32                  } else {
33                      LoggerUtil.warn("proxy registry bean not found. proxyRegistryId:" + proxyRegistryId + ", RegistryConfig:" + identity);
34                  }
35              }
36          }
37      }
38  }
</code></pre>
        </div>
        <div class="column">
            <h3>google-api-java-client-samples-MDEwOlJlcG9zaXRvcnkyOTc0OTA1Mg==-flat-BigqueryUtils.java</h3>
            <pre><code>1  package com.google.api.client.sample.bigquery.appengine.dashboard;
2  import com.google.api.client.util.Preconditions;
3  import com.google.api.services.bigquery.Bigquery;
4  import com.google.api.services.bigquery.model.Job;
5  import com.google.api.services.bigquery.model.JobConfiguration;
6  import com.google.api.services.bigquery.model.JobConfigurationQuery;
7  import com.google.api.services.bigquery.model.JobReference;
8  import com.google.api.services.bigquery.model.Table;
9  import com.google.api.services.bigquery.model.TableDataList;
10  import com.google.api.services.bigquery.model.TableFieldSchema;
11  import com.google.api.services.bigquery.model.TableReference;
12  import com.google.api.services.bigquery.model.TableRow;
13  import com.google.appengine.api.taskqueue.Queue;
14  import com.google.appengine.api.taskqueue.QueueFactory;
<span onclick='openModal()' class='match'>15  import com.google.appengine.api.taskqueue.RetryOptions;
16  import com.google.appengine.api.taskqueue.TaskOptions;
17  import com.google.common.base.Joiner;
18  import java.io.IOException;
19  import java.util.List;
20  import java.util.concurrent.Callable;
21  import java.util.logging.Logger;
22  import javax.servlet.http.HttpServletResponse;
23  public class BigqueryUtils {
24    private static final Logger log = Logger.getLogger(BigqueryUtils.class.getName());
</span>25    static final String projectId =
26        System.getProperty("com.google.api.client.sample.bigquery.appengine.dashboard.projectId");
27    private final String userId;
28    final Bigquery bigquery;
29    private Job job;
30    public BigqueryUtils(String userId) throws IOException {
31      this(userId, null);
32    }
33    public BigqueryUtils(String userId, final String jobId) throws IOException {
34      this.userId = userId;
35      bigquery = ServiceUtils.loadBigqueryClient(userId);
36      if (jobId != null) {
37        job = tryToDo(new Callable<Job>() {
38          @Override
39          public Job call() throws Exception {
40            return bigquery.jobs().get(projectId, jobId).execute();
41          }
42        });
43        if (job == null) {
44          throw new SampleDashboardException(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,
45              "Wasn't able to get a job for jobId " + jobId);
46        }
47      }
48    }
49    public void beginQuery() throws SampleDashboardException {
50      final Job queryJob = makeJob(buildExampleQuery());
51      job = tryToDo(new Callable<Job>() {
52        @Override
53        public Job call() throws Exception {
54          return bigquery.jobs().insert(projectId, queryJob).execute();
55        }
56      });
57      Preconditions.checkNotNull(job);
58      enqueueWaitingTask();
59    }
60    public boolean jobSucceeded() {
61      return (job != null && job.getStatus().getErrorResult() == null);
62    }
63    public String getJobErrorMessage() {
64      if (job != null && job.getStatus().getErrorResult() != null) {
65        return job.getStatus().getErrorResult().getMessage();
66      }
67      return "";
68    }
69    public boolean jobIsDone() {
70      String status = getJobStatus();
71      return (status != null && ("DONE").equalsIgnoreCase(status));
72    }
73    public String getJobStatus() {
74      return (job != null) ? job.getStatus().getState() : null;
75    }
76    public List<TableFieldSchema> getSchemaFieldNames() throws SampleDashboardException {
77      if (job != null) {
78        final TableReference tableReference = job.getConfiguration().getQuery().getDestinationTable();
79        Table table = tryToDo(new Callable<Table>() {
80          @Override
81          public Table call() throws IOException {
82            return bigquery.tables().get(tableReference.getProjectId(), tableReference.getDatasetId(),
83                tableReference.getTableId()).execute();
84          }
85        });
86        Preconditions.checkNotNull(table);
87        Preconditions.checkNotNull(table.getSchema());
88        Preconditions.checkNotNull(table.getSchema().getFields());
89        return table.getSchema().getFields();
90      }
91      return null;
92    }
93    public List<TableRow> getTableData() throws SampleDashboardException {
94      if (job != null) {
95        final TableReference tableReference = job.getConfiguration().getQuery().getDestinationTable();
96        TableDataList tableDataList = tryToDo(new Callable<TableDataList>() {
97          @Override
98          public TableDataList call() throws IOException {
99            return bigquery.tabledata().list(tableReference.getProjectId(),
100                tableReference.getDatasetId(), tableReference.getTableId()).execute();
101          }
102        });
103        Preconditions.checkNotNull(tableDataList);
104        Preconditions.checkNotNull(tableDataList.getRows());
105        return tableDataList.getRows();
106      }
107      return null;
108    }
109    public void enqueueWaitingTask() {
110      TaskOptions options = TaskOptions.Builder.withDefaults();
111      options.param("jobId", job.getJobReference().getJobId());
112      options.param("userId", userId);
113      options.url("/task");
114      options.countdownMillis(1000);
115      options.retryOptions(RetryOptions.Builder.withTaskRetryLimit(0));
116      Queue queue = QueueFactory.getDefaultQueue();
117      queue.add(options);
118    }
119    public static String buildExampleQuery() {
120      String[] west = {"WA", "OR", "CA", "AK", "HI", "ID", "MT", "WY", "NV", "UT", "CO", "AZ", "NM"};
121      String[] south = {"OK", "TX", "AR", "LA", "TN", "MS", "AL", "KY", "GA", "FL", "SC", "NC", "VA",
122                  "WV", "MD", "DC", "DE"};
123      String[] midwest = {"ND", "SD", "NE", "KS", "MN", "IA", "MO", "WI", "IL", "IN", "MI", "OH"};
124      String[] northeast = {"NY", "PA", "NJ", "CT", "RI", "MA", "VT", "NH", "ME"};
125      Joiner joiner = Joiner.on("', '");
126      String query = "SELECT IF (state IN ('" + joiner.join(west) + "'), 'West', \n\t"
127          + "IF (state IN ('" + joiner.join(south) + "'), 'South', \n\t" + "IF (state IN ('"
128          + joiner.join(midwest) + "'), 'Midwest', \n\t" + "IF (state IN ('" + joiner.join(northeast)
129          + "'), 'Northeast', 'None')))) "
130          + "as region, \naverage_mother_age, \naverage_father_age, \nstate, \nyear \n"
131          + "FROM (SELECT year, \n\t\tstate, \n\t\tSUM(mother_age)/COUNT(mother_age) as "
132          + "average_mother_age, \n\t\tSUM(father_age)/COUNT(father_age) as average_father_age \n\t"
133          + "FROM publicdata:samples.natality \n\tWHERE father_age < 99 \n\tGROUP BY year, state) \n"
134          + "ORDER BY year, region;";
135      return query;
136    }
137    private Job makeJob(String query) {
138      JobConfigurationQuery jobconfigurationquery = new JobConfigurationQuery();
139      jobconfigurationquery.setQuery(query);
140      jobconfigurationquery.setCreateDisposition("CREATE_IF_NEEDED");
141      JobConfiguration jobconfiguration = new JobConfiguration();
142      jobconfiguration.setQuery(jobconfigurationquery);
143      JobReference jobreference = new JobReference();
144      jobreference.setProjectId(projectId);
145      Job newJob = new Job();
146      newJob.setConfiguration(jobconfiguration);
147      newJob.setJobReference(jobreference);
148      return newJob;
149    }
150    private <T> T tryToDo(Callable<T> callback) throws SampleDashboardException {
151      int retries = 3;
152      int currentTry = 0;
153      SampleDashboardException sdex = null;
154      while (currentTry < retries) {
155        currentTry++;
156        try {
157          return callback.call();
158        } catch (Exception ex) {
159          sdex = new SampleDashboardException(ex);
160          log.warning("Caught exception (" + sdex.getStatusCode() + "): " + ex);
161        }
162      }
163      throw Preconditions.checkNotNull(sdex);
164    }
165  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from motan-MDEwOlJlcG9zaXRvcnk1NjY3OTUyMQ==-flat-SpringBeanUtil.java</div>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from google-api-java-client-samples-MDEwOlJlcG9zaXRvcnkyOTc0OTA1Mg==-flat-BigqueryUtils.java</div>
                <div class="column column_space"><pre><code>2  import com.weibo.api.motan.common.URLParamType;
3  import com.weibo.api.motan.config.RegistryConfig;
4  import com.weibo.api.motan.util.LoggerUtil;
5  import org.apache.commons.lang3.StringUtils;
6  import org.springframework.beans.factory.BeanFactory;
7  import java.util.ArrayList;
8  import java.util.List;
9  import java.util.Map;
10  public class SpringBeanUtil {
11      public static final String COMMA_SPLIT_PATTERN = "\\s*[,]+\\s*";
</pre></code></div>
                <div class="column column_space"><pre><code>15  import com.google.appengine.api.taskqueue.RetryOptions;
16  import com.google.appengine.api.taskqueue.TaskOptions;
17  import com.google.common.base.Joiner;
18  import java.io.IOException;
19  import java.util.List;
20  import java.util.concurrent.Callable;
21  import java.util.logging.Logger;
22  import javax.servlet.http.HttpServletResponse;
23  public class BigqueryUtils {
24    private static final Logger log = Logger.getLogger(BigqueryUtils.class.getName());
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    