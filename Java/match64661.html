<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for ValueGraphTest.java & FilesTest_1.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for ValueGraphTest.java & FilesTest_1.java
      </h3>
      <h1 align="center">
        31.8%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>ValueGraphTest.java (35.314285%)<TH>FilesTest_1.java (28.986866%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#0',2,'match64661-1.html#0',3)" NAME="0">(388-401)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#0',2,'match64661-1.html#0',3)" NAME="0">(616-633)</A><TD ALIGN=center><FONT COLOR="#ff0000">33</FONT>
<TR><TD BGCOLOR="#f63526"><FONT COLOR="#f63526">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#1',2,'match64661-1.html#1',3)" NAME="1">(80-93)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#1',2,'match64661-1.html#1',3)" NAME="1">(634-648)</A><TD ALIGN=center><FONT COLOR="#e70000">30</FONT>
<TR><TD BGCOLOR="#980517"><FONT COLOR="#980517">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#2',2,'match64661-1.html#2',3)" NAME="2">(51-57)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#2',2,'match64661-1.html#2',3)" NAME="2">(54-74)</A><TD ALIGN=center><FONT COLOR="#920000">19</FONT>
<TR><TD BGCOLOR="#53858b"><FONT COLOR="#53858b">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#3',2,'match64661-1.html#3',3)" NAME="3">(17-36)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#3',2,'match64661-1.html#3',3)" NAME="3">(17-36)</A><TD ALIGN=center><FONT COLOR="#8b0000">18</FONT>
<TR><TD BGCOLOR="#6cc417"><FONT COLOR="#6cc417">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#4',2,'match64661-1.html#4',3)" NAME="4">(326-333)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#4',2,'match64661-1.html#4',3)" NAME="4">(703-712)</A><TD ALIGN=center><FONT COLOR="#7b0000">16</FONT>
<TR><TD BGCOLOR="#151b8d"><FONT COLOR="#151b8d">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#5',2,'match64661-1.html#5',3)" NAME="5">(310-318)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#5',2,'match64661-1.html#5',3)" NAME="5">(449-463)</A><TD ALIGN=center><FONT COLOR="#7b0000">16</FONT>
<TR><TD BGCOLOR="#8c8774"><FONT COLOR="#8c8774">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#6',2,'match64661-1.html#6',3)" NAME="6">(283-289)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#6',2,'match64661-1.html#6',3)" NAME="6">(86-90)</A><TD ALIGN=center><FONT COLOR="#7b0000">16</FONT>
<TR><TD BGCOLOR="#38a4a5"><FONT COLOR="#38a4a5">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#7',2,'match64661-1.html#7',3)" NAME="7">(116-123)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#7',2,'match64661-1.html#7',3)" NAME="7">(203-214)</A><TD ALIGN=center><FONT COLOR="#6c0000">14</FONT>
<TR><TD BGCOLOR="#c58917"><FONT COLOR="#c58917">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#8',2,'match64661-1.html#8',3)" NAME="8">(404-414)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#8',2,'match64661-1.html#8',3)" NAME="8">(111-118)</A><TD ALIGN=center><FONT COLOR="#640000">13</FONT>
<TR><TD BGCOLOR="#83a33a"><FONT COLOR="#83a33a">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#9',2,'match64661-1.html#9',3)" NAME="9">(225-231)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#9',2,'match64661-1.html#9',3)" NAME="9">(361-368)</A><TD ALIGN=center><FONT COLOR="#640000">13</FONT>
<TR><TD BGCOLOR="#ad5910"><FONT COLOR="#ad5910">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#10',2,'match64661-1.html#10',3)" NAME="10">(176-182)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#10',2,'match64661-1.html#10',3)" NAME="10">(300-308)</A><TD ALIGN=center><FONT COLOR="#640000">13</FONT>
<TR><TD BGCOLOR="#b041ff"><FONT COLOR="#b041ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#11',2,'match64661-1.html#11',3)" NAME="11">(154-160)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#11',2,'match64661-1.html#11',3)" NAME="11">(138-147)</A><TD ALIGN=center><FONT COLOR="#640000">13</FONT>
<TR><TD BGCOLOR="#571b7e"><FONT COLOR="#571b7e">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#12',2,'match64661-1.html#12',3)" NAME="12">(68-72)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#12',2,'match64661-1.html#12',3)" NAME="12">(274-281)</A><TD ALIGN=center><FONT COLOR="#640000">13</FONT>
<TR><TD BGCOLOR="#3b9c9c"><FONT COLOR="#3b9c9c">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#13',2,'match64661-1.html#13',3)" NAME="13">(61-64)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#13',2,'match64661-1.html#13',3)" NAME="13">(216-224)</A><TD ALIGN=center><FONT COLOR="#640000">13</FONT>
<TR><TD BGCOLOR="#842dce"><FONT COLOR="#842dce">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#14',2,'match64661-1.html#14',3)" NAME="14">(64-66)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#14',2,'match64661-1.html#14',3)" NAME="14">(482-489)</A><TD ALIGN=center><FONT COLOR="#550000">11</FONT>
<TR><TD BGCOLOR="#f52887"><FONT COLOR="#f52887">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#15',2,'match64661-1.html#15',3)" NAME="15">(140-145)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#15',2,'match64661-1.html#15',3)" NAME="15">(508-514)</A><TD ALIGN=center><FONT COLOR="#4d0000">10</FONT>
<TR><TD BGCOLOR="#2981b2"><FONT COLOR="#2981b2">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#16',2,'match64661-1.html#16',3)" NAME="16">(134-138)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#16',2,'match64661-1.html#16',3)" NAME="16">(316-322)</A><TD ALIGN=center><FONT COLOR="#4d0000">10</FONT>
<TR><TD BGCOLOR="#3090c7"><FONT COLOR="#3090c7">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#17',2,'match64661-1.html#17',3)" NAME="17">(128-132)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#17',2,'match64661-1.html#17',3)" NAME="17">(309-315)</A><TD ALIGN=center><FONT COLOR="#4d0000">10</FONT>
<TR><TD BGCOLOR="#800517"><FONT COLOR="#800517">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#18',2,'match64661-1.html#18',3)" NAME="18">(93-99)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#18',2,'match64661-1.html#18',3)" NAME="18">(590-599)</A><TD ALIGN=center><FONT COLOR="#4d0000">10</FONT>
<TR><TD BGCOLOR="#f62817"><FONT COLOR="#f62817">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#19',2,'match64661-1.html#19',3)" NAME="19">(162-167)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#19',2,'match64661-1.html#19',3)" NAME="19">(343-349)</A><TD ALIGN=center><FONT COLOR="#450000">9</FONT>
<TR><TD BGCOLOR="#4e9258"><FONT COLOR="#4e9258">-</FONT><TD><A HREF="javascript:ZweiFrames('match64661-0.html#20',2,'match64661-1.html#20',3)" NAME="20">(147-152)<TD><A HREF="javascript:ZweiFrames('match64661-0.html#20',2,'match64661-1.html#20',3)" NAME="20">(323-328)</A><TD ALIGN=center><FONT COLOR="#450000">9</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>ValueGraphTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2016 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
<A NAME="3"></A> * limitations under the License.
 */

<FONT color="#53858b"><A HREF="javascript:ZweiFrames('match64661-1.html#3',3,'match64661-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>package com.google.common.graph;

import static com.google.common.graph.GraphConstants.ENDPOINTS_MISMATCH;
import static com.google.common.graph.TestUtil.assertStronglyEquivalent;
import static com.google.common.truth.Truth.assertThat;
import static com.google.common.truth.Truth8.assertThat;
import static java.util.concurrent.Executors.newFixedThreadPool;
import static org.junit.Assert.fail;

import com.google.common.collect.ImmutableList;
import java.util.Optional;
import java.util.Set;
import java.util.concurrent.Callable;
import java.util.concurrent.CyclicBarrier;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Future;
import org.junit.After;
import org.junit.Test;
import org.junit.runner.RunWith;
import</B></FONT> org.junit.runners.JUnit4;

/** Tests for {@link StandardMutableValueGraph} and related functionality. */
// TODO(user): Expand coverage and move to proper test suite.
@RunWith(JUnit4.class)
public final class ValueGraphTest {
  private static final String DEFAULT = &quot;default&quot;;

  MutableValueGraph&lt;Integer, String&gt; graph;

  @After
  public void validateGraphState() {
<A NAME="2"></A>    assertStronglyEquivalent(graph, Graphs.copyOf(graph));
    assertStronglyEquivalent(graph, ImmutableValueGraph.copyOf(graph));

    Graph&lt;Integer&gt; asGraph = <FONT color="#980517"><A HREF="javascript:ZweiFrames('match64661-1.html#2',3,'match64661-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>graph.asGraph();
    AbstractGraphTest.validateGraph(asGraph);
    assertThat(graph.nodes()).isEqualTo(asGraph.nodes());
    assertThat(graph.edges()).isEqualTo(asGraph.edges());
    assertThat(graph.nodeOrder()).isEqualTo(asGraph.nodeOrder());
    assertThat(graph.incidentEdgeOrder()).isEqualTo(asGraph.incidentEdgeOrder());
    assertThat(graph.isDirected()).isEqualTo</B></FONT>(asGraph.isDirected());
<A NAME="13"></A>    assertThat(graph.allowsSelfLoops()).isEqualTo(asGraph.allowsSelfLoops());

    for (Integer node : graph.nodes()) {
<A NAME="14"></A>      <FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match64661-1.html#13',3,'match64661-top.html#13',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>assertThat(graph.adjacentNodes(node)).isEqualTo(asGraph.adjacentNodes(node));
      assertThat(graph.predecessors(node)).isEqualTo(asGraph.predecessors(node));
      assertThat(graph.successors(node)).isEqualTo(asGraph.successors(node));
      <FONT color="#842dce"><A HREF="javascript:ZweiFrames('match64661-1.html#14',3,'match64661-top.html#14',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>assertThat(graph.degree(node)).isEqualTo</B></FONT>(asGraph.degree(node));
<A NAME="12"></A>      assertThat(graph.inDegree(node)).isEqualTo(asGraph.inDegree(node));
      assertThat(graph.outDegree(node)).isEqualTo(asGraph.outDegree</B></FONT>(node));

      for (Integer otherNode : graph.nodes()) <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match64661-1.html#12',3,'match64661-top.html#12',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
        boolean hasEdge = graph.hasEdgeConnecting(node, otherNode);
        assertThat(hasEdge).isEqualTo(asGraph.hasEdgeConnecting(node, otherNode));
        assertThat(graph.edgeValueOrDefault(node, otherNode, null) != null).isEqualTo(hasEdge);
        assertThat(!graph.edgeValueOrDefault</B></FONT>(node, otherNode, DEFAULT).equals(DEFAULT))
            .isEqualTo(hasEdge);
      }
    }
  }
<A NAME="1"></A>
  @Test
  public void directedGraph() {
    graph = <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match64661-1.html#1',3,'match64661-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.directed().allowsSelfLoops(true).build();
    graph.putEdgeValue(1, 2, &quot;valueA&quot;);
    graph.putEdgeValue(2, 1, &quot;valueB&quot;);
    graph.putEdgeValue(2, 3, &quot;valueC&quot;);
    graph.putEdgeValue(4, 4, &quot;valueD&quot;);

    assertThat(graph.edgeValueOrDefault(1, 2, null)).isEqualTo(&quot;valueA&quot;);
    assertThat(graph.edgeValueOrDefault(2, 1, null)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.edgeValueOrDefault(2, 3, null)).isEqualTo(&quot;valueC&quot;);
    assertThat(graph.edgeValueOrDefault(4, 4, null)).isEqualTo(&quot;valueD&quot;);
<A NAME="18"></A>    assertThat(graph.edgeValueOrDefault(1, 2, DEFAULT)).isEqualTo(&quot;valueA&quot;);
    assertThat(graph.edgeValueOrDefault(2, 1, DEFAULT)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.edgeValueOrDefault(2, 3, DEFAULT)).isEqualTo(&quot;valueC&quot;);
    assertThat</B></FONT>(<FONT color="#800517"><A HREF="javascript:ZweiFrames('match64661-1.html#18',3,'match64661-top.html#18',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>graph.edgeValueOrDefault(4, 4, DEFAULT)).isEqualTo(&quot;valueD&quot;);

    String toString = graph.toString();
    assertThat(toString).contains(&quot;valueA&quot;);
    assertThat(toString).contains(&quot;valueB&quot;);
    assertThat(toString).contains(&quot;valueC&quot;);
    assertThat(toString).contains</B></FONT>(&quot;valueD&quot;);
  }

  @Test
  public void undirectedGraph() {
    graph = ValueGraphBuilder.undirected().allowsSelfLoops(true).build();
    graph.putEdgeValue(1, 2, &quot;valueA&quot;);
    graph.putEdgeValue(2, 1, &quot;valueB&quot;); // overwrites valueA in undirected case
    graph.putEdgeValue(2, 3, &quot;valueC&quot;);
    graph.putEdgeValue(4, 4, &quot;valueD&quot;);

    assertThat(graph.edgeValueOrDefault(1, 2, null)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.edgeValueOrDefault(2, 1, null)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.edgeValueOrDefault(2, 3, null)).isEqualTo(&quot;valueC&quot;);
<A NAME="7"></A>    assertThat(graph.edgeValueOrDefault(4, 4, null)).isEqualTo(&quot;valueD&quot;);
    assertThat(graph.edgeValueOrDefault(1, 2, DEFAULT)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.edgeValueOrDefault(2, 1, DEFAULT)).isEqualTo(&quot;valueB&quot;);
    <FONT color="#38a4a5"><A HREF="javascript:ZweiFrames('match64661-1.html#7',3,'match64661-top.html#7',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>assertThat(graph.edgeValueOrDefault(2, 3, DEFAULT)).isEqualTo(&quot;valueC&quot;);
    assertThat(graph.edgeValueOrDefault(4, 4, DEFAULT)).isEqualTo(&quot;valueD&quot;);

    String toString = graph.toString();
    assertThat(toString).doesNotContain(&quot;valueA&quot;);
    assertThat(toString).contains(&quot;valueB&quot;);
    assertThat(toString).contains(&quot;valueC&quot;);
    assertThat(toString).contains</B></FONT>(&quot;valueD&quot;);
  }
<A NAME="17"></A>
  @Test
  public void incidentEdgeOrder_unordered() {
    graph = <FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match64661-1.html#17',3,'match64661-top.html#17',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.directed().incidentEdgeOrder(ElementOrder.unordered()).build();
    assertThat(graph.incidentEdgeOrder()).isEqualTo(ElementOrder.unordered());
  }
<A NAME="16"></A>
  @Test</B></FONT>
  public void incidentEdgeOrder_stable() {
    graph = <FONT color="#2981b2"><A HREF="javascript:ZweiFrames('match64661-1.html#16',3,'match64661-top.html#16',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.directed().incidentEdgeOrder(ElementOrder.stable()).build();
    assertThat(graph.incidentEdgeOrder()).isEqualTo(ElementOrder.stable());
  }
<A NAME="15"></A>
  @Test</B></FONT>
  public void hasEdgeConnecting_directed_correct() {
    graph = <FONT color="#f52887"><A HREF="javascript:ZweiFrames('match64661-1.html#15',3,'match64661-top.html#15',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.hasEdgeConnecting(EndpointPair.ordered(1, 2))).isTrue();
  }
<A NAME="20"></A>
  @Test</B></FONT>
  public void hasEdgeConnecting_directed_backwards() {
    graph = <FONT color="#4e9258"><A HREF="javascript:ZweiFrames('match64661-1.html#20',3,'match64661-top.html#20',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.hasEdgeConnecting(EndpointPair.ordered(2, 1))).isFalse();
  }
<A NAME="11"></A>
  @Test</B></FONT>
  public void hasEdgeConnecting_directed_mismatch() {
    graph = <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match64661-1.html#11',3,'match64661-top.html#11',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.hasEdgeConnecting(EndpointPair.unordered(1, 2))).isFalse();
    assertThat(graph.hasEdgeConnecting(EndpointPair.unordered(2, 1))).isFalse();
  }
<A NAME="19"></A>
  @Test</B></FONT>
  public void hasEdgeConnecting_undirected_correct() {
    graph = <FONT color="#f62817"><A HREF="javascript:ZweiFrames('match64661-1.html#19',3,'match64661-top.html#19',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.hasEdgeConnecting(EndpointPair.unordered(1, 2))).isTrue();
  }

  @Test</B></FONT>
  public void hasEdgeConnecting_undirected_backwards() {
    graph = ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.hasEdgeConnecting(EndpointPair.unordered(2, 1))).isTrue();
  }
<A NAME="10"></A>
  @Test
  public void hasEdgeConnecting_undirected_mismatch() {
    graph = <FONT color="#ad5910"><A HREF="javascript:ZweiFrames('match64661-1.html#10',3,'match64661-top.html#10',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.hasEdgeConnecting(EndpointPair.ordered(1, 2))).isTrue();
    assertThat(graph.hasEdgeConnecting(EndpointPair.ordered(2, 1))).isTrue();
  }

  @Test</B></FONT>
  public void edgeValue_directed_correct() {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValue(EndpointPair.ordered(1, 2))).hasValue(&quot;A&quot;);
  }

  @Test
  public void edgeValue_directed_backwards() {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValue(EndpointPair.ordered(2, 1))).isEmpty();
  }

  @Test
  public void edgeValue_directed_mismatch() {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    try {
      Optional&lt;String&gt; unused = graph.edgeValue(EndpointPair.unordered(1, 2));
      unused = graph.edgeValue(EndpointPair.unordered(2, 1));
      fail(&quot;Expected IllegalArgumentException: &quot; + ENDPOINTS_MISMATCH);
    } catch (IllegalArgumentException e) {
      assertThat(e).hasMessageThat().contains(ENDPOINTS_MISMATCH);
    }
  }

  @Test
  public void edgeValue_undirected_correct() {
    graph = ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValue(EndpointPair.unordered(1, 2))).hasValue(&quot;A&quot;);
  }

  @Test
  public void edgeValue_undirected_backwards() {
    graph = ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValue(EndpointPair.unordered(2, 1))).hasValue(&quot;A&quot;);
  }
<A NAME="9"></A>
  @Test
  public void edgeValue_undirected_mismatch() {
    graph = <FONT color="#83a33a"><A HREF="javascript:ZweiFrames('match64661-1.html#9',3,'match64661-top.html#9',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValue(EndpointPair.ordered(1, 2))).hasValue(&quot;A&quot;);
    assertThat(graph.edgeValue(EndpointPair.ordered(2, 1))).hasValue(&quot;A&quot;);
  }

  @Test</B></FONT>
  public void edgeValueOrDefault_directed_correct() {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValueOrDefault(EndpointPair.ordered(1, 2), &quot;default&quot;)).isEqualTo(&quot;A&quot;);
  }

  @Test
  public void edgeValueOrDefault_directed_backwards() {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValueOrDefault(EndpointPair.ordered(2, 1), &quot;default&quot;))
        .isEqualTo(&quot;default&quot;);
  }

  @Test
  public void edgeValueOrDefault_directed_mismatch() {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    try {
      String unused = graph.edgeValueOrDefault(EndpointPair.unordered(1, 2), &quot;default&quot;);
      unused = graph.edgeValueOrDefault(EndpointPair.unordered(2, 1), &quot;default&quot;);
      fail(&quot;Expected IllegalArgumentException: &quot; + ENDPOINTS_MISMATCH);
    } catch (IllegalArgumentException e) {
      assertThat(e).hasMessageThat().contains(ENDPOINTS_MISMATCH);
    }
  }

  @Test
  public void edgeValueOrDefault_undirected_correct() {
    graph = ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValueOrDefault(EndpointPair.unordered(1, 2), &quot;default&quot;)).isEqualTo(&quot;A&quot;);
  }

  @Test
  public void edgeValueOrDefault_undirected_backwards() {
    graph = ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValueOrDefault(EndpointPair.unordered(2, 1), &quot;default&quot;)).isEqualTo(&quot;A&quot;);
  }

  @Test
  public void edgeValueOrDefault_undirected_mismatch() {
    graph = ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    assertThat(graph.edgeValueOrDefault(EndpointPair.ordered(2, 1), &quot;default&quot;)).isEqualTo(&quot;A&quot;);
    assertThat(graph.edgeValueOrDefault(EndpointPair.ordered(2, 1), &quot;default&quot;)).isEqualTo(&quot;A&quot;);
  }
<A NAME="6"></A>
  @Test
  public void putEdgeValue_directed() {
    graph = <FONT color="#8c8774"><A HREF="javascript:ZweiFrames('match64661-1.html#6',3,'match64661-top.html#6',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.directed().build();

    assertThat(graph.putEdgeValue(1, 2, &quot;valueA&quot;)).isNull();
    assertThat(graph.putEdgeValue(2, 1, &quot;valueB&quot;)).isNull();
    assertThat(graph.putEdgeValue(1, 2, &quot;valueC&quot;)).isEqualTo(&quot;valueA&quot;);
    assertThat(graph.putEdgeValue(2, 1, &quot;valueD&quot;)).isEqualTo(&quot;valueB&quot;);
  }</B></FONT>

  @Test
  public void putEdgeValue_directed_orderMismatch() {
    graph = ValueGraphBuilder.directed().build();
    try {
      graph.putEdgeValue(EndpointPair.unordered(1, 2), &quot;irrelevant&quot;);
      fail(&quot;Expected IllegalArgumentException: &quot; + ENDPOINTS_MISMATCH);
    } catch (IllegalArgumentException e) {
      assertThat(e).hasMessageThat().contains(ENDPOINTS_MISMATCH);
    }
  }

  @Test
  public void putEdgeValue_undirected_orderMismatch() {
    graph = ValueGraphBuilder.undirected().build();
    assertThat(graph.putEdgeValue(EndpointPair.ordered(1, 2), &quot;irrelevant&quot;)).isNull();
  }
<A NAME="5"></A>
  @Test
  public void putEdgeValue_undirected() {
    graph = <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match64661-1.html#5',3,'match64661-top.html#5',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ValueGraphBuilder.undirected().build();

    assertThat(graph.putEdgeValue(1, 2, &quot;valueA&quot;)).isNull();
    assertThat(graph.putEdgeValue(2, 1, &quot;valueB&quot;)).isEqualTo(&quot;valueA&quot;);
    assertThat(graph.putEdgeValue(1, 2, &quot;valueC&quot;)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.putEdgeValue(2, 1, &quot;valueD&quot;)).isEqualTo(&quot;valueC&quot;);
  }

  @Test</B></FONT>
  public void removeEdge_directed() {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;valueA&quot;);
    graph.putEdgeValue(2, 1, &quot;valueB&quot;);
<A NAME="4"></A>    graph.putEdgeValue(2, 3, &quot;valueC&quot;);

    assertThat(graph.removeEdge(1, 2)).isEqualTo(&quot;valueA&quot;);
    assertThat(<FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match64661-1.html#4',3,'match64661-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>graph.removeEdge(1, 2)).isNull();
    assertThat(graph.removeEdge(2, 1)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.removeEdge(2, 1)).isNull();
    assertThat(graph.removeEdge(2, 3)).isEqualTo(&quot;valueC&quot;);
    assertThat(graph.removeEdge(2, 3)).isNull();
  }

  @Test</B></FONT>
  public void removeEdge_undirected() {
    graph = ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;valueA&quot;);
    graph.putEdgeValue(2, 1, &quot;valueB&quot;);
    graph.putEdgeValue(2, 3, &quot;valueC&quot;);

    assertThat(graph.removeEdge(1, 2)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.removeEdge(1, 2)).isNull();
    assertThat(graph.removeEdge(2, 1)).isNull();
    assertThat(graph.removeEdge(2, 3)).isEqualTo(&quot;valueC&quot;);
    assertThat(graph.removeEdge(2, 3)).isNull();
  }

  @Test
  public void removeEdge_directed_orderMismatch() {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;1-&gt;2&quot;);
    graph.putEdgeValue(2, 1, &quot;2-&gt;1&quot;);
    try {
      graph.removeEdge(EndpointPair.unordered(1, 2));
      graph.removeEdge(EndpointPair.unordered(2, 1));
      fail(&quot;Expected IllegalArgumentException: &quot; + ENDPOINTS_MISMATCH);
    } catch (IllegalArgumentException e) {
      assertThat(e).hasMessageThat().contains(ENDPOINTS_MISMATCH);
    }
  }

  @Test
  public void removeEdge_undirected_orderMismatch() {
    graph = ValueGraphBuilder.undirected().build();
    graph.putEdgeValue(1, 2, &quot;1-2&quot;);
    assertThat(graph.removeEdge(EndpointPair.ordered(1, 2))).isEqualTo(&quot;1-2&quot;);
  }

  @Test
  public void edgeValue_missing() {
    graph = ValueGraphBuilder.directed().build();

    assertThat(graph.edgeValueOrDefault(1, 2, DEFAULT)).isEqualTo(DEFAULT);
    assertThat(graph.edgeValueOrDefault(2, 1, DEFAULT)).isEqualTo(DEFAULT);
    assertThat(graph.edgeValue(1, 2).orElse(DEFAULT)).isEqualTo(DEFAULT);
    assertThat(graph.edgeValue(2, 1).orElse(DEFAULT)).isEqualTo(DEFAULT);
    assertThat(graph.edgeValueOrDefault(1, 2, null)).isNull();
    assertThat(graph.edgeValueOrDefault(2, 1, null)).isNull();
    assertThat(graph.edgeValue(1, 2).orElse(null)).isNull();
    assertThat(graph.edgeValue(2, 1).orElse(null)).isNull();

    graph.putEdgeValue(1, 2, &quot;valueA&quot;);
    graph.putEdgeValue(2, 1, &quot;valueB&quot;);
    assertThat(graph.edgeValueOrDefault(1, 2, DEFAULT)).isEqualTo(&quot;valueA&quot;);
    assertThat(graph.edgeValueOrDefault(2, 1, DEFAULT)).isEqualTo(&quot;valueB&quot;);
<A NAME="0"></A>    assertThat(graph.edgeValueOrDefault(1, 2, null)).isEqualTo(&quot;valueA&quot;);
    assertThat(graph.edgeValueOrDefault(2, 1, null)).isEqualTo(&quot;valueB&quot;);
    assertThat(graph.edgeValue(1, 2).get()).isEqualTo(&quot;valueA&quot;);
    <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match64661-1.html#0',3,'match64661-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>assertThat(graph.edgeValue(2, 1).get()).isEqualTo(&quot;valueB&quot;);

    graph.removeEdge(1, 2);
    graph.putEdgeValue(2, 1, &quot;valueC&quot;);
    assertThat(graph.edgeValueOrDefault(1, 2, DEFAULT)).isEqualTo(DEFAULT);
    assertThat(graph.edgeValueOrDefault(2, 1, DEFAULT)).isEqualTo(&quot;valueC&quot;);
    assertThat(graph.edgeValue(1, 2).orElse(DEFAULT)).isEqualTo(DEFAULT);
    assertThat(graph.edgeValueOrDefault(1, 2, null)).isNull();
    assertThat(graph.edgeValueOrDefault(2, 1, null)).isEqualTo(&quot;valueC&quot;);
    assertThat(graph.edgeValue(1, 2).orElse(null)).isNull();
    assertThat(graph.edgeValue(2, 1).get()).isEqualTo(&quot;valueC&quot;);
  }

<A NAME="8"></A>  @Test</B></FONT>
  public void equivalence_considersEdgeValue() {
    graph = ValueGraphBuilder.undirected().build();
    <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match64661-1.html#8',3,'match64661-top.html#8',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>graph.putEdgeValue(1, 2, &quot;valueA&quot;);

    MutableValueGraph&lt;Integer, String&gt; otherGraph = ValueGraphBuilder.undirected().build();
    otherGraph.putEdgeValue(1, 2, &quot;valueA&quot;);
    assertThat(graph).isEqualTo(otherGraph);

    otherGraph.putEdgeValue(1, 2, &quot;valueB&quot;);
    assertThat(graph).isNotEqualTo(otherGraph); // values differ
  }

  @Test</B></FONT>
  public void incidentEdges_stableIncidentEdgeOrder_preservesIncidentEdgesOrder_directed() {
    graph = ValueGraphBuilder.directed().incidentEdgeOrder(ElementOrder.stable()).build();
    graph.putEdgeValue(2, 1, &quot;2-1&quot;);
    graph.putEdgeValue(2, 3, &quot;2-3&quot;);
    graph.putEdgeValue(1, 2, &quot;1-2&quot;);

    assertThat(graph.incidentEdges(2))
        .containsExactly(
            EndpointPair.ordered(2, 1), EndpointPair.ordered(2, 3), EndpointPair.ordered(1, 2))
        .inOrder();
  }

  @Test
  public void incidentEdges_stableIncidentEdgeOrder_preservesIncidentEdgesOrder_undirected() {
    graph = ValueGraphBuilder.undirected().incidentEdgeOrder(ElementOrder.stable()).build();
    graph.putEdgeValue(2, 3, &quot;2-3&quot;);
    graph.putEdgeValue(2, 1, &quot;2-1&quot;);
    graph.putEdgeValue(2, 4, &quot;2-4&quot;);
    graph.putEdgeValue(1, 2, &quot;1-2&quot;); // Duplicate nodes, different value

    assertThat(graph.incidentEdges(2))
        .containsExactly(
            EndpointPair.unordered(2, 3),
            EndpointPair.unordered(1, 2),
            EndpointPair.unordered(2, 4))
        .inOrder();
  }


  @Test
  public void concurrentIteration() throws Exception {
    graph = ValueGraphBuilder.directed().build();
    graph.putEdgeValue(1, 2, &quot;A&quot;);
    graph.putEdgeValue(3, 4, &quot;B&quot;);
    graph.putEdgeValue(5, 6, &quot;C&quot;);

    int threadCount = 20;
    ExecutorService executor = newFixedThreadPool(threadCount);
    final CyclicBarrier barrier = new CyclicBarrier(threadCount);
    ImmutableList.Builder&lt;Future&lt;?&gt;&gt; futures = ImmutableList.builder();
    for (int i = 0; i &lt; threadCount; i++) {
      futures.add(
          executor.submit(
              new Callable&lt;Object&gt;() {
                @Override
                public Object call() throws Exception {
                  barrier.await();
                  Integer first = graph.nodes().iterator().next();
                  for (Integer node : graph.nodes()) {
                    Set&lt;Integer&gt; unused = graph.successors(node);
                  }
                  /*
                   * Also look up an earlier node so that, if the graph is using MapRetrievalCache,
                   * we read one of the fields declared in that class.
                   */
                  Set&lt;Integer&gt; unused = graph.successors(first);
                  return null;
                }
              }));
    }

    // For more about this test, see the equivalent in AbstractNetworkTest.
    for (Future&lt;?&gt; future : futures.build()) {
      future.get();
    }
    executor.shutdown();
  }
}
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>FilesTest_1.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2007 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
<A NAME="3"></A> * limitations under the License.
 */

<FONT color="#53858b"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#3',2,'match64661-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>package com.google.common.io;

import static com.google.common.truth.Truth.assertThat;

import com.google.common.base.Charsets;
import com.google.common.collect.ImmutableList;
import com.google.common.hash.Hashing;
import com.google.common.primitives.Bytes;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.PrintWriter;
import java.io.RandomAccessFile;
import java.nio.ByteBuffer;
import java.nio.MappedByteBuffer;
import java.nio.channels.FileChannel.MapMode;
import</B></FONT> java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Random;
import junit.framework.TestSuite;

/**
 * Unit test for {@link Files}.
 *
 * &lt;p&gt;Note: {@link Files#fileTraverser()} is tested in {@link FilesFileTraverserTest}.
 *
 * @author Chris Nokleberg
 */

public class FilesTest extends IoTestCase {
<A NAME="2"></A>
  public static TestSuite suite() {
    TestSuite suite = new TestSuite();
    <FONT color="#980517"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#2',2,'match64661-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>suite.addTest(
        ByteSourceTester.tests(
            &quot;Files.asByteSource[File]&quot;, SourceSinkFactories.fileByteSourceFactory(), true));
    suite.addTest(
        ByteSinkTester.tests(&quot;Files.asByteSink[File]&quot;, SourceSinkFactories.fileByteSinkFactory()));
    suite.addTest(
        ByteSinkTester.tests(
            &quot;Files.asByteSink[File, APPEND]&quot;, SourceSinkFactories.appendingFileByteSinkFactory()));
    suite.addTest(
        CharSourceTester.tests(
            &quot;Files.asCharSource[File, Charset]&quot;,
            SourceSinkFactories.fileCharSourceFactory(),
            false));
    suite.addTest(
        CharSinkTester.tests(
            &quot;Files.asCharSink[File, Charset]&quot;, SourceSinkFactories.fileCharSinkFactory()));
    suite.addTest(
        CharSinkTester.tests(
            &quot;Files.asCharSink[File, Charset, APPEND]&quot;,
            SourceSinkFactories.appendingFileCharSinkFactory()));
    suite.addTestSuite</B></FONT>(FilesTest.class);
    return suite;
  }

  public void testRoundTripSources() throws Exception {
    File asciiFile = getTestFile(&quot;ascii.txt&quot;);
    ByteSource byteSource = Files.asByteSource(asciiFile);
    assertSame(byteSource, byteSource.asCharSource(Charsets.UTF_8).asByteSource(Charsets.UTF_8));
  }
<A NAME="6"></A>
  public void testToByteArray() throws IOException {
    File asciiFile = getTestFile(&quot;ascii.txt&quot;);
    File i18nFile = <FONT color="#8c8774"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#6',2,'match64661-top.html#6',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>getTestFile(&quot;i18n.txt&quot;);
    assertTrue(Arrays.equals(ASCII.getBytes(Charsets.US_ASCII), Files.toByteArray(asciiFile)));
    assertTrue(Arrays.equals(I18N.getBytes(Charsets.UTF_8), Files.toByteArray(i18nFile)));
    assertTrue(Arrays.equals(I18N.getBytes(Charsets.UTF_8), Files.asByteSource(i18nFile).read()));
  }</B></FONT>

  /** A {@link File} that provides a specialized value for {@link File#length()}. */
  private static class BadLengthFile extends File {

    private final long badLength;

    public BadLengthFile(File delegate, long badLength) {
      super(delegate.getPath());
      this.badLength = badLength;
    }

    @Override
    public long length() {
      return badLength;
    }

    private static final long serialVersionUID = 0;
<A NAME="8"></A>  }

  public void testToString() throws IOException {
    File asciiFile = <FONT color="#c58917"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#8',2,'match64661-top.html#8',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>getTestFile(&quot;ascii.txt&quot;);
    File i18nFile = getTestFile(&quot;i18n.txt&quot;);
    assertEquals(ASCII, Files.toString(asciiFile, Charsets.US_ASCII));
    assertEquals(I18N, Files.toString(i18nFile, Charsets.UTF_8));
    assertThat(Files.toString(i18nFile, Charsets.US_ASCII)).isNotEqualTo(I18N);
  }

  public void tes</B></FONT>tWriteString() throws IOException {
    File temp = createTempFile();
    Files.write(I18N, temp, Charsets.UTF_16LE);
    assertEquals(I18N, Files.toString(temp, Charsets.UTF_16LE));
  }

  public void testWriteBytes() throws IOException {
    File temp = createTempFile();
    byte[] data = newPreFilledByteArray(2000);
    Files.write(data, temp);
    assertTrue(Arrays.equals(data, Files.toByteArray(temp)));

    try {
      Files.write(null, temp);
      fail(&quot;expected exception&quot;);
    } catch (NullPointerException expected) {
    }
<A NAME="11"></A>  }

  public void testAppendString() throws IOException {
    File temp = <FONT color="#b041ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#11',2,'match64661-top.html#11',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>createTempFile();
    Files.append(I18N, temp, Charsets.UTF_16LE);
    assertEquals(I18N, Files.toString(temp, Charsets.UTF_16LE));
    Files.append(I18N, temp, Charsets.UTF_16LE);
    assertEquals(I18N + I18N, Files.toString(temp, Charsets.UTF_16LE));
    Files.append(I18N, temp, Charsets.UTF_16LE);
    assertEquals(I18N + I18N + I18N, Files.toString(temp, Charsets.UTF_16LE));
  }

  public void testCopyTo</B></FONT>OutputStream() throws IOException {
    File i18nFile = getTestFile(&quot;i18n.txt&quot;);
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    Files.copy(i18nFile, out);
    assertEquals(I18N, out.toString(&quot;UTF-8&quot;));
  }

  public void testCopyToAppendable() throws IOException {
    File i18nFile = getTestFile(&quot;i18n.txt&quot;);
    StringBuilder sb = new StringBuilder();
    Files.copy(i18nFile, Charsets.UTF_8, sb);
    assertEquals(I18N, sb.toString());
  }

  public void testCopyFile() throws IOException {
    File i18nFile = getTestFile(&quot;i18n.txt&quot;);
    File temp = createTempFile();
    Files.copy(i18nFile, temp);
    assertEquals(I18N, Files.toString(temp, Charsets.UTF_8));
  }

  public void testCopyEqualFiles() throws IOException {
    File temp1 = createTempFile();
    File temp2 = file(temp1.getPath());
    assertEquals(temp1, temp2);
    Files.write(ASCII, temp1, Charsets.UTF_8);
    try {
      Files.copy(temp1, temp2);
      fail(&quot;Expected an IAE to be thrown but wasn't&quot;);
    } catch (IllegalArgumentException expected) {
    }
    assertEquals(ASCII, Files.toString(temp1, Charsets.UTF_8));
  }

  public void testCopySameFile() throws IOException {
    File temp = createTempFile();
    Files.write(ASCII, temp, Charsets.UTF_8);
    try {
      Files.copy(temp, temp);
      fail(&quot;Expected an IAE to be thrown but wasn't&quot;);
    } catch (IllegalArgumentException expected) {
    }
    assertEquals(ASCII, Files.toString(temp, Charsets.UTF_8));
  }

  public void testCopyIdenticalFiles() throws IOException {
    File temp1 = createTempFile();
    Files.write(ASCII, temp1, Charsets.UTF_8);
    File temp2 = createTempFile();
    Files.write(ASCII, temp2, Charsets.UTF_8);
    Files.copy(temp1, temp2);
    assertEquals(ASCII, Files.toString(temp2, Charsets.UTF_8));
  }
<A NAME="7"></A>
  public void testEqual() throws IOException {
    File asciiFile = getTestFile(&quot;ascii.txt&quot;);
    File i18nFile = <FONT color="#38a4a5"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#7',2,'match64661-top.html#7',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>getTestFile(&quot;i18n.txt&quot;);
    assertFalse(Files.equal(asciiFile, i18nFile));
    assertTrue(Files.equal(asciiFile, asciiFile));

    File temp = createTempFile();
    Files.copy(asciiFile, temp);
    assertTrue(Files.equal(asciiFile, temp));

    Files.copy(i18nFile, temp);
    assertTrue(Files.equal(i18nFile, temp));
<A NAME="13"></A>
    Files.copy</B></FONT>(asciiFile, temp);
    RandomAccessFile rf = new RandomAccessFile(temp, &quot;rw&quot;);
    <FONT color="#3b9c9c"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#13',2,'match64661-top.html#13',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>rf.writeByte(0);
    rf.close();
    assertEquals(asciiFile.length(), temp.length());
    assertFalse(Files.equal(asciiFile, temp));

    assertTrue(Files.asByteSource(asciiFile).contentEquals(Files.asByteSource(asciiFile)));

    // 0-length files have special treatment (/proc, etc.)
    assertTrue(Files.equal</B></FONT>(asciiFile, new BadLengthFile(asciiFile, 0)));
  }

  public void testNewReader() throws IOException {
    File asciiFile = getTestFile(&quot;ascii.txt&quot;);
    try {
      Files.newReader(asciiFile, null);
      fail(&quot;expected exception&quot;);
    } catch (NullPointerException expected) {
    }

    try {
      Files.newReader(null, Charsets.UTF_8);
      fail(&quot;expected exception&quot;);
    } catch (NullPointerException expected) {
    }

    BufferedReader r = Files.newReader(asciiFile, Charsets.US_ASCII);
    try {
      assertEquals(ASCII, r.readLine());
    } finally {
      r.close();
    }
  }

  public void testNewWriter() throws IOException {
    File temp = createTempFile();
    try {
      Files.newWriter(temp, null);
      fail(&quot;expected exception&quot;);
    } catch (NullPointerException expected) {
    }

    try {
      Files.newWriter(null, Charsets.UTF_8);
      fail(&quot;expected exception&quot;);
    } catch (NullPointerException expected) {
    }

    BufferedWriter w = Files.newWriter(temp, Charsets.UTF_8);
    try {
      w.write(I18N);
    } finally {
      w.close();
    }

    File i18nFile = getTestFile(&quot;i18n.txt&quot;);
<A NAME="12"></A>    assertTrue(Files.equal(i18nFile, temp));
  }

  public void testTouch() throws IOException <FONT color="#571b7e"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#12',2,'match64661-top.html#12',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>{
    File temp = createTempFile();
    assertTrue(temp.exists());
    assertTrue(temp.delete());
    assertFalse(temp.exists());
    Files.touch(temp);
    assertTrue(temp.exists());
    Files.touch</B></FONT>(temp);
    assertTrue(temp.exists());

    try {
      Files.touch(
          new File(temp.getPath()) {
            @Override
            public boolean setLastModified(long t) {
              return false;
            }

            private static final long serialVersionUID = 0;
          });
      fail(&quot;expected exception&quot;);
    } catch (IOException expected) {
    }
<A NAME="10"></A>  }

  public void testTouchTime() throws IOException {
    File temp = <FONT color="#ad5910"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#10',2,'match64661-top.html#10',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>createTempFile();
    assertTrue(temp.exists());
    temp.setLastModified(0);
    assertEquals(0, temp.lastModified());
    Files.touch(temp);
    assertThat(temp.lastModified()).isNotEqualTo(0);
<A NAME="17"></A>  }

  public void testCreatePar</B></FONT>entDirs_root() throws IOException {
    File file = <FONT color="#3090c7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#17',2,'match64661-top.html#17',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>root();
    assertNull(file.getParentFile());
    assertNull(file.getCanonicalFile().getParentFile());
    Files.createParentDirs(file);
<A NAME="16"></A>  }

  public void testCreateParentDirs_</B></FONT>relativePath() throws IOException {
    File file = <FONT color="#2981b2"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#16',2,'match64661-top.html#16',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>file(&quot;nonexistent.file&quot;);
    assertNull(file.getParentFile());
    assertNotNull(file.getCanonicalFile().getParentFile());
    Files.createParentDirs(file);
<A NAME="20"></A>  }

  public void testCreateParentDirs_noP</B></FONT>arentsNeeded() throws IOException {
    File file = <FONT color="#4e9258"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#20',2,'match64661-top.html#20',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>file(getTempDir(), &quot;nonexistent.file&quot;);
    assertTrue(file.getParentFile().exists());
    Files.createParentDirs(file);
  }

  public void testCreateParentDirs_one</B></FONT>ParentNeeded() throws IOException {
    File file = file(getTempDir(), &quot;parent&quot;, &quot;nonexistent.file&quot;);
    File parent = file.getParentFile();
    assertFalse(parent.exists());
    try {
      Files.createParentDirs(file);
      assertTrue(parent.exists());
    } finally {
      assertTrue(parent.delete());
    }
  }

<A NAME="19"></A>  public void testCreateParentDirs_multipleParentsNeeded() throws IOException {
    File file = file(getTempDir(), &quot;grandparent&quot;, &quot;parent&quot;, &quot;nonexistent.file&quot;);
    File parent = file.getParentFile();
    File grandparent = <FONT color="#f62817"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#19',2,'match64661-top.html#19',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>parent.getParentFile();
    assertFalse(grandparent.exists());
    Files.createParentDirs(file);
    assertTrue(parent.exists());
  }

  public void testCreateParentDirs_nonDirectory</B></FONT>ParentExists() throws IOException {
    File parent = getTestFile(&quot;ascii.txt&quot;);
    assertTrue(parent.isFile());
    File file = file(parent, &quot;foo&quot;);
    try {
      Files.createParentDirs(file);
      fail();
    } catch (IOException expected) {
    }
<A NAME="9"></A>  }

  public void testCreateTempDir() {
    File temp = <FONT color="#83a33a"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#9',2,'match64661-top.html#9',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>Files.createTempDir();
    assertTrue(temp.exists());
    assertTrue(temp.isDirectory());
    assertThat(temp.listFiles()).isEmpty();
    assertTrue(temp.delete());
  }

  public v</B></FONT>oid testMove() throws IOException {
    File i18nFile = getTestFile(&quot;i18n.txt&quot;);
    File temp1 = createTempFile();
    File temp2 = createTempFile();

    Files.copy(i18nFile, temp1);
    moveHelper(true, temp1, temp2);
    assertTrue(Files.equal(temp2, i18nFile));
  }

  public void testMoveViaCopy() throws IOException {
    File i18nFile = getTestFile(&quot;i18n.txt&quot;);
    File temp1 = createTempFile();
    File temp2 = createTempFile();

    Files.copy(i18nFile, temp1);
    moveHelper(true, new UnmovableFile(temp1, false, true), temp2);
    assertTrue(Files.equal(temp2, i18nFile));
  }

  public void testMoveFailures() throws IOException {
    File temp1 = createTempFile();
    File temp2 = createTempFile();

    moveHelper(false, new UnmovableFile(temp1, false, false), temp2);
    moveHelper(
        false, new UnmovableFile(temp1, false, false), new UnmovableFile(temp2, true, false));

    try {
      File asciiFile = getTestFile(&quot;ascii.txt&quot;);
      moveHelper(false, asciiFile, asciiFile);
      fail(&quot;expected exception&quot;);
    } catch (IllegalArgumentException expected) {
    }
  }

  private void moveHelper(boolean success, File from, File to) throws IOException {
    try {
      Files.move(from, to);
      if (success) {
        assertFalse(from.exists());
        assertTrue(to.exists());
      } else {
        fail(&quot;expected exception&quot;);
      }
    } catch (IOException possiblyExpected) {
      if (success) {
        throw possiblyExpected;
      }
    }
  }

  private static class UnmovableFile extends File {

    private final boolean canRename;
    private final boolean canDelete;

    public UnmovableFile(File file, boolean canRename, boolean canDelete) {
      super(file.getPath());
      this.canRename = canRename;
      this.canDelete = canDelete;
    }

    @Override
    public boolean renameTo(File to) {
      return canRename &amp;&amp; super.renameTo(to);
    }

    @Override
    public boolean delete() {
      return canDelete &amp;&amp; super.delete();
    }

    private static final long serialVersionUID = 0;
  }

  public void testLineReading() throws IOException {
    File temp = createTempFile();
<A NAME="5"></A>    assertNull(Files.readFirstLine(temp, Charsets.UTF_8));
    assertTrue(Files.readLines(temp, Charsets.UTF_8).isEmpty());

    PrintWriter w = new PrintWriter(<FONT color="#151b8d"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#5',2,'match64661-top.html#5',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>Files.newWriter(temp, Charsets.UTF_8));
    w.println(&quot;hello&quot;);
    w.println(&quot;&quot;);
    w.println(&quot; world  &quot;);
    w.println(&quot;&quot;);
    w.close();

    assertEquals(&quot;hello&quot;, Files.readFirstLine(temp, Charsets.UTF_8));
    assertEquals(
        ImmutableList.of(&quot;hello&quot;, &quot;&quot;, &quot; world  &quot;, &quot;&quot;), Files.readLines(temp, Charsets.UTF_8));

    assertTrue(temp.delete());
  }

  public void testReadLines_withL</B></FONT>ineProcessor() throws IOException {
    File temp = createTempFile();
    LineProcessor&lt;List&lt;String&gt;&gt; collect =
        new LineProcessor&lt;List&lt;String&gt;&gt;() {
          List&lt;String&gt; collector = new ArrayList&lt;&gt;();

          @Override
          public boolean processLine(String line) {
            collector.add(line);
            return true;
          }

          @Override
          public List&lt;String&gt; getResult() {
            return collector;
          }
<A NAME="14"></A>        };
    assertThat(Files.readLines(temp, Charsets.UTF_8, collect)).isEmpty();

    PrintWriter w = new PrintWriter(<FONT color="#842dce"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#14',2,'match64661-top.html#14',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>Files.newWriter(temp, Charsets.UTF_8));
    w.println(&quot;hello&quot;);
    w.println(&quot;&quot;);
    w.println(&quot; world  &quot;);
    w.println(&quot;&quot;);
    w.close();
    Files.readLines(temp, Charsets.UTF_8, collect);
    assertThat(collect.getResult</B></FONT>()).containsExactly(&quot;hello&quot;, &quot;&quot;, &quot; world  &quot;, &quot;&quot;).inOrder();

    LineProcessor&lt;List&lt;String&gt;&gt; collectNonEmptyLines =
        new LineProcessor&lt;List&lt;String&gt;&gt;() {
          List&lt;String&gt; collector = new ArrayList&lt;&gt;();

          @Override
          public boolean processLine(String line) {
            if (line.length() &gt; 0) {
              collector.add(line);
            }
            return true;
          }

          @Override
          public List&lt;String&gt; getResult() {
<A NAME="15"></A>            return collector;
          }
        };
    <FONT color="#f52887"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#15',2,'match64661-top.html#15',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>Files.readLines(temp, Charsets.UTF_8, collectNonEmptyLines);
    assertThat(collectNonEmptyLines.getResult()).containsExactly(&quot;hello&quot;, &quot; world  &quot;).inOrder();

    assertTrue(temp.delete());
  }

  public v</B></FONT>oid testHash() throws IOException {
    File asciiFile = getTestFile(&quot;ascii.txt&quot;);
    File i18nFile = getTestFile(&quot;i18n.txt&quot;);

    String init = &quot;d41d8cd98f00b204e9800998ecf8427e&quot;;
    assertEquals(init, Hashing.md5().newHasher().hash().toString());

    String asciiHash = &quot;e5df5a39f2b8cb71b24e1d8038f93131&quot;;
    assertEquals(asciiHash, Files.hash(asciiFile, Hashing.md5()).toString());

    String i18nHash = &quot;7fa826962ce2079c8334cd4ebf33aea4&quot;;
    assertEquals(i18nHash, Files.hash(i18nFile, Hashing.md5()).toString());
  }

  public void testMap() throws IOException {
    // Test data
    int size = 1024;
    byte[] bytes = newPreFilledByteArray(size);

    // Setup
    File file = createTempFile();
    Files.write(bytes, file);

    // Test
    MappedByteBuffer actual = Files.map(file);

    // Verify
    ByteBuffer expected = ByteBuffer.wrap(bytes);
    assertTrue(&quot;ByteBuffers should be equal.&quot;, expected.equals(actual));
  }

  public void testMap_noSuchFile() throws IOException {
    // Setup
    File file = createTempFile();
    boolean deleted = file.delete();
    assertTrue(deleted);

    // Test
    try {
      Files.map(file);
      fail(&quot;Should have thrown FileNotFoundException.&quot;);
    } catch (FileNotFoundException expected) {
    }
  }

  public void testMap_readWrite() throws IOException {
    // Test data
    int size = 1024;
    byte[] expectedBytes = new byte[size];
    byte[] bytes = newPreFilledByteArray(1024);

    // Setup
    File file = createTempFile();
    Files.write(bytes, file);

    Random random = new Random();
    random.nextBytes(expectedBytes);

    // Test
    MappedByteBuffer map = Files.map(file, MapMode.READ_WRITE);
    map.put(expectedBytes);

    // Verify
    byte[] actualBytes = Files.toByteArray(file);
    assertTrue(Arrays.equals(expectedBytes, actualBytes));
  }

  public void testMap_readWrite_creates() throws IOException {
    // Test data
    int size = 1024;
    byte[] expectedBytes = newPreFilledByteArray(1024);

    // Setup
<A NAME="18"></A>    File file = createTempFile();
    boolean deleted = file.delete();
    assertTrue(deleted);
    assertFalse(<FONT color="#800517"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#18',2,'match64661-top.html#18',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>file.exists());

    // Test
    MappedByteBuffer map = Files.map(file, MapMode.READ_WRITE, size);
    map.put(expectedBytes);

    // Verify
    assertTrue(file.exists());
    assertTrue(file.isFile());
    assertEquals(size, file.length</B></FONT>());
    byte[] actualBytes = Files.toByteArray(file);
    assertTrue(Arrays.equals(expectedBytes, actualBytes));
  }

  public void testMap_readWrite_max_value_plus_1() throws IOException {
    // Setup
    File file = createTempFile();
    // Test
    try {
      Files.map(file, MapMode.READ_WRITE, (long) Integer.MAX_VALUE + 1);
      fail(&quot;Should throw when size exceeds Integer.MAX_VALUE&quot;);
    } catch (IllegalArgumentException expected) {
    }
<A NAME="0"></A>  }

  public void testGetFileExtension() {
    <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#0',2,'match64661-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>assertEquals(&quot;txt&quot;, Files.getFileExtension(&quot;.txt&quot;));
    assertEquals(&quot;txt&quot;, Files.getFileExtension(&quot;blah.txt&quot;));
    assertEquals(&quot;txt&quot;, Files.getFileExtension(&quot;blah..txt&quot;));
    assertEquals(&quot;txt&quot;, Files.getFileExtension(&quot;.blah.txt&quot;));
    assertEquals(&quot;txt&quot;, Files.getFileExtension(&quot;/tmp/blah.txt&quot;));
    assertEquals(&quot;gz&quot;, Files.getFileExtension(&quot;blah.tar.gz&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;/&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;.&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;..&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;...&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;blah&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;blah.&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;.blah.&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;/foo.bar/blah&quot;));
    assertEquals(&quot;&quot;, Files.getFileExtension(&quot;/foo/.bar/blah&quot;));
<A NAME="1"></A>  }

  public void testGetNameWith</B></FONT>outExtension() {
    <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#1',2,'match64661-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>assertEquals(&quot;&quot;, Files.getNameWithoutExtension(&quot;.txt&quot;));
    assertEquals(&quot;blah&quot;, Files.getNameWithoutExtension(&quot;blah.txt&quot;));
    assertEquals(&quot;blah.&quot;, Files.getNameWithoutExtension(&quot;blah..txt&quot;));
    assertEquals(&quot;.blah&quot;, Files.getNameWithoutExtension(&quot;.blah.txt&quot;));
    assertEquals(&quot;blah&quot;, Files.getNameWithoutExtension(&quot;/tmp/blah.txt&quot;));
    assertEquals(&quot;blah.tar&quot;, Files.getNameWithoutExtension(&quot;blah.tar.gz&quot;));
    assertEquals(&quot;&quot;, Files.getNameWithoutExtension(&quot;/&quot;));
    assertEquals(&quot;&quot;, Files.getNameWithoutExtension(&quot;.&quot;));
    assertEquals(&quot;.&quot;, Files.getNameWithoutExtension(&quot;..&quot;));
    assertEquals(&quot;..&quot;, Files.getNameWithoutExtension(&quot;...&quot;));
    assertEquals(&quot;blah&quot;, Files.getNameWithoutExtension(&quot;blah&quot;));
    assertEquals(&quot;blah&quot;, Files.getNameWithoutExtension(&quot;blah.&quot;));
    assertEquals(&quot;.blah&quot;, Files.getNameWithoutExtension(&quot;.blah.&quot;));
    assertEquals(&quot;blah&quot;, Files.getNameWithoutExtension(&quot;/foo.bar/blah&quot;));
    assertEquals(&quot;blah&quot;, Files.getNameWithoutExtension</B></FONT>(&quot;/foo/.bar/blah&quot;));
  }

  public void testReadBytes() throws IOException {
    ByteProcessor&lt;byte[]&gt; processor =
        new ByteProcessor&lt;byte[]&gt;() {
          private final ByteArrayOutputStream out = new ByteArrayOutputStream();

          @Override
          public boolean processBytes(byte[] buffer, int offset, int length) throws IOException {
            if (length &gt;= 0) {
              out.write(buffer, offset, length);
            }
            return true;
          }

          @Override
          public byte[] getResult() {
            return out.toByteArray();
          }
        };

    File asciiFile = getTestFile(&quot;ascii.txt&quot;);
    byte[] result = Files.readBytes(asciiFile, processor);
    assertEquals(Bytes.asList(Files.toByteArray(asciiFile)), Bytes.asList(result));
  }

  public void testReadBytes_returnFalse() throws IOException {
    ByteProcessor&lt;byte[]&gt; processor =
        new ByteProcessor&lt;byte[]&gt;() {
          private final ByteArrayOutputStream out = new ByteArrayOutputStream();

          @Override
          public boolean processBytes(byte[] buffer, int offset, int length) throws IOException {
            if (length &gt; 0) {
              out.write(buffer, offset, 1);
              return false;
            } else {
              return true;
            }
          }

          @Override
          public byte[] getResult() {
            return out.toByteArray();
          }
        };

    File asciiFile = getTestFile(&quot;ascii.txt&quot;);
    byte[] result = Files.readBytes(asciiFile, processor);
    assertEquals(1, result.length);
  }
<A NAME="4"></A>
  public void testPredicates() throws IOException {
    File asciiFile = getTestFile(&quot;ascii.txt&quot;);
    File dir = <FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match64661-0.html#4',2,'match64661-top.html#4',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>asciiFile.getParentFile();
    assertTrue(Files.isDirectory().apply(dir));
    assertFalse(Files.isFile().apply(dir));

    assertFalse(Files.isDirectory().apply(asciiFile));
    assertTrue(Files.isFile().apply(asciiFile));
  }

  /** Returns a root path for the file system. */
  priv</B></FONT>ate static File root() {
    return File.listRoots()[0];
  }

  /** Returns a {@code File} object for the given path parts. */
  private static File file(String first, String... more) {
    return file(new File(first), more);
  }

  /** Returns a {@code File} object for the given path parts. */
  private static File file(File first, String... more) {
    // not very efficient, but should definitely be correct
    File file = first;
    for (String name : more) {
      file = new File(file, name);
    }
    return file;
  }
}
</PRE>
</div>
  </div>
</body>
</html>
