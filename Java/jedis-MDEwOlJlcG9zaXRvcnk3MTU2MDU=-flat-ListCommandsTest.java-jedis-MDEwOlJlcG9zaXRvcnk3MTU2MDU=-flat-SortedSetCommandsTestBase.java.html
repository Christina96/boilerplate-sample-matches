
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 45.741431964709875%, Tokens: 10</h2>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ListCommandsTest.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.jedis;
2  import static org.junit.Assert.assertArrayEquals;
3  import static org.junit.Assert.assertEquals;
4  import static org.junit.Assert.assertNotNull;
5  import static org.junit.Assert.assertNull;
6  import static org.junit.Assert.assertTrue;
7  import static org.junit.Assert.fail;
8  import static redis.clients.jedis.util.AssertUtil.assertByteArrayListEquals;
9  import java.util.ArrayList;
10  import java.util.Arrays;
11  import java.util.Collections;
12  import java.util.List;
13  import org.junit.Test;
14  import org.slf4j.Logger;
15  import org.slf4j.LoggerFactory;
16  import redis.clients.jedis.Jedis;
17  import redis.clients.jedis.args.ListPosition;
18  import redis.clients.jedis.args.ListDirection;
19  import redis.clients.jedis.exceptions.JedisDataException;
20  import redis.clients.jedis.params.LPosParams;
21  import redis.clients.jedis.util.KeyValue;
22  public class ListCommandsTest extends JedisCommandsTestBase {
23    private final Logger logger = LoggerFactory.getLogger(getClass());
24    final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
25    final byte[] bfoo1 = { 0x01, 0x02, 0x03, 0x04, 0x05 };
26    final byte[] bbar = { 0x05, 0x06, 0x07, 0x08 };
27    final byte[] bcar = { 0x09, 0x0A, 0x0B, 0x0C };
28    final byte[] bA = { 0x0A };
29    final byte[] bB = { 0x0B };
30    final byte[] bC = { 0x0C };
31    final byte[] b1 = { 0x01 };
32    final byte[] b2 = { 0x02 };
33    final byte[] b3 = { 0x03 };
34    final byte[] bhello = { 0x04, 0x02 };
35    final byte[] bx = { 0x02, 0x04 };
36    final byte[] bdst = { 0x11, 0x12, 0x13, 0x14 };
37    @Test
38    public void rpush() {
39      assertEquals(1, jedis.rpush("foo", "bar"));
40      assertEquals(2, jedis.rpush("foo", "foo"));
41      assertEquals(4, jedis.rpush("foo", "bar", "foo"));
42      assertEquals(1, jedis.rpush(bfoo, bbar));
43      assertEquals(2, jedis.rpush(bfoo, bfoo));
44      assertEquals(4, jedis.rpush(bfoo, bbar, bfoo));
45    }
46    @Test
47    public void lpush() {
48      assertEquals(1, jedis.lpush("foo", "bar"));
49      assertEquals(2, jedis.lpush("foo", "foo"));
50      assertEquals(4, jedis.lpush("foo", "bar", "foo"));
51      assertEquals(1, jedis.lpush(bfoo, bbar));
52      assertEquals(2, jedis.lpush(bfoo, bfoo));
53      assertEquals(4, jedis.lpush(bfoo, bbar, bfoo));
54    }
55    @Test
56    public void llen() {
57      assertEquals(0, jedis.llen("foo"));
58      jedis.lpush("foo", "bar");
59      jedis.lpush("foo", "car");
60      assertEquals(2, jedis.llen("foo"));
61      assertEquals(0, jedis.llen(bfoo));
62      jedis.lpush(bfoo, bbar);
63      jedis.lpush(bfoo, bcar);
64      assertEquals(2, jedis.llen(bfoo));
65    }
66    @Test
67    public void llenNotOnList() {
68      try {
69        jedis.set("foo", "bar");
70        jedis.llen("foo");
71        fail("JedisDataException expected");
72      } catch (final JedisDataException e) {
73      }
74      try {
75        jedis.set(bfoo, bbar);
76        jedis.llen(bfoo);
77        fail("JedisDataException expected");
78      } catch (final JedisDataException e) {
79      }
80    }
81    @Test
82    public void lrange() {
83      jedis.rpush("foo", "a");
84      jedis.rpush("foo", "b");
85      jedis.rpush("foo", "c");
86      List<String> expected = new ArrayList<String>();
87      expected.add("a");
88      expected.add("b");
89      expected.add("c");
90      List<String> range = jedis.lrange("foo", 0, 2);
91      assertEquals(expected, range);
92      range = jedis.lrange("foo", 0, 20);
93      assertEquals(expected, range);
94      expected = new ArrayList<String>();
95      expected.add("b");
96      expected.add("c");
97      range = jedis.lrange("foo", 1, 2);
98      assertEquals(expected, range);
99      range = jedis.lrange("foo", 2, 1);
100      assertEquals(Collections.<String> emptyList(), range);
101      jedis.rpush(bfoo, bA);
102      jedis.rpush(bfoo, bB);
103      jedis.rpush(bfoo, bC);
104      List<byte[]> bexpected = new ArrayList<byte[]>();
105      bexpected.add(bA);
106      bexpected.add(bB);
107      bexpected.add(bC);
108      List<byte[]> brange = jedis.lrange(bfoo, 0, 2);
109      assertByteArrayListEquals(bexpected, brange);
110      brange = jedis.lrange(bfoo, 0, 20);
111      assertByteArrayListEquals(bexpected, brange);
112      bexpected = new ArrayList<byte[]>();
113      bexpected.add(bB);
114      bexpected.add(bC);
115      brange = jedis.lrange(bfoo, 1, 2);
116      assertByteArrayListEquals(bexpected, brange);
117      brange = jedis.lrange(bfoo, 2, 1);
118      assertByteArrayListEquals(Collections.<byte[]> emptyList(), brange);
119    }
120    @Test
121    public void ltrim() {
122      jedis.lpush("foo", "1");
123      jedis.lpush("foo", "2");
124      jedis.lpush("foo", "3");
125      String status = jedis.ltrim("foo", 0, 1);
126      List<String> expected = new ArrayList<String>();
127      expected.add("3");
128      expected.add("2");
129      assertEquals("OK", status);
130      assertEquals(2, jedis.llen("foo"));
131      assertEquals(expected, jedis.lrange("foo", 0, 100));
132      jedis.lpush(bfoo, b1);
133      jedis.lpush(bfoo, b2);
134      jedis.lpush(bfoo, b3);
135      String bstatus = jedis.ltrim(bfoo, 0, 1);
136      List<byte[]> bexpected = new ArrayList<byte[]>();
137      bexpected.add(b3);
138      bexpected.add(b2);
139      assertEquals("OK", bstatus);
140      assertEquals(2, jedis.llen(bfoo));
141      assertByteArrayListEquals(bexpected, jedis.lrange(bfoo, 0, 100));
142    }
143    @Test
144    public void lset() {
145      jedis.lpush("foo", "1");
146      jedis.lpush("foo", "2");
147      jedis.lpush("foo", "3");
148      List<String> expected = new ArrayList<String>();
149      expected.add("3");
150      expected.add("bar");
151      expected.add("1");
152      String status = jedis.lset("foo", 1, "bar");
153      assertEquals("OK", status);
154      assertEquals(expected, jedis.lrange("foo", 0, 100));
155      jedis.lpush(bfoo, b1);
156      jedis.lpush(bfoo, b2);
157      jedis.lpush(bfoo, b3);
158      List<byte[]> bexpected = new ArrayList<byte[]>();
159      bexpected.add(b3);
160      bexpected.add(bbar);
161      bexpected.add(b1);
162      String bstatus = jedis.lset(bfoo, 1, bbar);
163      assertEquals("OK", bstatus);
164      assertByteArrayListEquals(bexpected, jedis.lrange(bfoo, 0, 100));
165    }
166    @Test
167    public void lindex() {
168      jedis.lpush("foo", "1");
169      jedis.lpush("foo", "2");
170      jedis.lpush("foo", "3");
171      assertEquals("3", jedis.lindex("foo", 0));
172      assertNull(jedis.lindex("foo", 100));
173      jedis.lpush(bfoo, b1);
174      jedis.lpush(bfoo, b2);
175      jedis.lpush(bfoo, b3);
176      assertArrayEquals(b3, jedis.lindex(bfoo, 0));
177      assertNull(jedis.lindex(bfoo, 100));
178    }
179    @Test
180    public void lrem() {
181      jedis.lpush("foo", "hello");
182      jedis.lpush("foo", "hello");
183      jedis.lpush("foo", "x");
184      jedis.lpush("foo", "hello");
185      jedis.lpush("foo", "c");
186      jedis.lpush("foo", "b");
187      jedis.lpush("foo", "a");
188      List<String> expected = new ArrayList<String>();
189      expected.add("a");
190      expected.add("b");
191      expected.add("c");
192      expected.add("hello");
193      expected.add("x");
194      assertEquals(2, jedis.lrem("foo", -2, "hello"));
195      assertEquals(expected, jedis.lrange("foo", 0, 1000));
196      assertEquals(0, jedis.lrem("bar", 100, "foo"));
197      jedis.lpush(bfoo, bhello);
198      jedis.lpush(bfoo, bhello);
199      jedis.lpush(bfoo, bx);
200      jedis.lpush(bfoo, bhello);
201      jedis.lpush(bfoo, bC);
202      jedis.lpush(bfoo, bB);
203      jedis.lpush(bfoo, bA);
204      List<byte[]> bexpected = new ArrayList<byte[]>();
205      bexpected.add(bA);
206      bexpected.add(bB);
207      bexpected.add(bC);
208      bexpected.add(bhello);
209      bexpected.add(bx);
210      assertEquals(2, jedis.lrem(bfoo, -2, bhello));
211      assertByteArrayListEquals(bexpected, jedis.lrange(bfoo, 0, 1000));
212      assertEquals(0, jedis.lrem(bbar, 100, bfoo));
213    }
214    @Test
215    public void lpop() {
216      assertNull(jedis.lpop("foo"));
217      assertNull(jedis.lpop("foo", 0));
218      jedis.rpush("foo", "a");
219      jedis.rpush("foo", "b");
220      jedis.rpush("foo", "c");
221      assertEquals("a", jedis.lpop("foo"));
222      assertEquals(Arrays.asList("b", "c"), jedis.lpop("foo", 10));
223      assertNull(jedis.lpop("foo"));
224      assertNull(jedis.lpop("foo", 1));
225      assertNull(jedis.lpop(bfoo));
226      assertNull(jedis.lpop(bfoo, 0));
227      jedis.rpush(bfoo, bA);
228      jedis.rpush(bfoo, bB);
229      jedis.rpush(bfoo, bC);
230      assertArrayEquals(bA, jedis.lpop(bfoo));
231      assertByteArrayListEquals(Arrays.asList(bB, bC), jedis.lpop(bfoo, 10));
232      assertNull(jedis.lpop(bfoo));
233      assertNull(jedis.lpop(bfoo, 1));
234    }
235    @Test
236    public void rpop() {
237      assertNull(jedis.rpop("foo"));
238      assertNull(jedis.rpop("foo", 0));
239      jedis.rpush("foo", "a");
240      jedis.rpush("foo", "b");
241      jedis.rpush("foo", "c");
242      assertEquals("c", jedis.rpop("foo"));
243      assertEquals(Arrays.asList("b", "a"), jedis.rpop("foo", 10));
244      assertNull(jedis.rpop("foo"));
245      assertNull(jedis.rpop("foo", 1));
246      assertNull(jedis.rpop(bfoo));
247      assertNull(jedis.rpop(bfoo, 0));
248      jedis.rpush(bfoo, bA);
249      jedis.rpush(bfoo, bB);
250      jedis.rpush(bfoo, bC);
251      assertArrayEquals(bC, jedis.rpop(bfoo));
252      assertByteArrayListEquals(Arrays.asList(bB, bA), jedis.rpop(bfoo, 10));
253      assertNull(jedis.rpop(bfoo));
254      assertNull(jedis.rpop(bfoo, 1));
255    }
256    @Test
257    public void rpoplpush() {
258      jedis.rpush("foo", "a");
259      jedis.rpush("foo", "b");
260      jedis.rpush("foo", "c");
261      jedis.rpush("dst", "foo");
262      jedis.rpush("dst", "bar");
263      String element = jedis.rpoplpush("foo", "dst");
264      assertEquals("c", element);
265      List<String> srcExpected = new ArrayList<String>();
266      srcExpected.add("a");
267      srcExpected.add("b");
268      List<String> dstExpected = new ArrayList<String>();
269      dstExpected.add("c");
270      dstExpected.add("foo");
271      dstExpected.add("bar");
272      assertEquals(srcExpected, jedis.lrange("foo", 0, 1000));
273      assertEquals(dstExpected, jedis.lrange("dst", 0, 1000));
274      jedis.rpush(bfoo, bA);
275      jedis.rpush(bfoo, bB);
276      jedis.rpush(bfoo, bC);
277      jedis.rpush(bdst, bfoo);
278      jedis.rpush(bdst, bbar);
279      byte[] belement = jedis.rpoplpush(bfoo, bdst);
280      assertArrayEquals(bC, belement);
281      List<byte[]> bsrcExpected = new ArrayList<byte[]>();
282      bsrcExpected.add(bA);
283      bsrcExpected.add(bB);
284      List<byte[]> bdstExpected = new ArrayList<byte[]>();
285      bdstExpected.add(bC);
286      bdstExpected.add(bfoo);
287      bdstExpected.add(bbar);
288      assertByteArrayListEquals(bsrcExpected, jedis.lrange(bfoo, 0, 1000));
289      assertByteArrayListEquals(bdstExpected, jedis.lrange(bdst, 0, 1000));
290    }
291    @Test
292    public void blpop() throws InterruptedException {
293      List<String> result = jedis.blpop(1, "foo");
294      assertNull(result);
295      jedis.lpush("foo", "bar");
296      result = jedis.blpop(1, "foo");
297      assertNotNull(result);
298      assertEquals(2, result.size());
299      assertEquals("foo", result.get(0));
300      assertEquals("bar", result.get(1));
301      result = jedis.blpop(1, "foo", "foo1");
302      assertNull(result);
303      jedis.lpush("foo", "bar");
304      jedis.lpush("foo1", "bar1");
305      result = jedis.blpop(1, "foo1", "foo");
306      assertNotNull(result);
307      assertEquals(2, result.size());
308      assertEquals("foo1", result.get(0));
309      assertEquals("bar1", result.get(1));
310      jedis.lpush(bfoo, bbar);
311      List<byte[]> bresult = jedis.blpop(1, bfoo);
312      assertNotNull(bresult);
313      assertEquals(2, bresult.size());
314      assertArrayEquals(bfoo, bresult.get(0));
315      assertArrayEquals(bbar, bresult.get(1));
316      bresult = jedis.blpop(1, bfoo, bfoo1);
317      assertNull(bresult);
318      jedis.lpush(bfoo, bbar);
319      jedis.lpush(bfoo1, bcar);
320      bresult = jedis.blpop(1, bfoo, bfoo1);
321      assertNotNull(bresult);
322      assertEquals(2, bresult.size());
323      assertArrayEquals(bfoo, bresult.get(0));
324      assertArrayEquals(bbar, bresult.get(1));
325    }
326    @Test
327    public void blpopDouble() throws InterruptedException {
328      KeyValue<String, String> result = jedis.blpop(0.1, "foo");
329      assertNull(result);
<span onclick='openModal()' class='match'>330      jedis.lpush("foo", "bar");
331      result = jedis.blpop(3.2, "foo");
332      assertNotNull(result);
333      assertEquals("foo", result.getKey());
334      assertEquals("bar", result.getValue());
335      result = jedis.blpop(0.18, "foo", "foo1");
</span>336      assertNull(result);
337      jedis.lpush("foo", "bar");
338      jedis.lpush("foo1", "bar1");
339      result = jedis.blpop(1d, "foo1", "foo");
340      assertNotNull(result);
341      assertEquals("foo1", result.getKey());
342      assertEquals("bar1", result.getValue());
343      jedis.lpush(bfoo, bbar);
344      KeyValue<byte[], byte[]> bresult = jedis.blpop(3.12, bfoo);
345      assertNotNull(bresult);
346      assertArrayEquals(bfoo, bresult.getKey());
347      assertArrayEquals(bbar, bresult.getValue());
348      bresult = jedis.blpop(0.11, bfoo, bfoo1);
349      assertNull(bresult);
350      jedis.lpush(bfoo, bbar);
351      jedis.lpush(bfoo1, bcar);
352      bresult = jedis.blpop(1d, bfoo, bfoo1);
353      assertNotNull(bresult);
354      assertArrayEquals(bfoo, bresult.getKey());
355      assertArrayEquals(bbar, bresult.getValue());
356    }
357    @Test
358    public void blpopDoubleWithSleep() {
359      long startMillis, totalMillis;
360      startMillis = System.currentTimeMillis();
361      KeyValue<String, String> result = jedis.blpop(0.04, "foo");
362      totalMillis = System.currentTimeMillis() - startMillis;
363      assertTrue("TotalMillis=" + totalMillis, totalMillis < 200);
364      assertNull(result);
365      startMillis = System.currentTimeMillis();
366      new Thread(() -> {
367        try {
368          Thread.sleep(30);
369        } catch(InterruptedException e) {
370          logger.error("", e);
371        }
372        try (Jedis j = createJedis()) {
373          j.lpush("foo", "bar");
374        }
375      }).start();
376      result = jedis.blpop(1.2, "foo");
377      totalMillis = System.currentTimeMillis() - startMillis;
378      assertTrue("TotalMillis=" + totalMillis, totalMillis < 200);
379      assertNotNull(result);
380      assertEquals("foo", result.getKey());
381      assertEquals("bar", result.getValue());
382    }
383    @Test
384    public void brpop() throws InterruptedException {
385      List<String> result = jedis.brpop(1, "foo");
386      assertNull(result);
387      jedis.lpush("foo", "bar");
388      result = jedis.brpop(1, "foo");
389      assertNotNull(result);
390      assertEquals(2, result.size());
391      assertEquals("foo", result.get(0));
392      assertEquals("bar", result.get(1));
393      result = jedis.brpop(1, "foo", "foo1");
394      assertNull(result);
395      jedis.lpush("foo", "bar");
396      jedis.lpush("foo1", "bar1");
397      result = jedis.brpop(1, "foo1", "foo");
398      assertNotNull(result);
399      assertEquals(2, result.size());
400      assertEquals("foo1", result.get(0));
401      assertEquals("bar1", result.get(1));
402      jedis.lpush(bfoo, bbar);
403      List<byte[]> bresult = jedis.brpop(1, bfoo);
404      assertNotNull(bresult);
405      assertEquals(2, bresult.size());
406      assertArrayEquals(bfoo, bresult.get(0));
407      assertArrayEquals(bbar, bresult.get(1));
408      bresult = jedis.brpop(1, bfoo, bfoo1);
409      assertNull(bresult);
410      jedis.lpush(bfoo, bbar);
411      jedis.lpush(bfoo1, bcar);
412      bresult = jedis.brpop(1, bfoo, bfoo1);
413      assertNotNull(bresult);
414      assertEquals(2, bresult.size());
415      assertArrayEquals(bfoo, bresult.get(0));
416      assertArrayEquals(bbar, bresult.get(1));
417    }
418    @Test
419    public void brpopDouble() throws InterruptedException {
420      KeyValue<String, String> result = jedis.brpop(0.1, "foo");
421      assertNull(result);
422      jedis.lpush("foo", "bar");
423      result = jedis.brpop(3.2, "foo");
424      assertNotNull(result);
425      assertEquals("foo", result.getKey());
426      assertEquals("bar", result.getValue());
427      result = jedis.brpop(0.18, "foo", "foo1");
428      assertNull(result);
429      jedis.lpush("foo", "bar");
430      jedis.lpush("foo1", "bar1");
431      result = jedis.brpop(1d, "foo1", "foo");
432      assertNotNull(result);
433      assertEquals("foo1", result.getKey());
434      assertEquals("bar1", result.getValue());
435      jedis.lpush(bfoo, bbar);
436      KeyValue<byte[], byte[]> bresult = jedis.brpop(3.12, bfoo);
437      assertNotNull(bresult);
438      assertArrayEquals(bfoo, bresult.getKey());
439      assertArrayEquals(bbar, bresult.getValue());
440      bresult = jedis.brpop(0.11, bfoo, bfoo1);
441      assertNull(bresult);
442      jedis.lpush(bfoo, bbar);
443      jedis.lpush(bfoo1, bcar);
444      bresult = jedis.brpop(1d, bfoo, bfoo1);
445      assertNotNull(bresult);
446      assertArrayEquals(bfoo, bresult.getKey());
447      assertArrayEquals(bbar, bresult.getValue());
448    }
449    @Test
450    public void brpopDoubleWithSleep() {
451      long startMillis, totalMillis;
452      startMillis = System.currentTimeMillis();
453      KeyValue<String, String> result = jedis.brpop(0.04, "foo");
454      totalMillis = System.currentTimeMillis() - startMillis;
455      assertTrue("TotalMillis=" + totalMillis, totalMillis < 200);
456      assertNull(result);
457      startMillis = System.currentTimeMillis();
458      new Thread(() -> {
459        try {
460          Thread.sleep(30);
461        } catch(InterruptedException e) {
462          logger.error("", e);
463        }
464        try (Jedis j = createJedis()) {
465          j.lpush("foo", "bar");
466        }
467      }).start();
468      result = jedis.brpop(1.2, "foo");
469      totalMillis = System.currentTimeMillis() - startMillis;
470      assertTrue("TotalMillis=" + totalMillis, totalMillis < 200);
471      assertNotNull(result);
472      assertEquals("foo", result.getKey());
473      assertEquals("bar", result.getValue());
474    }
475    @Test
476    public void lpushx() {
477      assertEquals(0, jedis.lpushx("foo", "bar"));
478      jedis.lpush("foo", "a");
479      assertEquals(2, jedis.lpushx("foo", "b"));
480      assertEquals(0, jedis.lpushx(bfoo, bbar));
481      jedis.lpush(bfoo, bA);
482      assertEquals(2, jedis.lpushx(bfoo, bB));
483    }
484    @Test
485    public void rpushx() {
486      assertEquals(0, jedis.rpushx("foo", "bar"));
487      jedis.lpush("foo", "a");
488      assertEquals(2, jedis.rpushx("foo", "b"));
489      assertEquals(0, jedis.rpushx(bfoo, bbar));
490      jedis.lpush(bfoo, bA);
491      assertEquals(2, jedis.rpushx(bfoo, bB));
492    }
493    @Test
494    public void linsert() {
495      assertEquals(0, jedis.linsert("foo", ListPosition.BEFORE, "bar", "car"));
496      jedis.lpush("foo", "a");
497      assertEquals(2, jedis.linsert("foo", ListPosition.AFTER, "a", "b"));
498      List<String> expected = new ArrayList<String>();
499      expected.add("a");
500      expected.add("b");
501      assertEquals(expected, jedis.lrange("foo", 0, 100));
502      assertEquals(-1, jedis.linsert("foo", ListPosition.BEFORE, "bar", "car"));
503      assertEquals(0, jedis.linsert(bfoo, ListPosition.BEFORE, bbar, bcar));
504      jedis.lpush(bfoo, bA);
505      assertEquals(2, jedis.linsert(bfoo, ListPosition.AFTER, bA, bB));
506      List<byte[]> bexpected = new ArrayList<byte[]>();
507      bexpected.add(bA);
508      bexpected.add(bB);
509      assertByteArrayListEquals(bexpected, jedis.lrange(bfoo, 0, 100));
510      assertEquals(-1, jedis.linsert(bfoo, ListPosition.BEFORE, bbar, bcar));
511    }
512    @Test
513    public void brpoplpush() {
514      new Thread(new Runnable() {
515        @Override
516        public void run() {
517          try {
518            Thread.sleep(100);
519          } catch (InterruptedException e) {
520            logger.error("", e);
521          }
522          try (Jedis j = createJedis()) {
523            j.lpush("foo", "a");
524          }
525        }
526      }).start();
527      String element = jedis.brpoplpush("foo", "bar", 0);
528      assertEquals("a", element);
529      assertEquals(1, jedis.llen("bar"));
530      assertEquals("a", jedis.lrange("bar", 0, -1).get(0));
531      new Thread(new Runnable() {
532        @Override
533        public void run() {
534          try {
535            Thread.sleep(100);
536          } catch (InterruptedException e) {
537            logger.error("", e);
538          }
539          try (Jedis j = createJedis()) {
540            j.lpush(bfoo, bA);
541          }
542        }
543      }).start();
544      byte[] belement = jedis.brpoplpush(bfoo, bbar, 0);
545      assertArrayEquals(bA, belement);
546      assertEquals(1, jedis.llen("bar"));
547      assertArrayEquals(bA, jedis.lrange(bbar, 0, -1).get(0));
548    }
549    @Test
550    public void lpos() {
551      jedis.rpush("foo", "a");
552      jedis.rpush("foo", "b");
553      jedis.rpush("foo", "c");
554      Long pos = jedis.lpos("foo", "b");
555      assertEquals(1, pos.intValue());
556      pos = jedis.lpos("foo", "d");
557      assertNull(pos);
558      jedis.rpush("foo", "a");
559      jedis.rpush("foo", "b");
560      jedis.rpush("foo", "b");
561      pos = jedis.lpos("foo", "b", LPosParams.lPosParams());
562      assertEquals(1, pos.intValue());
563      pos = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(3));
564      assertEquals(5, pos.intValue());
565      pos = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(-2));
566      assertEquals(4, pos.intValue());
567      pos = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(-5));
568      assertNull(pos);
569      pos = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(1).maxlen(2));
570      assertEquals(1, pos.intValue());
571      pos = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(2).maxlen(2));
572      assertNull(pos);
573      pos = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(-2).maxlen(2));
574      assertEquals(4, pos.intValue());
575      List<Long> expected = new ArrayList<Long>();
576      expected.add(1L);
577      expected.add(4L);
578      expected.add(5L);
579      List<Long> posList = jedis.lpos("foo", "b", LPosParams.lPosParams(), 2);
580      assertEquals(expected.subList(0, 2), posList);
581      posList = jedis.lpos("foo", "b", LPosParams.lPosParams(), 0);
582      assertEquals(expected, posList);
583      posList = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(2), 0);
584      assertEquals(expected.subList(1, 3), posList);
585      posList = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(2).maxlen(5), 0);
586      assertEquals(expected.subList(1, 2), posList);
587      Collections.reverse(expected);
588      posList = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(-2), 0);
589      assertEquals(expected.subList(1, 3), posList);
590      posList = jedis.lpos("foo", "b", LPosParams.lPosParams().rank(-1).maxlen(5), 2);
591      assertEquals(expected.subList(0, 2), posList);
592      jedis.rpush(bfoo, bA);
593      jedis.rpush(bfoo, bB);
594      jedis.rpush(bfoo, bC);
595      pos = jedis.lpos(bfoo, bB);
596      assertEquals(1, pos.intValue());
597      pos = jedis.lpos(bfoo, b3);
598      assertNull(pos);
599      jedis.rpush(bfoo, bA);
600      jedis.rpush(bfoo, bB);
601      jedis.rpush(bfoo, bA);
602      pos = jedis.lpos(bfoo, bB, LPosParams.lPosParams().rank(2));
603      assertEquals(4, pos.intValue());
604      pos = jedis.lpos(bfoo, bB, LPosParams.lPosParams().rank(-2).maxlen(5));
605      assertEquals(1, pos.intValue());
606      expected.clear();
607      expected.add(0L);
608      expected.add(3L);
609      expected.add(5L);
610      posList = jedis.lpos(bfoo, bA, LPosParams.lPosParams().maxlen(6), 0);
611      assertEquals(expected, posList);
612      posList = jedis.lpos(bfoo, bA, LPosParams.lPosParams().maxlen(6).rank(2), 1);
613      assertEquals(expected.subList(1, 2), posList);
614    }
615    @Test
616    public void lmove() {
617      jedis.rpush("foo", "bar1", "bar2", "bar3");
618      assertEquals("bar3", jedis.lmove("foo", "bar", ListDirection.RIGHT, ListDirection.LEFT));
619      assertEquals(Collections.singletonList("bar3"), jedis.lrange("bar", 0, -1));
620      assertEquals(Arrays.asList("bar1", "bar2"), jedis.lrange("foo", 0, -1));
621      jedis.rpush(bfoo, b1, b2, b3);
622      assertArrayEquals(b3, jedis.lmove(bfoo, bbar, ListDirection.RIGHT, ListDirection.LEFT));
623      assertByteArrayListEquals(Collections.singletonList(b3), jedis.lrange(bbar, 0, -1));
624      assertByteArrayListEquals(Arrays.asList(b1, b2), jedis.lrange(bfoo, 0, -1));
625    }
626    @Test
627    public void blmove() {
628      new Thread(() -> {
629        try {
630          Thread.sleep(100);
631        } catch (InterruptedException e) {
632          logger.error("", e);
633        }
634        try (Jedis j = createJedis()) {
635          j.rpush("foo", "bar1", "bar2", "bar3");
636        }
637      }).start();
638      assertEquals("bar3", jedis.blmove("foo", "bar", ListDirection.RIGHT, ListDirection.LEFT, 0));
639      assertEquals(Collections.singletonList("bar3"), jedis.lrange("bar", 0, -1));
640      assertEquals(Arrays.asList("bar1", "bar2"), jedis.lrange("foo", 0, -1));
641      new Thread(() -> {
642        try {
643          Thread.sleep(100);
644        } catch (InterruptedException e) {
645          logger.error("", e);
646        }
647        try (Jedis j = createJedis()) {
648          j.rpush(bfoo, b1, b2, b3);
649        }
650      }).start();
651      assertArrayEquals(b3, jedis.blmove(bfoo, bbar, ListDirection.RIGHT, ListDirection.LEFT, 0));
652      assertByteArrayListEquals(Collections.singletonList(b3), jedis.lrange(bbar, 0, -1));
653      assertByteArrayListEquals(Arrays.asList(b1, b2), jedis.lrange(bfoo, 0, -1));
654    }
655    @Test
656    public void lmpop() {
657      String mylist1 = "mylist1";
658      String mylist2 = "mylist2";
659      jedis.lpush(mylist1, "one", "two", "three", "four", "five");
660      jedis.lpush(mylist2, "one", "two", "three", "four", "five");
661      KeyValue<String, List<String>> elements = jedis.lmpop(ListDirection.LEFT, mylist1, mylist2);
662      assertEquals(mylist1, elements.getKey());
663      assertEquals(1, elements.getValue().size());
664      elements = jedis.lmpop(ListDirection.LEFT, 5, mylist1, mylist2);
665      assertEquals(mylist1, elements.getKey());
666      assertEquals(4, elements.getValue().size());
667      elements = jedis.lmpop(ListDirection.RIGHT, 100, mylist1, mylist2);
668      assertEquals(mylist2, elements.getKey());
669      assertEquals(5, elements.getValue().size());
670      elements = jedis.lmpop(ListDirection.RIGHT, mylist1, mylist2);
671      assertNull(elements);
672    }
673    @Test
674    public void blmpopSimple() {
675      String mylist1 = "mylist1";
676      String mylist2 = "mylist2";
677      jedis.lpush(mylist1, "one", "two", "three", "four", "five");
678      jedis.lpush(mylist2, "one", "two", "three", "four", "five");
679      KeyValue<String, List<String>> elements = jedis.blmpop(1L, ListDirection.LEFT, mylist1, mylist2);
680      assertEquals(mylist1, elements.getKey());
681      assertEquals(1, elements.getValue().size());
682      elements = jedis.blmpop(1L, ListDirection.LEFT, 5, mylist1, mylist2);
683      assertEquals(mylist1, elements.getKey());
684      assertEquals(4, elements.getValue().size());
685      elements = jedis.blmpop(1L, ListDirection.RIGHT, 100, mylist1, mylist2);
686      assertEquals(mylist2, elements.getKey());
687      assertEquals(5, elements.getValue().size());
688      elements = jedis.blmpop(1L, ListDirection.RIGHT, mylist1, mylist2);
689      assertNull(elements);
690    }
691  }
</code></pre>
        </div>
        <div class="column">
            <h3>jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-SortedSetCommandsTestBase.java</h3>
            <pre><code>1  package redis.clients.jedis.commands.unified;
2  import static java.util.Collections.singletonList;
3  import static org.junit.Assert.*;
4  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START;
5  import static redis.clients.jedis.params.ScanParams.SCAN_POINTER_START_BINARY;
6  import static redis.clients.jedis.util.AssertUtil.assertByteArrayListEquals;
7  import java.util.*;
8  import org.junit.Test;
9  import redis.clients.jedis.args.SortedSetOption;
10  import redis.clients.jedis.params.*;
11  import redis.clients.jedis.resps.ScanResult;
12  import redis.clients.jedis.resps.Tuple;
13  import redis.clients.jedis.util.AssertUtil;
14  import redis.clients.jedis.util.KeyValue;
15  import redis.clients.jedis.util.SafeEncoder;
16  public abstract class SortedSetCommandsTestBase extends UnifiedJedisCommandsTestBase {
17    final byte[] bfoo = { 0x01, 0x02, 0x03, 0x04 };
18    final byte[] bbar = { 0x05, 0x06, 0x07, 0x08 };
19    final byte[] bcar = { 0x09, 0x0A, 0x0B, 0x0C };
20    final byte[] ba = { 0x0A };
21    final byte[] bb = { 0x0B };
22    final byte[] bc = { 0x0C };
23    final byte[] bInclusiveB = { 0x5B, 0x0B };
24    final byte[] bExclusiveC = { 0x28, 0x0C };
25    final byte[] bLexMinusInf = { 0x2D };
26    final byte[] bLexPlusInf = { 0x2B };
27    final byte[] bbar1 = { 0x05, 0x06, 0x07, 0x08, 0x0A };
28    final byte[] bbar2 = { 0x05, 0x06, 0x07, 0x08, 0x0B };
29    final byte[] bbar3 = { 0x05, 0x06, 0x07, 0x08, 0x0C };
30    final byte[] bbarstar = { 0x05, 0x06, 0x07, 0x08, '*' };
31    @Test
32    public void zadd() {
33      assertEquals(1, jedis.zadd("foo", 1d, "a"));
34      assertEquals(1, jedis.zadd("foo", 10d, "b"));
35      assertEquals(1, jedis.zadd("foo", 0.1d, "c"));
36      assertEquals(0, jedis.zadd("foo", 2d, "a"));
37      assertEquals(1, jedis.zadd(bfoo, 1d, ba));
38      assertEquals(1, jedis.zadd(bfoo, 10d, bb));
39      assertEquals(1, jedis.zadd(bfoo, 0.1d, bc));
40      assertEquals(0, jedis.zadd(bfoo, 2d, ba));
41    }
42    @Test
43    public void zaddWithParams() {
44      jedis.del("foo");
45      assertEquals(0L, jedis.zadd("foo", 1d, "a", ZAddParams.zAddParams().xx()));
46      jedis.zadd("foo", 1d, "a");
47      assertEquals(0L, jedis.zadd("foo", 2d, "a", ZAddParams.zAddParams().nx()));
48      assertEquals(Double.valueOf(1d), jedis.zscore("foo", "a"));
49      Map<String, Double> scoreMembers = new HashMap<String, Double>();
50      scoreMembers.put("a", 2d);
51      scoreMembers.put("b", 1d);
52      assertEquals(2L, jedis.zadd("foo", scoreMembers, ZAddParams.zAddParams().ch()));
53      jedis.zadd("foo", 3d, "a", ZAddParams.zAddParams().lt());
54      assertEquals(Double.valueOf(2d), jedis.zscore("foo", "a"));
55      jedis.zadd("foo", 1d, "a", ZAddParams.zAddParams().lt());
56      assertEquals(Double.valueOf(1d), jedis.zscore("foo", "a"));
57      jedis.zadd("foo", 0d, "b", ZAddParams.zAddParams().gt());
58      assertEquals(Double.valueOf(1d), jedis.zscore("foo", "b"));
59      jedis.zadd("foo", 2d, "b", ZAddParams.zAddParams().gt());
60      assertEquals(Double.valueOf(2d), jedis.zscore("foo", "b"));
61      assertNull(jedis.zaddIncr("foo", 1d, "b", ZAddParams.zAddParams().nx()));
62      assertEquals(Double.valueOf(2d), jedis.zscore("foo", "b"));
63      assertEquals(Double.valueOf(3d), jedis.zaddIncr("foo", 1d,"b", ZAddParams.zAddParams().xx()));
64      assertEquals(Double.valueOf(3d), jedis.zscore("foo", "b"));
65      jedis.del(bfoo);
66      assertEquals(0L, jedis.zadd(bfoo, 1d, ba, ZAddParams.zAddParams().xx()));
67      jedis.zadd(bfoo, 1d, ba);
68      assertEquals(0L, jedis.zadd(bfoo, 2d, ba, ZAddParams.zAddParams().nx()));
69      assertEquals(Double.valueOf(1d), jedis.zscore(bfoo, ba));
70      Map<byte[], Double> binaryScoreMembers = new HashMap<byte[], Double>();
71      binaryScoreMembers.put(ba, 2d);
72      binaryScoreMembers.put(bb, 1d);
73      assertEquals(2L, jedis.zadd(bfoo, binaryScoreMembers, ZAddParams.zAddParams().ch()));
74      jedis.zadd(bfoo, 3d, ba, ZAddParams.zAddParams().lt());
75      assertEquals(Double.valueOf(2d), jedis.zscore(bfoo, ba));
76      jedis.zadd(bfoo, 1d, ba, ZAddParams.zAddParams().lt());
77      assertEquals(Double.valueOf(1d), jedis.zscore(bfoo, ba));
78      jedis.zadd(bfoo, 0d, bb, ZAddParams.zAddParams().gt());
79      assertEquals(Double.valueOf(1d), jedis.zscore(bfoo, bb));
80      jedis.zadd(bfoo, 2d, bb, ZAddParams.zAddParams().gt());
81      assertEquals(Double.valueOf(2d), jedis.zscore(bfoo, bb));
82      assertNull(jedis.zaddIncr(bfoo, 1d, bb, ZAddParams.zAddParams().nx()));
83      assertEquals(Double.valueOf(2d), jedis.zscore(bfoo, bb));
84      assertEquals(Double.valueOf(3d), jedis.zaddIncr(bfoo, 1d, bb, ZAddParams.zAddParams().xx()));
85      assertEquals(Double.valueOf(3d), jedis.zscore(bfoo, bb));
86    }
87    @Test
88    public void zrange() {
89      jedis.zadd("foo", 1d, "a");
90      jedis.zadd("foo", 10d, "b");
91      jedis.zadd("foo", 0.1d, "c");
92      jedis.zadd("foo", 2d, "a");
93      List<String> expected = new ArrayList<String>();
94      expected.add("c");
95      expected.add("a");
96      List<String> range = jedis.zrange("foo", 0, 1);
97      assertEquals(expected, range);
98      expected.add("b");
99      range = jedis.zrange("foo", 0, 100);
100      assertEquals(expected, range);
101      jedis.zadd(bfoo, 1d, ba);
102      jedis.zadd(bfoo, 10d, bb);
103      jedis.zadd(bfoo, 0.1d, bc);
104      jedis.zadd(bfoo, 2d, ba);
105      List<byte[]> bexpected = new ArrayList<byte[]>();
106      bexpected.add(bc);
107      bexpected.add(ba);
108      List<byte[]> brange = jedis.zrange(bfoo, 0, 1);
109      assertByteArrayListEquals(bexpected, brange);
110      bexpected.add(bb);
111      brange = jedis.zrange(bfoo, 0, 100);
112      assertByteArrayListEquals(bexpected, brange);
113    }
114    @Test
115    public void zrangeByLex() {
116      jedis.zadd("foo", 1, "aa");
117      jedis.zadd("foo", 1, "c");
118      jedis.zadd("foo", 1, "bb");
119      jedis.zadd("foo", 1, "d");
120      List<String> expected = new ArrayList<String>();
121      expected.add("bb");
122      expected.add("c");
123      assertEquals(expected, jedis.zrangeByLex("foo", "(aa", "[c"));
124      expected.clear();
125      expected.add("bb");
126      expected.add("c");
127      assertEquals(expected, jedis.zrangeByLex("foo", "-", "+", 1, 2));
128    }
129    @Test
130    public void zrangeByLexBinary() {
131      jedis.zadd(bfoo, 1, ba);
132      jedis.zadd(bfoo, 1, bc);
133      jedis.zadd(bfoo, 1, bb);
134      List<byte[]> bExpected = new ArrayList<byte[]>();
135      bExpected.add(bb);
136      assertByteArrayListEquals(bExpected, jedis.zrangeByLex(bfoo, bInclusiveB, bExclusiveC));
137      bExpected.clear();
138      bExpected.add(ba);
139      bExpected.add(bb);
140      assertByteArrayListEquals(bExpected, jedis.zrangeByLex(bfoo, bLexMinusInf, bLexPlusInf, 0, 2));
141    }
142    @Test
143    public void zrevrangeByLex() {
144      jedis.zadd("foo", 1, "aa");
145      jedis.zadd("foo", 1, "c");
146      jedis.zadd("foo", 1, "bb");
147      jedis.zadd("foo", 1, "d");
148      List<String> expected = new ArrayList<String>();
149      expected.add("c");
150      expected.add("bb");
151      assertEquals(expected, jedis.zrevrangeByLex("foo", "[c", "(aa"));
152      expected.clear();
153      expected.add("c");
154      expected.add("bb");
155      assertEquals(expected, jedis.zrevrangeByLex("foo", "+", "-", 1, 2));
156    }
157    @Test
158    public void zrevrangeByLexBinary() {
159      jedis.zadd(bfoo, 1, ba);
160      jedis.zadd(bfoo, 1, bc);
161      jedis.zadd(bfoo, 1, bb);
162      List<byte[]> bExpected = new ArrayList<byte[]>();
163      bExpected.add(bb);
164      assertByteArrayListEquals(bExpected, jedis.zrevrangeByLex(bfoo, bExclusiveC, bInclusiveB));
165      bExpected.clear();
166      bExpected.add(bc);
167      bExpected.add(bb);
168      assertByteArrayListEquals(bExpected, jedis.zrevrangeByLex(bfoo, bLexPlusInf, bLexMinusInf, 0, 2));
169    }
170    @Test
171    public void zrevrange() {
172      jedis.zadd("foo", 1d, "a");
173      jedis.zadd("foo", 10d, "b");
174      jedis.zadd("foo", 0.1d, "c");
175      jedis.zadd("foo", 2d, "a");
176      List<String> expected = new ArrayList<String>();
177      expected.add("b");
178      expected.add("a");
179      List<String> range = jedis.zrevrange("foo", 0, 1);
180      assertEquals(expected, range);
181      expected.add("c");
182      range = jedis.zrevrange("foo", 0, 100);
183      assertEquals(expected, range);
184      jedis.zadd(bfoo, 1d, ba);
185      jedis.zadd(bfoo, 10d, bb);
186      jedis.zadd(bfoo, 0.1d, bc);
187      jedis.zadd(bfoo, 2d, ba);
188      List<byte[]> bexpected = new ArrayList<byte[]>();
189      bexpected.add(bb);
190      bexpected.add(ba);
191      List<byte[]> brange = jedis.zrevrange(bfoo, 0, 1);
192      assertByteArrayListEquals(bexpected, brange);
193      bexpected.add(bc);
194      brange = jedis.zrevrange(bfoo, 0, 100);
195      assertByteArrayListEquals(bexpected, brange);
196    }
197    @Test
198    public void zrangeParams() {
199      jedis.zadd("foo", 1, "aa");
200      jedis.zadd("foo", 1, "c");
201      jedis.zadd("foo", 1, "bb");
202      jedis.zadd("foo", 1, "d");
203      List<String> expected = new ArrayList<String>();
204      expected.add("c");
205      expected.add("bb");
206      assertEquals(expected, jedis.zrange("foo", ZRangeParams.zrangeByLexParams("[c", "(aa").rev()));
207      assertNotNull(jedis.zrangeWithScores("foo", ZRangeParams.zrangeByScoreParams(0, 1)));
208      jedis.zadd(bfoo, 1, ba);
209      jedis.zadd(bfoo, 1, bc);
210      jedis.zadd(bfoo, 1, bb);
211      List<byte[]> bExpected = new ArrayList<byte[]>();
212      bExpected.add(bb);
213      assertByteArrayListEquals(bExpected, jedis.zrange(bfoo, ZRangeParams.zrangeByLexParams(bExclusiveC, bInclusiveB).rev()));
214      assertNotNull(jedis.zrangeWithScores(bfoo, ZRangeParams.zrangeByScoreParams(0, 1).limit(0, 3)));
215    }
216    @Test
217    public void zrangestore() {
218      jedis.zadd("foo", 1, "aa");
219      jedis.zadd("foo", 2, "c");
220      jedis.zadd("foo", 3, "bb");
221      long stored = jedis.zrangestore("bar", "foo", ZRangeParams.zrangeByScoreParams(1, 2));
222      assertEquals(2, stored);
223      List<String> range = jedis.zrange("bar", 0, -1);
224      List<String> expected = new ArrayList<>();
225      expected.add("aa");
226      expected.add("c");
227      assertEquals(expected, range);
228      jedis.zadd(bfoo, 1d, ba);
229      jedis.zadd(bfoo, 10d, bb);
230      jedis.zadd(bfoo, 0.1d, bc);
231      jedis.zadd(bfoo, 2d, ba);
232      long bstored = jedis.zrangestore(bbar, bfoo, ZRangeParams.zrangeParams(0, 1).rev());
233      assertEquals(2, bstored);
234      List<byte[]> brange = jedis.zrevrange(bbar, 0, 1);
235      List<byte[]> bexpected = new ArrayList<>();
236      bexpected.add(bb);
237      bexpected.add(ba);
238      assertByteArrayListEquals(bexpected, brange);
239    }
240    @Test
241    public void zrem() {
242      jedis.zadd("foo", 1d, "a");
243      jedis.zadd("foo", 2d, "b");
244      assertEquals(1, jedis.zrem("foo", "a"));
245      List<String> expected = new ArrayList<String>();
246      expected.add("b");
247      assertEquals(expected, jedis.zrange("foo", 0, 100));
248      assertEquals(0, jedis.zrem("foo", "bar"));
249      jedis.zadd(bfoo, 1d, ba);
250      jedis.zadd(bfoo, 2d, bb);
251      assertEquals(1, jedis.zrem(bfoo, ba));
252      List<byte[]> bexpected = new ArrayList<byte[]>();
253      bexpected.add(bb);
254      assertByteArrayListEquals(bexpected, jedis.zrange(bfoo, 0, 100));
255      assertEquals(0, jedis.zrem(bfoo, bbar));
256    }
257    @Test
258    public void zincrby() {
259      jedis.zadd("foo", 1d, "a");
260      jedis.zadd("foo", 2d, "b");
261      assertEquals(3d, jedis.zincrby("foo", 2d, "a"), 0);
262      List<String> expected = new ArrayList<String>();
263      expected.add("b");
264      expected.add("a");
265      assertEquals(expected, jedis.zrange("foo", 0, 100));
266      jedis.zadd(bfoo, 1d, ba);
267      jedis.zadd(bfoo, 2d, bb);
268      assertEquals(3d, jedis.zincrby(bfoo, 2d, ba), 0);
269      List<byte[]> bexpected = new ArrayList<byte[]>();
270      bexpected.add(bb);
271      bexpected.add(ba);
272      assertByteArrayListEquals(bexpected, jedis.zrange(bfoo, 0, 100));
273    }
274    @Test
275    public void zincrbyWithParams() {
276      jedis.del("foo");
277      assertNull(jedis.zincrby("foo", 2d, "a", ZIncrByParams.zIncrByParams().xx()));
278      jedis.zadd("foo", 2d, "a");
279      assertNull(jedis.zincrby("foo", 1d, "a", ZIncrByParams.zIncrByParams().nx()));
280      assertEquals(Double.valueOf(2d), jedis.zscore("foo", "a"));
281      jedis.del(bfoo);
282      assertNull(jedis.zincrby(bfoo, 2d, ba, ZIncrByParams.zIncrByParams().xx()));
283      jedis.zadd(bfoo, 2d, ba);
284      assertNull(jedis.zincrby(bfoo, 1d, ba, ZIncrByParams.zIncrByParams().nx()));
285      assertEquals(Double.valueOf(2d), jedis.zscore(bfoo, ba));
286    }
287    @Test
288    public void zrank() {
289      jedis.zadd("foo", 1d, "a");
290      jedis.zadd("foo", 2d, "b");
291      long rank = jedis.zrank("foo", "a");
292      assertEquals(0, rank);
293      rank = jedis.zrank("foo", "b");
294      assertEquals(1, rank);
295      assertNull(jedis.zrank("car", "b"));
296      jedis.zadd(bfoo, 1d, ba);
297      jedis.zadd(bfoo, 2d, bb);
298      long brank = jedis.zrank(bfoo, ba);
299      assertEquals(0, brank);
300      brank = jedis.zrank(bfoo, bb);
301      assertEquals(1, brank);
302      assertNull(jedis.zrank(bcar, bb));
303    }
304    @Test
305    public void zrankWithScore() {
306      jedis.zadd("foo", 1d, "a");
307      jedis.zadd("foo", 2d, "b");
308      KeyValue<Long, Double> keyValue = jedis.zrankWithScore("foo", "a");
309      assertEquals(Long.valueOf(0), keyValue.getKey());
310      assertEquals(Double.valueOf(1d), keyValue.getValue());
311      keyValue = jedis.zrankWithScore("foo", "b");
312      assertEquals(Long.valueOf(1), keyValue.getKey());
313      assertEquals(Double.valueOf(2d), keyValue.getValue());
314      assertNull(jedis.zrankWithScore("car", "b"));
315      jedis.zadd(bfoo, 1d, ba);
316      jedis.zadd(bfoo, 2d, bb);
317      keyValue = jedis.zrankWithScore(bfoo, ba);
318      assertEquals(Long.valueOf(0), keyValue.getKey());
319      assertEquals(Double.valueOf(1d), keyValue.getValue());
320      keyValue = jedis.zrankWithScore(bfoo, bb);
321      assertEquals(Long.valueOf(1), keyValue.getKey());
322      assertEquals(Double.valueOf(2d), keyValue.getValue());
323      assertNull(jedis.zrankWithScore(bcar, bb));
324    }
325    @Test
326    public void zrevrank() {
327      jedis.zadd("foo", 1d, "a");
328      jedis.zadd("foo", 2d, "b");
329      long rank = jedis.zrevrank("foo", "a");
330      assertEquals(1, rank);
331      rank = jedis.zrevrank("foo", "b");
332      assertEquals(0, rank);
333      jedis.zadd(bfoo, 1d, ba);
334      jedis.zadd(bfoo, 2d, bb);
335      long brank = jedis.zrevrank(bfoo, ba);
336      assertEquals(1, brank);
337      brank = jedis.zrevrank(bfoo, bb);
338      assertEquals(0, brank);
339    }
340    @Test
341    public void zrangeWithScores() {
342      jedis.zadd("foo", 1d, "a");
343      jedis.zadd("foo", 10d, "b");
344      jedis.zadd("foo", 0.1d, "c");
345      jedis.zadd("foo", 2d, "a");
346      List<Tuple> expected = new ArrayList<Tuple>();
347      expected.add(new Tuple("c", 0.1d));
348      expected.add(new Tuple("a", 2d));
349      List<Tuple> range = jedis.zrangeWithScores("foo", 0, 1);
350      assertEquals(expected, range);
351      expected.add(new Tuple("b", 10d));
352      range = jedis.zrangeWithScores("foo", 0, 100);
353      assertEquals(expected, range);
354      jedis.zadd(bfoo, 1d, ba);
355      jedis.zadd(bfoo, 10d, bb);
356      jedis.zadd(bfoo, 0.1d, bc);
357      jedis.zadd(bfoo, 2d, ba);
358      List<Tuple> bexpected = new ArrayList<Tuple>();
359      bexpected.add(new Tuple(bc, 0.1d));
360      bexpected.add(new Tuple(ba, 2d));
361      List<Tuple> brange = jedis.zrangeWithScores(bfoo, 0, 1);
362      assertEquals(bexpected, brange);
363      bexpected.add(new Tuple(bb, 10d));
364      brange = jedis.zrangeWithScores(bfoo, 0, 100);
365      assertEquals(bexpected, brange);
366    }
367    @Test
368    public void zrevrangeWithScores() {
369      jedis.zadd("foo", 1d, "a");
370      jedis.zadd("foo", 10d, "b");
371      jedis.zadd("foo", 0.1d, "c");
372      jedis.zadd("foo", 2d, "a");
373      List<Tuple> expected = new ArrayList<Tuple>();
374      expected.add(new Tuple("b", 10d));
375      expected.add(new Tuple("a", 2d));
376      List<Tuple> range = jedis.zrevrangeWithScores("foo", 0, 1);
377      assertEquals(expected, range);
378      expected.add(new Tuple("c", 0.1d));
379      range = jedis.zrevrangeWithScores("foo", 0, 100);
380      assertEquals(expected, range);
381      jedis.zadd(bfoo, 1d, ba);
382      jedis.zadd(bfoo, 10d, bb);
383      jedis.zadd(bfoo, 0.1d, bc);
384      jedis.zadd(bfoo, 2d, ba);
385      List<Tuple> bexpected = new ArrayList<Tuple>();
386      bexpected.add(new Tuple(bb, 10d));
387      bexpected.add(new Tuple(ba, 2d));
388      List<Tuple> brange = jedis.zrevrangeWithScores(bfoo, 0, 1);
389      assertEquals(bexpected, brange);
390      bexpected.add(new Tuple(bc, 0.1d));
391      brange = jedis.zrevrangeWithScores(bfoo, 0, 100);
392      assertEquals(bexpected, brange);
393    }
394    @Test
395    public void zcard() {
396      jedis.zadd("foo", 1d, "a");
397      jedis.zadd("foo", 10d, "b");
398      jedis.zadd("foo", 0.1d, "c");
399      jedis.zadd("foo", 2d, "a");
400      assertEquals(3, jedis.zcard("foo"));
401      jedis.zadd(bfoo, 1d, ba);
402      jedis.zadd(bfoo, 10d, bb);
403      jedis.zadd(bfoo, 0.1d, bc);
404      jedis.zadd(bfoo, 2d, ba);
405      assertEquals(3, jedis.zcard(bfoo));
406    }
407    @Test
408    public void zscore() {
409      jedis.zadd("foo", 1d, "a");
410      jedis.zadd("foo", 10d, "b");
411      jedis.zadd("foo", 0.1d, "c");
412      jedis.zadd("foo", 2d, "a");
413      assertEquals((Double) 10d, jedis.zscore("foo", "b"));
414      assertEquals((Double) 0.1d, jedis.zscore("foo", "c"));
415      assertNull(jedis.zscore("foo", "s"));
416      jedis.zadd(bfoo, 1d, ba);
417      jedis.zadd(bfoo, 10d, bb);
418      jedis.zadd(bfoo, 0.1d, bc);
419      jedis.zadd(bfoo, 2d, ba);
420      assertEquals((Double) 10d, jedis.zscore(bfoo, bb));
421      assertEquals((Double) 0.1d, jedis.zscore(bfoo, bc));
422      assertNull(jedis.zscore(bfoo, SafeEncoder.encode("s")));
423    }
424    @Test
425    public void zmscore() {
426      jedis.zadd("foo", 1d, "a");
427      jedis.zadd("foo", 10d, "b");
428      jedis.zadd("foo", 0.1d, "c");
429      jedis.zadd("foo", 2d, "a");
430      assertEquals(Arrays.asList(10d, 0.1d, null), jedis.zmscore("foo", "b", "c", "s"));
431      jedis.zadd(bfoo, 1d, ba);
432      jedis.zadd(bfoo, 10d, bb);
433      jedis.zadd(bfoo, 0.1d, bc);
434      jedis.zadd(bfoo, 2d, ba);
435      assertEquals(Arrays.asList(10d, 0.1d, null),
436        jedis.zmscore(bfoo, bb, bc, SafeEncoder.encode("s")));
437    }
438    @Test
439    public void zpopmax() {
440      jedis.zadd("foo", 1d, "a");
441      jedis.zadd("foo", 10d, "b");
442      jedis.zadd("foo", 0.1d, "c");
443      jedis.zadd("foo", 2d, "d");
444      Tuple actual = jedis.zpopmax("foo");
445      Tuple expected = new Tuple("b", 10d);
446      assertEquals(expected, actual);
447      actual = jedis.zpopmax("foo");
448      expected = new Tuple("d", 2d);
449      assertEquals(expected, actual);
450      actual = jedis.zpopmax("foo");
451      expected = new Tuple("a", 1d);
452      assertEquals(expected, actual);
453      actual = jedis.zpopmax("foo");
454      expected = new Tuple("c", 0.1d);
<span onclick='openModal()' class='match'>455      assertEquals(expected, actual);
456      actual = jedis.zpopmax("foo");
457      assertNull(actual);
458      jedis.zadd(bfoo, 1d, ba);
459      jedis.zadd(bfoo, 10d, bb);
460      jedis.zadd(bfoo, 0.1d, bc);
461      jedis.zadd(bfoo, 2d, ba);
462      actual = jedis.zpopmax(bfoo);
</span>463      expected = new Tuple(bb, 10d);
464      assertEquals(expected, actual);
465      actual = jedis.zpopmax(bfoo);
466      expected = new Tuple(ba, 2d);
467      assertEquals(expected, actual);
468      actual = jedis.zpopmax(bfoo);
469      expected = new Tuple(bc, 0.1d);
470      assertEquals(expected, actual);
471      actual = jedis.zpopmax(bfoo);
472      assertNull(actual);
473    }
474    @Test
475    public void zpopmaxWithCount() {
476      jedis.zadd("foo", 1d, "a");
477      jedis.zadd("foo", 10d, "b");
478      jedis.zadd("foo", 0.1d, "c");
479      jedis.zadd("foo", 2d, "d");
480      jedis.zadd("foo", 0.03, "e");
481      List<Tuple> actual = jedis.zpopmax("foo", 2);
482      assertEquals(2, actual.size());
483      List<Tuple> expected = new ArrayList<Tuple>();
484      expected.add(new Tuple("b", 10d));
485      expected.add(new Tuple("d", 2d));
486      assertEquals(expected, actual);
487      actual = jedis.zpopmax("foo", 3);
488      assertEquals(3, actual.size());
489      expected.clear();
490      expected.add(new Tuple("a", 1d));
491      expected.add(new Tuple("c", 0.1d));
492      expected.add(new Tuple("e", 0.03d));
493      assertEquals(expected, actual);
494      actual = jedis.zpopmax("foo", 1);
495      expected.clear();
496      assertEquals(expected, actual);
497      jedis.zadd(bfoo, 1d, ba);
498      jedis.zadd(bfoo, 10d, bb);
499      jedis.zadd(bfoo, 0.1d, bc);
500      jedis.zadd(bfoo, 2d, ba);
501      actual = jedis.zpopmax(bfoo, 1);
502      expected.clear();
503      expected.add(new Tuple(bb, 10d));
504      assertEquals(expected, actual);
505      actual = jedis.zpopmax(bfoo, 1);
506      expected.clear();
507      expected.add(new Tuple(ba, 2d));
508      assertEquals(expected, actual);
509      actual = jedis.zpopmax(bfoo, 1);
510      expected.clear();
511      expected.add(new Tuple(bc, 0.1d));
512      assertEquals(expected, actual);
513      actual = jedis.zpopmax(bfoo, 1);
514      expected.clear();
515      assertEquals(expected, actual);
516    }
517    @Test
518    public void zpopmin() {
519      jedis.zadd("foo", 1d, "a", ZAddParams.zAddParams().nx());
520      jedis.zadd("foo", 10d, "b", ZAddParams.zAddParams().nx());
521      jedis.zadd("foo", 0.1d, "c", ZAddParams.zAddParams().nx());
522      jedis.zadd("foo", 2d, "a", ZAddParams.zAddParams().nx());
523      List<Tuple> range = jedis.zpopmin("foo", 2);
524      List<Tuple> expected = new ArrayList<Tuple>();
525      expected.add(new Tuple("c", 0.1d));
526      expected.add(new Tuple("a", 1d));
527      assertEquals(expected, range);
528      assertEquals(new Tuple("b", 10d), jedis.zpopmin("foo"));
529      jedis.zadd(bfoo, 1d, ba);
530      jedis.zadd(bfoo, 10d, bb);
531      jedis.zadd(bfoo, 0.1d, bc);
532      jedis.zadd(bfoo, 2d, ba);
533      List<Tuple> brange = jedis.zpopmin(bfoo, 2);
534      List<Tuple> bexpected = new ArrayList<Tuple>();
535      bexpected.add(new Tuple(bc, 0.1d));
536      bexpected.add(new Tuple(ba, 2d));
537      assertEquals(bexpected, brange);
538      assertEquals(new Tuple(bb, 10d), jedis.zpopmin(bfoo));
539    }
540    @Test
541    public void zcount() {
542      jedis.zadd("foo", 1d, "a");
543      jedis.zadd("foo", 10d, "b");
544      jedis.zadd("foo", 0.1d, "c");
545      jedis.zadd("foo", 2d, "a");
546      assertEquals(2, jedis.zcount("foo", 0.01d, 2.1d));
547      assertEquals(3, jedis.zcount("foo", "(0.01", "+inf"));
548      jedis.zadd(bfoo, 1d, ba);
549      jedis.zadd(bfoo, 10d, bb);
550      jedis.zadd(bfoo, 0.1d, bc);
551      jedis.zadd(bfoo, 2d, ba);
552      assertEquals(2, jedis.zcount(bfoo, 0.01d, 2.1d));
553      assertEquals(3, jedis.zcount(bfoo, SafeEncoder.encode("(0.01"), SafeEncoder.encode("+inf")));
554    }
555    @Test
556    public void zlexcount() {
557      jedis.zadd("foo", 1, "a");
558      jedis.zadd("foo", 1, "b");
559      jedis.zadd("foo", 1, "c");
560      jedis.zadd("foo", 1, "aa");
561      assertEquals(2, jedis.zlexcount("foo", "[aa", "(c"));
562      assertEquals(4, jedis.zlexcount("foo", "-", "+"));
563      assertEquals(3, jedis.zlexcount("foo", "-", "(c"));
564      assertEquals(3, jedis.zlexcount("foo", "[aa", "+"));
565    }
566    @Test
567    public void zlexcountBinary() {
568      jedis.zadd(bfoo, 1, ba);
569      jedis.zadd(bfoo, 1, bc);
570      jedis.zadd(bfoo, 1, bb);
571      assertEquals(1, jedis.zlexcount(bfoo, bInclusiveB, bExclusiveC));
572      assertEquals(3, jedis.zlexcount(bfoo, bLexMinusInf, bLexPlusInf));
573    }
574    @Test
575    public void zrangebyscore() {
576      jedis.zadd("foo", 1d, "a");
577      jedis.zadd("foo", 10d, "b");
578      jedis.zadd("foo", 0.1d, "c");
579      jedis.zadd("foo", 2d, "a");
580      List<String> range = jedis.zrangeByScore("foo", 0d, 2d);
581      List<String> expected = new ArrayList<String>();
582      expected.add("c");
583      expected.add("a");
584      assertEquals(expected, range);
585      range = jedis.zrangeByScore("foo", 0d, 2d, 0, 1);
586      expected = new ArrayList<String>();
587      expected.add("c");
588      assertEquals(expected, range);
589      range = jedis.zrangeByScore("foo", 0d, 2d, 1, 1);
590      List<String> range2 = jedis.zrangeByScore("foo", "-inf", "(2");
591      assertEquals(expected, range2);
592      expected = new ArrayList<String>();
593      expected.add("a");
594      assertEquals(expected, range);
595      jedis.zadd(bfoo, 1d, ba);
596      jedis.zadd(bfoo, 10d, bb);
597      jedis.zadd(bfoo, 0.1d, bc);
598      jedis.zadd(bfoo, 2d, ba);
599      List<byte[]> brange = jedis.zrangeByScore(bfoo, 0d, 2d);
600      List<byte[]> bexpected = new ArrayList<byte[]>();
601      bexpected.add(bc);
602      bexpected.add(ba);
603      assertByteArrayListEquals(bexpected, brange);
604      brange = jedis.zrangeByScore(bfoo, 0d, 2d, 0, 1);
605      bexpected = new ArrayList<byte[]>();
606      bexpected.add(bc);
607      assertByteArrayListEquals(bexpected, brange);
608      brange = jedis.zrangeByScore(bfoo, 0d, 2d, 1, 1);
609      List<byte[]> brange2 = jedis.zrangeByScore(bfoo, SafeEncoder.encode("-inf"),
610        SafeEncoder.encode("(2"));
611      assertByteArrayListEquals(bexpected, brange2);
612      bexpected = new ArrayList<byte[]>();
613      bexpected.add(ba);
614      assertByteArrayListEquals(bexpected, brange);
615    }
616    @Test
617    public void zrevrangebyscore() {
618      jedis.zadd("foo", 1.0d, "a");
619      jedis.zadd("foo", 2.0d, "b");
620      jedis.zadd("foo", 3.0d, "c");
621      jedis.zadd("foo", 4.0d, "d");
622      jedis.zadd("foo", 5.0d, "e");
623      List<String> range = jedis.zrevrangeByScore("foo", 3d, Double.NEGATIVE_INFINITY, 0, 1);
624      List<String> expected = new ArrayList<String>();
625      expected.add("c");
626      assertEquals(expected, range);
627      range = jedis.zrevrangeByScore("foo", 3.5d, Double.NEGATIVE_INFINITY, 0, 2);
628      expected = new ArrayList<String>();
629      expected.add("c");
630      expected.add("b");
631      assertEquals(expected, range);
632      range = jedis.zrevrangeByScore("foo", 3.5d, Double.NEGATIVE_INFINITY, 1, 1);
633      expected = new ArrayList<String>();
634      expected.add("b");
635      assertEquals(expected, range);
636      range = jedis.zrevrangeByScore("foo", 4d, 2d);
637      expected = new ArrayList<String>();
638      expected.add("d");
639      expected.add("c");
640      expected.add("b");
641      assertEquals(expected, range);
642      range = jedis.zrevrangeByScore("foo", "4", "2", 0, 2);
643      expected = new ArrayList<String>();
644      expected.add("d");
645      expected.add("c");
646      assertEquals(expected, range);
647      range = jedis.zrevrangeByScore("foo", "+inf", "(4");
648      expected = new ArrayList<String>();
649      expected.add("e");
650      assertEquals(expected, range);
651      jedis.zadd(bfoo, 1d, ba);
652      jedis.zadd(bfoo, 10d, bb);
653      jedis.zadd(bfoo, 0.1d, bc);
654      jedis.zadd(bfoo, 2d, ba);
655      List<byte[]> brange = jedis.zrevrangeByScore(bfoo, 2d, 0d);
656      List<byte[]> bexpected = new ArrayList<byte[]>();
657      bexpected.add(ba);
658      bexpected.add(bc);
659      assertByteArrayListEquals(bexpected, brange);
660      brange = jedis.zrevrangeByScore(bfoo, 2d, 0d, 0, 1);
661      bexpected = new ArrayList<byte[]>();
662      bexpected.add(ba);
663      assertByteArrayListEquals(bexpected, brange);
664      List<byte[]> brange2 = jedis.zrevrangeByScore(bfoo, SafeEncoder.encode("+inf"),
665        SafeEncoder.encode("(2"));
666      bexpected = new ArrayList<byte[]>();
667      bexpected.add(bb);
668      assertByteArrayListEquals(bexpected, brange2);
669      brange = jedis.zrevrangeByScore(bfoo, 2d, 0d, 1, 1);
670      bexpected = new ArrayList<byte[]>();
671      bexpected.add(bc);
672      assertByteArrayListEquals(bexpected, brange);
673    }
674    @Test
675    public void zrangebyscoreWithScores() {
676      jedis.zadd("foo", 1d, "a");
677      jedis.zadd("foo", 10d, "b");
678      jedis.zadd("foo", 0.1d, "c");
679      jedis.zadd("foo", 2d, "a");
680      List<Tuple> range = jedis.zrangeByScoreWithScores("foo", 0d, 2d);
681      List<Tuple> expected = new ArrayList<Tuple>();
682      expected.add(new Tuple("c", 0.1d));
683      expected.add(new Tuple("a", 2d));
684      assertEquals(expected, range);
685      range = jedis.zrangeByScoreWithScores("foo", 0d, 2d, 0, 1);
686      expected = new ArrayList<Tuple>();
687      expected.add(new Tuple("c", 0.1d));
688      assertEquals(expected, range);
689      range = jedis.zrangeByScoreWithScores("foo", 0d, 2d, 1, 1);
690      expected = new ArrayList<Tuple>();
691      expected.add(new Tuple("a", 2d));
692      assertEquals(expected, range);
693      jedis.zadd(bfoo, 1d, ba);
694      jedis.zadd(bfoo, 10d, bb);
695      jedis.zadd(bfoo, 0.1d, bc);
696      jedis.zadd(bfoo, 2d, ba);
697      List<Tuple> brange = jedis.zrangeByScoreWithScores(bfoo, 0d, 2d);
698      List<Tuple> bexpected = new ArrayList<Tuple>();
699      bexpected.add(new Tuple(bc, 0.1d));
700      bexpected.add(new Tuple(ba, 2d));
701      assertEquals(bexpected, brange);
702      brange = jedis.zrangeByScoreWithScores(bfoo, 0d, 2d, 0, 1);
703      bexpected = new ArrayList<Tuple>();
704      bexpected.add(new Tuple(bc, 0.1d));
705      assertEquals(bexpected, brange);
706      brange = jedis.zrangeByScoreWithScores(bfoo, 0d, 2d, 1, 1);
707      bexpected = new ArrayList<Tuple>();
708      bexpected.add(new Tuple(ba, 2d));
709      assertEquals(bexpected, brange);
710    }
711    @Test
712    public void zrevrangebyscoreWithScores() {
713      jedis.zadd("foo", 1.0d, "a");
714      jedis.zadd("foo", 2.0d, "b");
715      jedis.zadd("foo", 3.0d, "c");
716      jedis.zadd("foo", 4.0d, "d");
717      jedis.zadd("foo", 5.0d, "e");
718      List<Tuple> range = jedis.zrevrangeByScoreWithScores("foo", 3d, Double.NEGATIVE_INFINITY, 0, 1);
719      List<Tuple> expected = new ArrayList<Tuple>();
720      expected.add(new Tuple("c", 3.0d));
721      assertEquals(expected, range);
722      range = jedis.zrevrangeByScoreWithScores("foo", 3.5d, Double.NEGATIVE_INFINITY, 0, 2);
723      expected = new ArrayList<Tuple>();
724      expected.add(new Tuple("c", 3.0d));
725      expected.add(new Tuple("b", 2.0d));
726      assertEquals(expected, range);
727      range = jedis.zrevrangeByScoreWithScores("foo", 3.5d, Double.NEGATIVE_INFINITY, 1, 1);
728      expected = new ArrayList<Tuple>();
729      expected.add(new Tuple("b", 2.0d));
730      assertEquals(expected, range);
731      range = jedis.zrevrangeByScoreWithScores("foo", 4d, 2d);
732      expected = new ArrayList<Tuple>();
733      expected.add(new Tuple("d", 4.0d));
734      expected.add(new Tuple("c", 3.0d));
735      expected.add(new Tuple("b", 2.0d));
736      assertEquals(expected, range);
737      jedis.zadd(bfoo, 1d, ba);
738      jedis.zadd(bfoo, 10d, bb);
739      jedis.zadd(bfoo, 0.1d, bc);
740      jedis.zadd(bfoo, 2d, ba);
741      List<Tuple> brange = jedis.zrevrangeByScoreWithScores(bfoo, 2d, 0d);
742      List<Tuple> bexpected = new ArrayList<Tuple>();
743      bexpected.add(new Tuple(ba, 2d));
744      bexpected.add(new Tuple(bc, 0.1d));
745      assertEquals(bexpected, brange);
746      brange = jedis.zrevrangeByScoreWithScores(bfoo, 2d, 0d, 0, 1);
747      bexpected = new ArrayList<Tuple>();
748      bexpected.add(new Tuple(ba, 2d));
749      assertEquals(bexpected, brange);
750      brange = jedis.zrevrangeByScoreWithScores(bfoo, 2d, 0d, 1, 1);
751      bexpected = new ArrayList<Tuple>();
752      bexpected.add(new Tuple(bc, 0.1d));
753      assertEquals(bexpected, brange);
754    }
755    @Test
756    public void zremrangeByRank() {
757      jedis.zadd("foo", 1d, "a");
758      jedis.zadd("foo", 10d, "b");
759      jedis.zadd("foo", 0.1d, "c");
760      jedis.zadd("foo", 2d, "a");
761      assertEquals(1, jedis.zremrangeByRank("foo", 0, 0));
762      List<String> expected = new ArrayList<String>();
763      expected.add("a");
764      expected.add("b");
765      assertEquals(expected, jedis.zrange("foo", 0, 100));
766      jedis.zadd(bfoo, 1d, ba);
767      jedis.zadd(bfoo, 10d, bb);
768      jedis.zadd(bfoo, 0.1d, bc);
769      jedis.zadd(bfoo, 2d, ba);
770      assertEquals(1, jedis.zremrangeByRank(bfoo, 0, 0));
771      List<byte[]> bexpected = new ArrayList<byte[]>();
772      bexpected.add(ba);
773      bexpected.add(bb);
774      assertByteArrayListEquals(bexpected, jedis.zrange(bfoo, 0, 100));
775    }
776    @Test
777    public void zremrangeByScore() {
778      jedis.zadd("foo", 1d, "a");
779      jedis.zadd("foo", 10d, "b");
780      jedis.zadd("foo", 0.1d, "c");
781      jedis.zadd("foo", 2d, "a");
782      assertEquals(2, jedis.zremrangeByScore("foo", 0, 2));
783      List<String> expected = new ArrayList<String>();
784      expected.add("b");
785      assertEquals(expected, jedis.zrange("foo", 0, 100));
786      jedis.zadd(bfoo, 1d, ba);
787      jedis.zadd(bfoo, 10d, bb);
788      jedis.zadd(bfoo, 0.1d, bc);
789      jedis.zadd(bfoo, 2d, ba);
790      assertEquals(2, jedis.zremrangeByScore(bfoo, 0, 2));
791      List<byte[]> bexpected = new ArrayList<byte[]>();
792      bexpected.add(bb);
793      assertByteArrayListEquals(bexpected, jedis.zrange(bfoo, 0, 100));
794    }
795    @Test
796    public void zremrangeByScoreExclusive() {
797      jedis.zadd("foo", 1d, "a");
798      jedis.zadd("foo", 0d, "c");
799      jedis.zadd("foo", 2d, "b");
800      assertEquals(1, jedis.zremrangeByScore("foo", "(0", "(2"));
801      jedis.zadd(bfoo, 1d, ba);
802      jedis.zadd(bfoo, 0d, bc);
803      jedis.zadd(bfoo, 2d, bb);
804      assertEquals(1, jedis.zremrangeByScore(bfoo, "(0".getBytes(), "(2".getBytes()));
805    }
806    @Test
807    public void zremrangeByLex() {
808      jedis.zadd("foo", 1, "a");
809      jedis.zadd("foo", 1, "b");
810      jedis.zadd("foo", 1, "c");
811      jedis.zadd("foo", 1, "aa");
812      assertEquals(2, jedis.zremrangeByLex("foo", "[aa", "(c"));
813      List<String> expected = new ArrayList<String>();
814      expected.add("a");
815      expected.add("c");
816      assertEquals(expected, jedis.zrangeByLex("foo", "-", "+"));
817    }
818    @Test
819    public void zremrangeByLexBinary() {
820      jedis.zadd(bfoo, 1, ba);
821      jedis.zadd(bfoo, 1, bc);
822      jedis.zadd(bfoo, 1, bb);
823      assertEquals(1, jedis.zremrangeByLex(bfoo, bInclusiveB, bExclusiveC));
824      List<byte[]> bexpected = new ArrayList<byte[]>();
825      bexpected.add(ba);
826      bexpected.add(bc);
827      assertByteArrayListEquals(bexpected, jedis.zrangeByLex(bfoo, bLexMinusInf, bLexPlusInf));
828    }
829    @Test
830    public void zunion() {
831      jedis.zadd("foo", 1, "a");
832      jedis.zadd("foo", 2, "b");
833      jedis.zadd("bar", 2, "a");
834      jedis.zadd("bar", 2, "b");
835      ZParams params = new ZParams();
836      params.weights(2, 2.5);
837      params.aggregate(ZParams.Aggregate.SUM);
838      List<String> expected = new ArrayList<>();
839      expected.add("a");
840      expected.add("b");
841      assertEquals(expected, jedis.zunion(params, "foo", "bar"));
842      List<Tuple> expectedTuple = new ArrayList<>();
843      expectedTuple.add(new Tuple("a", new Double(7)));
844      expectedTuple.add(new Tuple("b", new Double(9)));
845      assertEquals(expectedTuple, jedis.zunionWithScores(params, "foo", "bar"));
846      jedis.zadd(bfoo, 1, ba);
847      jedis.zadd(bfoo, 2, bb);
848      jedis.zadd(bbar, 2, ba);
849      jedis.zadd(bbar, 2, bb);
850      List<byte[]> bexpected = new ArrayList<>();
851      bexpected.add(ba);
852      bexpected.add(bb);
853      AssertUtil.assertByteArrayListEquals(bexpected, jedis.zunion(params, bfoo, bbar));
854      List<Tuple> bexpectedTuple = new ArrayList<>();
855      bexpectedTuple.add(new Tuple(ba, new Double(7)));
856      bexpectedTuple.add(new Tuple(bb, new Double(9)));
857      assertEquals(bexpectedTuple, jedis.zunionWithScores(params, bfoo, bbar));
858    }
859    @Test
860    public void zunionstore() {
861      jedis.zadd("foo", 1, "a");
862      jedis.zadd("foo", 2, "b");
863      jedis.zadd("bar", 2, "a");
864      jedis.zadd("bar", 2, "b");
865      assertEquals(2, jedis.zunionstore("dst", "foo", "bar"));
866      List<Tuple> expected = new ArrayList<Tuple>();
867      expected.add(new Tuple("a", new Double(3)));
868      expected.add(new Tuple("b", new Double(4)));
869      assertEquals(expected, jedis.zrangeWithScores("dst", 0, 100));
870      jedis.zadd(bfoo, 1, ba);
871      jedis.zadd(bfoo, 2, bb);
872      jedis.zadd(bbar, 2, ba);
873      jedis.zadd(bbar, 2, bb);
874      assertEquals(2, jedis.zunionstore(SafeEncoder.encode("dst"), bfoo, bbar));
875      List<Tuple> bexpected = new ArrayList<Tuple>();
876      bexpected.add(new Tuple(ba, new Double(3)));
877      bexpected.add(new Tuple(bb, new Double(4)));
878      assertEquals(bexpected, jedis.zrangeWithScores(SafeEncoder.encode("dst"), 0, 100));
879    }
880    @Test
881    public void zunionstoreParams() {
882      jedis.zadd("foo", 1, "a");
883      jedis.zadd("foo", 2, "b");
884      jedis.zadd("bar", 2, "a");
885      jedis.zadd("bar", 2, "b");
886      ZParams params = new ZParams();
887      params.weights(2, 2.5);
888      params.aggregate(ZParams.Aggregate.SUM);
889      assertEquals(2, jedis.zunionstore("dst", params, "foo", "bar"));
890      List<Tuple> expected = new ArrayList<Tuple>();
891      expected.add(new Tuple("a", new Double(7)));
892      expected.add(new Tuple("b", new Double(9)));
893      assertEquals(expected, jedis.zrangeWithScores("dst", 0, 100));
894      jedis.zadd(bfoo, 1, ba);
895      jedis.zadd(bfoo, 2, bb);
896      jedis.zadd(bbar, 2, ba);
897      jedis.zadd(bbar, 2, bb);
898      ZParams bparams = new ZParams();
899      bparams.weights(2, 2.5);
900      bparams.aggregate(ZParams.Aggregate.SUM);
901      assertEquals(2, jedis.zunionstore(SafeEncoder.encode("dst"), bparams, bfoo, bbar));
902      List<Tuple> bexpected = new ArrayList<Tuple>();
903      bexpected.add(new Tuple(ba, new Double(7)));
904      bexpected.add(new Tuple(bb, new Double(9)));
905      assertEquals(bexpected, jedis.zrangeWithScores(SafeEncoder.encode("dst"), 0, 100));
906    }
907    @Test
908    public void zinter() {
909      jedis.zadd("foo", 1, "a");
910      jedis.zadd("foo", 2, "b");
911      jedis.zadd("bar", 2, "a");
912      ZParams params = new ZParams();
913      params.weights(2, 2.5);
914      params.aggregate(ZParams.Aggregate.SUM);
915      assertEquals(singletonList("a"), jedis.zinter(params, "foo", "bar"));
916      assertEquals(singletonList(new Tuple("a", new Double(7))),
917        jedis.zinterWithScores(params, "foo", "bar"));
918      jedis.zadd(bfoo, 1, ba);
919      jedis.zadd(bfoo, 2, bb);
920      jedis.zadd(bbar, 2, ba);
921      ZParams bparams = new ZParams();
922      bparams.weights(2, 2.5);
923      bparams.aggregate(ZParams.Aggregate.SUM);
924      AssertUtil.assertByteArrayListEquals(singletonList(ba), jedis.zinter(params, bfoo, bbar));
925      assertEquals(singletonList(new Tuple(ba, new Double(7))),
926        jedis.zinterWithScores(bparams, bfoo, bbar));
927    }
928    @Test
929    public void zinterstore() {
930      jedis.zadd("foo", 1, "a");
931      jedis.zadd("foo", 2, "b");
932      jedis.zadd("bar", 2, "a");
933      assertEquals(1, jedis.zinterstore("dst", "foo", "bar"));
934      assertEquals(singletonList(new Tuple("a", new Double(3))),
935          jedis.zrangeWithScores("dst", 0, 100));
936      jedis.zadd(bfoo, 1, ba);
937      jedis.zadd(bfoo, 2, bb);
938      jedis.zadd(bbar, 2, ba);
939      assertEquals(1, jedis.zinterstore(SafeEncoder.encode("dst"), bfoo, bbar));
940      assertEquals(singletonList(new Tuple(ba, new Double(3))),
941          jedis.zrangeWithScores(SafeEncoder.encode("dst"), 0, 100));
942    }
943    @Test
944    public void zintertoreParams() {
945      jedis.zadd("foo", 1, "a");
946      jedis.zadd("foo", 2, "b");
947      jedis.zadd("bar", 2, "a");
948      ZParams params = new ZParams();
949      params.weights(2, 2.5);
950      params.aggregate(ZParams.Aggregate.SUM);
951      assertEquals(1, jedis.zinterstore("dst", params, "foo", "bar"));
952      assertEquals(singletonList(new Tuple("a", new Double(7))),
953          jedis.zrangeWithScores("dst", 0, 100));
954      jedis.zadd(bfoo, 1, ba);
955      jedis.zadd(bfoo, 2, bb);
956      jedis.zadd(bbar, 2, ba);
957      ZParams bparams = new ZParams();
958      bparams.weights(2, 2.5);
959      bparams.aggregate(ZParams.Aggregate.SUM);
960      assertEquals(1, jedis.zinterstore(SafeEncoder.encode("dst"), bparams, bfoo, bbar));
961      assertEquals(singletonList(new Tuple(ba, new Double(7))),
962          jedis.zrangeWithScores(SafeEncoder.encode("dst"), 0, 100));
963    }
964    @Test
965    public void zintercard() {
966      jedis.zadd("foo", 1, "a");
967      jedis.zadd("foo", 2, "b");
968      jedis.zadd("bar", 2, "a");
969      jedis.zadd("bar", 1, "b");
970      assertEquals(2, jedis.zintercard("foo", "bar"));
971      assertEquals(1, jedis.zintercard(1, "foo", "bar"));
972      jedis.zadd(bfoo, 1, ba);
973      jedis.zadd(bfoo, 2, bb);
974      jedis.zadd(bbar, 2, ba);
975      jedis.zadd(bbar, 2, bb);
976      assertEquals(2, jedis.zintercard(bfoo, bbar));
977      assertEquals(1, jedis.zintercard(1, bfoo, bbar));
978    }
979    @Test
980    public void zscan() {
981      jedis.zadd("foo", 1, "a");
982      jedis.zadd("foo", 2, "b");
983      ScanResult<Tuple> result = jedis.zscan("foo", SCAN_POINTER_START);
984      assertEquals(SCAN_POINTER_START, result.getCursor());
985      assertFalse(result.getResult().isEmpty());
986      jedis.zadd(bfoo, 1, ba);
987      jedis.zadd(bfoo, 1, bb);
988      ScanResult<Tuple> bResult = jedis.zscan(bfoo, SCAN_POINTER_START_BINARY);
989      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
990      assertFalse(bResult.getResult().isEmpty());
991    }
992    @Test
993    public void zscanMatch() {
994      ScanParams params = new ScanParams();
995      params.match("a*");
996      jedis.zadd("foo", 2, "b");
997      jedis.zadd("foo", 1, "a");
998      jedis.zadd("foo", 11, "aa");
999      ScanResult<Tuple> result = jedis.zscan("foo", SCAN_POINTER_START, params);
1000      assertEquals(SCAN_POINTER_START, result.getCursor());
1001      assertFalse(result.getResult().isEmpty());
1002      params = new ScanParams();
1003      params.match(bbarstar);
1004      jedis.zadd(bfoo, 2, bbar1);
1005      jedis.zadd(bfoo, 1, bbar2);
1006      jedis.zadd(bfoo, 11, bbar3);
1007      ScanResult<Tuple> bResult = jedis.zscan(bfoo, SCAN_POINTER_START_BINARY, params);
1008      assertArrayEquals(SCAN_POINTER_START_BINARY, bResult.getCursorAsBytes());
1009      assertFalse(bResult.getResult().isEmpty());
1010    }
1011    @Test
1012    public void zscanCount() {
1013      ScanParams params = new ScanParams();
1014      params.count(2);
1015      jedis.zadd("foo", 1, "a1");
1016      jedis.zadd("foo", 2, "a2");
1017      jedis.zadd("foo", 3, "a3");
1018      jedis.zadd("foo", 4, "a4");
1019      jedis.zadd("foo", 5, "a5");
1020      ScanResult<Tuple> result = jedis.zscan("foo", SCAN_POINTER_START, params);
1021      assertFalse(result.getResult().isEmpty());
1022      params = new ScanParams();
1023      params.count(2);
1024      jedis.zadd(bfoo, 2, bbar1);
1025      jedis.zadd(bfoo, 1, bbar2);
1026      jedis.zadd(bfoo, 11, bbar3);
1027      ScanResult<Tuple> bResult = jedis.zscan(bfoo, SCAN_POINTER_START_BINARY, params);
1028      assertFalse(bResult.getResult().isEmpty());
1029    }
1030    @Test
1031    public void infinity() {
1032      jedis.zadd("key", Double.POSITIVE_INFINITY, "pos");
1033      assertEquals(Double.POSITIVE_INFINITY, jedis.zscore("key", "pos"), 0d);
1034      jedis.zadd("key", Double.NEGATIVE_INFINITY, "neg");
1035      assertEquals(Double.NEGATIVE_INFINITY, jedis.zscore("key", "neg"), 0d);
1036      jedis.zadd("key", 0d, "zero");
1037      List<Tuple> set = jedis.zrangeWithScores("key", 0, -1);
1038      Iterator<Tuple> itr = set.iterator();
1039      assertEquals(Double.NEGATIVE_INFINITY, itr.next().getScore(), 0d);
1040      assertEquals(0d, itr.next().getScore(), 0d);
1041      assertEquals(Double.POSITIVE_INFINITY, itr.next().getScore(), 0d);
1042    }
1043    @Test
1044    public void bzpopmax() {
1045      jedis.zadd("foo", 1d, "a", ZAddParams.zAddParams().nx());
1046      jedis.zadd("foo", 10d, "b", ZAddParams.zAddParams().nx());
1047      jedis.zadd("bar", 0.1d, "c", ZAddParams.zAddParams().nx());
1048      assertEquals(new KeyValue<>("foo", new Tuple("b", 10d)), jedis.bzpopmax(0, "foo", "bar"));
1049      jedis.zadd(bfoo, 1d, ba);
1050      jedis.zadd(bfoo, 10d, bb);
1051      jedis.zadd(bbar, 0.1d, bc);
1052      KeyValue<byte[], Tuple> actual = jedis.bzpopmax(0, bfoo, bbar);
1053      assertArrayEquals(bfoo, actual.getKey());
1054      assertEquals(new Tuple(bb, 10d), actual.getValue());
1055    }
1056    @Test
1057    public void bzpopmin() {
1058      jedis.zadd("foo", 1d, "a", ZAddParams.zAddParams().nx());
1059      jedis.zadd("foo", 10d, "b", ZAddParams.zAddParams().nx());
1060      jedis.zadd("bar", 0.1d, "c", ZAddParams.zAddParams().nx());
1061      assertEquals(new KeyValue<>("bar", new Tuple("c", 0.1)), jedis.bzpopmin(0, "bar", "foo"));
1062      jedis.zadd(bfoo, 1d, ba);
1063      jedis.zadd(bfoo, 10d, bb);
1064      jedis.zadd(bbar, 0.1d, bc);
1065      KeyValue<byte[], Tuple> actual = jedis.bzpopmin(0, bbar, bfoo);
1066      assertArrayEquals(bbar, (byte[]) actual.getKey());
1067      assertEquals(new Tuple(bc, 0.1), actual.getValue());
1068    }
1069    @Test
1070    public void zdiff() {
1071      jedis.zadd("foo", 1.0, "a");
1072      jedis.zadd("foo", 2.0, "b");
1073      jedis.zadd("bar", 1.0, "a");
1074      assertEquals(0, jedis.zdiff("bar1", "bar2").size());
1075      assertEquals(singletonList("b"), jedis.zdiff("foo", "bar"));
1076      assertEquals(singletonList(new Tuple("b", 2.0d)), jedis.zdiffWithScores("foo", "bar"));
1077      jedis.zadd(bfoo, 1.0, ba);
1078      jedis.zadd(bfoo, 2.0, bb);
1079      jedis.zadd(bbar, 1.0, ba);
1080      assertEquals(0, jedis.zdiff(bbar1, bbar2).size());
1081      List<byte[]> bactual = jedis.zdiff(bfoo, bbar);
1082      assertEquals(1, bactual.size());
1083      assertArrayEquals(bb, bactual.iterator().next());
1084      assertEquals(singletonList(new Tuple(bb, 2.0d)), jedis.zdiffWithScores(bfoo, bbar));
1085    }
1086    @Test
1087    public void zdiffstore() {
1088      jedis.zadd("foo", 1.0, "a");
1089      jedis.zadd("foo", 2.0, "b");
1090      jedis.zadd("bar", 1.0, "a");
1091      assertEquals(0, jedis.zdiffstore("bar3", "bar1", "bar2"));
1092      assertEquals(1, jedis.zdiffstore("bar3", "foo", "bar"));
1093      assertEquals(singletonList("b"), jedis.zrange("bar3", 0, -1));
1094      jedis.zadd(bfoo, 1.0, ba);
1095      jedis.zadd(bfoo, 2.0, bb);
1096      jedis.zadd(bbar, 1.0, ba);
1097      assertEquals(0, jedis.zdiffstore(bbar3, bbar1, bbar2));
1098      assertEquals(1, jedis.zdiffstore(bbar3, bfoo, bbar));
1099      List<byte[]> bactual = jedis.zrange(bbar3, 0, -1);
1100      assertArrayEquals(bb, bactual.iterator().next());
1101    }
1102    @Test
1103    public void zrandmember() {
1104      assertNull(jedis.zrandmember("foo"));
1105      assertEquals(Collections.emptyList(), jedis.zrandmember("foo", 1));
1106      assertEquals(Collections.emptyList(), jedis.zrandmemberWithScores("foo", 1));
1107      Map<String, Double> hash = new HashMap<>();
1108      hash.put("bar1", 1d);
1109      hash.put("bar2", 10d);
1110      hash.put("bar3", 0.1d);
1111      jedis.zadd("foo", hash);
1112      AssertUtil.assertCollectionContains(hash.keySet(), jedis.zrandmember("foo"));
1113      assertEquals(2, jedis.zrandmember("foo", 2).size());
1114      List<Tuple> actual = jedis.zrandmemberWithScores("foo", 2);
1115      assertEquals(2, actual.size());
1116      actual.forEach(t -> assertEquals(hash.get(t.getElement()), t.getScore(), 0d));
1117      assertNull(jedis.zrandmember(bfoo));
1118      assertEquals(Collections.emptyList(), jedis.zrandmember(bfoo, 1));
1119      assertEquals(Collections.emptyList(), jedis.zrandmemberWithScores(bfoo, 1));
1120      Map<byte[], Double> bhash = new HashMap<>();
1121      bhash.put(bbar1, 1d);
1122      bhash.put(bbar2, 10d);
1123      bhash.put(bbar3, 0.1d);
1124      jedis.zadd(bfoo, bhash);
1125      AssertUtil.assertByteArrayCollectionContains(bhash.keySet(), jedis.zrandmember(bfoo));
1126      assertEquals(2, jedis.zrandmember(bfoo, 2).size());
1127      List<Tuple> bactual = jedis.zrandmemberWithScores(bfoo, 2);
1128      assertEquals(2, bactual.size());
1129      bactual.forEach(t -> assertEquals(getScoreFromByteMap(bhash, t.getBinaryElement()), t.getScore(), 0d));
1130    }
1131    private Double getScoreFromByteMap(Map<byte[], Double> bhash, byte[] key) {
1132      for (Map.Entry<byte[], Double> en : bhash.entrySet()) {
1133        if (Arrays.equals(en.getKey(), key)) {
1134          return en.getValue();
1135        }
1136      }
1137      return null;
1138    }
1139    @Test
1140    public void zmpop() {
1141      jedis.zadd("foo", 1d, "a", ZAddParams.zAddParams().nx());
1142      jedis.zadd("foo", 10d, "b", ZAddParams.zAddParams().nx());
1143      jedis.zadd("foo", 0.1d, "c", ZAddParams.zAddParams().nx());
1144      jedis.zadd("foo", 2d, "a", ZAddParams.zAddParams().nx());
1145      KeyValue<String, List<Tuple>> single = jedis.zmpop(SortedSetOption.MAX, "foo");
1146      KeyValue<String, List<Tuple>> range = jedis.zmpop(SortedSetOption.MIN, 2, "foo");
1147      assertEquals(new Tuple("b", 10d), single.getValue().get(0));
1148      assertEquals(2, range.getValue().size());
1149      assertNull(jedis.zmpop(SortedSetOption.MAX, "foo"));
1150    }
1151    @Test
1152    public void bzmpopSimple() {
1153      jedis.zadd("foo", 1d, "a", ZAddParams.zAddParams().nx());
1154      jedis.zadd("foo", 10d, "b", ZAddParams.zAddParams().nx());
1155      jedis.zadd("foo", 0.1d, "c", ZAddParams.zAddParams().nx());
1156      jedis.zadd("foo", 2d, "a", ZAddParams.zAddParams().nx());
1157      KeyValue<String, List<Tuple>> single = jedis.bzmpop(1L, SortedSetOption.MAX, "foo");
1158      KeyValue<String, List<Tuple>> range = jedis.bzmpop(1L, SortedSetOption.MIN, 2, "foo");
1159      assertEquals(new Tuple("b", 10d), single.getValue().get(0));
1160      assertEquals(2, range.getValue().size());
1161      assertNull(jedis.bzmpop(1L, SortedSetOption.MAX, "foo"));
1162    }
1163  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-ListCommandsTest.java</div>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from jedis-MDEwOlJlcG9zaXRvcnk3MTU2MDU=-flat-SortedSetCommandsTestBase.java</div>
                <div class="column column_space"><pre><code>330      jedis.lpush("foo", "bar");
331      result = jedis.blpop(3.2, "foo");
332      assertNotNull(result);
333      assertEquals("foo", result.getKey());
334      assertEquals("bar", result.getValue());
335      result = jedis.blpop(0.18, "foo", "foo1");
</pre></code></div>
                <div class="column column_space"><pre><code>455      assertEquals(expected, actual);
456      actual = jedis.zpopmax("foo");
457      assertNull(actual);
458      jedis.zadd(bfoo, 1d, ba);
459      jedis.zadd(bfoo, 10d, bb);
460      jedis.zadd(bfoo, 0.1d, bc);
461      jedis.zadd(bfoo, 2d, ba);
462      actual = jedis.zpopmax(bfoo);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    