<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for GroupingProjector.java &amp; SourceIndexWriterProjection.java</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for GroupingProjector.java &amp; SourceIndexWriterProjection.java
      </h3>
<h1 align="center">
        19.2%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>GroupingProjector.java (35.135136%)<th>SourceIndexWriterProjection.java (13.265306%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(26-46)<td><a href="#" name="0">(24-46)</a><td align="center"><font color="#ff0000">17</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(115-124)<td><a href="#" name="1">(131-140)</a><td align="center"><font color="#c30000">13</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(49-57)<td><a href="#" name="2">(47-56)</a><td align="center"><font color="#870000">9</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>GroupingProjector.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 package io.crate.execution.engine.aggregation;
2 <a name="0"></a>
3 import io.crate.breaker.RamAccounting;
4 import io.crate.data.BatchIterator;
5 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>import io.crate.data.CollectingBatchIterator;
6 import io.crate.data.Input;
7 import io.crate.data.Projector;
8 import io.crate.data.Row;
9 import io.crate.execution.engine.collect.CollectExpression;
10 import io.crate.expression.symbol.AggregateMode;
11 import io.crate.expression.symbol.Symbol;
12 import io.crate.memory.MemoryManager;
13 import io.crate.types.ArrayType;
14 import io.crate.types.DataType;
15 import io.crate.types.DataTypes;
16 import org.elasticsearch.Version;
17 import java.util.List;
18 import java.util.stream.Collector;
19 import static io.crate.expression.symbol.Symbols.typeView;
20 public class GroupingProjector implements Projector {
21 <a name="2"></a>    private final Collector&lt;Row, ?, Iterable&lt;Row&gt;&gt; collector</b></font>;
22     public GroupingProjector(<font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>List&lt;? extends Symbol&gt; keys,
23                              List&lt;Input&lt;?&gt;&gt; keyInputs,
24                              CollectExpression&lt;Row, ?&gt;[] collectExpressions,
25                              AggregateMode mode,
26                              AggregationContext[] aggregations,
27                              RamAccounting ramAccounting,
28                              MemoryManager memoryManager,
29                              Version minNodeVersion,
30                              Version indexVersionCreated</b></font>) {
31         assert keys.size() == keyInputs.size() : "number of key types must match with number of key inputs";
32         ensureAllTypesSupported(keys);
33         AggregationFunction[] functions = new AggregationFunction[aggregations.length];
34         Input[][] inputs = new Input[aggregations.length][];
35         Input&lt;Boolean&gt;[] filters = new Input[aggregations.length];
36         for (int i = 0; i &lt; aggregations.length; i++) {
37             AggregationContext aggregation = aggregations[i];
38             functions[i] = aggregation.function();
39             inputs[i] = aggregation.inputs();
40             filters[i] = aggregation.filter();
41         }
42         if (keys.size() == 1) {
43             Symbol key = keys.get(0);
44             collector = GroupingCollector.singleKey(
45                 collectExpressions,
46                 mode,
47                 functions,
48                 inputs,
49                 filters,
50                 ramAccounting,
51                 memoryManager,
52                 minNodeVersion,
53                 keyInputs.get(0),
54                 key.valueType(),
55                 indexVersionCreated
56             );
57         } else {
58             //noinspection unchecked
59             collector = (GroupingCollector&lt;Object&gt;) (GroupingCollector) GroupingCollector.manyKeys(
60                 collectExpressions,
61                 mode,
62                 functions,
63                 inputs,
64                 filters,
65                 ramAccounting,
66                 memoryManager,
67                 minNodeVersion,
68                 keyInputs,
69                 typeView(keys),
70                 indexVersionCreated
71             );
72         }
73     }
74     private static void ensureAllTypesSupported(Iterable&lt;? extends Symbol&gt; keys) {
75         for (Symbol key : keys) {
76             DataType type = key.valueType();
77             if (type instanceof ArrayType || type.equals(DataTypes.UNDEFINED)) {
78                 throw new UnsupportedOperationException("Cannot GROUP BY type: " + type);
79             }
80         }
81     }
82 <a name="1"></a>    @Override
83     public BatchIterator&lt;Row&gt; apply(BatchIterator&lt;Row&gt; batchIterator) {
84         return CollectingBatchIterator.newInstance(batchIterator, collector);
85     <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>}
86     public Collector&lt;Row, ?, Iterable&lt;Row&gt;&gt; getCollector() {
87         return collector;
88     }
89     @Override
90     public boolean providesIndependentScroll() {
91         return true;
92     }</b></font>
93 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>SourceIndexWriterProjection.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <a name="0"></a>
2 package io.crate.execution.dsl.projection;
3 <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>import io.crate.expression.symbol.InputColumn;
4 import io.crate.expression.symbol.Symbol;
5 import io.crate.expression.symbol.Symbols;
6 import io.crate.metadata.ColumnIdent;
7 import io.crate.metadata.Reference;
8 import io.crate.metadata.RelationName;
9 import org.elasticsearch.Version;
10 import org.elasticsearch.common.io.stream.StreamInput;
11 import org.elasticsearch.common.io.stream.StreamOutput;
12 import org.elasticsearch.common.settings.Settings;
13 import javax.annotation.Nullable;
14 import java.io.IOException;
15 import java.util.Arrays;
16 import java.util.List;
17 import java.util.Objects;
18 <a name="2"></a>public class SourceIndexWriterProjection extends AbstractIndexWriterProjection {
19     private static final String OVERWRITE_DUPLICATES = "overwrite_duplicates"</b></font>;
20     <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>private static final boolean OVERWRITE_DUPLICATES_DEFAULT = false;
21     private static final String FAIL_FAST = "fail_fast";
22     private static final String SOURCE_VALIDATION = "validation";
23     private final boolean failFast;
24     private final boolean validation;
25     private final Boolean overwriteDuplicates;
26     private final Reference rawSourceReference;
27     private final InputColumn rawSourceSymbol;
28     private final List&lt;? extends Symbol&gt; outputs</b></font>;
29     @Nullable
30     private String[] includes;
31     @Nullable
32     private String[] excludes;
33     public SourceIndexWriterProjection(RelationName relationName,
34                                        @Nullable String partitionIdent,
35                                        Reference rawSourceReference,
36                                        InputColumn rawSourcePtr,
37                                        List&lt;ColumnIdent&gt; primaryKeys,
38                                        List&lt;Symbol&gt; partitionedBySymbols,
39                                        @Nullable ColumnIdent clusteredByColumn,
40                                        Settings settings,
41                                        @Nullable String[] includes,
42                                        @Nullable String[] excludes,
43                                        List&lt;Symbol&gt; idSymbols,
44                                        @Nullable Symbol clusteredBySymbol,
45                                        List&lt;? extends Symbol&gt; outputs,
46                                        boolean autoCreateIndices) {
47         super(relationName, partitionIdent, primaryKeys, clusteredByColumn, settings, idSymbols, autoCreateIndices);
48         this.rawSourceReference = rawSourceReference;
49         this.includes = includes;
50         this.excludes = excludes;
51         this.partitionedBySymbols = partitionedBySymbols;
52         this.clusteredBySymbol = clusteredBySymbol;
53         this.rawSourceSymbol = rawSourcePtr;
54         this.outputs = outputs;
55         overwriteDuplicates = settings.getAsBoolean(OVERWRITE_DUPLICATES, OVERWRITE_DUPLICATES_DEFAULT);
56         this.failFast = settings.getAsBoolean(FAIL_FAST, false);
57         this.validation = settings.getAsBoolean(SOURCE_VALIDATION, true);
58     }
59     SourceIndexWriterProjection(StreamInput in) throws IOException {
60         super(in);
61         if (in.getVersion().onOrAfter(Version.V_4_7_0)) {
62             failFast = in.readBoolean();
63         } else {
64             failFast = false;
65         }
66         overwriteDuplicates = in.readBoolean();
67         rawSourceReference = Reference.fromStream(in);
68         rawSourceSymbol = (InputColumn) Symbols.fromStream(in);
69         if (in.readBoolean()) {
70             int length = in.readVInt();
71             includes = new String[length];
72             for (int i = 0; i &lt; length; i++) {
73                 includes[i] = in.readString();
74             }
75         }
76         if (in.readBoolean()) {
77             int length = in.readVInt();
78             excludes = new String[length];
79             for (int i = 0; i &lt; length; i++) {
80                 excludes[i] = in.readString();
81             }
82         }
83         outputs = Symbols.listFromStream(in);
84         if (in.getVersion().onOrAfter(Version.V_4_8_0)) {
85             validation = in.readBoolean();
86         } else {
87             validation = true;
88         }
89     }
90     @Override
91     public &lt;C, R&gt; R accept(ProjectionVisitor&lt;C, R&gt; visitor, C context) {
92         return visitor.visitSourceIndexWriterProjection(this, context);
93     }
94 <a name="1"></a>
95     public InputColumn rawSource() {
96         return rawSourceSymbol;
97     <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>}
98     public Reference rawSourceReference() {
99         return rawSourceReference;
100     }
101     @Nullable
102     public String[] includes() {
103         return includes;
104     }</b></font>
105     @Nullable
106     public String[] excludes() {
107         return excludes;
108     }
109     @Override
110     public ProjectionType projectionType() {
111         return ProjectionType.INDEX_WRITER;
112     }
113     @Override
114     public List&lt;? extends Symbol&gt; outputs() {
115         return outputs;
116     }
117     @Override
118     public boolean equals(Object o) {
119         if (this == o) return true;
120         if (o == null || getClass() != o.getClass()) return false;
121         if (!super.equals(o)) return false;
122         SourceIndexWriterProjection that = (SourceIndexWriterProjection) o;
123         return Objects.equals(overwriteDuplicates, that.overwriteDuplicates) &amp;&amp;
124                Objects.equals(rawSourceReference, that.rawSourceReference) &amp;&amp;
125                Objects.equals(rawSourceSymbol, that.rawSourceSymbol) &amp;&amp;
126                Arrays.equals(includes, that.includes) &amp;&amp;
127                Arrays.equals(excludes, that.excludes) &amp;&amp;
128                failFast == that.failFast &amp;&amp;
129                validation == that.validation;
130     }
131     @Override
132     public int hashCode() {
133         int result = Objects.hash(super.hashCode(),
134                                   overwriteDuplicates,
135                                   rawSourceReference,
136                                   rawSourceSymbol,
137                                   failFast,
138                                   validation);
139         result = 31 * result + Arrays.hashCode(includes);
140         result = 31 * result + Arrays.hashCode(excludes);
141         return result;
142     }
143     @Override
144     public void writeTo(StreamOutput out) throws IOException {
145         super.writeTo(out);
146         if (out.getVersion().onOrAfter(Version.V_4_7_0)) {
147             out.writeBoolean(failFast);
148         }
149         out.writeBoolean(overwriteDuplicates);
150         Reference.toStream(rawSourceReference, out);
151         Symbols.toStream(rawSourceSymbol, out);
152         if (includes == null) {
153             out.writeBoolean(false);
154         } else {
155             out.writeBoolean(true);
156             out.writeVInt(includes.length);
157             for (String include : includes) {
158                 out.writeString(include);
159             }
160         }
161         if (excludes == null) {
162             out.writeBoolean(false);
163         } else {
164             out.writeBoolean(true);
165             out.writeVInt(excludes.length);
166             for (String exclude : excludes) {
167                 out.writeString(exclude);
168             }
169         }
170         Symbols.toStream(outputs, out);
171         if (out.getVersion().onOrAfter(Version.V_4_8_0)) {
172             out.writeBoolean(validation);
173         }
174     }
175     public boolean overwriteDuplicates() {
176         return overwriteDuplicates;
177     }
178     public boolean failFast() {
179         return failFast;
180     }
181     public boolean validation() {
182         return validation;
183     }
184 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
