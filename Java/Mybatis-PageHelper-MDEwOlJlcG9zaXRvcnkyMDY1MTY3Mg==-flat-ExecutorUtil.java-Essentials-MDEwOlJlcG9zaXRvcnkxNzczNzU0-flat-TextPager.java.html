
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 6.741573033707865%, Tokens: 12</h2>
        <div class="column">
            <h3>Mybatis-PageHelper-MDEwOlJlcG9zaXRvcnkyMDY1MTY3Mg==-flat-ExecutorUtil.java</h3>
            <pre><code>1  package com.github.pagehelper.util;
2  import com.github.pagehelper.BoundSqlInterceptor;
3  import com.github.pagehelper.Dialect;
4  import com.github.pagehelper.PageException;
5  import org.apache.ibatis.builder.annotation.ProviderSqlSource;
6  import org.apache.ibatis.cache.CacheKey;
7  import org.apache.ibatis.executor.Executor;
8  import org.apache.ibatis.mapping.BoundSql;
9  import org.apache.ibatis.mapping.MappedStatement;
10  import org.apache.ibatis.session.Configuration;
11  import org.apache.ibatis.session.ResultHandler;
12  import org.apache.ibatis.session.RowBounds;
13  import java.lang.reflect.Field;
14  import java.sql.SQLException;
15  import java.util.List;
16  import java.util.Map;
17  public abstract class ExecutorUtil {
18      private static Field additionalParametersField;
19      private static Field providerMethodArgumentNamesField;
20      static {
21          try {
22              additionalParametersField = BoundSql.class.getDeclaredField("additionalParameters");
23              additionalParametersField.setAccessible(true);
24          } catch (NoSuchFieldException e) {
25              throw new PageException("获取 BoundSql 属性 additionalParameters 失败: " + e, e);
26          }
27          try {
28              providerMethodArgumentNamesField = ProviderSqlSource.class.getDeclaredField("providerMethodArgumentNames");
29              providerMethodArgumentNamesField.setAccessible(true);
30          } catch (NoSuchFieldException ignore) {
31          }
32      }
33      public static Map<String, Object> getAdditionalParameter(BoundSql boundSql) {
34          try {
35              return (Map<String, Object>) additionalParametersField.get(boundSql);
36          } catch (IllegalAccessException e) {
37              throw new PageException("获取 BoundSql 属性值 additionalParameters 失败: " + e, e);
38          }
39      }
40      public static String[] getProviderMethodArgumentNames(ProviderSqlSource providerSqlSource) {
41          try {
42              return providerMethodArgumentNamesField != null ? (String[]) providerMethodArgumentNamesField.get(providerSqlSource) : null;
43          } catch (IllegalAccessException e) {
44              throw new PageException("获取 ProviderSqlSource 属性值 providerMethodArgumentNames: " + e, e);
45          }
46      }
47      public static MappedStatement getExistedMappedStatement(Configuration configuration, String msId) {
48          MappedStatement mappedStatement = null;
49          try {
50              mappedStatement = configuration.getMappedStatement(msId, false);
51          } catch (Throwable t) {
52          }
53          return mappedStatement;
54      }
<span onclick='openModal()' class='match'>55      public static Long executeManualCount(Executor executor, MappedStatement countMs,
56                                            Object parameter, BoundSql boundSql,
57                                            ResultHandler resultHandler) throws SQLException {
58          CacheKey countKey = executor.createCacheKey(countMs, parameter, RowBounds.DEFAULT, boundSql);
59          BoundSql countBoundSql = countMs.getBoundSql(parameter);
60          Object countResultList = executor.query(countMs, parameter, RowBounds.DEFAULT, resultHandler, countKey, countBoundSql);
61          if (countResultList == null || ((List) countResultList).isEmpty()) {
</span>62              return 0L;
63          }
64          return ((Number) ((List) countResultList).get(0)).longValue();
65      }
66      public static Long executeAutoCount(Dialect dialect, Executor executor, MappedStatement countMs,
67                                          Object parameter, BoundSql boundSql,
68                                          RowBounds rowBounds, ResultHandler resultHandler) throws SQLException {
69          Map<String, Object> additionalParameters = getAdditionalParameter(boundSql);
70          CacheKey countKey = executor.createCacheKey(countMs, parameter, RowBounds.DEFAULT, boundSql);
71          String countSql = dialect.getCountSql(countMs, boundSql, parameter, rowBounds, countKey);
72          BoundSql countBoundSql = new BoundSql(countMs.getConfiguration(), countSql, boundSql.getParameterMappings(), parameter);
73          for (String key : additionalParameters.keySet()) {
74              countBoundSql.setAdditionalParameter(key, additionalParameters.get(key));
75          }
76          if (dialect instanceof BoundSqlInterceptor.Chain) {
77              countBoundSql = ((BoundSqlInterceptor.Chain) dialect).doBoundSql(BoundSqlInterceptor.Type.COUNT_SQL, countBoundSql, countKey);
78          }
79          Object countResultList = executor.query(countMs, parameter, RowBounds.DEFAULT, resultHandler, countKey, countBoundSql);
80          if (countResultList == null || ((List) countResultList).isEmpty()) {
81              return 0L;
82          }
83          return ((Number) ((List) countResultList).get(0)).longValue();
84      }
85      public static <E> List<E> pageQuery(Dialect dialect, Executor executor, MappedStatement ms, Object parameter,
86                                          RowBounds rowBounds, ResultHandler resultHandler,
87                                          BoundSql boundSql, CacheKey cacheKey) throws SQLException {
88          if (dialect.beforePage(ms, parameter, rowBounds)) {
89              CacheKey pageKey = cacheKey;
90              parameter = dialect.processParameterObject(ms, parameter, boundSql, pageKey);
91              String pageSql = dialect.getPageSql(ms, boundSql, parameter, rowBounds, pageKey);
92              BoundSql pageBoundSql = new BoundSql(ms.getConfiguration(), pageSql, boundSql.getParameterMappings(), parameter);
93              Map<String, Object> additionalParameters = getAdditionalParameter(boundSql);
94              for (String key : additionalParameters.keySet()) {
95                  pageBoundSql.setAdditionalParameter(key, additionalParameters.get(key));
96              }
97              if (dialect instanceof BoundSqlInterceptor.Chain) {
98                  pageBoundSql = ((BoundSqlInterceptor.Chain) dialect).doBoundSql(BoundSqlInterceptor.Type.PAGE_SQL, pageBoundSql, pageKey);
99              }
100              return executor.query(ms, parameter, RowBounds.DEFAULT, resultHandler, pageKey, pageBoundSql);
101          } else {
102              return executor.query(ms, parameter, RowBounds.DEFAULT, resultHandler, cacheKey, boundSql);
103          }
104      }
105  }
</code></pre>
        </div>
        <div class="column">
            <h3>Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-TextPager.java</h3>
            <pre><code>1  package com.earth2me.essentials.textreader;
2  import com.earth2me.essentials.CommandSource;
3  import com.earth2me.essentials.I18n;
4  import static com.earth2me.essentials.I18n.tl;
5  import java.util.List;
6  import java.util.Locale;
7  import java.util.Map;
8  public class TextPager
9  {
10  	private final transient IText text;
11  	private final transient boolean onePage;
12  	public TextPager(final IText text)
13  	{
14  		this(text, false);
15  	}
16  	public TextPager(final IText text, final boolean onePage)
17  	{
18  		this.text = text;
19  		this.onePage = onePage;
20  	}
<span onclick='openModal()' class='match'>21  	public void showPage(final String pageStr, final String chapterPageStr, final String commandName, final CommandSource sender)
22  	{
23  		List<String> lines = text.getLines();
24  		List<String> chapters = text.getChapters();
25  		Map<String, Integer> bookmarks = text.getBookmarks();
26  		if (pageStr == null || pageStr.isEmpty() || pageStr.matches("[0-9]+"))
</span>27  		{
28  			if (!lines.isEmpty() && lines.get(0).startsWith("#"))
29  			{
30  				if (onePage)
31  				{
32  					return;
33  				}
34  				sender.sendMessage(tl("infoChapter"));
35  				final StringBuilder sb = new StringBuilder();
36  				boolean first = true;
37  				for (String string : chapters)
38  				{
39  					if (!first)
40  					{
41  						sb.append(", ");
42  					}
43  					first = false;
44  					sb.append(string);
45  				}
46  				sender.sendMessage(sb.toString());
47  				return;
48  			}
49  			else
50  			{
51  				int page = 1;
52  				try
53  				{
54  					page = Integer.parseInt(pageStr);
55  				}
56  				catch (NumberFormatException ex)
57  				{
58  					page = 1;
59  				}
60  				if (page < 1)
61  				{
62  					page = 1;
63  				}
64  				int start = onePage ? 0 : (page - 1) * 9;
65  				int end;
66  				for (end = 0; end < lines.size(); end++)
67  				{
68  					String line = lines.get(end);
69  					if (line.startsWith("#"))
70  					{
71  						break;
72  					}
73  				}
74  				int pages = end / 9 + (end % 9 > 0 ? 1 : 0);
75  				if (!onePage && commandName != null)
76  				{
77  					StringBuilder content = new StringBuilder();
78  					final String[] title = commandName.split(" ", 2);
79  					if (title.length > 1)
80  					{
81  						content.append(I18n.capitalCase(title[0])).append(": ");
82  						content.append(title[1]);
83  					}
84  					else
85  					{
86  						content.append(I18n.capitalCase(commandName));
87  					}
88  					sender.sendMessage(tl("infoPages", page, pages, content));
89  				}
90  				for (int i = start; i < end && i < start + (onePage ? 20 : 9); i++)
91  				{
92  					sender.sendMessage("§r" + lines.get(i));
93  				}
94  				if (!onePage && page < pages && commandName != null)
95  				{
96  					sender.sendMessage(tl("readNextPage", commandName, page + 1));
97  				}
98  				return;
99  			}
100  		}
101  		int chapterpage = 0;
102  		if (chapterPageStr != null)
103  		{
104  			try
105  			{
106  				chapterpage = Integer.parseInt(chapterPageStr) - 1;
107  			}
108  			catch (NumberFormatException ex)
109  			{
110  				chapterpage = 0;
111  			}
112  			if (chapterpage < 0)
113  			{
114  				chapterpage = 0;
115  			}
116  		}
117  		if (!bookmarks.containsKey(pageStr.toLowerCase(Locale.ENGLISH)))
118  		{
119  			sender.sendMessage(tl("infoUnknownChapter"));
120  			return;
121  		}
122  		final int chapterstart = bookmarks.get(pageStr.toLowerCase(Locale.ENGLISH)) + 1;
123  		int chapterend;
124  		for (chapterend = chapterstart; chapterend < lines.size(); chapterend++)
125  		{
126  			final String line = lines.get(chapterend);
127  			if (line.length() > 0 && line.charAt(0) == '#')
128  			{
129  				break;
130  			}
131  		}
132  		final int start = chapterstart + (onePage ? 0 : chapterpage * 9);
133  		final int page = chapterpage + 1;
134  		final int pages = (chapterend - chapterstart) / 9 + ((chapterend - chapterstart) % 9 > 0 ? 1 : 0);
135  		if (!onePage && commandName != null)
136  		{
137  			StringBuilder content = new StringBuilder();
138  			content.append(I18n.capitalCase(commandName)).append(": ");
139  			content.append(pageStr);
140  			sender.sendMessage(tl("infoChapterPages", content, page, pages));
141  		}
142  		for (int i = start; i < chapterend && i < start + (onePage ? 20 : 9); i++)
143  		{
144  			sender.sendMessage("§r" + lines.get(i));
145  		}
146  		if (!onePage && page < pages && commandName != null)
147  		{
148  			sender.sendMessage(tl("readNextPage", commandName, pageStr + " " + (page + 1)));
149  		}
150  	}
151  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Mybatis-PageHelper-MDEwOlJlcG9zaXRvcnkyMDY1MTY3Mg==-flat-ExecutorUtil.java</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Essentials-MDEwOlJlcG9zaXRvcnkxNzczNzU0-flat-TextPager.java</div>
                </div>
                <div class="column column_space"><pre><code>55      public static Long executeManualCount(Executor executor, MappedStatement countMs,
56                                            Object parameter, BoundSql boundSql,
57                                            ResultHandler resultHandler) throws SQLException {
58          CacheKey countKey = executor.createCacheKey(countMs, parameter, RowBounds.DEFAULT, boundSql);
59          BoundSql countBoundSql = countMs.getBoundSql(parameter);
60          Object countResultList = executor.query(countMs, parameter, RowBounds.DEFAULT, resultHandler, countKey, countBoundSql);
61          if (countResultList == null || ((List) countResultList).isEmpty()) {
</pre></code></div>
                <div class="column column_space"><pre><code>21  	public void showPage(final String pageStr, final String chapterPageStr, final String commandName, final CommandSource sender)
22  	{
23  		List<String> lines = text.getLines();
24  		List<String> chapters = text.getChapters();
25  		Map<String, Integer> bookmarks = text.getBookmarks();
26  		if (pageStr == null || pageStr.isEmpty() || pageStr.matches("[0-9]+"))
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    