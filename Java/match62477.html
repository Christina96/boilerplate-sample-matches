<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for CompactLinkedHashMapTest.java & ImmutableSortedMultisetTest.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for CompactLinkedHashMapTest.java & ImmutableSortedMultisetTest.java
      </h3>
      <h1 align="center">
        32.1%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>CompactLinkedHashMapTest.java (76.447876%)<TH>ImmutableSortedMultisetTest.java (20.39135%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#0',2,'match62477-1.html#0',3)" NAME="0">(173-185)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#0',2,'match62477-1.html#0',3)" NAME="0">(459-481)</A><TD ALIGN=center><FONT COLOR="#ff0000">23</FONT>
<TR><TD BGCOLOR="#f63526"><FONT COLOR="#f63526">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#1',2,'match62477-1.html#1',3)" NAME="1">(17-40)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#1',2,'match62477-1.html#1',3)" NAME="1">(36-60)</A><TD ALIGN=center><FONT COLOR="#f30000">22</FONT>
<TR><TD BGCOLOR="#980517"><FONT COLOR="#980517">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#2',2,'match62477-1.html#2',3)" NAME="2">(128-145)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#2',2,'match62477-1.html#2',3)" NAME="2">(327-339)</A><TD ALIGN=center><FONT COLOR="#e80000">21</FONT>
<TR><TD BGCOLOR="#53858b"><FONT COLOR="#53858b">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#3',2,'match62477-1.html#3',3)" NAME="3">(89-104)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#3',2,'match62477-1.html#3',3)" NAME="3">(360-372)</A><TD ALIGN=center><FONT COLOR="#d20000">19</FONT>
<TR><TD BGCOLOR="#6cc417"><FONT COLOR="#6cc417">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#4',2,'match62477-1.html#4',3)" NAME="4">(108-121)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#4',2,'match62477-1.html#4',3)" NAME="4">(535-542)</A><TD ALIGN=center><FONT COLOR="#b10000">16</FONT>
<TR><TD BGCOLOR="#151b8d"><FONT COLOR="#151b8d">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#5',2,'match62477-1.html#5',3)" NAME="5">(49-66)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#5',2,'match62477-1.html#5',3)" NAME="5">(90-104)</A><TD ALIGN=center><FONT COLOR="#b10000">16</FONT>
<TR><TD BGCOLOR="#8c8774"><FONT COLOR="#8c8774">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#6',2,'match62477-1.html#6',3)" NAME="6">(152-158)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#6',2,'match62477-1.html#6',3)" NAME="6">(350-355)</A><TD ALIGN=center><FONT COLOR="#a60000">15</FONT>
<TR><TD BGCOLOR="#38a4a5"><FONT COLOR="#38a4a5">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#7',2,'match62477-1.html#7',3)" NAME="7">(187-194)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#7',2,'match62477-1.html#7',3)" NAME="7">(483-488)</A><TD ALIGN=center><FONT COLOR="#9b0000">14</FONT>
<TR><TD BGCOLOR="#c58917"><FONT COLOR="#c58917">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#8',2,'match62477-1.html#8',3)" NAME="8">(167-172)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#8',2,'match62477-1.html#8',3)" NAME="8">(321-325)</A><TD ALIGN=center><FONT COLOR="#790000">11</FONT>
<TR><TD BGCOLOR="#83a33a"><FONT COLOR="#83a33a">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#9',2,'match62477-1.html#9',3)" NAME="9">(145-152)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#9',2,'match62477-1.html#9',3)" NAME="9">(377-385)</A><TD ALIGN=center><FONT COLOR="#790000">11</FONT>
<TR><TD BGCOLOR="#ad5910"><FONT COLOR="#ad5910">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#10',2,'match62477-1.html#10',3)" NAME="10">(44-48)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#10',2,'match62477-1.html#10',3)" NAME="10">(105-111)</A><TD ALIGN=center><FONT COLOR="#790000">11</FONT>
<TR><TD BGCOLOR="#b041ff"><FONT COLOR="#b041ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#11',2,'match62477-1.html#11',3)" NAME="11">(195-200)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#11',2,'match62477-1.html#11',3)" NAME="11">(551-556)</A><TD ALIGN=center><FONT COLOR="#6e0000">10</FONT>
<TR><TD BGCOLOR="#571b7e"><FONT COLOR="#571b7e">-</FONT><TD><A HREF="javascript:ZweiFrames('match62477-0.html#12',2,'match62477-1.html#12',3)" NAME="12">(162-166)<TD><A HREF="javascript:ZweiFrames('match62477-0.html#12',2,'match62477-1.html#12',3)" NAME="12">(345-348)</A><TD ALIGN=center><FONT COLOR="#630000">9</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>CompactLinkedHashMapTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2012 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */
<A NAME="1"></A>
package com.google.common.collect;

<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match62477-1.html#1',3,'match62477-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>import static com.google.common.truth.Truth.assertThat;

import com.google.common.collect.testing.MapTestSuiteBuilder;
import com.google.common.collect.testing.TestStringMapGenerator;
import com.google.common.collect.testing.features.CollectionFeature;
import com.google.common.collect.testing.features.CollectionSize;
import com.google.common.collect.testing.features.MapFeature;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import junit.framework.Test;
import junit.framework.TestCase;
import junit.framework.TestSuite;

/**
 * Tests for {@code CompactLinkedHashMap}.
 *
 * @author Louis Wasserman
 */
public class CompactLinkedHashMapTest extends TestCase {
  public static Test suite() {
    TestSuite suite = new TestSuite();
    suite.addTest(
        MapTestSuiteBuilder.using</B></FONT>(
<A NAME="10"></A>                new TestStringMapGenerator() {
                  @Override
                  protected Map&lt;String, String&gt; create(Entry&lt;String, String&gt;[] entries) {
                    <FONT color="#ad5910"><A HREF="javascript:ZweiFrames('match62477-1.html#10',3,'match62477-top.html#10',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Map&lt;String, String&gt; map = CompactLinkedHashMap.create();
                    for (Entry&lt;String, String&gt; entry : entries) {
<A NAME="5"></A>                      map.put(entry.getKey(), entry.getValue());
                    }
                    return</B></FONT> map;
                  <FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match62477-1.html#5',3,'match62477-top.html#5',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
                })
            .named(&quot;CompactLinkedHashMap&quot;)
            .withFeatures(
                CollectionSize.ANY,
                CollectionFeature.SUPPORTS_ITERATOR_REMOVE,
                MapFeature.GENERAL_PURPOSE,
                MapFeature.ALLOWS_NULL_KEYS,
                MapFeature.ALLOWS_NULL_VALUES,
                CollectionFeature.SERIALIZABLE,
                CollectionFeature.KNOWN_ORDER)
            .createTestSuite());
    suite.addTest(
        MapTestSuiteBuilder.using(
                new TestStringMapGenerator() {
                  @Override
                  protected Map&lt;String, String&gt; create(Entry&lt;String, String&gt;[] entries) {
                    CompactLinkedHashMap&lt;String, String&gt; map = CompactLinkedHashMap.create</B></FONT>();
                    map.convertToHashFloodingResistantImplementation();
                    for (Entry&lt;String, String&gt; entry : entries) {
                      map.put(entry.getKey(), entry.getValue());
                    }
                    return map;
                  }
                })
            .named(&quot;CompactLinkedHashMap with flooding resistance&quot;)
            .withFeatures(
                CollectionSize.ANY,
                CollectionFeature.SUPPORTS_ITERATOR_REMOVE,
                MapFeature.GENERAL_PURPOSE,
                MapFeature.ALLOWS_NULL_KEYS,
                MapFeature.ALLOWS_NULL_VALUES,
                CollectionFeature.SERIALIZABLE,
                CollectionFeature.KNOWN_ORDER)
            .createTestSuite());
    suite.addTestSuite(CompactLinkedHashMapTest.class);
    return suite;
<A NAME="3"></A>  }

  public void testInsertionOrder() {
    <FONT color="#53858b"><A HREF="javascript:ZweiFrames('match62477-1.html#3',3,'match62477-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Map&lt;Integer, String&gt; map = CompactLinkedHashMap.create();
    map.put(1, &quot;a&quot;);
    map.put(4, &quot;b&quot;);
    map.put(3, &quot;d&quot;);
    map.put(2, &quot;c&quot;);
    testHasMapEntriesInOrder(map, 1, &quot;a&quot;, 4, &quot;b&quot;, 3, &quot;d&quot;, 2, &quot;c&quot;);
  }

  public void testInsertionOrderAfterPutKeyTwice() {
    Map&lt;Integer, String&gt; map = CompactLinkedHashMap.create();
    map.put(1, &quot;a&quot;);
    map.put(4, &quot;b&quot;);
    map.put(3, &quot;d&quot;);
    map.put(2, &quot;c&quot;);
    map.put(1, &quot;e&quot;);
    testHasMapEntriesInOrder</B></FONT>(map, 1, &quot;e&quot;, 4, &quot;b&quot;, 3, &quot;d&quot;, 2, &quot;c&quot;);
<A NAME="4"></A>  }

  public void testInsertionOrderAfterRemoveFirstEntry() {
    Map&lt;Integer, String&gt; map = <FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match62477-1.html#4',3,'match62477-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>CompactLinkedHashMap.create();
    map.put(1, &quot;a&quot;);
    map.put(4, &quot;b&quot;);
    map.put(3, &quot;d&quot;);
    map.put(2, &quot;c&quot;);
    map.remove(1);
    testHasMapEntriesInOrder(map, 4, &quot;b&quot;, 3, &quot;d&quot;, 2, &quot;c&quot;);
  }

  public void testInsertionOrderAfterRemoveMiddleEntry() {
    Map&lt;Integer, String&gt; map = CompactLinkedHashMap.create();
    map.put(1, &quot;a&quot;);
    map.put(4, &quot;b&quot;);
    map.put</B></FONT>(3, &quot;d&quot;);
    map.put(2, &quot;c&quot;);
    map.remove(4);
    testHasMapEntriesInOrder(map, 1, &quot;a&quot;, 3, &quot;d&quot;, 2, &quot;c&quot;);
<A NAME="2"></A>  }

  public void testInsertionOrderAfterRemoveLastEntry() {
    Map&lt;Integer, String&gt; map = <FONT color="#980517"><A HREF="javascript:ZweiFrames('match62477-1.html#2',3,'match62477-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>CompactLinkedHashMap.create();
    map.put(1, &quot;a&quot;);
    map.put(4, &quot;b&quot;);
    map.put(3, &quot;d&quot;);
    map.put(2, &quot;c&quot;);
    map.remove(2);
    testHasMapEntriesInOrder(map, 1, &quot;a&quot;, 4, &quot;b&quot;, 3, &quot;d&quot;);
  }

  public void testTrimToSize() {
    CompactLinkedHashMap&lt;Integer, String&gt; map = CompactLinkedHashMap.createWithExpectedSize(100);
    map.put(1, &quot;a&quot;);
    map.put(4, &quot;b&quot;);
    map.put(3, &quot;d&quot;);
<A NAME="9"></A>    map.put(2, &quot;c&quot;);
    map.trimToSize();
    assertThat(map.entries).hasLength(4);
    <FONT color="#83a33a"><A HREF="javascript:ZweiFrames('match62477-1.html#9',3,'match62477-top.html#9',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>assertThat(map.keys).hasLength</B></FONT>(4);
    assertThat(map.values).hasLength(4);
    assertThat(map.links).hasLength(4);
    assertEquals(4, map.size());
<A NAME="6"></A>    testHasMapEntriesInOrder(map, 1, &quot;a&quot;, 4, &quot;b&quot;, 3, &quot;d&quot;, 2, &quot;c&quot;);
  }

  private void testHasMapE</B></FONT>ntriesInOrder(Map&lt;?, ?&gt; map, Object... alternatingKeysAndValues) <FONT color="#8c8774"><A HREF="javascript:ZweiFrames('match62477-1.html#6',3,'match62477-top.html#6',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>{
    List&lt;? extends Entry&lt;?, ?&gt;&gt; entries = Lists.newArrayList(map.entrySet());
    List&lt;Object&gt; keys = Lists.newArrayList(map.keySet());
    List&lt;Object&gt; values = Lists.newArrayList(map.values());
    assertEquals(2 * entries.size(), alternatingKeysAndValues.length);
    assertEquals(2 * keys.size(), alternatingKeysAndValues.length);
    assertEquals</B></FONT>(2 * values.size(), alternatingKeysAndValues.length);
<A NAME="12"></A>    for (int i = 0; i &lt; map.size(); i++) {
      Object expectedKey = alternatingKeysAndValues[2 * i];
      Object expectedValue = alternatingKeysAndValues[2 * i + 1];
      <FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match62477-1.html#12',3,'match62477-top.html#12',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>Entry&lt;Object, Object&gt; expectedEntry = Maps.immutableEntry(expectedKey, expectedValue);
      assertEquals(expectedEntry, entries.get(i));
<A NAME="8"></A>      assertEquals(expectedKey, keys.get(i));
      assertEquals(expectedValue, values.get(i));
    }</B></FONT>
  <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match62477-1.html#8',3,'match62477-top.html#8',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}

  public void testAllocArraysDefault() {
<A NAME="0"></A>    CompactLinkedHashMap&lt;Integer, String&gt; map = CompactLinkedHashMap.create();
    assertThat(map.needsAllocArrays()).isTrue();
    assertThat</B></FONT>(map.entries).isNull();
    <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match62477-1.html#0',3,'match62477-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>assertThat(map.keys).isNull();
    assertThat(map.values).isNull();
    assertThat(map.links).isNull();

    map.put(1, Integer.toString(1));
    assertThat(map.needsAllocArrays()).isFalse();
    assertThat(map.entries).hasLength(CompactHashing.DEFAULT_SIZE);
    assertThat(map.keys).hasLength(CompactHashing.DEFAULT_SIZE);
    assertThat(map.values).hasLength(CompactHashing.DEFAULT_SIZE);
    assertThat(map.links).hasLength(CompactHashing.DEFAULT_SIZE);
  }
<A NAME="7"></A>
  public void testAllocArraysExpectedSize() {</B></FONT>
    for (int i = 0; i &lt;= CompactHashing.DEFAULT_SIZE; i++) {
      <FONT color="#38a4a5"><A HREF="javascript:ZweiFrames('match62477-1.html#7',3,'match62477-top.html#7',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>CompactLinkedHashMap&lt;Integer, String&gt; map = CompactLinkedHashMap.createWithExpectedSize(i);
      assertThat(map.needsAllocArrays()).isTrue();
      assertThat(map.entries).isNull();
      assertThat(map.keys).isNull();
      assertThat(map.values).isNull();
<A NAME="11"></A>      assertThat(map.links).isNull();

      map.put</B></FONT>(1, Integer.toString(1));
      assertThat(<FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match62477-1.html#11',3,'match62477-top.html#11',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>map.needsAllocArrays()).isFalse();
      int expectedSize = Math.max(1, i);
      assertThat(map.entries).hasLength(expectedSize);
      assertThat(map.keys).hasLength(expectedSize);
      assertThat(map.values).hasLength(expectedSize);
      assertThat(map.links).hasLength</B></FONT>(expectedSize);
    }
  }

}
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>ImmutableSortedMultisetTest.java</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/*
 * Copyright (C) 2011 The Guava Authors
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */

package com.google.common.collect;

import static com.google.common.base.Preconditions.checkArgument;
import static com.google.common.truth.Truth.assertThat;
import static java.util.Arrays.asList;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

import com.google.common.base.Function;
import com.google.common.collect.Multiset.Entry;
import com.google.common.collect.testing.ListTestSuiteBuilder;
import com.google.common.collect.testing.MinimalCollection;
import com.google.common.collect.testing.TestStringListGenerator;
import com.google.common.collect.testing.features.CollectionFeature;
import com.google.common.collect.testing.features.CollectionSize;
import com.google.common.collect.testing.google.SortedMultisetTestSuiteBuilder;
import com.google.common.collect.testing.google.TestStringMultisetGenerator;
import com.google.common.collect.testing.google.UnmodifiableCollectionTests;
<A NAME="1"></A>import com.google.common.testing.CollectorTester;
import com.google.common.testing.NullPointerTester;
import com.google.common.testing.SerializableTester;
<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#1',2,'match62477-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.Comparator;
import java.util.HashSet;
import java.util.Iterator;
import java.util.List;
import java.util.Set;
import java.util.function.BiPredicate;
import junit.framework.Test;
import junit.framework.TestCase;
import junit.framework.TestSuite;

/**
 * Tests for {@link ImmutableSortedMultiset}.
 *
 * @author Louis Wasserman
 */
public class ImmutableSortedMultisetTest extends TestCase {
  public static Test suite() {
    TestSuite suite = new TestSuite();
    suite.addTestSuite(ImmutableSortedMultisetTest.class);

    suite.addTest(
        SortedMultisetTestSuiteBuilder.using(</B></FONT>
                new TestStringMultisetGenerator() {
                  @Override
                  protected Multiset&lt;String&gt; create(String[] elements) {
                    return ImmutableSortedMultiset.copyOf(elements);
                  }

                  @Override
                  public List&lt;String&gt; order(List&lt;String&gt; insertionOrder) {
                    return Ordering.natural().sortedCopy(insertionOrder);
                  }
                })
            .named(&quot;ImmutableSortedMultiset&quot;)
            .withFeatures(
                CollectionSize.ANY,
                CollectionFeature.SERIALIZABLE_INCLUDING_VIEWS,
                CollectionFeature.ALLOWS_NULL_QUERIES)
            .createTestSuite());

    suite.addTest(
        ListTestSuiteBuilder.using(
                new TestStringListGenerator() {
                  @Override
                  protected List&lt;String&gt; create(String[] elements) {
                    return ImmutableSortedMultiset.copyOf(elements).asList();
                  }

<A NAME="5"></A>                  @Override
                  public List&lt;String&gt; order(List&lt;String&gt; insertionOrder) {
                    return Ordering.natural().sortedCopy(insertionOrder);
                  <FONT color="#151b8d"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#5',2,'match62477-top.html#5',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}
                })
            .named(&quot;ImmutableSortedMultiset.asList&quot;)
            .withFeatures(
                CollectionSize.ANY,
                CollectionFeature.SERIALIZABLE,
                CollectionFeature.ALLOWS_NULL_QUERIES)
            .createTestSuite());

    suite.addTest(
        ListTestSuiteBuilder.using(
                new TestStringListGenerator() {
<A NAME="10"></A>                  @Override
                  protected List&lt;String&gt; create(String[] elements) {
                    Set&lt;String&gt; set = Sets.newHashSet</B></FONT>();
                    <FONT color="#ad5910"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#10',2,'match62477-top.html#10',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ImmutableSortedMultiset.Builder&lt;String&gt; builder =
                        ImmutableSortedMultiset.naturalOrder();
                    for (String s : elements) {
                      checkArgument(set.add(s));
                      builder.addCopies(s, 2);
                    }
                    return</B></FONT> builder.build().elementSet().asList();
                  }

                  @Override
                  public List&lt;String&gt; order(List&lt;String&gt; insertionOrder) {
                    return Ordering.natural().sortedCopy(insertionOrder);
                  }
                })
            .named(&quot;ImmutableSortedMultiset.elementSet.asList&quot;)
            .withFeatures(
                CollectionSize.ANY,
                CollectionFeature.REJECTS_DUPLICATES_AT_CREATION,
                CollectionFeature.SERIALIZABLE,
                CollectionFeature.ALLOWS_NULL_QUERIES)
            .createTestSuite());

    return suite;
  }

  public void testCreation_noArgs() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of();
    assertTrue(multiset.isEmpty());
  }

  public void testCreation_oneElement() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of(&quot;a&quot;);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;)), multiset);
  }

  public void testCreation_twoElements() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;)), multiset);
  }

  public void testCreation_threeElements() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)), multiset);
  }

  public void testCreation_fourElements() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;)), multiset);
  }

  public void testCreation_fiveElements() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;)), multiset);
  }

  public void testCreation_sixElements() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;)), multiset);
  }

  public void testCreation_sevenElements() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;)), multiset);
  }

  public void testCreation_emptyArray() {
    String[] array = new String[0];
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(array);
    assertTrue(multiset.isEmpty());
  }

  public void testCreation_arrayOfOneElement() {
    String[] array = new String[] {&quot;a&quot;};
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(array);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;)), multiset);
  }

  public void testCreation_arrayOfArray() {
    Comparator&lt;String[]&gt; comparator =
        Ordering.natural()
            .lexicographical()
            .onResultOf(
                new Function&lt;String[], Iterable&lt;Comparable&gt;&gt;() {
                  @Override
                  public Iterable&lt;Comparable&gt; apply(String[] input) {
                    return Arrays.&lt;Comparable&gt;asList(input);
                  }
                });
    String[] array = new String[] {&quot;a&quot;};
    Multiset&lt;String[]&gt; multiset = ImmutableSortedMultiset.orderedBy(comparator).add(array).build();
    Multiset&lt;String[]&gt; expected = HashMultiset.create();
    expected.add(array);
    assertEquals(expected, multiset);
  }

  public void testCreation_arrayContainingOnlyNull() {
    String[] array = new String[] {null};
    try {
      ImmutableSortedMultiset.copyOf(array);
      fail();
    } catch (NullPointerException expected) {
    }
  }

  public void testCopyOf_collection_empty() {
    // &quot;&lt;String&gt;&quot; is required to work around a javac 1.5 bug.
    Collection&lt;String&gt; c = MinimalCollection.&lt;String&gt;of();
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(c);
    assertTrue(multiset.isEmpty());
  }

  public void testCopyOf_collection_oneElement() {
    Collection&lt;String&gt; c = MinimalCollection.of(&quot;a&quot;);
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(c);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;)), multiset);
  }

  public void testCopyOf_collection_general() {
    Collection&lt;String&gt; c = MinimalCollection.of(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;);
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(c);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;)), multiset);
  }

  public void testCopyOf_collectionContainingNull() {
    Collection&lt;String&gt; c = MinimalCollection.of(&quot;a&quot;, null, &quot;b&quot;);
    try {
      ImmutableSortedMultiset.copyOf(c);
      fail();
    } catch (NullPointerException expected) {
    }
  }

  public void testCopyOf_multiset_empty() {
    Multiset&lt;String&gt; c = HashMultiset.create();
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(c);
    assertTrue(multiset.isEmpty());
  }

  public void testCopyOf_multiset_oneElement() {
    Multiset&lt;String&gt; c = HashMultiset.create(asList(&quot;a&quot;));
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(c);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;)), multiset);
  }

  public void testCopyOf_multiset_general() {
    Multiset&lt;String&gt; c = HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;));
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(c);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;)), multiset);
  }

  public void testCopyOf_multisetContainingNull() {
    Multiset&lt;String&gt; c = HashMultiset.create(asList(&quot;a&quot;, null, &quot;b&quot;));
    try {
      ImmutableSortedMultiset.copyOf(c);
      fail();
    } catch (NullPointerException expected) {
    }
  }

  public void testCopyOf_iterator_empty() {
    Iterator&lt;String&gt; iterator = Iterators.emptyIterator();
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(iterator);
    assertTrue(multiset.isEmpty());
  }

  public void testCopyOf_iterator_oneElement() {
    Iterator&lt;String&gt; iterator = Iterators.singletonIterator(&quot;a&quot;);
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(iterator);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;)), multiset);
  }

  public void testCopyOf_iterator_general() {
    Iterator&lt;String&gt; iterator = asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;).iterator();
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(iterator);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;)), multiset);
  }

  public void testCopyOf_iteratorContainingNull() {
    Iterator&lt;String&gt; iterator = asList(&quot;a&quot;, null, &quot;b&quot;).iterator();
    try {
      ImmutableSortedMultiset.copyOf(iterator);
      fail();
    } catch (NullPointerException expected) {
    }
  }

  private static class CountingIterable implements Iterable&lt;String&gt; {
    int count = 0;

    @Override
    public Iterator&lt;String&gt; iterator() {
      count++;
      return asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;).iterator();
    }
  }

  public void testCopyOf_plainIterable() {
    CountingIterable iterable = new CountingIterable();
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.copyOf(iterable);
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;)), multiset);
    assertEquals(1, iterable.count);
  }

  public void testCopyOf_shortcut_empty() {
    Collection&lt;String&gt; c = ImmutableSortedMultiset.of();
    assertSame(c, ImmutableSortedMultiset.copyOf(c));
  }

  public void testCopyOf_shortcut_singleton() {
    Collection&lt;String&gt; c = ImmutableSortedMultiset.of(&quot;a&quot;);
    assertSame(c, ImmutableSortedMultiset.copyOf(c));
  }

<A NAME="8"></A>  public void testCopyOf_shortcut_immutableMultiset() {
    Collection&lt;String&gt; c = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);
    assertSame(c, ImmutableSortedMultiset.copyOf(c));
  <FONT color="#c58917"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#8',2,'match62477-top.html#8',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}

  public void testForEachEntry() {
<A NAME="2"></A>    ImmutableSortedMultiset&lt;String&gt; multiset =
        ImmutableSortedMultiset.&lt;String&gt;naturalOrder</B></FONT>().add(&quot;a&quot;).add(&quot;b&quot;).add(&quot;a&quot;).add(&quot;c&quot;).build();
    List&lt;Multiset.Entry&lt;String&gt;&gt; entries = new ArrayList&lt;&gt;();
    multiset.forEachEntry((e, c) -&gt; entries.add(<FONT color="#980517"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#2',2,'match62477-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>Multisets.immutableEntry(e, c)));
    assertThat(entries)
        .containsExactly(
            Multisets.immutableEntry(&quot;a&quot;, 2),
            Multisets.immutableEntry(&quot;b&quot;, 1),
            Multisets.immutableEntry(&quot;c&quot;, 1))
        .inOrder();
  }

  public void testBuilderAdd() {
    ImmutableSortedMultiset&lt;String&gt; multiset =
        ImmutableSortedMultiset.&lt;String&gt;naturalOrder().add(&quot;a&quot;).add(&quot;b&quot;).add(&quot;a&quot;).add(&quot;c&quot;).build();
    assertEquals(HashMultiset.create(asList</B></FONT>(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;, &quot;c&quot;)), multiset);
  }

<A NAME="12"></A>  public void testBuilderAddAll() {
    List&lt;String&gt; a = asList(&quot;a&quot;, &quot;b&quot;);
    List&lt;String&gt; b = asList(&quot;c&quot;, &quot;d&quot;);
    <FONT color="#571b7e"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#12',2,'match62477-top.html#12',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ImmutableSortedMultiset&lt;String&gt; multiset =
        ImmutableSortedMultiset.&lt;String&gt;naturalOrder().addAll(a).addAll(b).build();
<A NAME="6"></A>    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;)), multiset);
  }</B></FONT>

  public void testBuilderAddAllMultiset() <FONT color="#8c8774"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#6',2,'match62477-top.html#6',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>{
    Multiset&lt;String&gt; a = HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;b&quot;));
    Multiset&lt;String&gt; b = HashMultiset.create(asList(&quot;c&quot;, &quot;b&quot;));
    ImmutableSortedMultiset&lt;String&gt; multiset =
        ImmutableSortedMultiset.&lt;String&gt;naturalOrder().addAll(a).addAll(b).build();
    assertEquals(HashMultiset.create(asList</B></FONT>(&quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;)), multiset);
  }
<A NAME="3"></A>
  public void testBuilderAddAllIterator() {
    Iterator&lt;String&gt; iterator = asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;, &quot;c&quot;).iterator();
    <FONT color="#53858b"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#3',2,'match62477-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ImmutableSortedMultiset&lt;String&gt; multiset =
        ImmutableSortedMultiset.&lt;String&gt;naturalOrder().addAll(iterator).build();
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;, &quot;c&quot;)), multiset);
  }

  public void testBuilderAddCopies() {
    ImmutableSortedMultiset&lt;String&gt; multiset =
        ImmutableSortedMultiset.&lt;String&gt;naturalOrder()
            .addCopies(&quot;a&quot;, 2)
            .addCopies(&quot;b&quot;, 3)
            .addCopies(&quot;c&quot;, 0)
            .build();
    assertEquals(HashMultiset.create</B></FONT>(asList(&quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;)), multiset);
  }
<A NAME="9"></A>
  public void testBuilderSetCount() {
    ImmutableSortedMultiset&lt;String&gt; multiset =
        <FONT color="#83a33a"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#9',2,'match62477-top.html#9',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ImmutableSortedMultiset.&lt;String&gt;naturalOrder()
            .add(&quot;a&quot;)
            .setCount(&quot;a&quot;, 2)
            .setCount(&quot;b&quot;, 3)
            .build();
    assertEquals(HashMultiset.create(asList(&quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;)), multiset);
  }

  public void testBuilderAddHandlesNu</B></FONT>llsCorrectly() {
    ImmutableSortedMultiset.Builder&lt;String&gt; builder = ImmutableSortedMultiset.naturalOrder();
    try {
      builder.add((String) null);
      fail(&quot;expected NullPointerException&quot;);
    } catch (NullPointerException expected) {
    }
  }

  public void testBuilderAddAllHandlesNullsCorrectly() {
    ImmutableSortedMultiset.Builder&lt;String&gt; builder = ImmutableSortedMultiset.naturalOrder();
    try {
      builder.addAll((Collection&lt;String&gt;) null);
      fail(&quot;expected NullPointerException&quot;);
    } catch (NullPointerException expected) {
    }

    builder = ImmutableSortedMultiset.naturalOrder();
    List&lt;String&gt; listWithNulls = asList(&quot;a&quot;, null, &quot;b&quot;);
    try {
      builder.addAll(listWithNulls);
      fail(&quot;expected NullPointerException&quot;);
    } catch (NullPointerException expected) {
    }

    builder = ImmutableSortedMultiset.naturalOrder();
    Multiset&lt;String&gt; multisetWithNull = LinkedHashMultiset.create(asList(&quot;a&quot;, null, &quot;b&quot;));
    try {
      builder.addAll(multisetWithNull);
      fail(&quot;expected NullPointerException&quot;);
    } catch (NullPointerException expected) {
    }
  }

  public void testBuilderAddCopiesHandlesNullsCorrectly() {
    ImmutableSortedMultiset.Builder&lt;String&gt; builder = ImmutableSortedMultiset.naturalOrder();
    try {
      builder.addCopies(null, 2);
      fail(&quot;expected NullPointerException&quot;);
    } catch (NullPointerException expected) {
    }
  }

  public void testBuilderAddCopiesIllegal() {
    ImmutableSortedMultiset.Builder&lt;String&gt; builder = ImmutableSortedMultiset.naturalOrder();
    try {
      builder.addCopies(&quot;a&quot;, -2);
      fail(&quot;expected IllegalArgumentException&quot;);
    } catch (IllegalArgumentException expected) {
    }
  }

  public void testBuilderSetCountHandlesNullsCorrectly() {
    ImmutableSortedMultiset.Builder&lt;String&gt; builder =
        new ImmutableSortedMultiset.Builder&lt;&gt;(Ordering.natural().nullsFirst());
    try {
      builder.setCount(null, 2);
      fail(&quot;expected NullPointerException&quot;);
    } catch (NullPointerException expected) {
    }
  }

  public void testBuilderSetCountIllegal() {
    ImmutableSortedMultiset.Builder&lt;String&gt; builder = ImmutableSortedMultiset.naturalOrder();
    try {
      builder.setCount(&quot;a&quot;, -2);
      fail(&quot;expected IllegalArgumentException&quot;);
    } catch (IllegalArgumentException expected) {
    }
  }

<A NAME="0"></A>  public void testToImmutableSortedMultiset() {
    BiPredicate&lt;ImmutableSortedMultiset&lt;String&gt;, ImmutableSortedMultiset&lt;String&gt;&gt; equivalence =
        (ms1, ms2) -&gt;
            <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#0',2,'match62477-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ms1.equals(ms2)
                &amp;&amp; ms1.entrySet().asList().equals(ms2.entrySet().asList())
                &amp;&amp; ms1.comparator().equals(ms2.comparator());
    CollectorTester.of(
            ImmutableSortedMultiset.&lt;String&gt;toImmutableSortedMultiset(
                String.CASE_INSENSITIVE_ORDER),
            equivalence)
        .expectCollects(ImmutableSortedMultiset.emptyMultiset(String.CASE_INSENSITIVE_ORDER))
        .expectCollects(
            ImmutableSortedMultiset.orderedBy(String.CASE_INSENSITIVE_ORDER)
                .addCopies(&quot;a&quot;, 2)
                .addCopies(&quot;b&quot;, 1)
                .addCopies(&quot;c&quot;, 3)
                .build(),
            &quot;a&quot;,
            &quot;c&quot;,
            &quot;b&quot;,
            &quot;c&quot;,
            &quot;A&quot;,
            &quot;C&quot;);
  }
<A NAME="7"></A>
  public void testToImmutableSortedMultisetCountFunction() {</B></FONT>
    BiPredicate&lt;ImmutableSortedMultiset&lt;String&gt;, ImmutableSortedMultiset&lt;String&gt;&gt; equivalence =
        (ms1, <FONT color="#38a4a5"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#7',2,'match62477-top.html#7',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ms2) -&gt;
            ms1.equals(ms2)
                &amp;&amp; ms1.entrySet().asList().equals(ms2.entrySet().asList())
                &amp;&amp; ms1.comparator().equals(ms2.comparator());
    CollectorTester.of(
            ImmutableSortedMultiset.&lt;String, String&gt;toImmutableSortedMultiset</B></FONT>(
                String.CASE_INSENSITIVE_ORDER, e -&gt; e, e -&gt; 1),
            equivalence)
        .expectCollects(ImmutableSortedMultiset.emptyMultiset(String.CASE_INSENSITIVE_ORDER))
        .expectCollects(
            ImmutableSortedMultiset.orderedBy(String.CASE_INSENSITIVE_ORDER)
                .addCopies(&quot;a&quot;, 2)
                .addCopies(&quot;b&quot;, 1)
                .addCopies(&quot;c&quot;, 3)
                .build(),
            &quot;a&quot;,
            &quot;c&quot;,
            &quot;b&quot;,
            &quot;c&quot;,
            &quot;A&quot;,
            &quot;C&quot;);
  }

  public void testNullPointers() {
    new NullPointerTester().testAllPublicStaticMethods(ImmutableSortedMultiset.class);
  }

  public void testSerialization_empty() {
    Collection&lt;String&gt; c = ImmutableSortedMultiset.of();
    assertSame(c, SerializableTester.reserialize(c));
  }

  public void testSerialization_multiple() {
    Collection&lt;String&gt; c = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;);
    Collection&lt;String&gt; copy = SerializableTester.reserializeAndAssert(c);
    assertThat(copy).containsExactly(&quot;a&quot;, &quot;a&quot;, &quot;b&quot;).inOrder();
  }

  public void testSerialization_elementSet() {
    Multiset&lt;String&gt; c = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;);
    Collection&lt;String&gt; copy = SerializableTester.reserializeAndAssert(c.elementSet());
    assertThat(copy).containsExactly(&quot;a&quot;, &quot;b&quot;).inOrder();
  }

  public void testSerialization_entrySet() {
    Multiset&lt;String&gt; c = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);
    SerializableTester.reserializeAndAssert(c.entrySet());
  }

<A NAME="4"></A>  public void testEquals_immutableMultiset() {
    Collection&lt;String&gt; c = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;);
    assertEquals(c, ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;));
    assertEquals(c, <FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#4',2,'match62477-top.html#4',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ImmutableSortedMultiset.of(&quot;a&quot;, &quot;a&quot;, &quot;b&quot;));
    assertThat(c).isNotEqualTo(ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;));
    assertThat(c).isNotEqualTo(ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;));
  }

  public void testIterationOrder() {
    Collection&lt;String&gt; c = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;);
    assertThat</B></FONT>(c).containsExactly(&quot;a&quot;, &quot;a&quot;, &quot;b&quot;).inOrder();
  }

  public void testMultisetWrites() {
    Multiset&lt;String&gt; multiset = ImmutableSortedMultiset.of(&quot;a&quot;, &quot;b&quot;, &quot;a&quot;);
    UnmodifiableCollectionTests.assertMultisetIsUnmodifiable(multiset, &quot;test&quot;);
<A NAME="11"></A>  }

  public void testAsList() {
    ImmutableSortedMultiset&lt;String&gt; multiset = <FONT color="#b041ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match62477-0.html#11',2,'match62477-top.html#11',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ImmutableSortedMultiset.of(&quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;);
    ImmutableList&lt;String&gt; list = multiset.asList();
    assertEquals(ImmutableList.of(&quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;), list);
    SerializableTester.reserializeAndAssert(list);
    assertEquals(2, list.indexOf(&quot;b&quot;));
    assertEquals(4, list.lastIndexOf</B></FONT>(&quot;b&quot;));
  }

  public void testCopyOfDefensiveCopy() {
    // Depending on JDK version, either toArray() or toArray(T[]) may be called... use this class
    // rather than mocking to ensure that one of those methods is called.
    class TestArrayList&lt;E&gt; extends ArrayList&lt;E&gt; {
      boolean toArrayCalled = false;

      @Override
      public Object[] toArray() {
        toArrayCalled = true;
        return super.toArray();
      }

      @Override
      public &lt;T&gt; T[] toArray(T[] a) {
        toArrayCalled = true;
        return super.toArray(a);
      }
    }

    // Test that toArray() is used to make a defensive copy in copyOf(), so concurrently modified
    // synchronized collections can be safely copied.
    TestArrayList&lt;String&gt; toCopy = new TestArrayList&lt;&gt;();
    ImmutableSortedMultiset&lt;String&gt; unused =
        ImmutableSortedMultiset.copyOf(Ordering.natural(), toCopy);
    assertTrue(toCopy.toArrayCalled);
  }

  @SuppressWarnings(&quot;unchecked&quot;)
  public void testCopyOfSortedDefensiveCopy() {
    // Depending on JDK version, either toArray() or toArray(T[]) may be called... use this class
    // rather than mocking to ensure that one of those methods is called.
    class TestHashSet&lt;E&gt; extends HashSet&lt;E&gt; {
      boolean toArrayCalled = false;

      @Override
      public Object[] toArray() {
        toArrayCalled = true;
        return super.toArray();
      }

      @Override
      public &lt;T&gt; T[] toArray(T[] a) {
        toArrayCalled = true;
        return super.toArray(a);
      }
    }

    // Test that toArray() is used to make a defensive copy in copyOf(), so concurrently modified
    // synchronized collections can be safely copied.
    SortedMultiset&lt;String&gt; toCopy = mock(SortedMultiset.class);
    TestHashSet&lt;Entry&lt;String&gt;&gt; entrySet = new TestHashSet&lt;&gt;();
    when((Comparator&lt;Comparable&lt;String&gt;&gt;) toCopy.comparator())
        .thenReturn(Ordering.&lt;Comparable&lt;String&gt;&gt;natural());
    when(toCopy.entrySet()).thenReturn(entrySet);
    ImmutableSortedMultiset&lt;String&gt; unused = ImmutableSortedMultiset.copyOfSorted(toCopy);
    assertTrue(entrySet.toArrayCalled);
  }

  private static class IntegerDiv10 implements Comparable&lt;IntegerDiv10&gt; {
    final int value;

    IntegerDiv10(int value) {
      this.value = value;
    }

    @Override
    public int compareTo(IntegerDiv10 o) {
      return value / 10 - o.value / 10;
    }

    @Override
    public String toString() {
      return Integer.toString(value);
    }
  }

  public void testCopyOfDuplicateInconsistentWithEquals() {
    IntegerDiv10 three = new IntegerDiv10(3);
    IntegerDiv10 eleven = new IntegerDiv10(11);
    IntegerDiv10 twelve = new IntegerDiv10(12);
    IntegerDiv10 twenty = new IntegerDiv10(20);

    List&lt;IntegerDiv10&gt; original = ImmutableList.of(three, eleven, twelve, twenty);

    Multiset&lt;IntegerDiv10&gt; copy = ImmutableSortedMultiset.copyOf(original);
    assertTrue(copy.contains(eleven));
    assertTrue(copy.contains(twelve));
  }
}
</PRE>
</div>
  </div>
</body>
</html>
