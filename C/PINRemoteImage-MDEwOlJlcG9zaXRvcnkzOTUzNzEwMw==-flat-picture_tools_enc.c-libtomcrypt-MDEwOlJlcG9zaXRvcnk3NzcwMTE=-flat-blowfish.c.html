
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 6.493506493506493%, Tokens: 8, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>PINRemoteImage-MDEwOlJlcG9zaXRvcnkzOTUzNzEwMw==-flat-picture_tools_enc.c</h3>
            <pre><code>1  #include <assert.h>
2  #include "src/enc/vp8i_enc.h"
3  #include "src/dsp/yuv.h"
4  #define SIZE 8
5  #define SIZE2 (SIZE / 2)
6  static int IsTransparentARGBArea(const uint32_t* ptr, int stride, int size) {
7    int y, x;
8    for (y = 0; y < size; ++y) {
9      for (x = 0; x < size; ++x) {
10        if (ptr[x] & 0xff000000u) {
11          return 0;
12        }
13      }
14      ptr += stride;
15    }
16    return 1;
17  }
18  static void Flatten(uint8_t* ptr, int v, int stride, int size) {
19    int y;
20    for (y = 0; y < size; ++y) {
21      memset(ptr, v, size);
22      ptr += stride;
23    }
24  }
25  static void FlattenARGB(uint32_t* ptr, uint32_t v, int stride, int size) {
26    int x, y;
27    for (y = 0; y < size; ++y) {
28      for (x = 0; x < size; ++x) ptr[x] = v;
29      ptr += stride;
30    }
31  }
32  static int SmoothenBlock(const uint8_t* a_ptr, int a_stride, uint8_t* y_ptr,
33                           int y_stride, int width, int height) {
34    int sum = 0, count = 0;
35    int x, y;
36    const uint8_t* alpha_ptr = a_ptr;
37    uint8_t* luma_ptr = y_ptr;
38    for (y = 0; y < height; ++y) {
39      for (x = 0; x < width; ++x) {
40        if (alpha_ptr[x] != 0) {
41          ++count;
42          sum += luma_ptr[x];
43        }
44      }
45      alpha_ptr += a_stride;
46      luma_ptr += y_stride;
47    }
48    if (count > 0 && count < width * height) {
49      const uint8_t avg_u8 = (uint8_t)(sum / count);
50      alpha_ptr = a_ptr;
51      luma_ptr = y_ptr;
52      for (y = 0; y < height; ++y) {
53        for (x = 0; x < width; ++x) {
54          if (alpha_ptr[x] == 0) luma_ptr[x] = avg_u8;
55        }
56        alpha_ptr += a_stride;
57        luma_ptr += y_stride;
58      }
59    }
60    return (count == 0);
61  }
62  void WebPCleanupTransparentArea(WebPPicture* pic) {
63    int x, y, w, h;
64    if (pic == NULL) return;
65    w = pic->width / SIZE;
66    h = pic->height / SIZE;
67    if (pic->use_argb) {
68      uint32_t argb_value = 0;
69      for (y = 0; y < h; ++y) {
70        int need_reset = 1;
71        for (x = 0; x < w; ++x) {
72          const int off = (y * pic->argb_stride + x) * SIZE;
73          if (IsTransparentARGBArea(pic->argb + off, pic->argb_stride, SIZE)) {
74            if (need_reset) {
75              argb_value = pic->argb[off];
76              need_reset = 0;
77            }
78            FlattenARGB(pic->argb + off, argb_value, pic->argb_stride, SIZE);
79          } else {
80            need_reset = 1;
81          }
82        }
83      }
84    } else {
85      const int width = pic->width;
86      const int height = pic->height;
87      const int y_stride = pic->y_stride;
88      const int uv_stride = pic->uv_stride;
89      const int a_stride = pic->a_stride;
90      uint8_t* y_ptr = pic->y;
91      uint8_t* u_ptr = pic->u;
92      uint8_t* v_ptr = pic->v;
93      const uint8_t* a_ptr = pic->a;
94      int values[3] = { 0 };
95      if (a_ptr == NULL || y_ptr == NULL || u_ptr == NULL || v_ptr == NULL) {
96        return;
97      }
98      for (y = 0; y + SIZE <= height; y += SIZE) {
99        int need_reset = 1;
100        for (x = 0; x + SIZE <= width; x += SIZE) {
101          if (SmoothenBlock(a_ptr + x, a_stride, y_ptr + x, y_stride,
102                            SIZE, SIZE)) {
103            if (need_reset) {
104              values[0] = y_ptr[x];
105              values[1] = u_ptr[x >> 1];
106              values[2] = v_ptr[x >> 1];
107              need_reset = 0;
108            }
109            Flatten(y_ptr + x,        values[0], y_stride,  SIZE);
110            Flatten(u_ptr + (x >> 1), values[1], uv_stride, SIZE2);
111            Flatten(v_ptr + (x >> 1), values[2], uv_stride, SIZE2);
112          } else {
113            need_reset = 1;
114          }
115        }
116        if (x < width) {
117          SmoothenBlock(a_ptr + x, a_stride, y_ptr + x, y_stride,
118                        width - x, SIZE);
119        }
120        a_ptr += SIZE * a_stride;
121        y_ptr += SIZE * y_stride;
122        u_ptr += SIZE2 * uv_stride;
123        v_ptr += SIZE2 * uv_stride;
124      }
125      if (y < height) {
126        const int sub_height = height - y;
127        for (x = 0; x + SIZE <= width; x += SIZE) {
128          SmoothenBlock(a_ptr + x, a_stride, y_ptr + x, y_stride,
129                        SIZE, sub_height);
130        }
131        if (x < width) {
132          SmoothenBlock(a_ptr + x, a_stride, y_ptr + x, y_stride,
133                        width - x, sub_height);
134        }
135      }
136    }
137  }
138  #undef SIZE
139  #undef SIZE2
140  void WebPCleanupTransparentAreaLossless(WebPPicture* const pic) {
141    int x, y, w, h;
142    uint32_t* argb;
143    assert(pic != NULL && pic->use_argb);
144    w = pic->width;
145    h = pic->height;
146    argb = pic->argb;
147    for (y = 0; y < h; ++y) {
148      for (x = 0; x < w; ++x) {
149        if ((argb[x] & 0xff000000) == 0) {
150          argb[x] = 0x00000000;
151        }
152      }
153      argb += pic->argb_stride;
154    }
155  }
156  #define BLEND(V0, V1, ALPHA) \
157      ((((V0) * (255 - (ALPHA)) + (V1) * (ALPHA)) * 0x101 + 256) >> 16)
158  #define BLEND_10BIT(V0, V1, ALPHA) \
159      ((((V0) * (1020 - (ALPHA)) + (V1) * (ALPHA)) * 0x101 + 1024) >> 18)
160  static WEBP_INLINE uint32_t MakeARGB32(int r, int g, int b) {
161    return (0xff000000u | (r << 16) | (g << 8) | b);
162  }
163  void WebPBlendAlpha(WebPPicture* pic, uint32_t background_rgb) {
164    const int red = (background_rgb >> 16) & 0xff;
165    const int green = (background_rgb >> 8) & 0xff;
166    const int blue = (background_rgb >> 0) & 0xff;
167    int x, y;
168    if (pic == NULL) return;
169    if (!pic->use_argb) {
170      const int uv_width = (pic->width >> 1);  
171      const int Y0 = VP8RGBToY(red, green, blue, YUV_HALF);
172      const int U0 = VP8RGBToU(4 * red, 4 * green, 4 * blue, 4 * YUV_HALF);
173      const int V0 = VP8RGBToV(4 * red, 4 * green, 4 * blue, 4 * YUV_HALF);
174      const int has_alpha = pic->colorspace & WEBP_CSP_ALPHA_BIT;
175      uint8_t* y_ptr = pic->y;
176      uint8_t* u_ptr = pic->u;
177      uint8_t* v_ptr = pic->v;
178      uint8_t* a_ptr = pic->a;
179      if (!has_alpha || a_ptr == NULL) return;    
180      for (y = 0; y < pic->height; ++y) {
181        for (x = 0; x < pic->width; ++x) {
182          const uint8_t alpha = a_ptr[x];
183          if (alpha < 0xff) {
184            y_ptr[x] = BLEND(Y0, y_ptr[x], alpha);
185          }
186        }
187        if ((y & 1) == 0) {
188          uint8_t* const a_ptr2 =
189              (y + 1 == pic->height) ? a_ptr : a_ptr + pic->a_stride;
190          for (x = 0; x < uv_width; ++x) {
191            const uint32_t alpha =
192                a_ptr[2 * x + 0] + a_ptr[2 * x + 1] +
193                a_ptr2[2 * x + 0] + a_ptr2[2 * x + 1];
194            u_ptr[x] = BLEND_10BIT(U0, u_ptr[x], alpha);
195            v_ptr[x] = BLEND_10BIT(V0, v_ptr[x], alpha);
196          }
197          if (pic->width & 1) {   
198            const uint32_t alpha = 2 * (a_ptr[2 * x + 0] + a_ptr2[2 * x + 0]);
199            u_ptr[x] = BLEND_10BIT(U0, u_ptr[x], alpha);
200            v_ptr[x] = BLEND_10BIT(V0, v_ptr[x], alpha);
201          }
<span onclick='openModal()' class='match'>202        } else {
203          u_ptr += pic->uv_stride;
204          v_ptr += pic->uv_stride;
205        }
206        memset(a_ptr, 0xff, pic->width);  
207        a_ptr += pic->a_stride;
208        y_ptr += pic->y_stride;
209      }
210    } else {
</span>211      uint32_t* argb = pic->argb;
212      const uint32_t background = MakeARGB32(red, green, blue);
213      for (y = 0; y < pic->height; ++y) {
214        for (x = 0; x < pic->width; ++x) {
215          const int alpha = (argb[x] >> 24) & 0xff;
216          if (alpha != 0xff) {
217            if (alpha > 0) {
218              int r = (argb[x] >> 16) & 0xff;
219              int g = (argb[x] >>  8) & 0xff;
220              int b = (argb[x] >>  0) & 0xff;
221              r = BLEND(red, r, alpha);
222              g = BLEND(green, g, alpha);
223              b = BLEND(blue, b, alpha);
224              argb[x] = MakeARGB32(r, g, b);
225            } else {
226              argb[x] = background;
227            }
228          }
229        }
230        argb += pic->argb_stride;
231      }
232    }
233  }
234  #undef BLEND
235  #undef BLEND_10BIT
</code></pre>
        </div>
        <div class="column">
            <h3>libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-blowfish.c</h3>
            <pre><code>1  #include "tomcrypt_private.h"
2  #ifdef LTC_BLOWFISH
3  const struct ltc_cipher_descriptor blowfish_desc =
4  {
5      "blowfish",
6      0,
7      8, 56, 8, 16,
8      &blowfish_setup,
9      &blowfish_ecb_encrypt,
10      &blowfish_ecb_decrypt,
11      &blowfish_test,
12      &blowfish_done,
13      &blowfish_keysize,
14      NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL
15  };
16  static const ulong32 ORIG_P[16 + 2] = {
17          0x243F6A88UL, 0x85A308D3UL, 0x13198A2EUL, 0x03707344UL,
18          0xA4093822UL, 0x299F31D0UL, 0x082EFA98UL, 0xEC4E6C89UL,
19          0x452821E6UL, 0x38D01377UL, 0xBE5466CFUL, 0x34E90C6CUL,
20          0xC0AC29B7UL, 0xC97C50DDUL, 0x3F84D5B5UL, 0xB5470917UL,
21          0x9216D5D9UL, 0x8979FB1BUL
22  };
23  static const ulong32 ORIG_S[4][256] = {
24      {   0xD1310BA6UL, 0x98DFB5ACUL, 0x2FFD72DBUL, 0xD01ADFB7UL,
25          0xB8E1AFEDUL, 0x6A267E96UL, 0xBA7C9045UL, 0xF12C7F99UL,
26          0x24A19947UL, 0xB3916CF7UL, 0x0801F2E2UL, 0x858EFC16UL,
27          0x636920D8UL, 0x71574E69UL, 0xA458FEA3UL, 0xF4933D7EUL,
28          0x0D95748FUL, 0x728EB658UL, 0x718BCD58UL, 0x82154AEEUL,
29          0x7B54A41DUL, 0xC25A59B5UL, 0x9C30D539UL, 0x2AF26013UL,
30          0xC5D1B023UL, 0x286085F0UL, 0xCA417918UL, 0xB8DB38EFUL,
31          0x8E79DCB0UL, 0x603A180EUL, 0x6C9E0E8BUL, 0xB01E8A3EUL,
32          0xD71577C1UL, 0xBD314B27UL, 0x78AF2FDAUL, 0x55605C60UL,
33          0xE65525F3UL, 0xAA55AB94UL, 0x57489862UL, 0x63E81440UL,
34          0x55CA396AUL, 0x2AAB10B6UL, 0xB4CC5C34UL, 0x1141E8CEUL,
35          0xA15486AFUL, 0x7C72E993UL, 0xB3EE1411UL, 0x636FBC2AUL,
36          0x2BA9C55DUL, 0x741831F6UL, 0xCE5C3E16UL, 0x9B87931EUL,
37          0xAFD6BA33UL, 0x6C24CF5CUL, 0x7A325381UL, 0x28958677UL,
38          0x3B8F4898UL, 0x6B4BB9AFUL, 0xC4BFE81BUL, 0x66282193UL,
39          0x61D809CCUL, 0xFB21A991UL, 0x487CAC60UL, 0x5DEC8032UL,
40          0xEF845D5DUL, 0xE98575B1UL, 0xDC262302UL, 0xEB651B88UL,
41          0x23893E81UL, 0xD396ACC5UL, 0x0F6D6FF3UL, 0x83F44239UL,
42          0x2E0B4482UL, 0xA4842004UL, 0x69C8F04AUL, 0x9E1F9B5EUL,
43          0x21C66842UL, 0xF6E96C9AUL, 0x670C9C61UL, 0xABD388F0UL,
44          0x6A51A0D2UL, 0xD8542F68UL, 0x960FA728UL, 0xAB5133A3UL,
45          0x6EEF0B6CUL, 0x137A3BE4UL, 0xBA3BF050UL, 0x7EFB2A98UL,
46          0xA1F1651DUL, 0x39AF0176UL, 0x66CA593EUL, 0x82430E88UL,
47          0x8CEE8619UL, 0x456F9FB4UL, 0x7D84A5C3UL, 0x3B8B5EBEUL,
48          0xE06F75D8UL, 0x85C12073UL, 0x401A449FUL, 0x56C16AA6UL,
49          0x4ED3AA62UL, 0x363F7706UL, 0x1BFEDF72UL, 0x429B023DUL,
50          0x37D0D724UL, 0xD00A1248UL, 0xDB0FEAD3UL, 0x49F1C09BUL,
51          0x075372C9UL, 0x80991B7BUL, 0x25D479D8UL, 0xF6E8DEF7UL,
52          0xE3FE501AUL, 0xB6794C3BUL, 0x976CE0BDUL, 0x04C006BAUL,
53          0xC1A94FB6UL, 0x409F60C4UL, 0x5E5C9EC2UL, 0x196A2463UL,
54          0x68FB6FAFUL, 0x3E6C53B5UL, 0x1339B2EBUL, 0x3B52EC6FUL,
55          0x6DFC511FUL, 0x9B30952CUL, 0xCC814544UL, 0xAF5EBD09UL,
56          0xBEE3D004UL, 0xDE334AFDUL, 0x660F2807UL, 0x192E4BB3UL,
57          0xC0CBA857UL, 0x45C8740FUL, 0xD20B5F39UL, 0xB9D3FBDBUL,
58          0x5579C0BDUL, 0x1A60320AUL, 0xD6A100C6UL, 0x402C7279UL,
59          0x679F25FEUL, 0xFB1FA3CCUL, 0x8EA5E9F8UL, 0xDB3222F8UL,
60          0x3C7516DFUL, 0xFD616B15UL, 0x2F501EC8UL, 0xAD0552ABUL,
61          0x323DB5FAUL, 0xFD238760UL, 0x53317B48UL, 0x3E00DF82UL,
62          0x9E5C57BBUL, 0xCA6F8CA0UL, 0x1A87562EUL, 0xDF1769DBUL,
63          0xD542A8F6UL, 0x287EFFC3UL, 0xAC6732C6UL, 0x8C4F5573UL,
64          0x695B27B0UL, 0xBBCA58C8UL, 0xE1FFA35DUL, 0xB8F011A0UL,
65          0x10FA3D98UL, 0xFD2183B8UL, 0x4AFCB56CUL, 0x2DD1D35BUL,
66          0x9A53E479UL, 0xB6F84565UL, 0xD28E49BCUL, 0x4BFB9790UL,
67          0xE1DDF2DAUL, 0xA4CB7E33UL, 0x62FB1341UL, 0xCEE4C6E8UL,
68          0xEF20CADAUL, 0x36774C01UL, 0xD07E9EFEUL, 0x2BF11FB4UL,
69          0x95DBDA4DUL, 0xAE909198UL, 0xEAAD8E71UL, 0x6B93D5A0UL,
70          0xD08ED1D0UL, 0xAFC725E0UL, 0x8E3C5B2FUL, 0x8E7594B7UL,
71          0x8FF6E2FBUL, 0xF2122B64UL, 0x8888B812UL, 0x900DF01CUL,
72          0x4FAD5EA0UL, 0x688FC31CUL, 0xD1CFF191UL, 0xB3A8C1ADUL,
73          0x2F2F2218UL, 0xBE0E1777UL, 0xEA752DFEUL, 0x8B021FA1UL,
74          0xE5A0CC0FUL, 0xB56F74E8UL, 0x18ACF3D6UL, 0xCE89E299UL,
75          0xB4A84FE0UL, 0xFD13E0B7UL, 0x7CC43B81UL, 0xD2ADA8D9UL,
76          0x165FA266UL, 0x80957705UL, 0x93CC7314UL, 0x211A1477UL,
77          0xE6AD2065UL, 0x77B5FA86UL, 0xC75442F5UL, 0xFB9D35CFUL,
78          0xEBCDAF0CUL, 0x7B3E89A0UL, 0xD6411BD3UL, 0xAE1E7E49UL,
79          0x00250E2DUL, 0x2071B35EUL, 0x226800BBUL, 0x57B8E0AFUL,
80          0x2464369BUL, 0xF009B91EUL, 0x5563911DUL, 0x59DFA6AAUL,
81          0x78C14389UL, 0xD95A537FUL, 0x207D5BA2UL, 0x02E5B9C5UL,
82          0x83260376UL, 0x6295CFA9UL, 0x11C81968UL, 0x4E734A41UL,
83          0xB3472DCAUL, 0x7B14A94AUL, 0x1B510052UL, 0x9A532915UL,
84          0xD60F573FUL, 0xBC9BC6E4UL, 0x2B60A476UL, 0x81E67400UL,
85          0x08BA6FB5UL, 0x571BE91FUL, 0xF296EC6BUL, 0x2A0DD915UL,
86          0xB6636521UL, 0xE7B9F9B6UL, 0xFF34052EUL, 0xC5855664UL,
87          0x53B02D5DUL, 0xA99F8FA1UL, 0x08BA4799UL, 0x6E85076AUL   },
88      {   0x4B7A70E9UL, 0xB5B32944UL, 0xDB75092EUL, 0xC4192623UL,
89          0xAD6EA6B0UL, 0x49A7DF7DUL, 0x9CEE60B8UL, 0x8FEDB266UL,
90          0xECAA8C71UL, 0x699A17FFUL, 0x5664526CUL, 0xC2B19EE1UL,
91          0x193602A5UL, 0x75094C29UL, 0xA0591340UL, 0xE4183A3EUL,
92          0x3F54989AUL, 0x5B429D65UL, 0x6B8FE4D6UL, 0x99F73FD6UL,
93          0xA1D29C07UL, 0xEFE830F5UL, 0x4D2D38E6UL, 0xF0255DC1UL,
94          0x4CDD2086UL, 0x8470EB26UL, 0x6382E9C6UL, 0x021ECC5EUL,
95          0x09686B3FUL, 0x3EBAEFC9UL, 0x3C971814UL, 0x6B6A70A1UL,
96          0x687F3584UL, 0x52A0E286UL, 0xB79C5305UL, 0xAA500737UL,
97          0x3E07841CUL, 0x7FDEAE5CUL, 0x8E7D44ECUL, 0x5716F2B8UL,
98          0xB03ADA37UL, 0xF0500C0DUL, 0xF01C1F04UL, 0x0200B3FFUL,
99          0xAE0CF51AUL, 0x3CB574B2UL, 0x25837A58UL, 0xDC0921BDUL,
100          0xD19113F9UL, 0x7CA92FF6UL, 0x94324773UL, 0x22F54701UL,
101          0x3AE5E581UL, 0x37C2DADCUL, 0xC8B57634UL, 0x9AF3DDA7UL,
102          0xA9446146UL, 0x0FD0030EUL, 0xECC8C73EUL, 0xA4751E41UL,
103          0xE238CD99UL, 0x3BEA0E2FUL, 0x3280BBA1UL, 0x183EB331UL,
104          0x4E548B38UL, 0x4F6DB908UL, 0x6F420D03UL, 0xF60A04BFUL,
105          0x2CB81290UL, 0x24977C79UL, 0x5679B072UL, 0xBCAF89AFUL,
106          0xDE9A771FUL, 0xD9930810UL, 0xB38BAE12UL, 0xDCCF3F2EUL,
107          0x5512721FUL, 0x2E6B7124UL, 0x501ADDE6UL, 0x9F84CD87UL,
108          0x7A584718UL, 0x7408DA17UL, 0xBC9F9ABCUL, 0xE94B7D8CUL,
109          0xEC7AEC3AUL, 0xDB851DFAUL, 0x63094366UL, 0xC464C3D2UL,
110          0xEF1C1847UL, 0x3215D908UL, 0xDD433B37UL, 0x24C2BA16UL,
111          0x12A14D43UL, 0x2A65C451UL, 0x50940002UL, 0x133AE4DDUL,
112          0x71DFF89EUL, 0x10314E55UL, 0x81AC77D6UL, 0x5F11199BUL,
113          0x043556F1UL, 0xD7A3C76BUL, 0x3C11183BUL, 0x5924A509UL,
114          0xF28FE6EDUL, 0x97F1FBFAUL, 0x9EBABF2CUL, 0x1E153C6EUL,
115          0x86E34570UL, 0xEAE96FB1UL, 0x860E5E0AUL, 0x5A3E2AB3UL,
116          0x771FE71CUL, 0x4E3D06FAUL, 0x2965DCB9UL, 0x99E71D0FUL,
117          0x803E89D6UL, 0x5266C825UL, 0x2E4CC978UL, 0x9C10B36AUL,
118          0xC6150EBAUL, 0x94E2EA78UL, 0xA5FC3C53UL, 0x1E0A2DF4UL,
119          0xF2F74EA7UL, 0x361D2B3DUL, 0x1939260FUL, 0x19C27960UL,
120          0x5223A708UL, 0xF71312B6UL, 0xEBADFE6EUL, 0xEAC31F66UL,
121          0xE3BC4595UL, 0xA67BC883UL, 0xB17F37D1UL, 0x018CFF28UL,
122          0xC332DDEFUL, 0xBE6C5AA5UL, 0x65582185UL, 0x68AB9802UL,
123          0xEECEA50FUL, 0xDB2F953BUL, 0x2AEF7DADUL, 0x5B6E2F84UL,
124          0x1521B628UL, 0x29076170UL, 0xECDD4775UL, 0x619F1510UL,
125          0x13CCA830UL, 0xEB61BD96UL, 0x0334FE1EUL, 0xAA0363CFUL,
126          0xB5735C90UL, 0x4C70A239UL, 0xD59E9E0BUL, 0xCBAADE14UL,
127          0xEECC86BCUL, 0x60622CA7UL, 0x9CAB5CABUL, 0xB2F3846EUL,
128          0x648B1EAFUL, 0x19BDF0CAUL, 0xA02369B9UL, 0x655ABB50UL,
129          0x40685A32UL, 0x3C2AB4B3UL, 0x319EE9D5UL, 0xC021B8F7UL,
130          0x9B540B19UL, 0x875FA099UL, 0x95F7997EUL, 0x623D7DA8UL,
131          0xF837889AUL, 0x97E32D77UL, 0x11ED935FUL, 0x16681281UL,
132          0x0E358829UL, 0xC7E61FD6UL, 0x96DEDFA1UL, 0x7858BA99UL,
133          0x57F584A5UL, 0x1B227263UL, 0x9B83C3FFUL, 0x1AC24696UL,
134          0xCDB30AEBUL, 0x532E3054UL, 0x8FD948E4UL, 0x6DBC3128UL,
135          0x58EBF2EFUL, 0x34C6FFEAUL, 0xFE28ED61UL, 0xEE7C3C73UL,
136          0x5D4A14D9UL, 0xE864B7E3UL, 0x42105D14UL, 0x203E13E0UL,
137          0x45EEE2B6UL, 0xA3AAABEAUL, 0xDB6C4F15UL, 0xFACB4FD0UL,
138          0xC742F442UL, 0xEF6ABBB5UL, 0x654F3B1DUL, 0x41CD2105UL,
139          0xD81E799EUL, 0x86854DC7UL, 0xE44B476AUL, 0x3D816250UL,
140          0xCF62A1F2UL, 0x5B8D2646UL, 0xFC8883A0UL, 0xC1C7B6A3UL,
141          0x7F1524C3UL, 0x69CB7492UL, 0x47848A0BUL, 0x5692B285UL,
142          0x095BBF00UL, 0xAD19489DUL, 0x1462B174UL, 0x23820E00UL,
143          0x58428D2AUL, 0x0C55F5EAUL, 0x1DADF43EUL, 0x233F7061UL,
144          0x3372F092UL, 0x8D937E41UL, 0xD65FECF1UL, 0x6C223BDBUL,
145          0x7CDE3759UL, 0xCBEE7460UL, 0x4085F2A7UL, 0xCE77326EUL,
146          0xA6078084UL, 0x19F8509EUL, 0xE8EFD855UL, 0x61D99735UL,
147          0xA969A7AAUL, 0xC50C06C2UL, 0x5A04ABFCUL, 0x800BCADCUL,
148          0x9E447A2EUL, 0xC3453484UL, 0xFDD56705UL, 0x0E1E9EC9UL,
149          0xDB73DBD3UL, 0x105588CDUL, 0x675FDA79UL, 0xE3674340UL,
150          0xC5C43465UL, 0x713E38D8UL, 0x3D28F89EUL, 0xF16DFF20UL,
151          0x153E21E7UL, 0x8FB03D4AUL, 0xE6E39F2BUL, 0xDB83ADF7UL   },
152      {   0xE93D5A68UL, 0x948140F7UL, 0xF64C261CUL, 0x94692934UL,
153          0x411520F7UL, 0x7602D4F7UL, 0xBCF46B2EUL, 0xD4A20068UL,
154          0xD4082471UL, 0x3320F46AUL, 0x43B7D4B7UL, 0x500061AFUL,
155          0x1E39F62EUL, 0x97244546UL, 0x14214F74UL, 0xBF8B8840UL,
156          0x4D95FC1DUL, 0x96B591AFUL, 0x70F4DDD3UL, 0x66A02F45UL,
157          0xBFBC09ECUL, 0x03BD9785UL, 0x7FAC6DD0UL, 0x31CB8504UL,
158          0x96EB27B3UL, 0x55FD3941UL, 0xDA2547E6UL, 0xABCA0A9AUL,
159          0x28507825UL, 0x530429F4UL, 0x0A2C86DAUL, 0xE9B66DFBUL,
160          0x68DC1462UL, 0xD7486900UL, 0x680EC0A4UL, 0x27A18DEEUL,
161          0x4F3FFEA2UL, 0xE887AD8CUL, 0xB58CE006UL, 0x7AF4D6B6UL,
162          0xAACE1E7CUL, 0xD3375FECUL, 0xCE78A399UL, 0x406B2A42UL,
163          0x20FE9E35UL, 0xD9F385B9UL, 0xEE39D7ABUL, 0x3B124E8BUL,
164          0x1DC9FAF7UL, 0x4B6D1856UL, 0x26A36631UL, 0xEAE397B2UL,
165          0x3A6EFA74UL, 0xDD5B4332UL, 0x6841E7F7UL, 0xCA7820FBUL,
166          0xFB0AF54EUL, 0xD8FEB397UL, 0x454056ACUL, 0xBA489527UL,
167          0x55533A3AUL, 0x20838D87UL, 0xFE6BA9B7UL, 0xD096954BUL,
168          0x55A867BCUL, 0xA1159A58UL, 0xCCA92963UL, 0x99E1DB33UL,
169          0xA62A4A56UL, 0x3F3125F9UL, 0x5EF47E1CUL, 0x9029317CUL,
170          0xFDF8E802UL, 0x04272F70UL, 0x80BB155CUL, 0x05282CE3UL,
171          0x95C11548UL, 0xE4C66D22UL, 0x48C1133FUL, 0xC70F86DCUL,
172          0x07F9C9EEUL, 0x41041F0FUL, 0x404779A4UL, 0x5D886E17UL,
173          0x325F51EBUL, 0xD59BC0D1UL, 0xF2BCC18FUL, 0x41113564UL,
174          0x257B7834UL, 0x602A9C60UL, 0xDFF8E8A3UL, 0x1F636C1BUL,
175          0x0E12B4C2UL, 0x02E1329EUL, 0xAF664FD1UL, 0xCAD18115UL,
176          0x6B2395E0UL, 0x333E92E1UL, 0x3B240B62UL, 0xEEBEB922UL,
177          0x85B2A20EUL, 0xE6BA0D99UL, 0xDE720C8CUL, 0x2DA2F728UL,
178          0xD0127845UL, 0x95B794FDUL, 0x647D0862UL, 0xE7CCF5F0UL,
179          0x5449A36FUL, 0x877D48FAUL, 0xC39DFD27UL, 0xF33E8D1EUL,
180          0x0A476341UL, 0x992EFF74UL, 0x3A6F6EABUL, 0xF4F8FD37UL,
181          0xA812DC60UL, 0xA1EBDDF8UL, 0x991BE14CUL, 0xDB6E6B0DUL,
182          0xC67B5510UL, 0x6D672C37UL, 0x2765D43BUL, 0xDCD0E804UL,
183          0xF1290DC7UL, 0xCC00FFA3UL, 0xB5390F92UL, 0x690FED0BUL,
184          0x667B9FFBUL, 0xCEDB7D9CUL, 0xA091CF0BUL, 0xD9155EA3UL,
185          0xBB132F88UL, 0x515BAD24UL, 0x7B9479BFUL, 0x763BD6EBUL,
186          0x37392EB3UL, 0xCC115979UL, 0x8026E297UL, 0xF42E312DUL,
187          0x6842ADA7UL, 0xC66A2B3BUL, 0x12754CCCUL, 0x782EF11CUL,
188          0x6A124237UL, 0xB79251E7UL, 0x06A1BBE6UL, 0x4BFB6350UL,
189          0x1A6B1018UL, 0x11CAEDFAUL, 0x3D25BDD8UL, 0xE2E1C3C9UL,
190          0x44421659UL, 0x0A121386UL, 0xD90CEC6EUL, 0xD5ABEA2AUL,
191          0x64AF674EUL, 0xDA86A85FUL, 0xBEBFE988UL, 0x64E4C3FEUL,
192          0x9DBC8057UL, 0xF0F7C086UL, 0x60787BF8UL, 0x6003604DUL,
193          0xD1FD8346UL, 0xF6381FB0UL, 0x7745AE04UL, 0xD736FCCCUL,
194          0x83426B33UL, 0xF01EAB71UL, 0xB0804187UL, 0x3C005E5FUL,
195          0x77A057BEUL, 0xBDE8AE24UL, 0x55464299UL, 0xBF582E61UL,
196          0x4E58F48FUL, 0xF2DDFDA2UL, 0xF474EF38UL, 0x8789BDC2UL,
197          0x5366F9C3UL, 0xC8B38E74UL, 0xB475F255UL, 0x46FCD9B9UL,
198          0x7AEB2661UL, 0x8B1DDF84UL, 0x846A0E79UL, 0x915F95E2UL,
199          0x466E598EUL, 0x20B45770UL, 0x8CD55591UL, 0xC902DE4CUL,
200          0xB90BACE1UL, 0xBB8205D0UL, 0x11A86248UL, 0x7574A99EUL,
201          0xB77F19B6UL, 0xE0A9DC09UL, 0x662D09A1UL, 0xC4324633UL,
202          0xE85A1F02UL, 0x09F0BE8CUL, 0x4A99A025UL, 0x1D6EFE10UL,
203          0x1AB93D1DUL, 0x0BA5A4DFUL, 0xA186F20FUL, 0x2868F169UL,
204          0xDCB7DA83UL, 0x573906FEUL, 0xA1E2CE9BUL, 0x4FCD7F52UL,
205          0x50115E01UL, 0xA70683FAUL, 0xA002B5C4UL, 0x0DE6D027UL,
206          0x9AF88C27UL, 0x773F8641UL, 0xC3604C06UL, 0x61A806B5UL,
207          0xF0177A28UL, 0xC0F586E0UL, 0x006058AAUL, 0x30DC7D62UL,
208          0x11E69ED7UL, 0x2338EA63UL, 0x53C2DD94UL, 0xC2C21634UL,
209          0xBBCBEE56UL, 0x90BCB6DEUL, 0xEBFC7DA1UL, 0xCE591D76UL,
210          0x6F05E409UL, 0x4B7C0188UL, 0x39720A3DUL, 0x7C927C24UL,
211          0x86E3725FUL, 0x724D9DB9UL, 0x1AC15BB4UL, 0xD39EB8FCUL,
212          0xED545578UL, 0x08FCA5B5UL, 0xD83D7CD3UL, 0x4DAD0FC4UL,
213          0x1E50EF5EUL, 0xB161E6F8UL, 0xA28514D9UL, 0x6C51133CUL,
214          0x6FD5C7E7UL, 0x56E14EC4UL, 0x362ABFCEUL, 0xDDC6C837UL,
215          0xD79A3234UL, 0x92638212UL, 0x670EFA8EUL, 0x406000E0UL  },
216      {   0x3A39CE37UL, 0xD3FAF5CFUL, 0xABC27737UL, 0x5AC52D1BUL,
217          0x5CB0679EUL, 0x4FA33742UL, 0xD3822740UL, 0x99BC9BBEUL,
218          0xD5118E9DUL, 0xBF0F7315UL, 0xD62D1C7EUL, 0xC700C47BUL,
219          0xB78C1B6BUL, 0x21A19045UL, 0xB26EB1BEUL, 0x6A366EB4UL,
220          0x5748AB2FUL, 0xBC946E79UL, 0xC6A376D2UL, 0x6549C2C8UL,
221          0x530FF8EEUL, 0x468DDE7DUL, 0xD5730A1DUL, 0x4CD04DC6UL,
222          0x2939BBDBUL, 0xA9BA4650UL, 0xAC9526E8UL, 0xBE5EE304UL,
223          0xA1FAD5F0UL, 0x6A2D519AUL, 0x63EF8CE2UL, 0x9A86EE22UL,
224          0xC089C2B8UL, 0x43242EF6UL, 0xA51E03AAUL, 0x9CF2D0A4UL,
225          0x83C061BAUL, 0x9BE96A4DUL, 0x8FE51550UL, 0xBA645BD6UL,
226          0x2826A2F9UL, 0xA73A3AE1UL, 0x4BA99586UL, 0xEF5562E9UL,
227          0xC72FEFD3UL, 0xF752F7DAUL, 0x3F046F69UL, 0x77FA0A59UL,
228          0x80E4A915UL, 0x87B08601UL, 0x9B09E6ADUL, 0x3B3EE593UL,
229          0xE990FD5AUL, 0x9E34D797UL, 0x2CF0B7D9UL, 0x022B8B51UL,
230          0x96D5AC3AUL, 0x017DA67DUL, 0xD1CF3ED6UL, 0x7C7D2D28UL,
231          0x1F9F25CFUL, 0xADF2B89BUL, 0x5AD6B472UL, 0x5A88F54CUL,
232          0xE029AC71UL, 0xE019A5E6UL, 0x47B0ACFDUL, 0xED93FA9BUL,
233          0xE8D3C48DUL, 0x283B57CCUL, 0xF8D56629UL, 0x79132E28UL,
234          0x785F0191UL, 0xED756055UL, 0xF7960E44UL, 0xE3D35E8CUL,
235          0x15056DD4UL, 0x88F46DBAUL, 0x03A16125UL, 0x0564F0BDUL,
236          0xC3EB9E15UL, 0x3C9057A2UL, 0x97271AECUL, 0xA93A072AUL,
237          0x1B3F6D9BUL, 0x1E6321F5UL, 0xF59C66FBUL, 0x26DCF319UL,
238          0x7533D928UL, 0xB155FDF5UL, 0x03563482UL, 0x8ABA3CBBUL,
239          0x28517711UL, 0xC20AD9F8UL, 0xABCC5167UL, 0xCCAD925FUL,
240          0x4DE81751UL, 0x3830DC8EUL, 0x379D5862UL, 0x9320F991UL,
241          0xEA7A90C2UL, 0xFB3E7BCEUL, 0x5121CE64UL, 0x774FBE32UL,
242          0xA8B6E37EUL, 0xC3293D46UL, 0x48DE5369UL, 0x6413E680UL,
243          0xA2AE0810UL, 0xDD6DB224UL, 0x69852DFDUL, 0x09072166UL,
244          0xB39A460AUL, 0x6445C0DDUL, 0x586CDECFUL, 0x1C20C8AEUL,
245          0x5BBEF7DDUL, 0x1B588D40UL, 0xCCD2017FUL, 0x6BB4E3BBUL,
246          0xDDA26A7EUL, 0x3A59FF45UL, 0x3E350A44UL, 0xBCB4CDD5UL,
247          0x72EACEA8UL, 0xFA6484BBUL, 0x8D6612AEUL, 0xBF3C6F47UL,
248          0xD29BE463UL, 0x542F5D9EUL, 0xAEC2771BUL, 0xF64E6370UL,
249          0x740E0D8DUL, 0xE75B1357UL, 0xF8721671UL, 0xAF537D5DUL,
250          0x4040CB08UL, 0x4EB4E2CCUL, 0x34D2466AUL, 0x0115AF84UL,
251          0xE1B00428UL, 0x95983A1DUL, 0x06B89FB4UL, 0xCE6EA048UL,
252          0x6F3F3B82UL, 0x3520AB82UL, 0x011A1D4BUL, 0x277227F8UL,
253          0x611560B1UL, 0xE7933FDCUL, 0xBB3A792BUL, 0x344525BDUL,
254          0xA08839E1UL, 0x51CE794BUL, 0x2F32C9B7UL, 0xA01FBAC9UL,
255          0xE01CC87EUL, 0xBCC7D1F6UL, 0xCF0111C3UL, 0xA1E8AAC7UL,
256          0x1A908749UL, 0xD44FBD9AUL, 0xD0DADECBUL, 0xD50ADA38UL,
257          0x0339C32AUL, 0xC6913667UL, 0x8DF9317CUL, 0xE0B12B4FUL,
258          0xF79E59B7UL, 0x43F5BB3AUL, 0xF2D519FFUL, 0x27D9459CUL,
259          0xBF97222CUL, 0x15E6FC2AUL, 0x0F91FC71UL, 0x9B941525UL,
260          0xFAE59361UL, 0xCEB69CEBUL, 0xC2A86459UL, 0x12BAA8D1UL,
261          0xB6C1075EUL, 0xE3056A0CUL, 0x10D25065UL, 0xCB03A442UL,
262          0xE0EC6E0EUL, 0x1698DB3BUL, 0x4C98A0BEUL, 0x3278E964UL,
263          0x9F1F9532UL, 0xE0D392DFUL, 0xD3A0342BUL, 0x8971F21EUL,
264          0x1B0A7441UL, 0x4BA3348CUL, 0xC5BE7120UL, 0xC37632D8UL,
265          0xDF359F8DUL, 0x9B992F2EUL, 0xE60B6F47UL, 0x0FE3F11DUL,
266          0xE54CDA54UL, 0x1EDAD891UL, 0xCE6279CFUL, 0xCD3E7E6FUL,
267          0x1618B166UL, 0xFD2C1D05UL, 0x848FD2C5UL, 0xF6FB2299UL,
268          0xF523F357UL, 0xA6327623UL, 0x93A83531UL, 0x56CCCD02UL,
269          0xACF08162UL, 0x5A75EBB5UL, 0x6E163697UL, 0x88D273CCUL,
270          0xDE966292UL, 0x81B949D0UL, 0x4C50901BUL, 0x71C65614UL,
271          0xE6C6C7BDUL, 0x327A140AUL, 0x45E1D006UL, 0xC3F27B9AUL,
272          0xC9AA53FDUL, 0x62A80F00UL, 0xBB25BFE2UL, 0x35BDD2F6UL,
273          0x71126905UL, 0xB2040222UL, 0xB6CBCF7CUL, 0xCD769C2BUL,
274          0x53113EC0UL, 0x1640E3D3UL, 0x38ABBD60UL, 0x2547ADF0UL,
275          0xBA38209CUL, 0xF746CE76UL, 0x77AFA1C5UL, 0x20756060UL,
276          0x85CBFE4EUL, 0x8AE88DD8UL, 0x7AAAF9B0UL, 0x4CF9AA7EUL,
277          0x1948C25CUL, 0x02FB8A8CUL, 0x01C36AE4UL, 0xD6EBE1F9UL,
278          0x90D4F869UL, 0xA65CDEA0UL, 0x3F09252DUL, 0xC208E69FUL,
279          0xB74E6132UL, 0xCE77E25BUL, 0x578FDFE3UL, 0x3AC372E6UL  }
280  };
281  #ifndef __GNUC__
282  #define F(x) ((S1[LTC_BYTE(x,3)] + S2[LTC_BYTE(x,2)]) ^ S3[LTC_BYTE(x,1)]) + S4[LTC_BYTE(x,0)]
283  #else
284  #define F(x) ((skey->blowfish.S[0][LTC_BYTE(x,3)] + skey->blowfish.S[1][LTC_BYTE(x,2)]) ^ skey->blowfish.S[2][LTC_BYTE(x,1)]) + skey->blowfish.S[3][LTC_BYTE(x,0)]
285  #endif
286  static void s_blowfish_encipher(ulong32 *L, ulong32 *R, const symmetric_key *skey)
287  {
288     int rounds;
289     ulong32 l, r;
290  #ifndef __GNUC__
291     const ulong32 *S1, *S2, *S3, *S4;
292     S1 = skey->blowfish.S[0];
293     S2 = skey->blowfish.S[1];
294     S3 = skey->blowfish.S[2];
295     S4 = skey->blowfish.S[3];
296  #endif
297     l = *L;
298     r = *R;
299     for (rounds = 0; rounds < 16; ) {
300        l ^= skey->blowfish.K[rounds++];  r ^= F(l);
301        r ^= skey->blowfish.K[rounds++];  l ^= F(r);
302        l ^= skey->blowfish.K[rounds++];  r ^= F(l);
303        r ^= skey->blowfish.K[rounds++];  l ^= F(r);
304     }
305     l ^= skey->blowfish.K[16];
306     r ^= skey->blowfish.K[17];
307     *L = r;
308     *R = l;
309  }
310  void blowfish_enc(ulong32 *data, unsigned long blocks, const symmetric_key *skey)
311  {
312     unsigned long i;
313     ulong32 *d = data;
314     for (i = 0; i < blocks; ++i) {
315        s_blowfish_encipher(d, d + 1, skey);
316        d += 2;
317     }
318  }
319  static ulong32 s_blowfish_stream2word(const unsigned char *d, int dlen, int *cur)
320  {
321     unsigned int z;
322     int y = *cur;
323     ulong32 ret = 0;
324     for (z = 0; z < 4; z++) {
325         ret = (ret << 8) | ((ulong32)d[y++] & 255);
326         if (y == dlen) {
327            y = 0;
328         }
329     }
330     *cur = y;
331     return ret;
332  }
333  int blowfish_expand(const unsigned char *key, int keylen,
334                      const unsigned char *data, int datalen,
335                      symmetric_key *skey)
336  {
337     ulong32 x, y, A, B[2];
338     int i;
339     LTC_ARGCHK(key != NULL);
340     LTC_ARGCHK(skey != NULL);
341     i = 0;
342     for (x = 0; x < 18; x++) {
343         A = s_blowfish_stream2word(key, keylen, &i);
344         skey->blowfish.K[x] ^= A;
345     }
346     i = 0;
347     B[0] = 0;
348     B[1] = 0;
349     for (x = 0; x < 18; x += 2) {
350        if (data != NULL) {
351           B[0] ^= s_blowfish_stream2word(data, datalen, &i);
352           B[1] ^= s_blowfish_stream2word(data, datalen, &i);
353        }
354        s_blowfish_encipher(&B[0], &B[1], skey);
355        skey->blowfish.K[x] = B[0];
356        skey->blowfish.K[x+1] = B[1];
357     }
358     for (x = 0; x < 4; x++) {
359         for (y = 0; y < 256; y += 2) {
<span onclick='openModal()' class='match'>360            if (data != NULL) {
361               B[0] ^= s_blowfish_stream2word(data, datalen, &i);
362               B[1] ^= s_blowfish_stream2word(data, datalen, &i);
363            }
364            s_blowfish_encipher(&B[0], &B[1], skey);
365            skey->blowfish.S[x][y] = B[0];
366            skey->blowfish.S[x][y+1] = B[1];
367         }
368     }
</span>369  #ifdef LTC_CLEAN_STACK
370     zeromem(B, sizeof(B));
371  #endif
372     return CRYPT_OK;
373  }
374  int blowfish_setup(const unsigned char *key, int keylen, int num_rounds,
375                    symmetric_key *skey)
376  {
377     if (keylen < 8 || keylen > 56) {
378        return CRYPT_INVALID_KEYSIZE;
379     }
380     if (num_rounds != 0 && num_rounds != 16) {
381        return CRYPT_INVALID_ROUNDS;
382     }
383     return blowfish_setup_with_data(key, keylen, NULL, 0, skey);
384  }
385  int blowfish_setup_with_data(const unsigned char *key, int keylen,
386                               const unsigned char *data, int datalen,
387                               symmetric_key *skey)
388  {
389     XMEMCPY(skey->blowfish.K, ORIG_P, sizeof(ORIG_P));
390     XMEMCPY(skey->blowfish.S, ORIG_S, sizeof(ORIG_S));
391     return blowfish_expand(key, keylen, data, datalen, skey);
392  }
393  #ifdef LTC_CLEAN_STACK
394  static int s_blowfish_ecb_encrypt(const unsigned char *pt, unsigned char *ct, const symmetric_key *skey)
395  #else
396  int blowfish_ecb_encrypt(const unsigned char *pt, unsigned char *ct, const symmetric_key *skey)
397  #endif
398  {
399     ulong32 L, R;
400     LTC_ARGCHK(pt   != NULL);
401     LTC_ARGCHK(ct   != NULL);
402     LTC_ARGCHK(skey != NULL);
403     LOAD32H(L, &pt[0]);
404     LOAD32H(R, &pt[4]);
405     s_blowfish_encipher(&L, &R, skey);
406     STORE32H(L, &ct[0]);
407     STORE32H(R, &ct[4]);
408     return CRYPT_OK;
409  }
410  #ifdef LTC_CLEAN_STACK
411  int blowfish_ecb_encrypt(const unsigned char *pt, unsigned char *ct, const symmetric_key *skey)
412  {
413      int err = s_blowfish_ecb_encrypt(pt, ct, skey);
414      burn_stack(sizeof(ulong32) * 2 + sizeof(int));
415      return err;
416  }
417  #endif
418  #ifdef LTC_CLEAN_STACK
419  static int s_blowfish_ecb_decrypt(const unsigned char *ct, unsigned char *pt, const symmetric_key *skey)
420  #else
421  int blowfish_ecb_decrypt(const unsigned char *ct, unsigned char *pt, const symmetric_key *skey)
422  #endif
423  {
424     ulong32 L, R;
425     int r;
426  #ifndef __GNUC__
427     const ulong32 *S1, *S2, *S3, *S4;
428  #endif
429      LTC_ARGCHK(pt   != NULL);
430      LTC_ARGCHK(ct   != NULL);
431      LTC_ARGCHK(skey != NULL);
432  #ifndef __GNUC__
433      S1 = skey->blowfish.S[0];
434      S2 = skey->blowfish.S[1];
435      S3 = skey->blowfish.S[2];
436      S4 = skey->blowfish.S[3];
437  #endif
438     LOAD32H(R, &ct[0]);
439     LOAD32H(L, &ct[4]);
440     R ^= skey->blowfish.K[17];
441     L ^= skey->blowfish.K[16];
442     for (r = 15; r > 0; ) {
443        L ^= F(R); R ^= skey->blowfish.K[r--];
444        R ^= F(L); L ^= skey->blowfish.K[r--];
445        L ^= F(R); R ^= skey->blowfish.K[r--];
446        R ^= F(L); L ^= skey->blowfish.K[r--];
447     }
448     STORE32H(L, &pt[0]);
449     STORE32H(R, &pt[4]);
450     return CRYPT_OK;
451  }
452  #ifdef LTC_CLEAN_STACK
453  int blowfish_ecb_decrypt(const unsigned char *ct, unsigned char *pt, const symmetric_key *skey)
454  {
455      int err = s_blowfish_ecb_decrypt(ct, pt, skey);
456      burn_stack(sizeof(ulong32) * 2 + sizeof(int));
457      return err;
458  }
459  #endif
460  int blowfish_test(void)
461  {
462   #ifndef LTC_TEST
463      return CRYPT_NOP;
464   #else
465     int err;
466     symmetric_key key;
467     static const struct {
468            unsigned char key[8], pt[8], ct[8];
469     } tests[] = {
470         {
471             { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
472             { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
473             { 0x4E, 0xF9, 0x97, 0x45, 0x61, 0x98, 0xDD, 0x78}
474         },
475         {
476             { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF},
477             { 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF},
478             { 0x51, 0x86, 0x6F, 0xD5, 0xB8, 0x5E, 0xCB, 0x8A}
479         },
480         {
481             { 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
482             { 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01},
483             { 0x7D, 0x85, 0x6F, 0x9A, 0x61, 0x30, 0x63, 0xF2}
484         }
485     };
486     unsigned char tmp[2][8];
487     int x, y;
488     for (x = 0; x < (int)(sizeof(tests) / sizeof(tests[0])); x++) {
489        if ((err = blowfish_setup(tests[x].key, 8, 16, &key)) != CRYPT_OK) {
490           return err;
491        }
492        blowfish_ecb_encrypt(tests[x].pt, tmp[0], &key);
493        blowfish_ecb_decrypt(tmp[0], tmp[1], &key);
494        if ((compare_testvector(tmp[0], 8, tests[x].ct, 8, "Blowfish Encrypt", x) != 0) ||
495              (compare_testvector(tmp[1], 8, tests[x].pt, 8, "Blowfish Decrypt", x) != 0)) {
496           return CRYPT_FAIL_TESTVECTOR;
497        }
498        for (y = 0; y < 8; y++) tmp[0][y] = 0;
499        for (y = 0; y < 1000; y++) blowfish_ecb_encrypt(tmp[0], tmp[0], &key);
500        for (y = 0; y < 1000; y++) blowfish_ecb_decrypt(tmp[0], tmp[0], &key);
501        for (y = 0; y < 8; y++) if (tmp[0][y] != 0) return CRYPT_FAIL_TESTVECTOR;
502     }
503     return CRYPT_OK;
504   #endif
505  }
506  void blowfish_done(symmetric_key *skey)
507  {
508    LTC_UNUSED_PARAM(skey);
509  }
510  int blowfish_keysize(int *keysize)
511  {
512     LTC_ARGCHK(keysize != NULL);
513     if (*keysize < 8) {
514        return CRYPT_INVALID_KEYSIZE;
515     }
516     if (*keysize > 56) {
517        *keysize = 56;
518     }
519     return CRYPT_OK;
520  }
521  #endif
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from PINRemoteImage-MDEwOlJlcG9zaXRvcnkzOTUzNzEwMw==-flat-picture_tools_enc.c</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-blowfish.c</div>
                </div>
                <div class="column column_space"><pre><code>202        } else {
203          u_ptr += pic->uv_stride;
204          v_ptr += pic->uv_stride;
205        }
206        memset(a_ptr, 0xff, pic->width);  
207        a_ptr += pic->a_stride;
208        y_ptr += pic->y_stride;
209      }
210    } else {
</pre></code></div>
                <div class="column column_space"><pre><code>360            if (data != NULL) {
361               B[0] ^= s_blowfish_stream2word(data, datalen, &i);
362               B[1] ^= s_blowfish_stream2word(data, datalen, &i);
363            }
364            s_blowfish_encipher(&B[0], &B[1], skey);
365            skey->blowfish.S[x][y] = B[0];
366            skey->blowfish.S[x][y+1] = B[1];
367         }
368     }
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    