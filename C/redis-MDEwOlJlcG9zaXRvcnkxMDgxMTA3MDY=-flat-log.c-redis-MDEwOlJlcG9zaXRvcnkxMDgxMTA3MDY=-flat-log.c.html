
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 23, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>redis-MDEwOlJlcG9zaXRvcnkxMDgxMTA3MDY=-flat-log.c</h3>
            <pre><code>1  #include "test/jemalloc_test.h"
2  #include "jemalloc/internal/log.h"
3  static void
4  expect_no_logging(const char *names) {
5  	log_var_t log_l1 = LOG_VAR_INIT("l1");
6  	log_var_t log_l2 = LOG_VAR_INIT("l2");
7  	log_var_t log_l2_a = LOG_VAR_INIT("l2.a");
8  	strcpy(log_var_names, names);
9  	int count = 0;
10  	for (int i = 0; i < 10; i++) {
11  		log_do_begin(log_l1)
12  			count++;
13  		log_do_end(log_l1)
14  		log_do_begin(log_l2)
15  			count++;
16  		log_do_end(log_l2)
17  		log_do_begin(log_l2_a)
18  			count++;
19  		log_do_end(log_l2_a)
20  	}
21  	assert_d_eq(count, 0, "Disabled logging not ignored!");
22  }
23  TEST_BEGIN(test_log_disabled) {
24  	test_skip_if(!config_log);
25  	atomic_store_b(&log_init_done, true, ATOMIC_RELAXED);
26  	expect_no_logging("");
27  	expect_no_logging("abc");
28  	expect_no_logging("a.b.c");
29  	expect_no_logging("l12");
30  	expect_no_logging("l123|a456|b789");
31  	expect_no_logging("|||");
32  }
33  TEST_END
34  TEST_BEGIN(test_log_enabled_direct) {
35  	test_skip_if(!config_log);
36  	atomic_store_b(&log_init_done, true, ATOMIC_RELAXED);
37  	log_var_t log_l1 = LOG_VAR_INIT("l1");
38  	log_var_t log_l1_a = LOG_VAR_INIT("l1.a");
39  	log_var_t log_l2 = LOG_VAR_INIT("l2");
40  	int count;
41  	count = 0;
42  	strcpy(log_var_names, "l1");
43  	for (int i = 0; i < 10; i++) {
44  		log_do_begin(log_l1)
45  			count++;
46  		log_do_end(log_l1)
47  	}
48  	assert_d_eq(count, 10, "Mis-logged!");
49  	count = 0;
50  	strcpy(log_var_names, "l1.a");
51  	for (int i = 0; i < 10; i++) {
52  		log_do_begin(log_l1_a)
53  			count++;
54  		log_do_end(log_l1_a)
55  	}
56  	assert_d_eq(count, 10, "Mis-logged!");
57  	count = 0;
58  	strcpy(log_var_names, "l1.a|abc|l2|def");
59  	for (int i = 0; i < 10; i++) {
60  		log_do_begin(log_l1_a)
61  			count++;
62  		log_do_end(log_l1_a)
63  		log_do_begin(log_l2)
64  			count++;
65  		log_do_end(log_l2)
66  	}
67  	assert_d_eq(count, 20, "Mis-logged!");
68  }
69  TEST_END
70  TEST_BEGIN(test_log_enabled_indirect) {
71  	test_skip_if(!config_log);
72  	atomic_store_b(&log_init_done, true, ATOMIC_RELAXED);
73  	strcpy(log_var_names, "l0|l1|abc|l2.b|def");
74  	log_var_t log_l1 = LOG_VAR_INIT("l1");
75  	log_var_t log_l1a = LOG_VAR_INIT("l1a");
76  	log_var_t log_l1_a = LOG_VAR_INIT("l1.a");
77  	log_var_t log_l2_a = LOG_VAR_INIT("l2.a");
78  	log_var_t log_l2_b_a = LOG_VAR_INIT("l2.b.a");
79  	log_var_t log_l2_b_b = LOG_VAR_INIT("l2.b.b");
80  	int count = 0;
81  	for (int i = 0; i < 10; i++) {
82  		log_do_begin(log_l1)
83  			count++;
84  		log_do_end(log_l1)
85  		log_do_begin(log_l1a)
86  			count++;
87  		log_do_end(log_l1a)
88  		log_do_begin(log_l1_a)
89  			count++;
90  		log_do_end(log_l1_a)
91  		log_do_begin(log_l2_a)
92  			count++;
93  		log_do_end(log_l2_a)
94  		log_do_begin(log_l2_b_a)
95  			count++;
96  		log_do_end(log_l2_b_a)
97  		log_do_begin(log_l2_b_b)
98  			count++;
99  		log_do_end(log_l2_b_b)
100  	}
101  	assert_d_eq(count, 40, "Mis-logged!");
102  }
103  TEST_END
104  TEST_BEGIN(test_log_enabled_global) {
105  	test_skip_if(!config_log);
106  	atomic_store_b(&log_init_done, true, ATOMIC_RELAXED);
<span onclick='openModal()' class='match'>107  	strcpy(log_var_names, "abc|.|def");
108  	log_var_t log_l1 = LOG_VAR_INIT("l1");
109  	log_var_t log_l2_a_a = LOG_VAR_INIT("l2.a.a");
110  	int count = 0;
</span>111  	for (int i = 0; i < 10; i++) {
112  		log_do_begin(log_l1)
113  		    count++;
114  		log_do_end(log_l1)
115  		log_do_begin(log_l2_a_a)
116  		    count++;
117  		log_do_end(log_l2_a_a)
118  	}
119  	assert_d_eq(count, 20, "Mis-logged!");
120  }
121  TEST_END
122  TEST_BEGIN(test_logs_if_no_init) {
123  	test_skip_if(!config_log);
124  	atomic_store_b(&log_init_done, false, ATOMIC_RELAXED);
125  	log_var_t l = LOG_VAR_INIT("definitely.not.enabled");
126  	int count = 0;
127  	for (int i = 0; i < 10; i++) {
128  		log_do_begin(l)
129  			count++;
130  		log_do_end(l)
131  	}
132  	assert_d_eq(count, 0, "Logging shouldn't happen if not initialized.");
133  }
134  TEST_END
135  TEST_BEGIN(test_log_only_format_string) {
136  	if (false) {
137  		LOG("log_str", "No arguments follow this format string.");
138  	}
139  }
140  TEST_END
141  int
142  main(void) {
143  	return test(
144  	    test_log_disabled,
145  	    test_log_enabled_direct,
146  	    test_log_enabled_indirect,
147  	    test_log_enabled_global,
148  	    test_logs_if_no_init,
149  	    test_log_only_format_string);
150  }
</code></pre>
        </div>
        <div class="column">
            <h3>redis-MDEwOlJlcG9zaXRvcnkxMDgxMTA3MDY=-flat-log.c</h3>
            <pre><code>1  #include "test/jemalloc_test.h"
2  #include "jemalloc/internal/log.h"
3  static void
4  expect_no_logging(const char *names) {
5  	log_var_t log_l1 = LOG_VAR_INIT("l1");
6  	log_var_t log_l2 = LOG_VAR_INIT("l2");
7  	log_var_t log_l2_a = LOG_VAR_INIT("l2.a");
8  	strcpy(log_var_names, names);
9  	int count = 0;
10  	for (int i = 0; i < 10; i++) {
11  		log_do_begin(log_l1)
12  			count++;
13  		log_do_end(log_l1)
14  		log_do_begin(log_l2)
15  			count++;
16  		log_do_end(log_l2)
17  		log_do_begin(log_l2_a)
18  			count++;
19  		log_do_end(log_l2_a)
20  	}
21  	assert_d_eq(count, 0, "Disabled logging not ignored!");
22  }
23  TEST_BEGIN(test_log_disabled) {
24  	test_skip_if(!config_log);
25  	atomic_store_b(&log_init_done, true, ATOMIC_RELAXED);
26  	expect_no_logging("");
27  	expect_no_logging("abc");
28  	expect_no_logging("a.b.c");
29  	expect_no_logging("l12");
30  	expect_no_logging("l123|a456|b789");
31  	expect_no_logging("|||");
32  }
33  TEST_END
34  TEST_BEGIN(test_log_enabled_direct) {
35  	test_skip_if(!config_log);
36  	atomic_store_b(&log_init_done, true, ATOMIC_RELAXED);
37  	log_var_t log_l1 = LOG_VAR_INIT("l1");
38  	log_var_t log_l1_a = LOG_VAR_INIT("l1.a");
39  	log_var_t log_l2 = LOG_VAR_INIT("l2");
40  	int count;
41  	count = 0;
42  	strcpy(log_var_names, "l1");
43  	for (int i = 0; i < 10; i++) {
44  		log_do_begin(log_l1)
45  			count++;
46  		log_do_end(log_l1)
47  	}
48  	assert_d_eq(count, 10, "Mis-logged!");
49  	count = 0;
50  	strcpy(log_var_names, "l1.a");
51  	for (int i = 0; i < 10; i++) {
52  		log_do_begin(log_l1_a)
53  			count++;
54  		log_do_end(log_l1_a)
55  	}
56  	assert_d_eq(count, 10, "Mis-logged!");
57  	count = 0;
58  	strcpy(log_var_names, "l1.a|abc|l2|def");
59  	for (int i = 0; i < 10; i++) {
60  		log_do_begin(log_l1_a)
61  			count++;
62  		log_do_end(log_l1_a)
63  		log_do_begin(log_l2)
64  			count++;
65  		log_do_end(log_l2)
66  	}
67  	assert_d_eq(count, 20, "Mis-logged!");
68  }
69  TEST_END
70  TEST_BEGIN(test_log_enabled_indirect) {
71  	test_skip_if(!config_log);
72  	atomic_store_b(&log_init_done, true, ATOMIC_RELAXED);
73  	strcpy(log_var_names, "l0|l1|abc|l2.b|def");
74  	log_var_t log_l1 = LOG_VAR_INIT("l1");
75  	log_var_t log_l1a = LOG_VAR_INIT("l1a");
76  	log_var_t log_l1_a = LOG_VAR_INIT("l1.a");
77  	log_var_t log_l2_a = LOG_VAR_INIT("l2.a");
78  	log_var_t log_l2_b_a = LOG_VAR_INIT("l2.b.a");
79  	log_var_t log_l2_b_b = LOG_VAR_INIT("l2.b.b");
80  	int count = 0;
81  	for (int i = 0; i < 10; i++) {
82  		log_do_begin(log_l1)
83  			count++;
84  		log_do_end(log_l1)
85  		log_do_begin(log_l1a)
86  			count++;
87  		log_do_end(log_l1a)
88  		log_do_begin(log_l1_a)
89  			count++;
90  		log_do_end(log_l1_a)
91  		log_do_begin(log_l2_a)
92  			count++;
93  		log_do_end(log_l2_a)
94  		log_do_begin(log_l2_b_a)
95  			count++;
96  		log_do_end(log_l2_b_a)
97  		log_do_begin(log_l2_b_b)
98  			count++;
99  		log_do_end(log_l2_b_b)
100  	}
101  	assert_d_eq(count, 40, "Mis-logged!");
102  }
103  TEST_END
104  TEST_BEGIN(test_log_enabled_global) {
105  	test_skip_if(!config_log);
106  	atomic_store_b(&log_init_done, true, ATOMIC_RELAXED);
<span onclick='openModal()' class='match'>107  	strcpy(log_var_names, "abc|.|def");
108  	log_var_t log_l1 = LOG_VAR_INIT("l1");
109  	log_var_t log_l2_a_a = LOG_VAR_INIT("l2.a.a");
110  	int count = 0;
</span>111  	for (int i = 0; i < 10; i++) {
112  		log_do_begin(log_l1)
113  		    count++;
114  		log_do_end(log_l1)
115  		log_do_begin(log_l2_a_a)
116  		    count++;
117  		log_do_end(log_l2_a_a)
118  	}
119  	assert_d_eq(count, 20, "Mis-logged!");
120  }
121  TEST_END
122  TEST_BEGIN(test_logs_if_no_init) {
123  	test_skip_if(!config_log);
124  	atomic_store_b(&log_init_done, false, ATOMIC_RELAXED);
125  	log_var_t l = LOG_VAR_INIT("definitely.not.enabled");
126  	int count = 0;
127  	for (int i = 0; i < 10; i++) {
128  		log_do_begin(l)
129  			count++;
130  		log_do_end(l)
131  	}
132  	assert_d_eq(count, 0, "Logging shouldn't happen if not initialized.");
133  }
134  TEST_END
135  TEST_BEGIN(test_log_only_format_string) {
136  	if (false) {
137  		LOG("log_str", "No arguments follow this format string.");
138  	}
139  }
140  TEST_END
141  int
142  main(void) {
143  	return test(
144  	    test_log_disabled,
145  	    test_log_enabled_direct,
146  	    test_log_enabled_indirect,
147  	    test_log_enabled_global,
148  	    test_logs_if_no_init,
149  	    test_log_only_format_string);
150  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from redis-MDEwOlJlcG9zaXRvcnkxMDgxMTA3MDY=-flat-log.c</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from redis-MDEwOlJlcG9zaXRvcnkxMDgxMTA3MDY=-flat-log.c</div>
                </div>
                <div class="column column_space"><pre><code>107  	strcpy(log_var_names, "abc|.|def");
108  	log_var_t log_l1 = LOG_VAR_INIT("l1");
109  	log_var_t log_l2_a_a = LOG_VAR_INIT("l2.a.a");
110  	int count = 0;
</pre></code></div>
                <div class="column column_space"><pre><code>107  	strcpy(log_var_names, "abc|.|def");
108  	log_var_t log_l1 = LOG_VAR_INIT("l1");
109  	log_var_t log_l2_a_a = LOG_VAR_INIT("l2.a.a");
110  	int count = 0;
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    