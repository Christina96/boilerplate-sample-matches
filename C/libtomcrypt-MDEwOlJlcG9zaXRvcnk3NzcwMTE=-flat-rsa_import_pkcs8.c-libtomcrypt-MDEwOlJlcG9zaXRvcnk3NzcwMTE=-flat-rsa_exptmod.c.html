
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 18.939393939393938%, Tokens: 12</h2>
        <div class="column">
            <h3>libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-rsa_import_pkcs8.c</h3>
            <pre><code>1  #include "tomcrypt_private.h"
2  #ifdef LTC_MRSA
3  int rsa_import_pkcs8(const unsigned char *in, unsigned long inlen,
4                       const void *passwd, unsigned long passwdlen,
5                       rsa_key *key)
6  {
7     int           err;
8     unsigned char *buf1 = NULL, *buf2 = NULL;
9     unsigned long buf1len, buf2len;
10     unsigned long oid[16], version;
11     const char    *rsaoid;
12     ltc_asn1_list alg_seq[2], top_seq[3];
13     ltc_asn1_list *l = NULL;
14     unsigned char *decrypted = NULL;
15     unsigned long decryptedlen;
16     LTC_ARGCHK(in          != NULL);
17     LTC_ARGCHK(key         != NULL);
18     LTC_ARGCHK(ltc_mp.name != NULL);
19     err = pk_get_oid(LTC_OID_RSA, &rsaoid);
20     if (err != CRYPT_OK) { goto LBL_NOFREE; }
21     buf1len = inlen; &bsol;* approx. */
22     buf1 = XMALLOC(buf1len);
23     if (buf1 == NULL) { err = CRYPT_MEM; goto LBL_NOFREE; }
24     buf2len = inlen; &bsol;* approx. */
25     buf2 = XMALLOC(buf2len);
<span onclick='openModal()' class='match'>26     if (buf2 == NULL) { err = CRYPT_MEM; goto LBL_FREE1; }
27     if ((err = rsa_init(key)) != CRYPT_OK) { goto LBL_FREE2; }
28     if ((err = pkcs8_decode_flexi(in, inlen, passwd, passwdlen, &l)) != CRYPT_OK) {
29        goto LBL_ERR;
30     }
</span>31     decrypted    = l->data;
32     decryptedlen = l->size;
33     LTC_SET_ASN1(alg_seq, 0, LTC_ASN1_OBJECT_IDENTIFIER, oid, 16UL);
34     LTC_SET_ASN1(alg_seq, 1, LTC_ASN1_NULL, NULL, 0UL);
35     LTC_SET_ASN1(top_seq, 0, LTC_ASN1_SHORT_INTEGER, &version, 1UL);
36     LTC_SET_ASN1(top_seq, 1, LTC_ASN1_SEQUENCE, alg_seq, 2UL);
37     LTC_SET_ASN1(top_seq, 2, LTC_ASN1_OCTET_STRING, buf1, buf1len);
38     err=der_decode_sequence(decrypted, decryptedlen, top_seq, 3UL);
39     if (err != CRYPT_OK) { goto LBL_ERR; }
40     if ((err = pk_oid_cmp_with_asn1(rsaoid, &alg_seq[0])) != CRYPT_OK) {
41        goto LBL_ERR;
42     }
43     if ((err = rsa_import_pkcs1(buf1, top_seq[2].size, key)) != CRYPT_OK) {
44        goto LBL_ERR;
45     }
46     key->type = PK_PRIVATE;
47     err = CRYPT_OK;
48     goto LBL_FREE2;
49  LBL_ERR:
50     rsa_free(key);
51  LBL_FREE2:
52     if (l) der_free_sequence_flexi(l);
53     XFREE(buf2);
54  LBL_FREE1:
55     XFREE(buf1);
56  LBL_NOFREE:
57     return err;
58  }
59  #endif &bsol;* LTC_MRSA */
</code></pre>
        </div>
        <div class="column">
            <h3>libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-rsa_exptmod.c</h3>
            <pre><code>1  #include "tomcrypt_private.h"
2  #ifdef LTC_MRSA
3  int rsa_exptmod(const unsigned char *in,   unsigned long inlen,
4                        unsigned char *out,  unsigned long *outlen, int which,
5                  const rsa_key *key)
6  {
7     void        *tmp, *tmpa, *tmpb;
8     #ifdef LTC_RSA_BLINDING
9     void        *rnd, *rndi &bsol;* inverse of rnd */;
10     #endif
11     unsigned long x;
12     int           err, has_crt_parameters;
13     LTC_ARGCHK(in     != NULL);
14     LTC_ARGCHK(out    != NULL);
15     LTC_ARGCHK(outlen != NULL);
16     LTC_ARGCHK(key    != NULL);
17     if (which == PK_PRIVATE && (key->type != PK_PRIVATE)) {
18        return CRYPT_PK_NOT_PRIVATE;
19     }
20     if (which != PK_PRIVATE && which != PK_PUBLIC) {
21        return CRYPT_PK_INVALID_TYPE;
22     }
23     if ((err = mp_init_multi(&tmp, &tmpa, &tmpb,
24  #ifdef LTC_RSA_BLINDING
25                                                 &rnd, &rndi,
26  #endif &bsol;* LTC_RSA_BLINDING */
27                                                             NULL)) != CRYPT_OK)
28          { return err; }
29     if ((err = mp_read_unsigned_bin(tmp, (unsigned char *)in, (int)inlen)) != CRYPT_OK)
30          { goto error; }
31     if (mp_cmp(key->N, tmp) == LTC_MP_LT) {
32        err = CRYPT_PK_INVALID_SIZE;
33        goto error;
34     }
35     if (which == PK_PRIVATE) {
36        #ifdef LTC_RSA_BLINDING
37        err = mp_rand(rnd, mp_get_digit_count(key->N));
38        if (err != CRYPT_OK) {
39               goto error;
40        }
41        err = mp_invmod(rnd, key->N, rndi);
42        if (err != CRYPT_OK) {
43               goto error;
44        }
45        err = mp_exptmod( rnd, key->e, key->N, rnd);
46        if (err != CRYPT_OK) {
47               goto error;
48        }
49        err = mp_mulmod( tmp, rnd, key->N, tmp);
50        if (err != CRYPT_OK) {
51               goto error;
52        }
53        #endif &bsol;* LTC_RSA_BLINDING */
54        has_crt_parameters = (key->p != NULL) && (mp_get_digit_count(key->p) != 0) &&
55                                (key->q != NULL) && (mp_get_digit_count(key->q) != 0) &&
56                                   (key->dP != NULL) && (mp_get_digit_count(key->dP) != 0) &&
57                                      (key->dQ != NULL) && (mp_get_digit_count(key->dQ) != 0) &&
58                                         (key->qP != NULL) && (mp_get_digit_count(key->qP) != 0);
59        if (!has_crt_parameters) {
60           if ((err = mp_exptmod(tmp, key->d, key->N, tmp)) != CRYPT_OK)                              { goto error; }
61        } else {
62           if ((err = mp_exptmod(tmp, key->dP, key->p, tmpa)) != CRYPT_OK)                            { goto error; }
63           if ((err = mp_exptmod(tmp, key->dQ, key->q, tmpb)) != CRYPT_OK)                            { goto error; }
64           if ((err = mp_sub(tmpa, tmpb, tmp)) != CRYPT_OK)                                           { goto error; }
<span onclick='openModal()' class='match'>65           if ((err = mp_mulmod(tmp, key->qP, key->p, tmp)) != CRYPT_OK)                              { goto error; }
66           if ((err = mp_mul(tmp, key->q, tmp)) != CRYPT_OK)                                          { goto error; }
67           if ((err = mp_add(tmp, tmpb, tmp)) != CRYPT_OK)                                            { goto error; }
</span>68        }
69        #ifdef LTC_RSA_BLINDING
70        err = mp_mulmod( tmp, rndi, key->N, tmp);
71        if (err != CRYPT_OK) {
72               goto error;
73        }
74        #endif
75        #ifdef LTC_RSA_CRT_HARDENING
76        if (has_crt_parameters) {
77           if ((err = mp_exptmod(tmp, key->e, key->N, tmpa)) != CRYPT_OK)                              { goto error; }
78           if ((err = mp_read_unsigned_bin(tmpb, (unsigned char *)in, (int)inlen)) != CRYPT_OK)        { goto error; }
79           if (mp_cmp(tmpa, tmpb) != LTC_MP_EQ)                                     { err = CRYPT_ERROR; goto error; }
80        }
81        #endif
82     } else {
83        if ((err = mp_exptmod(tmp, key->e, key->N, tmp)) != CRYPT_OK)                                { goto error; }
84     }
85     x = (unsigned long)mp_unsigned_bin_size(key->N);
86     if (x > *outlen) {
87        *outlen = x;
88        err = CRYPT_BUFFER_OVERFLOW;
89        goto error;
90     }
91     if (mp_unsigned_bin_size(tmp) > mp_unsigned_bin_size(key->N)) {
92        err = CRYPT_ERROR;
93        goto error;
94     }
95     *outlen = x;
96     zeromem(out, x);
97     if ((err = mp_to_unsigned_bin(tmp, out+(x-mp_unsigned_bin_size(tmp)))) != CRYPT_OK)               { goto error; }
98     err = CRYPT_OK;
99  error:
100     mp_clear_multi(
101  #ifdef LTC_RSA_BLINDING
102                    rndi, rnd,
103  #endif &bsol;* LTC_RSA_BLINDING */
104                               tmpb, tmpa, tmp, NULL);
105     return err;
106  }
107  #endif
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-rsa_import_pkcs8.c</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-rsa_exptmod.c</div>
                </div>
                <div class="column column_space"><pre><code>26     if (buf2 == NULL) { err = CRYPT_MEM; goto LBL_FREE1; }
27     if ((err = rsa_init(key)) != CRYPT_OK) { goto LBL_FREE2; }
28     if ((err = pkcs8_decode_flexi(in, inlen, passwd, passwdlen, &l)) != CRYPT_OK) {
29        goto LBL_ERR;
30     }
</pre></code></div>
                <div class="column column_space"><pre><code>65           if ((err = mp_mulmod(tmp, key->qP, key->p, tmp)) != CRYPT_OK)                              { goto error; }
66           if ((err = mp_mul(tmp, key->q, tmp)) != CRYPT_OK)                                          { goto error; }
67           if ((err = mp_add(tmp, tmpb, tmp)) != CRYPT_OK)                                            { goto error; }
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    