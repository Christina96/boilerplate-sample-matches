
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 66, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-tomcrypt_pk.h</h3>
            <pre><code>1  enum public_key_type {
2     PK_PUBLIC      = 0x0000,
3     PK_PRIVATE     = 0x0001,
4     PK_STD         = 0x1000,
5     PK_COMPRESSED  = 0x2000,
6     PK_CURVEOID    = 0x4000
7  };
8  int rand_prime(void *N, long len, prng_state *prng, int wprng);
9  #ifdef LTC_MRSA
10  typedef struct Rsa_key {
11      int type;
12      void *e;
13      void *d;
14      void *N;
15      void *p;
16      void *q;
17      void *qP;
18      void *dP;
19      void *dQ;
20  } rsa_key;
21  int rsa_make_key(prng_state *prng, int wprng, int size, long e, rsa_key *key);
22  int rsa_make_key_ubin_e(prng_state *prng, int wprng, int size,
23                          const unsigned char *e, unsigned long elen, rsa_key *key);
24  int rsa_get_size(const rsa_key *key);
25  int rsa_exptmod(const unsigned char *in,   unsigned long inlen,
26                        unsigned char *out,  unsigned long *outlen, int which,
27                  const rsa_key *key);
28  void rsa_free(rsa_key *key);
29  #define rsa_encrypt_key(in, inlen, out, outlen, lparam, lparamlen, prng, prng_idx, hash_idx, key) \
30    rsa_encrypt_key_ex(in, inlen, out, outlen, lparam, lparamlen, prng, prng_idx, hash_idx, LTC_PKCS_1_OAEP, key)
31  #define rsa_decrypt_key(in, inlen, out, outlen, lparam, lparamlen, hash_idx, stat, key) \
32    rsa_decrypt_key_ex(in, inlen, out, outlen, lparam, lparamlen, hash_idx, LTC_PKCS_1_OAEP, stat, key)
33  #define rsa_sign_hash(in, inlen, out, outlen, prng, prng_idx, hash_idx, saltlen, key) \
34    rsa_sign_hash_ex(in, inlen, out, outlen, LTC_PKCS_1_PSS, prng, prng_idx, hash_idx, saltlen, key)
35  #define rsa_verify_hash(sig, siglen, hash, hashlen, hash_idx, saltlen, stat, key) \
36    rsa_verify_hash_ex(sig, siglen, hash, hashlen, LTC_PKCS_1_PSS, hash_idx, saltlen, stat, key)
37  #define rsa_sign_saltlen_get_max(hash_idx, key) \
38    rsa_sign_saltlen_get_max_ex(LTC_PKCS_1_PSS, hash_idx, key)
39  int rsa_encrypt_key_ex(const unsigned char *in,       unsigned long  inlen,
40                               unsigned char *out,      unsigned long *outlen,
41                         const unsigned char *lparam,   unsigned long  lparamlen,
42                               prng_state    *prng,     int            prng_idx,
43                               int            hash_idx, int            padding,
44                         const rsa_key       *key);
45  int rsa_decrypt_key_ex(const unsigned char *in,             unsigned long  inlen,
46                               unsigned char *out,            unsigned long *outlen,
47                         const unsigned char *lparam,         unsigned long  lparamlen,
48                               int            hash_idx,       int            padding,
49                               int           *stat,     const rsa_key       *key);
50  int rsa_sign_hash_ex(const unsigned char *in,       unsigned long  inlen,
51                             unsigned char *out,      unsigned long *outlen,
52                             int            padding,
53                             prng_state    *prng,     int            prng_idx,
54                             int            hash_idx, unsigned long  saltlen,
55                       const rsa_key       *key);
56  int rsa_verify_hash_ex(const unsigned char *sig,            unsigned long  siglen,
57                         const unsigned char *hash,           unsigned long  hashlen,
58                               int            padding,
59                               int            hash_idx,       unsigned long  saltlen,
60                               int           *stat,     const rsa_key       *key);
61  int rsa_sign_saltlen_get_max_ex(int padding, int hash_idx, const rsa_key *key);
62  int rsa_export(unsigned char *out, unsigned long *outlen, int type, const rsa_key *key);
63  int rsa_import(const unsigned char *in, unsigned long inlen, rsa_key *key);
64  int rsa_import_x509(const unsigned char *in, unsigned long inlen, rsa_key *key);
65  int rsa_import_pkcs8(const unsigned char *in, unsigned long inlen,
66                       const void *passwd, unsigned long passwdlen, rsa_key *key);
67  int rsa_set_key(const unsigned char *N,  unsigned long Nlen,
68                  const unsigned char *e,  unsigned long elen,
69                  const unsigned char *d,  unsigned long dlen,
70                  rsa_key *key);
71  int rsa_set_factors(const unsigned char *p,  unsigned long plen,
72                      const unsigned char *q,  unsigned long qlen,
73                      rsa_key *key);
74  int rsa_set_crt_params(const unsigned char *dP, unsigned long dPlen,
75                         const unsigned char *dQ, unsigned long dQlen,
76                         const unsigned char *qP, unsigned long qPlen,
77                         rsa_key *key);
78  #endif
79  #ifdef LTC_MDH
80  typedef struct {
81      int type;
82      void *x;
83      void *y;
84      void *base;
85      void *prime;
86  } dh_key;
87  int dh_get_groupsize(const dh_key *key);
88  int dh_export(unsigned char *out, unsigned long *outlen, int type, const dh_key *key);
89  int dh_import(const unsigned char *in, unsigned long inlen, dh_key *key);
90  int dh_set_pg(const unsigned char *p, unsigned long plen,
91                const unsigned char *g, unsigned long glen,
92                dh_key *key);
93  int dh_set_pg_dhparam(const unsigned char *dhparam, unsigned long dhparamlen, dh_key *key);
94  int dh_set_pg_groupsize(int groupsize, dh_key *key);
95  int dh_set_key(const unsigned char *in, unsigned long inlen, int type, dh_key *key);
96  int dh_generate_key(prng_state *prng, int wprng, dh_key *key);
97  int dh_shared_secret(const dh_key  *private_key, const dh_key  *public_key,
98                       unsigned char *out,         unsigned long *outlen);
99  void dh_free(dh_key *key);
100  int dh_export_key(void *out, unsigned long *outlen, int type, const dh_key *key);
101  #endif &bsol;* LTC_MDH */
102  #ifdef LTC_MECC
103  #define ECC_BUF_SIZE 256
104  #define ECC_MAXSIZE  66
105  typedef struct {
106     const char *prime;
107     const char *A;
108     const char *B;
109     const char *order;
110     const char *Gx;
111     const char *Gy;
112     unsigned long cofactor;
113     const char *OID;
114  } ltc_ecc_curve;
115  typedef struct {
116      void *x;
117      void *y;
118      void *z;
119  } ecc_point;
120  typedef struct {
121     int size;
122     void *prime;
123     void *A;
124     void *B;
125     void *order;
126     ecc_point base;
127     unsigned long cofactor;
128     unsigned long oid[16];
129     unsigned long oidlen;
130  } ltc_ecc_dp;
131  typedef struct {
132      int type;
133      ltc_ecc_dp dp;
134      ecc_point pubkey;
135      void *k;
136  } ecc_key;
137  typedef enum ecc_signature_type_ {
138     LTC_ECCSIG_ANSIX962   = 0x0,
139     LTC_ECCSIG_RFC7518    = 0x1,
140     LTC_ECCSIG_ETH27      = 0x2,
141     LTC_ECCSIG_RFC5656    = 0x3,
142  } ecc_signature_type;
143  extern const ltc_ecc_curve ltc_ecc_curves[];
144  void ecc_sizes(int *low, int *high);
145  int  ecc_get_size(const ecc_key *key);
146  int  ecc_find_curve(const char* name_or_oid, const ltc_ecc_curve** cu);
147  int  ecc_set_curve(const ltc_ecc_curve *cu, ecc_key *key);
148  int  ecc_generate_key(prng_state *prng, int wprng, ecc_key *key);
149  int  ecc_set_key(const unsigned char *in, unsigned long inlen, int type, ecc_key *key);
150  int  ecc_get_key(unsigned char *out, unsigned long *outlen, int type, const ecc_key *key);
151  int  ecc_get_oid_str(char *out, unsigned long *outlen, const ecc_key *key);
152  int  ecc_make_key(prng_state *prng, int wprng, int keysize, ecc_key *key);
153  int  ecc_make_key_ex(prng_state *prng, int wprng, ecc_key *key, const ltc_ecc_curve *cu);
154  void ecc_free(ecc_key *key);
155  int  ecc_export(unsigned char *out, unsigned long *outlen, int type, const ecc_key *key);
156  int  ecc_import(const unsigned char *in, unsigned long inlen, ecc_key *key);
157  int  ecc_import_ex(const unsigned char *in, unsigned long inlen, ecc_key *key, const ltc_ecc_curve *cu);
158  int ecc_ansi_x963_export(const ecc_key *key, unsigned char *out, unsigned long *outlen);
159  int ecc_ansi_x963_import(const unsigned char *in, unsigned long inlen, ecc_key *key);
160  int ecc_ansi_x963_import_ex(const unsigned char *in, unsigned long inlen, ecc_key *key, const ltc_ecc_curve *cu);
161  int ecc_export_openssl(unsigned char *out, unsigned long *outlen, int type, const ecc_key *key);
162  int ecc_import_openssl(const unsigned char *in, unsigned long inlen, ecc_key *key);
163  int ecc_import_pkcs8(const unsigned char *in, unsigned long inlen, const void *pwd, unsigned long pwdlen, ecc_key *key);
164  int ecc_import_x509(const unsigned char *in, unsigned long inlen, ecc_key *key);
165  int  ecc_shared_secret(const ecc_key *private_key, const ecc_key *public_key,
166                         unsigned char *out, unsigned long *outlen);
167  int  ecc_encrypt_key(const unsigned char *in,   unsigned long inlen,
168                             unsigned char *out,  unsigned long *outlen,
169                             prng_state *prng, int wprng, int hash,
170                             const ecc_key *key);
171  int  ecc_decrypt_key(const unsigned char *in,  unsigned long  inlen,
172                             unsigned char *out, unsigned long *outlen,
173                             const ecc_key *key);
174  #define ecc_sign_hash_rfc7518(in_, inlen_, out_, outlen_, prng_, wprng_, key_) \
175     ecc_sign_hash_ex(in_, inlen_, out_, outlen_, prng_, wprng_, LTC_ECCSIG_RFC7518, NULL, key_)
176  #define ecc_sign_hash(in_, inlen_, out_, outlen_, prng_, wprng_, key_) \
177     ecc_sign_hash_ex(in_, inlen_, out_, outlen_, prng_, wprng_, LTC_ECCSIG_ANSIX962, NULL, key_)
178  #define ecc_verify_hash_rfc7518(sig_, siglen_, hash_, hashlen_, stat_, key_) \
179     ecc_verify_hash_ex(sig_, siglen_, hash_, hashlen_, LTC_ECCSIG_RFC7518, stat_, key_)
180  #define ecc_verify_hash(sig_, siglen_, hash_, hashlen_, stat_, key_) \
181     ecc_verify_hash_ex(sig_, siglen_, hash_, hashlen_, LTC_ECCSIG_ANSIX962, stat_, key_)
182  int  ecc_sign_hash_ex(const unsigned char *in,  unsigned long inlen,
183                              unsigned char *out, unsigned long *outlen,
184                              prng_state *prng, int wprng, ecc_signature_type sigformat,
185                              int *recid, const ecc_key *key);
186  int  ecc_verify_hash_ex(const unsigned char *sig,  unsigned long siglen,
187                          const unsigned char *hash, unsigned long hashlen,
188                          ecc_signature_type sigformat, int *stat, const ecc_key *key);
189  int  ecc_recover_key(const unsigned char *sig,  unsigned long siglen,
190                       const unsigned char *hash, unsigned long hashlen,
191                       int recid, ecc_signature_type sigformat, ecc_key *key);
192  #endif
193  #ifdef LTC_CURVE25519
194  typedef struct {
195     enum public_key_type type;
196     int algo;
197     unsigned char priv[32];
198     unsigned char pub[32];
199  } curve25519_key;
200  int ed25519_make_key(prng_state *prng, int wprng, curve25519_key *key);
201  int ed25519_export(       unsigned char *out, unsigned long *outlen,
202                                      int  which,
203                     const curve25519_key *key);
204  int ed25519_import(const unsigned char *in, unsigned long inlen, curve25519_key *key);
205  int ed25519_import_raw(const unsigned char *in, unsigned long inlen, int which, curve25519_key *key);
206  int ed25519_import_x509(const unsigned char *in, unsigned long inlen, curve25519_key *key);
207  int ed25519_import_pkcs8(const unsigned char *in, unsigned long inlen,
208                                    const void *pwd, unsigned long pwdlen,
209                                curve25519_key *key);
210  int ed25519_sign(const  unsigned char *msg, unsigned long msglen,
211                          unsigned char *sig, unsigned long *siglen,
212                   const curve25519_key *private_key);
213  int ed25519ctx_sign(const  unsigned char *msg, unsigned long  msglen,
214                             unsigned char *sig, unsigned long *siglen,
215                      const  unsigned char *ctx, unsigned long  ctxlen,
216                      const curve25519_key *private_key);
217  int ed25519ph_sign(const  unsigned char *msg, unsigned long  msglen,
218                            unsigned char *sig, unsigned long *siglen,
219                     const  unsigned char *ctx, unsigned long  ctxlen,
220                     const curve25519_key *private_key);
221  int ed25519_verify(const  unsigned char *msg, unsigned long msglen,
222                     const  unsigned char *sig, unsigned long siglen,
223                                      int *stat,
224                     const curve25519_key *public_key);
225  int ed25519ctx_verify(const  unsigned char *msg, unsigned long msglen,
226                        const  unsigned char *sig, unsigned long siglen,
227                        const  unsigned char *ctx, unsigned long ctxlen,
228                                         int *stat,
229                        const curve25519_key *public_key);
230  int ed25519ph_verify(const  unsigned char *msg, unsigned long msglen,
231                       const  unsigned char *sig, unsigned long siglen,
232                       const  unsigned char *ctx, unsigned long ctxlen,
233                                        int *stat,
234                       const curve25519_key *public_key);
235  int x25519_make_key(prng_state *prng, int wprng, curve25519_key *key);
236  int x25519_export(       unsigned char *out, unsigned long *outlen,
237                                     int  which,
238                    const curve25519_key *key);
239  int x25519_import(const unsigned char *in, unsigned long inlen, curve25519_key *key);
240  int x25519_import_raw(const unsigned char *in, unsigned long inlen, int which, curve25519_key *key);
241  int x25519_import_x509(const unsigned char *in, unsigned long inlen, curve25519_key *key);
242  int x25519_import_pkcs8(const unsigned char *in, unsigned long inlen,
243                                   const void *pwd, unsigned long pwdlen,
244                               curve25519_key *key);
245  int x25519_shared_secret(const curve25519_key *private_key,
246                           const curve25519_key *public_key,
247                                  unsigned char *out, unsigned long *outlen);
248  #endif &bsol;* LTC_CURVE25519 */
249  #ifdef LTC_MDSA
250  #define LTC_MDSA_DELTA 992
251  #define LTC_MDSA_MAX_GROUP 64
252  #define LTC_MDSA_MAX_MODULUS 1024
253  typedef struct {
254     int type;
255     int qord;
256     void *g;
257     void *q;
258     void *p;
259     void *x;
260     void *y;
261  } dsa_key;
262  int dsa_make_key(prng_state *prng, int wprng, int group_size, int modulus_size, dsa_key *key);
263  int dsa_set_pqg(const unsigned char *p,  unsigned long plen,
264                  const unsigned char *q,  unsigned long qlen,
265                  const unsigned char *g,  unsigned long glen,
266                  dsa_key *key);
267  int dsa_set_pqg_dsaparam(const unsigned char *dsaparam, unsigned long dsaparamlen, dsa_key *key);
268  int dsa_generate_pqg(prng_state *prng, int wprng, int group_size, int modulus_size, dsa_key *key);
269  int dsa_set_key(const unsigned char *in, unsigned long inlen, int type, dsa_key *key);
270  int dsa_generate_key(prng_state *prng, int wprng, dsa_key *key);
271  void dsa_free(dsa_key *key);
272  int dsa_sign_hash_raw(const unsigned char *in,  unsigned long inlen,
273                                     void *r,   void *s,
274                                 prng_state *prng, int wprng, const dsa_key *key);
275  int dsa_sign_hash(const unsigned char *in,  unsigned long inlen,
276                          unsigned char *out, unsigned long *outlen,
277                          prng_state *prng, int wprng, const dsa_key *key);
278  int dsa_verify_hash_raw(         void *r,          void *s,
279                      const unsigned char *hash, unsigned long hashlen,
280                                      int *stat, const dsa_key *key);
281  int dsa_verify_hash(const unsigned char *sig,        unsigned long  siglen,
282                      const unsigned char *hash,       unsigned long  hashlen,
283                            int           *stat, const dsa_key       *key);
284  int dsa_encrypt_key(const unsigned char *in,   unsigned long inlen,
285                            unsigned char *out,  unsigned long *outlen,
286                            prng_state    *prng, int wprng, int hash,
287                      const dsa_key       *key);
288  int dsa_decrypt_key(const unsigned char *in,  unsigned long  inlen,
289                            unsigned char *out, unsigned long *outlen,
290                      const dsa_key       *key);
291  int dsa_import(const unsigned char *in, unsigned long inlen, dsa_key *key);
292  int dsa_export(unsigned char *out, unsigned long *outlen, int type, const dsa_key *key);
293  int dsa_verify_key(const dsa_key *key, int *stat);
294  int dsa_shared_secret(void          *private_key, void *base,
295                        const dsa_key *public_key,
296                        unsigned char *out,         unsigned long *outlen);
297  #endif &bsol;* LTC_MDSA */
298  #ifdef LTC_DER
299  typedef enum ltc_asn1_type_ {
300   LTC_ASN1_EOL,
301   LTC_ASN1_BOOLEAN,
302   LTC_ASN1_INTEGER,
303   LTC_ASN1_SHORT_INTEGER,
304   LTC_ASN1_BIT_STRING,
305   LTC_ASN1_OCTET_STRING,
306   LTC_ASN1_NULL,
307   LTC_ASN1_OBJECT_IDENTIFIER,
308   LTC_ASN1_IA5_STRING,
309   LTC_ASN1_PRINTABLE_STRING,
310   LTC_ASN1_UTF8_STRING,
311   LTC_ASN1_UTCTIME,
312   LTC_ASN1_CHOICE,
313   LTC_ASN1_SEQUENCE,
314   LTC_ASN1_SET,
315   LTC_ASN1_SETOF,
316   LTC_ASN1_RAW_BIT_STRING,
317   LTC_ASN1_TELETEX_STRING,
318   LTC_ASN1_GENERALIZEDTIME,
319   LTC_ASN1_CUSTOM_TYPE,
320  } ltc_asn1_type;
321  typedef enum {
322     LTC_ASN1_CL_UNIVERSAL = 0x0,
323     LTC_ASN1_CL_APPLICATION = 0x1,
324     LTC_ASN1_CL_CONTEXT_SPECIFIC = 0x2,
325     LTC_ASN1_CL_PRIVATE = 0x3,
326  } ltc_asn1_class;
327  typedef enum {
328     LTC_ASN1_PC_PRIMITIVE = 0x0,
329     LTC_ASN1_PC_CONSTRUCTED = 0x1,
330  } ltc_asn1_pc;
331  typedef struct ltc_asn1_list_ {
332     ltc_asn1_type type;
333     void         *data;
334     unsigned long size;
335     int           used;
336     int           optional;
337     ltc_asn1_class klass;
338     ltc_asn1_pc    pc;
339     ulong64        tag;
340     struct ltc_asn1_list_ *prev, *next, *child, *parent;
341  } ltc_asn1_list;
342  #define LTC_SET_ASN1(list, index, Type, Data, Size)               \
343     do {                                                           \
344        int LTC_TMPVAR(SA)            = (index);                    \
345        ltc_asn1_list *LTC_TMPVAR(SA_list) = (list);                \
346        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].type = (Type);          \
347        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].data = (void*)(Data);   \
348        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].size = (Size);          \
349        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].used = 0;               \
350        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].optional = 0;           \
351        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].klass = 0;              \
352        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].pc = 0;                 \
353        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].tag = 0;                \
354     } while (0)
355  #define LTC_SET_ASN1_IDENTIFIER(list, index, Class, Pc, Tag)               \
356     do {                                                                    \
357        int LTC_TMPVAR(SAI)       = (index);                                 \
358        ltc_asn1_list *LTC_TMPVAR(SAI_list) = (list);                        \
359        LTC_TMPVAR(SAI_list)[LTC_TMPVAR(SAI)].type = LTC_ASN1_CUSTOM_TYPE;   \
360        LTC_TMPVAR(SAI_list)[LTC_TMPVAR(SAI)].klass = (Class);               \
361        LTC_TMPVAR(SAI_list)[LTC_TMPVAR(SAI)].pc = (Pc);                     \
362        LTC_TMPVAR(SAI_list)[LTC_TMPVAR(SAI)].tag = (Tag);                   \
363     } while (0)
364  #define LTC_SET_ASN1_CUSTOM_CONSTRUCTED(list, index, Class, Tag, Data)                       \
365     do {                                                                                      \
366        int LTC_TMPVAR(SACC) = (index);                                                        \
367        LTC_SET_ASN1(list, LTC_TMPVAR(SACC), LTC_ASN1_CUSTOM_TYPE, Data, 1);                   \
368        LTC_SET_ASN1_IDENTIFIER(list, LTC_TMPVAR(SACC), Class, LTC_ASN1_PC_CONSTRUCTED, Tag);  \
369     } while (0)
370  #define LTC_SET_ASN1_CUSTOM_PRIMITIVE(list, index, Class, Tag, Type, Data, Size)          \
371     do {                                                                                   \
372        int LTC_TMPVAR(SACP) = (index);                                                     \
373        LTC_SET_ASN1(list, LTC_TMPVAR(SACP), LTC_ASN1_CUSTOM_TYPE, Data, Size);             \
374        LTC_SET_ASN1_IDENTIFIER(list, LTC_TMPVAR(SACP), Class, LTC_ASN1_PC_PRIMITIVE, Tag); \
375        list[LTC_TMPVAR(SACP)].used = (int)(Type);                                          \
376     } while (0)
377  extern const char*          der_asn1_class_to_string_map[];
378  extern const unsigned long  der_asn1_class_to_string_map_sz;
379  extern const char*          der_asn1_pc_to_string_map[];
380  extern const unsigned long  der_asn1_pc_to_string_map_sz;
381  extern const char*          der_asn1_tag_to_string_map[];
382  extern const unsigned long  der_asn1_tag_to_string_map_sz;
383  int der_encode_sequence_ex(const ltc_asn1_list *list, unsigned long inlen,
384                             unsigned char *out,        unsigned long *outlen, int type_of);
385  #define der_encode_sequence(list, inlen, out, outlen) der_encode_sequence_ex(list, inlen, out, outlen, LTC_ASN1_SEQUENCE)
386  enum ltc_der_seq {
387     LTC_DER_SEQ_ZERO = 0x0u,
388     LTC_DER_SEQ_UNORDERED = LTC_DER_SEQ_ZERO,
389     LTC_DER_SEQ_ORDERED = 0x1u,
390     LTC_DER_SEQ_RELAXED = LTC_DER_SEQ_ZERO,
391     LTC_DER_SEQ_STRICT = 0x2u,
392     LTC_DER_SEQ_SET = LTC_DER_SEQ_UNORDERED,
393     LTC_DER_SEQ_SEQUENCE = LTC_DER_SEQ_ORDERED,
394  };
395  int der_decode_sequence_ex(const unsigned char *in, unsigned long  inlen,
396                             ltc_asn1_list *list,     unsigned long  outlen, unsigned int flags);
397  #define der_decode_sequence(in, inlen, list, outlen) der_decode_sequence_ex(in, inlen, list, outlen, LTC_DER_SEQ_SEQUENCE | LTC_DER_SEQ_RELAXED)
398  #define der_decode_sequence_strict(in, inlen, list, outlen) der_decode_sequence_ex(in, inlen, list, outlen, LTC_DER_SEQ_SEQUENCE | LTC_DER_SEQ_STRICT)
399  int der_length_sequence(const ltc_asn1_list *list, unsigned long inlen,
400                          unsigned long *outlen);
401  int der_encode_custom_type(const ltc_asn1_list *root,
402                                   unsigned char *out, unsigned long *outlen);
403  int der_decode_custom_type(const unsigned char *in, unsigned long inlen,
404                                   ltc_asn1_list *root);
405  int der_length_custom_type(const ltc_asn1_list *root,
406                                   unsigned long *outlen,
407                                   unsigned long *payloadlen);
408  #define der_decode_set(in, inlen, list, outlen) der_decode_sequence_ex(in, inlen, list, outlen, LTC_DER_SEQ_SET)
409  #define der_length_set der_length_sequence
410  int der_encode_set(const ltc_asn1_list *list, unsigned long inlen,
411                     unsigned char *out,        unsigned long *outlen);
412  int der_encode_setof(const ltc_asn1_list *list, unsigned long inlen,
413                       unsigned char *out,        unsigned long *outlen);
414  int der_encode_sequence_multi(unsigned char *out, unsigned long *outlen, ...) LTC_NULL_TERMINATED;
415  int der_decode_sequence_multi(const unsigned char *in, unsigned long inlen, ...) LTC_NULL_TERMINATED;
416  int  der_decode_sequence_flexi(const unsigned char *in, unsigned long *inlen, ltc_asn1_list **out);
417  #define der_free_sequence_flexi         der_sequence_free
418  void der_sequence_free(ltc_asn1_list *in);
419  void der_sequence_shrink(ltc_asn1_list *in);
420  int der_length_boolean(unsigned long *outlen);
421  int der_encode_boolean(int in,
422                         unsigned char *out, unsigned long *outlen);
423  int der_decode_boolean(const unsigned char *in, unsigned long inlen,
424                                         int *out);
425  int der_encode_integer(void *num, unsigned char *out, unsigned long *outlen);
426  int der_decode_integer(const unsigned char *in, unsigned long inlen, void *num);
427  int der_length_integer(void *num, unsigned long *outlen);
428  int der_decode_short_integer(const unsigned char *in, unsigned long inlen, unsigned long *num);
429  int der_encode_short_integer(unsigned long num, unsigned char *out, unsigned long *outlen);
430  int der_length_short_integer(unsigned long num, unsigned long *outlen);
431  int der_encode_bit_string(const unsigned char *in, unsigned long inlen,
432                                  unsigned char *out, unsigned long *outlen);
433  int der_decode_bit_string(const unsigned char *in, unsigned long inlen,
434                                  unsigned char *out, unsigned long *outlen);
435  int der_encode_raw_bit_string(const unsigned char *in, unsigned long inlen,
436                                  unsigned char *out, unsigned long *outlen);
437  int der_decode_raw_bit_string(const unsigned char *in, unsigned long inlen,
438                                  unsigned char *out, unsigned long *outlen);
439  int der_length_bit_string(unsigned long nbits, unsigned long *outlen);
440  int der_encode_octet_string(const unsigned char *in, unsigned long inlen,
441                                    unsigned char *out, unsigned long *outlen);
442  int der_decode_octet_string(const unsigned char *in, unsigned long inlen,
443                                    unsigned char *out, unsigned long *outlen);
444  int der_length_octet_string(unsigned long noctets, unsigned long *outlen);
445  int der_encode_object_identifier(const unsigned long *words, unsigned long  nwords,
446                                         unsigned char *out,   unsigned long *outlen);
447  int der_decode_object_identifier(const unsigned char *in,    unsigned long  inlen,
448                                         unsigned long *words, unsigned long *outlen);
449  int der_length_object_identifier(const unsigned long *words, unsigned long nwords, unsigned long *outlen);
450  unsigned long der_object_identifier_bits(unsigned long x);
451  int der_encode_ia5_string(const unsigned char *in, unsigned long inlen,
452                                  unsigned char *out, unsigned long *outlen);
453  int der_decode_ia5_string(const unsigned char *in, unsigned long inlen,
454                                  unsigned char *out, unsigned long *outlen);
455  int der_length_ia5_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen);
456  int der_ia5_char_encode(int c);
457  int der_ia5_value_decode(int v);
458  int der_decode_teletex_string(const unsigned char *in, unsigned long inlen,
459                                  unsigned char *out, unsigned long *outlen);
460  int der_length_teletex_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen);
461  int der_encode_printable_string(const unsigned char *in, unsigned long inlen,
462                                  unsigned char *out, unsigned long *outlen);
463  int der_decode_printable_string(const unsigned char *in, unsigned long inlen,
464                                  unsigned char *out, unsigned long *outlen);
465  int der_length_printable_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen);
466  int der_printable_char_encode(int c);
467  int der_printable_value_decode(int v);
468  #if (defined(SIZE_MAX) || __STDC_VERSION__ >= 199901L || defined(WCHAR_MAX) || defined(__WCHAR_MAX__) || defined(_WCHAR_T) || defined(_WCHAR_T_DEFINED) || defined (__WCHAR_TYPE__)) && !defined(LTC_NO_WCHAR)
469     #if defined(__WCHAR_MAX__)
470        #define LTC_WCHAR_MAX __WCHAR_MAX__
471     #else
472        #include <wchar.h>
473        #define LTC_WCHAR_MAX WCHAR_MAX
474     #endif
475  #else
476     typedef ulong32 wchar_t;
477     #define LTC_WCHAR_MAX 0xFFFFFFFF
478  #endif
479  int der_encode_utf8_string(const wchar_t *in,  unsigned long inlen,
480                             unsigned char *out, unsigned long *outlen);
481  int der_decode_utf8_string(const unsigned char *in,  unsigned long inlen,
482                                         wchar_t *out, unsigned long *outlen);
483  unsigned long der_utf8_charsize(const wchar_t c);
484  int der_length_utf8_string(const wchar_t *in, unsigned long noctets, unsigned long *outlen);
485  int der_decode_choice(const unsigned char *in,   unsigned long *inlen,
486                              ltc_asn1_list *list, unsigned long  outlen);
487  typedef struct {
488     unsigned YY, &bsol;* year */
489              MM, &bsol;* month */
490              DD, &bsol;* day */
491              hh, &bsol;* hour */
492              mm, &bsol;* minute */
493              ss, &bsol;* second */
494              off_dir, &bsol;* timezone offset direction 0 == +, 1 == - */
495              off_hh, &bsol;* timezone offset hours */
<span onclick='openModal()' class='match'>496              off_mm; &bsol;* timezone offset minutes */
497  } ltc_utctime;
498  int der_encode_utctime(const ltc_utctime   *utctime,
499                               unsigned char *out,   unsigned long *outlen);
500  int der_decode_utctime(const unsigned char *in, unsigned long *inlen,
501                               ltc_utctime   *out);
502  int der_length_utctime(const ltc_utctime *utctime, unsigned long *outlen);
503  typedef struct {
</span>504     unsigned YYYY, &bsol;* year */
505              MM, &bsol;* month */
506              DD, &bsol;* day */
507              hh, &bsol;* hour */
508              mm, &bsol;* minute */
509              ss, &bsol;* second */
510              fs, &bsol;* fractional seconds */
511              off_dir, &bsol;* timezone offset direction 0 == +, 1 == - */
512              off_hh, &bsol;* timezone offset hours */
513              off_mm; &bsol;* timezone offset minutes */
514  } ltc_generalizedtime;
515  int der_encode_generalizedtime(const ltc_generalizedtime *gtime,
516                                       unsigned char       *out, unsigned long *outlen);
517  int der_decode_generalizedtime(const unsigned char *in, unsigned long *inlen,
518                                 ltc_generalizedtime *out);
519  int der_length_generalizedtime(const ltc_generalizedtime *gtime, unsigned long *outlen);
520  #endif
</code></pre>
        </div>
        <div class="column">
            <h3>libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-tomcrypt_pk.h</h3>
            <pre><code>1  enum public_key_type {
2     PK_PUBLIC      = 0x0000,
3     PK_PRIVATE     = 0x0001,
4     PK_STD         = 0x1000,
5     PK_COMPRESSED  = 0x2000,
6     PK_CURVEOID    = 0x4000
7  };
8  int rand_prime(void *N, long len, prng_state *prng, int wprng);
9  #ifdef LTC_MRSA
10  typedef struct Rsa_key {
11      int type;
12      void *e;
13      void *d;
14      void *N;
15      void *p;
16      void *q;
17      void *qP;
18      void *dP;
19      void *dQ;
20  } rsa_key;
21  int rsa_make_key(prng_state *prng, int wprng, int size, long e, rsa_key *key);
22  int rsa_make_key_ubin_e(prng_state *prng, int wprng, int size,
23                          const unsigned char *e, unsigned long elen, rsa_key *key);
24  int rsa_get_size(const rsa_key *key);
25  int rsa_exptmod(const unsigned char *in,   unsigned long inlen,
26                        unsigned char *out,  unsigned long *outlen, int which,
27                  const rsa_key *key);
28  void rsa_free(rsa_key *key);
29  #define rsa_encrypt_key(in, inlen, out, outlen, lparam, lparamlen, prng, prng_idx, hash_idx, key) \
30    rsa_encrypt_key_ex(in, inlen, out, outlen, lparam, lparamlen, prng, prng_idx, hash_idx, LTC_PKCS_1_OAEP, key)
31  #define rsa_decrypt_key(in, inlen, out, outlen, lparam, lparamlen, hash_idx, stat, key) \
32    rsa_decrypt_key_ex(in, inlen, out, outlen, lparam, lparamlen, hash_idx, LTC_PKCS_1_OAEP, stat, key)
33  #define rsa_sign_hash(in, inlen, out, outlen, prng, prng_idx, hash_idx, saltlen, key) \
34    rsa_sign_hash_ex(in, inlen, out, outlen, LTC_PKCS_1_PSS, prng, prng_idx, hash_idx, saltlen, key)
35  #define rsa_verify_hash(sig, siglen, hash, hashlen, hash_idx, saltlen, stat, key) \
36    rsa_verify_hash_ex(sig, siglen, hash, hashlen, LTC_PKCS_1_PSS, hash_idx, saltlen, stat, key)
37  #define rsa_sign_saltlen_get_max(hash_idx, key) \
38    rsa_sign_saltlen_get_max_ex(LTC_PKCS_1_PSS, hash_idx, key)
39  int rsa_encrypt_key_ex(const unsigned char *in,       unsigned long  inlen,
40                               unsigned char *out,      unsigned long *outlen,
41                         const unsigned char *lparam,   unsigned long  lparamlen,
42                               prng_state    *prng,     int            prng_idx,
43                               int            hash_idx, int            padding,
44                         const rsa_key       *key);
45  int rsa_decrypt_key_ex(const unsigned char *in,             unsigned long  inlen,
46                               unsigned char *out,            unsigned long *outlen,
47                         const unsigned char *lparam,         unsigned long  lparamlen,
48                               int            hash_idx,       int            padding,
49                               int           *stat,     const rsa_key       *key);
50  int rsa_sign_hash_ex(const unsigned char *in,       unsigned long  inlen,
51                             unsigned char *out,      unsigned long *outlen,
52                             int            padding,
53                             prng_state    *prng,     int            prng_idx,
54                             int            hash_idx, unsigned long  saltlen,
55                       const rsa_key       *key);
56  int rsa_verify_hash_ex(const unsigned char *sig,            unsigned long  siglen,
57                         const unsigned char *hash,           unsigned long  hashlen,
58                               int            padding,
59                               int            hash_idx,       unsigned long  saltlen,
60                               int           *stat,     const rsa_key       *key);
61  int rsa_sign_saltlen_get_max_ex(int padding, int hash_idx, const rsa_key *key);
62  int rsa_export(unsigned char *out, unsigned long *outlen, int type, const rsa_key *key);
63  int rsa_import(const unsigned char *in, unsigned long inlen, rsa_key *key);
64  int rsa_import_x509(const unsigned char *in, unsigned long inlen, rsa_key *key);
65  int rsa_import_pkcs8(const unsigned char *in, unsigned long inlen,
66                       const void *passwd, unsigned long passwdlen, rsa_key *key);
67  int rsa_set_key(const unsigned char *N,  unsigned long Nlen,
68                  const unsigned char *e,  unsigned long elen,
69                  const unsigned char *d,  unsigned long dlen,
70                  rsa_key *key);
71  int rsa_set_factors(const unsigned char *p,  unsigned long plen,
72                      const unsigned char *q,  unsigned long qlen,
73                      rsa_key *key);
74  int rsa_set_crt_params(const unsigned char *dP, unsigned long dPlen,
75                         const unsigned char *dQ, unsigned long dQlen,
76                         const unsigned char *qP, unsigned long qPlen,
77                         rsa_key *key);
78  #endif
79  #ifdef LTC_MDH
80  typedef struct {
81      int type;
82      void *x;
83      void *y;
84      void *base;
85      void *prime;
86  } dh_key;
87  int dh_get_groupsize(const dh_key *key);
88  int dh_export(unsigned char *out, unsigned long *outlen, int type, const dh_key *key);
89  int dh_import(const unsigned char *in, unsigned long inlen, dh_key *key);
90  int dh_set_pg(const unsigned char *p, unsigned long plen,
91                const unsigned char *g, unsigned long glen,
92                dh_key *key);
93  int dh_set_pg_dhparam(const unsigned char *dhparam, unsigned long dhparamlen, dh_key *key);
94  int dh_set_pg_groupsize(int groupsize, dh_key *key);
95  int dh_set_key(const unsigned char *in, unsigned long inlen, int type, dh_key *key);
96  int dh_generate_key(prng_state *prng, int wprng, dh_key *key);
97  int dh_shared_secret(const dh_key  *private_key, const dh_key  *public_key,
98                       unsigned char *out,         unsigned long *outlen);
99  void dh_free(dh_key *key);
100  int dh_export_key(void *out, unsigned long *outlen, int type, const dh_key *key);
101  #endif &bsol;* LTC_MDH */
102  #ifdef LTC_MECC
103  #define ECC_BUF_SIZE 256
104  #define ECC_MAXSIZE  66
105  typedef struct {
106     const char *prime;
107     const char *A;
108     const char *B;
109     const char *order;
110     const char *Gx;
111     const char *Gy;
112     unsigned long cofactor;
113     const char *OID;
114  } ltc_ecc_curve;
115  typedef struct {
116      void *x;
117      void *y;
118      void *z;
119  } ecc_point;
120  typedef struct {
121     int size;
122     void *prime;
123     void *A;
124     void *B;
125     void *order;
126     ecc_point base;
127     unsigned long cofactor;
128     unsigned long oid[16];
129     unsigned long oidlen;
130  } ltc_ecc_dp;
131  typedef struct {
132      int type;
133      ltc_ecc_dp dp;
134      ecc_point pubkey;
135      void *k;
136  } ecc_key;
137  typedef enum ecc_signature_type_ {
138     LTC_ECCSIG_ANSIX962   = 0x0,
139     LTC_ECCSIG_RFC7518    = 0x1,
140     LTC_ECCSIG_ETH27      = 0x2,
141     LTC_ECCSIG_RFC5656    = 0x3,
142  } ecc_signature_type;
143  extern const ltc_ecc_curve ltc_ecc_curves[];
144  void ecc_sizes(int *low, int *high);
145  int  ecc_get_size(const ecc_key *key);
146  int  ecc_find_curve(const char* name_or_oid, const ltc_ecc_curve** cu);
147  int  ecc_set_curve(const ltc_ecc_curve *cu, ecc_key *key);
148  int  ecc_generate_key(prng_state *prng, int wprng, ecc_key *key);
149  int  ecc_set_key(const unsigned char *in, unsigned long inlen, int type, ecc_key *key);
150  int  ecc_get_key(unsigned char *out, unsigned long *outlen, int type, const ecc_key *key);
151  int  ecc_get_oid_str(char *out, unsigned long *outlen, const ecc_key *key);
152  int  ecc_make_key(prng_state *prng, int wprng, int keysize, ecc_key *key);
153  int  ecc_make_key_ex(prng_state *prng, int wprng, ecc_key *key, const ltc_ecc_curve *cu);
154  void ecc_free(ecc_key *key);
155  int  ecc_export(unsigned char *out, unsigned long *outlen, int type, const ecc_key *key);
156  int  ecc_import(const unsigned char *in, unsigned long inlen, ecc_key *key);
157  int  ecc_import_ex(const unsigned char *in, unsigned long inlen, ecc_key *key, const ltc_ecc_curve *cu);
158  int ecc_ansi_x963_export(const ecc_key *key, unsigned char *out, unsigned long *outlen);
159  int ecc_ansi_x963_import(const unsigned char *in, unsigned long inlen, ecc_key *key);
160  int ecc_ansi_x963_import_ex(const unsigned char *in, unsigned long inlen, ecc_key *key, const ltc_ecc_curve *cu);
161  int ecc_export_openssl(unsigned char *out, unsigned long *outlen, int type, const ecc_key *key);
162  int ecc_import_openssl(const unsigned char *in, unsigned long inlen, ecc_key *key);
163  int ecc_import_pkcs8(const unsigned char *in, unsigned long inlen, const void *pwd, unsigned long pwdlen, ecc_key *key);
164  int ecc_import_x509(const unsigned char *in, unsigned long inlen, ecc_key *key);
165  int  ecc_shared_secret(const ecc_key *private_key, const ecc_key *public_key,
166                         unsigned char *out, unsigned long *outlen);
167  int  ecc_encrypt_key(const unsigned char *in,   unsigned long inlen,
168                             unsigned char *out,  unsigned long *outlen,
169                             prng_state *prng, int wprng, int hash,
170                             const ecc_key *key);
171  int  ecc_decrypt_key(const unsigned char *in,  unsigned long  inlen,
172                             unsigned char *out, unsigned long *outlen,
173                             const ecc_key *key);
174  #define ecc_sign_hash_rfc7518(in_, inlen_, out_, outlen_, prng_, wprng_, key_) \
175     ecc_sign_hash_ex(in_, inlen_, out_, outlen_, prng_, wprng_, LTC_ECCSIG_RFC7518, NULL, key_)
176  #define ecc_sign_hash(in_, inlen_, out_, outlen_, prng_, wprng_, key_) \
177     ecc_sign_hash_ex(in_, inlen_, out_, outlen_, prng_, wprng_, LTC_ECCSIG_ANSIX962, NULL, key_)
178  #define ecc_verify_hash_rfc7518(sig_, siglen_, hash_, hashlen_, stat_, key_) \
179     ecc_verify_hash_ex(sig_, siglen_, hash_, hashlen_, LTC_ECCSIG_RFC7518, stat_, key_)
180  #define ecc_verify_hash(sig_, siglen_, hash_, hashlen_, stat_, key_) \
181     ecc_verify_hash_ex(sig_, siglen_, hash_, hashlen_, LTC_ECCSIG_ANSIX962, stat_, key_)
182  int  ecc_sign_hash_ex(const unsigned char *in,  unsigned long inlen,
183                              unsigned char *out, unsigned long *outlen,
184                              prng_state *prng, int wprng, ecc_signature_type sigformat,
185                              int *recid, const ecc_key *key);
186  int  ecc_verify_hash_ex(const unsigned char *sig,  unsigned long siglen,
187                          const unsigned char *hash, unsigned long hashlen,
188                          ecc_signature_type sigformat, int *stat, const ecc_key *key);
189  int  ecc_recover_key(const unsigned char *sig,  unsigned long siglen,
190                       const unsigned char *hash, unsigned long hashlen,
191                       int recid, ecc_signature_type sigformat, ecc_key *key);
192  #endif
193  #ifdef LTC_CURVE25519
194  typedef struct {
195     enum public_key_type type;
196     int algo;
197     unsigned char priv[32];
198     unsigned char pub[32];
199  } curve25519_key;
200  int ed25519_make_key(prng_state *prng, int wprng, curve25519_key *key);
201  int ed25519_export(       unsigned char *out, unsigned long *outlen,
202                                      int  which,
203                     const curve25519_key *key);
204  int ed25519_import(const unsigned char *in, unsigned long inlen, curve25519_key *key);
205  int ed25519_import_raw(const unsigned char *in, unsigned long inlen, int which, curve25519_key *key);
206  int ed25519_import_x509(const unsigned char *in, unsigned long inlen, curve25519_key *key);
207  int ed25519_import_pkcs8(const unsigned char *in, unsigned long inlen,
208                                    const void *pwd, unsigned long pwdlen,
209                                curve25519_key *key);
210  int ed25519_sign(const  unsigned char *msg, unsigned long msglen,
211                          unsigned char *sig, unsigned long *siglen,
212                   const curve25519_key *private_key);
213  int ed25519ctx_sign(const  unsigned char *msg, unsigned long  msglen,
214                             unsigned char *sig, unsigned long *siglen,
215                      const  unsigned char *ctx, unsigned long  ctxlen,
216                      const curve25519_key *private_key);
217  int ed25519ph_sign(const  unsigned char *msg, unsigned long  msglen,
218                            unsigned char *sig, unsigned long *siglen,
219                     const  unsigned char *ctx, unsigned long  ctxlen,
220                     const curve25519_key *private_key);
221  int ed25519_verify(const  unsigned char *msg, unsigned long msglen,
222                     const  unsigned char *sig, unsigned long siglen,
223                                      int *stat,
224                     const curve25519_key *public_key);
225  int ed25519ctx_verify(const  unsigned char *msg, unsigned long msglen,
226                        const  unsigned char *sig, unsigned long siglen,
227                        const  unsigned char *ctx, unsigned long ctxlen,
228                                         int *stat,
229                        const curve25519_key *public_key);
230  int ed25519ph_verify(const  unsigned char *msg, unsigned long msglen,
231                       const  unsigned char *sig, unsigned long siglen,
232                       const  unsigned char *ctx, unsigned long ctxlen,
233                                        int *stat,
234                       const curve25519_key *public_key);
235  int x25519_make_key(prng_state *prng, int wprng, curve25519_key *key);
236  int x25519_export(       unsigned char *out, unsigned long *outlen,
237                                     int  which,
238                    const curve25519_key *key);
239  int x25519_import(const unsigned char *in, unsigned long inlen, curve25519_key *key);
240  int x25519_import_raw(const unsigned char *in, unsigned long inlen, int which, curve25519_key *key);
241  int x25519_import_x509(const unsigned char *in, unsigned long inlen, curve25519_key *key);
242  int x25519_import_pkcs8(const unsigned char *in, unsigned long inlen,
243                                   const void *pwd, unsigned long pwdlen,
244                               curve25519_key *key);
245  int x25519_shared_secret(const curve25519_key *private_key,
246                           const curve25519_key *public_key,
247                                  unsigned char *out, unsigned long *outlen);
248  #endif &bsol;* LTC_CURVE25519 */
249  #ifdef LTC_MDSA
250  #define LTC_MDSA_DELTA 992
251  #define LTC_MDSA_MAX_GROUP 64
252  #define LTC_MDSA_MAX_MODULUS 1024
253  typedef struct {
254     int type;
255     int qord;
256     void *g;
257     void *q;
258     void *p;
259     void *x;
260     void *y;
261  } dsa_key;
262  int dsa_make_key(prng_state *prng, int wprng, int group_size, int modulus_size, dsa_key *key);
263  int dsa_set_pqg(const unsigned char *p,  unsigned long plen,
264                  const unsigned char *q,  unsigned long qlen,
265                  const unsigned char *g,  unsigned long glen,
266                  dsa_key *key);
267  int dsa_set_pqg_dsaparam(const unsigned char *dsaparam, unsigned long dsaparamlen, dsa_key *key);
268  int dsa_generate_pqg(prng_state *prng, int wprng, int group_size, int modulus_size, dsa_key *key);
269  int dsa_set_key(const unsigned char *in, unsigned long inlen, int type, dsa_key *key);
270  int dsa_generate_key(prng_state *prng, int wprng, dsa_key *key);
271  void dsa_free(dsa_key *key);
272  int dsa_sign_hash_raw(const unsigned char *in,  unsigned long inlen,
273                                     void *r,   void *s,
274                                 prng_state *prng, int wprng, const dsa_key *key);
275  int dsa_sign_hash(const unsigned char *in,  unsigned long inlen,
276                          unsigned char *out, unsigned long *outlen,
277                          prng_state *prng, int wprng, const dsa_key *key);
278  int dsa_verify_hash_raw(         void *r,          void *s,
279                      const unsigned char *hash, unsigned long hashlen,
280                                      int *stat, const dsa_key *key);
281  int dsa_verify_hash(const unsigned char *sig,        unsigned long  siglen,
282                      const unsigned char *hash,       unsigned long  hashlen,
283                            int           *stat, const dsa_key       *key);
284  int dsa_encrypt_key(const unsigned char *in,   unsigned long inlen,
285                            unsigned char *out,  unsigned long *outlen,
286                            prng_state    *prng, int wprng, int hash,
287                      const dsa_key       *key);
288  int dsa_decrypt_key(const unsigned char *in,  unsigned long  inlen,
289                            unsigned char *out, unsigned long *outlen,
290                      const dsa_key       *key);
291  int dsa_import(const unsigned char *in, unsigned long inlen, dsa_key *key);
292  int dsa_export(unsigned char *out, unsigned long *outlen, int type, const dsa_key *key);
293  int dsa_verify_key(const dsa_key *key, int *stat);
294  int dsa_shared_secret(void          *private_key, void *base,
295                        const dsa_key *public_key,
296                        unsigned char *out,         unsigned long *outlen);
297  #endif &bsol;* LTC_MDSA */
298  #ifdef LTC_DER
299  typedef enum ltc_asn1_type_ {
300   LTC_ASN1_EOL,
301   LTC_ASN1_BOOLEAN,
302   LTC_ASN1_INTEGER,
303   LTC_ASN1_SHORT_INTEGER,
304   LTC_ASN1_BIT_STRING,
305   LTC_ASN1_OCTET_STRING,
306   LTC_ASN1_NULL,
307   LTC_ASN1_OBJECT_IDENTIFIER,
308   LTC_ASN1_IA5_STRING,
309   LTC_ASN1_PRINTABLE_STRING,
310   LTC_ASN1_UTF8_STRING,
311   LTC_ASN1_UTCTIME,
312   LTC_ASN1_CHOICE,
313   LTC_ASN1_SEQUENCE,
314   LTC_ASN1_SET,
315   LTC_ASN1_SETOF,
316   LTC_ASN1_RAW_BIT_STRING,
317   LTC_ASN1_TELETEX_STRING,
318   LTC_ASN1_GENERALIZEDTIME,
319   LTC_ASN1_CUSTOM_TYPE,
320  } ltc_asn1_type;
321  typedef enum {
322     LTC_ASN1_CL_UNIVERSAL = 0x0,
323     LTC_ASN1_CL_APPLICATION = 0x1,
324     LTC_ASN1_CL_CONTEXT_SPECIFIC = 0x2,
325     LTC_ASN1_CL_PRIVATE = 0x3,
326  } ltc_asn1_class;
327  typedef enum {
328     LTC_ASN1_PC_PRIMITIVE = 0x0,
329     LTC_ASN1_PC_CONSTRUCTED = 0x1,
330  } ltc_asn1_pc;
331  typedef struct ltc_asn1_list_ {
332     ltc_asn1_type type;
333     void         *data;
334     unsigned long size;
335     int           used;
336     int           optional;
337     ltc_asn1_class klass;
338     ltc_asn1_pc    pc;
339     ulong64        tag;
340     struct ltc_asn1_list_ *prev, *next, *child, *parent;
341  } ltc_asn1_list;
342  #define LTC_SET_ASN1(list, index, Type, Data, Size)               \
343     do {                                                           \
344        int LTC_TMPVAR(SA)            = (index);                    \
345        ltc_asn1_list *LTC_TMPVAR(SA_list) = (list);                \
346        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].type = (Type);          \
347        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].data = (void*)(Data);   \
348        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].size = (Size);          \
349        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].used = 0;               \
350        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].optional = 0;           \
351        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].klass = 0;              \
352        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].pc = 0;                 \
353        LTC_TMPVAR(SA_list)[LTC_TMPVAR(SA)].tag = 0;                \
354     } while (0)
355  #define LTC_SET_ASN1_IDENTIFIER(list, index, Class, Pc, Tag)               \
356     do {                                                                    \
357        int LTC_TMPVAR(SAI)       = (index);                                 \
358        ltc_asn1_list *LTC_TMPVAR(SAI_list) = (list);                        \
359        LTC_TMPVAR(SAI_list)[LTC_TMPVAR(SAI)].type = LTC_ASN1_CUSTOM_TYPE;   \
360        LTC_TMPVAR(SAI_list)[LTC_TMPVAR(SAI)].klass = (Class);               \
361        LTC_TMPVAR(SAI_list)[LTC_TMPVAR(SAI)].pc = (Pc);                     \
362        LTC_TMPVAR(SAI_list)[LTC_TMPVAR(SAI)].tag = (Tag);                   \
363     } while (0)
364  #define LTC_SET_ASN1_CUSTOM_CONSTRUCTED(list, index, Class, Tag, Data)                       \
365     do {                                                                                      \
366        int LTC_TMPVAR(SACC) = (index);                                                        \
367        LTC_SET_ASN1(list, LTC_TMPVAR(SACC), LTC_ASN1_CUSTOM_TYPE, Data, 1);                   \
368        LTC_SET_ASN1_IDENTIFIER(list, LTC_TMPVAR(SACC), Class, LTC_ASN1_PC_CONSTRUCTED, Tag);  \
369     } while (0)
370  #define LTC_SET_ASN1_CUSTOM_PRIMITIVE(list, index, Class, Tag, Type, Data, Size)          \
371     do {                                                                                   \
372        int LTC_TMPVAR(SACP) = (index);                                                     \
373        LTC_SET_ASN1(list, LTC_TMPVAR(SACP), LTC_ASN1_CUSTOM_TYPE, Data, Size);             \
374        LTC_SET_ASN1_IDENTIFIER(list, LTC_TMPVAR(SACP), Class, LTC_ASN1_PC_PRIMITIVE, Tag); \
375        list[LTC_TMPVAR(SACP)].used = (int)(Type);                                          \
376     } while (0)
377  extern const char*          der_asn1_class_to_string_map[];
378  extern const unsigned long  der_asn1_class_to_string_map_sz;
379  extern const char*          der_asn1_pc_to_string_map[];
380  extern const unsigned long  der_asn1_pc_to_string_map_sz;
381  extern const char*          der_asn1_tag_to_string_map[];
382  extern const unsigned long  der_asn1_tag_to_string_map_sz;
383  int der_encode_sequence_ex(const ltc_asn1_list *list, unsigned long inlen,
384                             unsigned char *out,        unsigned long *outlen, int type_of);
385  #define der_encode_sequence(list, inlen, out, outlen) der_encode_sequence_ex(list, inlen, out, outlen, LTC_ASN1_SEQUENCE)
386  enum ltc_der_seq {
387     LTC_DER_SEQ_ZERO = 0x0u,
388     LTC_DER_SEQ_UNORDERED = LTC_DER_SEQ_ZERO,
389     LTC_DER_SEQ_ORDERED = 0x1u,
390     LTC_DER_SEQ_RELAXED = LTC_DER_SEQ_ZERO,
391     LTC_DER_SEQ_STRICT = 0x2u,
392     LTC_DER_SEQ_SET = LTC_DER_SEQ_UNORDERED,
393     LTC_DER_SEQ_SEQUENCE = LTC_DER_SEQ_ORDERED,
394  };
395  int der_decode_sequence_ex(const unsigned char *in, unsigned long  inlen,
396                             ltc_asn1_list *list,     unsigned long  outlen, unsigned int flags);
397  #define der_decode_sequence(in, inlen, list, outlen) der_decode_sequence_ex(in, inlen, list, outlen, LTC_DER_SEQ_SEQUENCE | LTC_DER_SEQ_RELAXED)
398  #define der_decode_sequence_strict(in, inlen, list, outlen) der_decode_sequence_ex(in, inlen, list, outlen, LTC_DER_SEQ_SEQUENCE | LTC_DER_SEQ_STRICT)
399  int der_length_sequence(const ltc_asn1_list *list, unsigned long inlen,
400                          unsigned long *outlen);
401  int der_encode_custom_type(const ltc_asn1_list *root,
402                                   unsigned char *out, unsigned long *outlen);
403  int der_decode_custom_type(const unsigned char *in, unsigned long inlen,
404                                   ltc_asn1_list *root);
405  int der_length_custom_type(const ltc_asn1_list *root,
406                                   unsigned long *outlen,
407                                   unsigned long *payloadlen);
408  #define der_decode_set(in, inlen, list, outlen) der_decode_sequence_ex(in, inlen, list, outlen, LTC_DER_SEQ_SET)
409  #define der_length_set der_length_sequence
410  int der_encode_set(const ltc_asn1_list *list, unsigned long inlen,
411                     unsigned char *out,        unsigned long *outlen);
412  int der_encode_setof(const ltc_asn1_list *list, unsigned long inlen,
413                       unsigned char *out,        unsigned long *outlen);
414  int der_encode_sequence_multi(unsigned char *out, unsigned long *outlen, ...) LTC_NULL_TERMINATED;
415  int der_decode_sequence_multi(const unsigned char *in, unsigned long inlen, ...) LTC_NULL_TERMINATED;
416  int  der_decode_sequence_flexi(const unsigned char *in, unsigned long *inlen, ltc_asn1_list **out);
417  #define der_free_sequence_flexi         der_sequence_free
418  void der_sequence_free(ltc_asn1_list *in);
419  void der_sequence_shrink(ltc_asn1_list *in);
420  int der_length_boolean(unsigned long *outlen);
421  int der_encode_boolean(int in,
422                         unsigned char *out, unsigned long *outlen);
423  int der_decode_boolean(const unsigned char *in, unsigned long inlen,
424                                         int *out);
425  int der_encode_integer(void *num, unsigned char *out, unsigned long *outlen);
426  int der_decode_integer(const unsigned char *in, unsigned long inlen, void *num);
427  int der_length_integer(void *num, unsigned long *outlen);
428  int der_decode_short_integer(const unsigned char *in, unsigned long inlen, unsigned long *num);
429  int der_encode_short_integer(unsigned long num, unsigned char *out, unsigned long *outlen);
430  int der_length_short_integer(unsigned long num, unsigned long *outlen);
431  int der_encode_bit_string(const unsigned char *in, unsigned long inlen,
432                                  unsigned char *out, unsigned long *outlen);
433  int der_decode_bit_string(const unsigned char *in, unsigned long inlen,
434                                  unsigned char *out, unsigned long *outlen);
435  int der_encode_raw_bit_string(const unsigned char *in, unsigned long inlen,
436                                  unsigned char *out, unsigned long *outlen);
437  int der_decode_raw_bit_string(const unsigned char *in, unsigned long inlen,
438                                  unsigned char *out, unsigned long *outlen);
439  int der_length_bit_string(unsigned long nbits, unsigned long *outlen);
440  int der_encode_octet_string(const unsigned char *in, unsigned long inlen,
441                                    unsigned char *out, unsigned long *outlen);
442  int der_decode_octet_string(const unsigned char *in, unsigned long inlen,
443                                    unsigned char *out, unsigned long *outlen);
444  int der_length_octet_string(unsigned long noctets, unsigned long *outlen);
445  int der_encode_object_identifier(const unsigned long *words, unsigned long  nwords,
446                                         unsigned char *out,   unsigned long *outlen);
447  int der_decode_object_identifier(const unsigned char *in,    unsigned long  inlen,
448                                         unsigned long *words, unsigned long *outlen);
449  int der_length_object_identifier(const unsigned long *words, unsigned long nwords, unsigned long *outlen);
450  unsigned long der_object_identifier_bits(unsigned long x);
451  int der_encode_ia5_string(const unsigned char *in, unsigned long inlen,
452                                  unsigned char *out, unsigned long *outlen);
453  int der_decode_ia5_string(const unsigned char *in, unsigned long inlen,
454                                  unsigned char *out, unsigned long *outlen);
455  int der_length_ia5_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen);
456  int der_ia5_char_encode(int c);
457  int der_ia5_value_decode(int v);
458  int der_decode_teletex_string(const unsigned char *in, unsigned long inlen,
459                                  unsigned char *out, unsigned long *outlen);
460  int der_length_teletex_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen);
461  int der_encode_printable_string(const unsigned char *in, unsigned long inlen,
462                                  unsigned char *out, unsigned long *outlen);
463  int der_decode_printable_string(const unsigned char *in, unsigned long inlen,
464                                  unsigned char *out, unsigned long *outlen);
465  int der_length_printable_string(const unsigned char *octets, unsigned long noctets, unsigned long *outlen);
466  int der_printable_char_encode(int c);
467  int der_printable_value_decode(int v);
468  #if (defined(SIZE_MAX) || __STDC_VERSION__ >= 199901L || defined(WCHAR_MAX) || defined(__WCHAR_MAX__) || defined(_WCHAR_T) || defined(_WCHAR_T_DEFINED) || defined (__WCHAR_TYPE__)) && !defined(LTC_NO_WCHAR)
469     #if defined(__WCHAR_MAX__)
470        #define LTC_WCHAR_MAX __WCHAR_MAX__
471     #else
472        #include <wchar.h>
473        #define LTC_WCHAR_MAX WCHAR_MAX
474     #endif
475  #else
476     typedef ulong32 wchar_t;
477     #define LTC_WCHAR_MAX 0xFFFFFFFF
478  #endif
479  int der_encode_utf8_string(const wchar_t *in,  unsigned long inlen,
480                             unsigned char *out, unsigned long *outlen);
481  int der_decode_utf8_string(const unsigned char *in,  unsigned long inlen,
482                                         wchar_t *out, unsigned long *outlen);
483  unsigned long der_utf8_charsize(const wchar_t c);
484  int der_length_utf8_string(const wchar_t *in, unsigned long noctets, unsigned long *outlen);
485  int der_decode_choice(const unsigned char *in,   unsigned long *inlen,
486                              ltc_asn1_list *list, unsigned long  outlen);
487  typedef struct {
488     unsigned YY, &bsol;* year */
489              MM, &bsol;* month */
490              DD, &bsol;* day */
491              hh, &bsol;* hour */
492              mm, &bsol;* minute */
493              ss, &bsol;* second */
494              off_dir, &bsol;* timezone offset direction 0 == +, 1 == - */
495              off_hh, &bsol;* timezone offset hours */
496              off_mm; &bsol;* timezone offset minutes */
497  } ltc_utctime;
498  int der_encode_utctime(const ltc_utctime   *utctime,
499                               unsigned char *out,   unsigned long *outlen);
500  int der_decode_utctime(const unsigned char *in, unsigned long *inlen,
501                               ltc_utctime   *out);
502  int der_length_utctime(const ltc_utctime *utctime, unsigned long *outlen);
503  typedef struct {
504     unsigned YYYY, &bsol;* year */
505              MM, &bsol;* month */
506              DD, &bsol;* day */
507              hh, &bsol;* hour */
508              mm, &bsol;* minute */
509              ss, &bsol;* second */
510              fs, &bsol;* fractional seconds */
511              off_dir, &bsol;* timezone offset direction 0 == +, 1 == - */
512              off_hh, &bsol;* timezone offset hours */
<span onclick='openModal()' class='match'>513              off_mm; &bsol;* timezone offset minutes */
514  } ltc_generalizedtime;
515  int der_encode_generalizedtime(const ltc_generalizedtime *gtime,
516                                       unsigned char       *out, unsigned long *outlen);
517  int der_decode_generalizedtime(const unsigned char *in, unsigned long *inlen,
518                                 ltc_generalizedtime *out);
519  int der_length_generalizedtime(const ltc_generalizedtime *gtime, unsigned long *outlen);
520  #endif
</span></code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-tomcrypt_pk.h</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-tomcrypt_pk.h</div>
                </div>
                <div class="column column_space"><pre><code>496              off_mm; &bsol;* timezone offset minutes */
497  } ltc_utctime;
498  int der_encode_utctime(const ltc_utctime   *utctime,
499                               unsigned char *out,   unsigned long *outlen);
500  int der_decode_utctime(const unsigned char *in, unsigned long *inlen,
501                               ltc_utctime   *out);
502  int der_length_utctime(const ltc_utctime *utctime, unsigned long *outlen);
503  typedef struct {
</pre></code></div>
                <div class="column column_space"><pre><code>513              off_mm; &bsol;* timezone offset minutes */
514  } ltc_generalizedtime;
515  int der_encode_generalizedtime(const ltc_generalizedtime *gtime,
516                                       unsigned char       *out, unsigned long *outlen);
517  int der_decode_generalizedtime(const unsigned char *in, unsigned long *inlen,
518                                 ltc_generalizedtime *out);
519  int der_length_generalizedtime(const ltc_generalizedtime *gtime, unsigned long *outlen);
520  #endif
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    