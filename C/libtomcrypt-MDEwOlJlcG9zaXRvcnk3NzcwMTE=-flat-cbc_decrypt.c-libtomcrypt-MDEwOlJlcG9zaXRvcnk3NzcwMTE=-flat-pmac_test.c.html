
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 8.791208791208792%, Tokens: 8, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-cbc_decrypt.c</h3>
            <pre><code>1  #include "tomcrypt_private.h"
2  #ifdef LTC_CBC_MODE
3  int cbc_decrypt(const unsigned char *ct, unsigned char *pt, unsigned long len, symmetric_CBC *cbc)
4  {
5     int x, err;
6     unsigned char tmp[16];
7  #ifdef LTC_FAST
8     LTC_FAST_TYPE tmpy;
9  #else
10     unsigned char tmpy;
11  #endif
12     LTC_ARGCHK(pt  != NULL);
13     LTC_ARGCHK(ct  != NULL);
14     LTC_ARGCHK(cbc != NULL);
15     if ((err = cipher_is_valid(cbc->cipher)) != CRYPT_OK) {
16         return err;
17     }
18     if (cbc->blocklen < 1 || cbc->blocklen > (int)sizeof(cbc->IV) || cbc->blocklen > (int)sizeof(tmp)) {
19        return CRYPT_INVALID_ARG;
20     }
<span onclick='openModal()' class='match'>21     if (len % cbc->blocklen) {
22        return CRYPT_INVALID_ARG;
23     }
24  #ifdef LTC_FAST
25     if (cbc->blocklen % sizeof(LTC_FAST_TYPE)) {
26        return CRYPT_INVALID_ARG;
27     }
</span>28  #endif
29     if (cipher_descriptor[cbc->cipher].accel_cbc_decrypt != NULL) {
30        return cipher_descriptor[cbc->cipher].accel_cbc_decrypt(ct, pt, len / cbc->blocklen, cbc->IV, &cbc->key);
31     }
32     while (len) {
33        if ((err = cipher_descriptor[cbc->cipher].ecb_decrypt(ct, tmp, &cbc->key)) != CRYPT_OK) {
34           return err;
35        }
36  #if defined(LTC_FAST)
37        for (x = 0; x < cbc->blocklen; x += sizeof(LTC_FAST_TYPE)) {
38           tmpy = *(LTC_FAST_TYPE_PTR_CAST((unsigned char *)cbc->IV + x)) ^ *(LTC_FAST_TYPE_PTR_CAST((unsigned char *)tmp + x));
39           *(LTC_FAST_TYPE_PTR_CAST((unsigned char *)cbc->IV + x)) = *(LTC_FAST_TYPE_PTR_CAST((unsigned char *)ct + x));
40           *(LTC_FAST_TYPE_PTR_CAST((unsigned char *)pt + x)) = tmpy;
41        }
42  #else
43        for (x = 0; x < cbc->blocklen; x++) {
44           tmpy       = tmp[x] ^ cbc->IV[x];
45           cbc->IV[x] = ct[x];
46           pt[x]      = tmpy;
47        }
48  #endif
49        ct  += cbc->blocklen;
50        pt  += cbc->blocklen;
51        len -= cbc->blocklen;
52     }
53     return CRYPT_OK;
54  }
55  #endif
</code></pre>
        </div>
        <div class="column">
            <h3>libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-pmac_test.c</h3>
            <pre><code>1  #include "tomcrypt_private.h"
2  #ifdef LTC_PMAC
3  int pmac_test(void)
4  {
5  #if !defined(LTC_TEST)
6      return CRYPT_NOP;
7  #else
8      static const struct {
9          int msglen;
10          unsigned char key[16], msg[34], tag[16];
11      } tests[] = {
12  {
13     0,
14     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
15       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f },
16     { 0x00 },
17     { 0x43, 0x99, 0x57, 0x2c, 0xd6, 0xea, 0x53, 0x41,
18       0xb8, 0xd3, 0x58, 0x76, 0xa7, 0x09, 0x8a, 0xf7 }
19  },
20  {
21     3,
22     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
23       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f },
24     { 0x00, 0x01, 0x02 },
25     { 0x25, 0x6b, 0xa5, 0x19, 0x3c, 0x1b, 0x99, 0x1b,
26       0x4d, 0xf0, 0xc5, 0x1f, 0x38, 0x8a, 0x9e, 0x27 }
27  },
28  {
29     16,
30     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
31       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f },
32     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
33       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f },
34     { 0xeb, 0xbd, 0x82, 0x2f, 0xa4, 0x58, 0xda, 0xf6,
35       0xdf, 0xda, 0xd7, 0xc2, 0x7d, 0xa7, 0x63, 0x38 }
36  },
37  {
38     20,
39     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
40       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f },
41     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
42       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,
43       0x10, 0x11, 0x12, 0x13 },
44     { 0x04, 0x12, 0xca, 0x15, 0x0b, 0xbf, 0x79, 0x05,
45       0x8d, 0x8c, 0x75, 0xa5, 0x8c, 0x99, 0x3f, 0x55 }
46  },
47  {
48     32,
49     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
50       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f },
51     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
52       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,
53       0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
54       0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f },
55     { 0xe9, 0x7a, 0xc0, 0x4e, 0x9e, 0x5e, 0x33, 0x99,
56       0xce, 0x53, 0x55, 0xcd, 0x74, 0x07, 0xbc, 0x75 }
57  },
58  {
59     34,
60     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
61       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f },
62     { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
63       0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,
64       0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
65       0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,
66       0x20, 0x21 },
67     { 0x5c, 0xba, 0x7d, 0x5e, 0xb2, 0x4f, 0x7c, 0x86,
68       0xcc, 0xc5, 0x46, 0x04, 0xe5, 0x3d, 0x55, 0x12 }
69  }
70  };
71     int err, x, idx;
72     unsigned long len;
73     unsigned char outtag[MAXBLOCKSIZE];
74      if ((idx = find_cipher("aes")) == -1) {
75         if ((idx = find_cipher("rijndael")) == -1) {
76            return CRYPT_NOP;
77         }
78      }
79      for (x = 0; x < (int)(sizeof(tests)/sizeof(tests[0])); x++) {
80          len = sizeof(outtag);
<span onclick='openModal()' class='match'>81          if ((err = pmac_memory(idx, tests[x].key, 16, tests[x].msg, tests[x].msglen, outtag, &len)) != CRYPT_OK) {
82             return err;
83          }
84          if (compare_testvector(outtag, len, tests[x].tag, sizeof(tests[x].tag), "PMAC", x)) {
85             return CRYPT_FAIL_TESTVECTOR;
86          }
</span>87      }
88      return CRYPT_OK;
89  #endif &bsol;* LTC_TEST */
90  }
91  #endif &bsol;* PMAC_MODE */
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-cbc_decrypt.c</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from libtomcrypt-MDEwOlJlcG9zaXRvcnk3NzcwMTE=-flat-pmac_test.c</div>
                </div>
                <div class="column column_space"><pre><code>21     if (len % cbc->blocklen) {
22        return CRYPT_INVALID_ARG;
23     }
24  #ifdef LTC_FAST
25     if (cbc->blocklen % sizeof(LTC_FAST_TYPE)) {
26        return CRYPT_INVALID_ARG;
27     }
</pre></code></div>
                <div class="column column_space"><pre><code>81          if ((err = pmac_memory(idx, tests[x].key, 16, tests[x].msg, tests[x].msglen, outtag, &len)) != CRYPT_OK) {
82             return err;
83          }
84          if (compare_testvector(outtag, len, tests[x].tag, sizeof(tests[x].tag), "PMAC", x)) {
85             return CRYPT_FAIL_TESTVECTOR;
86          }
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    