<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for im_csv2vips.c & im_tiff2vips.c</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for im_csv2vips.c & im_tiff2vips.c
      </h3>
      <h1 align="center">
        22.3%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>im_csv2vips.c (33.80282%)<TH>im_tiff2vips.c (16.666666%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match2854-0.html#0',2,'match2854-1.html#0',3)" NAME="0">(94-115)<TD><A HREF="javascript:ZweiFrames('match2854-0.html#0',2,'match2854-1.html#0',3)" NAME="0">(200-219)</A><TD ALIGN=center><FONT COLOR="#ff0000">24</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>im_csv2vips.c</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/* Read a csv file.
 * 
 * 16/12/11
 * 	- just a stub
 */

/*

    This file is part of VIPS.
    
    VIPS is free software; you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
    02110-1301  USA

 */

/*

    These files are distributed with VIPS - http://www.vips.ecs.soton.ac.uk

 */

#ifdef HAVE_CONFIG_H
#include &lt;config.h&gt;
#endif /*HAVE_CONFIG_H*/
#include &lt;vips/intl.h&gt;

#include &lt;ctype.h&gt;
#include &lt;stdio.h&gt;
#include &lt;errno.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;

#include &lt;vips/vips.h&gt;
#include &lt;vips/vips7compat.h&gt;

#include &quot;../foreign/pforeign.h&quot;

int
im_csv2vips( const char *filename, IMAGE *out )
{
	/* Read options.
	 */
	int start_skip = 0;
	char *whitespace = &quot; &quot;;
	char *separator = &quot;;,\t&quot;;
	int lines = -1;

	char name[FILENAME_MAX];
	char mode[FILENAME_MAX];
	char *p, *q, *r;

	VipsImage *x;

	/* Parse mode string.
	 */
	im_filename_split( filename, name, mode );
	p = &amp;mode[0];
	while( (q = im_getnextoption( &amp;p )) ) {
		if( im_isprefix( &quot;ski&quot;, q ) &amp;&amp; (r = im_getsuboption( q )) )
			start_skip = atoi( r );
		else if( im_isprefix( &quot;whi&quot;, q ) &amp;&amp; (r = im_getsuboption( q )) )
			whitespace = r;
		else if( im_isprefix( &quot;sep&quot;, q ) &amp;&amp; (r = im_getsuboption( q )) )
			separator = r;
		else if( im_isprefix( &quot;lin&quot;, q ) &amp;&amp; (r = im_getsuboption( q )) )
			lines = atoi( r );
	}

	if( vips_csvload( name, &amp;x, 
		&quot;skip&quot;, start_skip,
		&quot;lines&quot;, lines,
		&quot;whitespace&quot;, whitespace,
		&quot;separator&quot;, separator,
		NULL ) )
		return( -1 );
	if( vips_image_write( x, out ) ) {
		g_object_unref( x );
		return( -1 );
<A NAME="0"></A>	}
	g_object_unref( x );

<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match2854-1.html#0',3,'match2854-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>	return( 0 );
}

static const char *csv_suffs[] = { &quot;.csv&quot;, NULL };

/* csv format adds no new members.
 */
typedef VipsFormat VipsFormatCsv;
typedef VipsFormatClass VipsFormatCsvClass;

static void
vips_format_csv_class_init( VipsFormatCsvClass *class )
{
	VipsObjectClass *object_class = (VipsObjectClass *) class;
	VipsFormatClass *format_class = (VipsFormatClass *) class;

	object_class-&gt;nickname = &quot;csv&quot;;
	object_class-&gt;description = _( &quot;CSV&quot; );

	format_class-&gt;load = im_csv2vips;
	format_class-&gt;save = im_vips2csv;
	format_class-&gt;suffs = csv_suffs;</B></FONT>
}

static void
vips_format_csv_init( VipsFormatCsv *object )
{
}

G_DEFINE_TYPE( VipsFormatCsv, vips_format_csv, VIPS_TYPE_FORMAT );
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>im_tiff2vips.c</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/* vips7 compat stub for tiff loading ... see foreign/tiff2vips for the
 * replacement
 *
 * 6/12/11
 * 	- just a stub
 */

/*

    This file is part of VIPS.
    
    VIPS is free software; you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
    02110-1301  USA

 */

/*

    These files are distributed with VIPS - http://www.vips.ecs.soton.ac.uk

 */

/* 
#define DEBUG
 */

#ifdef HAVE_CONFIG_H
#include &lt;config.h&gt;
#endif /*HAVE_CONFIG_H*/
#include &lt;vips/intl.h&gt;

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#include &lt;vips/vips.h&gt;
#include &lt;vips/vips7compat.h&gt;
#include &lt;vips/internal.h&gt;
#include &lt;vips/thread.h&gt;

#include &quot;../foreign/pforeign.h&quot;

#ifdef HAVE_TIFF
static gboolean
im_istifftiled( const char *filename )
{
	VipsSource *source;
	gboolean result;

	if( !(source = vips_source_new_from_file( filename )) )
		return( FALSE );
	result = vips__istiff_source( source );
	VIPS_UNREF( source );

	return( result );
}

static int
im_tiff_read_header( const char *filename, VipsImage *out, 
	int page, int n, gboolean autorotate )
{
	VipsSource *source;

	if( !(source = vips_source_new_from_file( filename )) )
		return( -1 );
	if( vips__tiff_read_header_source( source, 
		out, page, n, autorotate, -1 ) ) {
		VIPS_UNREF( source );
		return( -1 );
	}
	VIPS_UNREF( source );

	return( 0 );
}

static int
im_tiff_read( const char *filename, VipsImage *out, 
	int page, int n, gboolean autorotate )
{
	VipsSource *source;

	if( !(source = vips_source_new_from_file( filename )) )
		return( -1 );
	if( vips__tiff_read_source( source, out, page, n, autorotate, -1 ) ) {
		VIPS_UNREF( source );
		return( -1 );
	}
	VIPS_UNREF( source );

	return( 0 );
}
#endif /*HAVE_TIFF*/

static int
tiff2vips( const char *name, IMAGE *out, gboolean header_only )
{
#ifdef HAVE_TIFF
	char filename[FILENAME_MAX];
	char mode[FILENAME_MAX];
	char *p, *q;
	int page;
	int seq;

	im_filename_split( name, filename, mode );

	page = 0;
	seq = 0;
	p = &amp;mode[0];
	if( (q = im_getnextoption( &amp;p )) ) {
		page = atoi( q );
	}
	if( (q = im_getnextoption( &amp;p )) ) {
		if( im_isprefix( &quot;seq&quot;, q ) )
			seq = 1;
	}

	/* We need to be compatible with the pre-sequential mode 
	 * im_tiff2vips(). This returned a &quot;t&quot; if given a &quot;p&quot; image, since it
	 * used writeline.
	 *
	 * If we're writing the image to a &quot;p&quot;, switch it to a &quot;t&quot;. And only
	 * for non-tiled (strip) images which we write with writeline.
	 *
	 * Don't do this for header read, since we don't want to force a
	 * malloc if all we are doing is looking at fields.
	 */

	if( !header_only &amp;&amp;
		!seq &amp;&amp;
		!im_istifftiled( filename ) &amp;&amp;
		out-&gt;dtype == VIPS_IMAGE_PARTIAL ) {
		if( vips__image_wio_output( out ) ) 
			return( -1 );
	}

	if( header_only ) {
		if( im_tiff_read_header( filename, out, page, 1, FALSE ) )
			return( -1 );
	}
	else {
		if( im_tiff_read( filename, out, page, 1, FALSE ) )
			return( -1 );
	}
#else
	vips_error( &quot;im_tiff2vips&quot;, 
		&quot;%s&quot;, _( &quot;no TIFF support in your libvips&quot; ) ); 

	return( -1 );
#endif /*HAVE_TIFF*/

	return( 0 );
}

int
im_tiff2vips( const char *name, IMAGE *out )
{
	return( tiff2vips( name, out, FALSE ) ); 
}

/* By having a separate header func, we get lazy.c to open via disc/mem.
 */
static int
im_tiff2vips_header( const char *name, IMAGE *out )
{
	return( tiff2vips( name, out, TRUE ) ); 
}

static VipsFormatFlags
tiff_flags( const char *name )
{
	char filename[FILENAME_MAX];
	char mode[FILENAME_MAX];

	im_filename_split( name, filename, mode );

	return( (VipsFormatFlags)
		vips_foreign_flags( &quot;tiffload&quot;, filename ) );
}

static int
istiff( const char *name )
{
	char filename[FILENAME_MAX];
	char mode[FILENAME_MAX];
<A NAME="0"></A>
	im_filename_split( name, filename, mode );

<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2854-0.html#0',2,'match2854-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>	return( vips_foreign_is_a( &quot;tiffload&quot;, filename ) );
}

static const char *tiff_suffs[] = { &quot;.tif&quot;, &quot;.tiff&quot;, NULL };

typedef VipsFormat VipsFormatTiff;
typedef VipsFormatClass VipsFormatTiffClass;

static void
vips_format_tiff_class_init( VipsFormatTiffClass *class )
{
	VipsObjectClass *object_class = (VipsObjectClass *) class;
	VipsFormatClass *format_class = (VipsFormatClass *) class;

	object_class-&gt;nickname = &quot;tiff&quot;;
	object_class-&gt;description = _( &quot;TIFF&quot; );

	format_class-&gt;is_a = istiff;
	format_class-&gt;header = im_tiff2vips_header;
	format_class-&gt;load = im_tiff2vips;</B></FONT>
	format_class-&gt;save = im_vips2tiff;
	format_class-&gt;get_flags = tiff_flags;
	format_class-&gt;suffs = tiff_suffs;
}

static void
vips_format_tiff_init( VipsFormatTiff *object )
{
}

G_DEFINE_TYPE( VipsFormatTiff, vips_format_tiff, VIPS_TYPE_FORMAT );
</PRE>
</div>
  </div>
</body>
</html>
