
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 33, <button onclick='openModal()' class='match'>CODE CLONE</button></h2>
        <div class="column">
            <h3>Adafruit_nRF52_Arduino-MDEwOlJlcG9zaXRvcnk3NDM1NDcyOQ==-flat-SEGGER_SYSVIEW.c</h3>
            <pre><code>1  #include &quot;SEGGER_SYSVIEW_Int.h&quot;
2  #include &quot;SEGGER_RTT.h&quot;
3  #include &lt;string.h&gt;
4  #include &lt;stdlib.h&gt;
5  #include &lt;stdarg.h&gt;
6  #if SEGGER_SYSVIEW_ID_SHIFT
7    #define SHRINK_ID(Id)   (((Id) - _SYSVIEW_Globals.RAMBaseAddress) &gt;&gt; SEGGER_SYSVIEW_ID_SHIFT)
8  #else
9    #define SHRINK_ID(Id)   ((Id) - _SYSVIEW_Globals.RAMBaseAddress)
10  #endif
11  #if SEGGER_SYSVIEW_RTT_CHANNEL &gt; 0
12    #define CHANNEL_ID_UP   SEGGER_SYSVIEW_RTT_CHANNEL
13    #define CHANNEL_ID_DOWN SEGGER_SYSVIEW_RTT_CHANNEL
14  #else
15    #define CHANNEL_ID_UP   _SYSVIEW_Globals.UpChannel
16    #define CHANNEL_ID_DOWN _SYSVIEW_Globals.DownChannel
17  #endif
18  #if SEGGER_SYSVIEW_TIMESTAMP_BITS &lt; 32  
19    #define MAKE_DELTA_32BIT(Delta) Delta &lt;&lt;= 32 - SEGGER_SYSVIEW_TIMESTAMP_BITS; \
20                                    Delta &gt;&gt;= 32 - SEGGER_SYSVIEW_TIMESTAMP_BITS;
21  #else
22    #define MAKE_DELTA_32BIT(Delta)
23  #endif
24  #define ENABLE_STATE_OFF        0
25  #define ENABLE_STATE_ON         1
26  #define ENABLE_STATE_DROPPING   2
27  #define FORMAT_FLAG_LEFT_JUSTIFY   (1u &lt;&lt; 0)
28  #define FORMAT_FLAG_PAD_ZERO       (1u &lt;&lt; 1)
29  #define FORMAT_FLAG_PRINT_SIGN     (1u &lt;&lt; 2)
30  #define FORMAT_FLAG_ALTERNATE      (1u &lt;&lt; 3)
31  #define MODULE_EVENT_OFFSET        (512)
32  typedef struct {
33    U8*       pBuffer;
34    U8*       pPayload;
35    U8*       pPayloadStart;
36    U32       Options;
37    unsigned  Cnt;
38  } SEGGER_SYSVIEW_PRINTF_DESC;
39  typedef struct {
40          U8                      EnableState;   
41          U8                      UpChannel;
42          U8                      RecursionCnt;
43          U32                     SysFreq;
44          U32                     CPUFreq;
45          U32                     LastTxTimeStamp;
46          U32                     RAMBaseAddress;
47  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
48          U32                     PacketCount;
49  #else
50          U32                     DropCount;
51          U8                      DownChannel;
52  #endif
53          U32                     DisabledEvents;
54    const SEGGER_SYSVIEW_OS_API*  pOSAPI;
55          SEGGER_SYSVIEW_SEND_SYS_DESC_FUNC*   pfSendSysDesc;
56  } SEGGER_SYSVIEW_GLOBALS;
57  static void _SendPacket(U8* pStartPacket, U8* pEndPacket, unsigned int EventId);
58  static const U8 _abSync[10] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
59  #ifdef SEGGER_SYSVIEW_SECTION
60    #if (defined __GNUC__)
61      __attribute__ ((section (SEGGER_SYSVIEW_SECTION))) static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
62      #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
63      __attribute__ ((section (SEGGER_SYSVIEW_SECTION))) static char _DownBuffer[8];  
64      #endif
65    #elif (defined __ICCARM__) || (defined __ICCRX__)
66      #pragma location=SEGGER_SYSVIEW_SECTION
67      static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
68      #pragma location=SEGGER_SYSVIEW_SECTION
69      static char _DownBuffer[8];  
70    #elif (defined __CC_ARM)
71      __attribute__ ((section (SEGGER_SYSVIEW_SECTION), zero_init)) static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
72      #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
73      __attribute__ ((section (SEGGER_SYSVIEW_SECTION), zero_init)) static char _DownBuffer[8];  
74      #endif
75    #else
76      static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
77      #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
78      static char _DownBuffer[8];  
79      #endif
80    #endif
81  #else
82      static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
83      #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
84      static char _DownBuffer[8];  
85      #endif
86  #endif
87  static SEGGER_SYSVIEW_GLOBALS _SYSVIEW_Globals;
88  static SEGGER_SYSVIEW_MODULE* _pFirstModule;
89  static U8                     _NumModules;
90  #define ENCODE_U32(pDest, Value) {                                                  \
91                                     U8* pSysviewPointer;                             \
92                                     U32 SysViewData;                                 \
93                                     pSysviewPointer = pDest;                         \
94                                     SysViewData = Value;                             \
95                                     while(SysViewData &gt; 0x7F) {                      \
96                                       *pSysviewPointer++ = (U8)(SysViewData | 0x80); \
97                                       SysViewData &gt;&gt;= 7;                             \
98                                     };                                               \
99                                     *pSysviewPointer++ = (U8)SysViewData;            \
100                                     pDest = pSysviewPointer;                         \
101                                   };
102  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 1)
103  static U8 _aPacket[SEGGER_SYSVIEW_MAX_PACKET_SIZE];
104  #define RECORD_START(PacketSize)  SEGGER_SYSVIEW_LOCK();                            \
105                                    pPayloadStart = _PreparePacket(_aPacket);
106  #define RECORD_END()              SEGGER_SYSVIEW_UNLOCK()
107  #else
108  #define RECORD_START(PacketSize)  U8 aPacket[(PacketSize)];                         \
109                                    pPayloadStart = _PreparePacket(aPacket);          \
110  
111  #define RECORD_END()
112  #endif
113  static U8* _EncodeData(U8* pPayload, const char* pSrc, unsigned int NumBytes) {
114    unsigned int n;
115    n = 0;
116    *pPayload++ = NumBytes;
117    while (n &lt; NumBytes) {
118      *pPayload++ = *pSrc++;
119      n++;
120    }
121    return pPayload;
122  }
123  static U8 *_EncodeStr(U8 *pPayload, const char *pText, unsigned int Limit) {
124    unsigned int n;
125    unsigned int Len;
126    Len = 0;
127    while(*(pText + Len) != 0) {
128      Len++;
129    }
130    if (Len &gt; Limit) {
131      Len = Limit;
132    }
133    if (Len &lt; 255)  {
134      *pPayload++ = Len; 
135    } else {
136      *pPayload++ = 255;
137      *pPayload++ = (Len &amp; 255);
138      *pPayload++ = ((Len &gt;&gt; 8) &amp; 255);
139    }
140    n = 0;
141    while (n &lt; Len) {
142      *pPayload++ = *pText++;
143      n++;
144    }
145    return pPayload;
146  }
147  static U8* _PreparePacket(U8* pPacket) {
148    return pPacket + 4;
149  }
150  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
151  static void _HandleIncomingPacket(void) {
152    U8  Cmd;
153    int Status;
154    Status = SEGGER_RTT_ReadNoLock(CHANNEL_ID_DOWN, &amp;Cmd, 1);
155    if (Status &gt; 0) {
156      switch (Cmd) {
157      case SEGGER_SYSVIEW_COMMAND_ID_START:
158        SEGGER_SYSVIEW_Start();
159        break;
160      case SEGGER_SYSVIEW_COMMAND_ID_STOP:
161        SEGGER_SYSVIEW_Stop();
162        break;
163      case SEGGER_SYSVIEW_COMMAND_ID_GET_SYSTIME:
164        SEGGER_SYSVIEW_RecordSystime();
165        break;
166      case SEGGER_SYSVIEW_COMMAND_ID_GET_TASKLIST:
167        SEGGER_SYSVIEW_SendTaskList();
168        break;
169      case SEGGER_SYSVIEW_COMMAND_ID_GET_SYSDESC:
170        SEGGER_SYSVIEW_GetSysDesc();
171        break;
172      case SEGGER_SYSVIEW_COMMAND_ID_GET_NUMMODULES:
173        SEGGER_SYSVIEW_SendNumModules();
174        break;
175      case SEGGER_SYSVIEW_COMMAND_ID_GET_MODULEDESC:
176        SEGGER_SYSVIEW_SendModuleDescription();
177        break;
178      case SEGGER_SYSVIEW_COMMAND_ID_GET_MODULE:
179        Status = SEGGER_RTT_ReadNoLock(CHANNEL_ID_DOWN, &amp;Cmd, 1);
180        if (Status &gt; 0) {
181          SEGGER_SYSVIEW_SendModule(Cmd);
182        }
183        break;
184      default:
185        if (Cmd &gt;= 128) { 
186          SEGGER_RTT_ReadNoLock(CHANNEL_ID_DOWN, &amp;Cmd, 1);
187        }
188        break;
189      }
190    }
191  }
192  #endif 
193  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
194  static int _TrySendOverflowPacket(void) {
195    U32 TimeStamp;
196    I32 Delta;
197    int Status;
198    U8  aPacket[11];
199    U8* pPayload;
200    aPacket[0] = SYSVIEW_EVTID_OVERFLOW;      
201    pPayload   = &amp;aPacket[1];
202    ENCODE_U32(pPayload, _SYSVIEW_Globals.DropCount);
203    TimeStamp  = SEGGER_SYSVIEW_GET_TIMESTAMP();
204    Delta = TimeStamp - _SYSVIEW_Globals.LastTxTimeStamp;
205    MAKE_DELTA_32BIT(Delta);
206    ENCODE_U32(pPayload, Delta);
207    Status = SEGGER_RTT_WriteSkipNoLock(CHANNEL_ID_UP, aPacket, pPayload - aPacket);
208    SEGGER_SYSVIEW_ON_EVENT_RECORDED(pPayload - aPacket);
209    if (Status) {
210      _SYSVIEW_Globals.LastTxTimeStamp = TimeStamp;
211      _SYSVIEW_Globals.EnableState--; 
212    } else {
213      _SYSVIEW_Globals.DropCount++;
214    }
215    return Status;
216  }
217  #endif  
218  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
219  static void _SendSyncInfo(void) {
220    SEGGER_RTT_WriteWithOverwriteNoLock(CHANNEL_ID_UP, _abSync, 10);
221    SEGGER_SYSVIEW_ON_EVENT_RECORDED(10);
222    SEGGER_SYSVIEW_RecordVoid(SYSVIEW_EVTID_TRACE_START);
223    {
224      U8* pPayload;
225      U8* pPayloadStart;
226      RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 4 * SEGGER_SYSVIEW_QUANTA_U32);
227      pPayload = pPayloadStart;
228      ENCODE_U32(pPayload, _SYSVIEW_Globals.SysFreq);
229      ENCODE_U32(pPayload, _SYSVIEW_Globals.CPUFreq);
230      ENCODE_U32(pPayload, _SYSVIEW_Globals.RAMBaseAddress);
231      ENCODE_U32(pPayload, SEGGER_SYSVIEW_ID_SHIFT);
232      _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_INIT);
233      RECORD_END();
234    }
235    if (_SYSVIEW_Globals.pfSendSysDesc) {
236      _SYSVIEW_Globals.pfSendSysDesc();
237    }
238    SEGGER_SYSVIEW_RecordSystime();
239    SEGGER_SYSVIEW_SendTaskList();
240    if (_NumModules &gt; 0) {
241      int n;
242      SEGGER_SYSVIEW_SendNumModules();
243      for (n = 0; n &lt; _NumModules; n++) {
244        SEGGER_SYSVIEW_SendModule(n);
245      }
246      SEGGER_SYSVIEW_SendModuleDescription();
247    }
248  }
249  #endif  
250  static void _SendPacket(U8* pStartPacket, U8* pEndPacket, unsigned int EventId) {
251    unsigned int  NumBytes;
252    U32           TimeStamp;
253    U32           Delta;
254  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
255    int           Status;
256  #endif
257  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0)
258    SEGGER_SYSVIEW_LOCK();
259  #endif
260  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
261    if (_SYSVIEW_Globals.EnableState == 0) {
262      goto SendDone;
263    }
264  #else
265    if (_SYSVIEW_Globals.EnableState == 1) {  
266      goto Send;
267    }
268    if (_SYSVIEW_Globals.EnableState == 0) {
269      goto SendDone;
270    }
271    if (_SYSVIEW_Globals.EnableState == 2) {
272      _TrySendOverflowPacket();
273      if (_SYSVIEW_Globals.EnableState != 1) {
274        goto SendDone;
275      }
276    }
277  Send:
278  #endif
279    if (EventId &lt; 32) {
280      if (_SYSVIEW_Globals.DisabledEvents &amp; ((U32)1u &lt;&lt; EventId)) {
281        goto SendDone;
282      }
283    }
284    if (EventId &lt; 24) {
285      *--pStartPacket = EventId;
286    } else {
287      NumBytes = pEndPacket - pStartPacket;
288      if (NumBytes &gt; 127) {
289        *--pStartPacket = (NumBytes &gt;&gt; 7);
290        *--pStartPacket = NumBytes | 0x80;
291      } else {
292        *--pStartPacket = NumBytes;
293      }
294      if (EventId &gt; 127) {
295        *--pStartPacket = (EventId &gt;&gt; 7);
296        *--pStartPacket = EventId | 0x80;
297      } else {
298        *--pStartPacket = EventId;
299      }
300    }
301    TimeStamp  = SEGGER_SYSVIEW_GET_TIMESTAMP();
302    Delta = TimeStamp - _SYSVIEW_Globals.LastTxTimeStamp;
303    MAKE_DELTA_32BIT(Delta);
304    ENCODE_U32(pEndPacket, Delta);
305  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
306    SEGGER_RTT_WriteWithOverwriteNoLock(CHANNEL_ID_UP, pStartPacket, pEndPacket - pStartPacket);
307    SEGGER_SYSVIEW_ON_EVENT_RECORDED(pEndPacket - pStartPacket);
308    _SYSVIEW_Globals.LastTxTimeStamp = TimeStamp;
309  #else
310    Status = SEGGER_RTT_WriteSkipNoLock(CHANNEL_ID_UP, pStartPacket, pEndPacket - pStartPacket);
311    SEGGER_SYSVIEW_ON_EVENT_RECORDED(pEndPacket - pStartPacket);
312    if (Status) {
313      _SYSVIEW_Globals.LastTxTimeStamp = TimeStamp;
314    } else {
315      _SYSVIEW_Globals.EnableState++; 
316    }
317  #endif
318  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
319    if (_SYSVIEW_Globals.RecursionCnt == 0) {   
320      _SYSVIEW_Globals.RecursionCnt = 1;
321      if (_SYSVIEW_Globals.PacketCount++ &amp; (1 &lt;&lt; SEGGER_SYSVIEW_SYNC_PERIOD_SHIFT)) {
322        _SendSyncInfo();
323        _SYSVIEW_Globals.PacketCount = 0;
324      }
325      _SYSVIEW_Globals.RecursionCnt = 0;
326    }
327  SendDone:
328    ; 
329  #else
330  SendDone:
331    if (SEGGER_RTT_HASDATA(CHANNEL_ID_DOWN)) {
332      if (_SYSVIEW_Globals.RecursionCnt == 0) {   
333        _SYSVIEW_Globals.RecursionCnt = 1;
334        _HandleIncomingPacket();
335        _SYSVIEW_Globals.RecursionCnt = 0;
336      }
337    }
338  #endif
339  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0)
340    SEGGER_SYSVIEW_UNLOCK();  
341  #endif
342  }
343  #ifndef SEGGER_SYSVIEW_EXCLUDE_PRINTF 
344  static int _VPrintHost(const char* s, U32 Options, va_list* pParamList) {
345    U32         aParas[SEGGER_SYSVIEW_MAX_ARGUMENTS];
346    U32*        pParas;
347    U32         NumArguments;
348    const char* p;
349    char        c;
350    U8*         pPayload;
351    U8*         pPayloadStart;
352  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
353    U8 HasNonScalar;
354    HasNonScalar = 0;
355  #endif  
356    p = s;
357    NumArguments = 0;
358    for (;;) {
359      c = *p++;
360      if (c == 0) {
361        break;
362      }
363      if (c == &#x27;%&#x27;) {
364        c = *p;
365  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT == 0
366        aParas[NumArguments++] = va_arg(*pParamList, int);
367        if (NumArguments == SEGGER_SYSVIEW_MAX_ARGUMENTS) {
368          break;
369        }
370  #else
371        if (c == &#x27;s&#x27;) {
372          HasNonScalar = 1;
373          break;
374        } else {
375          aParas[NumArguments++] = va_arg(*pParamList, int);
376          if (NumArguments == SEGGER_SYSVIEW_MAX_ARGUMENTS) {
377            break;
378          }
379        }
380  #endif
381      }
382    }
383  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
384    if (HasNonScalar) {
385      return -1;
386    }
387  #endif
388    {
389      RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_MAX_STRING_LEN + 2 * SEGGER_SYSVIEW_QUANTA_U32 + SEGGER_SYSVIEW_MAX_ARGUMENTS * SEGGER_SYSVIEW_QUANTA_U32);
390      pPayload = _EncodeStr(pPayloadStart, s, SEGGER_SYSVIEW_MAX_STRING_LEN);
391      ENCODE_U32(pPayload, Options);
392      ENCODE_U32(pPayload, NumArguments);
393      pParas = aParas;
394      while (NumArguments--) {
395        ENCODE_U32(pPayload, (*pParas));
396        pParas++;
397      }
398      _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
399      RECORD_END();
400    }
401    return 0;
402  }
403  static void _StoreChar(SEGGER_SYSVIEW_PRINTF_DESC * p, char c) {
404    unsigned int  Cnt;
405    U8*           pPayload;
406    U32           Options;
407    Cnt = p-&gt;Cnt;
408    if ((Cnt + 1u) &lt;= SEGGER_SYSVIEW_MAX_STRING_LEN) {
409      *(p-&gt;pPayload++) = c;
410      p-&gt;Cnt = Cnt + 1u;
411    }
412    if (p-&gt;Cnt == SEGGER_SYSVIEW_MAX_STRING_LEN) {
413      *(p-&gt;pPayloadStart) = p-&gt;Cnt;
414      pPayload = p-&gt;pPayload;
415      Options = p-&gt;Options;
416      ENCODE_U32(pPayload, Options);
417      ENCODE_U32(pPayload, 0);
418      _SendPacket(p-&gt;pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
419      p-&gt;pPayloadStart = _PreparePacket(p-&gt;pBuffer);
420      p-&gt;pPayload = p-&gt;pPayloadStart + 1u;
421      p-&gt;Cnt = 0u;
422    }
423  }
424  static void _PrintUnsigned(SEGGER_SYSVIEW_PRINTF_DESC * pBufferDesc, unsigned int v, unsigned int Base, unsigned int NumDigits, unsigned int FieldWidth, unsigned int FormatFlags) {
425    static const char _aV2C[16] = {&#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27; };
426    unsigned int      Div;
427    unsigned int      Digit;
428    unsigned int      Number;
429    unsigned int      Width;
430    char              c;
431    Number = v;
432    Digit = 1u;
433    Width = 1u;
434    while (Number &gt;= Base) {
435      Number = (Number / Base);
436      Width++;
437    }
438    if (NumDigits &gt; Width) {
439      Width = NumDigits;
440    }
441    if ((FormatFlags &amp; FORMAT_FLAG_LEFT_JUSTIFY) == 0u) {
442      if (FieldWidth != 0u) {
443        if (((FormatFlags &amp; FORMAT_FLAG_PAD_ZERO) == FORMAT_FLAG_PAD_ZERO) &amp;&amp; (NumDigits == 0u)) {
444          c = &#x27;0&#x27;;
445        } else {
446          c = &#x27; &#x27;;
447        }
448        while ((FieldWidth != 0u) &amp;&amp; (Width &lt; FieldWidth)) {
449          FieldWidth--;
450          _StoreChar(pBufferDesc, c);
451        }
452      }
453    }
454    while (1) {
455      if (NumDigits &gt; 1u) {       
456        NumDigits--;
457      } else {
458        Div = v / Digit;
459        if (Div &lt; Base) {        
460          break;
461        }
462      }
463      Digit *= Base;
464    }
465    do {
466      Div = v / Digit;
467      v -= Div * Digit;
468      _StoreChar(pBufferDesc, _aV2C[Div]);
469      Digit /= Base;
470    } while (Digit);
471    if ((FormatFlags &amp; FORMAT_FLAG_LEFT_JUSTIFY) == FORMAT_FLAG_LEFT_JUSTIFY) {
472      if (FieldWidth != 0u) {
473        while ((FieldWidth != 0u) &amp;&amp; (Width &lt; FieldWidth)) {
474          FieldWidth--;
475          _StoreChar(pBufferDesc, &#x27; &#x27;);
476        }
477      }
478    }
479  }
480  static void _PrintInt(SEGGER_SYSVIEW_PRINTF_DESC * pBufferDesc, int v, unsigned int Base, unsigned int NumDigits, unsigned int FieldWidth, unsigned int FormatFlags) {
481    unsigned int  Width;
482    int           Number;
483    Number = (v &lt; 0) ? -v : v;
484    Width = 1u;
485    while (Number &gt;= (int)Base) {
486      Number = (Number / (int)Base);
487      Width++;
488    }
489    if (NumDigits &gt; Width) {
490      Width = NumDigits;
491    }
492    if ((FieldWidth &gt; 0u) &amp;&amp; ((v &lt; 0) || ((FormatFlags &amp; FORMAT_FLAG_PRINT_SIGN) == FORMAT_FLAG_PRINT_SIGN))) {
493      FieldWidth--;
494    }
495    if ((((FormatFlags &amp; FORMAT_FLAG_PAD_ZERO) == 0u) || (NumDigits != 0u)) &amp;&amp; ((FormatFlags &amp; FORMAT_FLAG_LEFT_JUSTIFY) == 0u)) {
496      if (FieldWidth != 0u) {
497        while ((FieldWidth != 0u) &amp;&amp; (Width &lt; FieldWidth)) {
498          FieldWidth--;
499          _StoreChar(pBufferDesc, &#x27; &#x27;);
500        }
501      }
502    }
503    if (v &lt; 0) {
504      v = -v;
505      _StoreChar(pBufferDesc, &#x27;-&#x27;);
506    } else if ((FormatFlags &amp; FORMAT_FLAG_PRINT_SIGN) == FORMAT_FLAG_PRINT_SIGN) {
507      _StoreChar(pBufferDesc, &#x27;+&#x27;);
508    } else {
509    }
510    if (((FormatFlags &amp; FORMAT_FLAG_PAD_ZERO) == FORMAT_FLAG_PAD_ZERO) &amp;&amp; ((FormatFlags &amp; FORMAT_FLAG_LEFT_JUSTIFY) == 0u) &amp;&amp; (NumDigits == 0u)) {
511      if (FieldWidth != 0u) {
512        while ((FieldWidth != 0u) &amp;&amp; (Width &lt; FieldWidth)) {
513          FieldWidth--;
514          _StoreChar(pBufferDesc, &#x27;0&#x27;);
515        }
516      }
517    }
518    _PrintUnsigned(pBufferDesc, (unsigned int)v, Base, NumDigits, FieldWidth, FormatFlags);
519  }
520  static void _VPrintTarget(const char* sFormat, U32 Options, va_list* pParamList) {
521    SEGGER_SYSVIEW_PRINTF_DESC BufferDesc;
522    char          c;
523    int           v;
524    unsigned int  NumDigits;
525    unsigned int  FormatFlags;
526    unsigned int  FieldWidth;
527    U8*           pPayloadStart;
528  #if SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0
529    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_MAX_STRING_LEN + 1 + 2 * SEGGER_SYSVIEW_QUANTA_U32);
530    SEGGER_SYSVIEW_LOCK();
531  #else
532    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_MAX_STRING_LEN + 1 + 2 * SEGGER_SYSVIEW_QUANTA_U32);
533  #endif
534  #if SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0
535    BufferDesc.pBuffer        = aPacket;
536  #else
537    BufferDesc.pBuffer        = _aPacket;
538  #endif
539    BufferDesc.Cnt            = 0u;
540    BufferDesc.pPayloadStart  = pPayloadStart;
541    BufferDesc.pPayload       = BufferDesc.pPayloadStart + 1u;
542    BufferDesc.Options        =  Options;
543    do {
544      c = *sFormat;
545      sFormat++;
546      if (c == 0u) {
547        break;
548      }
549      if (c == &#x27;%&#x27;) {
550        FormatFlags = 0u;
551        v = 1;
552        do {
553          c = *sFormat;
554          switch (c) {
555          case &#x27;-&#x27;: FormatFlags |= FORMAT_FLAG_LEFT_JUSTIFY; sFormat++; break;
556          case &#x27;0&#x27;: FormatFlags |= FORMAT_FLAG_PAD_ZERO;     sFormat++; break;
557          case &#x27;+&#x27;: FormatFlags |= FORMAT_FLAG_PRINT_SIGN;   sFormat++; break;
558          case &#x27;#&#x27;: FormatFlags |= FORMAT_FLAG_ALTERNATE;    sFormat++; break;
559          default:  v = 0; break;
560          }
561        } while (v);
562        FieldWidth = 0u;
563        do {
564          c = *sFormat;
565          if ((c &lt; &#x27;0&#x27;) || (c &gt; &#x27;9&#x27;)) {
566            break;
567          }
568          sFormat++;
569          FieldWidth = (FieldWidth * 10u) + ((unsigned int)c - &#x27;0&#x27;);
570        } while (1);
571        NumDigits = 0u;
572        c = *sFormat;
573        if (c == &#x27;.&#x27;) {
574          sFormat++;
575          do {
576            c = *sFormat;
577            if ((c &lt; &#x27;0&#x27;) || (c &gt; &#x27;9&#x27;)) {
578              break;
579            }
580            sFormat++;
581            NumDigits = NumDigits * 10u + ((unsigned int)c - &#x27;0&#x27;);
582          } while (1);
583        }
584        c = *sFormat;
585        do {
586          if ((c == &#x27;l&#x27;) || (c == &#x27;h&#x27;)) {
587            c = *sFormat;
588            sFormat++;
589          } else {
590            break;
591          }
592        } while (1);
593        switch (c) {
594        case &#x27;c&#x27;: {
595          char c0;
596          v = va_arg(*pParamList, int);
597          c0 = (char)v;
598          _StoreChar(&amp;BufferDesc, c0);
599          break;
600        }
601        case &#x27;d&#x27;:
602          v = va_arg(*pParamList, int);
603          _PrintInt(&amp;BufferDesc, v, 10u, NumDigits, FieldWidth, FormatFlags);
604          break;
605        case &#x27;u&#x27;:
606          v = va_arg(*pParamList, int);
607          _PrintUnsigned(&amp;BufferDesc, (unsigned int)v, 10u, NumDigits, FieldWidth, FormatFlags);
608          break;
609        case &#x27;x&#x27;:
610        case &#x27;X&#x27;:
611          v = va_arg(*pParamList, int);
612          _PrintUnsigned(&amp;BufferDesc, (unsigned int)v, 16u, NumDigits, FieldWidth, FormatFlags);
613          break;
614        case &#x27;p&#x27;:
615          v = va_arg(*pParamList, int);
616          _PrintUnsigned(&amp;BufferDesc, (unsigned int)v, 16u, 8u, 8u, 0u);
617          break;
618        case &#x27;%&#x27;:
619          _StoreChar(&amp;BufferDesc, &#x27;%&#x27;);
620          break;
621        default:
622          break;
623        }
624        sFormat++;
625      } else {
626        _StoreChar(&amp;BufferDesc, c);
627      }
628    } while (*sFormat);
629    if (BufferDesc.Cnt != 0u) {
630      *(BufferDesc.pPayloadStart) = BufferDesc.Cnt;
631      ENCODE_U32(BufferDesc.pPayload, BufferDesc.Options);
632      ENCODE_U32(BufferDesc.pPayload, 0);
633      _SendPacket(BufferDesc.pPayloadStart, BufferDesc.pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
634    }
635  #if SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0
636    SEGGER_SYSVIEW_UNLOCK();
637    RECORD_END();
638  #else
639    RECORD_END();
640  #endif
641  }
642  #endif 
643  void SEGGER_SYSVIEW_Init(U32 SysFreq, U32 CPUFreq, const SEGGER_SYSVIEW_OS_API *pOSAPI, SEGGER_SYSVIEW_SEND_SYS_DESC_FUNC pfSendSysDesc) {
644  #ifdef SEGGER_RTT_SECTION
645    SEGGER_RTT_Init();
646  #endif
647  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
648  #if SEGGER_SYSVIEW_RTT_CHANNEL &gt; 0
649    SEGGER_RTT_ConfigUpBuffer(SEGGER_SYSVIEW_RTT_CHANNEL, &quot;SysView&quot;, &amp;_UpBuffer[0],   sizeof(_UpBuffer),   SEGGER_RTT_MODE_NO_BLOCK_SKIP);
650  #else
651    _SYSVIEW_Globals.UpChannel = SEGGER_RTT_AllocUpBuffer  (&quot;SysView&quot;, &amp;_UpBuffer[0],   sizeof(_UpBuffer),   SEGGER_RTT_MODE_NO_BLOCK_SKIP);
652  #endif
653    _SYSVIEW_Globals.RAMBaseAddress   = SEGGER_SYSVIEW_ID_BASE;
654    _SYSVIEW_Globals.LastTxTimeStamp  = SEGGER_SYSVIEW_GET_TIMESTAMP();
655    _SYSVIEW_Globals.pOSAPI           = pOSAPI;
656    _SYSVIEW_Globals.SysFreq          = SysFreq;
657    _SYSVIEW_Globals.CPUFreq          = CPUFreq;
658    _SYSVIEW_Globals.pfSendSysDesc    = pfSendSysDesc;
659    _SYSVIEW_Globals.EnableState      = 0;
660    _SYSVIEW_Globals.PacketCount      = 0;
661  #else 
662  #if SEGGER_SYSVIEW_RTT_CHANNEL &gt; 0
663    SEGGER_RTT_ConfigUpBuffer   (SEGGER_SYSVIEW_RTT_CHANNEL, &quot;SysView&quot;, &amp;_UpBuffer[0],   sizeof(_UpBuffer),   SEGGER_RTT_MODE_NO_BLOCK_SKIP);
664    SEGGER_RTT_ConfigDownBuffer (SEGGER_SYSVIEW_RTT_CHANNEL, &quot;SysView&quot;, &amp;_DownBuffer[0], sizeof(_DownBuffer), SEGGER_RTT_MODE_NO_BLOCK_SKIP);
665  #else
666    _SYSVIEW_Globals.UpChannel = SEGGER_RTT_AllocUpBuffer  (&quot;SysView&quot;, &amp;_UpBuffer[0],   sizeof(_UpBuffer),   SEGGER_RTT_MODE_NO_BLOCK_SKIP);
667    _SYSVIEW_Globals.DownChannel = _SYSVIEW_Globals.UpChannel;
668    SEGGER_RTT_ConfigDownBuffer (_SYSVIEW_Globals.DownChannel, &quot;SysView&quot;, &amp;_DownBuffer[0], sizeof(_DownBuffer), SEGGER_RTT_MODE_NO_BLOCK_SKIP);
669  #endif
670    _SYSVIEW_Globals.RAMBaseAddress   = SEGGER_SYSVIEW_ID_BASE;
671    _SYSVIEW_Globals.LastTxTimeStamp  = SEGGER_SYSVIEW_GET_TIMESTAMP();
672    _SYSVIEW_Globals.pOSAPI           = pOSAPI;
673    _SYSVIEW_Globals.SysFreq          = SysFreq;
674    _SYSVIEW_Globals.CPUFreq          = CPUFreq;
675    _SYSVIEW_Globals.pfSendSysDesc    = pfSendSysDesc;
676    _SYSVIEW_Globals.EnableState      = 0;
677  #endif  
678  }
679  void SEGGER_SYSVIEW_SetRAMBase(U32 RAMBaseAddress) {
680    _SYSVIEW_Globals.RAMBaseAddress = RAMBaseAddress;
681  }
682  void SEGGER_SYSVIEW_RecordVoid(unsigned int EventID) {
683    U8* pPayloadStart;
684    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
<span onclick='openModal()' class='match'>685    _SendPacket(pPayloadStart, pPayloadStart, EventID);
686    RECORD_END();
687  }
688  void SEGGER_SYSVIEW_RecordU32(unsigned int EventID, U32 Value) {
689    U8* pPayload;
690    U8* pPayloadStart;
691    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
</span>692    pPayload = pPayloadStart;
693    ENCODE_U32(pPayload, Value);
694    _SendPacket(pPayloadStart, pPayload, EventID);
695    RECORD_END();
696  }
697  void SEGGER_SYSVIEW_RecordU32x2(unsigned int EventID, U32 Para0, U32 Para1) {
698    U8* pPayload;
699    U8* pPayloadStart;
700    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
701    pPayload = pPayloadStart;
702    ENCODE_U32(pPayload, Para0);
703    ENCODE_U32(pPayload, Para1);
704    _SendPacket(pPayloadStart, pPayload, EventID);
705    RECORD_END();
706  }
707  void SEGGER_SYSVIEW_RecordU32x3(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2) {
708    U8* pPayload;
709    U8* pPayloadStart;
710    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 3 * SEGGER_SYSVIEW_QUANTA_U32);
711    pPayload = pPayloadStart;
712    ENCODE_U32(pPayload, Para0);
713    ENCODE_U32(pPayload, Para1);
714    ENCODE_U32(pPayload, Para2);
715    _SendPacket(pPayloadStart, pPayload, EventID);
716    RECORD_END();
717  }
718  void SEGGER_SYSVIEW_RecordU32x4(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3) {
719    U8* pPayload;
720    U8* pPayloadStart;
721    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 4 * SEGGER_SYSVIEW_QUANTA_U32);
722    pPayload = pPayloadStart;
723    ENCODE_U32(pPayload, Para0);
724    ENCODE_U32(pPayload, Para1);
725    ENCODE_U32(pPayload, Para2);
726    ENCODE_U32(pPayload, Para3);
727    _SendPacket(pPayloadStart, pPayload, EventID);
728    RECORD_END();
729  }
730  void SEGGER_SYSVIEW_RecordU32x5(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4) {
731    U8* pPayload;
732    U8* pPayloadStart;
733    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 5 * SEGGER_SYSVIEW_QUANTA_U32);
734    pPayload = pPayloadStart;
735    ENCODE_U32(pPayload, Para0);
736    ENCODE_U32(pPayload, Para1);
737    ENCODE_U32(pPayload, Para2);
738    ENCODE_U32(pPayload, Para3);
739    ENCODE_U32(pPayload, Para4);
740    _SendPacket(pPayloadStart, pPayload, EventID);
741    RECORD_END();
742  }
743  void SEGGER_SYSVIEW_RecordU32x6(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5) {
744    U8* pPayload;
745    U8* pPayloadStart;
746    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 6 * SEGGER_SYSVIEW_QUANTA_U32);
747    pPayload = pPayloadStart;
748    ENCODE_U32(pPayload, Para0);
749    ENCODE_U32(pPayload, Para1);
750    ENCODE_U32(pPayload, Para2);
751    ENCODE_U32(pPayload, Para3);
752    ENCODE_U32(pPayload, Para4);
753    ENCODE_U32(pPayload, Para5);
754    _SendPacket(pPayloadStart, pPayload, EventID);
755    RECORD_END();
756  }
757  void SEGGER_SYSVIEW_RecordU32x7(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5, U32 Para6) {
758    U8* pPayload;
759    U8* pPayloadStart;
760    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 7 * SEGGER_SYSVIEW_QUANTA_U32);
761    pPayload = pPayloadStart;
762    ENCODE_U32(pPayload, Para0);
763    ENCODE_U32(pPayload, Para1);
764    ENCODE_U32(pPayload, Para2);
765    ENCODE_U32(pPayload, Para3);
766    ENCODE_U32(pPayload, Para4);
767    ENCODE_U32(pPayload, Para5);
768    ENCODE_U32(pPayload, Para6);
769    _SendPacket(pPayloadStart, pPayload, EventID);
770    RECORD_END();
771  }
772  void SEGGER_SYSVIEW_RecordU32x8(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5, U32 Para6, U32 Para7) {
773    U8* pPayload;
774    U8* pPayloadStart;
775    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 8 * SEGGER_SYSVIEW_QUANTA_U32);
776    pPayload = pPayloadStart;
777    ENCODE_U32(pPayload, Para0);
778    ENCODE_U32(pPayload, Para1);
779    ENCODE_U32(pPayload, Para2);
780    ENCODE_U32(pPayload, Para3);
781    ENCODE_U32(pPayload, Para4);
782    ENCODE_U32(pPayload, Para5);
783    ENCODE_U32(pPayload, Para6);
784    ENCODE_U32(pPayload, Para7);
785    _SendPacket(pPayloadStart, pPayload, EventID);
786    RECORD_END();
787  }
788  void SEGGER_SYSVIEW_RecordU32x9(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5, U32 Para6, U32 Para7, U32 Para8) {
789    U8* pPayload;
790    U8* pPayloadStart;
791    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 9 * SEGGER_SYSVIEW_QUANTA_U32);
792    pPayload = pPayloadStart;
793    ENCODE_U32(pPayload, Para0);
794    ENCODE_U32(pPayload, Para1);
795    ENCODE_U32(pPayload, Para2);
796    ENCODE_U32(pPayload, Para3);
797    ENCODE_U32(pPayload, Para4);
798    ENCODE_U32(pPayload, Para5);
799    ENCODE_U32(pPayload, Para6);
800    ENCODE_U32(pPayload, Para7);
801    ENCODE_U32(pPayload, Para8);
802    _SendPacket(pPayloadStart, pPayload, EventID);
803    RECORD_END();
804  }
805  void SEGGER_SYSVIEW_RecordU32x10(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5, U32 Para6, U32 Para7, U32 Para8, U32 Para9) {
806    U8* pPayload;
807    U8* pPayloadStart;
808    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 10 * SEGGER_SYSVIEW_QUANTA_U32);
809    pPayload = pPayloadStart;
810    ENCODE_U32(pPayload, Para0);
811    ENCODE_U32(pPayload, Para1);
812    ENCODE_U32(pPayload, Para2);
813    ENCODE_U32(pPayload, Para3);
814    ENCODE_U32(pPayload, Para4);
815    ENCODE_U32(pPayload, Para5);
816    ENCODE_U32(pPayload, Para6);
817    ENCODE_U32(pPayload, Para7);
818    ENCODE_U32(pPayload, Para8);
819    ENCODE_U32(pPayload, Para9);
820    _SendPacket(pPayloadStart, pPayload, EventID);
821    RECORD_END();
822  }
823  void SEGGER_SYSVIEW_RecordString(unsigned int EventID, const char* pString) {
824    U8* pPayload;
825    U8* pPayloadStart;
826    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
827    pPayload = _EncodeStr(pPayloadStart, pString, SEGGER_SYSVIEW_MAX_STRING_LEN);
828    _SendPacket(pPayloadStart, pPayload, EventID);
829    RECORD_END();
830  }
831  void SEGGER_SYSVIEW_Start(void) {
832  #if (SEGGER_SYSVIEW_CAN_RESTART == 0)
833    if (_SYSVIEW_Globals.EnableState == 0) {
834  #endif
835      _SYSVIEW_Globals.EnableState = 1;
836  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
837      _SendSyncInfo();
838  #else
839      SEGGER_SYSVIEW_LOCK();
840      SEGGER_RTT_WriteSkipNoLock(CHANNEL_ID_UP, _abSync, 10);
841      SEGGER_SYSVIEW_UNLOCK();
842      SEGGER_SYSVIEW_ON_EVENT_RECORDED(10);
843      SEGGER_SYSVIEW_RecordVoid(SYSVIEW_EVTID_TRACE_START);
844      {
845        U8* pPayload;
846        U8* pPayloadStart;
847        RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 4 * SEGGER_SYSVIEW_QUANTA_U32);
848        pPayload = pPayloadStart;
849        ENCODE_U32(pPayload, _SYSVIEW_Globals.SysFreq);
850        ENCODE_U32(pPayload, _SYSVIEW_Globals.CPUFreq);
851        ENCODE_U32(pPayload, _SYSVIEW_Globals.RAMBaseAddress);
852        ENCODE_U32(pPayload, SEGGER_SYSVIEW_ID_SHIFT);
853        _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_INIT);
854        RECORD_END();
855      }
856      if (_SYSVIEW_Globals.pfSendSysDesc) {
857        _SYSVIEW_Globals.pfSendSysDesc();
858      }
859      SEGGER_SYSVIEW_RecordSystime();
860      SEGGER_SYSVIEW_SendTaskList();
861      SEGGER_SYSVIEW_SendNumModules();
862  #endif
863  #if (SEGGER_SYSVIEW_CAN_RESTART == 0)
864    }
865  #endif
866  }
867  void SEGGER_SYSVIEW_Stop(void) {
868    U8* pPayloadStart;
869    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
870    if (_SYSVIEW_Globals.EnableState) {
871      _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_TRACE_STOP);
872      _SYSVIEW_Globals.EnableState = 0;
873    }
874    RECORD_END();
875  }
876  int SEGGER_SYSVIEW_GetChannelID(void) {
877    return CHANNEL_ID_UP;
878  }
879  void SEGGER_SYSVIEW_GetSysDesc(void) {
880    U8* pPayload;
881    U8* pPayloadStart;
882    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 4 * SEGGER_SYSVIEW_QUANTA_U32);
883    pPayload = pPayloadStart;
884    ENCODE_U32(pPayload, _SYSVIEW_Globals.SysFreq);
885    ENCODE_U32(pPayload, _SYSVIEW_Globals.CPUFreq);
886    ENCODE_U32(pPayload, _SYSVIEW_Globals.RAMBaseAddress);
887    ENCODE_U32(pPayload, SEGGER_SYSVIEW_ID_SHIFT);
888    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_INIT);
889    RECORD_END();
890    if (_SYSVIEW_Globals.pfSendSysDesc) {
891      _SYSVIEW_Globals.pfSendSysDesc();
892    }
893  }
894  void SEGGER_SYSVIEW_SendTaskInfo(const SEGGER_SYSVIEW_TASKINFO *pInfo) {
895    U8* pPayload;
896    U8* pPayloadStart;
897    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32 + 1 + 32);
898    pPayload = pPayloadStart;
899    ENCODE_U32(pPayload, SHRINK_ID(pInfo-&gt;TaskID));
900    ENCODE_U32(pPayload, pInfo-&gt;Prio);
901    pPayload = _EncodeStr(pPayload, pInfo-&gt;sName, 32);
902    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_INFO);
903    pPayload = pPayloadStart;
904    ENCODE_U32(pPayload, SHRINK_ID(pInfo-&gt;TaskID));
905    ENCODE_U32(pPayload, pInfo-&gt;StackBase);
906    ENCODE_U32(pPayload, pInfo-&gt;StackSize);
907    ENCODE_U32(pPayload, 0); 
908    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_STACK_INFO);
909    RECORD_END();
910  }
911  void SEGGER_SYSVIEW_SendTaskList(void) {
912    if (_SYSVIEW_Globals.pOSAPI &amp;&amp; _SYSVIEW_Globals.pOSAPI-&gt;pfSendTaskList) {
913      _SYSVIEW_Globals.pOSAPI-&gt;pfSendTaskList();
914    }
915  }
916  void SEGGER_SYSVIEW_SendSysDesc(const char *sSysDesc) {
917    U8* pPayload;
918    U8* pPayloadStart;
919    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
920    pPayload = _EncodeStr(pPayloadStart, sSysDesc, SEGGER_SYSVIEW_MAX_STRING_LEN);
921    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_SYSDESC);
922    RECORD_END();
923  }
924  void SEGGER_SYSVIEW_RecordSystime(void) {
925    U64 Systime;
926    if (_SYSVIEW_Globals.pOSAPI &amp;&amp; _SYSVIEW_Globals.pOSAPI-&gt;pfGetTime) {
927      Systime = _SYSVIEW_Globals.pOSAPI-&gt;pfGetTime();
928      SEGGER_SYSVIEW_RecordU32x2(SYSVIEW_EVTID_SYSTIME_US,
929                                 (U32)(Systime),
930                                 (U32)(Systime &gt;&gt; 32));
931    } else {
932      SEGGER_SYSVIEW_RecordU32(SYSVIEW_EVTID_SYSTIME_CYCLES, SEGGER_SYSVIEW_GET_TIMESTAMP());
933    }
934  }
935  void SEGGER_SYSVIEW_RecordEnterISR(void) {
936    unsigned v;
937    U8* pPayload;
938    U8* pPayloadStart;
939    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
940    pPayload = pPayloadStart;
941    v = SEGGER_SYSVIEW_GET_INTERRUPT_ID();
942    ENCODE_U32(pPayload, v);
943    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_ISR_ENTER);
944    RECORD_END();
945  }
946  void SEGGER_SYSVIEW_RecordExitISR(void) {
947    U8* pPayloadStart;
948    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
949    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_ISR_EXIT);
950    RECORD_END();
951  }
952  void SEGGER_SYSVIEW_RecordExitISRToScheduler(void) {
953    U8* pPayloadStart;
954    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
955    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_ISR_TO_SCHEDULER);
956    RECORD_END();
957  }
958  void SEGGER_SYSVIEW_RecordEnterTimer(U32 TimerId) {
959    U8* pPayload;
960    U8* pPayloadStart;
961    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
962    pPayload = pPayloadStart;
963    ENCODE_U32(pPayload, SHRINK_ID(TimerId));
964    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TIMER_ENTER);
965    RECORD_END();
966  }
967  void SEGGER_SYSVIEW_RecordExitTimer(void) {
968    U8* pPayloadStart;
969    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
970    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_TIMER_EXIT);
971    RECORD_END();
972  }
973  void SEGGER_SYSVIEW_RecordEndCall(unsigned int EventID) {
974    U8* pPayload;
975    U8* pPayloadStart;
976    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
977    pPayload = pPayloadStart;
978    ENCODE_U32(pPayload, EventID);
979    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_END_CALL);
980    RECORD_END();
981  }
982  void SEGGER_SYSVIEW_RecordEndCallU32(unsigned int EventID, U32 Para0) {
983    U8* pPayload;
984    U8* pPayloadStart;
985    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
986    pPayload = pPayloadStart;
987    ENCODE_U32(pPayload, EventID);
988    ENCODE_U32(pPayload, Para0);
989    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_END_CALL);
990    RECORD_END();
991  }
992  void SEGGER_SYSVIEW_OnIdle(void) {
993    U8* pPayloadStart;
994    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
995    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_IDLE);
996    RECORD_END();
997  }
998  void SEGGER_SYSVIEW_OnTaskCreate(U32 TaskId) {
999    U8* pPayload;
1000    U8* pPayloadStart;
1001    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1002    pPayload = pPayloadStart;
1003    TaskId = SHRINK_ID(TaskId);
1004    ENCODE_U32(pPayload, TaskId);
1005    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_CREATE);
1006    RECORD_END();
1007  }
1008  void SEGGER_SYSVIEW_OnTaskTerminate(U32 TaskId) {
1009    U8* pPayload;
1010    U8* pPayloadStart;
1011    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1012    pPayload = pPayloadStart;
1013    TaskId = SHRINK_ID(TaskId);
1014    ENCODE_U32(pPayload, TaskId);
1015    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_TERMINATE);
1016    RECORD_END();
1017  }
1018  void SEGGER_SYSVIEW_OnTaskStartExec(U32 TaskId) {
1019    U8* pPayload;
1020    U8* pPayloadStart;
1021    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1022    pPayload = pPayloadStart;
1023    TaskId = SHRINK_ID(TaskId);
1024    ENCODE_U32(pPayload, TaskId);
1025    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_START_EXEC);
1026    RECORD_END();
1027  }
1028  void SEGGER_SYSVIEW_OnTaskStopExec(void) {
1029    U8* pPayloadStart;
1030    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
1031    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_TASK_STOP_EXEC);
1032    RECORD_END();
1033  }
1034  void SEGGER_SYSVIEW_OnTaskStartReady(U32 TaskId) {
1035    U8* pPayload;
1036    U8* pPayloadStart;
1037    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1038    pPayload = pPayloadStart;
1039    TaskId = SHRINK_ID(TaskId);
1040    ENCODE_U32(pPayload, TaskId);
1041    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_START_READY);
1042    RECORD_END();
1043  }
1044  void SEGGER_SYSVIEW_OnTaskStopReady(U32 TaskId, unsigned int Cause) {
1045    U8* pPayload;
1046    U8* pPayloadStart;
1047    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
1048    pPayload = pPayloadStart;
1049    TaskId = SHRINK_ID(TaskId);
1050    ENCODE_U32(pPayload, TaskId);
1051    ENCODE_U32(pPayload, Cause);
1052    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_STOP_READY);
1053    RECORD_END();
1054  }
1055  void SEGGER_SYSVIEW_MarkStart(unsigned MarkerId) {
1056    U8* pPayload;
1057    U8* pPayloadStart;
1058    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1059    pPayload = pPayloadStart;
1060    ENCODE_U32(pPayload, MarkerId);
1061    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_MARK_START);
1062    RECORD_END();
1063  }
1064  void SEGGER_SYSVIEW_MarkStop(unsigned MarkerId) {
1065    U8 * pPayload;
1066    U8 * pPayloadStart;
1067    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1068    pPayload = pPayloadStart;
1069    ENCODE_U32(pPayload, MarkerId);
1070    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_MARK_STOP);
1071    RECORD_END();
1072  }
1073  void SEGGER_SYSVIEW_Mark(unsigned int MarkerId) {
1074    U8* pPayload;
1075    U8* pPayloadStart;
1076    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
1077    pPayload = pPayloadStart;
1078    ENCODE_U32(pPayload, SYSVIEW_EVTID_EX_MARK);
1079    ENCODE_U32(pPayload, MarkerId);
1080    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_EX);
1081    RECORD_END();
1082  }
1083  void SEGGER_SYSVIEW_NameMarker(unsigned int MarkerId, const char* sName) {
1084    U8* pPayload;
1085    U8* pPayloadStart;
1086    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1087    pPayload = pPayloadStart;
1088    ENCODE_U32(pPayload, SYSVIEW_EVTID_EX_NAME_MARKER);
1089    ENCODE_U32(pPayload, MarkerId);
1090    pPayload = _EncodeStr(pPayload, sName, SEGGER_SYSVIEW_MAX_STRING_LEN);
1091    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_EX);
1092    RECORD_END();
1093  }
1094  void SEGGER_SYSVIEW_NameResource(U32 ResourceId, const char* sName) {
1095    U8* pPayload;
1096    U8* pPayloadStart;
1097    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32 + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1098    pPayload = pPayloadStart;
1099    ENCODE_U32(pPayload, SHRINK_ID(ResourceId));
1100    pPayload = _EncodeStr(pPayload, sName, SEGGER_SYSVIEW_MAX_STRING_LEN);
1101    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_NAME_RESOURCE);
1102    RECORD_END();
1103  }
1104  int SEGGER_SYSVIEW_SendPacket(U8* pPacket, U8* pPayloadEnd, unsigned int EventId) {
1105  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 1)
1106    SEGGER_SYSVIEW_LOCK();
1107  #endif
1108    _SendPacket(pPacket + 4, pPayloadEnd, EventId);
1109  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 1)
1110    SEGGER_SYSVIEW_UNLOCK();
1111  #endif
1112    return 0;
1113  }
1114  U8* SEGGER_SYSVIEW_EncodeU32(U8* pPayload, U32 Value) {
1115    ENCODE_U32(pPayload, Value);
1116    return pPayload;
1117  }
1118  U8* SEGGER_SYSVIEW_EncodeString(U8* pPayload, const char* s, unsigned int MaxLen) {
1119    return _EncodeStr(pPayload, s, MaxLen);
1120  }
1121  U8* SEGGER_SYSVIEW_EncodeData(U8 *pPayload, const char* pSrc, unsigned int NumBytes) {
1122    return _EncodeData(pPayload, pSrc, NumBytes);
1123  }
1124  U8* SEGGER_SYSVIEW_EncodeId(U8* pPayload, U32 Id) {
1125    Id = SHRINK_ID(Id);
1126    ENCODE_U32(pPayload, Id);
1127    return pPayload;
1128  }
1129  U32 SEGGER_SYSVIEW_ShrinkId(U32 Id) {
1130    return SHRINK_ID(Id);
1131  }
1132  void SEGGER_SYSVIEW_RegisterModule(SEGGER_SYSVIEW_MODULE* pModule) {
1133    SEGGER_SYSVIEW_LOCK();
1134    if (_pFirstModule == 0) {
1135      pModule-&gt;EventOffset = MODULE_EVENT_OFFSET;
1136      pModule-&gt;pNext = 0;
1137      _pFirstModule = pModule;
1138      _NumModules = 1;
1139    } else {
1140      pModule-&gt;EventOffset = _pFirstModule-&gt;EventOffset + _pFirstModule-&gt;NumEvents;
1141      pModule-&gt;pNext = _pFirstModule;
1142      _pFirstModule = pModule;
1143      _NumModules++;
1144    }
1145    SEGGER_SYSVIEW_SendModule(0);
1146    if (pModule-&gt;pfSendModuleDesc) {
1147      pModule-&gt;pfSendModuleDesc();
1148    }
1149    SEGGER_SYSVIEW_UNLOCK();
1150  }
1151  void SEGGER_SYSVIEW_RecordModuleDescription(const SEGGER_SYSVIEW_MODULE* pModule, const char* sDescription) {
1152    U8  ModuleId;
1153    SEGGER_SYSVIEW_MODULE* p;
1154    p = _pFirstModule;
1155    ModuleId = 0;
1156    do {
1157      if (p == pModule) {
1158        break;
1159      }
1160      ModuleId++;
1161      p = p-&gt;pNext;
1162    } while (p);
1163    {
1164      U8* pPayload;
1165      U8* pPayloadStart;
1166      RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1167      pPayload = pPayloadStart;
1168      ENCODE_U32(pPayload, ModuleId);
1169      ENCODE_U32(pPayload, (pModule-&gt;EventOffset));
1170      pPayload = _EncodeStr(pPayload, sDescription, SEGGER_SYSVIEW_MAX_STRING_LEN);
1171      _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_MODULEDESC);
1172      RECORD_END();
1173    }
1174  }
1175  void SEGGER_SYSVIEW_SendModule(U8 ModuleId) {
1176    SEGGER_SYSVIEW_MODULE* pModule;
1177    U32 n;
1178    if (_pFirstModule != 0) {
1179      pModule = _pFirstModule;
1180      for (n = 0; n &lt; ModuleId; n++) {
1181        pModule = pModule-&gt;pNext;
1182        if (pModule == 0) {
1183          break;
1184        }
1185      }
1186      if (pModule != 0) {
1187        U8* pPayload;
1188        U8* pPayloadStart;
1189        RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1190        pPayload = pPayloadStart;
1191        ENCODE_U32(pPayload, ModuleId);
1192        ENCODE_U32(pPayload, (pModule-&gt;EventOffset));
1193        pPayload = _EncodeStr(pPayload, pModule-&gt;sModule, SEGGER_SYSVIEW_MAX_STRING_LEN);
1194        _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_MODULEDESC);
1195        RECORD_END();
1196      }
1197    }
1198  }
1199  void SEGGER_SYSVIEW_SendModuleDescription(void) {
1200    SEGGER_SYSVIEW_MODULE* pModule;
1201    if (_pFirstModule != 0) {
1202      pModule = _pFirstModule;
1203      do {
1204        if (pModule-&gt;pfSendModuleDesc) {
1205          pModule-&gt;pfSendModuleDesc();
1206        }
1207        pModule = pModule-&gt;pNext;
1208      } while (pModule);
1209    }
1210  }
1211  void SEGGER_SYSVIEW_SendNumModules(void) {
1212    U8* pPayload;
1213    U8* pPayloadStart;
1214    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2*SEGGER_SYSVIEW_QUANTA_U32);
1215    pPayload = pPayloadStart;
1216    ENCODE_U32(pPayload, _NumModules);
1217    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_NUMMODULES);
1218    RECORD_END();
1219  }
1220  #ifndef SEGGER_SYSVIEW_EXCLUDE_PRINTF 
1221  void SEGGER_SYSVIEW_PrintfHostEx(const char* s, U32 Options, ...) {
1222    va_list ParamList;
1223  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
1224    int r;
1225    va_start(ParamList, Options);
1226    r = _VPrintHost(s, Options, &amp;ParamList);
1227    va_end(ParamList);
1228    if (r == -1) {
1229      va_start(ParamList, Options);
1230      _VPrintTarget(s, Options, &amp;ParamList);
1231      va_end(ParamList);
1232    }
1233  #else
1234    va_start(ParamList, Options);
1235    _VPrintHost(s, Options, &amp;ParamList);
1236    va_end(ParamList);
1237  #endif
1238  }
1239  void SEGGER_SYSVIEW_PrintfHost(const char* s, ...) {
1240    va_list ParamList;
1241  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
1242    int r;
1243    va_start(ParamList, s);
1244    r = _VPrintHost(s, SEGGER_SYSVIEW_LOG, &amp;ParamList);
1245    va_end(ParamList);
1246    if (r == -1) {
1247      va_start(ParamList, s);
1248      _VPrintTarget(s, SEGGER_SYSVIEW_LOG, &amp;ParamList);
1249      va_end(ParamList);
1250    }
1251  #else
1252    va_start(ParamList, s);
1253    _VPrintHost(s, SEGGER_SYSVIEW_LOG, &amp;ParamList);
1254    va_end(ParamList);
1255  #endif
1256  }
1257  void SEGGER_SYSVIEW_WarnfHost(const char* s, ...) {
1258    va_list ParamList;
1259  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
1260    int r;
1261    va_start(ParamList, s);
1262    r = _VPrintHost(s, SEGGER_SYSVIEW_WARNING, &amp;ParamList);
1263    va_end(ParamList);
1264    if (r == -1) {
1265      va_start(ParamList, s);
1266      _VPrintTarget(s, SEGGER_SYSVIEW_WARNING, &amp;ParamList);
1267      va_end(ParamList);
1268    }
1269  #else
1270    va_start(ParamList, s);
1271    _VPrintHost(s, SEGGER_SYSVIEW_WARNING, &amp;ParamList);
1272    va_end(ParamList);
1273  #endif
1274  }
1275  void SEGGER_SYSVIEW_ErrorfHost(const char* s, ...) {
1276    va_list ParamList;
1277  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
1278    int r;
1279    va_start(ParamList, s);
1280    r = _VPrintHost(s, SEGGER_SYSVIEW_ERROR, &amp;ParamList);
1281    va_end(ParamList);
1282    if (r == -1) {
1283      va_start(ParamList, s);
1284      _VPrintTarget(s, SEGGER_SYSVIEW_ERROR, &amp;ParamList);
1285      va_end(ParamList);
1286    }
1287  #else
1288    va_start(ParamList, s);
1289    _VPrintHost(s, SEGGER_SYSVIEW_ERROR, &amp;ParamList);
1290    va_end(ParamList);
1291  #endif
1292  }
1293  void SEGGER_SYSVIEW_PrintfTargetEx(const char* s, U32 Options, ...) {
1294    va_list ParamList;
1295    va_start(ParamList, Options);
1296    _VPrintTarget(s, Options, &amp;ParamList);
1297    va_end(ParamList);
1298  }
1299  void SEGGER_SYSVIEW_PrintfTarget(const char* s, ...) {
1300    va_list ParamList;
1301    va_start(ParamList, s);
1302    _VPrintTarget(s, SEGGER_SYSVIEW_LOG, &amp;ParamList);
1303    va_end(ParamList);
1304  }
1305  void SEGGER_SYSVIEW_WarnfTarget(const char* s, ...) {
1306    va_list ParamList;
1307    va_start(ParamList, s);
1308    _VPrintTarget(s, SEGGER_SYSVIEW_WARNING, &amp;ParamList);
1309    va_end(ParamList);
1310  }
1311  void SEGGER_SYSVIEW_ErrorfTarget(const char* s, ...) {
1312    va_list ParamList;
1313    va_start(ParamList, s);
1314    _VPrintTarget(s, SEGGER_SYSVIEW_ERROR, &amp;ParamList);
1315    va_end(ParamList);
1316  }
1317  #endif 
1318  void SEGGER_SYSVIEW_Print(const char* s) {
1319    U8* pPayload;
1320    U8* pPayloadStart;
1321    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1322    pPayload = _EncodeStr(pPayloadStart, s, SEGGER_SYSVIEW_MAX_STRING_LEN);
1323    ENCODE_U32(pPayload, SEGGER_SYSVIEW_LOG);
1324    ENCODE_U32(pPayload, 0);
1325    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
1326    RECORD_END();
1327  }
1328  void SEGGER_SYSVIEW_Warn(const char* s) {
1329    U8* pPayload;
1330    U8* pPayloadStart;
1331    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1332    pPayload = _EncodeStr(pPayloadStart, s, SEGGER_SYSVIEW_MAX_STRING_LEN);
1333    ENCODE_U32(pPayload, SEGGER_SYSVIEW_WARNING);
1334    ENCODE_U32(pPayload, 0);
1335    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
1336    RECORD_END();
1337  }
1338  void SEGGER_SYSVIEW_Error(const char* s) {
1339    U8* pPayload;
1340    U8* pPayloadStart;
1341    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1342    pPayload = _EncodeStr(pPayloadStart, s, SEGGER_SYSVIEW_MAX_STRING_LEN);
1343    ENCODE_U32(pPayload, SEGGER_SYSVIEW_ERROR);
1344    ENCODE_U32(pPayload, 0);
1345    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
1346    RECORD_END();
1347  }
1348  void SEGGER_SYSVIEW_EnableEvents(U32 EnableMask) {
1349    _SYSVIEW_Globals.DisabledEvents &amp;= ~EnableMask;
1350  }
1351  void SEGGER_SYSVIEW_DisableEvents(U32 DisableMask) {
1352    _SYSVIEW_Globals.DisabledEvents |= DisableMask;
1353  }
1354  int SEGGER_SYSVIEW_IsStarted(void) {
1355  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
1356    if (SEGGER_RTT_HASDATA(CHANNEL_ID_DOWN)) {
1357      if (_SYSVIEW_Globals.RecursionCnt == 0) {   
1358        _SYSVIEW_Globals.RecursionCnt = 1;
1359        _HandleIncomingPacket();
1360        _SYSVIEW_Globals.RecursionCnt = 0;
1361      }
1362    }
1363  #endif
1364    return _SYSVIEW_Globals.EnableState;
1365  }
</code></pre>
        </div>
        <div class="column">
            <h3>Adafruit_nRF52_Arduino-MDEwOlJlcG9zaXRvcnk3NDM1NDcyOQ==-flat-SEGGER_SYSVIEW.c</h3>
            <pre><code>1  #include &quot;SEGGER_SYSVIEW_Int.h&quot;
2  #include &quot;SEGGER_RTT.h&quot;
3  #include &lt;string.h&gt;
4  #include &lt;stdlib.h&gt;
5  #include &lt;stdarg.h&gt;
6  #if SEGGER_SYSVIEW_ID_SHIFT
7    #define SHRINK_ID(Id)   (((Id) - _SYSVIEW_Globals.RAMBaseAddress) &gt;&gt; SEGGER_SYSVIEW_ID_SHIFT)
8  #else
9    #define SHRINK_ID(Id)   ((Id) - _SYSVIEW_Globals.RAMBaseAddress)
10  #endif
11  #if SEGGER_SYSVIEW_RTT_CHANNEL &gt; 0
12    #define CHANNEL_ID_UP   SEGGER_SYSVIEW_RTT_CHANNEL
13    #define CHANNEL_ID_DOWN SEGGER_SYSVIEW_RTT_CHANNEL
14  #else
15    #define CHANNEL_ID_UP   _SYSVIEW_Globals.UpChannel
16    #define CHANNEL_ID_DOWN _SYSVIEW_Globals.DownChannel
17  #endif
18  #if SEGGER_SYSVIEW_TIMESTAMP_BITS &lt; 32  
19    #define MAKE_DELTA_32BIT(Delta) Delta &lt;&lt;= 32 - SEGGER_SYSVIEW_TIMESTAMP_BITS; \
20                                    Delta &gt;&gt;= 32 - SEGGER_SYSVIEW_TIMESTAMP_BITS;
21  #else
22    #define MAKE_DELTA_32BIT(Delta)
23  #endif
24  #define ENABLE_STATE_OFF        0
25  #define ENABLE_STATE_ON         1
26  #define ENABLE_STATE_DROPPING   2
27  #define FORMAT_FLAG_LEFT_JUSTIFY   (1u &lt;&lt; 0)
28  #define FORMAT_FLAG_PAD_ZERO       (1u &lt;&lt; 1)
29  #define FORMAT_FLAG_PRINT_SIGN     (1u &lt;&lt; 2)
30  #define FORMAT_FLAG_ALTERNATE      (1u &lt;&lt; 3)
31  #define MODULE_EVENT_OFFSET        (512)
32  typedef struct {
33    U8*       pBuffer;
34    U8*       pPayload;
35    U8*       pPayloadStart;
36    U32       Options;
37    unsigned  Cnt;
38  } SEGGER_SYSVIEW_PRINTF_DESC;
39  typedef struct {
40          U8                      EnableState;   
41          U8                      UpChannel;
42          U8                      RecursionCnt;
43          U32                     SysFreq;
44          U32                     CPUFreq;
45          U32                     LastTxTimeStamp;
46          U32                     RAMBaseAddress;
47  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
48          U32                     PacketCount;
49  #else
50          U32                     DropCount;
51          U8                      DownChannel;
52  #endif
53          U32                     DisabledEvents;
54    const SEGGER_SYSVIEW_OS_API*  pOSAPI;
55          SEGGER_SYSVIEW_SEND_SYS_DESC_FUNC*   pfSendSysDesc;
56  } SEGGER_SYSVIEW_GLOBALS;
57  static void _SendPacket(U8* pStartPacket, U8* pEndPacket, unsigned int EventId);
58  static const U8 _abSync[10] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
59  #ifdef SEGGER_SYSVIEW_SECTION
60    #if (defined __GNUC__)
61      __attribute__ ((section (SEGGER_SYSVIEW_SECTION))) static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
62      #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
63      __attribute__ ((section (SEGGER_SYSVIEW_SECTION))) static char _DownBuffer[8];  
64      #endif
65    #elif (defined __ICCARM__) || (defined __ICCRX__)
66      #pragma location=SEGGER_SYSVIEW_SECTION
67      static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
68      #pragma location=SEGGER_SYSVIEW_SECTION
69      static char _DownBuffer[8];  
70    #elif (defined __CC_ARM)
71      __attribute__ ((section (SEGGER_SYSVIEW_SECTION), zero_init)) static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
72      #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
73      __attribute__ ((section (SEGGER_SYSVIEW_SECTION), zero_init)) static char _DownBuffer[8];  
74      #endif
75    #else
76      static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
77      #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
78      static char _DownBuffer[8];  
79      #endif
80    #endif
81  #else
82      static char _UpBuffer  [SEGGER_SYSVIEW_RTT_BUFFER_SIZE];
83      #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
84      static char _DownBuffer[8];  
85      #endif
86  #endif
87  static SEGGER_SYSVIEW_GLOBALS _SYSVIEW_Globals;
88  static SEGGER_SYSVIEW_MODULE* _pFirstModule;
89  static U8                     _NumModules;
90  #define ENCODE_U32(pDest, Value) {                                                  \
91                                     U8* pSysviewPointer;                             \
92                                     U32 SysViewData;                                 \
93                                     pSysviewPointer = pDest;                         \
94                                     SysViewData = Value;                             \
95                                     while(SysViewData &gt; 0x7F) {                      \
96                                       *pSysviewPointer++ = (U8)(SysViewData | 0x80); \
97                                       SysViewData &gt;&gt;= 7;                             \
98                                     };                                               \
99                                     *pSysviewPointer++ = (U8)SysViewData;            \
100                                     pDest = pSysviewPointer;                         \
101                                   };
102  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 1)
103  static U8 _aPacket[SEGGER_SYSVIEW_MAX_PACKET_SIZE];
104  #define RECORD_START(PacketSize)  SEGGER_SYSVIEW_LOCK();                            \
105                                    pPayloadStart = _PreparePacket(_aPacket);
106  #define RECORD_END()              SEGGER_SYSVIEW_UNLOCK()
107  #else
108  #define RECORD_START(PacketSize)  U8 aPacket[(PacketSize)];                         \
109                                    pPayloadStart = _PreparePacket(aPacket);          \
110  
111  #define RECORD_END()
112  #endif
113  static U8* _EncodeData(U8* pPayload, const char* pSrc, unsigned int NumBytes) {
114    unsigned int n;
115    n = 0;
116    *pPayload++ = NumBytes;
117    while (n &lt; NumBytes) {
118      *pPayload++ = *pSrc++;
119      n++;
120    }
121    return pPayload;
122  }
123  static U8 *_EncodeStr(U8 *pPayload, const char *pText, unsigned int Limit) {
124    unsigned int n;
125    unsigned int Len;
126    Len = 0;
127    while(*(pText + Len) != 0) {
128      Len++;
129    }
130    if (Len &gt; Limit) {
131      Len = Limit;
132    }
133    if (Len &lt; 255)  {
134      *pPayload++ = Len; 
135    } else {
136      *pPayload++ = 255;
137      *pPayload++ = (Len &amp; 255);
138      *pPayload++ = ((Len &gt;&gt; 8) &amp; 255);
139    }
140    n = 0;
141    while (n &lt; Len) {
142      *pPayload++ = *pText++;
143      n++;
144    }
145    return pPayload;
146  }
147  static U8* _PreparePacket(U8* pPacket) {
148    return pPacket + 4;
149  }
150  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
151  static void _HandleIncomingPacket(void) {
152    U8  Cmd;
153    int Status;
154    Status = SEGGER_RTT_ReadNoLock(CHANNEL_ID_DOWN, &amp;Cmd, 1);
155    if (Status &gt; 0) {
156      switch (Cmd) {
157      case SEGGER_SYSVIEW_COMMAND_ID_START:
158        SEGGER_SYSVIEW_Start();
159        break;
160      case SEGGER_SYSVIEW_COMMAND_ID_STOP:
161        SEGGER_SYSVIEW_Stop();
162        break;
163      case SEGGER_SYSVIEW_COMMAND_ID_GET_SYSTIME:
164        SEGGER_SYSVIEW_RecordSystime();
165        break;
166      case SEGGER_SYSVIEW_COMMAND_ID_GET_TASKLIST:
167        SEGGER_SYSVIEW_SendTaskList();
168        break;
169      case SEGGER_SYSVIEW_COMMAND_ID_GET_SYSDESC:
170        SEGGER_SYSVIEW_GetSysDesc();
171        break;
172      case SEGGER_SYSVIEW_COMMAND_ID_GET_NUMMODULES:
173        SEGGER_SYSVIEW_SendNumModules();
174        break;
175      case SEGGER_SYSVIEW_COMMAND_ID_GET_MODULEDESC:
176        SEGGER_SYSVIEW_SendModuleDescription();
177        break;
178      case SEGGER_SYSVIEW_COMMAND_ID_GET_MODULE:
179        Status = SEGGER_RTT_ReadNoLock(CHANNEL_ID_DOWN, &amp;Cmd, 1);
180        if (Status &gt; 0) {
181          SEGGER_SYSVIEW_SendModule(Cmd);
182        }
183        break;
184      default:
185        if (Cmd &gt;= 128) { 
186          SEGGER_RTT_ReadNoLock(CHANNEL_ID_DOWN, &amp;Cmd, 1);
187        }
188        break;
189      }
190    }
191  }
192  #endif 
193  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
194  static int _TrySendOverflowPacket(void) {
195    U32 TimeStamp;
196    I32 Delta;
197    int Status;
198    U8  aPacket[11];
199    U8* pPayload;
200    aPacket[0] = SYSVIEW_EVTID_OVERFLOW;      
201    pPayload   = &amp;aPacket[1];
202    ENCODE_U32(pPayload, _SYSVIEW_Globals.DropCount);
203    TimeStamp  = SEGGER_SYSVIEW_GET_TIMESTAMP();
204    Delta = TimeStamp - _SYSVIEW_Globals.LastTxTimeStamp;
205    MAKE_DELTA_32BIT(Delta);
206    ENCODE_U32(pPayload, Delta);
207    Status = SEGGER_RTT_WriteSkipNoLock(CHANNEL_ID_UP, aPacket, pPayload - aPacket);
208    SEGGER_SYSVIEW_ON_EVENT_RECORDED(pPayload - aPacket);
209    if (Status) {
210      _SYSVIEW_Globals.LastTxTimeStamp = TimeStamp;
211      _SYSVIEW_Globals.EnableState--; 
212    } else {
213      _SYSVIEW_Globals.DropCount++;
214    }
215    return Status;
216  }
217  #endif  
218  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
219  static void _SendSyncInfo(void) {
220    SEGGER_RTT_WriteWithOverwriteNoLock(CHANNEL_ID_UP, _abSync, 10);
221    SEGGER_SYSVIEW_ON_EVENT_RECORDED(10);
222    SEGGER_SYSVIEW_RecordVoid(SYSVIEW_EVTID_TRACE_START);
223    {
224      U8* pPayload;
225      U8* pPayloadStart;
226      RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 4 * SEGGER_SYSVIEW_QUANTA_U32);
227      pPayload = pPayloadStart;
228      ENCODE_U32(pPayload, _SYSVIEW_Globals.SysFreq);
229      ENCODE_U32(pPayload, _SYSVIEW_Globals.CPUFreq);
230      ENCODE_U32(pPayload, _SYSVIEW_Globals.RAMBaseAddress);
231      ENCODE_U32(pPayload, SEGGER_SYSVIEW_ID_SHIFT);
232      _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_INIT);
233      RECORD_END();
234    }
235    if (_SYSVIEW_Globals.pfSendSysDesc) {
236      _SYSVIEW_Globals.pfSendSysDesc();
237    }
238    SEGGER_SYSVIEW_RecordSystime();
239    SEGGER_SYSVIEW_SendTaskList();
240    if (_NumModules &gt; 0) {
241      int n;
242      SEGGER_SYSVIEW_SendNumModules();
243      for (n = 0; n &lt; _NumModules; n++) {
244        SEGGER_SYSVIEW_SendModule(n);
245      }
246      SEGGER_SYSVIEW_SendModuleDescription();
247    }
248  }
249  #endif  
250  static void _SendPacket(U8* pStartPacket, U8* pEndPacket, unsigned int EventId) {
251    unsigned int  NumBytes;
252    U32           TimeStamp;
253    U32           Delta;
254  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
255    int           Status;
256  #endif
257  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0)
258    SEGGER_SYSVIEW_LOCK();
259  #endif
260  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
261    if (_SYSVIEW_Globals.EnableState == 0) {
262      goto SendDone;
263    }
264  #else
265    if (_SYSVIEW_Globals.EnableState == 1) {  
266      goto Send;
267    }
268    if (_SYSVIEW_Globals.EnableState == 0) {
269      goto SendDone;
270    }
271    if (_SYSVIEW_Globals.EnableState == 2) {
272      _TrySendOverflowPacket();
273      if (_SYSVIEW_Globals.EnableState != 1) {
274        goto SendDone;
275      }
276    }
277  Send:
278  #endif
279    if (EventId &lt; 32) {
280      if (_SYSVIEW_Globals.DisabledEvents &amp; ((U32)1u &lt;&lt; EventId)) {
281        goto SendDone;
282      }
283    }
284    if (EventId &lt; 24) {
285      *--pStartPacket = EventId;
286    } else {
287      NumBytes = pEndPacket - pStartPacket;
288      if (NumBytes &gt; 127) {
289        *--pStartPacket = (NumBytes &gt;&gt; 7);
290        *--pStartPacket = NumBytes | 0x80;
291      } else {
292        *--pStartPacket = NumBytes;
293      }
294      if (EventId &gt; 127) {
295        *--pStartPacket = (EventId &gt;&gt; 7);
296        *--pStartPacket = EventId | 0x80;
297      } else {
298        *--pStartPacket = EventId;
299      }
300    }
301    TimeStamp  = SEGGER_SYSVIEW_GET_TIMESTAMP();
302    Delta = TimeStamp - _SYSVIEW_Globals.LastTxTimeStamp;
303    MAKE_DELTA_32BIT(Delta);
304    ENCODE_U32(pEndPacket, Delta);
305  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
306    SEGGER_RTT_WriteWithOverwriteNoLock(CHANNEL_ID_UP, pStartPacket, pEndPacket - pStartPacket);
307    SEGGER_SYSVIEW_ON_EVENT_RECORDED(pEndPacket - pStartPacket);
308    _SYSVIEW_Globals.LastTxTimeStamp = TimeStamp;
309  #else
310    Status = SEGGER_RTT_WriteSkipNoLock(CHANNEL_ID_UP, pStartPacket, pEndPacket - pStartPacket);
311    SEGGER_SYSVIEW_ON_EVENT_RECORDED(pEndPacket - pStartPacket);
312    if (Status) {
313      _SYSVIEW_Globals.LastTxTimeStamp = TimeStamp;
314    } else {
315      _SYSVIEW_Globals.EnableState++; 
316    }
317  #endif
318  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
319    if (_SYSVIEW_Globals.RecursionCnt == 0) {   
320      _SYSVIEW_Globals.RecursionCnt = 1;
321      if (_SYSVIEW_Globals.PacketCount++ &amp; (1 &lt;&lt; SEGGER_SYSVIEW_SYNC_PERIOD_SHIFT)) {
322        _SendSyncInfo();
323        _SYSVIEW_Globals.PacketCount = 0;
324      }
325      _SYSVIEW_Globals.RecursionCnt = 0;
326    }
327  SendDone:
328    ; 
329  #else
330  SendDone:
331    if (SEGGER_RTT_HASDATA(CHANNEL_ID_DOWN)) {
332      if (_SYSVIEW_Globals.RecursionCnt == 0) {   
333        _SYSVIEW_Globals.RecursionCnt = 1;
334        _HandleIncomingPacket();
335        _SYSVIEW_Globals.RecursionCnt = 0;
336      }
337    }
338  #endif
339  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0)
340    SEGGER_SYSVIEW_UNLOCK();  
341  #endif
342  }
343  #ifndef SEGGER_SYSVIEW_EXCLUDE_PRINTF 
344  static int _VPrintHost(const char* s, U32 Options, va_list* pParamList) {
345    U32         aParas[SEGGER_SYSVIEW_MAX_ARGUMENTS];
346    U32*        pParas;
347    U32         NumArguments;
348    const char* p;
349    char        c;
350    U8*         pPayload;
351    U8*         pPayloadStart;
352  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
353    U8 HasNonScalar;
354    HasNonScalar = 0;
355  #endif  
356    p = s;
357    NumArguments = 0;
358    for (;;) {
359      c = *p++;
360      if (c == 0) {
361        break;
362      }
363      if (c == &#x27;%&#x27;) {
364        c = *p;
365  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT == 0
366        aParas[NumArguments++] = va_arg(*pParamList, int);
367        if (NumArguments == SEGGER_SYSVIEW_MAX_ARGUMENTS) {
368          break;
369        }
370  #else
371        if (c == &#x27;s&#x27;) {
372          HasNonScalar = 1;
373          break;
374        } else {
375          aParas[NumArguments++] = va_arg(*pParamList, int);
376          if (NumArguments == SEGGER_SYSVIEW_MAX_ARGUMENTS) {
377            break;
378          }
379        }
380  #endif
381      }
382    }
383  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
384    if (HasNonScalar) {
385      return -1;
386    }
387  #endif
388    {
389      RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_MAX_STRING_LEN + 2 * SEGGER_SYSVIEW_QUANTA_U32 + SEGGER_SYSVIEW_MAX_ARGUMENTS * SEGGER_SYSVIEW_QUANTA_U32);
390      pPayload = _EncodeStr(pPayloadStart, s, SEGGER_SYSVIEW_MAX_STRING_LEN);
391      ENCODE_U32(pPayload, Options);
392      ENCODE_U32(pPayload, NumArguments);
393      pParas = aParas;
394      while (NumArguments--) {
395        ENCODE_U32(pPayload, (*pParas));
396        pParas++;
397      }
398      _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
399      RECORD_END();
400    }
401    return 0;
402  }
403  static void _StoreChar(SEGGER_SYSVIEW_PRINTF_DESC * p, char c) {
404    unsigned int  Cnt;
405    U8*           pPayload;
406    U32           Options;
407    Cnt = p-&gt;Cnt;
408    if ((Cnt + 1u) &lt;= SEGGER_SYSVIEW_MAX_STRING_LEN) {
409      *(p-&gt;pPayload++) = c;
410      p-&gt;Cnt = Cnt + 1u;
411    }
412    if (p-&gt;Cnt == SEGGER_SYSVIEW_MAX_STRING_LEN) {
413      *(p-&gt;pPayloadStart) = p-&gt;Cnt;
414      pPayload = p-&gt;pPayload;
415      Options = p-&gt;Options;
416      ENCODE_U32(pPayload, Options);
417      ENCODE_U32(pPayload, 0);
418      _SendPacket(p-&gt;pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
419      p-&gt;pPayloadStart = _PreparePacket(p-&gt;pBuffer);
420      p-&gt;pPayload = p-&gt;pPayloadStart + 1u;
421      p-&gt;Cnt = 0u;
422    }
423  }
424  static void _PrintUnsigned(SEGGER_SYSVIEW_PRINTF_DESC * pBufferDesc, unsigned int v, unsigned int Base, unsigned int NumDigits, unsigned int FieldWidth, unsigned int FormatFlags) {
425    static const char _aV2C[16] = {&#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27; };
426    unsigned int      Div;
427    unsigned int      Digit;
428    unsigned int      Number;
429    unsigned int      Width;
430    char              c;
431    Number = v;
432    Digit = 1u;
433    Width = 1u;
434    while (Number &gt;= Base) {
435      Number = (Number / Base);
436      Width++;
437    }
438    if (NumDigits &gt; Width) {
439      Width = NumDigits;
440    }
441    if ((FormatFlags &amp; FORMAT_FLAG_LEFT_JUSTIFY) == 0u) {
442      if (FieldWidth != 0u) {
443        if (((FormatFlags &amp; FORMAT_FLAG_PAD_ZERO) == FORMAT_FLAG_PAD_ZERO) &amp;&amp; (NumDigits == 0u)) {
444          c = &#x27;0&#x27;;
445        } else {
446          c = &#x27; &#x27;;
447        }
448        while ((FieldWidth != 0u) &amp;&amp; (Width &lt; FieldWidth)) {
449          FieldWidth--;
450          _StoreChar(pBufferDesc, c);
451        }
452      }
453    }
454    while (1) {
455      if (NumDigits &gt; 1u) {       
456        NumDigits--;
457      } else {
458        Div = v / Digit;
459        if (Div &lt; Base) {        
460          break;
461        }
462      }
463      Digit *= Base;
464    }
465    do {
466      Div = v / Digit;
467      v -= Div * Digit;
468      _StoreChar(pBufferDesc, _aV2C[Div]);
469      Digit /= Base;
470    } while (Digit);
471    if ((FormatFlags &amp; FORMAT_FLAG_LEFT_JUSTIFY) == FORMAT_FLAG_LEFT_JUSTIFY) {
472      if (FieldWidth != 0u) {
473        while ((FieldWidth != 0u) &amp;&amp; (Width &lt; FieldWidth)) {
474          FieldWidth--;
475          _StoreChar(pBufferDesc, &#x27; &#x27;);
476        }
477      }
478    }
479  }
480  static void _PrintInt(SEGGER_SYSVIEW_PRINTF_DESC * pBufferDesc, int v, unsigned int Base, unsigned int NumDigits, unsigned int FieldWidth, unsigned int FormatFlags) {
481    unsigned int  Width;
482    int           Number;
483    Number = (v &lt; 0) ? -v : v;
484    Width = 1u;
485    while (Number &gt;= (int)Base) {
486      Number = (Number / (int)Base);
487      Width++;
488    }
489    if (NumDigits &gt; Width) {
490      Width = NumDigits;
491    }
492    if ((FieldWidth &gt; 0u) &amp;&amp; ((v &lt; 0) || ((FormatFlags &amp; FORMAT_FLAG_PRINT_SIGN) == FORMAT_FLAG_PRINT_SIGN))) {
493      FieldWidth--;
494    }
495    if ((((FormatFlags &amp; FORMAT_FLAG_PAD_ZERO) == 0u) || (NumDigits != 0u)) &amp;&amp; ((FormatFlags &amp; FORMAT_FLAG_LEFT_JUSTIFY) == 0u)) {
496      if (FieldWidth != 0u) {
497        while ((FieldWidth != 0u) &amp;&amp; (Width &lt; FieldWidth)) {
498          FieldWidth--;
499          _StoreChar(pBufferDesc, &#x27; &#x27;);
500        }
501      }
502    }
503    if (v &lt; 0) {
504      v = -v;
505      _StoreChar(pBufferDesc, &#x27;-&#x27;);
506    } else if ((FormatFlags &amp; FORMAT_FLAG_PRINT_SIGN) == FORMAT_FLAG_PRINT_SIGN) {
507      _StoreChar(pBufferDesc, &#x27;+&#x27;);
508    } else {
509    }
510    if (((FormatFlags &amp; FORMAT_FLAG_PAD_ZERO) == FORMAT_FLAG_PAD_ZERO) &amp;&amp; ((FormatFlags &amp; FORMAT_FLAG_LEFT_JUSTIFY) == 0u) &amp;&amp; (NumDigits == 0u)) {
511      if (FieldWidth != 0u) {
512        while ((FieldWidth != 0u) &amp;&amp; (Width &lt; FieldWidth)) {
513          FieldWidth--;
514          _StoreChar(pBufferDesc, &#x27;0&#x27;);
515        }
516      }
517    }
518    _PrintUnsigned(pBufferDesc, (unsigned int)v, Base, NumDigits, FieldWidth, FormatFlags);
519  }
520  static void _VPrintTarget(const char* sFormat, U32 Options, va_list* pParamList) {
521    SEGGER_SYSVIEW_PRINTF_DESC BufferDesc;
522    char          c;
523    int           v;
524    unsigned int  NumDigits;
525    unsigned int  FormatFlags;
526    unsigned int  FieldWidth;
527    U8*           pPayloadStart;
528  #if SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0
529    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_MAX_STRING_LEN + 1 + 2 * SEGGER_SYSVIEW_QUANTA_U32);
530    SEGGER_SYSVIEW_LOCK();
531  #else
532    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_MAX_STRING_LEN + 1 + 2 * SEGGER_SYSVIEW_QUANTA_U32);
533  #endif
534  #if SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0
535    BufferDesc.pBuffer        = aPacket;
536  #else
537    BufferDesc.pBuffer        = _aPacket;
538  #endif
539    BufferDesc.Cnt            = 0u;
540    BufferDesc.pPayloadStart  = pPayloadStart;
541    BufferDesc.pPayload       = BufferDesc.pPayloadStart + 1u;
542    BufferDesc.Options        =  Options;
543    do {
544      c = *sFormat;
545      sFormat++;
546      if (c == 0u) {
547        break;
548      }
549      if (c == &#x27;%&#x27;) {
550        FormatFlags = 0u;
551        v = 1;
552        do {
553          c = *sFormat;
554          switch (c) {
555          case &#x27;-&#x27;: FormatFlags |= FORMAT_FLAG_LEFT_JUSTIFY; sFormat++; break;
556          case &#x27;0&#x27;: FormatFlags |= FORMAT_FLAG_PAD_ZERO;     sFormat++; break;
557          case &#x27;+&#x27;: FormatFlags |= FORMAT_FLAG_PRINT_SIGN;   sFormat++; break;
558          case &#x27;#&#x27;: FormatFlags |= FORMAT_FLAG_ALTERNATE;    sFormat++; break;
559          default:  v = 0; break;
560          }
561        } while (v);
562        FieldWidth = 0u;
563        do {
564          c = *sFormat;
565          if ((c &lt; &#x27;0&#x27;) || (c &gt; &#x27;9&#x27;)) {
566            break;
567          }
568          sFormat++;
569          FieldWidth = (FieldWidth * 10u) + ((unsigned int)c - &#x27;0&#x27;);
570        } while (1);
571        NumDigits = 0u;
572        c = *sFormat;
573        if (c == &#x27;.&#x27;) {
574          sFormat++;
575          do {
576            c = *sFormat;
577            if ((c &lt; &#x27;0&#x27;) || (c &gt; &#x27;9&#x27;)) {
578              break;
579            }
580            sFormat++;
581            NumDigits = NumDigits * 10u + ((unsigned int)c - &#x27;0&#x27;);
582          } while (1);
583        }
584        c = *sFormat;
585        do {
586          if ((c == &#x27;l&#x27;) || (c == &#x27;h&#x27;)) {
587            c = *sFormat;
588            sFormat++;
589          } else {
590            break;
591          }
592        } while (1);
593        switch (c) {
594        case &#x27;c&#x27;: {
595          char c0;
596          v = va_arg(*pParamList, int);
597          c0 = (char)v;
598          _StoreChar(&amp;BufferDesc, c0);
599          break;
600        }
601        case &#x27;d&#x27;:
602          v = va_arg(*pParamList, int);
603          _PrintInt(&amp;BufferDesc, v, 10u, NumDigits, FieldWidth, FormatFlags);
604          break;
605        case &#x27;u&#x27;:
606          v = va_arg(*pParamList, int);
607          _PrintUnsigned(&amp;BufferDesc, (unsigned int)v, 10u, NumDigits, FieldWidth, FormatFlags);
608          break;
609        case &#x27;x&#x27;:
610        case &#x27;X&#x27;:
611          v = va_arg(*pParamList, int);
612          _PrintUnsigned(&amp;BufferDesc, (unsigned int)v, 16u, NumDigits, FieldWidth, FormatFlags);
613          break;
614        case &#x27;p&#x27;:
615          v = va_arg(*pParamList, int);
616          _PrintUnsigned(&amp;BufferDesc, (unsigned int)v, 16u, 8u, 8u, 0u);
617          break;
618        case &#x27;%&#x27;:
619          _StoreChar(&amp;BufferDesc, &#x27;%&#x27;);
620          break;
621        default:
622          break;
623        }
624        sFormat++;
625      } else {
626        _StoreChar(&amp;BufferDesc, c);
627      }
628    } while (*sFormat);
629    if (BufferDesc.Cnt != 0u) {
630      *(BufferDesc.pPayloadStart) = BufferDesc.Cnt;
631      ENCODE_U32(BufferDesc.pPayload, BufferDesc.Options);
632      ENCODE_U32(BufferDesc.pPayload, 0);
633      _SendPacket(BufferDesc.pPayloadStart, BufferDesc.pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
634    }
635  #if SEGGER_SYSVIEW_USE_STATIC_BUFFER == 0
636    SEGGER_SYSVIEW_UNLOCK();
637    RECORD_END();
638  #else
639    RECORD_END();
640  #endif
641  }
642  #endif 
643  void SEGGER_SYSVIEW_Init(U32 SysFreq, U32 CPUFreq, const SEGGER_SYSVIEW_OS_API *pOSAPI, SEGGER_SYSVIEW_SEND_SYS_DESC_FUNC pfSendSysDesc) {
644  #ifdef SEGGER_RTT_SECTION
645    SEGGER_RTT_Init();
646  #endif
647  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
648  #if SEGGER_SYSVIEW_RTT_CHANNEL &gt; 0
649    SEGGER_RTT_ConfigUpBuffer(SEGGER_SYSVIEW_RTT_CHANNEL, &quot;SysView&quot;, &amp;_UpBuffer[0],   sizeof(_UpBuffer),   SEGGER_RTT_MODE_NO_BLOCK_SKIP);
650  #else
651    _SYSVIEW_Globals.UpChannel = SEGGER_RTT_AllocUpBuffer  (&quot;SysView&quot;, &amp;_UpBuffer[0],   sizeof(_UpBuffer),   SEGGER_RTT_MODE_NO_BLOCK_SKIP);
652  #endif
653    _SYSVIEW_Globals.RAMBaseAddress   = SEGGER_SYSVIEW_ID_BASE;
654    _SYSVIEW_Globals.LastTxTimeStamp  = SEGGER_SYSVIEW_GET_TIMESTAMP();
655    _SYSVIEW_Globals.pOSAPI           = pOSAPI;
656    _SYSVIEW_Globals.SysFreq          = SysFreq;
657    _SYSVIEW_Globals.CPUFreq          = CPUFreq;
658    _SYSVIEW_Globals.pfSendSysDesc    = pfSendSysDesc;
659    _SYSVIEW_Globals.EnableState      = 0;
660    _SYSVIEW_Globals.PacketCount      = 0;
661  #else 
662  #if SEGGER_SYSVIEW_RTT_CHANNEL &gt; 0
663    SEGGER_RTT_ConfigUpBuffer   (SEGGER_SYSVIEW_RTT_CHANNEL, &quot;SysView&quot;, &amp;_UpBuffer[0],   sizeof(_UpBuffer),   SEGGER_RTT_MODE_NO_BLOCK_SKIP);
664    SEGGER_RTT_ConfigDownBuffer (SEGGER_SYSVIEW_RTT_CHANNEL, &quot;SysView&quot;, &amp;_DownBuffer[0], sizeof(_DownBuffer), SEGGER_RTT_MODE_NO_BLOCK_SKIP);
665  #else
666    _SYSVIEW_Globals.UpChannel = SEGGER_RTT_AllocUpBuffer  (&quot;SysView&quot;, &amp;_UpBuffer[0],   sizeof(_UpBuffer),   SEGGER_RTT_MODE_NO_BLOCK_SKIP);
667    _SYSVIEW_Globals.DownChannel = _SYSVIEW_Globals.UpChannel;
668    SEGGER_RTT_ConfigDownBuffer (_SYSVIEW_Globals.DownChannel, &quot;SysView&quot;, &amp;_DownBuffer[0], sizeof(_DownBuffer), SEGGER_RTT_MODE_NO_BLOCK_SKIP);
669  #endif
670    _SYSVIEW_Globals.RAMBaseAddress   = SEGGER_SYSVIEW_ID_BASE;
671    _SYSVIEW_Globals.LastTxTimeStamp  = SEGGER_SYSVIEW_GET_TIMESTAMP();
672    _SYSVIEW_Globals.pOSAPI           = pOSAPI;
673    _SYSVIEW_Globals.SysFreq          = SysFreq;
674    _SYSVIEW_Globals.CPUFreq          = CPUFreq;
675    _SYSVIEW_Globals.pfSendSysDesc    = pfSendSysDesc;
676    _SYSVIEW_Globals.EnableState      = 0;
677  #endif  
678  }
679  void SEGGER_SYSVIEW_SetRAMBase(U32 RAMBaseAddress) {
680    _SYSVIEW_Globals.RAMBaseAddress = RAMBaseAddress;
681  }
682  void SEGGER_SYSVIEW_RecordVoid(unsigned int EventID) {
683    U8* pPayloadStart;
684    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
685    _SendPacket(pPayloadStart, pPayloadStart, EventID);
686    RECORD_END();
687  }
688  void SEGGER_SYSVIEW_RecordU32(unsigned int EventID, U32 Value) {
689    U8* pPayload;
690    U8* pPayloadStart;
691    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
692    pPayload = pPayloadStart;
693    ENCODE_U32(pPayload, Value);
694    _SendPacket(pPayloadStart, pPayload, EventID);
695    RECORD_END();
696  }
697  void SEGGER_SYSVIEW_RecordU32x2(unsigned int EventID, U32 Para0, U32 Para1) {
698    U8* pPayload;
699    U8* pPayloadStart;
700    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
701    pPayload = pPayloadStart;
702    ENCODE_U32(pPayload, Para0);
703    ENCODE_U32(pPayload, Para1);
704    _SendPacket(pPayloadStart, pPayload, EventID);
705    RECORD_END();
706  }
707  void SEGGER_SYSVIEW_RecordU32x3(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2) {
708    U8* pPayload;
709    U8* pPayloadStart;
710    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 3 * SEGGER_SYSVIEW_QUANTA_U32);
711    pPayload = pPayloadStart;
712    ENCODE_U32(pPayload, Para0);
713    ENCODE_U32(pPayload, Para1);
714    ENCODE_U32(pPayload, Para2);
715    _SendPacket(pPayloadStart, pPayload, EventID);
716    RECORD_END();
717  }
718  void SEGGER_SYSVIEW_RecordU32x4(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3) {
719    U8* pPayload;
720    U8* pPayloadStart;
721    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 4 * SEGGER_SYSVIEW_QUANTA_U32);
722    pPayload = pPayloadStart;
723    ENCODE_U32(pPayload, Para0);
724    ENCODE_U32(pPayload, Para1);
725    ENCODE_U32(pPayload, Para2);
726    ENCODE_U32(pPayload, Para3);
727    _SendPacket(pPayloadStart, pPayload, EventID);
728    RECORD_END();
729  }
730  void SEGGER_SYSVIEW_RecordU32x5(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4) {
731    U8* pPayload;
732    U8* pPayloadStart;
733    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 5 * SEGGER_SYSVIEW_QUANTA_U32);
734    pPayload = pPayloadStart;
735    ENCODE_U32(pPayload, Para0);
736    ENCODE_U32(pPayload, Para1);
737    ENCODE_U32(pPayload, Para2);
738    ENCODE_U32(pPayload, Para3);
739    ENCODE_U32(pPayload, Para4);
740    _SendPacket(pPayloadStart, pPayload, EventID);
741    RECORD_END();
742  }
743  void SEGGER_SYSVIEW_RecordU32x6(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5) {
744    U8* pPayload;
745    U8* pPayloadStart;
746    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 6 * SEGGER_SYSVIEW_QUANTA_U32);
747    pPayload = pPayloadStart;
748    ENCODE_U32(pPayload, Para0);
749    ENCODE_U32(pPayload, Para1);
750    ENCODE_U32(pPayload, Para2);
751    ENCODE_U32(pPayload, Para3);
752    ENCODE_U32(pPayload, Para4);
753    ENCODE_U32(pPayload, Para5);
754    _SendPacket(pPayloadStart, pPayload, EventID);
755    RECORD_END();
756  }
757  void SEGGER_SYSVIEW_RecordU32x7(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5, U32 Para6) {
758    U8* pPayload;
759    U8* pPayloadStart;
760    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 7 * SEGGER_SYSVIEW_QUANTA_U32);
761    pPayload = pPayloadStart;
762    ENCODE_U32(pPayload, Para0);
763    ENCODE_U32(pPayload, Para1);
764    ENCODE_U32(pPayload, Para2);
765    ENCODE_U32(pPayload, Para3);
766    ENCODE_U32(pPayload, Para4);
767    ENCODE_U32(pPayload, Para5);
768    ENCODE_U32(pPayload, Para6);
769    _SendPacket(pPayloadStart, pPayload, EventID);
770    RECORD_END();
771  }
772  void SEGGER_SYSVIEW_RecordU32x8(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5, U32 Para6, U32 Para7) {
773    U8* pPayload;
774    U8* pPayloadStart;
775    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 8 * SEGGER_SYSVIEW_QUANTA_U32);
776    pPayload = pPayloadStart;
777    ENCODE_U32(pPayload, Para0);
778    ENCODE_U32(pPayload, Para1);
779    ENCODE_U32(pPayload, Para2);
780    ENCODE_U32(pPayload, Para3);
781    ENCODE_U32(pPayload, Para4);
782    ENCODE_U32(pPayload, Para5);
783    ENCODE_U32(pPayload, Para6);
784    ENCODE_U32(pPayload, Para7);
785    _SendPacket(pPayloadStart, pPayload, EventID);
786    RECORD_END();
787  }
788  void SEGGER_SYSVIEW_RecordU32x9(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5, U32 Para6, U32 Para7, U32 Para8) {
789    U8* pPayload;
790    U8* pPayloadStart;
791    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 9 * SEGGER_SYSVIEW_QUANTA_U32);
792    pPayload = pPayloadStart;
793    ENCODE_U32(pPayload, Para0);
794    ENCODE_U32(pPayload, Para1);
795    ENCODE_U32(pPayload, Para2);
796    ENCODE_U32(pPayload, Para3);
797    ENCODE_U32(pPayload, Para4);
798    ENCODE_U32(pPayload, Para5);
799    ENCODE_U32(pPayload, Para6);
800    ENCODE_U32(pPayload, Para7);
801    ENCODE_U32(pPayload, Para8);
802    _SendPacket(pPayloadStart, pPayload, EventID);
803    RECORD_END();
804  }
805  void SEGGER_SYSVIEW_RecordU32x10(unsigned int EventID, U32 Para0, U32 Para1, U32 Para2, U32 Para3, U32 Para4, U32 Para5, U32 Para6, U32 Para7, U32 Para8, U32 Para9) {
806    U8* pPayload;
807    U8* pPayloadStart;
808    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 10 * SEGGER_SYSVIEW_QUANTA_U32);
809    pPayload = pPayloadStart;
810    ENCODE_U32(pPayload, Para0);
811    ENCODE_U32(pPayload, Para1);
812    ENCODE_U32(pPayload, Para2);
813    ENCODE_U32(pPayload, Para3);
814    ENCODE_U32(pPayload, Para4);
815    ENCODE_U32(pPayload, Para5);
816    ENCODE_U32(pPayload, Para6);
817    ENCODE_U32(pPayload, Para7);
818    ENCODE_U32(pPayload, Para8);
819    ENCODE_U32(pPayload, Para9);
820    _SendPacket(pPayloadStart, pPayload, EventID);
821    RECORD_END();
822  }
823  void SEGGER_SYSVIEW_RecordString(unsigned int EventID, const char* pString) {
824    U8* pPayload;
825    U8* pPayloadStart;
826    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
827    pPayload = _EncodeStr(pPayloadStart, pString, SEGGER_SYSVIEW_MAX_STRING_LEN);
828    _SendPacket(pPayloadStart, pPayload, EventID);
829    RECORD_END();
830  }
831  void SEGGER_SYSVIEW_Start(void) {
832  #if (SEGGER_SYSVIEW_CAN_RESTART == 0)
833    if (_SYSVIEW_Globals.EnableState == 0) {
834  #endif
835      _SYSVIEW_Globals.EnableState = 1;
836  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE == 1)
837      _SendSyncInfo();
838  #else
839      SEGGER_SYSVIEW_LOCK();
840      SEGGER_RTT_WriteSkipNoLock(CHANNEL_ID_UP, _abSync, 10);
841      SEGGER_SYSVIEW_UNLOCK();
842      SEGGER_SYSVIEW_ON_EVENT_RECORDED(10);
843      SEGGER_SYSVIEW_RecordVoid(SYSVIEW_EVTID_TRACE_START);
844      {
845        U8* pPayload;
846        U8* pPayloadStart;
847        RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 4 * SEGGER_SYSVIEW_QUANTA_U32);
848        pPayload = pPayloadStart;
849        ENCODE_U32(pPayload, _SYSVIEW_Globals.SysFreq);
850        ENCODE_U32(pPayload, _SYSVIEW_Globals.CPUFreq);
851        ENCODE_U32(pPayload, _SYSVIEW_Globals.RAMBaseAddress);
852        ENCODE_U32(pPayload, SEGGER_SYSVIEW_ID_SHIFT);
853        _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_INIT);
854        RECORD_END();
855      }
856      if (_SYSVIEW_Globals.pfSendSysDesc) {
857        _SYSVIEW_Globals.pfSendSysDesc();
858      }
859      SEGGER_SYSVIEW_RecordSystime();
860      SEGGER_SYSVIEW_SendTaskList();
861      SEGGER_SYSVIEW_SendNumModules();
862  #endif
863  #if (SEGGER_SYSVIEW_CAN_RESTART == 0)
864    }
865  #endif
866  }
867  void SEGGER_SYSVIEW_Stop(void) {
868    U8* pPayloadStart;
869    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
870    if (_SYSVIEW_Globals.EnableState) {
871      _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_TRACE_STOP);
872      _SYSVIEW_Globals.EnableState = 0;
873    }
874    RECORD_END();
875  }
876  int SEGGER_SYSVIEW_GetChannelID(void) {
877    return CHANNEL_ID_UP;
878  }
879  void SEGGER_SYSVIEW_GetSysDesc(void) {
880    U8* pPayload;
881    U8* pPayloadStart;
882    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 4 * SEGGER_SYSVIEW_QUANTA_U32);
883    pPayload = pPayloadStart;
884    ENCODE_U32(pPayload, _SYSVIEW_Globals.SysFreq);
885    ENCODE_U32(pPayload, _SYSVIEW_Globals.CPUFreq);
886    ENCODE_U32(pPayload, _SYSVIEW_Globals.RAMBaseAddress);
887    ENCODE_U32(pPayload, SEGGER_SYSVIEW_ID_SHIFT);
888    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_INIT);
889    RECORD_END();
890    if (_SYSVIEW_Globals.pfSendSysDesc) {
891      _SYSVIEW_Globals.pfSendSysDesc();
892    }
893  }
894  void SEGGER_SYSVIEW_SendTaskInfo(const SEGGER_SYSVIEW_TASKINFO *pInfo) {
895    U8* pPayload;
896    U8* pPayloadStart;
897    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32 + 1 + 32);
898    pPayload = pPayloadStart;
899    ENCODE_U32(pPayload, SHRINK_ID(pInfo-&gt;TaskID));
900    ENCODE_U32(pPayload, pInfo-&gt;Prio);
901    pPayload = _EncodeStr(pPayload, pInfo-&gt;sName, 32);
902    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_INFO);
903    pPayload = pPayloadStart;
904    ENCODE_U32(pPayload, SHRINK_ID(pInfo-&gt;TaskID));
905    ENCODE_U32(pPayload, pInfo-&gt;StackBase);
906    ENCODE_U32(pPayload, pInfo-&gt;StackSize);
907    ENCODE_U32(pPayload, 0); 
908    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_STACK_INFO);
909    RECORD_END();
910  }
911  void SEGGER_SYSVIEW_SendTaskList(void) {
912    if (_SYSVIEW_Globals.pOSAPI &amp;&amp; _SYSVIEW_Globals.pOSAPI-&gt;pfSendTaskList) {
913      _SYSVIEW_Globals.pOSAPI-&gt;pfSendTaskList();
914    }
915  }
916  void SEGGER_SYSVIEW_SendSysDesc(const char *sSysDesc) {
917    U8* pPayload;
918    U8* pPayloadStart;
919    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
920    pPayload = _EncodeStr(pPayloadStart, sSysDesc, SEGGER_SYSVIEW_MAX_STRING_LEN);
921    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_SYSDESC);
922    RECORD_END();
923  }
924  void SEGGER_SYSVIEW_RecordSystime(void) {
925    U64 Systime;
926    if (_SYSVIEW_Globals.pOSAPI &amp;&amp; _SYSVIEW_Globals.pOSAPI-&gt;pfGetTime) {
927      Systime = _SYSVIEW_Globals.pOSAPI-&gt;pfGetTime();
928      SEGGER_SYSVIEW_RecordU32x2(SYSVIEW_EVTID_SYSTIME_US,
929                                 (U32)(Systime),
930                                 (U32)(Systime &gt;&gt; 32));
931    } else {
932      SEGGER_SYSVIEW_RecordU32(SYSVIEW_EVTID_SYSTIME_CYCLES, SEGGER_SYSVIEW_GET_TIMESTAMP());
933    }
934  }
935  void SEGGER_SYSVIEW_RecordEnterISR(void) {
936    unsigned v;
937    U8* pPayload;
938    U8* pPayloadStart;
939    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
940    pPayload = pPayloadStart;
941    v = SEGGER_SYSVIEW_GET_INTERRUPT_ID();
942    ENCODE_U32(pPayload, v);
943    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_ISR_ENTER);
944    RECORD_END();
945  }
946  void SEGGER_SYSVIEW_RecordExitISR(void) {
947    U8* pPayloadStart;
948    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
949    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_ISR_EXIT);
950    RECORD_END();
951  }
952  void SEGGER_SYSVIEW_RecordExitISRToScheduler(void) {
953    U8* pPayloadStart;
954    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
955    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_ISR_TO_SCHEDULER);
956    RECORD_END();
957  }
958  void SEGGER_SYSVIEW_RecordEnterTimer(U32 TimerId) {
959    U8* pPayload;
960    U8* pPayloadStart;
961    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
962    pPayload = pPayloadStart;
963    ENCODE_U32(pPayload, SHRINK_ID(TimerId));
964    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TIMER_ENTER);
965    RECORD_END();
966  }
967  void SEGGER_SYSVIEW_RecordExitTimer(void) {
968    U8* pPayloadStart;
969    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
970    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_TIMER_EXIT);
971    RECORD_END();
972  }
973  void SEGGER_SYSVIEW_RecordEndCall(unsigned int EventID) {
974    U8* pPayload;
975    U8* pPayloadStart;
976    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
977    pPayload = pPayloadStart;
978    ENCODE_U32(pPayload, EventID);
<span onclick='openModal()' class='match'>979    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_END_CALL);
980    RECORD_END();
981  }
982  void SEGGER_SYSVIEW_RecordEndCallU32(unsigned int EventID, U32 Para0) {
983    U8* pPayload;
984    U8* pPayloadStart;
985    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
</span>986    pPayload = pPayloadStart;
987    ENCODE_U32(pPayload, EventID);
988    ENCODE_U32(pPayload, Para0);
989    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_END_CALL);
990    RECORD_END();
991  }
992  void SEGGER_SYSVIEW_OnIdle(void) {
993    U8* pPayloadStart;
994    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
995    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_IDLE);
996    RECORD_END();
997  }
998  void SEGGER_SYSVIEW_OnTaskCreate(U32 TaskId) {
999    U8* pPayload;
1000    U8* pPayloadStart;
1001    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1002    pPayload = pPayloadStart;
1003    TaskId = SHRINK_ID(TaskId);
1004    ENCODE_U32(pPayload, TaskId);
1005    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_CREATE);
1006    RECORD_END();
1007  }
1008  void SEGGER_SYSVIEW_OnTaskTerminate(U32 TaskId) {
1009    U8* pPayload;
1010    U8* pPayloadStart;
1011    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1012    pPayload = pPayloadStart;
1013    TaskId = SHRINK_ID(TaskId);
1014    ENCODE_U32(pPayload, TaskId);
1015    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_TERMINATE);
1016    RECORD_END();
1017  }
1018  void SEGGER_SYSVIEW_OnTaskStartExec(U32 TaskId) {
1019    U8* pPayload;
1020    U8* pPayloadStart;
1021    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1022    pPayload = pPayloadStart;
1023    TaskId = SHRINK_ID(TaskId);
1024    ENCODE_U32(pPayload, TaskId);
1025    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_START_EXEC);
1026    RECORD_END();
1027  }
1028  void SEGGER_SYSVIEW_OnTaskStopExec(void) {
1029    U8* pPayloadStart;
1030    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE);
1031    _SendPacket(pPayloadStart, pPayloadStart, SYSVIEW_EVTID_TASK_STOP_EXEC);
1032    RECORD_END();
1033  }
1034  void SEGGER_SYSVIEW_OnTaskStartReady(U32 TaskId) {
1035    U8* pPayload;
1036    U8* pPayloadStart;
1037    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1038    pPayload = pPayloadStart;
1039    TaskId = SHRINK_ID(TaskId);
1040    ENCODE_U32(pPayload, TaskId);
1041    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_START_READY);
1042    RECORD_END();
1043  }
1044  void SEGGER_SYSVIEW_OnTaskStopReady(U32 TaskId, unsigned int Cause) {
1045    U8* pPayload;
1046    U8* pPayloadStart;
1047    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
1048    pPayload = pPayloadStart;
1049    TaskId = SHRINK_ID(TaskId);
1050    ENCODE_U32(pPayload, TaskId);
1051    ENCODE_U32(pPayload, Cause);
1052    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_TASK_STOP_READY);
1053    RECORD_END();
1054  }
1055  void SEGGER_SYSVIEW_MarkStart(unsigned MarkerId) {
1056    U8* pPayload;
1057    U8* pPayloadStart;
1058    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1059    pPayload = pPayloadStart;
1060    ENCODE_U32(pPayload, MarkerId);
1061    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_MARK_START);
1062    RECORD_END();
1063  }
1064  void SEGGER_SYSVIEW_MarkStop(unsigned MarkerId) {
1065    U8 * pPayload;
1066    U8 * pPayloadStart;
1067    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
1068    pPayload = pPayloadStart;
1069    ENCODE_U32(pPayload, MarkerId);
1070    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_MARK_STOP);
1071    RECORD_END();
1072  }
1073  void SEGGER_SYSVIEW_Mark(unsigned int MarkerId) {
1074    U8* pPayload;
1075    U8* pPayloadStart;
1076    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
1077    pPayload = pPayloadStart;
1078    ENCODE_U32(pPayload, SYSVIEW_EVTID_EX_MARK);
1079    ENCODE_U32(pPayload, MarkerId);
1080    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_EX);
1081    RECORD_END();
1082  }
1083  void SEGGER_SYSVIEW_NameMarker(unsigned int MarkerId, const char* sName) {
1084    U8* pPayload;
1085    U8* pPayloadStart;
1086    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1087    pPayload = pPayloadStart;
1088    ENCODE_U32(pPayload, SYSVIEW_EVTID_EX_NAME_MARKER);
1089    ENCODE_U32(pPayload, MarkerId);
1090    pPayload = _EncodeStr(pPayload, sName, SEGGER_SYSVIEW_MAX_STRING_LEN);
1091    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_EX);
1092    RECORD_END();
1093  }
1094  void SEGGER_SYSVIEW_NameResource(U32 ResourceId, const char* sName) {
1095    U8* pPayload;
1096    U8* pPayloadStart;
1097    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32 + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1098    pPayload = pPayloadStart;
1099    ENCODE_U32(pPayload, SHRINK_ID(ResourceId));
1100    pPayload = _EncodeStr(pPayload, sName, SEGGER_SYSVIEW_MAX_STRING_LEN);
1101    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_NAME_RESOURCE);
1102    RECORD_END();
1103  }
1104  int SEGGER_SYSVIEW_SendPacket(U8* pPacket, U8* pPayloadEnd, unsigned int EventId) {
1105  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 1)
1106    SEGGER_SYSVIEW_LOCK();
1107  #endif
1108    _SendPacket(pPacket + 4, pPayloadEnd, EventId);
1109  #if (SEGGER_SYSVIEW_USE_STATIC_BUFFER == 1)
1110    SEGGER_SYSVIEW_UNLOCK();
1111  #endif
1112    return 0;
1113  }
1114  U8* SEGGER_SYSVIEW_EncodeU32(U8* pPayload, U32 Value) {
1115    ENCODE_U32(pPayload, Value);
1116    return pPayload;
1117  }
1118  U8* SEGGER_SYSVIEW_EncodeString(U8* pPayload, const char* s, unsigned int MaxLen) {
1119    return _EncodeStr(pPayload, s, MaxLen);
1120  }
1121  U8* SEGGER_SYSVIEW_EncodeData(U8 *pPayload, const char* pSrc, unsigned int NumBytes) {
1122    return _EncodeData(pPayload, pSrc, NumBytes);
1123  }
1124  U8* SEGGER_SYSVIEW_EncodeId(U8* pPayload, U32 Id) {
1125    Id = SHRINK_ID(Id);
1126    ENCODE_U32(pPayload, Id);
1127    return pPayload;
1128  }
1129  U32 SEGGER_SYSVIEW_ShrinkId(U32 Id) {
1130    return SHRINK_ID(Id);
1131  }
1132  void SEGGER_SYSVIEW_RegisterModule(SEGGER_SYSVIEW_MODULE* pModule) {
1133    SEGGER_SYSVIEW_LOCK();
1134    if (_pFirstModule == 0) {
1135      pModule-&gt;EventOffset = MODULE_EVENT_OFFSET;
1136      pModule-&gt;pNext = 0;
1137      _pFirstModule = pModule;
1138      _NumModules = 1;
1139    } else {
1140      pModule-&gt;EventOffset = _pFirstModule-&gt;EventOffset + _pFirstModule-&gt;NumEvents;
1141      pModule-&gt;pNext = _pFirstModule;
1142      _pFirstModule = pModule;
1143      _NumModules++;
1144    }
1145    SEGGER_SYSVIEW_SendModule(0);
1146    if (pModule-&gt;pfSendModuleDesc) {
1147      pModule-&gt;pfSendModuleDesc();
1148    }
1149    SEGGER_SYSVIEW_UNLOCK();
1150  }
1151  void SEGGER_SYSVIEW_RecordModuleDescription(const SEGGER_SYSVIEW_MODULE* pModule, const char* sDescription) {
1152    U8  ModuleId;
1153    SEGGER_SYSVIEW_MODULE* p;
1154    p = _pFirstModule;
1155    ModuleId = 0;
1156    do {
1157      if (p == pModule) {
1158        break;
1159      }
1160      ModuleId++;
1161      p = p-&gt;pNext;
1162    } while (p);
1163    {
1164      U8* pPayload;
1165      U8* pPayloadStart;
1166      RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1167      pPayload = pPayloadStart;
1168      ENCODE_U32(pPayload, ModuleId);
1169      ENCODE_U32(pPayload, (pModule-&gt;EventOffset));
1170      pPayload = _EncodeStr(pPayload, sDescription, SEGGER_SYSVIEW_MAX_STRING_LEN);
1171      _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_MODULEDESC);
1172      RECORD_END();
1173    }
1174  }
1175  void SEGGER_SYSVIEW_SendModule(U8 ModuleId) {
1176    SEGGER_SYSVIEW_MODULE* pModule;
1177    U32 n;
1178    if (_pFirstModule != 0) {
1179      pModule = _pFirstModule;
1180      for (n = 0; n &lt; ModuleId; n++) {
1181        pModule = pModule-&gt;pNext;
1182        if (pModule == 0) {
1183          break;
1184        }
1185      }
1186      if (pModule != 0) {
1187        U8* pPayload;
1188        U8* pPayloadStart;
1189        RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + 1 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1190        pPayload = pPayloadStart;
1191        ENCODE_U32(pPayload, ModuleId);
1192        ENCODE_U32(pPayload, (pModule-&gt;EventOffset));
1193        pPayload = _EncodeStr(pPayload, pModule-&gt;sModule, SEGGER_SYSVIEW_MAX_STRING_LEN);
1194        _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_MODULEDESC);
1195        RECORD_END();
1196      }
1197    }
1198  }
1199  void SEGGER_SYSVIEW_SendModuleDescription(void) {
1200    SEGGER_SYSVIEW_MODULE* pModule;
1201    if (_pFirstModule != 0) {
1202      pModule = _pFirstModule;
1203      do {
1204        if (pModule-&gt;pfSendModuleDesc) {
1205          pModule-&gt;pfSendModuleDesc();
1206        }
1207        pModule = pModule-&gt;pNext;
1208      } while (pModule);
1209    }
1210  }
1211  void SEGGER_SYSVIEW_SendNumModules(void) {
1212    U8* pPayload;
1213    U8* pPayloadStart;
1214    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2*SEGGER_SYSVIEW_QUANTA_U32);
1215    pPayload = pPayloadStart;
1216    ENCODE_U32(pPayload, _NumModules);
1217    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_NUMMODULES);
1218    RECORD_END();
1219  }
1220  #ifndef SEGGER_SYSVIEW_EXCLUDE_PRINTF 
1221  void SEGGER_SYSVIEW_PrintfHostEx(const char* s, U32 Options, ...) {
1222    va_list ParamList;
1223  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
1224    int r;
1225    va_start(ParamList, Options);
1226    r = _VPrintHost(s, Options, &amp;ParamList);
1227    va_end(ParamList);
1228    if (r == -1) {
1229      va_start(ParamList, Options);
1230      _VPrintTarget(s, Options, &amp;ParamList);
1231      va_end(ParamList);
1232    }
1233  #else
1234    va_start(ParamList, Options);
1235    _VPrintHost(s, Options, &amp;ParamList);
1236    va_end(ParamList);
1237  #endif
1238  }
1239  void SEGGER_SYSVIEW_PrintfHost(const char* s, ...) {
1240    va_list ParamList;
1241  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
1242    int r;
1243    va_start(ParamList, s);
1244    r = _VPrintHost(s, SEGGER_SYSVIEW_LOG, &amp;ParamList);
1245    va_end(ParamList);
1246    if (r == -1) {
1247      va_start(ParamList, s);
1248      _VPrintTarget(s, SEGGER_SYSVIEW_LOG, &amp;ParamList);
1249      va_end(ParamList);
1250    }
1251  #else
1252    va_start(ParamList, s);
1253    _VPrintHost(s, SEGGER_SYSVIEW_LOG, &amp;ParamList);
1254    va_end(ParamList);
1255  #endif
1256  }
1257  void SEGGER_SYSVIEW_WarnfHost(const char* s, ...) {
1258    va_list ParamList;
1259  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
1260    int r;
1261    va_start(ParamList, s);
1262    r = _VPrintHost(s, SEGGER_SYSVIEW_WARNING, &amp;ParamList);
1263    va_end(ParamList);
1264    if (r == -1) {
1265      va_start(ParamList, s);
1266      _VPrintTarget(s, SEGGER_SYSVIEW_WARNING, &amp;ParamList);
1267      va_end(ParamList);
1268    }
1269  #else
1270    va_start(ParamList, s);
1271    _VPrintHost(s, SEGGER_SYSVIEW_WARNING, &amp;ParamList);
1272    va_end(ParamList);
1273  #endif
1274  }
1275  void SEGGER_SYSVIEW_ErrorfHost(const char* s, ...) {
1276    va_list ParamList;
1277  #if SEGGER_SYSVIEW_PRINTF_IMPLICIT_FORMAT
1278    int r;
1279    va_start(ParamList, s);
1280    r = _VPrintHost(s, SEGGER_SYSVIEW_ERROR, &amp;ParamList);
1281    va_end(ParamList);
1282    if (r == -1) {
1283      va_start(ParamList, s);
1284      _VPrintTarget(s, SEGGER_SYSVIEW_ERROR, &amp;ParamList);
1285      va_end(ParamList);
1286    }
1287  #else
1288    va_start(ParamList, s);
1289    _VPrintHost(s, SEGGER_SYSVIEW_ERROR, &amp;ParamList);
1290    va_end(ParamList);
1291  #endif
1292  }
1293  void SEGGER_SYSVIEW_PrintfTargetEx(const char* s, U32 Options, ...) {
1294    va_list ParamList;
1295    va_start(ParamList, Options);
1296    _VPrintTarget(s, Options, &amp;ParamList);
1297    va_end(ParamList);
1298  }
1299  void SEGGER_SYSVIEW_PrintfTarget(const char* s, ...) {
1300    va_list ParamList;
1301    va_start(ParamList, s);
1302    _VPrintTarget(s, SEGGER_SYSVIEW_LOG, &amp;ParamList);
1303    va_end(ParamList);
1304  }
1305  void SEGGER_SYSVIEW_WarnfTarget(const char* s, ...) {
1306    va_list ParamList;
1307    va_start(ParamList, s);
1308    _VPrintTarget(s, SEGGER_SYSVIEW_WARNING, &amp;ParamList);
1309    va_end(ParamList);
1310  }
1311  void SEGGER_SYSVIEW_ErrorfTarget(const char* s, ...) {
1312    va_list ParamList;
1313    va_start(ParamList, s);
1314    _VPrintTarget(s, SEGGER_SYSVIEW_ERROR, &amp;ParamList);
1315    va_end(ParamList);
1316  }
1317  #endif 
1318  void SEGGER_SYSVIEW_Print(const char* s) {
1319    U8* pPayload;
1320    U8* pPayloadStart;
1321    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1322    pPayload = _EncodeStr(pPayloadStart, s, SEGGER_SYSVIEW_MAX_STRING_LEN);
1323    ENCODE_U32(pPayload, SEGGER_SYSVIEW_LOG);
1324    ENCODE_U32(pPayload, 0);
1325    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
1326    RECORD_END();
1327  }
1328  void SEGGER_SYSVIEW_Warn(const char* s) {
1329    U8* pPayload;
1330    U8* pPayloadStart;
1331    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1332    pPayload = _EncodeStr(pPayloadStart, s, SEGGER_SYSVIEW_MAX_STRING_LEN);
1333    ENCODE_U32(pPayload, SEGGER_SYSVIEW_WARNING);
1334    ENCODE_U32(pPayload, 0);
1335    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
1336    RECORD_END();
1337  }
1338  void SEGGER_SYSVIEW_Error(const char* s) {
1339    U8* pPayload;
1340    U8* pPayloadStart;
1341    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32 + SEGGER_SYSVIEW_MAX_STRING_LEN);
1342    pPayload = _EncodeStr(pPayloadStart, s, SEGGER_SYSVIEW_MAX_STRING_LEN);
1343    ENCODE_U32(pPayload, SEGGER_SYSVIEW_ERROR);
1344    ENCODE_U32(pPayload, 0);
1345    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_PRINT_FORMATTED);
1346    RECORD_END();
1347  }
1348  void SEGGER_SYSVIEW_EnableEvents(U32 EnableMask) {
1349    _SYSVIEW_Globals.DisabledEvents &amp;= ~EnableMask;
1350  }
1351  void SEGGER_SYSVIEW_DisableEvents(U32 DisableMask) {
1352    _SYSVIEW_Globals.DisabledEvents |= DisableMask;
1353  }
1354  int SEGGER_SYSVIEW_IsStarted(void) {
1355  #if (SEGGER_SYSVIEW_POST_MORTEM_MODE != 1)
1356    if (SEGGER_RTT_HASDATA(CHANNEL_ID_DOWN)) {
1357      if (_SYSVIEW_Globals.RecursionCnt == 0) {   
1358        _SYSVIEW_Globals.RecursionCnt = 1;
1359        _HandleIncomingPacket();
1360        _SYSVIEW_Globals.RecursionCnt = 0;
1361      }
1362    }
1363  #endif
1364    return _SYSVIEW_Globals.EnableState;
1365  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Adafruit_nRF52_Arduino-MDEwOlJlcG9zaXRvcnk3NDM1NDcyOQ==-flat-SEGGER_SYSVIEW.c</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Adafruit_nRF52_Arduino-MDEwOlJlcG9zaXRvcnk3NDM1NDcyOQ==-flat-SEGGER_SYSVIEW.c</div>
                </div>
                <div class="column column_space"><pre><code>685    _SendPacket(pPayloadStart, pPayloadStart, EventID);
686    RECORD_END();
687  }
688  void SEGGER_SYSVIEW_RecordU32(unsigned int EventID, U32 Value) {
689    U8* pPayload;
690    U8* pPayloadStart;
691    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + SEGGER_SYSVIEW_QUANTA_U32);
</pre></code></div>
                <div class="column column_space"><pre><code>979    _SendPacket(pPayloadStart, pPayload, SYSVIEW_EVTID_END_CALL);
980    RECORD_END();
981  }
982  void SEGGER_SYSVIEW_RecordEndCallU32(unsigned int EventID, U32 Para0) {
983    U8* pPayload;
984    U8* pPayloadStart;
985    RECORD_START(SEGGER_SYSVIEW_INFO_SIZE + 2 * SEGGER_SYSVIEW_QUANTA_U32);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    