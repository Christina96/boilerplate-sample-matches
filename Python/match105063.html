<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for sportbox.py &amp; nrk.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for sportbox.py &amp; nrk.py
      </h3>
<h1 align="center">
        5.1%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>sportbox.py (27.777779%)<th>nrk.py (2.8636885%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(17-50)<td><a href="#" name="0">(660-690)</a><td align="center"><font color="#ff0000">13</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(55-63)<td><a href="#" name="1">(599-602)</a><td align="center"><font color="#eb0000">12</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>sportbox.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from __future__ import unicode_literals
2 import re
3 from .common import InfoExtractor
4 from ..utils import (
5     determine_ext,
6     int_or_none,
7     js_to_json,
8     merge_dicts,
9 )
10 class SportBoxIE(InfoExtractor):
11     _VALID_URL = r'https?://(?:news\.sportbox|matchtv)\.ru/vdl/player(?:/[^/]+/|\?.*?\bn?id=)(?P&lt;id&gt;\d+)'
12     _TESTS = [<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>{
13         'url': 'http://news.sportbox.ru/vdl/player/ci/211355',
14         'info_dict': {
15             'id': '109158',
16             'ext': 'mp4',
17             'title': 'В Новороссийске прошел детский турнир «Поле славы боевой»',
18             'description': 'В Новороссийске прошел детский турнир «Поле славы боевой»',
19             'thumbnail': r're:^https?://.*\.jpg$',
20             'duration': 292,
21             'view_count': int,
22             'timestamp': 1426237001,
23             'upload_date': '20150313',
24         },
25         'params': {
26             'skip_download': True,
27         },
28     }, {
29         'url': 'http://news.sportbox.ru/vdl/player?nid=370908&amp;only_player=1&amp;autostart=false&amp;playeri=2&amp;height=340&amp;width=580',
30         'only_matching': True,
31     }, {
32         'url': 'https://news.sportbox.ru/vdl/player/media/193095',
33         'only_matching': True,
34     }, {
35         'url': 'https://news.sportbox.ru/vdl/player/media/109158',
36         'only_matching': True,
37     }, {
38         'url': 'https://matchtv.ru/vdl/player/media/109158',
39         'only_matching': True,
40     }]
41     @staticmethod
42     def _extract_urls(webpage):
43         return re.findall(</b></font>
44             r'&lt;iframe[^&gt;]+src="(https?://(?:news\.sportbox|matchtv)\.ru/vdl/player[^"]+)"',
45     def _real_extract(self, url):
46         video_id <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>= self._match_id(url)
47         webpage = self._download_webpage(url, video_id)
48         sources = self._parse_json(
49             self._search_regex(
50                 r'(?s)playerOptions\.sources(?:WithRes)?\s*=\s*(\[.+?\])\s*;\s*\n',
51                 webpage, 'sources'),
52             video_id, transform_source=</b></font>js_to_json)
53         formats = []
54         for source in sources:
55             src = source.get('src')
56             if not src:
57                 continue
58             if determine_ext(src) == 'm3u8':
59                 formats.extend(self._extract_m3u8_formats(
60                     src, video_id, 'mp4', entry_protocol='m3u8_native',
61                     m3u8_id='hls', fatal=False))
62             else:
63                 formats.append({
64                     'url': src,
65                 })
66         self._sort_formats(formats)
67         player = self._parse_json(
68             self._search_regex(
69                 r'(?s)playerOptions\s*=\s*({.+?})\s*;\s*\n', webpage,
70                 'player options', default='{}'),
71             video_id, transform_source=js_to_json)
72         media_id = player['mediaId']
73         info = self._search_json_ld(webpage, media_id, default={})
74         view_count = int_or_none(self._search_regex(
75             r'Просмотров\s*:\s*(\d+)', webpage, 'view count', default=None))
76         return merge_dicts(info, {
77             'id': media_id,
78             'title': self._og_search_title(webpage, default=None) or media_id,
79             'thumbnail': player.get('poster'),
80             'duration': int_or_none(player.get('duration')),
81             'view_count': view_count,
82             'formats': formats,
83         })
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>nrk.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from __future__ import unicode_literals
2 import itertools
3 import random
4 import re
5 from .common import InfoExtractor
6 from ..compat import compat_str
7 from ..utils import (
8     determine_ext,
9     ExtractorError,
10     int_or_none,
11     parse_duration,
12     str_or_none,
13     try_get,
14     urljoin,
15     url_or_none,
16 )
17 class NRKBaseIE(InfoExtractor):
18     _GEO_COUNTRIES = ['NO']
19     _CDN_REPL_REGEX = r'''(?x)://
20         (?:
21             nrkod\d{1,2}-httpcache0-47115-cacheod0\.dna\.ip-only\.net/47115-cacheod0|
22             nrk-od-no\.telenorcdn\.net|
23             minicdn-od\.nrk\.no/od/nrkhd-osl-rr\.netwerk\.no/no
24         )/'''
25     def _extract_nrk_formats(self, asset_url, video_id):
26         if re.match(r'https?://[^/]+\.akamaihd\.net/i/', asset_url):
27             return self._extract_akamai_formats(asset_url, video_id)
28         asset_url = re.sub(r'(?:bw_(?:low|high)=\d+|no_audio_only)&amp;?', '', asset_url)
29         formats = self._extract_m3u8_formats(
30             asset_url, video_id, 'mp4', 'm3u8_native', fatal=False)
31         if not formats and re.search(self._CDN_REPL_REGEX, asset_url):
32             formats = self._extract_m3u8_formats(
33                 re.sub(self._CDN_REPL_REGEX, '://nrk-od-%02d.akamaized.net/no/' % random.randint(0, 99), asset_url),
34                 video_id, 'mp4', 'm3u8_native', fatal=False)
35         return formats
36     def _raise_error(self, data):
37         MESSAGES = {
38             'ProgramRightsAreNotReady': 'Du kan dessverre ikke se eller høre programmet',
39             'ProgramRightsHasExpired': 'Programmet har gått ut',
40             'NoProgramRights': 'Ikke tilgjengelig',
41             'ProgramIsGeoBlocked': 'NRK har ikke rettigheter til å vise dette programmet utenfor Norge',
42         }
43         message_type = data.get('messageType', '')
44         if 'IsGeoBlocked' in message_type or try_get(data, lambda x: x['usageRights']['isGeoBlocked']) is True:
45             self.raise_geo_restricted(
46                 msg=MESSAGES.get('ProgramIsGeoBlocked'),
47                 countries=self._GEO_COUNTRIES)
48         message = data.get('endUserMessage') or MESSAGES.get(message_type, message_type)
49         raise ExtractorError('%s said: %s' % (self.IE_NAME, message), expected=True)
50     def _call_api(self, path, video_id, item=None, note=None, fatal=True, query=None):
51         return self._download_json(
52             urljoin('https://psapi.nrk.no/', path),
53             video_id, note or 'Downloading %s JSON' % item,
54             fatal=fatal, query=query,
55             headers={'Accept-Encoding': 'gzip, deflate, br'})
56 class NRKIE(NRKBaseIE):
57     _VALID_URL = r'''(?x)
58                         (?:
59                             nrk:|
60                             https?://
61                                 (?:
62                                     (?:www\.)?nrk\.no/video/(?:PS\*|[^_]+_)|
63                                     v8[-.]psapi\.nrk\.no/mediaelement/
64                                 )
65                             )
66                             (?P&lt;id&gt;[^?\#&amp;]+)
67                         '''
68     _TESTS = [{
69         'url': 'http://www.nrk.no/video/PS*150533',
70         'md5': 'f46be075326e23ad0e524edfcb06aeb6',
71         'info_dict': {
72             'id': '150533',
73             'ext': 'mp4',
74             'title': 'Dompap og andre fugler i Piip-Show',
75             'description': 'md5:d9261ba34c43b61c812cb6b0269a5c8f',
76             'duration': 262,
77         }
78     }, {
79         'url': 'http://www.nrk.no/video/PS*154915',
80         'info_dict': {
81             'id': '154915',
82             'ext': 'mp4',
83             'title': 'Slik høres internett ut når du er blind',
84             'description': 'md5:a621f5cc1bd75c8d5104cb048c6b8568',
85             'duration': 20,
86         }
87     }, {
88         'url': 'nrk:ecc1b952-96dc-4a98-81b9-5296dc7a98d9',
89         'only_matching': True,
90     }, {
91         'url': 'nrk:clip/7707d5a3-ebe7-434a-87d5-a3ebe7a34a70',
92         'only_matching': True,
93     }, {
94         'url': 'https://v8-psapi.nrk.no/mediaelement/ecc1b952-96dc-4a98-81b9-5296dc7a98d9',
95         'only_matching': True,
96     }, {
97         'url': 'https://www.nrk.no/video/dompap-og-andre-fugler-i-piip-show_150533',
98         'only_matching': True,
99     }, {
100         'url': 'https://www.nrk.no/video/humor/kommentatorboksen-reiser-til-sjos_d1fda11f-a4ad-437a-a374-0398bc84e999',
101         'only_matching': True,
102     }, {
103         'url': 'nrk:l_96f4f1b0-de54-4e6a-b4f1-b0de54fe6af8',
104         'only_matching': True,
105     }, {
106         'url': 'nrk:podcast/l_96f4f1b0-de54-4e6a-b4f1-b0de54fe6af8',
107         'only_matching': True,
108     }, {
109         'url': 'nrk:150533',
110         'only_matching': True,
111     }, {
112         'url': 'nrk:clip/150533',
113         'only_matching': True,
114     }, {
115         'url': 'nrk:MDDP12000117',
116         'only_matching': True,
117     }, {
118         'url': 'nrk:program/ENRK10100318',
119         'only_matching': True,
120     }, {
121         'url': 'nrk:nrk1',
122         'only_matching': True,
123     }, {
124         'url': 'nrk:channel/nrk1',
125         'only_matching': True,
126     }]
127     def _real_extract(self, url):
128         video_id = self._match_id(url).split('/')[-1]
129         path_templ = 'playback/%s/' + video_id
130         def call_playback_api(item, query=None):
131             return self._call_api(path_templ % item, video_id, item, query=query)
132         manifest = call_playback_api('manifest', {'preferredCdn': 'akamai'})
133         video_id = try_get(manifest, lambda x: x['id'], compat_str) or video_id
134         if manifest.get('playability') == 'nonPlayable':
135             self._raise_error(manifest['nonPlayable'])
136         playable = manifest['playable']
137         formats = []
138         for asset in playable['assets']:
139             if not isinstance(asset, dict):
140                 continue
141             if asset.get('encrypted'):
142                 continue
143             format_url = url_or_none(asset.get('url'))
144             if not format_url:
145                 continue
146             asset_format = (asset.get('format') or '').lower()
147             if asset_format == 'hls' or determine_ext(format_url) == 'm3u8':
148                 formats.extend(self._extract_nrk_formats(format_url, video_id))
149             elif asset_format == 'mp3':
150                 formats.append({
151                     'url': format_url,
152                     'format_id': asset_format,
153                     'vcodec': 'none',
154                 })
155         self._sort_formats(formats)
156         data = call_playback_api('metadata')
157         preplay = data['preplay']
158         titles = preplay['titles']
159         title = titles['title']
160         alt_title = titles.get('subtitle')
161         description = preplay.get('description')
162         duration = parse_duration(playable.get('duration')) or parse_duration(data.get('duration'))
163         thumbnails = []
164         for image in try_get(
165                 preplay, lambda x: x['poster']['images'], list) or []:
166             if not isinstance(image, dict):
167                 continue
168             image_url = url_or_none(image.get('url'))
169             if not image_url:
170                 continue
171             thumbnails.append({
172                 'url': image_url,
173                 'width': int_or_none(image.get('pixelWidth')),
174                 'height': int_or_none(image.get('pixelHeight')),
175             })
176         subtitles = {}
177         for sub in try_get(playable, lambda x: x['subtitles'], list) or []:
178             if not isinstance(sub, dict):
179                 continue
180             sub_url = url_or_none(sub.get('webVtt'))
181             if not sub_url:
182                 continue
183             sub_key = str_or_none(sub.get('language')) or 'nb'
184             sub_type = str_or_none(sub.get('type'))
185             if sub_type:
186                 sub_key += '-%s' % sub_type
187             subtitles.setdefault(sub_key, []).append({
188                 'url': sub_url,
189             })
190         legal_age = try_get(
191             data, lambda x: x['legalAge']['body']['rating']['code'], compat_str)
192         age_limit = None
193         if legal_age:
194             if legal_age == 'A':
195                 age_limit = 0
196             elif legal_age.isdigit():
197                 age_limit = int_or_none(legal_age)
198         is_series = try_get(data, lambda x: x['_links']['series']['name']) == 'series'
199         info = {
200             'id': video_id,
201             'title': title,
202             'alt_title': alt_title,
203             'description': description,
204             'duration': duration,
205             'thumbnails': thumbnails,
206             'age_limit': age_limit,
207             'formats': formats,
208             'subtitles': subtitles,
209         }
210         if is_series:
211             series = season_id = season_number = episode = episode_number = None
212             programs = self._call_api(
213                 'programs/%s' % video_id, video_id, 'programs', fatal=False)
214             if programs and isinstance(programs, dict):
215                 series = str_or_none(programs.get('seriesTitle'))
216                 season_id = str_or_none(programs.get('seasonId'))
217                 season_number = int_or_none(programs.get('seasonNumber'))
218                 episode = str_or_none(programs.get('episodeTitle'))
219                 episode_number = int_or_none(programs.get('episodeNumber'))
220             if not series:
221                 series = title
222             if alt_title:
223                 title += ' - %s' % alt_title
224             if not season_number:
225                 season_number = int_or_none(self._search_regex(
226                     r'Sesong\s+(\d+)', description or '', 'season number',
227                     default=None))
228             if not episode:
229                 episode = alt_title if is_series else None
230             if not episode_number:
231                 episode_number = int_or_none(self._search_regex(
232                     r'^(\d+)\.', episode or '', 'episode number',
233                     default=None))
234             if not episode_number:
235                 episode_number = int_or_none(self._search_regex(
236                     r'\((\d+)\s*:\s*\d+\)', description or '',
237                     'episode number', default=None))
238             info.update({
239                 'title': title,
240                 'series': series,
241                 'season_id': season_id,
242                 'season_number': season_number,
243                 'episode': episode,
244                 'episode_number': episode_number,
245             })
246         return info
247 class NRKTVIE(InfoExtractor):
248     IE_DESC = 'NRK TV and NRK Radio'
249     _EPISODE_RE = r'(?P&lt;id&gt;[a-zA-Z]{4}\d{8})'
250     _VALID_URL = r'https?://(?:tv|radio)\.nrk(?:super)?\.no/(?:[^/]+/)*%s' % _EPISODE_RE
251     _TESTS = [{
252         'url': 'https://tv.nrk.no/program/MDDP12000117',
253         'md5': 'c4a5960f1b00b40d47db65c1064e0ab1',
254         'info_dict': {
255             'id': 'MDDP12000117',
256             'ext': 'mp4',
257             'title': 'Alarm Trolltunga',
258             'description': 'md5:46923a6e6510eefcce23d5ef2a58f2ce',
259             'duration': 2223.44,
260             'age_limit': 6,
261             'subtitles': {
262                 'nb-nor': [{
263                     'ext': 'vtt',
264                 }],
265                 'nb-ttv': [{
266                     'ext': 'vtt',
267                 }]
268             },
269         },
270     }, {
271         'url': 'https://tv.nrk.no/serie/20-spoersmaal-tv/MUHH48000314/23-05-2014',
272         'md5': '8d40dab61cea8ab0114e090b029a0565',
273         'info_dict': {
274             'id': 'MUHH48000314',
275             'ext': 'mp4',
276             'title': '20 spørsmål - 23. mai 2014',
277             'alt_title': '23. mai 2014',
278             'description': 'md5:bdea103bc35494c143c6a9acdd84887a',
279             'duration': 1741,
280             'series': '20 spørsmål',
281             'episode': '23. mai 2014',
282             'age_limit': 0,
283         },
284     }, {
285         'url': 'https://tv.nrk.no/program/mdfp15000514',
286         'info_dict': {
287             'id': 'MDFP15000514',
288             'ext': 'mp4',
289             'title': 'Kunnskapskanalen - Grunnlovsjubiléet - Stor ståhei for ingenting',
290             'description': 'md5:89290c5ccde1b3a24bb8050ab67fe1db',
291             'duration': 4605.08,
292             'series': 'Kunnskapskanalen',
293             'episode': 'Grunnlovsjubiléet - Stor ståhei for ingenting',
294             'age_limit': 0,
295         },
296         'params': {
297             'skip_download': True,
298         },
299     }, {
300         'url': 'https://tv.nrk.no/serie/tour-de-ski/MSPO40010515/06-01-2015#del=2',
301         'info_dict': {
302             'id': 'MSPO40010515',
303             'ext': 'mp4',
304             'title': 'Sprint fri teknikk, kvinner og menn 06.01.2015',
305             'description': 'md5:c03aba1e917561eface5214020551b7a',
306             'age_limit': 0,
307         },
308         'params': {
309             'skip_download': True,
310         },
311         'expected_warnings': ['Failed to download m3u8 information'],
312         'skip': 'particular part is not supported currently',
313     }, {
314         'url': 'https://tv.nrk.no/serie/tour-de-ski/MSPO40010515/06-01-2015',
315         'info_dict': {
316             'id': 'MSPO40010515',
317             'ext': 'mp4',
318             'title': 'Sprint fri teknikk, kvinner og menn 06.01.2015',
319             'description': 'md5:c03aba1e917561eface5214020551b7a',
320             'age_limit': 0,
321         },
322         'expected_warnings': ['Failed to download m3u8 information'],
323         'skip': 'Ikke tilgjengelig utenfor Norge',
324     }, {
325         'url': 'https://tv.nrk.no/serie/anno/KMTE50001317/sesong-3/episode-13',
326         'info_dict': {
327             'id': 'KMTE50001317',
328             'ext': 'mp4',
329             'title': 'Anno - 13. episode',
330             'description': 'md5:11d9613661a8dbe6f9bef54e3a4cbbfa',
331             'duration': 2340,
332             'series': 'Anno',
333             'episode': '13. episode',
334             'season_number': 3,
335             'episode_number': 13,
336             'age_limit': 0,
337         },
338         'params': {
339             'skip_download': True,
340         },
341     }, {
342         'url': 'https://tv.nrk.no/serie/nytt-paa-nytt/MUHH46000317/27-01-2017',
343         'info_dict': {
344             'id': 'MUHH46000317',
345             'ext': 'mp4',
346             'title': 'Nytt på Nytt 27.01.2017',
347             'description': 'md5:5358d6388fba0ea6f0b6d11c48b9eb4b',
348             'duration': 1796,
349             'series': 'Nytt på nytt',
350             'episode': '27.01.2017',
351             'age_limit': 0,
352         },
353         'params': {
354             'skip_download': True,
355         },
356         'skip': 'ProgramRightsHasExpired',
357     }, {
358         'url': 'https://radio.nrk.no/serie/dagsnytt/NPUB21019315/12-07-2015#',
359         'only_matching': True,
360     }, {
361         'url': 'https://tv.nrk.no/serie/lindmo/2018/MUHU11006318/avspiller',
362         'only_matching': True,
363     }, {
364         'url': 'https://radio.nrk.no/serie/dagsnytt/sesong/201507/NPUB21019315',
365         'only_matching': True,
366     }]
367     def _real_extract(self, url):
368         video_id = self._match_id(url)
369         return self.url_result(
370             'nrk:%s' % video_id, ie=NRKIE.ie_key(), video_id=video_id)
371 class NRKTVEpisodeIE(InfoExtractor):
372     _VALID_URL = r'https?://tv\.nrk\.no/serie/(?P&lt;id&gt;[^/]+/sesong/(?P&lt;season_number&gt;\d+)/episode/(?P&lt;episode_number&gt;\d+))'
373     _TESTS = [{
374         'url': 'https://tv.nrk.no/serie/hellums-kro/sesong/1/episode/2',
375         'info_dict': {
376             'id': 'MUHH36005220',
377             'ext': 'mp4',
378             'title': 'Hellums kro - 2. Kro, krig og kjærlighet',
379             'description': 'md5:ad92ddffc04cea8ce14b415deef81787',
380             'duration': 1563.92,
381             'series': 'Hellums kro',
382             'season_number': 1,
383             'episode_number': 2,
384             'episode': '2. Kro, krig og kjærlighet',
385             'age_limit': 6,
386         },
387         'params': {
388             'skip_download': True,
389         },
390     }, {
391         'url': 'https://tv.nrk.no/serie/backstage/sesong/1/episode/8',
392         'info_dict': {
393             'id': 'MSUI14000816',
394             'ext': 'mp4',
395             'title': 'Backstage - 8. episode',
396             'description': 'md5:de6ca5d5a2d56849e4021f2bf2850df4',
397             'duration': 1320,
398             'series': 'Backstage',
399             'season_number': 1,
400             'episode_number': 8,
401             'episode': '8. episode',
402             'age_limit': 0,
403         },
404         'params': {
405             'skip_download': True,
406         },
407         'skip': 'ProgramRightsHasExpired',
408     }]
409     def _real_extract(self, url):
410         display_id, season_number, episode_number = re.match(self._VALID_URL, url).groups()
411         webpage = self._download_webpage(url, display_id)
412         info = self._search_json_ld(webpage, display_id, default={})
413         nrk_id = info.get('@id') or self._html_search_meta(
414             'nrk:program-id', webpage, default=None) or self._search_regex(
415             r'data-program-id=["\'](%s)' % NRKTVIE._EPISODE_RE, webpage,
416             'nrk id')
417         assert re.match(NRKTVIE._EPISODE_RE, nrk_id)
418         info.update({
419             '_type': 'url',
420             'id': nrk_id,
421             'url': 'nrk:%s' % nrk_id,
422             'ie_key': NRKIE.ie_key(),
423             'season_number': int(season_number),
424             'episode_number': int(episode_number),
425         })
426         return info
427 class NRKTVSerieBaseIE(NRKBaseIE):
428     def _extract_entries(self, entry_list):
429         if not isinstance(entry_list, list):
430             return []
431         entries = []
432         for episode in entry_list:
433             nrk_id = episode.get('prfId') or episode.get('episodeId')
434             if not nrk_id or not isinstance(nrk_id, compat_str):
435                 continue
436             entries.append(self.url_result(
437                 'nrk:%s' % nrk_id, ie=NRKIE.ie_key(), video_id=nrk_id))
438         return entries
439     _ASSETS_KEYS = ('episodes', 'instalments',)
440     def _extract_assets_key(self, embedded):
441         for asset_key in self._ASSETS_KEYS:
442             if embedded.get(asset_key):
443                 return asset_key
444     @staticmethod
445     def _catalog_name(serie_kind):
446         return 'podcast' if serie_kind in ('podcast', 'podkast') else 'series'
447     def _entries(self, data, display_id):
448         for page_num in itertools.count(1):
449             embedded = data.get('_embedded') or data
450             if not isinstance(embedded, dict):
451                 break
452             assets_key = self._extract_assets_key(embedded)
453             if not assets_key:
454                 break
455             entries = try_get(
456                 embedded,
457                 (lambda x: x[assets_key]['_embedded'][assets_key],
458                  lambda x: x[assets_key]),
459                 list)
460             for e in self._extract_entries(entries):
461                 yield e
462             next_url_path = try_get(
463                 data,
464                 (lambda x: x['_links']['next']['href'],
465                  lambda x: x['_embedded'][assets_key]['_links']['next']['href']),
466                 compat_str)
467             if not next_url_path:
468                 break
469             data = self._call_api(
470                 next_url_path, display_id,
471                 note='Downloading %s JSON page %d' % (assets_key, page_num),
472                 fatal=False)
473             if not data:
474                 break
475 class NRKTVSeasonIE(NRKTVSerieBaseIE):
476     _VALID_URL = r'''(?x)
477                     https?://
478                         (?P&lt;domain&gt;tv|radio)\.nrk\.no/
479                         (?P&lt;serie_kind&gt;serie|pod[ck]ast)/
480                         (?P&lt;serie&gt;[^/]+)/
481                         (?:
482                             (?:sesong/)?(?P&lt;id&gt;\d+)|
483                             sesong/(?P&lt;id_2&gt;[^/?#&amp;]+)
484                         )
485                     '''
486         serie_kind <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>= mobj.group('serie_kind')
487         serie = mobj.group('serie')
488         season_id = mobj.group('id') or mobj.group('id_2')
489         display_id =</b></font> '%s/%s' % (serie, season_id)
490         data = self._call_api(
491             '%s/catalog/%s/%s/seasons/%s'
492             % (domain, self._catalog_name(serie_kind), serie, season_id),
493             display_id, 'season', query={'pageSize': 50})
494         title = try_get(data, lambda x: x['titles']['title'], compat_str) or display_id
495         return self.playlist_result(
496             self._entries(data, display_id),
497             display_id, title)
498 class NRKTVSeriesIE(NRKTVSerieBaseIE):
499     _VALID_URL = r'https?://(?P&lt;domain&gt;(?:tv|radio)\.nrk|(?:tv\.)?nrksuper)\.no/(?P&lt;serie_kind&gt;serie|pod[ck]ast)/(?P&lt;id&gt;[^/]+)'
500     _TESTS = [{
501         'url': 'https://tv.nrk.no/serie/groenn-glede',
502         'info_dict': {
503             'id': 'groenn-glede',
504             'title': 'Grønn glede',
505             'description': 'md5:7576e92ae7f65da6993cf90ee29e4608',
506         },
507         'playlist_mincount': 90,
508     }, {
509         'url': 'https://tv.nrk.no/serie/lindmo',
510         'only_matching': True,
511     }, {
512         'url': 'https://tv.nrk.no/serie/blank',
513         'info_dict': {
514             'id': 'blank',
515             'title': 'Blank',
516             'description': 'md5:7664b4e7e77dc6810cd3bca367c25b6e',
517         },
518         'playlist_mincount': 30,
519     }, {
520         'url': 'https://tv.nrk.no/serie/backstage',
521         'info_dict': {
522             'id': 'backstage',
523             'title': 'Backstage',
524             'description': 'md5:63692ceb96813d9a207e9910483d948b',
525         },
526         'playlist_mincount': 60,
527     }, {
528         'url': 'https://tv.nrksuper.no/serie/labyrint',
529         'info_dict': {
530             'id': 'labyrint',
531             'title': 'Labyrint',
532             'description': 'I Daidalos sin undersjøiske Labyrint venter spennende oppgaver, skumle robotskapninger og slim.',
533         },
534         'playlist_mincount': 3,
535     }, {
536         'only_matching': True,
537     }, {
538         <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>'url': 'https://tv.nrk.no/serie/saving-the-human-race',
539         'only_matching': True,
540     }, {
541         'url': 'https://tv.nrk.no/serie/postmann-pat',
542         'only_matching': True,
543     }, {
544         'url': 'https://radio.nrk.no/serie/dickie-dick-dickens',
545         'info_dict': {
546             'id': 'dickie-dick-dickens',
547             'title': 'Dickie Dick Dickens',
548             'description': 'md5:19e67411ffe57f7dce08a943d7a0b91f',
549         },
550         'playlist_mincount': 8,
551     }, {
552         'url': 'https://nrksuper.no/serie/labyrint',
553         'only_matching': True,
554     }, {
555         'url': 'https://radio.nrk.no/podkast/ulrikkes_univers',
556         'info_dict': {
557             'id': 'ulrikkes_univers',
558         },
559         'playlist_mincount': 10,
560     }, {
561         'url': 'https://radio.nrk.no/podkast/ulrikkes_univers/nrkno-poddkast-26588-134079-05042018030000',
562         'only_matching': True,
563     }]
564     @classmethod
565     def suitable(cls, url):
566         return (
567             False if any(</b></font>ie.suitable(url)
568                          for ie in (NRKTVIE, NRKTVEpisodeIE, NRKRadioPodkastIE, NRKTVSeasonIE))
569             else super(NRKTVSeriesIE, cls).suitable(url))
570     def _real_extract(self, url):
571         site, serie_kind, series_id = re.match(self._VALID_URL, url).groups()
572         is_radio = site == 'radio.nrk'
573         domain = 'radio' if is_radio else 'tv'
574         size_prefix = 'p' if is_radio else 'embeddedInstalmentsP'
575         series = self._call_api(
576             '%s/catalog/%s/%s'
577             % (domain, self._catalog_name(serie_kind), series_id),
578             series_id, 'serie', query={size_prefix + 'ageSize': 50})
579         titles = try_get(series, [
580             lambda x: x['titles'],
581             lambda x: x[x['type']]['titles'],
582             lambda x: x[x['seriesType']]['titles'],
583         ]) or {}
584         entries = []
585         entries.extend(self._entries(series, series_id))
586         embedded = series.get('_embedded') or {}
587         linked_seasons = try_get(series, lambda x: x['_links']['seasons']) or []
588         embedded_seasons = embedded.get('seasons') or []
589         if len(linked_seasons) &gt; len(embedded_seasons):
590             for season in linked_seasons:
591                 season_url = urljoin(url, season.get('href'))
592                 if not season_url:
593                     season_name = season.get('name')
594                     if season_name and isinstance(season_name, compat_str):
595                         season_url = 'https://%s.nrk.no/serie/%s/sesong/%s' % (domain, series_id, season_name)
596                 if season_url:
597                     entries.append(self.url_result(
598                         season_url, ie=NRKTVSeasonIE.ie_key(),
599                         video_title=season.get('title')))
600         else:
601             for season in embedded_seasons:
602                 entries.extend(self._entries(season, series_id))
603         entries.extend(self._entries(
604             embedded.get('extraMaterial') or {}, series_id))
605         return self.playlist_result(
606             entries, series_id, titles.get('title'), titles.get('subtitle'))
607 class NRKTVDirekteIE(NRKTVIE):
608     IE_DESC = 'NRK TV Direkte and NRK Radio Direkte'
609     _VALID_URL = r'https?://(?:tv|radio)\.nrk\.no/direkte/(?P&lt;id&gt;[^/?#&amp;]+)'
610     _TESTS = [{
611         'url': 'https://tv.nrk.no/direkte/nrk1',
612         'only_matching': True,
613     }, {
614         'url': 'https://radio.nrk.no/direkte/p1_oslo_akershus',
615         'only_matching': True,
616     }]
617 class NRKRadioPodkastIE(InfoExtractor):
618     _VALID_URL = r'https?://radio\.nrk\.no/pod[ck]ast/(?:[^/]+/)+(?P&lt;id&gt;l_[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12})'
619     _TESTS = [{
620         'url': 'https://radio.nrk.no/podkast/ulrikkes_univers/l_96f4f1b0-de54-4e6a-b4f1-b0de54fe6af8',
621         'md5': '8d40dab61cea8ab0114e090b029a0565',
622         'info_dict': {
623             'id': 'MUHH48000314AA',
624             'ext': 'mp4',
625             'title': '20 spørsmål 23.05.2014',
626             'description': 'md5:bdea103bc35494c143c6a9acdd84887a',
627             'duration': 1741,
628             'series': '20 spørsmål',
629             'episode': '23.05.2014',
630         },
631     }, {
632         'url': 'https://radio.nrk.no/podcast/ulrikkes_univers/l_96f4f1b0-de54-4e6a-b4f1-b0de54fe6af8',
633         'only_matching': True,
634     }, {
635         'url': 'https://radio.nrk.no/podkast/ulrikkes_univers/sesong/1/l_96f4f1b0-de54-4e6a-b4f1-b0de54fe6af8',
636         'only_matching': True,
637     }, {
638         'url': 'https://radio.nrk.no/podkast/hele_historien/sesong/bortfoert-i-bergen/l_774d1a2c-7aa7-4965-8d1a-2c7aa7d9652c',
639         'only_matching': True,
640     }]
641     def _real_extract(self, url):
642         video_id = self._match_id(url)
643         return self.url_result(
644             'nrk:%s' % video_id, ie=NRKIE.ie_key(), video_id=video_id)
645 class NRKPlaylistBaseIE(InfoExtractor):
646     def _extract_description(self, webpage):
647         pass
648     def _real_extract(self, url):
649         playlist_id = self._match_id(url)
650         webpage = self._download_webpage(url, playlist_id)
651         entries = [
652             self.url_result('nrk:%s' % video_id, NRKIE.ie_key())
653             for video_id in re.findall(self._ITEM_RE, webpage)
654         ]
655         playlist_title = self. _extract_title(webpage)
656         playlist_description = self._extract_description(webpage)
657         return self.playlist_result(
658             entries, playlist_id, playlist_title, playlist_description)
659 class NRKPlaylistIE(NRKPlaylistBaseIE):
660     _VALID_URL = r'https?://(?:www\.)?nrk\.no/(?!video|skole)(?:[^/]+/)+(?P&lt;id&gt;[^/]+)'
661     _ITEM_RE = r'class="[^"]*\brich\b[^"]*"[^&gt;]+data-video-id="([^"]+)"'
662     _TESTS = [{
663         'url': 'http://www.nrk.no/troms/gjenopplev-den-historiske-solformorkelsen-1.12270763',
664         'info_dict': {
665             'id': 'gjenopplev-den-historiske-solformorkelsen-1.12270763',
666             'title': 'Gjenopplev den historiske solformørkelsen',
667             'description': 'md5:c2df8ea3bac5654a26fc2834a542feed',
668         },
669         'playlist_count': 2,
670     }, {
671         'url': 'http://www.nrk.no/kultur/bok/rivertonprisen-til-karin-fossum-1.12266449',
672         'info_dict': {
673             'id': 'rivertonprisen-til-karin-fossum-1.12266449',
674             'title': 'Rivertonprisen til Karin Fossum',
675             'description': 'Første kvinne på 15 år til å vinne krimlitteraturprisen.',
676         },
677         'playlist_count': 2,
678     }]
679     def _extract_title(self, webpage):
680         return self._og_search_title(webpage, fatal=False)
681     def _extract_description(self, webpage):
682         return self._og_search_description(webpage)
683 class NRKTVEpisodesIE(NRKPlaylistBaseIE):
684     _VALID_URL = r'https?://tv\.nrk\.no/program/[Ee]pisodes/[^/]+/(?P&lt;id&gt;\d+)'
685     _ITEM_RE = r'data-episode=["\']%s' % NRKTVIE._EPISODE_RE
686     _TESTS = [{
687         'url': 'https://tv.nrk.no/program/episodes/nytt-paa-nytt/69031',
688         'info_dict': {
689             'id': '69031',
690             'title': 'Nytt på nytt, sesong: 201210',
691         },
692         'playlist_count': 4,
693     }]
694     def _extract_title(self, webpage):
695         return self._html_search_regex(
696             r'&lt;h1&gt;([^&lt;]+)&lt;/h1&gt;', webpage, 'title', fatal=False)
697 class NRKSkoleIE(InfoExtractor):
698     IE_DESC = 'NRK Skole'
699     _VALID_URL = r'https?://(?:www\.)?nrk\.no/skole/?\?.*\bmediaId=(?P&lt;id&gt;\d+)'
700     _TESTS = [{
701         'url': 'https://www.nrk.no/skole/?page=search&amp;q=&amp;mediaId=14099',
702         'md5': '18c12c3d071953c3bf8d54ef6b2587b7',
703         'info_dict': {
704             'id': '6021',
705             'ext': 'mp4',
706             'title': 'Genetikk og eneggede tvillinger',
707             'description': 'md5:3aca25dcf38ec30f0363428d2b265f8d',
708             'duration': 399,
709         },
710     }, {
711         'url': 'https://www.nrk.no/skole/?page=objectives&amp;subject=naturfag&amp;objective=K15114&amp;mediaId=19355',
712         'only_matching': True,
713     }]
714     def _real_extract(self, url):
715         video_id = self._match_id(url)
716         nrk_id = self._download_json(
717             'https://nrkno-skole-prod.kube.nrk.no/skole/api/media/%s' % video_id,
718             video_id)['psId']
719         return self.url_result('nrk:%s' % nrk_id)
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
