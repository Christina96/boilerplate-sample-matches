<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for kickstart.py &amp; test_ipaddress.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for kickstart.py &amp; test_ipaddress.py
      </h3>
<h1 align="center">
        3.3%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>kickstart.py (5.574468%)<th>test_ipaddress.py (2.363341%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(951-958)<td><a href="#" name="0">(1128-1133)</a><td align="center"><font color="#ff0000">16</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(554-565)<td><a href="#" name="1">(2794-2800)</a><td align="center"><font color="#df0000">14</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(414-425)<td><a href="#" name="2">(2788-2794)</a><td align="center"><font color="#df0000">14</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(1127-1133)<td><a href="#" name="3">(1073-1075)</a><td align="center"><font color="#cf0000">13</font>
<tr onclick='openModal("#6cc417")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#6cc417"><font color="#6cc417">-</font><td><a href="#" name="4">(1077-1083)<td><a href="#" name="4">(134-137)</a><td align="center"><font color="#cf0000">13</font>
<tr onclick='openModal("#151b8d")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#151b8d"><font color="#151b8d">-</font><td><a href="#" name="5">(770-780)<td><a href="#" name="5">(2779-2786)</a><td align="center"><font color="#cf0000">13</font>
<tr onclick='openModal("#8c8774")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#8c8774"><font color="#8c8774">-</font><td><a href="#" name="6">(1013-1018)<td><a href="#" name="6">(1133-1138)</a><td align="center"><font color="#bf0000">12</font>
<tr onclick='openModal("#38a4a5")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#38a4a5"><font color="#38a4a5">-</font><td><a href="#" name="7">(218-222)<td><a href="#" name="7">(202-206)</a><td align="center"><font color="#bf0000">12</font>
<tr onclick='openModal("#c58917")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#c58917"><font color="#c58917">-</font><td><a href="#" name="8">(133-143)<td><a href="#" name="8">(1209-1217)</a><td align="center"><font color="#bf0000">12</font>
<tr onclick='openModal("#83a33a")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#83a33a"><font color="#83a33a">-</font><td><a href="#" name="9">(115-125)<td><a href="#" name="9">(1151-1159)</a><td align="center"><font color="#bf0000">12</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>kickstart.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import argparse
2 import shlex
3 import salt.utils.files
4 import salt.utils.yaml
5 def clean_args(args):
6     for arg in list(args):
7         if not args[arg]:
8             del args[arg]
9     return args
10 def parse_auth(rule):
11     parser = argparse.ArgumentParser()
12     rules = shlex.split(rule)
13     rules.pop(0)
14     noargs = (
15         "back",
16         "test",
17         "nostart",
18         "kickstart",
19         "probe",
20         "enablecache",
21         "disablecache",
22         "disablenis",
23         "enableshadow",
24         "disableshadow",
25         "enablemd5",
26         "disablemd5",
27         "enableldap",
28         "enableldapauth",
29         "enableldaptls",
30         "disableldap",
31         "disableldapauth",
32         "enablekrb5kdcdns",
33         "disablekrb5kdcdns",
34         "enablekrb5realmdns",
35         "disablekrb5realmdns",
36         "disablekrb5",
37         "disablehe-siod",
38         "enablesmbauth",
39         "disablesmbauth",
40         "enablewinbind",
41         "enablewinbindauth",
42         "disablewinbind",
43         "disablewinbindauth",
44         "enablewinbindusedefaultdomain",
45         "disablewinbindusedefaultdomain",
46         "enablewins",
47         "disablewins",
48     )
49     for arg in noargs:
50         parser.add_argument("--{}".format(arg), dest=arg, action="store_true")
51     parser.add_argument("--enablenis", dest="enablenis", action="store")
52     parser.add_argument("--hesiodrhs", dest="hesiodrhs", action="store")
53     parser.add_argument("--krb5adminserver", dest="krb5adminserver", action="append")
54     parser.add_argument("--krb5kdc", dest="krb5kdc", action="append")
55     parser.add_argument("--ldapbasedn", dest="ldapbasedn", action="store")
56     parser.add_argument("--ldapserver", dest="ldapserver", action="append")
57     parser.add_argument("--nisserver", dest="nisserver", action="append")
58     parser.add_argument("--passalgo", dest="passalgo", action="store")
59     parser.add_argument("--smbidmapgid", dest="smbidmapgid", action="store")
60     parser.add_argument("--smbidmapuid", dest="smbidmapuid", action="store")
61     parser.add_argument("--smbrealm", dest="smbrealm", action="store")
62     parser.add_argument(
63         "--smbsecurity",
64         dest="smbsecurity",
65         action="store",
66         choices=["user", "server", "domain", "dns"],
67     )
68     parser.add_argument("--smbservers", dest="smbservers", action="store")
69     parser.add_argument("--smbworkgroup", dest="smbworkgroup", action="store")
70     parser.add_argument("--winbindjoin", dest="winbindjoin", action="store")
71     parser.add_argument("--winbindseparator", dest="winbindseparator", action="store")
72     parser.add_argument(
73         "--winbindtemplatehomedir", dest="winbindtemplatehomedir", action="store"
74     )
75     parser.add_argument(
76         "--winbindtemplateprimarygroup",
77         dest="winbindtemplateprimarygroup",
78         action="store",
79     )
80     parser.add_argument(
81         "--winbindtemplateshell", dest="winbindtemplateshell", action="store"
82     )
83     parser.add_argument("--enablekrb5", dest="enablekrb5", action="store_true")
84     if "--enablekrb5" in rules:
85         parser.add_argument(
86             "--krb5realm", dest="krb5realm", action="store", required=True
87         )
88     parser.add_argument("--enablehesiod", dest="enablehesiod", action="store_true")
89     if "--enablehesiod" in rules:
90         parser.add_argument(
91             "--hesiodlhs", dest="hesiodlhs", action="store", required=True
92         )
93 <a name="9"></a>
94     args = clean_args(vars(parser.parse_args(rules)))
95     parser = None
96     r<font color="#83a33a"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>eturn args
97 def parse_autopart(rule):
98     parser = argparse.ArgumentParser()
99     rules = shlex.split(rule)
100     rules.pop(0)
101     parser.add_argument(</b></font>"--type", dest="type", action="store")
102     parser.add_argument("--encrypted", dest="encrypted", action="store_true")
103     parser.add_argument("--passphrase", dest="passphrase", action="store")
104     parser.add_argument("--escrowcert", dest="escrowcert", action="store")
105     parser.add_argument("--backuppassphrase", dest="backuppassphrase", action="store")
106 <a name="8"></a>
107     args = clean_args(vars(parser.parse_args(rules)))
108     parser = None
109     r<font color="#c58917"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>eturn args
110 def parse_autostep(rule):
111     parser = argparse.ArgumentParser()
112     rules = shlex.split(rule)
113     rules.pop(0)
114     parser.add_argument(</b></font>"--autoscreenshot", dest="autoscreenshot", action="store")
115     args = clean_args(vars(parser.parse_args(rules)))
116     parser = None
117     return args
118 def parse_bootloader(rule):
119     parser = argparse.ArgumentParser()
120     rules = shlex.split(rule)
121     rules.pop(0)
122     parser.add_argument("--append", dest="append", action="store")
123     parser.add_argument("--driveorder", dest="driveorder", action="store")
124     parser.add_argument("--location", dest="location", action="store")
125     parser.add_argument("--password", dest="password", action="store")
126     parser.add_argument("--md5pass", dest="md5pass", action="store")
127     parser.add_argument("--upgrade", dest="upgrade", action="store_true")
128     parser.add_argument("--timeout", dest="timeout", action="store")
129     parser.add_argument("--boot-drive", dest="bootdrive", action="store")
130     args = clean_args(vars(parser.parse_args(rules)))
131     parser = None
132     return args
133 def parse_btrfs(rule):
134     parser = argparse.ArgumentParser()
135     rules = shlex.split(rule)
136     rules.pop(0)
137     parser.add_argument("--name", dest="name", action="store")
138     parser.add_argument("--data", dest="data", action="store")
139     parser.add_argument("--metadata", dest="metadata", action="store")
140     parser.add_argument("--label", dest="label", action="store")
141     parser.add_argument("--noformat", dest="noformat", action="store_true")
142     parser.add_argument("--useexisting", dest="useexisting", action="store_true")
143     parser.add_argument("--subvol", dest="subvol", action="store_true")
144     args = clean_args(vars(parser.parse_args(rules)))
145     parser = None
146     return args
147 def parse_clearpart(rule):
148     parser = argparse.ArgumentParser()
149     rules = shlex.split(rule)
150     rules.pop(0)
151     parser.add_argument("--all", dest="all", action="store_true")
152     parser.add_argument("--drives", dest="drives", action="store")
153     parser.add_argument("--init_label", dest="init_label", action="store_true")
154     parser.add_argument("--linux", dest="linux", action="store_true")
155     parser.add_argument("--none", dest="none", action="store_true")
156     parser.add_argument("--initlabel", dest="init_label", action="store_true")
157     parser.add_argument("--list", dest="list", action="store")
158     args = clean_args(vars(parser.parse_args(rules)))
159     parser = None
160     return args
161 def parse_device(rule):
162 <a name="7"></a>    """
163     Parse the device line
164     parser = argparse<font color="#38a4a5"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.ArgumentParser()
165     rules = shlex.split(rule)
166     rules.pop(0)
167     modulename = rules.pop(0)
168     parser.add_argument(</b></font>"--opts", dest="opts", action="store")
169     args = clean_args(vars(parser.parse_args(rules)))
170     args["modulename"] = modulename
171     parser = None
172     return args
173 def parse_dmraid(rule):
174     parser = argparse.ArgumentParser()
175     rules = shlex.split(rule)
176     rules.pop(0)
177     parser.add_argument("--name", dest="name", action="store")
178     parser.add_argument("--dev", dest="dev", action="store")
179     args = clean_args(vars(parser.parse_args(rules)))
180     parser = None
181     return args
182 def parse_driverdisk(rule):
183     if "--" not in rule:
184         return {"partition": rule}
185     parser = argparse.ArgumentParser()
186     rules = shlex.split(rule)
187     rules.pop(0)
188     parser.add_argument("--source", dest="source", action="store")
189     parser.add_argument("--biospart", dest="biospart", action="store")
190     args = clean_args(vars(parser.parse_args(rules)))
191     parser = None
192     return args
193 def parse_firewall(rule):
194     parser = argparse.ArgumentParser()
195     rules = shlex.split(rule)
196     rules.pop(0)
197     parser.add_argument("--enable", "--enabled", dest="enable", action="store_true")
198     parser.add_argument("--disable", "--disabled", dest="disable", action="store_true")
199     parser.add_argument("--port", dest="port", action="store")
200     parser.add_argument("--service", dest="service", action="store")
201     parser.add_argument("--ssh", dest="ssh", action="store_true")
202     parser.add_argument("--smtp", dest="smtp", action="store_true")
203     parser.add_argument("--http", dest="http", action="store_true")
204     parser.add_argument("--ftp", dest="ftp", action="store_true")
205     args = clean_args(vars(parser.parse_args(rules)))
206     parser = None
207     return args
208 def parse_firstboot(rule):
209     parser = argparse.ArgumentParser()
210     rules = shlex.split(rule)
211     rules.pop(0)
212     parser.add_argument("--enable", "--enabled", dest="enable", action="store_true")
213     parser.add_argument("--disable", "--disabled", dest="disable", action="store_true")
214     parser.add_argument("--reconfig", dest="reconfig", action="store_true")
215     args = clean_args(vars(parser.parse_args(rules)))
216     parser = None
217     return args
218 def parse_group(rule):
219     parser = argparse.ArgumentParser()
220     rules = shlex.split(rule)
221     rules.pop(0)
222     parser.add_argument("--name", dest="name", action="store")
223     parser.add_argument("--gid", dest="gid", action="store")
224     args = clean_args(vars(parser.parse_args(rules)))
225     parser = None
226     return args
227 def parse_harddrive(rule):
228     parser = argparse.ArgumentParser()
229     rules = shlex.split(rule)
230     rules.pop(0)
231     parser.add_argument("--biospart", dest="biospart", action="store")
232     parser.add_argument("--partition", dest="partition", action="store")
233     parser.add_argument("--dir", dest="dir", action="store")
234     args = clean_args(vars(parser.parse_args(rules)))
235     parser = None
236     return args
237 def parse_ignoredisk(rule):
238     parser = argparse.ArgumentParser()
239     rules = shlex.split(rule)
240     rules.pop(0)
241     parser.add_argument("--drives", dest="drives", action="store")
242     parser.add_argument("--only-use", dest="only-use", action="store")
243     parser.add_argument("--interactive", dest="interactive", action="store_true")
244     args = clean_args(vars(parser.parse_args(rules)))
245     parser = None
246     return args
247 def parse_iscsi(rule):
248     parser = argparse.ArgumentParser()
249     rules = shlex.split(rule)
250     rules.pop(0)
251     parser.add_argument("--ipaddr", dest="ipaddr", action="store")
252     parser.add_argument("--port", dest="port", action="store")
253     parser.add_argument("--target", dest="target", action="store")
254     parser.add_argument("--iface", dest="iface", action="store")
255     parser.add_argument("--user", dest="user", action="store")
256     parser.add_argument("--password", dest="password", action="store")
257     parser.add_argument("--reverse-user", dest="reverse-user", action="store")
258     parser.add_argument("--reverse-password", dest="reverse-password", action="store")
259     args = clean_args(vars(parser.parse_args(rules)))
260     parser = None
261     return args
262 def parse_iscsiname(rule):
263     parser = argparse.ArgumentParser()
264     rules = shlex.split(rule)
265     rules.pop(0)
266     args = clean_args(vars(parser.parse_args(rules)))
267     parser = None
268     return args
269 def parse_keyboard(rule):
270     parser = argparse.ArgumentParser()
271     rules = shlex.split(rule)
272     rules.pop(0)
273     parser.add_argument("--vckeymap", dest="vckeymap", action="store")
274     parser.add_argument("--xlayouts", dest="xlayouts", action="store")
275     parser.add_argument("--switch", dest="switch", action="store")
276     parser.add_argument("keyboard")
277     args = clean_args(vars(parser.parse_args(rules)))
278     if "keyboard" in args and "xlayouts" not in args:
279         args["xlayouts"] = args["keyboard"]
280     parser = None
281     return args
282 def parse_lang(rule):
283     parser = argparse.ArgumentParser()
284     rules = shlex.split(rule)
285     rules.pop(0)
286     parser.add_argument("lang")
287 <a name="2"></a>
288     args = clean_args(vars(parser.parse_args(rules)))
289     parser = None
290     r<font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>eturn args
291 def parse_logvol(rule):
292     parser = argparse.ArgumentParser()
293     rules = shlex.split(rule)
294     rules.pop(0)
295     parser.add_argument("mntpoint")
296     parser.add_argument(</b></font>"--noformat", dest="noformat", action="store_true")
297     parser.add_argument("--useexisting", dest="useexisting", action="store_true")
298     parser.add_argument("--fstype", dest="fstype", action="store")
299     parser.add_argument("--fsoptions", dest="fsoptions", action="store")
300     parser.add_argument("--grow", dest="grow", action="store_true")
301     parser.add_argument("--maxsize", dest="maxsize", action="store")
302     parser.add_argument("--recommended", dest="recommended", action="store_true")
303     parser.add_argument("--percent", dest="percent", action="store_true")
304     parser.add_argument("--encrypted", dest="encrypted", action="store_true")
305     parser.add_argument("--passphrase", dest="passphrase", action="store")
306     parser.add_argument("--escrowcert", dest="escrowcert", action="store")
307     parser.add_argument(
308         "--backuppassphrase", dest="backuppassphrase", action="store_true"
309     )
310     parser.add_argument("--name", dest="name", action="store")
311     parser.add_argument("--vgname", dest="vgname", action="store")
312     parser.add_argument("--size", dest="size", action="store")
313     parser.add_argument("--label", dest="label", action="store")
314     args = clean_args(vars(parser.parse_args(rules)))
315     parser = None
316     return args
317 def parse_logging(rule):
318     parser = argparse.ArgumentParser()
319     rules = shlex.split(rule)
320     rules.pop(0)
321     parser.add_argument("--host", dest="host", action="store")
322     parser.add_argument("--port", dest="port", action="store")
323     parser.add_argument(
324         "--level",
325         dest="level",
326         action="store",
327         choices=["debug", "info", "warning", "error", "critical"],
328     )
329     args = clean_args(vars(parser.parse_args(rules)))
330     parser = None
331     return args
332 def parse_monitor(rule):
333     parser = argparse.ArgumentParser()
334     rules = shlex.split(rule)
335     rules.pop(0)
336     parser.add_argument("--hsync", dest="hsync", action="store")
337     parser.add_argument("--monitor", dest="monitor", action="store")
338     parser.add_argument("--noprobe", dest="noprobe", action="store_true")
339     parser.add_argument("--vsync", dest="vsync", action="store")
340     args = clean_args(vars(parser.parse_args(rules)))
341     parser = None
342     return args
343 def parse_multipath(rule):
344     parser = argparse.ArgumentParser()
345     rules = shlex.split(rule)
346     rules.pop(0)
347     parser.add_argument("--name", dest="name", action="store")
348     parser.add_argument("--device", dest="device", action="store")
349     parser.add_argument("--rule", dest="rule", action="store")
350     args = clean_args(vars(parser.parse_args(rules)))
351     parser = None
352     return args
353 def parse_network(rule):
354     parser = argparse.ArgumentParser()
355     rules = shlex.split(rule)
356     rules.pop(0)
357     parser.add_argument(
358         "--bootproto",
359         dest="bootproto",
360         action="store",
361         choices=["dhcp", "bootp", "static", "ibft"],
362     )
363     parser.add_argument("--device", dest="device", action="store")
364     parser.add_argument("--ip", dest="ip", action="store")
365     parser.add_argument("--ipv6", dest="ipv6", action="store")
366     parser.add_argument("--gateway", dest="gateway", action="store")
367     parser.add_argument("--nodefroute", dest="nodefroute", action="store_true")
368     parser.add_argument("--nameserver", dest="nameserver", action="store")
369     parser.add_argument("--nodns", dest="nodns", action="store_true")
370     parser.add_argument("--netmask", dest="netmask", action="store")
371     parser.add_argument("--hostname", dest="hostname", action="store")
372     parser.add_argument("--ethtool", dest="ethtool", action="store")
373     parser.add_argument("--essid", dest="essid", action="store")
374     parser.add_argument("--wepkey", dest="wepkey", action="store")
375     parser.add_argument("--wpakey", dest="wpakey", action="store")
376     parser.add_argument("--onboot", dest="onboot", action="store")
377     parser.add_argument("--dhcpclass", dest="dhcpclass", action="store")
378     parser.add_argument("--mtu", dest="mtu", action="store")
379     parser.add_argument("--noipv4", dest="noipv4", action="store_true")
380     parser.add_argument("--noipv6", dest="noipv6", action="store_true")
381     parser.add_argument("--activate", dest="activate", action="store_true")
382     args = clean_args(vars(parser.parse_args(rules)))
383     parser = None
384     return args
385 def parse_nfs(rule):
386     parser = argparse.ArgumentParser()
387     rules = shlex.split(rule)
388     rules.pop(0)
389     parser.add_argument("--server", dest="server", action="store")
390     parser.add_argument("--dir", dest="dir", action="store")
391     parser.add_argument("--opts", dest="opts", action="store")
392 <a name="1"></a>
393     args = clean_args(vars(parser.parse_args(rules)))
394     parser = None
395     r<font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>eturn args
396 def parse_partition(rule):
397     parser = argparse.ArgumentParser()
398     rules = shlex.split(rule)
399     rules.pop(0)
400     parser.add_argument("mntpoint")
401     parser.add_argument(</b></font>"--size", dest="size", action="store")
402     parser.add_argument("--grow", dest="grow", action="store_true")
403     parser.add_argument("--maxsize", dest="maxsize", action="store")
404     parser.add_argument("--noformat", dest="noformat", action="store_true")
405     parser.add_argument("--onpart", "--usepart", dest="onpart", action="store")
406     parser.add_argument("--ondisk", "--ondrive", dest="ondisk", action="store")
407     parser.add_argument("--asprimary", dest="asprimary", action="store_true")
408     parser.add_argument("--fsprofile", dest="fsprofile", action="store")
409     parser.add_argument("--fstype", dest="fstype", action="store")
410     parser.add_argument("--fsoptions", dest="fsoptions", action="store")
411     parser.add_argument("--label", dest="label", action="store")
412     parser.add_argument("--recommended", dest="recommended", action="store_true")
413     parser.add_argument("--onbiosdisk", dest="onbiosdisk", action="store")
414     parser.add_argument("--encrypted", dest="encrypted", action="store_true")
415     parser.add_argument("--passphrase", dest="passphrase", action="store")
416     parser.add_argument("--escrowcert", dest="escrowcert", action="store")
417     parser.add_argument("--backupphrase", dest="backupphrase", action="store")
418     args = clean_args(vars(parser.parse_args(rules)))
419     parser = None
420     return args
421 def parse_raid(rule):
422     parser = argparse.ArgumentParser()
423     rules = shlex.split(rule)
424     rules.pop(0)
425     partitions = []
426     newrules = []
427     for count, rule in enumerate(rules):
428         if count == 0:
429             newrules.append(rule)
430             continue
431         elif rule.startswith("--"):
432             newrules.append(rule)
433             continue
434         else:
435             partitions.append(rule)
436     rules = newrules
437     parser.add_argument("mntpoint")
438     parser.add_argument("--level", dest="level", action="store")
439     parser.add_argument("--device", dest="device", action="store")
440     parser.add_argument("--spares", dest="spares", action="store")
441     parser.add_argument("--fstype", dest="fstype", action="store")
442     parser.add_argument("--fsoptions", dest="fsoptions", action="store")
443     parser.add_argument("--label", dest="label", action="store")
444     parser.add_argument("--noformat", dest="noformat", action="store_true")
445     parser.add_argument("--useexisting", dest="useexisting", action="store_true")
446     parser.add_argument("--encrypted", dest="encrypted", action="store_true")
447     parser.add_argument("--passphrase", dest="passphrase", action="store")
448     parser.add_argument("--escrowcert", dest="escrowcert", action="store")
449     parser.add_argument("--backuppassphrase", dest="backuppassphrase", action="store")
450     args = clean_args(vars(parser.parse_args(rules)))
451     if partitions:
452         args["partitions"] = partitions
453     parser = None
454     return args
455 def parse_reboot(rule):
456     parser = argparse.ArgumentParser()
457     rules = shlex.split(rule)
458     rules.pop(0)
459     parser.add_argument("--eject", dest="eject", action="store_true")
460     args = clean_args(vars(parser.parse_args(rules)))
461     parser = None
462     return args
463 def parse_repo(rule):
464     parser = argparse.ArgumentParser()
465     rules = shlex.split(rule)
466     rules.pop(0)
467     parser.add_argument("--name", dest="name", action="store")
468     parser.add_argument("--baseurl", dest="baseurl", action="store")
469     parser.add_argument("--mirrorlist", dest="mirrorlist", action="store")
470     parser.add_argument("--cost", dest="cost", action="store")
471     parser.add_argument("--excludepkgs", dest="excludepkgs", action="store")
472     parser.add_argument("--includepkgs", dest="includepkgs", action="store")
473     parser.add_argument("--proxy", dest="proxy", action="store")
474     parser.add_argument("--ignoregroups", dest="ignoregroups", action="store")
475     parser.add_argument("--noverifyssl", dest="noverifyssl", action="store_true")
476     args = clean_args(vars(parser.parse_args(rules)))
477     parser = None
478     return args
479 def parse_rescue(rule):
480     parser = argparse.ArgumentParser()
481     rules = shlex.split(rule)
482     rules.pop(0)
483     parser.add_argument("--nomount", dest="nomount", action="store_true")
484     parser.add_argument("--romount", dest="romount", action="store_true")
485     args = clean_args(vars(parser.parse_args(rules)))
486     parser = None
487     return args
488 def parse_rootpw(rule):
489     parser = argparse.ArgumentParser()
490     rules = shlex.split(rule)
491     rules.pop(0)
492     parser.add_argument("--iscrypted", dest="iscrypted", action="store_true")
493     parser.add_argument("--plaintext", dest="plaintext", action="store_true")
494     parser.add_argument("--lock", dest="lock", action="store_true")
495     parser.add_argument("password")
496     args = clean_args(vars(parser.parse_args(rules)))
497     parser = None
498     return args
499 def parse_selinux(rule):
500     parser = argparse.ArgumentParser()
501     rules = shlex.split(rule)
502     rules.pop(0)
503     parser.add_argument("--disabled", dest="disabled", action="store_true")
504     parser.add_argument("--enforcing", dest="enforcing", action="store_true")
505     parser.add_argument("--permissive", dest="permissive", action="store_true")
506     args = clean_args(vars(parser.parse_args(rules)))
507     parser = None
508     return args
509 def parse_services(rule):
510     parser = argparse.ArgumentParser()
511     rules = shlex.split(rule)
512     rules.pop(0)
513     parser.add_argument("--disabled", dest="disabled", action="store")
514     parser.add_argument("--enabled", dest="enabled", action="store")
515     args = clean_args(vars(parser.parse_args(rules)))
516     parser = None
517     return args
518 def parse_sshpw(rule):
519     parser = argparse.ArgumentParser()
520     rules = shlex.split(rule)
521     rules.pop(0)
522     parser.add_argument("--username", dest="username", action="store")
523     parser.add_argument("--iscrypted", dest="iscrypted", action="store_true")
524     parser.add_argument("--plaintext", dest="plaintext", action="store_true")
525     parser.add_argument("--lock", dest="lock", action="store_true")
526     args = clean_args(vars(parser.parse_args(rules)))
527     parser = None
528     return args
529 def parse_timezone(rule):
530     parser = argparse.ArgumentParser()
531     rules = shlex.split(rule)
532     rules.pop(0)
533     parser.add_argument("--utc", dest="utc", action="store_true")
534     parser.add_argument("--nontp", dest="nontp", action="store_true")
535     parser.add_argument("--ntpservers", dest="ntpservers", action="store")
536     parser.add_argument("--isUtc", dest="isutc", action="store_true")
537     parser.add_argument("timezone")
538     args = clean_args(vars(parser.parse_args(rules)))
539     parser = None
540     return args
541 def parse_updates(rule):
542     return {"url": rules<font color="#151b8d"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>[0]} if rules else True
543 def parse_upgrade(rule):
544     parser = argparse.ArgumentParser()
545     rules = shlex.split(rule)
546     rules.pop(0)
547     parser.add_argument(</b></font>"--root-device", dest="root-device", action="store")
548     args = clean_args(vars(parser.parse_args(rules)))
549     parser = None
550     if args:
551         return args
552     return True
553 def parse_url(rule):
554     parser = argparse.ArgumentParser()
555     rules = shlex.split(rule)
556     rules.pop(0)
557     parser.add_argument("--url", dest="url", action="store")
558     parser.add_argument("--proxy", dest="proxy", action="store")
559     parser.add_argument("--noverifyssl", dest="noverifyssl", action="store_true")
560     args = clean_args(vars(parser.parse_args(rules)))
561     parser = None
562     return args
563 def parse_user(rule):
564     parser = argparse.ArgumentParser()
565     rules = shlex.split(rule)
566     rules.pop(0)
567     parser.add_argument("--name", dest="name", action="store")
568     parser.add_argument("--gecos", dest="gecos", action="store")
569     parser.add_argument("--groups", dest="groups", action="store")
570     parser.add_argument("--homedir", dest="homedir", action="store")
571     parser.add_argument("--lock", dest="lock", action="store_true")
572     parser.add_argument("--password", dest="password", action="store")
573     parser.add_argument("--iscrypted", dest="iscrypted", action="store_true")
574     parser.add_argument("--plaintext", dest="plaintext", action="store_true")
575     parser.add_argument("--shell", dest="shell", action="store")
576     parser.add_argument("--uid", dest="uid", action="store")
577     args = clean_args(vars(parser.parse_args(rules)))
578     parser = None
579     return args
580 def parse_vnc(rule):
581     parser = argparse.ArgumentParser()
582     rules = shlex.split(rule)
583     rules.pop(0)
584     parser.add_argument("--host", dest="host", action="store")
585     parser.add_argument("--port", dest="port", action="store")
586     parser.add_argument("--password", dest="password", action="store")
587     args = clean_args(vars(parser.parse_args(rules)))
588     parser = None
589     return args
590 def parse_volgroup(rule):
591     parser = argparse.ArgumentParser()
592     rules = shlex.split(rule)
593     rules.pop(0)
594     partitions = []
595     newrules = []
596     for count, rule in enumerate(rules):
597         if count == 0:
598             newrules.append(rule)
599             continue
600         elif rule.startswith("--"):
601             newrules.append(rule)
602             continue
603         else:
604             partitions.append(rule)
605     rules = newrules
606     parser.add_argument("name")
607     parser.add_argument("--noformat", dest="noformat", action="store_true")
608     parser.add_argument("--useexisting", dest="useexisting", action="store_true")
609     parser.add_argument("--pesize", dest="pesize", action="store")
610     parser.add_argument("--reserved-space", dest="reserved-space", action="store")
611     parser.add_argument("--reserved-percent", dest="reserved-percent", action="store")
612     args = clean_args(vars(parser.parse_args(rules)))
613     if partitions:
614         args["partitions"] = partitions
615     parser = None
616     return args
617 def parse_xconfig(rule):
618     parser = argparse.ArgumentParser()
619     rules = shlex.split(rule)
620     rules.pop(0)
621     parser.add_argument("--defaultdesktop", dest="defaultdesktop", action="store")
622     parser.add_argument("--startxonboot", dest="startxonboot", action="store_true")
623     args = clean_args(vars(parser.parse_args(rules)))
624     parser = None
625     return args
626 def parse_zfcp(rule):
627     parser = argparse.ArgumentParser()
628     rules = shlex.split(rule)
629     rules.pop(0)
630     parser.add_argument("--devnum", dest="devnum", action="store")
631     parser.add_argument("--fcplun", dest="fcplun", action="store")
632     parser.add_argument("--wwpn", dest="wwpn", action="store")
633     args = clean_args(vars(parser.parse_args(rules)))
634     parser = None
635     return args
636 def mksls(src, dst=None):
637     mode = "command"
638     sls = {}
639     ks_opts = {}
640     with salt.utils.files.fopen(src, "r") as fh_:
641         for line in fh_:
642             if line.startswith("#"):
643                 continue
644             if mode == "command":
645                 if line.startswith("auth ") or line.startswith("authconfig "):
646                     ks_opts["auth"] = parse_auth(line)
647                 elif line.startswith("autopart"):
648                     ks_opts["autopath"] = parse_autopart(line)
649                 elif line.startswith("autostep"):
650                     ks_opts["autostep"] = parse_autostep(line)
651                 elif line.startswith("bootloader"):
652                     ks_opts["bootloader"] = parse_bootloader(line)
653                 elif line.startswith("btrfs"):
654                     ks_opts["btrfs"] = parse_btrfs(line)
655                 elif line.startswith("cdrom"):
656                     ks_opts["cdrom"] = True
657                 elif line.startswith("clearpart"):
658                     ks_opts["clearpart"] = parse_clearpart(line)
659                 elif line.startswith("cmdline"):
660                     ks_opts["cmdline"] = True
661                 elif line.startswith("device"):
662                     ks_opts["device"] = parse_device(line)
663                 elif line.startswith("dmraid"):
664                     ks_opts["dmraid"] = parse_dmraid(line)
665                 elif line.startswith("driverdisk"):
666                     ks_opts["driverdisk"] = parse_driverdisk(line)
667                 elif line.startswith("firewall"):
668                     ks_opts["firewall"] = parse_firewall(line)
669                 elif line.startswith("firstboot"):
670 <a name="0"></a>                    ks_opts["firstboot"] = parse_firstboot(line)
671                 elif line.startswith("group"):
672                     ks_opts["group"] = parse_group(line)
673                 elif line<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.startswith("graphical"):
674                     ks_opts["graphical"] = True
675                 elif line.startswith("halt"):
676                     ks_opts["halt"] = True
677                 elif line.startswith("harddrive"):
678                     ks_opts["harddrive"] = True
679                 elif line.startswith("ignoredisk"):
680                     ks_opts["ignoredisk"] =</b></font> parse_ignoredisk(line)
681                 elif line.startswith("install"):
682                     ks_opts["install"] = True
683                 elif line.startswith("iscsi"):
684                     ks_opts["iscsi"] = parse_iscsi(line)
685                 elif line.startswith("iscsiname"):
686                     ks_opts["iscsiname"] = parse_iscsiname(line)
687                 elif line.startswith("keyboard"):
688                     ks_opts["keyboard"] = parse_keyboard(line)
689                 elif line.startswith("lang"):
690                     ks_opts["lang"] = parse_lang(line)
691                 elif line.startswith("logvol"):
692                     if "logvol" not in ks_opts:
693                         ks_opts["logvol"] = []
694                     ks_opts["logvol"].append(parse_logvol(line))
695                 elif line.startswith("logging"):
696                     ks_opts["logging"] = parse_logging(line)
697                 elif line.startswith("mediacheck"):
698                     ks_opts["mediacheck"] = True
699                 elif line.startswith("monitor"):
700                     ks_opts["monitor"] = parse_monitor(line)
701                 elif line.startswith("multipath"):
702                     ks_opts["multipath"] = parse_multipath(line)
703                 elif line.startswith("network"):
704                     if "network" not in ks_opts:
705                         ks_opts["network"] = []
706                     ks_opts["network"].append(parse_network(line))
707                 elif line.startswith("nfs"):
708                     ks_opts["nfs"] = True
709                 elif line.startswith("part ") or line.startswith("partition"):
710                     if "part" not in ks_opts:
711                         ks_opts["part"] = []
712                     ks_opts["part"].append(parse_partition(line))
713                 elif line.startswith("poweroff"):
714                     ks_opts["poweroff"] = True
715                 elif line.startswith("raid"):
716                     if "raid" not in ks_opts:
717                         ks_opts["raid"] = []
718                     ks_opts["raid"].append(parse_raid(line))
719                 elif line.startswith("reboot"):
720                     ks_opts["reboot"] = parse_reboot(line)
721                 elif line.startswith("repo"):
722                     ks_opts["repo"] = parse_repo(line)
723                 elif line.startswith("rescue"):
724                     ks_opts["rescue"] = parse_rescue(line)
725                 elif line.startswith("rootpw"):
726                     ks_opts["rootpw"] = parse_rootpw(line)
727                 elif line.startswith("selinux"):
728                     ks_opts["selinux"] = parse_selinux(line)
729                 elif line.startswith("services"):
730                     ks_opts["services"] = parse_services(line)
731                 elif line.startswith("shutdown"):
732 <a name="6"></a>                    ks_opts["shutdown"] = True
733                 elif line.startswith("sshpw"):
734                     ks_opts["sshpw"] = parse_sshpw(line)
735                 elif line<font color="#8c8774"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.startswith("skipx"):
736                     ks_opts["skipx"] = True
737                 elif line.startswith("text"):
738                     ks_opts["text"] = True
739                 elif line.startswith("timezone"):
740                     ks_opts["timezone"] =</b></font> parse_timezone(line)
741                 elif line.startswith("updates"):
742                     ks_opts["updates"] = parse_updates(line)
743                 elif line.startswith("upgrade"):
744                     ks_opts["upgrade"] = parse_upgrade(line)
745                 elif line.startswith("url"):
746                     ks_opts["url"] = True
747                 elif line.startswith("user"):
748                     ks_opts["user"] = parse_user(line)
749                 elif line.startswith("vnc"):
750                     ks_opts["vnc"] = parse_vnc(line)
751                 elif line.startswith("volgroup"):
752                     ks_opts["volgroup"] = parse_volgroup(line)
753                 elif line.startswith("xconfig"):
754                     ks_opts["xconfig"] = parse_xconfig(line)
755                 elif line.startswith("zerombr"):
756                     ks_opts["zerombr"] = True
757                 elif line.startswith("zfcp"):
758                     ks_opts["zfcp"] = parse_zfcp(line)
759             if line.startswith("%include"):
760                 rules = shlex.split(line)
761                 if not ks_opts["include"]:
762                     ks_opts["include"] = []
763                 ks_opts["include"].append(rules[1])
764             if line.startswith("%ksappend"):
765                 rules = shlex.split(line)
766                 if not ks_opts["ksappend"]:
767                     ks_opts["ksappend"] = []
768                 ks_opts["ksappend"].append(rules[1])
769             if line.startswith("%packages"):
770                 mode = "packages"
771                 if "packages" not in ks_opts:
772                     ks_opts["packages"] = {"packages": {}}
773                 parser = argparse.ArgumentParser()
774                 opts = shlex.split(line)
775                 opts.pop(0)
776                 parser.add_argument("--default", dest="default", action="store_true")
777                 parser.add_argument(
778                     "--excludedocs", dest="excludedocs", action="store_true"
779                 )
780                 parser.add_argument(
781                     "--ignoremissing", dest="ignoremissing", action="store_true"
782                 )
783                 parser.add_argument("--instLangs", dest="instLangs", action="store")
784                 parser.add_argument("--multilib", dest="multilib", action="store_true")
785                 parser.add_argument(
786                     "--nodefaults", dest="nodefaults", action="store_true"
787                 )
788                 parser.add_argument("--optional", dest="optional", action="store_true")
789                 parser.add_argument("--nobase", dest="nobase", action="store_true")
790                 args = clean_args(vars(parser.parse_args(opts)))
791                 ks_opts["packages"]["options"] = args
792 <a name="4"></a>
793                 continue
794             if line<font color="#6cc417"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.startswith("%pre"):
795                 mode = "pre"
796                 parser = argparse.ArgumentParser()
797                 opts = shlex.split(line)
798                 opts.pop(0)
799                 parser.add_argument(</b></font>"--interpreter", dest="interpreter", action="store")
800                 parser.add_argument(
801                     "--erroronfail", dest="erroronfail", action="store_true"
802                 )
803                 parser.add_argument("--log", dest="log", action="store")
804                 args = clean_args(vars(parser.parse_args(opts)))
805                 ks_opts["pre"] = {"options": args, "script": ""}
806                 continue
807             if line.startswith("%post"):
808                 mode = "post"
809                 parser = argparse.ArgumentParser()
810                 opts = shlex.split(line)
811                 opts.pop(0)
812                 parser.add_argument("--nochroot", dest="nochroot", action="store_true")
813                 parser.add_argument("--interpreter", dest="interpreter", action="store")
814                 parser.add_argument(
815                     "--erroronfail", dest="erroronfail", action="store_true"
816                 )
817                 parser.add_argument("--log", dest="log", action="store")
818                 args = clean_args(vars(parser.parse_args(opts)))
819                 ks_opts["post"] = {"options": args, "script": ""}
820                 continue
821             if line.startswith("%end"):
822                 mode = None
823             if mode == "packages":
824                 if line.startswith("-"):
825                     package = line.replace("-", "", 1).strip()
826                     ks_opts["packages"]["packages"][package] = False
827                 else:
828                     ks_opts["packages"]["packages"][line.strip()] = True
829             if mode == "pre":
830                 ks_opts["pre"]["script"] += line
831             if mode == "post":
832 <a name="3"></a>                ks_opts["post"]["script"] += line
833     sls<font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>[ks_opts["lang"]["lang"]] = {"locale": ["system"]}
834     sls[ks_opts["keyboard"]["xlayouts"]] = {"keyboard": ["system"]}
835     sls[ks_opts["timezone"][</b></font>"timezone"]] = {"timezone": ["system"]}
836     if "utc" in ks_opts["timezone"]:
837         sls[ks_opts["timezone"]["timezone"]]["timezone"].append("utc")
838     if "network" in ks_opts:
839         for interface in ks_opts["network"]:
840             device = interface.get("device", None)
841             if device is not None:
842                 del interface["device"]
843                 sls[device] = {"proto": interface["bootproto"]}
844                 del interface["bootproto"]
845                 if "onboot" in interface:
846                     if "no" in interface["onboot"]:
847                         sls[device]["enabled"] = False
848                     else:
849                         sls[device]["enabled"] = True
850                     del interface["onboot"]
851                 if "noipv4" in interface:
852                     sls[device]["ipv4"] = {"enabled": False}
853                     del interface["noipv4"]
854                 if "noipv6" in interface:
855                     sls[device]["ipv6"] = {"enabled": False}
856                     del interface["noipv6"]
857                 for option in interface:
858                     if type(interface[option]) is bool:
859                         sls[device][option] = {"enabled": [interface[option]]}
860                     else:
861                         sls[device][option] = interface[option]
862             if "hostname" in interface:
863                 sls["system"] = {
864                     "network.system": {
865                         "enabled": True,
866                         "hostname": interface["hostname"],
867                         "apply_hostname": True,
868                     }
869                 }
870     if "selinux" in ks_opts:
871         for mode in ks_opts["selinux"]:
872             sls[mode] = {"selinux": ["mode"]}
873     if "nobase" not in ks_opts["packages"]["options"]:
874         sls["base"] = {"pkg_group": ["installed"]}
875     packages = ks_opts["packages"]["packages"]
876     for package in packages:
877         if not packages[package]:
878             continue
879         if package and packages[package] is True:
880             if package.startswith("@"):
881                 pkg_group = package.replace("@", "", 1)
882                 sls[pkg_group] = {"pkg_group": ["installed"]}
883             else:
884                 sls[package] = {"pkg": ["installed"]}
885         elif packages[package] is False:
886             sls[package] = {"pkg": ["absent"]}
887     if dst:
888         with salt.utils.files.fopen(dst, "w") as fp_:
889             salt.utils.yaml.safe_dump(sls, fp_, default_flow_style=False)
890     else:
891         return salt.utils.yaml.safe_dump(sls, default_flow_style=False)
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_ipaddress.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import contextlib
2 import functools
3 import operator
4 import pickle
5 import re
6 import sys
7 import weakref
8 import pytest
9 from salt._compat import ipaddress
10 from tests.support.unit import TestCase, skipIf
11 @functools.total_ordering
12 class _LARGEST:
13     def __eq__(self, other):
14         return isinstance(other, _LARGEST)
15     def __lt__(self, other):
16         return False
17 LARGEST = _LARGEST()
18 @functools.total_ordering
19 class _SMALLEST:
20     def __eq__(self, other):
21         return isinstance(other, _SMALLEST)
22     def __gt__(self, other):
23         return False
24 SMALLEST = _SMALLEST()
25 class BaseTestCase(TestCase):
26     @property
27     def factory(self):
28         raise NotImplementedError
29     @contextlib.contextmanager
30     def assertCleanError(self, exc_type, details, *args):
31         if args:
32             details = details % args
33         cm = self.assertRaisesRegex(exc_type, details)
34         with cm as exc:
35             yield exc
36         if exc.exception.__context__ is not None:
37             self.assertTrue(exc.exception.__suppress_context__)
38     def assertAddressError(self, details, *args):
39         return self.assertCleanError(ipaddress.AddressValueError, details, *args)
40     def assertNetmaskError(self, details, *args):
41         return self.assertCleanError(ipaddress.NetmaskValueError, details, *args)
42     def assertInstancesEqual(self, lhs, rhs):
43         self.assertEqual(self.factory(lhs), self.factory(rhs))
44 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
45 class CommonTestMixin:
46     def test_empty_address(self):
47         with self.assertAddressError("Address cannot be empty"):
48             self.factory("")
49     def test_floats_rejected(self):
50         with self.assertAddressError(re.escape(repr("1.0"))):
51             self.factory(1.0)
52     def test_not_an_index_issue15559(self):
53         self.assertRaises(TypeError, operator.index, self.factory(1))
54         self.assertRaises(TypeError, hex, self.factory(1))
55         self.assertRaises(TypeError, bytes, self.factory(1))
56 <a name="4"></a>
57     def pickle_test(self, addr):
58         for proto in range(pickle.HIGHEST_PROTOCOL + 1):
59             with self<font color="#6cc417"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.subTest(proto=proto):
60                 x = self.factory(addr)
61                 y = pickle.loads(pickle.dumps(x, proto))
62                 self.assertEqual(</b></font>y, x)
63 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
64 class CommonTestMixin_v4(CommonTestMixin):
65     def test_leading_zeros(self):
66         msg = r"Leading zeros are not permitted in '\d+'"
67         addresses = [
68             "000.000.000.000",
69             "192.168.000.001",
70             "016.016.016.016",
71             "192.168.000.001",
72             "001.000.008.016",
73             "01.2.3.40",
74             "1.02.3.40",
75             "1.2.03.40",
76             "1.2.3.040",
77         ]
78         for address in addresses:
79             with self.subTest(address=address):
80                 with self.assertAddressError(msg):
81                     self.factory(address)
82     def test_int(self):
83         self.assertInstancesEqual(0, "0.0.0.0")
84         self.assertInstancesEqual(3232235521, "192.168.0.1")
85     def test_packed(self):
86         self.assertInstancesEqual(bytes.fromhex("00000000"), "0.0.0.0")
87         self.assertInstancesEqual(bytes.fromhex("c0a80001"), "192.168.0.1")
88     def test_negative_ints_rejected(self):
89         msg = "-1 (&lt; 0) is not permitted as an IPv4 address"
90         with self.assertAddressError(re.escape(msg)):
91             self.factory(-1)
92     def test_large_ints_rejected(self):
93         msg = "%d (&gt;= 2**32) is not permitted as an IPv4 address"
94         with self.assertAddressError(re.escape(msg % 2 ** 32)):
95             self.factory(2 ** 32)
96     def test_bad_packed_length(self):
97         def assertBadLength(length):
98             addr = b"\0" * length
99             msg = "%r (len %d != 4) is not permitted as an IPv4 address"
100             with self.assertAddressError(re.escape(msg % (addr, length))):
101                 self.factory(addr)
102         assertBadLength(3)
103         assertBadLength(5)
104 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
105 class CommonTestMixin_v6(CommonTestMixin):
106     def test_leading_zeros(self):
107         self.assertInstancesEqual("0000::0000", "::")
108         self.assertInstancesEqual("000::c0a8:0001", "::c0a8:1")
109     def test_int(self):
110         self.assertInstancesEqual(0, "::")
111         self.assertInstancesEqual(3232235521, "::c0a8:1")
112 <a name="7"></a>
113     def test_packed(self):
114         addr = b"\0" * 12 + bytes.fromhex("00000000")
115         self<font color="#38a4a5"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.assertInstancesEqual(addr, "::")
116         addr = b"\0" * 12 + bytes.fromhex("c0a80001")
117         self.assertInstancesEqual(addr, "::c0a8:1")
118         addr = bytes.fromhex("c0a80001") + b"\0" * 12
119         self.assertInstancesEqual(</b></font>addr, "c0a8:1::")
120     def test_negative_ints_rejected(self):
121         msg = "-1 (&lt; 0) is not permitted as an IPv6 address"
122         with self.assertAddressError(re.escape(msg)):
123             self.factory(-1)
124     def test_large_ints_rejected(self):
125         msg = "%d (&gt;= 2**128) is not permitted as an IPv6 address"
126         with self.assertAddressError(re.escape(msg % 2 ** 128)):
127             self.factory(2 ** 128)
128     def test_bad_packed_length(self):
129         def assertBadLength(length):
130             addr = b"\0" * length
131             msg = "%r (len %d != 16) is not permitted as an IPv6 address"
132             with self.assertAddressError(re.escape(msg % (addr, length))):
133                 self.factory(addr)
134                 self.factory(addr)
135         assertBadLength(15)
136         assertBadLength(17)
137     def test_blank_scope_id(self):
138         address = "::1%"
139         with self.assertAddressError('Invalid IPv6 address: "%r"', address):
140             self.factory(address)
141     def test_invalid_scope_id_with_percent(self):
142         address = "::1%scope%"
143         with self.assertAddressError('Invalid IPv6 address: "%r"', address):
144             self.factory(address)
145 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
146 class AddressTestCase_v4(BaseTestCase, CommonTestMixin_v4):
147     factory = ipaddress.IPv4Address
148     @pytest.mark.skipif(sys.version_info &lt; (3, 6), reason="Don't run on Py3.5")
149     def test_format(self):
150         v4 = ipaddress.IPv4Address("1.2.3.42")
151         v4_pairs = [
152             ("b", "00000001000000100000001100101010"),
153             ("n", "00000001000000100000001100101010"),
154             ("x", "0102032a"),
155             ("X", "0102032A"),
156             ("_b", "0000_0001_0000_0010_0000_0011_0010_1010"),
157             ("_n", "0000_0001_0000_0010_0000_0011_0010_1010"),
158             ("_x", "0102_032a"),
159             ("_X", "0102_032A"),
160             ("#b", "0b00000001000000100000001100101010"),
161             ("#n", "0b00000001000000100000001100101010"),
162             ("#x", "0x0102032a"),
163             ("#X", "0X0102032A"),
164             ("#_b", "0b0000_0001_0000_0010_0000_0011_0010_1010"),
165             ("#_n", "0b0000_0001_0000_0010_0000_0011_0010_1010"),
166             ("#_x", "0x0102_032a"),
167             ("#_X", "0X0102_032A"),
168             ("s", "1.2.3.42"),
169             ("", "1.2.3.42"),
170         ]
171         for (fmt, txt) in v4_pairs:
172             self.assertEqual(txt, format(v4, fmt))
173     def test_network_passed_as_address(self):
174         addr = "127.0.0.1/24"
175         with self.assertAddressError("Unexpected '/' in %r", addr):
176             ipaddress.IPv4Address(addr)
177     def test_bad_address_split(self):
178         def assertBadSplit(addr):
179             with self.assertAddressError("Expected 4 octets in %r", addr):
180                 ipaddress.IPv4Address(addr)
181         assertBadSplit("127.0.1")
182         assertBadSplit("42.42.42.42.42")
183         assertBadSplit("42.42.42")
184         assertBadSplit("42.42")
185         assertBadSplit("42")
186         assertBadSplit("42..42.42.42")
187         assertBadSplit("42.42.42.42.")
188         assertBadSplit("42.42.42.42...")
189         assertBadSplit(".42.42.42.42")
190         assertBadSplit("...42.42.42.42")
191         assertBadSplit("016.016.016")
192         assertBadSplit("016.016")
193         assertBadSplit("016")
194         assertBadSplit("000")
195         assertBadSplit("0x0a.0x0a.0x0a")
196         assertBadSplit("0x0a.0x0a")
197         assertBadSplit("0x0a")
198         assertBadSplit(".")
199         assertBadSplit("bogus")
200         assertBadSplit("bogus.com")
201         assertBadSplit("1000")
202         assertBadSplit("1000000000000000")
203         assertBadSplit("192.168.0.1.com")
204     def test_empty_octet(self):
205         def assertBadOctet(addr):
206             with self.assertAddressError("Empty octet not permitted in %r", addr):
207                 ipaddress.IPv4Address(addr)
208         assertBadOctet("42..42.42")
209         assertBadOctet("...")
210     def test_invalid_characters(self):
211         def assertBadOctet(addr, octet):
212             msg = "Only decimal digits permitted in {!r} in {!r}".format(octet, addr)
213             with self.assertAddressError(re.escape(msg)):
214                 ipaddress.IPv4Address(addr)
215         assertBadOctet("0x0a.0x0a.0x0a.0x0a", "0x0a")
216         assertBadOctet("0xa.0x0a.0x0a.0x0a", "0xa")
217         assertBadOctet("42.42.42.-0", "-0")
218         assertBadOctet("42.42.42.+0", "+0")
219         assertBadOctet("42.42.42.-42", "-42")
220         assertBadOctet("+1.+2.+3.4", "+1")
221         assertBadOctet("1.2.3.4e0", "4e0")
222         assertBadOctet("1.2.3.4::", "4::")
223         assertBadOctet("1.a.2.3", "a")
224     def test_octet_length(self):
225         def assertBadOctet(addr, octet):
226             msg = "At most 3 characters permitted in %r in %r"
227             with self.assertAddressError(re.escape(msg % (octet, addr))):
228                 ipaddress.IPv4Address(addr)
229         assertBadOctet("0000.000.000.000", "0000")
230         assertBadOctet("12345.67899.-54321.-98765", "12345")
231     def test_octet_limit(self):
232         def assertBadOctet(addr, octet):
233             msg = "Octet %d (&gt; 255) not permitted in %r" % (octet, addr)
234             with self.assertAddressError(re.escape(msg)):
235                 ipaddress.IPv4Address(addr)
236         assertBadOctet("257.0.0.0", 257)
237         assertBadOctet("192.168.0.999", 999)
238     def test_pickle(self):
239         self.pickle_test("192.0.2.1")
240     def test_weakref(self):
241         weakref.ref(self.factory("192.0.2.1"))
242 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
243 class AddressTestCase_v6(BaseTestCase, CommonTestMixin_v6):
244     factory = ipaddress.IPv6Address
245     @pytest.mark.skipif(sys.version_info &lt; (3, 6), reason="Don't run on Py3.5")
246     def test_format(self):
247         v6 = ipaddress.IPv6Address("::1.2.3.42")
248         v6_pairs = [
249             (
250                 "b",
251                 "000000000000000000000000000000000000000000000000000000"
252                 "000000000000000000000000000000000000000000000000010000"
253                 "00100000001100101010",
254             ),
255             ("n", "0000000000000000000000000102032a"),
256             ("x", "0000000000000000000000000102032a"),
257             ("X", "0000000000000000000000000102032A"),
258             (
259                 "_b",
260                 "0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000"
261                 "_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000"
262                 "_0000_0000_0000_0000_0001_0000_0010_0000_0011_0010"
263                 "_1010",
264             ),
265             ("_n", "0000_0000_0000_0000_0000_0000_0102_032a"),
266             ("_x", "0000_0000_0000_0000_0000_0000_0102_032a"),
267             ("_X", "0000_0000_0000_0000_0000_0000_0102_032A"),
268             (
269                 "#b",
270                 "0b0000000000000000000000000000000000000000000000000000"
271                 "000000000000000000000000000000000000000000000000000100"
272                 "0000100000001100101010",
273             ),
274             ("#n", "0x0000000000000000000000000102032a"),
275             ("#x", "0x0000000000000000000000000102032a"),
276             ("#X", "0X0000000000000000000000000102032A"),
277             (
278                 "#_b",
279                 "0b0000_0000_0000_0000_0000_0000_0000_0000_0000_0000"
280                 "_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000"
281                 "_0000_0000_0000_0000_0000_0001_0000_0010_0000_0011"
282                 "_0010_1010",
283             ),
284             ("#_n", "0x0000_0000_0000_0000_0000_0000_0102_032a"),
285             ("#_x", "0x0000_0000_0000_0000_0000_0000_0102_032a"),
286             ("#_X", "0X0000_0000_0000_0000_0000_0000_0102_032A"),
287             ("s", "::102:32a"),
288             ("", "::102:32a"),
289         ]
290         for (fmt, txt) in v6_pairs:
291             self.assertEqual(txt, format(v6, fmt))
292     def test_network_passed_as_address(self):
293         def assertBadSplit(addr):
294             msg = "Unexpected '/' in %r"
295             with self.assertAddressError(msg, addr):
296                 ipaddress.IPv6Address(addr)
297         assertBadSplit("::1/24")
298         assertBadSplit("::1%scope_id/24")
299     def test_bad_address_split_v6_not_enough_parts(self):
300         def assertBadSplit(addr):
301             msg = "At least 3 parts expected in %r"
302             with self.assertAddressError(msg, addr.split("%")[0]):
303                 ipaddress.IPv6Address(addr)
304         assertBadSplit(":")
305         assertBadSplit(":1")
306         assertBadSplit("FEDC:9878")
307         assertBadSplit(":%scope")
308         assertBadSplit(":1%scope")
309         assertBadSplit("FEDC:9878%scope")
310     def test_bad_address_split_v6_too_many_colons(self):
311         def assertBadSplit(addr):
312             msg = "At most 8 colons permitted in %r"
313             with self.assertAddressError(msg, addr.split("%")[0]):
314                 ipaddress.IPv6Address(addr)
315         assertBadSplit("9:8:7:6:5:4:3::2:1")
316         assertBadSplit("10:9:8:7:6:5:4:3:2:1")
317         assertBadSplit("::8:7:6:5:4:3:2:1")
318         assertBadSplit("8:7:6:5:4:3:2:1::")
319         assertBadSplit("10:9:8:7:6:5:4:3:42.42.42.42")
320         assertBadSplit("9:8:7:6:5:4:3::2:1%scope")
321         assertBadSplit("10:9:8:7:6:5:4:3:2:1%scope")
322         assertBadSplit("::8:7:6:5:4:3:2:1%scope")
323         assertBadSplit("8:7:6:5:4:3:2:1::%scope")
324         assertBadSplit("10:9:8:7:6:5:4:3:42.42.42.42%scope")
325     def test_bad_address_split_v6_too_many_parts(self):
326         def assertBadSplit(addr):
327             msg = "Exactly 8 parts expected without '::' in %r"
328             with self.assertAddressError(msg, addr.split("%")[0]):
329                 ipaddress.IPv6Address(addr)
330         assertBadSplit("3ffe:0:0:0:0:0:0:0:1")
331         assertBadSplit("9:8:7:6:5:4:3:2:1")
332         assertBadSplit("7:6:5:4:3:2:1")
333         assertBadSplit("9:8:7:6:5:4:3:42.42.42.42")
334         assertBadSplit("7:6:5:4:3:42.42.42.42")
335         assertBadSplit("3ffe:0:0:0:0:0:0:0:1%scope")
336         assertBadSplit("9:8:7:6:5:4:3:2:1%scope")
337         assertBadSplit("7:6:5:4:3:2:1%scope")
338         assertBadSplit("9:8:7:6:5:4:3:42.42.42.42%scope")
339         assertBadSplit("7:6:5:4:3:42.42.42.42%scope")
340     def test_bad_address_split_v6_too_many_parts_with_double_colon(self):
341         def assertBadSplit(addr):
342             msg = "Expected at most 7 other parts with '::' in %r"
343             with self.assertAddressError(msg, addr.split("%")[0]):
344                 ipaddress.IPv6Address(addr)
345         assertBadSplit("1:2:3:4::5:6:7:8")
346         assertBadSplit("1:2:3:4::5:6:7:8%scope")
347     def test_bad_address_split_v6_repeated_double_colon(self):
348         def assertBadSplit(addr):
349             msg = "At most one '::' permitted in %r"
350             with self.assertAddressError(msg, addr.split("%")[0]):
351                 ipaddress.IPv6Address(addr)
352         assertBadSplit("3ffe::1::1")
353         assertBadSplit("1::2::3::4:5")
354         assertBadSplit("2001::db:::1")
355         assertBadSplit("3ffe::1::")
356         assertBadSplit("::3ffe::1")
357         assertBadSplit(":3ffe::1::1")
358         assertBadSplit("3ffe::1::1:")
359         assertBadSplit(":3ffe::1::1:")
360         assertBadSplit(":::")
361         assertBadSplit("2001:db8:::1")
362         assertBadSplit("3ffe::1::1%scope")
363         assertBadSplit("1::2::3::4:5%scope")
364         assertBadSplit("2001::db:::1%scope")
365         assertBadSplit("3ffe::1::%scope")
366         assertBadSplit("::3ffe::1%scope")
367         assertBadSplit(":3ffe::1::1%scope")
368         assertBadSplit("3ffe::1::1:%scope")
369         assertBadSplit(":3ffe::1::1:%scope")
370         assertBadSplit(":::%scope")
371         assertBadSplit("2001:db8:::1%scope")
372     def test_bad_address_split_v6_leading_colon(self):
373         def assertBadSplit(addr):
374             msg = "Leading ':' only permitted as part of '::' in %r"
375             with self.assertAddressError(msg, addr.split("%")[0]):
376                 ipaddress.IPv6Address(addr)
377         assertBadSplit(":2001:db8::1")
378         assertBadSplit(":1:2:3:4:5:6:7")
379         assertBadSplit(":1:2:3:4:5:6:")
380         assertBadSplit(":6:5:4:3:2:1::")
381         assertBadSplit(":2001:db8::1%scope")
382         assertBadSplit(":1:2:3:4:5:6:7%scope")
383         assertBadSplit(":1:2:3:4:5:6:%scope")
384         assertBadSplit(":6:5:4:3:2:1::%scope")
385     def test_bad_address_split_v6_trailing_colon(self):
386         def assertBadSplit(addr):
387             msg = "Trailing ':' only permitted as part of '::' in %r"
388             with self.assertAddressError(msg, addr.split("%")[0]):
389                 ipaddress.IPv6Address(addr)
390         assertBadSplit("2001:db8::1:")
391         assertBadSplit("1:2:3:4:5:6:7:")
392         assertBadSplit("::1.2.3.4:")
393         assertBadSplit("::7:6:5:4:3:2:")
394         assertBadSplit("2001:db8::1:%scope")
395         assertBadSplit("1:2:3:4:5:6:7:%scope")
396         assertBadSplit("::1.2.3.4:%scope")
397         assertBadSplit("::7:6:5:4:3:2:%scope")
398     def test_bad_v4_part_in(self):
399         def assertBadAddressPart(addr, v4_error):
400             with self.assertAddressError("%s in %r", v4_error, addr.split("%")[0]):
401                 ipaddress.IPv6Address(addr)
402         assertBadAddressPart("3ffe::1.net", "Expected 4 octets in '1.net'")
403         assertBadAddressPart("3ffe::127.0.1", "Expected 4 octets in '127.0.1'")
404         assertBadAddressPart("::1.2.3", "Expected 4 octets in '1.2.3'")
405         assertBadAddressPart("::1.2.3.4.5", "Expected 4 octets in '1.2.3.4.5'")
406         assertBadAddressPart(
407             "3ffe::1.1.1.net",
408             "Only decimal digits permitted in 'net' in '1.1.1.net'",
409         )
410         assertBadAddressPart("3ffe::1.net%scope", "Expected 4 octets in '1.net'")
411         assertBadAddressPart("3ffe::127.0.1%scope", "Expected 4 octets in '127.0.1'")
412         assertBadAddressPart("::1.2.3%scope", "Expected 4 octets in '1.2.3'")
413         assertBadAddressPart("::1.2.3.4.5%scope", "Expected 4 octets in '1.2.3.4.5'")
414         assertBadAddressPart(
415             "3ffe::1.1.1.net%scope",
416             "Only decimal digits permitted in 'net' in '1.1.1.net'",
417         )
418     def test_invalid_characters(self):
419         def assertBadPart(addr, part):
420             msg = "Only hex digits permitted in {!r} in {!r}".format(
421                 part, addr.split("%")[0]
422             )
423             with self.assertAddressError(re.escape(msg)):
424                 ipaddress.IPv6Address(addr)
425         assertBadPart("3ffe::goog", "goog")
426         assertBadPart("3ffe::-0", "-0")
427         assertBadPart("3ffe::+0", "+0")
428         assertBadPart("3ffe::-1", "-1")
429         assertBadPart("1.2.3.4::", "1.2.3.4")
430         assertBadPart("1234:axy::b", "axy")
431         assertBadPart("3ffe::goog%scope", "goog")
432         assertBadPart("3ffe::-0%scope", "-0")
433         assertBadPart("3ffe::+0%scope", "+0")
434         assertBadPart("3ffe::-1%scope", "-1")
435         assertBadPart("1.2.3.4::%scope", "1.2.3.4")
436         assertBadPart("1234:axy::b%scope", "axy")
437     def test_part_length(self):
438         def assertBadPart(addr, part):
439             msg = "At most 4 characters permitted in %r in %r"
440             with self.assertAddressError(msg, part, addr.split("%")[0]):
441                 ipaddress.IPv6Address(addr)
442         assertBadPart("::00000", "00000")
443         assertBadPart("3ffe::10000", "10000")
444         assertBadPart("02001:db8::", "02001")
445         assertBadPart("2001:888888::1", "888888")
446         assertBadPart("::00000%scope", "00000")
447         assertBadPart("3ffe::10000%scope", "10000")
448         assertBadPart("02001:db8::%scope", "02001")
449         assertBadPart("2001:888888::1%scope", "888888")
450     def test_pickle(self):
451         self.pickle_test("2001:db8::")
452     def test_weakref(self):
453         weakref.ref(self.factory("2001:db8::"))
454         weakref.ref(self.factory("2001:db8::%scope"))
455 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
456 class NetmaskTestMixin_v4(CommonTestMixin_v4):
457     def test_no_mask(self):
458         for address in ("1.2.3.4", 0x01020304, b"\x01\x02\x03\x04"):
459             net = self.factory(address)
460             self.assertEqual(str(net), "1.2.3.4/32")
461             self.assertEqual(str(net.netmask), "255.255.255.255")
462             self.assertEqual(str(net.hostmask), "0.0.0.0")
463     def test_split_netmask(self):
464         addr = "1.2.3.4/32/24"
465         with self.assertAddressError("Only one '/' permitted in %r" % addr):
466             self.factory(addr)
467     def test_address_errors(self):
468         def assertBadAddress(addr, details):
469             with self.assertAddressError(details):
470                 self.factory(addr)
471         assertBadAddress("/", "Address cannot be empty")
472         assertBadAddress("/8", "Address cannot be empty")
473         assertBadAddress("bogus", "Expected 4 octets")
474         assertBadAddress("google.com", "Expected 4 octets")
475         assertBadAddress("10/8", "Expected 4 octets")
476         assertBadAddress("::1.2.3.4", "Only decimal digits")
477         assertBadAddress("1.2.3.256", re.escape("256 (&gt; 255)"))
478     def test_valid_netmask(self):
479         self.assertEqual(str(self.factory("192.0.2.0/255.255.255.0")), "192.0.2.0/24")
480         for i in range(0, 33):
481             net_str = "0.0.0.0/%d" % i
482             net = self.factory(net_str)
483             self.assertEqual(str(net), net_str)
484             self.assertEqual(str(self.factory("0.0.0.0/%s" % net.netmask)), net_str)
485             self.assertEqual(str(self.factory("0.0.0.0/0%d" % i)), net_str)
486             if i in (32, 0):
487                 net_str = "0.0.0.0/%d" % (32 - i)
488             self.assertEqual(str(self.factory("0.0.0.0/%s" % net.hostmask)), net_str)
489     def test_netmask_errors(self):
490         def assertBadNetmask(addr, netmask):
491             msg = "%r is not a valid netmask" % netmask
492             with self.assertNetmaskError(re.escape(msg)):
493                 self.factory("{}/{}".format(addr, netmask))
494         assertBadNetmask("1.2.3.4", "")
495         assertBadNetmask("1.2.3.4", "-1")
496         assertBadNetmask("1.2.3.4", "+1")
497         assertBadNetmask("1.2.3.4", " 1 ")
498         assertBadNetmask("1.2.3.4", "0x1")
499         assertBadNetmask("1.2.3.4", "33")
500         assertBadNetmask("1.2.3.4", "254.254.255.256")
501         assertBadNetmask("1.2.3.4", "1.a.2.3")
502         assertBadNetmask("1.1.1.1", "254.xyz.2.3")
503         assertBadNetmask("1.1.1.1", "240.255.0.0")
504         assertBadNetmask("1.1.1.1", "255.254.128.0")
505         assertBadNetmask("1.1.1.1", "0.1.127.255")
506         assertBadNetmask("1.1.1.1", "pudding")
507         assertBadNetmask("1.1.1.1", "::")
508     def test_netmask_in_tuple_errors(self):
509         def assertBadNetmask(addr, netmask):
510             msg = "%r is not a valid netmask" % netmask
511             with self.assertNetmaskError(re.escape(msg)):
512                 self.factory((addr, netmask))
513         assertBadNetmask("1.1.1.1", -1)
514         assertBadNetmask("1.1.1.1", 33)
515     def test_pickle(self):
516         self.pickle_test("192.0.2.0/27")
517         self.pickle_test("192.0.2.0/31")  # IPV4LENGTH - 1
518         self.pickle_test("192.0.2.0")  # IPV4LENGTH
519 class InterfaceTestCase_v4(BaseTestCase, NetmaskTestMixin_v4):
520     factory = ipaddress.IPv4Interface
521 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
522 class NetworkTestCase_v4(BaseTestCase, NetmaskTestMixin_v4):
523     factory = ipaddress.IPv4Network
524     def test_subnet_of(self):
525         self.assertFalse(
526             self.factory("10.0.0.0/30").subnet_of(self.factory("10.0.1.0/24"))
527         )
528         self.assertTrue(
529             self.factory("10.0.0.0/30").subnet_of(self.factory("10.0.0.0/24"))
530         )
531         self.assertFalse(
532             self.factory("10.0.0.0/30").subnet_of(self.factory("10.0.1.0/24"))
533         )
534         self.assertFalse(
535             self.factory("10.0.1.0/24").subnet_of(self.factory("10.0.0.0/30"))
536         )
537     def test_supernet_of(self):
538         self.assertFalse(
539             self.factory("10.0.0.0/30").supernet_of(self.factory("10.0.1.0/24"))
540         )
541         self.assertFalse(
542             self.factory("10.0.0.0/30").supernet_of(self.factory("10.0.0.0/24"))
543         )
544         self.assertFalse(
545             self.factory("10.0.0.0/30").supernet_of(self.factory("10.0.1.0/24"))
546         )
547         self.assertTrue(
548             self.factory("10.0.0.0/24").supernet_of(self.factory("10.0.0.0/30"))
549         )
550     def test_subnet_of_mixed_types(self):
551         with self.assertRaises(TypeError):
552             ipaddress.IPv4Network("10.0.0.0/30").supernet_of(
553                 ipaddress.IPv6Network("::1/128")
554             )
555         with self.assertRaises(TypeError):
556             ipaddress.IPv6Network("::1/128").supernet_of(
557                 ipaddress.IPv4Network("10.0.0.0/30")
558             )
559         with self.assertRaises(TypeError):
560             ipaddress.IPv4Network("10.0.0.0/30").subnet_of(
561                 ipaddress.IPv6Network("::1/128")
562             )
563         with self.assertRaises(TypeError):
564             ipaddress.IPv6Network("::1/128").subnet_of(
565                 ipaddress.IPv4Network("10.0.0.0/30")
566             )
567 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
568 class NetmaskTestMixin_v6(CommonTestMixin_v6):
569     def test_no_mask(self):
570         for address in ("::1", 1, b"\x00" * 15 + b"\x01"):
571             net = self.factory(address)
572             self.assertEqual(str(net), "::1/128")
573             self.assertEqual(
574                 str(net.netmask), "ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
575             )
576             self.assertEqual(str(net.hostmask), "::")
577         scoped_net = self.factory("::1%scope")
578         self.assertEqual(str(scoped_net), "::1%scope/128")
579         self.assertEqual(
580             str(scoped_net.netmask), "ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
581         )
582         self.assertEqual(str(scoped_net.hostmask), "::")
583     def test_split_netmask(self):
584         addr = "cafe:cafe::/128/190"
585         with self.assertAddressError("Only one '/' permitted in %r" % addr):
586             self.factory(addr)
587         scoped_addr = "cafe:cafe::%scope/128/190"
588         with self.assertAddressError("Only one '/' permitted in %r" % scoped_addr):
589             self.factory(scoped_addr)
590     def test_address_errors(self):
591         def assertBadAddress(addr, details):
592             with self.assertAddressError(details):
593                 self.factory(addr)
594         assertBadAddress("/", "Address cannot be empty")
595         assertBadAddress("/8", "Address cannot be empty")
596         assertBadAddress("google.com", "At least 3 parts")
597         assertBadAddress("1.2.3.4", "At least 3 parts")
598         assertBadAddress("10/8", "At least 3 parts")
599         assertBadAddress("1234:axy::b", "Only hex digits")
600         assertBadAddress("/%scope", "Address cannot be empty")
601         assertBadAddress("/%scope8", "Address cannot be empty")
602         assertBadAddress("google.com%scope", "At least 3 parts")
603         assertBadAddress("1.2.3.4%scope", "At least 3 parts")
604         assertBadAddress("10%scope/8", "At least 3 parts")
605         assertBadAddress("1234:axy::b%scope", "Only hex digits")
606     def test_valid_netmask(self):
607         self.assertEqual(str(self.factory("2001:db8::/32")), "2001:db8::/32")
608         for i in range(0, 129):
609             net_str = "::/%d" % i
610             self.assertEqual(str(self.factory(net_str)), net_str)
611             self.assertEqual(str(self.factory("::/0%d" % i)), net_str)
612         self.assertEqual(
613             str(self.factory("2001:db8::%scope/32")), "2001:db8::%scope/32"
614         )
615         for i in range(0, 129):
616             net_str = "::/%d" % i
617             self.assertEqual(str(self.factory(net_str)), net_str)
618             self.assertEqual(str(self.factory("::/0%d" % i)), net_str)
619     def test_netmask_errors(self):
620         def assertBadNetmask(addr, netmask):
621             msg = "%r is not a valid netmask" % netmask
622             with self.assertNetmaskError(re.escape(msg)):
623                 self.factory("{}/{}".format(addr, netmask))
624         assertBadNetmask("::1", "")
625         assertBadNetmask("::1", "::1")
626         assertBadNetmask("::1", "1::")
627         assertBadNetmask("::1", "-1")
628         assertBadNetmask("::1", "+1")
629         assertBadNetmask("::1", " 1 ")
630         assertBadNetmask("::1", "0x1")
631         assertBadNetmask("::1", "129")
632         assertBadNetmask("::1", "1.2.3.4")
633         assertBadNetmask("::1", "pudding")
634         assertBadNetmask("::", "::")
635         assertBadNetmask("::1%scope", "pudding")
636     def test_netmask_in_tuple_errors(self):
637         def assertBadNetmask(addr, netmask):
638             msg = "%r is not a valid netmask" % netmask
639             with self.assertNetmaskError(re.escape(msg)):
640                 self.factory((addr, netmask))
641         assertBadNetmask("::1", -1)
642         assertBadNetmask("::1", 129)
643         assertBadNetmask("::1%scope", 129)
644     def test_pickle(self):
645         self.pickle_test("2001:db8::1000/124")
646         self.pickle_test("2001:db8::1000/127")  # IPV6LENGTH - 1
647         self.pickle_test("2001:db8::1000")  # IPV6LENGTH
648         self.pickle_test("2001:db8::1000%scope")  # IPV6LENGTH
649 class InterfaceTestCase_v6(BaseTestCase, NetmaskTestMixin_v6):
650     factory = ipaddress.IPv6Interface
651 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
652 class NetworkTestCase_v6(BaseTestCase, NetmaskTestMixin_v6):
653     factory = ipaddress.IPv6Network
654     def test_subnet_of(self):
655         self.assertFalse(
656             self.factory("2000:999::/56").subnet_of(self.factory("2000:aaa::/48"))
657         )
658         self.assertTrue(
659             self.factory("2000:aaa::/56").subnet_of(self.factory("2000:aaa::/48"))
660         )
661         self.assertFalse(
662             self.factory("2000:bbb::/56").subnet_of(self.factory("2000:aaa::/48"))
663         )
664         self.assertFalse(
665             self.factory("2000:aaa::/48").subnet_of(self.factory("2000:aaa::/56"))
666         )
667         self.assertFalse(
668             self.factory("2000:999::%scope/56").subnet_of(
669                 self.factory("2000:aaa::%scope/48")
670             )
671         )
672         self.assertTrue(
673             self.factory("2000:aaa::%scope/56").subnet_of(
674                 self.factory("2000:aaa::%scope/48")
675             )
676         )
677     def test_supernet_of(self):
678         self.assertFalse(
679             self.factory("2000:999::/56").supernet_of(self.factory("2000:aaa::/48"))
680         )
681         self.assertFalse(
682             self.factory("2000:aaa::/56").supernet_of(self.factory("2000:aaa::/48"))
683         )
684         self.assertFalse(
685             self.factory("2000:bbb::/56").supernet_of(self.factory("2000:aaa::/48"))
686         )
687         self.assertTrue(
688             self.factory("2000:aaa::/48").supernet_of(self.factory("2000:aaa::/56"))
689         )
690 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
691 class FactoryFunctionErrors(BaseTestCase):
692     def assertFactoryError(self, factory, kind):
693         addr = "camelot"
694         msg = "%r does not appear to be an IPv4 or IPv6 %s"
695         with self.assertCleanError(ValueError, msg, addr, kind):
696             factory(addr)
697     def test_ip_address(self):
698         self.assertFactoryError(ipaddress.ip_address, "address")
699     def test_ip_interface(self):
700         self.assertFactoryError(ipaddress.ip_interface, "interface")
701     def test_ip_network(self):
702         self.assertFactoryError(ipaddress.ip_network, "network")
703 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
704 class ComparisonTests(TestCase):
705     v4addr = ipaddress.IPv4Address(1)
706     v4net = ipaddress.IPv4Network(1)
707     v4intf = ipaddress.IPv4Interface(1)
708     v6addr = ipaddress.IPv6Address(1)
709     v6net = ipaddress.IPv6Network(1)
710     v6intf = ipaddress.IPv6Interface(1)
711     v6addr_scoped = ipaddress.IPv6Address("::1%scope")
712     v6net_scoped = ipaddress.IPv6Network("::1%scope")
713     v6intf_scoped = ipaddress.IPv6Interface("::1%scope")
714     v4_addresses = [v4addr, v4intf]
715     v4_objects = v4_addresses + [v4net]
716     v6_addresses = [v6addr, v6intf]
717     v6_objects = v6_addresses + [v6net]
718     v6_scoped_addresses = [v6addr_scoped, v6intf_scoped]
719     v6_scoped_objects = v6_scoped_addresses + [v6net_scoped]
720     objects = v4_objects + v6_objects
721     objects_with_scoped = objects + v6_scoped_objects
722     v4addr2 = ipaddress.IPv4Address(2)
723     v4net2 = ipaddress.IPv4Network(2)
724     v4intf2 = ipaddress.IPv4Interface(2)
725     v6addr2 = ipaddress.IPv6Address(2)
726     v6net2 = ipaddress.IPv6Network(2)
727     v6intf2 = ipaddress.IPv6Interface(2)
728     v6addr2_scoped = ipaddress.IPv6Address("::2%scope")
729     v6net2_scoped = ipaddress.IPv6Network("::2%scope")
730     v6intf2_scoped = ipaddress.IPv6Interface("::2%scope")
731     def test_foreign_type_equality(self):
732         other = object()
733         for obj in self.objects_with_scoped:
734             self.assertNotEqual(obj, other)
735             self.assertFalse(obj == other)
736             self.assertEqual(obj.__eq__(other), NotImplemented)
737             self.assertEqual(obj.__ne__(other), NotImplemented)
738     def test_mixed_type_equality(self):
739         for lhs in self.objects:
740             for rhs in self.objects:
741                 if lhs is rhs:
742                     continue
743                 self.assertNotEqual(lhs, rhs)
744     def test_scoped_ipv6_equality(self):
745         for lhs, rhs in zip(self.v6_objects, self.v6_scoped_objects):
746             self.assertNotEqual(lhs, rhs)
747     def test_v4_with_v6_scoped_equality(self):
748         for lhs in self.v4_objects:
749             for rhs in self.v6_scoped_objects:
750                 self.assertNotEqual(lhs, rhs)
751     def test_same_type_equality(self):
752         for obj in self.objects_with_scoped:
753             self.assertEqual(obj, obj)
754             self.assertLessEqual(obj, obj)
755             self.assertGreaterEqual(obj, obj)
756     def test_same_type_ordering(self):
757         for lhs, rhs in (
758             (self.v4addr, self.v4addr2),
759             (self.v4net, self.v4net2),
760             (self.v4intf, self.v4intf2),
761             (self.v6addr, self.v6addr2),
762             (self.v6net, self.v6net2),
763             (self.v6intf, self.v6intf2),
764             (self.v6addr_scoped, self.v6addr2_scoped),
765             (self.v6net_scoped, self.v6net2_scoped),
766             (self.v6intf_scoped, self.v6intf2_scoped),
767         ):
768             self.assertNotEqual(lhs, rhs)
769             self.assertLess(lhs, rhs)
770             self.assertLessEqual(lhs, rhs)
771             self.assertGreater(rhs, lhs)
772             self.assertGreaterEqual(rhs, lhs)
773             self.assertFalse(lhs &gt; rhs)
774             self.assertFalse(rhs &lt; lhs)
775             self.assertFalse(lhs &gt;= rhs)
776             self.assertFalse(rhs &lt;= lhs)
777     def test_containment(self):
778         for obj in self.v4_addresses:
779             self.assertIn(obj, self.v4net)
780         for obj in self.v6_addresses + self.v6_scoped_addresses:
781             self.assertIn(obj, self.v6net)
782         for obj in self.v6_addresses + self.v6_scoped_addresses:
783             self.assertIn(obj, self.v6net_scoped)
784         for obj in self.v4_objects + [self.v6net, self.v6net_scoped]:
785             self.assertNotIn(obj, self.v6net)
786         for obj in self.v4_objects + [self.v6net, self.v6net_scoped]:
787             self.assertNotIn(obj, self.v6net_scoped)
788         for obj in self.v6_objects + self.v6_scoped_objects + [self.v4net]:
789             self.assertNotIn(obj, self.v4net)
790     def test_mixed_type_ordering(self):
791         for lhs in self.objects_with_scoped:
792             for rhs in self.objects_with_scoped:
793                 if isinstance(lhs, type(rhs)) or isinstance(rhs, type(lhs)):
794                     continue
795                 self.assertRaises(TypeError, lambda: lhs &lt; rhs)
796                 self.assertRaises(TypeError, lambda: lhs &gt; rhs)
797                 self.assertRaises(TypeError, lambda: lhs &lt;= rhs)
798                 self.assertRaises(TypeError, lambda: lhs &gt;= rhs)
799     def test_foreign_type_ordering(self):
800         other = object()
801         for obj in self.objects_with_scoped:
802             with self.assertRaises(TypeError):
803                 obj &lt; other
804             with self.assertRaises(TypeError):
805                 obj &gt; other
806             with self.assertRaises(TypeError):
807                 obj &lt;= other
808             with self.assertRaises(TypeError):
809                 obj &gt;= other
810             self.assertTrue(obj &lt; LARGEST)
811             self.assertFalse(obj &gt; LARGEST)
812             self.assertTrue(obj &lt;= LARGEST)
813             self.assertFalse(obj &gt;= LARGEST)
814             self.assertFalse(obj &lt; SMALLEST)
815             self.assertTrue(obj &gt; SMALLEST)
816             self.assertFalse(obj &lt;= SMALLEST)
817             self.assertTrue(obj &gt;= SMALLEST)
818 <a name="3"></a>
819     def test_mixed_type_key(self):
820         v4_ordered = [self<font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.v4addr, self.v4net, self.v4intf]
821         v6_ordered = [self.v6addr, self.v6net, self.v6intf]
822         v6_scoped_ordered = [self.v6addr_scoped, self.v6net_scoped, self.</b></font>v6intf_scoped]
823         self.assertEqual(
824             v4_ordered, sorted(self.v4_objects, key=ipaddress.get_mixed_type_key)
825         )
826         self.assertEqual(
827             v6_ordered, sorted(self.v6_objects, key=ipaddress.get_mixed_type_key)
828         )
829         self.assertEqual(
830             v6_scoped_ordered,
831             sorted(self.v6_scoped_objects, key=ipaddress.get_mixed_type_key),
832         )
833         self.assertEqual(
834             v4_ordered + v6_scoped_ordered,
835             sorted(
836                 self.v4_objects + self.v6_scoped_objects,
837                 key=ipaddress.get_mixed_type_key,
838             ),
839         )
840         self.assertEqual(NotImplemented, ipaddress.get_mixed_type_key(object))
841     def test_incompatible_versions(self):
842         v4addr = ipaddress.ip_address("1.1.1.1")
843         v4net = ipaddress.ip_network("1.1.1.1")
844         v6addr = ipaddress.ip_address("::1")
845         v6net = ipaddress.ip_network("::1")
846         v6addr_scoped = ipaddress.ip_address("::1%scope")
847         v6net_scoped = ipaddress.ip_network("::1%scope")
848         self.assertRaises(TypeError, v4addr.__lt__, v6addr)
849         self.assertRaises(TypeError, v4addr.__gt__, v6addr)
850         self.assertRaises(TypeError, v4net.__lt__, v6net)
851         self.assertRaises(TypeError, v4net.__gt__, v6net)
852         self.assertRaises(TypeError, v6addr.__lt__, v4addr)
853         self.assertRaises(TypeError, v6addr.__gt__, v4addr)
854         self.assertRaises(TypeError, v6net.__lt__, v4net)
855         self.assertRaises(TypeError, v6net.__gt__, v4net)
856         self.assertRaises(TypeError, v4addr.__lt__, v6addr_scoped)
857         self.assertRaises(TypeError, v4addr.__gt__, v6addr_scoped)
858         self.assertRaises(TypeError, v4net.__lt__, v6net_scoped)
859         self.assertRaises(TypeError, v4net.__gt__, v6net_scoped)
860         self.assertRaises(TypeError, v6addr_scoped.__lt__, v4addr)
861         self.assertRaises(TypeError, v6addr_scoped.__gt__, v4addr)
862         self.assertRaises(TypeError, v6net_scoped.__lt__, v4net)
863         self.assertRaises(TypeError, v6net_scoped.__gt__, v4net)
864 <a name="0"></a>@skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
865 class IpaddrUnitTest(TestCase):
866     def setUp(self):
867         self.ipv4_address = ipaddress<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.IPv4Address("1.2.3.4")
868         self.ipv4_interface = ipaddress.IPv4Interface("1.2.3.4/24")
869 <a name="6"></a>        self.ipv4_network = ipaddress.IPv4Network("1.2.3.0/24")
870         self.ipv6_address = ipaddress.IPv6Interface("2001:658:22a:cafe:200:0:0:1")
871         self.ipv6_interface =</b></font> ipaddress<font color="#8c8774"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.IPv6Interface("2001:658:22a:cafe:200:0:0:1/64")
872         self.ipv6_network = ipaddress.IPv6Network("2001:658:22a:cafe::/64")
873         self.ipv6_scoped_address = ipaddress.IPv6Interface(
874             "2001:658:22a:cafe:200:0:0:1%scope"
875         )
876         self.ipv6_scoped_interface =</b></font> ipaddress.IPv6Interface(
877             "2001:658:22a:cafe:200:0:0:1%scope/64"
878         )
879         self.ipv6_scoped_network = ipaddress.IPv6Network("2001:658:22a:cafe::%scope/64")
880     def testRepr(self):
881         self.assertEqual(
882             "IPv4Interface('1.2.3.4/32')", repr(ipaddress.IPv4Interface("1.2.3.4"))
883         )
884         self.assertEqual(
885 <a name="9"></a>            "IPv6Interface('::1/128')", repr(ipaddress.IPv6Interface("::1"))
886         )
887         self.assertEqual(
888             "IPv6Interface('::1%scope/128')", repr(ipaddress.IPv6Interface(<font color="#83a33a"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>"::1%scope"))
889         )
890     def testIPv4Tuple(self):
891         ip = ipaddress.IPv4Address("192.0.2.1")
892         net = ipaddress.IPv4Network("192.0.2.1/32")
893         self.assertEqual(ipaddress.IPv4Network(</b></font>("192.0.2.1", 32)), net)
894         self.assertEqual(ipaddress.IPv4Network((ip, 32)), net)
895         self.assertEqual(ipaddress.IPv4Network((3221225985, 32)), net)
896         self.assertEqual(ipaddress.IPv4Network(("192.0.2.1", "255.255.255.255")), net)
897         self.assertEqual(ipaddress.IPv4Network((ip, "255.255.255.255")), net)
898         self.assertEqual(ipaddress.IPv4Network((3221225985, "255.255.255.255")), net)
899         with self.assertRaises(ValueError):
900             ipaddress.IPv4Network(("192.0.2.1", 24))
901         with self.assertRaises(ValueError):
902             ipaddress.IPv4Network((ip, 24))
903         with self.assertRaises(ValueError):
904             ipaddress.IPv4Network((3221225985, 24))
905         with self.assertRaises(ValueError):
906             ipaddress.IPv4Network(("192.0.2.1", "255.255.255.0"))
907         with self.assertRaises(ValueError):
908             ipaddress.IPv4Network((ip, "255.255.255.0"))
909         with self.assertRaises(ValueError):
910             ipaddress.IPv4Network((3221225985, "255.255.255.0"))
911         net = ipaddress.IPv4Network("192.0.2.0/24")
912         self.assertEqual(ipaddress.IPv4Network(("192.0.2.1", 24), strict=False), net)
913         self.assertEqual(ipaddress.IPv4Network((ip, 24), strict=False), net)
914         self.assertEqual(ipaddress.IPv4Network((3221225985, 24), strict=False), net)
915         self.assertEqual(
916             ipaddress.IPv4Network(("192.0.2.1", "255.255.255.0"), strict=False), net
917         )
918         self.assertEqual(
919             ipaddress.IPv4Network((ip, "255.255.255.0"), strict=False), net
920         )
921         self.assertEqual(
922             ipaddress.IPv4Network((3221225985, "255.255.255.0"), strict=False), net
923         )
924         ip = ipaddress.IPv4Address("192.0.2.0")
925         net = ipaddress.IPv4Network("192.0.2.0/24")
926         self.assertEqual(ipaddress.IPv4Network(("192.0.2.0", "255.255.255.0")), net)
927         self.assertEqual(ipaddress.IPv4Network((ip, "255.255.255.0")), net)
928         self.assertEqual(ipaddress.IPv4Network((3221225984, "255.255.255.0")), net)
929         self.assertEqual(ipaddress.IPv4Network(("192.0.2.0", 24)), net)
930         self.assertEqual(ipaddress.IPv4Network((ip, 24)), net)
931         self.assertEqual(ipaddress.IPv4Network((3221225984, 24)), net)
932         self.assertEqual(
933             ipaddress.IPv4Interface(("192.0.2.1", 24)),
934             ipaddress.IPv4Interface("192.0.2.1/24"),
935 <a name="8"></a>        )
936         self.assertEqual(
937             ipaddress.IPv4Interface((3221225985, 24)),
938             ipaddress.IPv4Interface(<font color="#c58917"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>"192.0.2.1/24"),
939         )
940     def testIPv6Tuple(self):
941         ip = ipaddress.IPv6Address("2001:db8::")
942         net = ipaddress.IPv6Network("2001:db8::/128")
943         self.assertEqual(ipaddress.IPv6Network(</b></font>("2001:db8::", "128")), net)
944         self.assertEqual(
945             ipaddress.IPv6Network((42540766411282592856903984951653826560, 128)), net
946         )
947         self.assertEqual(ipaddress.IPv6Network((ip, "128")), net)
948         ip = ipaddress.IPv6Address("2001:db8::")
949         net = ipaddress.IPv6Network("2001:db8::/96")
950         self.assertEqual(ipaddress.IPv6Network(("2001:db8::", "96")), net)
951         self.assertEqual(
952             ipaddress.IPv6Network((42540766411282592856903984951653826560, 96)), net
953         )
954         self.assertEqual(ipaddress.IPv6Network((ip, "96")), net)
955         ip_scoped = ipaddress.IPv6Address("2001:db8::%scope")
956         ip = ipaddress.IPv6Address("2001:db8::1")
957         with self.assertRaises(ValueError):
958             ipaddress.IPv6Network(("2001:db8::1", 96))
959         with self.assertRaises(ValueError):
960             ipaddress.IPv6Network((42540766411282592856903984951653826561, 96))
961         with self.assertRaises(ValueError):
962             ipaddress.IPv6Network((ip, 96))
963         net = ipaddress.IPv6Network("2001:db8::/96")
964         self.assertEqual(ipaddress.IPv6Network(("2001:db8::1", 96), strict=False), net)
965         self.assertEqual(
966             ipaddress.IPv6Network(
967                 (42540766411282592856903984951653826561, 96), strict=False
968             ),
969             net,
970         )
971         self.assertEqual(ipaddress.IPv6Network((ip, 96), strict=False), net)
972         self.assertEqual(
973             ipaddress.IPv6Interface(("2001:db8::1", "96")),
974             ipaddress.IPv6Interface("2001:db8::1/96"),
975         )
976         self.assertEqual(
977             ipaddress.IPv6Interface((42540766411282592856903984951653826561, "96")),
978             ipaddress.IPv6Interface("2001:db8::1/96"),
979         )
980         ip_scoped = ipaddress.IPv6Address("2001:db8::1%scope")
981         with self.assertRaises(ValueError):
982             ipaddress.IPv6Network(("2001:db8::1%scope", 96))
983         with self.assertRaises(ValueError):
984             ipaddress.IPv6Network((ip_scoped, 96))
985     def testAddressIntMath(self):
986         self.assertEqual(
987             ipaddress.IPv4Address("1.1.1.1") + 255, ipaddress.IPv4Address("1.1.2.0")
988         )
989         self.assertEqual(
990             ipaddress.IPv4Address("1.1.1.1") - 256, ipaddress.IPv4Address("1.1.0.1")
991         )
992         self.assertEqual(
993             ipaddress.IPv6Address("::1") + (2 ** 16 - 2),
994             ipaddress.IPv6Address("::ffff"),
995         )
996         self.assertEqual(
997             ipaddress.IPv6Address("::ffff") - (2 ** 16 - 2),
998             ipaddress.IPv6Address("::1"),
999         )
1000         self.assertNotEqual(
1001             ipaddress.IPv6Address("::1%scope") + (2 ** 16 - 2),
1002             ipaddress.IPv6Address("::ffff%scope"),
1003         )
1004         self.assertNotEqual(
1005             ipaddress.IPv6Address("::ffff%scope") - (2 ** 16 - 2),
1006             ipaddress.IPv6Address("::1%scope"),
1007         )
1008     def testInvalidIntToBytes(self):
1009         self.assertRaises(ValueError, ipaddress.v4_int_to_packed, -1)
1010         self.assertRaises(
1011             ValueError, ipaddress.v4_int_to_packed, 2 ** ipaddress.IPV4LENGTH
1012         )
1013         self.assertRaises(ValueError, ipaddress.v6_int_to_packed, -1)
1014         self.assertRaises(
1015             ValueError, ipaddress.v6_int_to_packed, 2 ** ipaddress.IPV6LENGTH
1016         )
1017     def testInternals(self):
1018         ip1 = ipaddress.IPv4Address("10.10.10.10")
1019         ip2 = ipaddress.IPv4Address("10.10.10.11")
1020         ip3 = ipaddress.IPv4Address("10.10.10.12")
1021         self.assertEqual(list(ipaddress._find_address_range([ip1])), [(ip1, ip1)])
1022         self.assertEqual(
1023             list(ipaddress._find_address_range([ip1, ip3])), [(ip1, ip1), (ip3, ip3)]
1024         )
1025         self.assertEqual(
1026             list(ipaddress._find_address_range([ip1, ip2, ip3])), [(ip1, ip3)]
1027         )
1028         self.assertEqual(128, ipaddress._count_righthand_zero_bits(0, 128))
1029         self.assertEqual("IPv4Network('1.2.3.0/24')", repr(self.ipv4_network))
1030     def testGetNetwork(self):
1031         self.assertEqual(int(self.ipv4_network.network_address), 16909056)
1032         self.assertEqual(str(self.ipv4_network.network_address), "1.2.3.0")
1033         self.assertEqual(
1034             int(self.ipv6_network.network_address),
1035             42540616829182469433403647294022090752,
1036         )
1037         self.assertEqual(str(self.ipv6_network.network_address), "2001:658:22a:cafe::")
1038         self.assertEqual(str(self.ipv6_network.hostmask), "::ffff:ffff:ffff:ffff")
1039         self.assertEqual(
1040             int(self.ipv6_scoped_network.network_address),
1041             42540616829182469433403647294022090752,
1042         )
1043         self.assertEqual(
1044             str(self.ipv6_scoped_network.network_address), "2001:658:22a:cafe::%scope"
1045         )
1046         self.assertEqual(
1047             str(self.ipv6_scoped_network.hostmask), "::ffff:ffff:ffff:ffff"
1048         )
1049     def testIpFromInt(self):
1050         self.assertEqual(self.ipv4_interface._ip, ipaddress.IPv4Interface(16909060)._ip)
1051         ipv4 = ipaddress.ip_network("1.2.3.4")
1052         ipv6 = ipaddress.ip_network("2001:658:22a:cafe:200:0:0:1")
1053         ipv6_scoped = ipaddress.ip_network("2001:658:22a:cafe:200:0:0:1%scope")
1054         self.assertEqual(ipv4, ipaddress.ip_network(int(ipv4.network_address)))
1055         self.assertEqual(ipv6, ipaddress.ip_network(int(ipv6.network_address)))
1056         self.assertNotEqual(
1057             ipv6_scoped, ipaddress.ip_network(int(ipv6_scoped.network_address))
1058         )
1059         v6_int = 42540616829182469433547762482097946625
1060         self.assertEqual(self.ipv6_interface._ip, ipaddress.IPv6Interface(v6_int)._ip)
1061         self.assertEqual(
1062             self.ipv6_scoped_interface._ip, ipaddress.IPv6Interface(v6_int)._ip
1063         )
1064         self.assertEqual(ipaddress.ip_network(self.ipv4_address._ip).version, 4)
1065         self.assertEqual(ipaddress.ip_network(self.ipv6_address._ip).version, 6)
1066         self.assertEqual(ipaddress.ip_network(self.ipv6_scoped_address._ip).version, 6)
1067     def testIpFromPacked(self):
1068         address = ipaddress.ip_address
1069         self.assertEqual(
1070             self.ipv4_interface._ip, ipaddress.ip_interface(b"\x01\x02\x03\x04")._ip
1071         )
1072         self.assertEqual(address("255.254.253.252"), address(b"\xff\xfe\xfd\xfc"))
1073         self.assertEqual(
1074             self.ipv6_interface.ip,
1075             ipaddress.ip_interface(
1076                 b"\x20\x01\x06\x58\x02\x2a\xca\xfe\x02\x00\x00\x00\x00\x00\x00\x01"
1077             ).ip,
1078         )
1079         self.assertEqual(
1080             address("ffff:2:3:4:ffff::"),
1081             address(b"\xff\xff\x00\x02\x00\x03\x00\x04" + b"\xff\xff" + b"\x00" * 6),
1082         )
1083         self.assertEqual(address("::"), address(b"\x00" * 16))
1084     def testGetIp(self):
1085         self.assertEqual(int(self.ipv4_interface.ip), 16909060)
1086         self.assertEqual(str(self.ipv4_interface.ip), "1.2.3.4")
1087         self.assertEqual(
1088             int(self.ipv6_interface.ip), 42540616829182469433547762482097946625
1089         )
1090         self.assertEqual(str(self.ipv6_interface.ip), "2001:658:22a:cafe:200::1")
1091         self.assertEqual(
1092             int(self.ipv6_scoped_interface.ip), 42540616829182469433547762482097946625
1093         )
1094         self.assertEqual(str(self.ipv6_scoped_interface.ip), "2001:658:22a:cafe:200::1")
1095     def testGetScopeId(self):
1096         self.assertEqual(self.ipv6_address.scope_id, None)
1097         self.assertEqual(str(self.ipv6_scoped_address.scope_id), "scope")
1098         self.assertEqual(self.ipv6_interface.scope_id, None)
1099         self.assertEqual(str(self.ipv6_scoped_interface.scope_id), "scope")
1100         self.assertEqual(self.ipv6_network.network_address.scope_id, None)
1101         self.assertEqual(
1102             str(self.ipv6_scoped_network.network_address.scope_id), "scope"
1103         )
1104     def testGetNetmask(self):
1105         self.assertEqual(int(self.ipv4_network.netmask), 4294967040)
1106         self.assertEqual(str(self.ipv4_network.netmask), "255.255.255.0")
1107         self.assertEqual(
1108             int(self.ipv6_network.netmask), 340282366920938463444927863358058659840
1109         )
1110         self.assertEqual(self.ipv6_network.prefixlen, 64)
1111         self.assertEqual(
1112             int(self.ipv6_scoped_network.netmask),
1113             340282366920938463444927863358058659840,
1114         )
1115         self.assertEqual(self.ipv6_scoped_network.prefixlen, 64)
1116     def testZeroNetmask(self):
1117         ipv4_zero_netmask = ipaddress.IPv4Interface("1.2.3.4/0")
1118         self.assertEqual(int(ipv4_zero_netmask.network.netmask), 0)
1119         self.assertEqual(ipv4_zero_netmask._prefix_from_prefix_string("0"), 0)
1120         ipv6_zero_netmask = ipaddress.IPv6Interface("::1/0")
1121         self.assertEqual(int(ipv6_zero_netmask.network.netmask), 0)
1122         self.assertEqual(ipv6_zero_netmask._prefix_from_prefix_string("0"), 0)
1123         ipv6_scoped_zero_netmask = ipaddress.IPv6Interface("::1%scope/0")
1124         self.assertEqual(int(ipv6_scoped_zero_netmask.network.netmask), 0)
1125         self.assertEqual(ipv6_scoped_zero_netmask._prefix_from_prefix_string("0"), 0)
1126     def testIPv4Net(self):
1127         net = ipaddress.IPv4Network("127.0.0.0/0.0.0.255")
1128         self.assertEqual(net.prefixlen, 24)
1129     def testGetBroadcast(self):
1130         self.assertEqual(int(self.ipv4_network.broadcast_address), 16909311)
1131         self.assertEqual(str(self.ipv4_network.broadcast_address), "1.2.3.255")
1132         self.assertEqual(
1133             int(self.ipv6_network.broadcast_address),
1134             42540616829182469451850391367731642367,
1135         )
1136         self.assertEqual(
1137             str(self.ipv6_network.broadcast_address),
1138             "2001:658:22a:cafe:ffff:ffff:ffff:ffff",
1139         )
1140         self.assertEqual(
1141             int(self.ipv6_scoped_network.broadcast_address),
1142             42540616829182469451850391367731642367,
1143         )
1144         self.assertEqual(
1145             str(self.ipv6_scoped_network.broadcast_address),
1146             "2001:658:22a:cafe:ffff:ffff:ffff:ffff",
1147         )
1148     def testGetPrefixlen(self):
1149         self.assertEqual(self.ipv4_interface.network.prefixlen, 24)
1150         self.assertEqual(self.ipv6_interface.network.prefixlen, 64)
1151         self.assertEqual(self.ipv6_scoped_interface.network.prefixlen, 64)
1152     def testGetSupernet(self):
1153         self.assertEqual(self.ipv4_network.supernet().prefixlen, 23)
1154         self.assertEqual(str(self.ipv4_network.supernet().network_address), "1.2.2.0")
1155         self.assertEqual(
1156             ipaddress.IPv4Interface("0.0.0.0/0").network.supernet(),
1157             ipaddress.IPv4Network("0.0.0.0/0"),
1158         )
1159         self.assertEqual(self.ipv6_network.supernet().prefixlen, 63)
1160         self.assertEqual(
1161             str(self.ipv6_network.supernet().network_address), "2001:658:22a:cafe::"
1162         )
1163         self.assertEqual(
1164             ipaddress.IPv6Interface("::0/0").network.supernet(),
1165             ipaddress.IPv6Network("::0/0"),
1166         )
1167         self.assertEqual(self.ipv6_scoped_network.supernet().prefixlen, 63)
1168         self.assertEqual(
1169             str(self.ipv6_scoped_network.supernet().network_address),
1170             "2001:658:22a:cafe::",
1171         )
1172     def testGetSupernet3(self):
1173         self.assertEqual(self.ipv4_network.supernet(3).prefixlen, 21)
1174         self.assertEqual(str(self.ipv4_network.supernet(3).network_address), "1.2.0.0")
1175         self.assertEqual(self.ipv6_network.supernet(3).prefixlen, 61)
1176         self.assertEqual(
1177             str(self.ipv6_network.supernet(3).network_address), "2001:658:22a:caf8::"
1178         )
1179         self.assertEqual(self.ipv6_scoped_network.supernet(3).prefixlen, 61)
1180         self.assertEqual(
1181             str(self.ipv6_scoped_network.supernet(3).network_address),
1182             "2001:658:22a:caf8::",
1183         )
1184     def testGetSupernet4(self):
1185         self.assertRaises(
1186             ValueError, self.ipv4_network.supernet, prefixlen_diff=2, new_prefix=1
1187         )
1188         self.assertRaises(ValueError, self.ipv4_network.supernet, new_prefix=25)
1189         self.assertEqual(
1190             self.ipv4_network.supernet(prefixlen_diff=2),
1191             self.ipv4_network.supernet(new_prefix=22),
1192         )
1193         self.assertRaises(
1194             ValueError, self.ipv6_network.supernet, prefixlen_diff=2, new_prefix=1
1195         )
1196         self.assertRaises(ValueError, self.ipv6_network.supernet, new_prefix=65)
1197         self.assertEqual(
1198             self.ipv6_network.supernet(prefixlen_diff=2),
1199             self.ipv6_network.supernet(new_prefix=62),
1200         )
1201         self.assertRaises(
1202             ValueError,
1203             self.ipv6_scoped_network.supernet,
1204             prefixlen_diff=2,
1205             new_prefix=1,
1206         )
1207         self.assertRaises(ValueError, self.ipv6_scoped_network.supernet, new_prefix=65)
1208         self.assertEqual(
1209             self.ipv6_scoped_network.supernet(prefixlen_diff=2),
1210             self.ipv6_scoped_network.supernet(new_prefix=62),
1211         )
1212     def testHosts(self):
1213         hosts = list(self.ipv4_network.hosts())
1214         self.assertEqual(254, len(hosts))
1215         self.assertEqual(ipaddress.IPv4Address("1.2.3.1"), hosts[0])
1216         self.assertEqual(ipaddress.IPv4Address("1.2.3.254"), hosts[-1])
1217         ipv6_network = ipaddress.IPv6Network("2001:658:22a:cafe::/120")
1218         hosts = list(ipv6_network.hosts())
1219         self.assertEqual(255, len(hosts))
1220         self.assertEqual(ipaddress.IPv6Address("2001:658:22a:cafe::1"), hosts[0])
1221         self.assertEqual(ipaddress.IPv6Address("2001:658:22a:cafe::ff"), hosts[-1])
1222         ipv6_scoped_network = ipaddress.IPv6Network("2001:658:22a:cafe::%scope/120")
1223         hosts = list(ipv6_scoped_network.hosts())
1224         self.assertEqual(255, len(hosts))
1225         self.assertEqual(ipaddress.IPv6Address("2001:658:22a:cafe::1"), hosts[0])
1226         self.assertEqual(ipaddress.IPv6Address("2001:658:22a:cafe::ff"), hosts[-1])
1227         addrs = [ipaddress.IPv4Address("2.0.0.0"), ipaddress.IPv4Address("2.0.0.1")]
1228         str_args = "2.0.0.0/31"
1229         tpl_args = ("2.0.0.0", 31)
1230         self.assertEqual(addrs, list(ipaddress.ip_network(str_args).hosts()))
1231         self.assertEqual(addrs, list(ipaddress.ip_network(tpl_args).hosts()))
1232         self.assertEqual(
1233             list(ipaddress.ip_network(str_args).hosts()),
1234             list(ipaddress.ip_network(tpl_args).hosts()),
1235         )
1236         addrs = [ipaddress.IPv4Address("1.2.3.4")]
1237         str_args = "1.2.3.4/32"
1238         tpl_args = ("1.2.3.4", 32)
1239         self.assertEqual(addrs, list(ipaddress.ip_network(str_args).hosts()))
1240         self.assertEqual(addrs, list(ipaddress.ip_network(tpl_args).hosts()))
1241         self.assertEqual(
1242             list(ipaddress.ip_network(str_args).hosts()),
1243             list(ipaddress.ip_network(tpl_args).hosts()),
1244         )
1245         addrs = [
1246             ipaddress.IPv6Address("2001:658:22a:cafe::"),
1247             ipaddress.IPv6Address("2001:658:22a:cafe::1"),
1248         ]
1249         str_args = "2001:658:22a:cafe::/127"
1250         tpl_args = ("2001:658:22a:cafe::", 127)
1251         self.assertEqual(addrs, list(ipaddress.ip_network(str_args).hosts()))
1252         self.assertEqual(addrs, list(ipaddress.ip_network(tpl_args).hosts()))
1253         self.assertEqual(
1254             list(ipaddress.ip_network(str_args).hosts()),
1255             list(ipaddress.ip_network(tpl_args).hosts()),
1256         )
1257         addrs = [
1258             ipaddress.IPv6Address("2001:658:22a:cafe::1"),
1259         ]
1260         str_args = "2001:658:22a:cafe::1/128"
1261         tpl_args = ("2001:658:22a:cafe::1", 128)
1262         self.assertEqual(addrs, list(ipaddress.ip_network(str_args).hosts()))
1263         self.assertEqual(addrs, list(ipaddress.ip_network(tpl_args).hosts()))
1264         self.assertEqual(
1265             list(ipaddress.ip_network(str_args).hosts()),
1266             list(ipaddress.ip_network(tpl_args).hosts()),
1267         )
1268     def testFancySubnetting(self):
1269         self.assertEqual(
1270             sorted(self.ipv4_network.subnets(prefixlen_diff=3)),
1271             sorted(self.ipv4_network.subnets(new_prefix=27)),
1272         )
1273         self.assertRaises(ValueError, list, self.ipv4_network.subnets(new_prefix=23))
1274         self.assertRaises(
1275             ValueError, list, self.ipv4_network.subnets(prefixlen_diff=3, new_prefix=27)
1276         )
1277         self.assertEqual(
1278             sorted(self.ipv6_network.subnets(prefixlen_diff=4)),
1279             sorted(self.ipv6_network.subnets(new_prefix=68)),
1280         )
1281         self.assertRaises(ValueError, list, self.ipv6_network.subnets(new_prefix=63))
1282         self.assertRaises(
1283             ValueError, list, self.ipv6_network.subnets(prefixlen_diff=4, new_prefix=68)
1284         )
1285         self.assertEqual(
1286             sorted(self.ipv6_scoped_network.subnets(prefixlen_diff=4)),
1287             sorted(self.ipv6_scoped_network.subnets(new_prefix=68)),
1288         )
1289         self.assertRaises(
1290             ValueError, list, self.ipv6_scoped_network.subnets(new_prefix=63)
1291         )
1292         self.assertRaises(
1293             ValueError,
1294             list,
1295             self.ipv6_scoped_network.subnets(prefixlen_diff=4, new_prefix=68),
1296         )
1297     def testGetSubnets(self):
1298         self.assertEqual(list(self.ipv4_network.subnets())[0].prefixlen, 25)
1299         self.assertEqual(
1300             str(list(self.ipv4_network.subnets())[0].network_address), "1.2.3.0"
1301         )
1302         self.assertEqual(
1303             str(list(self.ipv4_network.subnets())[1].network_address), "1.2.3.128"
1304         )
1305         self.assertEqual(list(self.ipv6_network.subnets())[0].prefixlen, 65)
1306         self.assertEqual(list(self.ipv6_scoped_network.subnets())[0].prefixlen, 65)
1307     def testGetSubnetForSingle32(self):
1308         ip = ipaddress.IPv4Network("1.2.3.4/32")
1309         subnets1 = [str(x) for x in ip.subnets()]
1310         subnets2 = [str(x) for x in ip.subnets(2)]
1311         self.assertEqual(subnets1, ["1.2.3.4/32"])
1312         self.assertEqual(subnets1, subnets2)
1313     def testGetSubnetForSingle128(self):
1314         ip = ipaddress.IPv6Network("::1/128")
1315         subnets1 = [str(x) for x in ip.subnets()]
1316         subnets2 = [str(x) for x in ip.subnets(2)]
1317         self.assertEqual(subnets1, ["::1/128"])
1318         self.assertEqual(subnets1, subnets2)
1319         ip_scoped = ipaddress.IPv6Network("::1%scope/128")
1320         subnets1 = [str(x) for x in ip_scoped.subnets()]
1321         subnets2 = [str(x) for x in ip_scoped.subnets(2)]
1322         self.assertEqual(subnets1, ["::1%scope/128"])
1323         self.assertEqual(subnets1, subnets2)
1324     def testSubnet2(self):
1325         ips = [str(x) for x in self.ipv4_network.subnets(2)]
1326         self.assertEqual(
1327             ips, ["1.2.3.0/26", "1.2.3.64/26", "1.2.3.128/26", "1.2.3.192/26"]
1328         )
1329         ipsv6 = [str(x) for x in self.ipv6_network.subnets(2)]
1330         self.assertEqual(
1331             ipsv6,
1332             [
1333                 "2001:658:22a:cafe::/66",
1334                 "2001:658:22a:cafe:4000::/66",
1335                 "2001:658:22a:cafe:8000::/66",
1336                 "2001:658:22a:cafe:c000::/66",
1337             ],
1338         )
1339     def testGetSubnets3(self):
1340         subnets = [str(x) for x in self.ipv4_network.subnets(8)]
1341         self.assertEqual(subnets[:3], ["1.2.3.0/32", "1.2.3.1/32", "1.2.3.2/32"])
1342         self.assertEqual(subnets[-3:], ["1.2.3.253/32", "1.2.3.254/32", "1.2.3.255/32"])
1343         self.assertEqual(len(subnets), 256)
1344         ipv6_network = ipaddress.IPv6Network("2001:658:22a:cafe::/120")
1345         subnets = [str(x) for x in ipv6_network.subnets(8)]
1346         self.assertEqual(
1347             subnets[:3],
1348             [
1349                 "2001:658:22a:cafe::/128",
1350                 "2001:658:22a:cafe::1/128",
1351                 "2001:658:22a:cafe::2/128",
1352             ],
1353         )
1354         self.assertEqual(
1355             subnets[-3:],
1356             [
1357                 "2001:658:22a:cafe::fd/128",
1358                 "2001:658:22a:cafe::fe/128",
1359                 "2001:658:22a:cafe::ff/128",
1360             ],
1361         )
1362         self.assertEqual(len(subnets), 256)
1363     def testSubnetFailsForLargeCidrDiff(self):
1364         self.assertRaises(ValueError, list, self.ipv4_interface.network.subnets(9))
1365         self.assertRaises(ValueError, list, self.ipv4_network.subnets(9))
1366         self.assertRaises(ValueError, list, self.ipv6_interface.network.subnets(65))
1367         self.assertRaises(ValueError, list, self.ipv6_network.subnets(65))
1368         self.assertRaises(
1369             ValueError, list, self.ipv6_scoped_interface.network.subnets(65)
1370         )
1371         self.assertRaises(ValueError, list, self.ipv6_scoped_network.subnets(65))
1372     def testSupernetFailsForLargeCidrDiff(self):
1373         self.assertRaises(ValueError, self.ipv4_interface.network.supernet, 25)
1374         self.assertRaises(ValueError, self.ipv6_interface.network.supernet, 65)
1375         self.assertRaises(ValueError, self.ipv6_scoped_interface.network.supernet, 65)
1376     def testSubnetFailsForNegativeCidrDiff(self):
1377         self.assertRaises(ValueError, list, self.ipv4_interface.network.subnets(-1))
1378         self.assertRaises(ValueError, list, self.ipv4_network.subnets(-1))
1379         self.assertRaises(ValueError, list, self.ipv6_interface.network.subnets(-1))
1380         self.assertRaises(ValueError, list, self.ipv6_network.subnets(-1))
1381         self.assertRaises(
1382             ValueError, list, self.ipv6_scoped_interface.network.subnets(-1)
1383         )
1384         self.assertRaises(ValueError, list, self.ipv6_scoped_network.subnets(-1))
1385     def testGetNum_Addresses(self):
1386         self.assertEqual(self.ipv4_network.num_addresses, 256)
1387         self.assertEqual(list(self.ipv4_network.subnets())[0].num_addresses, 128)
1388         self.assertEqual(self.ipv4_network.supernet().num_addresses, 512)
1389         self.assertEqual(self.ipv6_network.num_addresses, 18446744073709551616)
1390         self.assertEqual(
1391             list(self.ipv6_network.subnets())[0].num_addresses, 9223372036854775808
1392         )
1393         self.assertEqual(
1394             self.ipv6_network.supernet().num_addresses, 36893488147419103232
1395         )
1396         self.assertEqual(self.ipv6_scoped_network.num_addresses, 18446744073709551616)
1397         self.assertEqual(
1398             list(self.ipv6_scoped_network.subnets())[0].num_addresses,
1399             9223372036854775808,
1400         )
1401         self.assertEqual(
1402             self.ipv6_scoped_network.supernet().num_addresses, 36893488147419103232
1403         )
1404     def testContains(self):
1405         self.assertIn(ipaddress.IPv4Interface("1.2.3.128/25"), self.ipv4_network)
1406         self.assertNotIn(ipaddress.IPv4Interface("1.2.4.1/24"), self.ipv4_network)
1407         addr1 = ipaddress.IPv4Address("1.2.3.37")
1408         self.assertIn(addr1, self.ipv4_network)
1409         self.assertFalse(
1410             ipaddress.IPv4Network("1.1.0.0/16").__contains__(
1411                 ipaddress.IPv4Network("1.0.0.0/15")
1412             )
1413         )
1414     def testNth(self):
1415         self.assertEqual(str(self.ipv4_network[5]), "1.2.3.5")
1416         self.assertRaises(IndexError, self.ipv4_network.__getitem__, 256)
1417         self.assertEqual(str(self.ipv6_network[5]), "2001:658:22a:cafe::5")
1418         self.assertRaises(IndexError, self.ipv6_network.__getitem__, 1 &lt;&lt; 64)
1419         self.assertEqual(str(self.ipv6_scoped_network[5]), "2001:658:22a:cafe::5")
1420         self.assertRaises(IndexError, self.ipv6_scoped_network.__getitem__, 1 &lt;&lt; 64)
1421     def testGetitem(self):
1422         addr = ipaddress.IPv4Network("172.31.255.128/255.255.255.240")
1423         self.assertEqual(28, addr.prefixlen)
1424         addr_list = list(addr)
1425         self.assertEqual("172.31.255.128", str(addr_list[0]))
1426         self.assertEqual("172.31.255.128", str(addr[0]))
1427         self.assertEqual("172.31.255.143", str(addr_list[-1]))
1428         self.assertEqual("172.31.255.143", str(addr[-1]))
1429         self.assertEqual(addr_list[-1], addr[-1])
1430     def testEqual(self):
1431         self.assertTrue(self.ipv4_interface == ipaddress.IPv4Interface("1.2.3.4/24"))
1432         self.assertFalse(self.ipv4_interface == ipaddress.IPv4Interface("1.2.3.4/23"))
1433         self.assertFalse(self.ipv4_interface == ipaddress.IPv6Interface("::1.2.3.4/24"))
1434         self.assertFalse(
1435             self.ipv4_interface == ipaddress.IPv6Interface("::1.2.3.4%scope/24")
1436         )
1437         self.assertFalse(self.ipv4_interface == "")
1438         self.assertFalse(self.ipv4_interface == [])
1439         self.assertFalse(self.ipv4_interface == 2)
1440         self.assertTrue(
1441             self.ipv6_interface
1442             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/64")
1443         )
1444         self.assertFalse(
1445             self.ipv6_interface
1446             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/63")
1447         )
1448         self.assertFalse(self.ipv6_interface == ipaddress.IPv4Interface("1.2.3.4/23"))
1449         self.assertFalse(self.ipv6_interface == "")
1450         self.assertFalse(self.ipv6_interface == [])
1451         self.assertFalse(self.ipv6_interface == 2)
1452         self.assertTrue(
1453             self.ipv6_scoped_interface
1454             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1%scope/64")
1455         )
1456         self.assertFalse(
1457             self.ipv6_scoped_interface
1458             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1%scope/63")
1459         )
1460         self.assertFalse(
1461             self.ipv6_scoped_interface
1462             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/64")
1463         )
1464         self.assertFalse(
1465             self.ipv6_scoped_interface
1466             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/63")
1467         )
1468         self.assertFalse(
1469             self.ipv6_scoped_interface == ipaddress.IPv4Interface("1.2.3.4/23")
1470         )
1471         self.assertFalse(self.ipv6_scoped_interface == "")
1472         self.assertFalse(self.ipv6_scoped_interface == [])
1473         self.assertFalse(self.ipv6_scoped_interface == 2)
1474     def testNotEqual(self):
1475         self.assertFalse(self.ipv4_interface != ipaddress.IPv4Interface("1.2.3.4/24"))
1476         self.assertTrue(self.ipv4_interface != ipaddress.IPv4Interface("1.2.3.4/23"))
1477         self.assertTrue(self.ipv4_interface != ipaddress.IPv6Interface("::1.2.3.4/24"))
1478         self.assertTrue(
1479             self.ipv4_interface != ipaddress.IPv6Interface("::1.2.3.4%scope/24")
1480         )
1481         self.assertTrue(self.ipv4_interface != "")
1482         self.assertTrue(self.ipv4_interface != [])
1483         self.assertTrue(self.ipv4_interface != 2)
1484         self.assertTrue(self.ipv4_address != ipaddress.IPv4Address("1.2.3.5"))
1485         self.assertTrue(self.ipv4_address != "")
1486         self.assertTrue(self.ipv4_address != [])
1487         self.assertTrue(self.ipv4_address != 2)
1488         self.assertFalse(
1489             self.ipv6_interface
1490             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/64")
1491         )
1492         self.assertTrue(
1493             self.ipv6_interface
1494             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/63")
1495         )
1496         self.assertTrue(self.ipv6_interface != ipaddress.IPv4Interface("1.2.3.4/23"))
1497         self.assertTrue(self.ipv6_interface != "")
1498         self.assertTrue(self.ipv6_interface != [])
1499         self.assertTrue(self.ipv6_interface != 2)
1500         self.assertTrue(self.ipv6_address != ipaddress.IPv4Address("1.2.3.4"))
1501         self.assertTrue(self.ipv6_address != "")
1502         self.assertTrue(self.ipv6_address != [])
1503         self.assertTrue(self.ipv6_address != 2)
1504         self.assertFalse(
1505             self.ipv6_scoped_interface
1506             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1%scope/64")
1507         )
1508         self.assertTrue(
1509             self.ipv6_scoped_interface
1510             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1%scope/63")
1511         )
1512         self.assertTrue(
1513             self.ipv6_scoped_interface
1514             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/64")
1515         )
1516         self.assertTrue(
1517             self.ipv6_scoped_interface
1518             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/63")
1519         )
1520         self.assertTrue(
1521             self.ipv6_scoped_interface != ipaddress.IPv4Interface("1.2.3.4/23")
1522         )
1523         self.assertTrue(self.ipv6_scoped_interface != "")
1524         self.assertTrue(self.ipv6_scoped_interface != [])
1525         self.assertTrue(self.ipv6_scoped_interface != 2)
1526         self.assertTrue(self.ipv6_scoped_address != ipaddress.IPv4Address("1.2.3.4"))
1527         self.assertTrue(self.ipv6_scoped_address != "")
1528         self.assertTrue(self.ipv6_scoped_address != [])
1529         self.assertTrue(self.ipv6_scoped_address != 2)
1530     def testSlash32Constructor(self):
1531         self.assertEqual(
1532             str(ipaddress.IPv4Interface("1.2.3.4/255.255.255.255")), "1.2.3.4/32"
1533         )
1534     def testSlash128Constructor(self):
1535         self.assertEqual(str(ipaddress.IPv6Interface("::1/128")), "::1/128")
1536         self.assertEqual(str(ipaddress.IPv6Interface("::1%scope/128")), "::1%scope/128")
1537     def testSlash0Constructor(self):
1538         self.assertEqual(str(ipaddress.IPv4Interface("1.2.3.4/0.0.0.0")), "1.2.3.4/0")
1539     def testCollapsing(self):
1540         ip1 = ipaddress.IPv4Address("1.1.1.0")
1541         ip2 = ipaddress.IPv4Address("1.1.1.1")
1542         ip3 = ipaddress.IPv4Address("1.1.1.2")
1543         ip4 = ipaddress.IPv4Address("1.1.1.3")
1544         ip5 = ipaddress.IPv4Address("1.1.1.4")
1545         ip6 = ipaddress.IPv4Address("1.1.1.0")
1546         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3, ip4, ip5, ip6])
1547         self.assertEqual(
1548             list(collapsed),
1549             [ipaddress.IPv4Network("1.1.1.0/30"), ipaddress.IPv4Network("1.1.1.4/32")],
1550         )
1551         ip1 = ipaddress.IPv4Address("1.1.1.0")
1552         ip2 = ipaddress.IPv4Address("1.1.1.1")
1553         ip3 = ipaddress.IPv4Address("1.1.1.2")
1554         ip4 = ipaddress.IPv4Address("1.1.1.3")
1555         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3, ip4])
1556         self.assertEqual(list(collapsed), [ipaddress.IPv4Network("1.1.1.0/30")])
1557         ip1 = ipaddress.IPv4Network("1.1.0.0/24")
1558         ip2 = ipaddress.IPv4Network("1.1.1.0/24")
1559         ip3 = ipaddress.IPv4Network("1.1.2.0/24")
1560         ip4 = ipaddress.IPv4Network("1.1.3.0/24")
1561         ip5 = ipaddress.IPv4Network("1.1.4.0/24")
1562         ip6 = ipaddress.IPv4Network("1.1.0.0/22")
1563         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3, ip4, ip5, ip6])
1564         self.assertEqual(
1565             list(collapsed),
1566             [ipaddress.IPv4Network("1.1.0.0/22"), ipaddress.IPv4Network("1.1.4.0/24")],
1567         )
1568         collapsed = ipaddress.collapse_addresses([ip1, ip2])
1569         self.assertEqual(list(collapsed), [ipaddress.IPv4Network("1.1.0.0/23")])
1570         ip_same1 = ip_same2 = ipaddress.IPv4Network("1.1.1.1/32")
1571         self.assertEqual(
1572             list(ipaddress.collapse_addresses([ip_same1, ip_same2])), [ip_same1]
1573         )
1574         ip_same1 = ip_same2 = ipaddress.IPv4Address("1.1.1.1")
1575         self.assertEqual(
1576             list(ipaddress.collapse_addresses([ip_same1, ip_same2])),
1577             [ipaddress.ip_network("1.1.1.1/32")],
1578         )
1579         ip1 = ipaddress.IPv6Network("2001::/100")
1580         ip2 = ipaddress.IPv6Network("2001::/120")
1581         ip3 = ipaddress.IPv6Network("2001::/96")
1582         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3])
1583         self.assertEqual(list(collapsed), [ip3])
1584         ip1 = ipaddress.IPv6Network("2001::%scope/100")
1585         ip2 = ipaddress.IPv6Network("2001::%scope/120")
1586         ip3 = ipaddress.IPv6Network("2001::%scope/96")
1587         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3])
1588         self.assertEqual(list(collapsed), [ip3])
1589         addr_tuples = [
1590             (ipaddress.ip_address("1.1.1.1"), ipaddress.ip_address("::1")),
1591             (ipaddress.IPv4Network("1.1.0.0/24"), ipaddress.IPv6Network("2001::/120")),
1592             (ipaddress.IPv4Network("1.1.0.0/32"), ipaddress.IPv6Network("2001::/128")),
1593         ]
1594         for ip1, ip2 in addr_tuples:
1595             self.assertRaises(TypeError, ipaddress.collapse_addresses, [ip1, ip2])
1596         addr_tuples = [
1597             (ipaddress.ip_address("1.1.1.1"), ipaddress.ip_address("::1%scope")),
1598             (
1599                 ipaddress.IPv4Network("1.1.0.0/24"),
1600                 ipaddress.IPv6Network("2001::%scope/120"),
1601             ),
1602             (
1603                 ipaddress.IPv4Network("1.1.0.0/32"),
1604                 ipaddress.IPv6Network("2001::%scope/128"),
1605             ),
1606         ]
1607         for ip1, ip2 in addr_tuples:
1608             self.assertRaises(TypeError, ipaddress.collapse_addresses, [ip1, ip2])
1609     def testSummarizing(self):
1610         summarize = ipaddress.summarize_address_range
1611         ip1 = ipaddress.ip_address("1.1.1.0")
1612         ip2 = ipaddress.ip_address("1.1.1.255")
1613         class IPv7Address(ipaddress.IPv6Address):
1614             @property
1615             def version(self):
1616                 return 7
1617         ip_invalid1 = IPv7Address("::1")
1618         ip_invalid2 = IPv7Address("::1")
1619         self.assertRaises(ValueError, list, summarize(ip_invalid1, ip_invalid2))
1620         self.assertRaises(TypeError, list, summarize(ip1, ipaddress.IPv6Address("::1")))
1621         self.assertRaises(
1622             TypeError, list, summarize(ip1, ipaddress.IPv6Address("::1%scope"))
1623         )
1624         self.assertEqual(
1625             list(summarize(ip1, ip2))[0], ipaddress.ip_network("1.1.1.0/24")
1626         )
1627         ip2 = ipaddress.ip_address("1.1.1.8")
1628         self.assertEqual(
1629             list(summarize(ip1, ip2)),
1630             [ipaddress.ip_network("1.1.1.0/29"), ipaddress.ip_network("1.1.1.8")],
1631         )
1632         ip1 = ipaddress.IPv4Address(0)
1633         ip2 = ipaddress.IPv4Address(ipaddress.IPv4Address._ALL_ONES)
1634         self.assertEqual(
1635             [ipaddress.IPv4Network("0.0.0.0/0")], list(summarize(ip1, ip2))
1636         )
1637         ip1 = ipaddress.ip_address("1::")
1638         ip2 = ipaddress.ip_address("1:ffff:ffff:ffff:ffff:ffff:ffff:ffff")
1639         self.assertEqual(list(summarize(ip1, ip2))[0], ipaddress.ip_network("1::/16"))
1640         ip2 = ipaddress.ip_address("2::")
1641         self.assertEqual(
1642             list(summarize(ip1, ip2)),
1643             [ipaddress.ip_network("1::/16"), ipaddress.ip_network("2::/128")],
1644         )
1645         ip1 = ipaddress.ip_address("1::%scope")
1646         ip2 = ipaddress.ip_address("1:ffff:ffff:ffff:ffff:ffff:ffff:ffff%scope")
1647         self.assertEqual(list(summarize(ip1, ip2))[0], ipaddress.ip_network("1::/16"))
1648         ip2 = ipaddress.ip_address("2::%scope")
1649         self.assertEqual(
1650             list(summarize(ip1, ip2)),
1651             [ipaddress.ip_network("1::/16"), ipaddress.ip_network("2::/128")],
1652         )
1653         self.assertRaises(
1654             ValueError,
1655             list,
1656             summarize(ipaddress.ip_address("1.1.1.0"), ipaddress.ip_address("1.1.0.0")),
1657         )
1658         self.assertRaises(
1659             TypeError,
1660             list,
1661             summarize(ipaddress.ip_network("1.1.1.0"), ipaddress.ip_network("1.1.0.0")),
1662         )
1663         self.assertRaises(
1664             TypeError,
1665             list,
1666             summarize(ipaddress.ip_network("1.1.1.0"), ipaddress.ip_network("1.1.0.0")),
1667         )
1668         self.assertRaises(
1669             TypeError,
1670             list,
1671             summarize(ipaddress.ip_address("::"), ipaddress.ip_network("1.1.0.0")),
1672         )
1673     def testAddressComparison(self):
1674         self.assertTrue(
1675             ipaddress.ip_address("1.1.1.1") &lt;= ipaddress.ip_address("1.1.1.1")
1676         )
1677         self.assertTrue(
1678             ipaddress.ip_address("1.1.1.1") &lt;= ipaddress.ip_address("1.1.1.2")
1679         )
1680         self.assertTrue(ipaddress.ip_address("::1") &lt;= ipaddress.ip_address("::1"))
1681         self.assertTrue(ipaddress.ip_address("::1") &lt;= ipaddress.ip_address("::2"))
1682         self.assertTrue(
1683             ipaddress.ip_address("::1%scope") &lt;= ipaddress.ip_address("::1%scope")
1684         )
1685         self.assertTrue(
1686             ipaddress.ip_address("::1%scope") &lt;= ipaddress.ip_address("::2%scope")
1687         )
1688     def testInterfaceComparison(self):
1689         self.assertTrue(
1690             ipaddress.ip_interface("1.1.1.1/24") == ipaddress.ip_interface("1.1.1.1/24")
1691         )
1692         self.assertTrue(
1693             ipaddress.ip_interface("1.1.1.1/16") &lt; ipaddress.ip_interface("1.1.1.1/24")
1694         )
1695         self.assertTrue(
1696             ipaddress.ip_interface("1.1.1.1/24") &lt; ipaddress.ip_interface("1.1.1.2/24")
1697         )
1698         self.assertTrue(
1699             ipaddress.ip_interface("1.1.1.2/16") &lt; ipaddress.ip_interface("1.1.1.1/24")
1700         )
1701         self.assertTrue(
1702             ipaddress.ip_interface("1.1.1.1/24") &gt; ipaddress.ip_interface("1.1.1.1/16")
1703         )
1704         self.assertTrue(
1705             ipaddress.ip_interface("1.1.1.2/24") &gt; ipaddress.ip_interface("1.1.1.1/24")
1706         )
1707         self.assertTrue(
1708             ipaddress.ip_interface("1.1.1.1/24") &gt; ipaddress.ip_interface("1.1.1.2/16")
1709         )
1710         self.assertTrue(
1711             ipaddress.ip_interface("::1/64") == ipaddress.ip_interface("::1/64")
1712         )
1713         self.assertTrue(
1714             ipaddress.ip_interface("::1/64") &lt; ipaddress.ip_interface("::1/80")
1715         )
1716         self.assertTrue(
1717             ipaddress.ip_interface("::1/64") &lt; ipaddress.ip_interface("::2/64")
1718         )
1719         self.assertTrue(
1720             ipaddress.ip_interface("::2/48") &lt; ipaddress.ip_interface("::1/64")
1721         )
1722         self.assertTrue(
1723             ipaddress.ip_interface("::1/80") &gt; ipaddress.ip_interface("::1/64")
1724         )
1725         self.assertTrue(
1726             ipaddress.ip_interface("::2/64") &gt; ipaddress.ip_interface("::1/64")
1727         )
1728         self.assertTrue(
1729             ipaddress.ip_interface("::1/64") &gt; ipaddress.ip_interface("::2/48")
1730         )
1731         self.assertTrue(
1732             ipaddress.ip_interface("::1%scope/64")
1733             == ipaddress.ip_interface("::1%scope/64")
1734         )
1735         self.assertTrue(
1736             ipaddress.ip_interface("::1%scope/64")
1737             &lt; ipaddress.ip_interface("::1%scope/80")
1738         )
1739         self.assertTrue(
1740             ipaddress.ip_interface("::1%scope/64")
1741             &lt; ipaddress.ip_interface("::2%scope/64")
1742         )
1743         self.assertTrue(
1744             ipaddress.ip_interface("::2%scope/48")
1745             &lt; ipaddress.ip_interface("::1%scope/64")
1746         )
1747         self.assertTrue(
1748             ipaddress.ip_interface("::1%scope/80")
1749             &gt; ipaddress.ip_interface("::1%scope/64")
1750         )
1751         self.assertTrue(
1752             ipaddress.ip_interface("::2%scope/64")
1753             &gt; ipaddress.ip_interface("::1%scope/64")
1754         )
1755         self.assertTrue(
1756             ipaddress.ip_interface("::1%scope/64")
1757             &gt; ipaddress.ip_interface("::2%scope/48")
1758         )
1759         self.assertFalse(
1760             ipaddress.ip_interface("::1%scope/64") == ipaddress.ip_interface("::1/64")
1761         )
1762         self.assertTrue(
1763             ipaddress.ip_interface("::1%scope/64") &lt; ipaddress.ip_interface("::1/80")
1764         )
1765         self.assertTrue(
1766             ipaddress.ip_interface("::1%scope/64") &lt; ipaddress.ip_interface("::2/64")
1767         )
1768         self.assertTrue(
1769             ipaddress.ip_interface("::2%scope/48") &lt; ipaddress.ip_interface("::1/64")
1770         )
1771         self.assertTrue(
1772             ipaddress.ip_interface("::1%scope/80") &gt; ipaddress.ip_interface("::1/64")
1773         )
1774         self.assertTrue(
1775             ipaddress.ip_interface("::2%scope/64") &gt; ipaddress.ip_interface("::1/64")
1776         )
1777         self.assertTrue(
1778             ipaddress.ip_interface("::1%scope/64") &gt; ipaddress.ip_interface("::2/48")
1779         )
1780         self.assertFalse(
1781             ipaddress.ip_interface("::1/64") == ipaddress.ip_interface("::1%scope/64")
1782         )
1783         self.assertTrue(
1784             ipaddress.ip_interface("::1/64") &lt; ipaddress.ip_interface("::1%scope/80")
1785         )
1786         self.assertTrue(
1787             ipaddress.ip_interface("::1/64") &lt; ipaddress.ip_interface("::2%scope/64")
1788         )
1789         self.assertTrue(
1790             ipaddress.ip_interface("::2/48") &lt; ipaddress.ip_interface("::1%scope/64")
1791         )
1792         self.assertTrue(
1793             ipaddress.ip_interface("::1/80") &gt; ipaddress.ip_interface("::1%scope/64")
1794         )
1795         self.assertTrue(
1796             ipaddress.ip_interface("::2/64") &gt; ipaddress.ip_interface("::1%scope/64")
1797         )
1798         self.assertTrue(
1799             ipaddress.ip_interface("::1/64") &gt; ipaddress.ip_interface("::2%scope/48")
1800         )
1801     def testNetworkComparison(self):
1802         ip1 = ipaddress.IPv4Network("1.1.1.0/24")
1803         ip2 = ipaddress.IPv4Network("1.1.1.0/32")
1804         ip3 = ipaddress.IPv4Network("1.1.2.0/24")
1805         self.assertTrue(ip1 &lt; ip3)
1806         self.assertTrue(ip3 &gt; ip2)
1807         self.assertEqual(ip1.compare_networks(ip1), 0)
1808         self.assertEqual(ip1.compare_networks(ip2), -1)
1809         self.assertEqual(ip2.compare_networks(ip1), 1)
1810         self.assertEqual(ip1.compare_networks(ip3), -1)
1811         self.assertEqual(ip3.compare_networks(ip1), 1)
1812         self.assertTrue(ip1._get_networks_key() &lt; ip3._get_networks_key())
1813         ip1 = ipaddress.IPv6Network("2001:2000::/96")
1814         ip2 = ipaddress.IPv6Network("2001:2001::/96")
1815         ip3 = ipaddress.IPv6Network("2001:ffff:2000::/96")
1816         self.assertTrue(ip1 &lt; ip3)
1817         self.assertTrue(ip3 &gt; ip2)
1818         self.assertEqual(ip1.compare_networks(ip3), -1)
1819         self.assertTrue(ip1._get_networks_key() &lt; ip3._get_networks_key())
1820         self.assertRaises(
1821             TypeError, self.ipv4_network.compare_networks, self.ipv6_network
1822         )
1823         ipv6 = ipaddress.IPv6Interface("::/0")
1824         ipv4 = ipaddress.IPv4Interface("0.0.0.0/0")
1825         self.assertRaises(TypeError, ipv4.__lt__, ipv6)
1826         self.assertRaises(TypeError, ipv4.__gt__, ipv6)
1827         self.assertRaises(TypeError, ipv6.__lt__, ipv4)
1828         self.assertRaises(TypeError, ipv6.__gt__, ipv4)
1829         ip1 = ipaddress.ip_network("10.1.2.128/25")
1830         self.assertFalse(ip1 &lt; ip1)
1831         self.assertFalse(ip1 &gt; ip1)
1832         ip2 = ipaddress.ip_network("10.1.3.0/24")
1833         self.assertTrue(ip1 &lt; ip2)
1834         self.assertFalse(ip2 &lt; ip1)
1835         self.assertFalse(ip1 &gt; ip2)
1836         self.assertTrue(ip2 &gt; ip1)
1837         ip3 = ipaddress.ip_network("10.1.3.0/25")
1838         self.assertTrue(ip2 &lt; ip3)
1839         self.assertFalse(ip3 &lt; ip2)
1840         self.assertFalse(ip2 &gt; ip3)
1841         self.assertTrue(ip3 &gt; ip2)
1842         ip1 = ipaddress.ip_network("10.10.10.0/31")
1843         ip2 = ipaddress.ip_network("10.10.10.0")
1844         ip3 = ipaddress.ip_network("10.10.10.2/31")
1845         ip4 = ipaddress.ip_network("10.10.10.2")
1846         sorted = [ip1, ip2, ip3, ip4]
1847         unsorted = [ip2, ip4, ip1, ip3]
1848         unsorted.sort()
1849         self.assertEqual(sorted, unsorted)
1850         unsorted = [ip4, ip1, ip3, ip2]
1851         unsorted.sort()
1852         self.assertEqual(sorted, unsorted)
1853         self.assertIs(ip1.__lt__(ipaddress.ip_address("10.10.10.0")), NotImplemented)
1854         self.assertIs(ip2.__lt__(ipaddress.ip_address("10.10.10.0")), NotImplemented)
1855         self.assertTrue(
1856             ipaddress.ip_network("1.1.1.1") &lt;= ipaddress.ip_network("1.1.1.1")
1857         )
1858         self.assertTrue(
1859             ipaddress.ip_network("1.1.1.1") &lt;= ipaddress.ip_network("1.1.1.2")
1860         )
1861         self.assertFalse(
1862             ipaddress.ip_network("1.1.1.2") &lt;= ipaddress.ip_network("1.1.1.1")
1863         )
1864         self.assertTrue(ipaddress.ip_network("::1") &lt;= ipaddress.ip_network("::1"))
1865         self.assertTrue(ipaddress.ip_network("::1") &lt;= ipaddress.ip_network("::2"))
1866         self.assertFalse(ipaddress.ip_network("::2") &lt;= ipaddress.ip_network("::1"))
1867     def testStrictNetworks(self):
1868         self.assertRaises(ValueError, ipaddress.ip_network, "192.168.1.1/24")
1869         self.assertRaises(ValueError, ipaddress.ip_network, "::1/120")
1870         self.assertRaises(ValueError, ipaddress.ip_network, "::1%scope/120")
1871     def testOverlaps(self):
1872         other = ipaddress.IPv4Network("1.2.3.0/30")
1873         other2 = ipaddress.IPv4Network("1.2.2.0/24")
1874         other3 = ipaddress.IPv4Network("1.2.2.64/26")
1875         self.assertTrue(self.ipv4_network.overlaps(other))
1876         self.assertFalse(self.ipv4_network.overlaps(other2))
1877         self.assertTrue(other2.overlaps(other3))
1878     def testEmbeddedIpv4(self):
1879         ipv4_string = "192.168.0.1"
1880         ipv4 = ipaddress.IPv4Interface(ipv4_string)
1881         v4compat_ipv6 = ipaddress.IPv6Interface("::%s" % ipv4_string)
1882         self.assertEqual(int(v4compat_ipv6.ip), int(ipv4.ip))
1883         v4mapped_ipv6 = ipaddress.IPv6Interface("::ffff:%s" % ipv4_string)
1884         self.assertNotEqual(v4mapped_ipv6.ip, ipv4.ip)
1885         self.assertRaises(
1886             ipaddress.AddressValueError, ipaddress.IPv6Interface, "2001:1.1.1.1:1.1.1.1"
1887         )
1888     def testIPv6AddressTooLarge(self):
1889         self.assertEqual(
1890             ipaddress.ip_address("::FFFF:192.0.2.1"),
1891             ipaddress.ip_address("::FFFF:c000:201"),
1892         )
1893         self.assertEqual(
1894             ipaddress.ip_address("FFFF::192.0.2.1"),
1895             ipaddress.ip_address("FFFF::c000:201"),
1896         )
1897         self.assertEqual(
1898             ipaddress.ip_address("::FFFF:192.0.2.1%scope"),
1899             ipaddress.ip_address("::FFFF:c000:201%scope"),
1900         )
1901         self.assertEqual(
1902             ipaddress.ip_address("FFFF::192.0.2.1%scope"),
1903             ipaddress.ip_address("FFFF::c000:201%scope"),
1904         )
1905         self.assertNotEqual(
1906             ipaddress.ip_address("::FFFF:192.0.2.1%scope"),
1907             ipaddress.ip_address("::FFFF:c000:201"),
1908         )
1909         self.assertNotEqual(
1910             ipaddress.ip_address("FFFF::192.0.2.1%scope"),
1911             ipaddress.ip_address("FFFF::c000:201"),
1912         )
1913         self.assertNotEqual(
1914             ipaddress.ip_address("::FFFF:192.0.2.1"),
1915             ipaddress.ip_address("::FFFF:c000:201%scope"),
1916         )
1917         self.assertNotEqual(
1918             ipaddress.ip_address("FFFF::192.0.2.1"),
1919             ipaddress.ip_address("FFFF::c000:201%scope"),
1920         )
1921     def testIPVersion(self):
1922         self.assertEqual(self.ipv4_address.version, 4)
1923         self.assertEqual(self.ipv6_address.version, 6)
1924         self.assertEqual(self.ipv6_scoped_address.version, 6)
1925     def testMaxPrefixLength(self):
1926         self.assertEqual(self.ipv4_interface.max_prefixlen, 32)
1927         self.assertEqual(self.ipv6_interface.max_prefixlen, 128)
1928         self.assertEqual(self.ipv6_scoped_interface.max_prefixlen, 128)
1929     def testPacked(self):
1930         self.assertEqual(self.ipv4_address.packed, b"\x01\x02\x03\x04")
1931         self.assertEqual(
1932             ipaddress.IPv4Interface("255.254.253.252").packed, b"\xff\xfe\xfd\xfc"
1933         )
1934         self.assertEqual(
1935             self.ipv6_address.packed,
1936             b"\x20\x01\x06\x58\x02\x2a\xca\xfe\x02\x00\x00\x00\x00\x00\x00\x01",
1937         )
1938         self.assertEqual(
1939             ipaddress.IPv6Interface("ffff:2:3:4:ffff::").packed,
1940             b"\xff\xff\x00\x02\x00\x03\x00\x04\xff\xff" + b"\x00" * 6,
1941         )
1942         self.assertEqual(
1943             ipaddress.IPv6Interface("::1:0:0:0:0").packed,
1944             b"\x00" * 6 + b"\x00\x01" + b"\x00" * 8,
1945         )
1946         self.assertEqual(
1947             self.ipv6_scoped_address.packed,
1948             b"\x20\x01\x06\x58\x02\x2a\xca\xfe\x02\x00\x00\x00\x00\x00\x00\x01",
1949         )
1950         self.assertEqual(
1951             ipaddress.IPv6Interface("ffff:2:3:4:ffff::%scope").packed,
1952             b"\xff\xff\x00\x02\x00\x03\x00\x04\xff\xff" + b"\x00" * 6,
1953         )
1954         self.assertEqual(
1955             ipaddress.IPv6Interface("::1:0:0:0:0%scope").packed,
1956             b"\x00" * 6 + b"\x00\x01" + b"\x00" * 8,
1957         )
1958     def testIpType(self):
1959         ipv4net = ipaddress.ip_network("1.2.3.4")
1960         ipv4addr = ipaddress.ip_address("1.2.3.4")
1961         ipv6net = ipaddress.ip_network("::1.2.3.4")
1962         ipv6addr = ipaddress.ip_address("::1.2.3.4")
1963         self.assertEqual(ipaddress.IPv4Network, type(ipv4net))
1964         self.assertEqual(ipaddress.IPv4Address, type(ipv4addr))
1965         self.assertEqual(ipaddress.IPv6Network, type(ipv6net))
1966         self.assertEqual(ipaddress.IPv6Address, type(ipv6addr))
1967     def testReservedIpv4(self):
1968         self.assertEqual(True, ipaddress.ip_interface("224.1.1.1/31").is_multicast)
1969         self.assertEqual(False, ipaddress.ip_network("240.0.0.0").is_multicast)
1970         self.assertEqual(True, ipaddress.ip_network("240.0.0.0").is_reserved)
1971         self.assertEqual(True, ipaddress.ip_interface("192.168.1.1/17").is_private)
1972         self.assertEqual(False, ipaddress.ip_network("192.169.0.0").is_private)
1973         self.assertEqual(True, ipaddress.ip_network("10.255.255.255").is_private)
1974         self.assertEqual(False, ipaddress.ip_network("11.0.0.0").is_private)
1975         self.assertEqual(False, ipaddress.ip_network("11.0.0.0").is_reserved)
1976         self.assertEqual(True, ipaddress.ip_network("172.31.255.255").is_private)
1977         self.assertEqual(False, ipaddress.ip_network("172.32.0.0").is_private)
1978         self.assertEqual(True, ipaddress.ip_network("169.254.1.0/24").is_link_local)
1979         self.assertEqual(
1980             True, ipaddress.ip_interface("169.254.100.200/24").is_link_local
1981         )
1982         self.assertEqual(
1983             False, ipaddress.ip_interface("169.255.100.200/24").is_link_local
1984         )
1985         self.assertEqual(True, ipaddress.ip_network("127.100.200.254/32").is_loopback)
1986         self.assertEqual(True, ipaddress.ip_network("127.42.0.0/16").is_loopback)
1987         self.assertEqual(False, ipaddress.ip_network("128.0.0.0").is_loopback)
1988         self.assertEqual(False, ipaddress.ip_network("100.64.0.0/10").is_private)
1989         self.assertEqual(False, ipaddress.ip_network("100.64.0.0/10").is_global)
1990         self.assertEqual(True, ipaddress.ip_network("192.0.2.128/25").is_private)
1991         self.assertEqual(True, ipaddress.ip_network("192.0.3.0/24").is_global)
1992         self.assertEqual(True, ipaddress.ip_address("0.0.0.0").is_unspecified)
1993         self.assertEqual(True, ipaddress.ip_address("224.1.1.1").is_multicast)
1994         self.assertEqual(False, ipaddress.ip_address("240.0.0.0").is_multicast)
1995         self.assertEqual(True, ipaddress.ip_address("240.0.0.1").is_reserved)
1996         self.assertEqual(False, ipaddress.ip_address("239.255.255.255").is_reserved)
1997         self.assertEqual(True, ipaddress.ip_address("192.168.1.1").is_private)
1998         self.assertEqual(False, ipaddress.ip_address("192.169.0.0").is_private)
1999         self.assertEqual(True, ipaddress.ip_address("10.255.255.255").is_private)
2000         self.assertEqual(False, ipaddress.ip_address("11.0.0.0").is_private)
2001         self.assertEqual(True, ipaddress.ip_address("172.31.255.255").is_private)
2002         self.assertEqual(False, ipaddress.ip_address("172.32.0.0").is_private)
2003         self.assertEqual(True, ipaddress.ip_address("169.254.100.200").is_link_local)
2004         self.assertEqual(False, ipaddress.ip_address("169.255.100.200").is_link_local)
2005         self.assertTrue(ipaddress.ip_address("192.0.7.1").is_global)
2006         self.assertFalse(ipaddress.ip_address("203.0.113.1").is_global)
2007         self.assertEqual(True, ipaddress.ip_address("127.100.200.254").is_loopback)
2008         self.assertEqual(True, ipaddress.ip_address("127.42.0.0").is_loopback)
2009         self.assertEqual(False, ipaddress.ip_address("128.0.0.0").is_loopback)
2010         self.assertEqual(True, ipaddress.ip_network("0.0.0.0").is_unspecified)
2011     def testReservedIpv6(self):
2012         self.assertEqual(True, ipaddress.ip_network("ffff::").is_multicast)
2013         self.assertEqual(True, ipaddress.ip_network(2 ** 128 - 1).is_multicast)
2014         self.assertEqual(True, ipaddress.ip_network("ff00::").is_multicast)
2015         self.assertEqual(False, ipaddress.ip_network("fdff::").is_multicast)
2016         self.assertEqual(True, ipaddress.ip_network("fecf::").is_site_local)
2017         self.assertEqual(
2018             True, ipaddress.ip_network("feff:ffff:ffff:ffff::").is_site_local
2019         )
2020         self.assertEqual(False, ipaddress.ip_network("fbf:ffff::").is_site_local)
2021         self.assertEqual(False, ipaddress.ip_network("ff00::").is_site_local)
2022         self.assertEqual(True, ipaddress.ip_network("fc00::").is_private)
2023         self.assertEqual(True, ipaddress.ip_network("fc00:ffff:ffff:ffff::").is_private)
2024         self.assertEqual(False, ipaddress.ip_network("fbff:ffff::").is_private)
2025         self.assertEqual(False, ipaddress.ip_network("fe00::").is_private)
2026         self.assertEqual(True, ipaddress.ip_network("fea0::").is_link_local)
2027         self.assertEqual(True, ipaddress.ip_network("febf:ffff::").is_link_local)
2028         self.assertEqual(False, ipaddress.ip_network("fe7f:ffff::").is_link_local)
2029         self.assertEqual(False, ipaddress.ip_network("fec0::").is_link_local)
2030         self.assertEqual(True, ipaddress.ip_interface("0:0::0:01").is_loopback)
2031         self.assertEqual(False, ipaddress.ip_interface("::1/127").is_loopback)
2032         self.assertEqual(False, ipaddress.ip_network("::").is_loopback)
2033         self.assertEqual(False, ipaddress.ip_network("::2").is_loopback)
2034         self.assertEqual(True, ipaddress.ip_network("0::0").is_unspecified)
2035         self.assertEqual(False, ipaddress.ip_network("::1").is_unspecified)
2036         self.assertEqual(False, ipaddress.ip_network("::/127").is_unspecified)
2037         self.assertEqual(True, ipaddress.ip_network("2001::1/128").is_private)
2038         self.assertEqual(True, ipaddress.ip_network("200::1/128").is_global)
2039         self.assertEqual(True, ipaddress.ip_address("ffff::").is_multicast)
2040         self.assertEqual(True, ipaddress.ip_address(2 ** 128 - 1).is_multicast)
2041         self.assertEqual(True, ipaddress.ip_address("ff00::").is_multicast)
2042         self.assertEqual(False, ipaddress.ip_address("fdff::").is_multicast)
2043         self.assertEqual(True, ipaddress.ip_address("fecf::").is_site_local)
2044         self.assertEqual(
2045             True, ipaddress.ip_address("feff:ffff:ffff:ffff::").is_site_local
2046         )
2047         self.assertEqual(False, ipaddress.ip_address("fbf:ffff::").is_site_local)
2048         self.assertEqual(False, ipaddress.ip_address("ff00::").is_site_local)
2049         self.assertEqual(True, ipaddress.ip_address("fc00::").is_private)
2050         self.assertEqual(True, ipaddress.ip_address("fc00:ffff:ffff:ffff::").is_private)
2051         self.assertEqual(False, ipaddress.ip_address("fbff:ffff::").is_private)
2052         self.assertEqual(False, ipaddress.ip_address("fe00::").is_private)
2053         self.assertEqual(True, ipaddress.ip_address("fea0::").is_link_local)
2054         self.assertEqual(True, ipaddress.ip_address("febf:ffff::").is_link_local)
2055         self.assertEqual(False, ipaddress.ip_address("fe7f:ffff::").is_link_local)
2056         self.assertEqual(False, ipaddress.ip_address("fec0::").is_link_local)
2057         self.assertEqual(True, ipaddress.ip_address("0:0::0:01").is_loopback)
2058         self.assertEqual(True, ipaddress.ip_address("::1").is_loopback)
2059         self.assertEqual(False, ipaddress.ip_address("::2").is_loopback)
2060         self.assertEqual(True, ipaddress.ip_address("0::0").is_unspecified)
2061         self.assertEqual(False, ipaddress.ip_address("::1").is_unspecified)
2062         self.assertEqual(True, ipaddress.ip_address("100::").is_reserved)
2063         self.assertEqual(True, ipaddress.ip_network("4000::1/128").is_reserved)
2064     def testIpv4Mapped(self):
2065         self.assertEqual(
2066             ipaddress.ip_address("::ffff:192.168.1.1").ipv4_mapped,
2067             ipaddress.ip_address("192.168.1.1"),
2068         )
2069         self.assertEqual(ipaddress.ip_address("::c0a8:101").ipv4_mapped, None)
2070         self.assertEqual(
2071             ipaddress.ip_address("::ffff:c0a8:101").ipv4_mapped,
2072             ipaddress.ip_address("192.168.1.1"),
2073         )
2074     def testAddrExclude(self):
2075         addr1 = ipaddress.ip_network("10.1.1.0/24")
2076         addr2 = ipaddress.ip_network("10.1.1.0/26")
2077         addr3 = ipaddress.ip_network("10.2.1.0/24")
2078         addr4 = ipaddress.ip_address("10.1.1.0")
2079         addr5 = ipaddress.ip_network("2001:db8::0/32")
2080         addr6 = ipaddress.ip_network("10.1.1.5/32")
2081         self.assertEqual(
2082             sorted(list(addr1.address_exclude(addr2))),
2083             [
2084                 ipaddress.ip_network("10.1.1.64/26"),
2085                 ipaddress.ip_network("10.1.1.128/25"),
2086             ],
2087         )
2088         self.assertRaises(ValueError, list, addr1.address_exclude(addr3))
2089         self.assertRaises(TypeError, list, addr1.address_exclude(addr4))
2090         self.assertRaises(TypeError, list, addr1.address_exclude(addr5))
2091         self.assertEqual(list(addr1.address_exclude(addr1)), [])
2092         self.assertEqual(
2093             sorted(list(addr1.address_exclude(addr6))),
2094             [
2095                 ipaddress.ip_network("10.1.1.0/30"),
2096                 ipaddress.ip_network("10.1.1.4/32"),
2097                 ipaddress.ip_network("10.1.1.6/31"),
2098                 ipaddress.ip_network("10.1.1.8/29"),
2099                 ipaddress.ip_network("10.1.1.16/28"),
2100                 ipaddress.ip_network("10.1.1.32/27"),
2101                 ipaddress.ip_network("10.1.1.64/26"),
2102                 ipaddress.ip_network("10.1.1.128/25"),
2103             ],
2104         )
2105     def testHash(self):
2106         self.assertEqual(
2107             hash(ipaddress.ip_interface("10.1.1.0/24")),
2108             hash(ipaddress.ip_interface("10.1.1.0/24")),
2109         )
2110         self.assertEqual(
2111             hash(ipaddress.ip_network("10.1.1.0/24")),
2112             hash(ipaddress.ip_network("10.1.1.0/24")),
2113         )
2114         self.assertEqual(
2115             hash(ipaddress.ip_address("10.1.1.0")),
2116             hash(ipaddress.ip_address("10.1.1.0")),
2117         )
2118         self.assertEqual(
2119             hash(ipaddress.ip_address("1.2.3.4")),
2120             hash(ipaddress.ip_address(int(ipaddress.ip_address("1.2.3.4")._ip))),
2121         )
2122         ip1 = ipaddress.ip_address("10.1.1.0")
2123         ip2 = ipaddress.ip_address("1::")
2124         dummy = {}
2125         dummy[self.ipv4_address] = None
2126         dummy[self.ipv6_address] = None
2127         dummy[ip1] = None
2128         dummy[ip2] = None
2129         self.assertIn(self.ipv4_address, dummy)
2130         self.assertIn(ip2, dummy)
2131     def testIPBases(self):
2132         net = self.ipv4_network
2133         self.assertEqual("1.2.3.0/24", net.compressed)
2134         net = self.ipv6_network
2135         self.assertRaises(ValueError, net._string_from_ip_int, 2 ** 128 + 1)
2136     def testIPv6NetworkHelpers(self):
2137         net = self.ipv6_network
2138         self.assertEqual("2001:658:22a:cafe::/64", net.with_prefixlen)
2139         self.assertEqual("2001:658:22a:cafe::/ffff:ffff:ffff:ffff::", net.with_netmask)
2140         self.assertEqual("2001:658:22a:cafe::/::ffff:ffff:ffff:ffff", net.with_hostmask)
2141         self.assertEqual("2001:658:22a:cafe::/64", str(net))
2142     def testIPv4NetworkHelpers(self):
2143         net = self.ipv4_network
2144         self.assertEqual("1.2.3.0/24", net.with_prefixlen)
2145         self.assertEqual("1.2.3.0/255.255.255.0", net.with_netmask)
2146         self.assertEqual("1.2.3.0/0.0.0.255", net.with_hostmask)
2147         self.assertEqual("1.2.3.0/24", str(net))
2148     def testCopyConstructor(self):
2149         addr1 = ipaddress.ip_network("10.1.1.0/24")
2150         addr2 = ipaddress.ip_network(addr1)
2151         addr3 = ipaddress.ip_interface("2001:658:22a:cafe:200::1/64")
2152         addr4 = ipaddress.ip_interface(addr3)
2153         addr5 = ipaddress.IPv4Address("1.1.1.1")
2154         addr6 = ipaddress.IPv6Address("2001:658:22a:cafe:200::1")
2155         self.assertEqual(addr1, addr2)
2156         self.assertEqual(addr3, addr4)
2157         self.assertEqual(addr5, ipaddress.IPv4Address(addr5))
2158         self.assertEqual(addr6, ipaddress.IPv6Address(addr6))
2159     def testCompressIPv6Address(self):
2160         test_addresses = {
2161             "1:2:3:4:5:6:7:8": "1:2:3:4:5:6:7:8/128",
2162             "2001:0:0:4:0:0:0:8": "2001:0:0:4::8/128",
2163             "2001:0:0:4:5:6:7:8": "2001::4:5:6:7:8/128",
2164             "2001:0:3:4:5:6:7:8": "2001:0:3:4:5:6:7:8/128",
2165             "0:0:3:0:0:0:0:ffff": "0:0:3::ffff/128",
2166             "0:0:0:4:0:0:0:ffff": "::4:0:0:0:ffff/128",
2167             "0:0:0:0:5:0:0:ffff": "::5:0:0:ffff/128",
2168             "1:0:0:4:0:0:7:8": "1::4:0:0:7:8/128",
2169             "0:0:0:0:0:0:0:0": "::/128",
2170             "0:0:0:0:0:0:0:0/0": "::/0",
2171             "0:0:0:0:0:0:0:1": "::1/128",
2172             "2001:0658:022a:cafe:0000:0000:0000:0000/66": "2001:658:22a:cafe::/66",
2173             "::1.2.3.4": "::102:304/128",
2174             "1:2:3:4:5:ffff:1.2.3.4": "1:2:3:4:5:ffff:102:304/128",
2175             "::7:6:5:4:3:2:1": "0:7:6:5:4:3:2:1/128",
2176             "::7:6:5:4:3:2:0": "0:7:6:5:4:3:2:0/128",
2177             "7:6:5:4:3:2:1::": "7:6:5:4:3:2:1:0/128",
2178             "0:6:5:4:3:2:1::": "0:6:5:4:3:2:1:0/128",
2179         }
2180         for uncompressed, compressed in list(test_addresses.items()):
2181             self.assertEqual(compressed, str(ipaddress.IPv6Interface(uncompressed)))
2182     def testExplodeShortHandIpStr(self):
2183         addr1 = ipaddress.IPv6Interface("2001::1")
2184         addr2 = ipaddress.IPv6Address("2001:0:5ef5:79fd:0:59d:a0e5:ba1")
2185         addr3 = ipaddress.IPv6Network("2001::/96")
2186         addr4 = ipaddress.IPv4Address("192.168.178.1")
2187         self.assertEqual("2001:0000:0000:0000:0000:0000:0000:0001/128", addr1.exploded)
2188         self.assertEqual(
2189             "0000:0000:0000:0000:0000:0000:0000:0001/128",
2190             ipaddress.IPv6Interface("::1/128").exploded,
2191         )
2192         self.assertEqual("2001:0000:5ef5:79fd:0000:059d:a0e5:0ba1", addr2.exploded)
2193         self.assertEqual("2001:0000:0000:0000:0000:0000:0000:0000/96", addr3.exploded)
2194         self.assertEqual("192.168.178.1", addr4.exploded)
2195     def testReversePointer(self):
2196         addr1 = ipaddress.IPv4Address("127.0.0.1")
2197         addr2 = ipaddress.IPv6Address("2001:db8::1")
2198         self.assertEqual("1.0.0.127.in-addr.arpa", addr1.reverse_pointer)
2199         self.assertEqual(
2200             "1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8."
2201             + "b.d.0.1.0.0.2.ip6.arpa",
2202             addr2.reverse_pointer,
2203         )
2204     def testIntRepresentation(self):
2205         self.assertEqual(16909060, int(self.ipv4_address))
2206         self.assertEqual(42540616829182469433547762482097946625, int(self.ipv6_address))
2207     def testForceVersion(self):
2208         self.assertEqual(ipaddress.ip_network(1).version, 4)
2209         self.assertEqual(ipaddress.IPv6Network(1).version, 6)
2210     def testWithStar(self):
2211         self.assertEqual(self.ipv4_interface.with_prefixlen, "1.2.3.4/24")
2212         self.assertEqual(self.ipv4_interface.with_netmask, "1.2.3.4/255.255.255.0")
2213         self.assertEqual(self.ipv4_interface.with_hostmask, "1.2.3.4/0.0.0.255")
2214         self.assertEqual(
2215             self.ipv6_interface.with_prefixlen, "2001:658:22a:cafe:200::1/64"
2216         )
2217         self.assertEqual(
2218             self.ipv6_interface.with_netmask,
2219             "2001:658:22a:cafe:200::1/ffff:ffff:ffff:ffff::",
2220         )
2221         self.assertEqual(
2222             self.ipv6_interface.with_hostmask,
2223             "2001:658:22a:cafe:200::1/::ffff:ffff:ffff:ffff",
2224         )
2225     def testNetworkElementCaching(self):
2226         self.assertNotIn("broadcast_address", self.ipv4_network._cache)
2227         self.assertNotIn("hostmask", self.ipv4_network._cache)
2228         self.assertEqual(
2229             self.ipv4_network.broadcast_address, ipaddress.IPv4Address("1.2.3.255")
2230         )
2231         self.assertEqual(self.ipv4_network.hostmask, ipaddress.IPv4Address("0.0.0.255"))
2232         self.assertIn("broadcast_address", self.ipv4_network._cache)
2233         self.assertIn("hostmask", self.ipv4_network._cache)
2234         self.assertNotIn("broadcast_address", self.ipv6_network._cache)
2235         self.assertNotIn("hostmask", self.ipv6_network._cache)
2236         self.assertEqual(
2237             self.ipv6_network.network_address,
2238             ipaddress.IPv6Address("2001:658:22a:cafe::"),
2239         )
2240         self.assertEqual(
2241             self.ipv6_interface.network.network_address,
2242             ipaddress.IPv6Address("2001:658:22a:cafe::"),
2243         )
2244         self.assertEqual(
2245             self.ipv6_network.broadcast_address,
2246             ipaddress.IPv6Address("2001:658:22a:cafe:ffff:ffff:ffff:ffff"),
2247         )
2248         self.assertEqual(
2249             self.ipv6_network.hostmask, ipaddress.IPv6Address("::ffff:ffff:ffff:ffff")
2250         )
2251         self.assertEqual(
2252             self.ipv6_interface.network.broadcast_address,
2253             ipaddress.IPv6Address("2001:658:22a:cafe:ffff:ffff:ffff:ffff"),
2254         )
2255         self.assertEqual(
2256             self.ipv6_interface.network.hostmask,
2257             ipaddress.IPv6Address("::ffff:ffff:ffff:ffff"),
2258         )
2259         self.assertIn("broadcast_address", self.ipv6_network._cache)
2260         self.assertIn("hostmask", self.ipv6_network._cache)
2261         self.assertIn("broadcast_address", self.ipv6_interface.network._cache)
2262         self.assertIn("hostmask", self.ipv6_interface.network._cache)
2263     def testTeredo(self):
2264         server = ipaddress.IPv4Address("65.54.227.120")
2265         client = ipaddress.IPv4Address("192.0.2.45")
2266         teredo_addr = "2001:0000:4136:e378:8000:63bf:3fff:fdd2"
2267         self.assertEqual((server, client), ipaddress.ip_address(teredo_addr).teredo)
2268         bad_addr = "2000::4136:e378:8000:63bf:3fff:fdd2"
2269         self.assertFalse(ipaddress.ip_address(bad_addr).teredo)
2270         bad_addr = "2001:0001:4136:e378:8000:63bf:3fff:fdd2"
2271         self.assertFalse(ipaddress.ip_address(bad_addr).teredo)
2272         teredo_addr = ipaddress.IPv6Address("2001:0:5ef5:79fd:0:59d:a0e5:ba1")
2273         self.assertEqual(
2274             (
2275 <a name="5"></a>                ipaddress.IPv4Address("94.245.121.253"),
2276                 ipaddress.IPv4Address("95.26.244.94"),
2277             ),
2278             teredo_addr<font color="#151b8d"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.teredo,
2279         )
2280     def testsixtofour(self):
2281         sixtofouraddr = ipaddress.ip_address("2002:ac1d:2d64::1")
2282         bad_addr = ipaddress.ip_address("2000:ac1d:2d64::1")
2283 <a name="2"></a>        self.assertEqual(
2284             ipaddress.IPv4Address(</b></font>"172.29.45.100"), sixtofouraddr.sixtofour
2285         )
2286         self.assertFalse(bad_addr.<font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>sixtofour)
2287 <a name="1"></a>    def testV4HashIsNotConstant(self):
2288         ipv4_address1 = ipaddress.IPv4Interface("1.2.3.4")
2289         ipv4_address2 = ipaddress.IPv4Interface("2.3.4.5")
2290         self.assertNotEqual(ipv4_address1.__hash__(), ipv4_address2.__hash__(</b></font><font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>))
2291     def testV6HashIsNotConstant(self):
2292         ipv6_address1 = ipaddress.IPv6Interface("2001:658:22a:cafe:200:0:0:1")
2293         ipv6_address2 = ipaddress.IPv6Interface("2001:658:22a:cafe:200:0:0:2")
2294         self.assertNotEqual(ipv6_address1.__hash__(), ipv6_address2.__hash__(</b></font>))
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
