<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for nxos_api_2.py &amp; splunk_1.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for nxos_api_2.py &amp; splunk_1.py
      </h3>
<h1 align="center">
        10.0%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>nxos_api_2.py (18.181818%)<th>splunk_1.py (6.965174%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(102-150)<td><a href="#" name="0">(23-53)</a><td align="center"><font color="#ff0000">14</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>nxos_api_2.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>import copy
2 import logging
3 from salt.exceptions import SaltException
4 __proxyenabled__ = ["nxos_api"]
5 __virtualname__ = "nxos_api"
6 log = logging.getLogger(__name__)
7 nxos_device = {}
8 def __virtual__():
9     return __virtualname__
10 def init(opts):
11     proxy_dict =</b></font> opts.get("proxy", {})
12     conn_args = copy.deepcopy(proxy_dict)
13     conn_args.pop("proxytype", None)
14     opts["multiprocessing"] = conn_args.pop("multiprocessing", True)
15     try:
16         rpc_reply = __utils__["nxos_api.rpc"]("show clock", **conn_args)
17         nxos_device["conn_args"] = conn_args
18         nxos_device["initialized"] = True
19         nxos_device["up"] = True
20     except SaltException:
21         log.error("Unable to connect to %s", conn_args["host"], exc_info=True)
22         raise
23     return True
24 def ping():
25     return nxos_device.get("up", False)
26 def initialized():
27     return nxos_device.get("initialized", False)
28 def shutdown(opts):
29     log.debug("Shutting down the nxos_api Proxy Minion %s", opts["id"])
30 def get_conn_args():
31     conn_args = copy.deepcopy(nxos_device["conn_args"])
32     return conn_args
33 def rpc(commands, method="cli", **kwargs):
34     conn_args = nxos_device["conn_args"]
35     conn_args.update(kwargs)
36     return __utils__["nxos_api.rpc"](commands, method=method, **conn_args)
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>splunk_1.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import logging
2 import socket
3 <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>import time
4 import requests
5 import salt.utils.json
6 _max_content_bytes = 100000
7 http_event_collector_debug = False
8 log = logging.getLogger(__name__)
9 __virtualname__ = "splunk"
10 def __virtual__():
11     return __virtualname__
12 def returner(ret):
13     opts =</b></font> _get_options()
14     log.info(
15         "Options: %s",
16         salt.utils.json.dumps(opts),
17     )
18     http_collector = _create_http_event_collector(opts)
19     payload = _prepare_splunk_payload(ret, opts)
20     http_collector.sendEvent(payload)
21     return True
22 def event_return(events):
23     opts = _get_options()
24     log.info(
25         "Options: %s",
26         salt.utils.json.dumps(opts),
27     )
28     http_collector = _create_http_event_collector(opts)
29     for event in events:
30         payload = _prepare_splunk_payload(event, opts)
31         http_collector.sendEvent(payload)
32     return True
33 def _get_options():
34     try:
35         token = __salt__["config.get"]("splunk_http_forwarder:token")
36         indexer = __salt__["config.get"]("splunk_http_forwarder:indexer")
37         sourcetype = __salt__["config.get"]("splunk_http_forwarder:sourcetype")
38         index = __salt__["config.get"]("splunk_http_forwarder:index")
39         verify_ssl = __salt__["config.get"](
40             "splunk_http_forwarder:verify_ssl", default=True
41         )
42     except Exception:  # pylint: disable=broad-except
43         log.error("Splunk HTTP Forwarder parameters not present in config.")
44         return None
45     splunk_opts = {
46         "token": token,
47         "indexer": indexer,
48         "sourcetype": sourcetype,
49         "index": index,
50         "verify_ssl": verify_ssl,
51     }
52     return splunk_opts
53 def _create_http_event_collector(opts):
54     http_event_collector_key = opts["token"]
55     http_event_collector_host = opts["indexer"]
56     http_event_collector_verify_ssl = opts["verify_ssl"]
57     return http_event_collector(
58         http_event_collector_key,
59         http_event_collector_host,
60         verify_ssl=http_event_collector_verify_ssl,
61     )
62 def _prepare_splunk_payload(event, opts):
63     opts = _get_options()
64     payload = {}
65     payload.update({"index": opts["index"]})
66     payload.update({"sourcetype": opts["sourcetype"]})
67     payload.update({"event": event})
68     log.info(
69         "Payload: %s",
70         salt.utils.json.dumps(payload),
71     )
72     return payload
73 class http_event_collector:
74     def __init__(
75         self,
76         token,
77         http_event_server,
78         host="",
79         http_event_port="8088",
80         http_event_server_ssl=True,
81         max_bytes=_max_content_bytes,
82         verify_ssl=True,
83     ):
84         self.token = token
85         self.batchEvents = []
86         self.maxByteLength = max_bytes
87         self.currentByteLength = 0
88         self.verify_ssl = verify_ssl
89         if host:
90             self.host = host
91         else:
92             self.host = socket.gethostname()
93         if http_event_server_ssl:
94             buildURI = ["https://"]
95         else:
96             buildURI = ["http://"]
97         for i in [http_event_server, ":", http_event_port, "/services/collector/event"]:
98             buildURI.append(i)
99         self.server_uri = "".join(buildURI)
100         if http_event_collector_debug:
101             log.debug(self.token)
102             log.debug(self.server_uri)
103     def sendEvent(self, payload, eventtime=""):
104         headers = {"Authorization": "Splunk " + self.token}
105         if not eventtime:
106             eventtime = str(int(time.time()))
107         if "host" not in payload:
108             payload.update({"host": self.host})
109         data = {"time": eventtime}
110         data.update(payload)
111         r = requests.post(
112             self.server_uri,
113             data=salt.utils.json.dumps(data),
114             headers=headers,
115             verify=self.verify_ssl,
116         )
117         if http_event_collector_debug:
118             log.debug(r.text)
119             log.debug(data)
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
