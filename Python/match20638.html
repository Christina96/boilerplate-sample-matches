<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for nxos_api_2.py &amp; splunk_1.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for nxos_api_2.py &amp; splunk_1.py
      </h3>
<h1 align="center">
        10.0%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>nxos_api_2.py (18.181818%)<th>splunk_1.py (6.965174%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(102-150)<td><a href="#" name="0">(23-53)</a><td align="center"><font color="#ff0000">14</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>nxos_api_2.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>import copy
2 import logging
3 from salt.exceptions import SaltException
4 __proxyenabled__ = ["nxos_api"]
5 __virtualname__ = "nxos_api"
6 log = logging.getLogger(__name__)
7 nxos_device = {}
8 def __virtual__():
9     return __virtualname__
10 def init(opts):
11     proxy_dict =</b></font> opts.get("proxy", {})
12     conn_args = copy.deepcopy(proxy_dict)
13     conn_args.pop("proxytype", None)
14     opts["multiprocessing"] = conn_args.pop("multiprocessing", True)
15     try:
16         rpc_reply = __utils__["nxos_api.rpc"]("show clock", **conn_args)
17         nxos_device["conn_args"] = conn_args
18         nxos_device["initialized"] = True
19         nxos_device["up"] = True
20     except SaltException:
21         log.error("Unable to connect to %s", conn_args["host"], exc_info=True)
22         raise
23     return True
24 def ping():
25     return nxos_device.get("up", False)
26 def initialized():
27     return nxos_device.get("initialized", False)
28 def shutdown(opts):
29     log.debug("Shutting down the nxos_api Proxy Minion %s", opts["id"])
30 def get_conn_args():
31     conn_args = copy.deepcopy(nxos_device["conn_args"])
32     return conn_args
33 def rpc(commands, method="cli", **kwargs):
34     conn_args = nxos_device["conn_args"]
35     conn_args.update(kwargs)
36     return __utils__["nxos_api.rpc"](commands, method=method, **conn_args)
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>splunk_1.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <a name="0"></a>
2 import logging
3 import socket
4 <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>import time
5 import requests
6 import salt.utils.json
7 _max_content_bytes = 100000
8 http_event_collector_debug = False
9 log = logging.getLogger(__name__)
10 __virtualname__ = "splunk"
11 def __virtual__():
12     return __virtualname__
13 def returner(ret):
14     opts =</b></font> _get_options()
15     log.info(
16         "Options: %s",
17         salt.utils.json.dumps(opts),
18     )
19     http_collector = _create_http_event_collector(opts)
20     payload = _prepare_splunk_payload(ret, opts)
21     http_collector.sendEvent(payload)
22     return True
23 def event_return(events):
24     opts = _get_options()
25     log.info(
26         "Options: %s",
27         salt.utils.json.dumps(opts),
28     )
29     http_collector = _create_http_event_collector(opts)
30     for event in events:
31         payload = _prepare_splunk_payload(event, opts)
32         http_collector.sendEvent(payload)
33     return True
34 def _get_options():
35     try:
36         token = __salt__["config.get"]("splunk_http_forwarder:token")
37         indexer = __salt__["config.get"]("splunk_http_forwarder:indexer")
38         sourcetype = __salt__["config.get"]("splunk_http_forwarder:sourcetype")
39         index = __salt__["config.get"]("splunk_http_forwarder:index")
40         verify_ssl = __salt__["config.get"](
41             "splunk_http_forwarder:verify_ssl", default=True
42         )
43     except Exception:  # pylint: disable=broad-except
44         log.error("Splunk HTTP Forwarder parameters not present in config.")
45         return None
46     splunk_opts = {
47         "token": token,
48         "indexer": indexer,
49         "sourcetype": sourcetype,
50         "index": index,
51         "verify_ssl": verify_ssl,
52     }
53     return splunk_opts
54 def _create_http_event_collector(opts):
55     http_event_collector_key = opts["token"]
56     http_event_collector_host = opts["indexer"]
57     http_event_collector_verify_ssl = opts["verify_ssl"]
58     return http_event_collector(
59         http_event_collector_key,
60         http_event_collector_host,
61         verify_ssl=http_event_collector_verify_ssl,
62     )
63 def _prepare_splunk_payload(event, opts):
64     opts = _get_options()
65     payload = {}
66     payload.update({"index": opts["index"]})
67     payload.update({"sourcetype": opts["sourcetype"]})
68     payload.update({"event": event})
69     log.info(
70         "Payload: %s",
71         salt.utils.json.dumps(payload),
72     )
73     return payload
74 class http_event_collector:
75     def __init__(
76         self,
77         token,
78         http_event_server,
79         host="",
80         http_event_port="8088",
81         http_event_server_ssl=True,
82         max_bytes=_max_content_bytes,
83         verify_ssl=True,
84     ):
85         self.token = token
86         self.batchEvents = []
87         self.maxByteLength = max_bytes
88         self.currentByteLength = 0
89         self.verify_ssl = verify_ssl
90         if host:
91             self.host = host
92         else:
93             self.host = socket.gethostname()
94         if http_event_server_ssl:
95             buildURI = ["https://"]
96         else:
97             buildURI = ["http://"]
98         for i in [http_event_server, ":", http_event_port, "/services/collector/event"]:
99             buildURI.append(i)
100         self.server_uri = "".join(buildURI)
101         if http_event_collector_debug:
102             log.debug(self.token)
103             log.debug(self.server_uri)
104     def sendEvent(self, payload, eventtime=""):
105         headers = {"Authorization": "Splunk " + self.token}
106         if not eventtime:
107             eventtime = str(int(time.time()))
108         if "host" not in payload:
109             payload.update({"host": self.host})
110         data = {"time": eventtime}
111         data.update(payload)
112         r = requests.post(
113             self.server_uri,
114             data=salt.utils.json.dumps(data),
115             headers=headers,
116             verify=self.verify_ssl,
117         )
118         if http_event_collector_debug:
119             log.debug(r.text)
120             log.debug(data)
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
