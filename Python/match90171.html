<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for exitcodes.py &amp; panos_2.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for exitcodes.py &amp; panos_2.py
      </h3>
<h1 align="center">
        3.7%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>exitcodes.py (100.0%)<th>panos_2.py (1.9011407%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(9-46)<td><a href="#" name="0">(932-951)</a><td align="center"><font color="#ff0000">20</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>exitcodes.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <a name="0"></a>
2 EX_GENERIC <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>= 1
3 EX_STATE_COMPILER_ERROR = 1
4 EX_STATE_FAILURE = 2
5 EX_PILLAR_FAILURE = 5
6 EX_THIN_PYTHON_INVALID = 10
7 EX_THIN_DEPLOY = 11
8 EX_THIN_CHECKSUM = 12
9 EX_MOD_DEPLOY = 13
10 EX_SCP_NOT_FOUND = 14
11 EX_AGGREGATE = 20
12 EX_OK = 0  # successful termination
13 EX_USAGE = 64  # command line usage error
14 EX_NOUSER = 67  # addressee unknown
15 EX_UNAVAILABLE = 69  # service unavailable
16 EX_SOFTWARE = 70  # internal software error
17 EX_CANTCREAT = 73  # can't create (user) output file
18 EX_TEMPFAIL = 75  # temp failure; user is invited to retry
19 EX_NOPERM = 77  # permission denied
20 SALT_KEEPALIVE = 99
21 SALT_BUILD_FAIL =</b></font> 101
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>panos_2.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import logging
2 import xml.etree.ElementTree as ET
3 import salt.utils.xmlutil as xml
4 log = logging.getLogger(__name__)
5 def __virtual__():
6     if "panos.commit" in __salt__:
7         return True
8     return (False, "panos module could not be loaded")
9 def _build_members(members, anycheck=False):
10     if isinstance(members, list):
11         if anycheck and "any" in members:
12             return "&lt;member&gt;any&lt;/member&gt;"
13         response = ""
14         for m in members:
15             response += "&lt;member&gt;{}&lt;/member&gt;".format(m)
16         return response
17     else:
18         return "&lt;member&gt;{}&lt;/member&gt;".format(members)
19 def _default_ret(name):
20     ret = {"name": name, "changes": {}, "commit": None, "result": False, "comment": ""}
21     return ret
22 def _edit_config(xpath, element):
23     query = {"type": "config", "action": "edit", "xpath": xpath, "element": element}
24     response = __proxy__["panos.call"](query)
25     return _validate_response(response)
26 def _get_config(xpath):
27     query = {"type": "config", "action": "get", "xpath": xpath}
28     response = __proxy__["panos.call"](query)
29     return response
30 def _move_after(xpath, target):
31     query = {
32         "type": "config",
33         "action": "move",
34         "xpath": xpath,
35         "where": "after",
36         "dst": target,
37     }
38     response = __proxy__["panos.call"](query)
39     return _validate_response(response)
40 def _move_before(xpath, target):
41     query = {
42         "type": "config",
43         "action": "move",
44         "xpath": xpath,
45         "where": "before",
46         "dst": target,
47     }
48     response = __proxy__["panos.call"](query)
49     return _validate_response(response)
50 def _move_bottom(xpath):
51     query = {"type": "config", "action": "move", "xpath": xpath, "where": "bottom"}
52     response = __proxy__["panos.call"](query)
53     return _validate_response(response)
54 def _move_top(xpath):
55     query = {"type": "config", "action": "move", "xpath": xpath, "where": "top"}
56     response = __proxy__["panos.call"](query)
57     return _validate_response(response)
58 def _set_config(xpath, element):
59     query = {"type": "config", "action": "set", "xpath": xpath, "element": element}
60     response = __proxy__["panos.call"](query)
61     return _validate_response(response)
62 def _validate_response(response):
63     if not response:
64         return False, "Unable to validate response from device."
65     elif "msg" in response:
66         if "line" in response["msg"]:
67             if response["msg"]["line"] == "already at the top":
68                 return True, response
69             elif response["msg"]["line"] == "already at the bottom":
70                 return True, response
71             else:
72                 return False, response
73         elif response["msg"] == "command succeeded":
74             return True, response
75         else:
76             return False, response
77     elif "status" in response:
78         if response["status"] == "success":
79             return True, response
80         else:
81             return False, response
82     else:
83         return False, response
84 def add_config_lock(name):
85     ret = _default_ret(name)
86     ret.update({"changes": __salt__["panos.add_config_lock"](), "result": True})
87     return ret
88 def address_exists(
89     name,
90     addressname=None,
91     vsys=1,
92     ipnetmask=None,
93     iprange=None,
94     fqdn=None,
95     description=None,
96     commit=False,
97 ):
98     ret = _default_ret(name)
99     if not addressname:
100         ret.update({"comment": "The service name field must be provided."})
101         return ret
102     address = __salt__["panos.get_address"](addressname, vsys)["result"]
103     if address and "entry" in address:
104         address = address["entry"]
105     else:
106         address = {}
107     element = ""
108     if ipnetmask:
109         element = "&lt;ip-netmask&gt;{}&lt;/ip-netmask&gt;".format(ipnetmask)
110     elif iprange:
111         element = "&lt;ip-range&gt;{}&lt;/ip-range&gt;".format(iprange)
112     elif fqdn:
113         element = "&lt;fqdn&gt;{}&lt;/fqdn&gt;".format(fqdn)
114     else:
115         ret.update({"comment": "A valid address type must be specified."})
116         return ret
117     if description:
118         element += "&lt;description&gt;{}&lt;/description&gt;".format(description)
119     full_element = "&lt;entry name='{}'&gt;{}&lt;/entry&gt;".format(addressname, element)
120     new_address = xml.to_dict(ET.fromstring(full_element), True)
121     if address == new_address:
122         ret.update(
123             {
124                 "comment": "Address object already exists. No changes required.",
125                 "result": True,
126             }
127         )
128         return ret
129     else:
130         xpath = (
131             "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys{}']/address/"
132             "entry[@name='{}']".format(vsys, addressname)
133         )
134         result, msg = _edit_config(xpath, full_element)
135         if not result:
136             ret.update({"comment": msg})
137             return ret
138     if commit is True:
139         ret.update(
140             {
141                 "changes": {"before": address, "after": new_address},
142                 "commit": __salt__["panos.commit"](),
143                 "comment": "Address object successfully configured.",
144                 "result": True,
145             }
146         )
147     else:
148         ret.update(
149             {
150                 "changes": {"before": address, "after": new_address},
151                 "comment": "Service object successfully configured.",
152                 "result": True,
153             }
154         )
155     return ret
156 def address_group_exists(
157     name, groupname=None, vsys=1, members=None, description=None, commit=False
158 ):
159     ret = _default_ret(name)
160     if not groupname:
161         ret.update({"comment": "The group name field must be provided."})
162         return ret
163     group = __salt__["panos.get_address_group"](groupname, vsys)["result"]
164     if group and "entry" in group:
165         group = group["entry"]
166     else:
167         group = {}
168     if members:
169         element = "&lt;static&gt;{}&lt;/static&gt;".format(_build_members(members, True))
170     else:
171         ret.update({"comment": "The group members must be provided."})
172         return ret
173     if description:
174         element += "&lt;description&gt;{}&lt;/description&gt;".format(description)
175     full_element = "&lt;entry name='{}'&gt;{}&lt;/entry&gt;".format(groupname, element)
176     new_group = xml.to_dict(ET.fromstring(full_element), True)
177     if group == new_group:
178         ret.update(
179             {
180                 "comment": "Address group object already exists. No changes required.",
181                 "result": True,
182             }
183         )
184         return ret
185     else:
186         xpath = (
187             "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys{}']/address-group/"
188             "entry[@name='{}']".format(vsys, groupname)
189         )
190         result, msg = _edit_config(xpath, full_element)
191         if not result:
192             ret.update({"comment": msg})
193             return ret
194     if commit is True:
195         ret.update(
196             {
197                 "changes": {"before": group, "after": new_group},
198                 "commit": __salt__["panos.commit"](),
199                 "comment": "Address group object successfully configured.",
200                 "result": True,
201             }
202         )
203     else:
204         ret.update(
205             {
206                 "changes": {"before": group, "after": new_group},
207                 "comment": "Address group object successfully configured.",
208                 "result": True,
209             }
210         )
211     return ret
212 def clone_config(name, xpath=None, newname=None, commit=False):
213     ret = _default_ret(name)
214     if not xpath:
215         return ret
216     if not newname:
217         return ret
218     query = {"type": "config", "action": "clone", "xpath": xpath, "newname": newname}
219     result, response = _validate_response(__proxy__["panos.call"](query))
220     ret.update({"changes": response, "result": result})
221     if not result:
222         return ret
223     if commit is True:
224         ret.update({"commit": __salt__["panos.commit"](), "result": True})
225     return ret
226 def commit_config(name):
227     ret = _default_ret(name)
228     ret.update({"commit": __salt__["panos.commit"](), "result": True})
229     return ret
230 def delete_config(name, xpath=None, commit=False):
231     ret = _default_ret(name)
232     if not xpath:
233         return ret
234     query = {"type": "config", "action": "delete", "xpath": xpath}
235     result, response = _validate_response(__proxy__["panos.call"](query))
236     ret.update({"changes": response, "result": result})
237     if not result:
238         return ret
239     if commit is True:
240         ret.update({"commit": __salt__["panos.commit"](), "result": True})
241     return ret
242 def download_software(name, version=None, synch=False, check=False):
243     ret = _default_ret(name)
244     if check is True:
245         __salt__["panos.check_software"]()
246     versions = __salt__["panos.get_software_info"]()["result"]
247     if (
248         "sw-updates" not in versions
249         or "versions" not in versions["sw-updates"]
250         or "entry" not in versions["sw-updates"]["versions"]
251     ):
252         ret.update(
253             {
254                 "comment": "Software version is not found in the local software list.",
255                 "result": False,
256             }
257         )
258         return ret
259     for entry in versions["sw-updates"]["versions"]["entry"]:
260         if entry["version"] == version and entry["downloaded"] == "yes":
261             ret.update(
262                 {"comment": "Software version is already downloaded.", "result": True}
263             )
264         return ret
265     ret.update(
266         {
267             "changes": __salt__["panos.download_software_version"](
268                 version=version, synch=synch
269             )
270         }
271     )
272     versions = __salt__["panos.get_software_info"]()["result"]
273     if (
274         "sw-updates" not in versions
275         or "versions" not in versions["sw-updates"]
276         or "entry" not in versions["sw-updates"]["versions"]
277     ):
278         ret.update({"result": False})
279         return ret
280     for entry in versions["sw-updates"]["versions"]["entry"]:
281         if entry["version"] == version and entry["downloaded"] == "yes":
282             ret.update({"result": True})
283         return ret
284     return ret
285 def edit_config(name, xpath=None, value=None, commit=False):
286     ret = _default_ret(name)
287     xpath_split = xpath.split("/")
288     if len(xpath_split) &gt; 0:
289         head = xpath_split[-1]
290         if "[" in head:
291             head = head.split("[")[0]
292     current_element = __salt__["panos.get_xpath"](xpath)["result"]
293     if head and current_element and head in current_element:
294         current_element = current_element[head]
295     else:
296         current_element = {}
297     new_element = xml.to_dict(ET.fromstring(value), True)
298     if current_element == new_element:
299         ret.update(
300             {
301                 "comment": "XPATH is already equal to the specified value.",
302                 "result": True,
303             }
304         )
305         return ret
306     result, msg = _edit_config(xpath, value)
307     ret.update({"comment": msg, "result": result})
308     if not result:
309         return ret
310     if commit is True:
311         ret.update(
312             {
313                 "changes": {"before": current_element, "after": new_element},
314                 "commit": __salt__["panos.commit"](),
315                 "result": True,
316             }
317         )
318     else:
319         ret.update(
320             {
321                 "changes": {"before": current_element, "after": new_element},
322                 "result": True,
323             }
324         )
325     return ret
326 def move_config(name, xpath=None, where=None, dst=None, commit=False):
327     ret = _default_ret(name)
328     if not xpath:
329         return ret
330     if not where:
331         return ret
332     if where == "after":
333         result, msg = _move_after(xpath, dst)
334     elif where == "before":
335         result, msg = _move_before(xpath, dst)
336     elif where == "top":
337         result, msg = _move_top(xpath)
338     elif where == "bottom":
339         result, msg = _move_bottom(xpath)
340     ret.update({"result": result, "comment": msg})
341     if not result:
342         return ret
343     if commit is True:
344         ret.update({"commit": __salt__["panos.commit"](), "result": True})
345     return ret
346 def remove_config_lock(name):
347     ret = _default_ret(name)
348     ret.update({"changes": __salt__["panos.remove_config_lock"](), "result": True})
349     return ret
350 def rename_config(name, xpath=None, newname=None, commit=False):
351     ret = _default_ret(name)
352     if not xpath:
353         return ret
354     if not newname:
355         return ret
356     query = {"type": "config", "action": "rename", "xpath": xpath, "newname": newname}
357     result, response = _validate_response(__proxy__["panos.call"](query))
358     ret.update({"changes": response, "result": result})
359     if not result:
360         return ret
361     if commit is True:
362         ret.update({"commit": __salt__["panos.commit"](), "result": True})
363     return ret
364 <a name="0"></a>
365 def security_rule_exists(
366     name,
367     rulename<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>=None,
368     vsys="1",
369     action=None,
370     disabled=None,
371     sourcezone=None,
372     destinationzone=None,
373     source=None,
374     destination=None,
375     application=None,
376     service=None,
377     description=None,
378     logsetting=None,
379     logstart=None,
380     logend=None,
381     negatesource=None,
382     negatedestination=None,
383     profilegroup=None,
384     datafilter=None,
385     fileblock=None,
386     spyware=</b></font>None,
387     urlfilter=None,
388     virus=None,
389     vulnerability=None,
390     wildfire=None,
391     move=None,
392     movetarget=None,
393     commit=False,
394 ):
395     ret = _default_ret(name)
396     if not rulename:
397         return ret
398     rule = __salt__["panos.get_security_rule"](rulename, vsys)["result"]
399     if rule and "entry" in rule:
400         rule = rule["entry"]
401     else:
402         rule = {}
403     element = ""
404     if sourcezone:
405         element += "&lt;from&gt;{}&lt;/from&gt;".format(_build_members(sourcezone, True))
406     else:
407         ret.update({"comment": "The sourcezone field must be provided."})
408         return ret
409     if destinationzone:
410         element += "&lt;to&gt;{}&lt;/to&gt;".format(_build_members(destinationzone, True))
411     else:
412         ret.update({"comment": "The destinationzone field must be provided."})
413         return ret
414     if source:
415         element += "&lt;source&gt;{}&lt;/source&gt;".format(_build_members(source, True))
416     else:
417         ret.update({"comment": "The source field must be provided."})
418         return
419     if destination:
420         element += "&lt;destination&gt;{}&lt;/destination&gt;".format(
421             _build_members(destination, True)
422         )
423     else:
424         ret.update({"comment": "The destination field must be provided."})
425         return ret
426     if application:
427         element += "&lt;application&gt;{}&lt;/application&gt;".format(
428             _build_members(application, True)
429         )
430     else:
431         ret.update({"comment": "The application field must be provided."})
432         return ret
433     if service:
434         element += "&lt;service&gt;{}&lt;/service&gt;".format(_build_members(service, True))
435     else:
436         ret.update({"comment": "The service field must be provided."})
437         return ret
438     if action:
439         element += "&lt;action&gt;{}&lt;/action&gt;".format(action)
440     else:
441         ret.update({"comment": "The action field must be provided."})
442         return ret
443     if disabled is not None:
444         if disabled:
445             element += "&lt;disabled&gt;yes&lt;/disabled&gt;"
446         else:
447             element += "&lt;disabled&gt;no&lt;/disabled&gt;"
448     if description:
449         element += "&lt;description&gt;{}&lt;/description&gt;".format(description)
450     if logsetting:
451         element += "&lt;log-setting&gt;{}&lt;/log-setting&gt;".format(logsetting)
452     if logstart is not None:
453         if logstart:
454             element += "&lt;log-start&gt;yes&lt;/log-start&gt;"
455         else:
456             element += "&lt;log-start&gt;no&lt;/log-start&gt;"
457     if logend is not None:
458         if logend:
459             element += "&lt;log-end&gt;yes&lt;/log-end&gt;"
460         else:
461             element += "&lt;log-end&gt;no&lt;/log-end&gt;"
462     if negatesource is not None:
463         if negatesource:
464             element += "&lt;negate-source&gt;yes&lt;/negate-source&gt;"
465         else:
466             element += "&lt;negate-source&gt;no&lt;/negate-source&gt;"
467     if negatedestination is not None:
468         if negatedestination:
469             element += "&lt;negate-destination&gt;yes&lt;/negate-destination&gt;"
470         else:
471             element += "&lt;negate-destination&gt;no&lt;/negate-destination&gt;"
472     profile_string = None
473     if profilegroup:
474         profile_string = "&lt;group&gt;&lt;member&gt;{}&lt;/member&gt;&lt;/group&gt;".format(profilegroup)
475     else:
476         member_string = ""
477         if datafilter:
478             member_string += (
479                 "&lt;data-filtering&gt;&lt;member&gt;{}&lt;/member&gt;&lt;/data-filtering&gt;".format(
480                     datafilter
481                 )
482             )
483         if fileblock:
484             member_string += (
485                 "&lt;file-blocking&gt;&lt;member&gt;{}&lt;/member&gt;&lt;/file-blocking&gt;".format(fileblock)
486             )
487         if spyware:
488             member_string += "&lt;spyware&gt;&lt;member&gt;{}&lt;/member&gt;&lt;/spyware&gt;".format(spyware)
489         if urlfilter:
490             member_string += (
491                 "&lt;url-filtering&gt;&lt;member&gt;{}&lt;/member&gt;&lt;/url-filtering&gt;".format(urlfilter)
492             )
493         if virus:
494             member_string += "&lt;virus&gt;&lt;member&gt;{}&lt;/member&gt;&lt;/virus&gt;".format(virus)
495         if vulnerability:
496             member_string += (
497                 "&lt;vulnerability&gt;&lt;member&gt;{}&lt;/member&gt;&lt;/vulnerability&gt;".format(
498                     vulnerability
499                 )
500             )
501         if wildfire:
502             member_string += (
503                 "&lt;wildfire-analysis&gt;&lt;member&gt;{}&lt;/member&gt;&lt;/wildfire-analysis&gt;".format(
504                     wildfire
505                 )
506             )
507         if member_string != "":
508             profile_string = "&lt;profiles&gt;{}&lt;/profiles&gt;".format(member_string)
509     if profile_string:
510         element += "&lt;profile-setting&gt;{}&lt;/profile-setting&gt;".format(profile_string)
511     full_element = "&lt;entry name='{}'&gt;{}&lt;/entry&gt;".format(rulename, element)
512     new_rule = xml.to_dict(ET.fromstring(full_element), True)
513     config_change = False
514     if rule == new_rule:
515         ret.update({"comment": "Security rule already exists. No changes required."})
516     else:
517         config_change = True
518         xpath = (
519             "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys{}']/rulebase/"
520             "security/rules/entry[@name='{}']".format(vsys, rulename)
521         )
522         result, msg = _edit_config(xpath, full_element)
523         if not result:
524             ret.update({"comment": msg})
525             return ret
526         ret.update(
527             {
528                 "changes": {"before": rule, "after": new_rule},
529                 "comment": "Security rule verified successfully.",
530             }
531         )
532     if move:
533         movepath = (
534             "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys{}']/rulebase/"
535             "security/rules/entry[@name='{}']".format(vsys, rulename)
536         )
537         move_result = False
538         move_msg = ""
539         if move == "before" and movetarget:
540             move_result, move_msg = _move_before(movepath, movetarget)
541         elif move == "after":
542             move_result, move_msg = _move_after(movepath, movetarget)
543         elif move == "top":
544             move_result, move_msg = _move_top(movepath)
545         elif move == "bottom":
546             move_result, move_msg = _move_bottom(movepath)
547         if config_change:
548             ret.update(
549                 {"changes": {"before": rule, "after": new_rule, "move": move_msg}}
550             )
551         else:
552             ret.update({"changes": {"move": move_msg}})
553         if not move_result:
554             ret.update({"comment": move_msg})
555             return ret
556     if commit is True:
557         ret.update({"commit": __salt__["panos.commit"](), "result": True})
558     else:
559         ret.update({"result": True})
560     return ret
561 def service_exists(
562     name,
563     servicename=None,
564     vsys=1,
565     protocol=None,
566     port=None,
567     description=None,
568     commit=False,
569 ):
570     ret = _default_ret(name)
571     if not servicename:
572         ret.update({"comment": "The service name field must be provided."})
573         return ret
574     service = __salt__["panos.get_service"](servicename, vsys)["result"]
575     if service and "entry" in service:
576         service = service["entry"]
577     else:
578         service = {}
579     if not protocol and protocol not in ["tcp", "udp"]:
580         ret.update({"comment": "The protocol must be provided and must be tcp or udp."})
581         return ret
582     if not port:
583         ret.update({"comment": "The port field must be provided."})
584         return ret
585     element = "&lt;protocol&gt;&lt;{0}&gt;&lt;port&gt;{1}&lt;/port&gt;&lt;/{0}&gt;&lt;/protocol&gt;".format(protocol, port)
586     if description:
587         element += "&lt;description&gt;{}&lt;/description&gt;".format(description)
588     full_element = "&lt;entry name='{}'&gt;{}&lt;/entry&gt;".format(servicename, element)
589     new_service = xml.to_dict(ET.fromstring(full_element), True)
590     if service == new_service:
591         ret.update(
592             {
593                 "comment": "Service object already exists. No changes required.",
594                 "result": True,
595             }
596         )
597         return ret
598     else:
599         xpath = (
600             "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys{}']/service/"
601             "entry[@name='{}']".format(vsys, servicename)
602         )
603         result, msg = _edit_config(xpath, full_element)
604         if not result:
605             ret.update({"comment": msg})
606             return ret
607     if commit is True:
608         ret.update(
609             {
610                 "changes": {"before": service, "after": new_service},
611                 "commit": __salt__["panos.commit"](),
612                 "comment": "Service object successfully configured.",
613                 "result": True,
614             }
615         )
616     else:
617         ret.update(
618             {
619                 "changes": {"before": service, "after": new_service},
620                 "comment": "Service object successfully configured.",
621                 "result": True,
622             }
623         )
624     return ret
625 def service_group_exists(
626     name, groupname=None, vsys=1, members=None, description=None, commit=False
627 ):
628     ret = _default_ret(name)
629     if not groupname:
630         ret.update({"comment": "The group name field must be provided."})
631         return ret
632     group = __salt__["panos.get_service_group"](groupname, vsys)["result"]
633     if group and "entry" in group:
634         group = group["entry"]
635     else:
636         group = {}
637     if members:
638         element = "&lt;members&gt;{}&lt;/members&gt;".format(_build_members(members, True))
639     else:
640         ret.update({"comment": "The group members must be provided."})
641         return ret
642     if description:
643         element += "&lt;description&gt;{}&lt;/description&gt;".format(description)
644     full_element = "&lt;entry name='{}'&gt;{}&lt;/entry&gt;".format(groupname, element)
645     new_group = xml.to_dict(ET.fromstring(full_element), True)
646     if group == new_group:
647         ret.update(
648             {
649                 "comment": "Service group object already exists. No changes required.",
650                 "result": True,
651             }
652         )
653         return ret
654     else:
655         xpath = (
656             "/config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys{}']/service-group/"
657             "entry[@name='{}']".format(vsys, groupname)
658         )
659         result, msg = _edit_config(xpath, full_element)
660         if not result:
661             ret.update({"comment": msg})
662             return ret
663     if commit is True:
664         ret.update(
665             {
666                 "changes": {"before": group, "after": new_group},
667                 "commit": __salt__["panos.commit"](),
668                 "comment": "Service group object successfully configured.",
669                 "result": True,
670             }
671         )
672     else:
673         ret.update(
674             {
675                 "changes": {"before": group, "after": new_group},
676                 "comment": "Service group object successfully configured.",
677                 "result": True,
678             }
679         )
680     return ret
681 def set_config(name, xpath=None, value=None, commit=False):
682     ret = _default_ret(name)
683     result, msg = _set_config(xpath, value)
684     ret.update({"comment": msg, "result": result})
685     if not result:
686         return ret
687     if commit is True:
688         ret.update({"commit": __salt__["panos.commit"](), "result": True})
689     return ret
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
