<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_sqlite3_1.py &amp; test_ipaddress.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_sqlite3_1.py &amp; test_ipaddress.py
      </h3>
<h1 align="center">
        1.7%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_sqlite3_1.py (48.076923%)<th>test_ipaddress.py (0.90203863%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(96-110)<td><a href="#" name="0">(713-720)</a><td align="center"><font color="#ff0000">18</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(67-91)<td><a href="#" name="1">(159-169)</a><td align="center"><font color="#ff0000">18</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(118-129)<td><a href="#" name="2">(894-903)</a><td align="center"><font color="#c60000">14</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_sqlite3_1.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import salt.modules.sqlite3 as sqlite3
2 from tests.support.mixins import LoaderModuleMockMixin
3 from tests.support.unit import TestCase
4 class MockSqlite3:
5     version = "2.6.0"
6     sqlite_version = "3.8.2"
7     def __init__(self):
8         self.dbase = None
9         self.isolation_level = None
10     def connect(self, dbase, isolation_level=None):
11         self.dbase = dbase
12         self.isolation_level = isolation_level
13         return MockSqlite3()
14     @staticmethod
15     def cursor():
16         return MockSqlite3()
17     @staticmethod
18     def execute(sql):
19         return sql
20     @staticmethod
21     def fetchall():
22         return True
23 class Sqlite3TestCase(TestCase, LoaderModuleMockMixin):
24     def setup_loader_modules(self):
25         return {sqlite3: {"sqlite3": MockSqlite3()}}
26     def test_version(self):
27 <a name="1"></a>        """
28         Tests if it return version of pysqlite.
29         self.assertEqual(sqlite3.version(<font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>), "2.6.0")
30     def test_sqlite_version(self):
31         self.assertEqual(sqlite3.sqlite_version(), "3.8.2")
32     def test_modify(self):
33         self.assertFalse(sqlite3.modify())
34         self.assertTrue(
35             sqlite3.modify("/root/test.db", "CREATE TABLE test(id INT, testdata TEXT);")
36         )
37     def</b></font> test_fetch(self):
38         self<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.assertFalse(sqlite3.fetch())
39         self.assertTrue(
40             sqlite3.fetch("/root/test.db", "CREATE TABLE test(id INT, testdata TEXT);")
41         )
42     def test_tables(self):
43         self.assertFalse(sqlite3.tables())
44         self.assertTrue(sqlite3.tables(</b></font>"/root/test.db"))
45     def test_indices(self):
46 <a name="2"></a>        """
47         Tests if it show all indices in the database.
48         self<font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.assertFalse(sqlite3.indices())
49         self.assertTrue(sqlite3.indices("/root/test.db"))
50     def test_indexes(self):
51         self.assertTrue(sqlite3.indexes(</b></font>"/root/test.db"))
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_ipaddress.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import contextlib
2 import functools
3 import operator
4 import pickle
5 import re
6 import sys
7 import weakref
8 import pytest
9 from salt._compat import ipaddress
10 from tests.support.unit import TestCase, skipIf
11 @functools.total_ordering
12 class _LARGEST:
13     def __eq__(self, other):
14         return isinstance(other, _LARGEST)
15     def __lt__(self, other):
16         return False
17 LARGEST = _LARGEST()
18 @functools.total_ordering
19 class _SMALLEST:
20     def __eq__(self, other):
21         return isinstance(other, _SMALLEST)
22     def __gt__(self, other):
23         return False
24 SMALLEST = _SMALLEST()
25 class BaseTestCase(TestCase):
26     @property
27     def factory(self):
28         raise NotImplementedError
29     @contextlib.contextmanager
30     def assertCleanError(self, exc_type, details, *args):
31         if args:
32             details = details % args
33         cm = self.assertRaisesRegex(exc_type, details)
34         with cm as exc:
35             yield exc
36         if exc.exception.__context__ is not None:
37             self.assertTrue(exc.exception.__suppress_context__)
38     def assertAddressError(self, details, *args):
39         return self.assertCleanError(ipaddress.AddressValueError, details, *args)
40     def assertNetmaskError(self, details, *args):
41         return self.assertCleanError(ipaddress.NetmaskValueError, details, *args)
42     def assertInstancesEqual(self, lhs, rhs):
43         self.assertEqual(self.factory(lhs), self.factory(rhs))
44 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
45 class CommonTestMixin:
46     def test_empty_address(self):
47         with self.assertAddressError("Address cannot be empty"):
48             self.factory("")
49     def test_floats_rejected(self):
50         with self.assertAddressError(re.escape(repr("1.0"))):
51             self.factory(1.0)
52     def test_not_an_index_issue15559(self):
53         self.assertRaises(TypeError, operator.index, self.factory(1))
54         self.assertRaises(TypeError, hex, self.factory(1))
55         self.assertRaises(TypeError, bytes, self.factory(1))
56     def pickle_test(self, addr):
57         for proto in range(pickle.HIGHEST_PROTOCOL + 1):
58             with self.subTest(proto=proto):
59                 x = self.factory(addr)
60                 y = pickle.loads(pickle.dumps(x, proto))
61                 self.assertEqual(y, x)
62 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
63 class CommonTestMixin_v4(CommonTestMixin):
64     def test_leading_zeros(self):
65         msg = r"Leading zeros are not permitted in '\d+'"
66         addresses = [
67             "000.000.000.000",
68             "192.168.000.001",
69             "016.016.016.016",
70             "192.168.000.001",
71             "001.000.008.016",
72             "01.2.3.40",
73             "1.02.3.40",
74             "1.2.03.40",
75             "1.2.3.040",
76         ]
77 <a name="1"></a>        for address in addresses:
78             with self.subTest(address=address):
79                 with self.assertAddressError(msg):
80                     self.factory(add<font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>ress)
81     def test_int(self):
82         self.assertInstancesEqual(0, "0.0.0.0")
83         self.assertInstancesEqual(3232235521, "192.168.0.1")
84     def test_packed(self):
85         self.assertInstancesEqual(bytes.fromhex("00000000"), "0.0.0.0")
86         self.assertInstancesEqual(bytes.fromhex("c0a80001"), "192.168.0.1")
87     def</b></font> test_negative_ints_rejected(self):
88         msg = "-1 (&lt; 0) is not permitted as an IPv4 address"
89         with self.assertAddressError(re.escape(msg)):
90             self.factory(-1)
91     def test_large_ints_rejected(self):
92         msg = "%d (&gt;= 2**32) is not permitted as an IPv4 address"
93         with self.assertAddressError(re.escape(msg % 2 ** 32)):
94             self.factory(2 ** 32)
95     def test_bad_packed_length(self):
96         def assertBadLength(length):
97             addr = b"\0" * length
98             msg = "%r (len %d != 4) is not permitted as an IPv4 address"
99             with self.assertAddressError(re.escape(msg % (addr, length))):
100                 self.factory(addr)
101         assertBadLength(3)
102         assertBadLength(5)
103 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
104 class CommonTestMixin_v6(CommonTestMixin):
105     def test_leading_zeros(self):
106         self.assertInstancesEqual("0000::0000", "::")
107         self.assertInstancesEqual("000::c0a8:0001", "::c0a8:1")
108     def test_int(self):
109         self.assertInstancesEqual(0, "::")
110         self.assertInstancesEqual(3232235521, "::c0a8:1")
111     def test_packed(self):
112         addr = b"\0" * 12 + bytes.fromhex("00000000")
113         self.assertInstancesEqual(addr, "::")
114         addr = b"\0" * 12 + bytes.fromhex("c0a80001")
115         self.assertInstancesEqual(addr, "::c0a8:1")
116         addr = bytes.fromhex("c0a80001") + b"\0" * 12
117         self.assertInstancesEqual(addr, "c0a8:1::")
118     def test_negative_ints_rejected(self):
119         msg = "-1 (&lt; 0) is not permitted as an IPv6 address"
120         with self.assertAddressError(re.escape(msg)):
121             self.factory(-1)
122     def test_large_ints_rejected(self):
123         msg = "%d (&gt;= 2**128) is not permitted as an IPv6 address"
124         with self.assertAddressError(re.escape(msg % 2 ** 128)):
125             self.factory(2 ** 128)
126     def test_bad_packed_length(self):
127         def assertBadLength(length):
128             addr = b"\0" * length
129             msg = "%r (len %d != 16) is not permitted as an IPv6 address"
130             with self.assertAddressError(re.escape(msg % (addr, length))):
131                 self.factory(addr)
132                 self.factory(addr)
133         assertBadLength(15)
134         assertBadLength(17)
135     def test_blank_scope_id(self):
136         address = "::1%"
137         with self.assertAddressError('Invalid IPv6 address: "%r"', address):
138             self.factory(address)
139     def test_invalid_scope_id_with_percent(self):
140         address = "::1%scope%"
141         with self.assertAddressError('Invalid IPv6 address: "%r"', address):
142             self.factory(address)
143 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
144 class AddressTestCase_v4(BaseTestCase, CommonTestMixin_v4):
145     factory = ipaddress.IPv4Address
146     @pytest.mark.skipif(sys.version_info &lt; (3, 6), reason="Don't run on Py3.5")
147     def test_format(self):
148         v4 = ipaddress.IPv4Address("1.2.3.42")
149         v4_pairs = [
150             ("b", "00000001000000100000001100101010"),
151             ("n", "00000001000000100000001100101010"),
152             ("x", "0102032a"),
153             ("X", "0102032A"),
154             ("_b", "0000_0001_0000_0010_0000_0011_0010_1010"),
155             ("_n", "0000_0001_0000_0010_0000_0011_0010_1010"),
156             ("_x", "0102_032a"),
157             ("_X", "0102_032A"),
158             ("#b", "0b00000001000000100000001100101010"),
159             ("#n", "0b00000001000000100000001100101010"),
160             ("#x", "0x0102032a"),
161             ("#X", "0X0102032A"),
162             ("#_b", "0b0000_0001_0000_0010_0000_0011_0010_1010"),
163             ("#_n", "0b0000_0001_0000_0010_0000_0011_0010_1010"),
164             ("#_x", "0x0102_032a"),
165             ("#_X", "0X0102_032A"),
166             ("s", "1.2.3.42"),
167             ("", "1.2.3.42"),
168         ]
169         for (fmt, txt) in v4_pairs:
170             self.assertEqual(txt, format(v4, fmt))
171     def test_network_passed_as_address(self):
172         addr = "127.0.0.1/24"
173         with self.assertAddressError("Unexpected '/' in %r", addr):
174             ipaddress.IPv4Address(addr)
175     def test_bad_address_split(self):
176         def assertBadSplit(addr):
177             with self.assertAddressError("Expected 4 octets in %r", addr):
178                 ipaddress.IPv4Address(addr)
179         assertBadSplit("127.0.1")
180         assertBadSplit("42.42.42.42.42")
181         assertBadSplit("42.42.42")
182         assertBadSplit("42.42")
183         assertBadSplit("42")
184         assertBadSplit("42..42.42.42")
185         assertBadSplit("42.42.42.42.")
186         assertBadSplit("42.42.42.42...")
187         assertBadSplit(".42.42.42.42")
188         assertBadSplit("...42.42.42.42")
189         assertBadSplit("016.016.016")
190         assertBadSplit("016.016")
191         assertBadSplit("016")
192         assertBadSplit("000")
193         assertBadSplit("0x0a.0x0a.0x0a")
194         assertBadSplit("0x0a.0x0a")
195         assertBadSplit("0x0a")
196         assertBadSplit(".")
197         assertBadSplit("bogus")
198         assertBadSplit("bogus.com")
199         assertBadSplit("1000")
200         assertBadSplit("1000000000000000")
201         assertBadSplit("192.168.0.1.com")
202     def test_empty_octet(self):
203         def assertBadOctet(addr):
204             with self.assertAddressError("Empty octet not permitted in %r", addr):
205                 ipaddress.IPv4Address(addr)
206         assertBadOctet("42..42.42")
207         assertBadOctet("...")
208     def test_invalid_characters(self):
209         def assertBadOctet(addr, octet):
210             msg = "Only decimal digits permitted in {!r} in {!r}".format(octet, addr)
211             with self.assertAddressError(re.escape(msg)):
212                 ipaddress.IPv4Address(addr)
213         assertBadOctet("0x0a.0x0a.0x0a.0x0a", "0x0a")
214         assertBadOctet("0xa.0x0a.0x0a.0x0a", "0xa")
215         assertBadOctet("42.42.42.-0", "-0")
216         assertBadOctet("42.42.42.+0", "+0")
217         assertBadOctet("42.42.42.-42", "-42")
218         assertBadOctet("+1.+2.+3.4", "+1")
219         assertBadOctet("1.2.3.4e0", "4e0")
220         assertBadOctet("1.2.3.4::", "4::")
221         assertBadOctet("1.a.2.3", "a")
222     def test_octet_length(self):
223         def assertBadOctet(addr, octet):
224             msg = "At most 3 characters permitted in %r in %r"
225             with self.assertAddressError(re.escape(msg % (octet, addr))):
226                 ipaddress.IPv4Address(addr)
227         assertBadOctet("0000.000.000.000", "0000")
228         assertBadOctet("12345.67899.-54321.-98765", "12345")
229     def test_octet_limit(self):
230         def assertBadOctet(addr, octet):
231             msg = "Octet %d (&gt; 255) not permitted in %r" % (octet, addr)
232             with self.assertAddressError(re.escape(msg)):
233                 ipaddress.IPv4Address(addr)
234         assertBadOctet("257.0.0.0", 257)
235         assertBadOctet("192.168.0.999", 999)
236     def test_pickle(self):
237         self.pickle_test("192.0.2.1")
238     def test_weakref(self):
239         weakref.ref(self.factory("192.0.2.1"))
240 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
241 class AddressTestCase_v6(BaseTestCase, CommonTestMixin_v6):
242     factory = ipaddress.IPv6Address
243     @pytest.mark.skipif(sys.version_info &lt; (3, 6), reason="Don't run on Py3.5")
244     def test_format(self):
245         v6 = ipaddress.IPv6Address("::1.2.3.42")
246         v6_pairs = [
247             (
248                 "b",
249                 "000000000000000000000000000000000000000000000000000000"
250                 "000000000000000000000000000000000000000000000000010000"
251                 "00100000001100101010",
252             ),
253             ("n", "0000000000000000000000000102032a"),
254             ("x", "0000000000000000000000000102032a"),
255             ("X", "0000000000000000000000000102032A"),
256             (
257                 "_b",
258                 "0000_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000"
259                 "_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000"
260                 "_0000_0000_0000_0000_0001_0000_0010_0000_0011_0010"
261                 "_1010",
262             ),
263             ("_n", "0000_0000_0000_0000_0000_0000_0102_032a"),
264             ("_x", "0000_0000_0000_0000_0000_0000_0102_032a"),
265             ("_X", "0000_0000_0000_0000_0000_0000_0102_032A"),
266             (
267                 "#b",
268                 "0b0000000000000000000000000000000000000000000000000000"
269                 "000000000000000000000000000000000000000000000000000100"
270                 "0000100000001100101010",
271             ),
272             ("#n", "0x0000000000000000000000000102032a"),
273             ("#x", "0x0000000000000000000000000102032a"),
274             ("#X", "0X0000000000000000000000000102032A"),
275             (
276                 "#_b",
277                 "0b0000_0000_0000_0000_0000_0000_0000_0000_0000_0000"
278                 "_0000_0000_0000_0000_0000_0000_0000_0000_0000_0000"
279                 "_0000_0000_0000_0000_0000_0001_0000_0010_0000_0011"
280                 "_0010_1010",
281             ),
282             ("#_n", "0x0000_0000_0000_0000_0000_0000_0102_032a"),
283             ("#_x", "0x0000_0000_0000_0000_0000_0000_0102_032a"),
284             ("#_X", "0X0000_0000_0000_0000_0000_0000_0102_032A"),
285             ("s", "::102:32a"),
286             ("", "::102:32a"),
287         ]
288         for (fmt, txt) in v6_pairs:
289             self.assertEqual(txt, format(v6, fmt))
290     def test_network_passed_as_address(self):
291         def assertBadSplit(addr):
292             msg = "Unexpected '/' in %r"
293             with self.assertAddressError(msg, addr):
294                 ipaddress.IPv6Address(addr)
295         assertBadSplit("::1/24")
296         assertBadSplit("::1%scope_id/24")
297     def test_bad_address_split_v6_not_enough_parts(self):
298         def assertBadSplit(addr):
299             msg = "At least 3 parts expected in %r"
300             with self.assertAddressError(msg, addr.split("%")[0]):
301                 ipaddress.IPv6Address(addr)
302         assertBadSplit(":")
303         assertBadSplit(":1")
304         assertBadSplit("FEDC:9878")
305         assertBadSplit(":%scope")
306         assertBadSplit(":1%scope")
307         assertBadSplit("FEDC:9878%scope")
308     def test_bad_address_split_v6_too_many_colons(self):
309         def assertBadSplit(addr):
310             msg = "At most 8 colons permitted in %r"
311             with self.assertAddressError(msg, addr.split("%")[0]):
312                 ipaddress.IPv6Address(addr)
313         assertBadSplit("9:8:7:6:5:4:3::2:1")
314         assertBadSplit("10:9:8:7:6:5:4:3:2:1")
315         assertBadSplit("::8:7:6:5:4:3:2:1")
316         assertBadSplit("8:7:6:5:4:3:2:1::")
317         assertBadSplit("10:9:8:7:6:5:4:3:42.42.42.42")
318         assertBadSplit("9:8:7:6:5:4:3::2:1%scope")
319         assertBadSplit("10:9:8:7:6:5:4:3:2:1%scope")
320         assertBadSplit("::8:7:6:5:4:3:2:1%scope")
321         assertBadSplit("8:7:6:5:4:3:2:1::%scope")
322         assertBadSplit("10:9:8:7:6:5:4:3:42.42.42.42%scope")
323     def test_bad_address_split_v6_too_many_parts(self):
324         def assertBadSplit(addr):
325             msg = "Exactly 8 parts expected without '::' in %r"
326             with self.assertAddressError(msg, addr.split("%")[0]):
327                 ipaddress.IPv6Address(addr)
328         assertBadSplit("3ffe:0:0:0:0:0:0:0:1")
329         assertBadSplit("9:8:7:6:5:4:3:2:1")
330         assertBadSplit("7:6:5:4:3:2:1")
331         assertBadSplit("9:8:7:6:5:4:3:42.42.42.42")
332         assertBadSplit("7:6:5:4:3:42.42.42.42")
333         assertBadSplit("3ffe:0:0:0:0:0:0:0:1%scope")
334         assertBadSplit("9:8:7:6:5:4:3:2:1%scope")
335         assertBadSplit("7:6:5:4:3:2:1%scope")
336         assertBadSplit("9:8:7:6:5:4:3:42.42.42.42%scope")
337         assertBadSplit("7:6:5:4:3:42.42.42.42%scope")
338     def test_bad_address_split_v6_too_many_parts_with_double_colon(self):
339         def assertBadSplit(addr):
340             msg = "Expected at most 7 other parts with '::' in %r"
341             with self.assertAddressError(msg, addr.split("%")[0]):
342                 ipaddress.IPv6Address(addr)
343         assertBadSplit("1:2:3:4::5:6:7:8")
344         assertBadSplit("1:2:3:4::5:6:7:8%scope")
345     def test_bad_address_split_v6_repeated_double_colon(self):
346         def assertBadSplit(addr):
347             msg = "At most one '::' permitted in %r"
348             with self.assertAddressError(msg, addr.split("%")[0]):
349                 ipaddress.IPv6Address(addr)
350         assertBadSplit("3ffe::1::1")
351         assertBadSplit("1::2::3::4:5")
352         assertBadSplit("2001::db:::1")
353         assertBadSplit("3ffe::1::")
354         assertBadSplit("::3ffe::1")
355         assertBadSplit(":3ffe::1::1")
356         assertBadSplit("3ffe::1::1:")
357         assertBadSplit(":3ffe::1::1:")
358         assertBadSplit(":::")
359         assertBadSplit("2001:db8:::1")
360         assertBadSplit("3ffe::1::1%scope")
361         assertBadSplit("1::2::3::4:5%scope")
362         assertBadSplit("2001::db:::1%scope")
363         assertBadSplit("3ffe::1::%scope")
364         assertBadSplit("::3ffe::1%scope")
365         assertBadSplit(":3ffe::1::1%scope")
366         assertBadSplit("3ffe::1::1:%scope")
367         assertBadSplit(":3ffe::1::1:%scope")
368         assertBadSplit(":::%scope")
369         assertBadSplit("2001:db8:::1%scope")
370     def test_bad_address_split_v6_leading_colon(self):
371         def assertBadSplit(addr):
372             msg = "Leading ':' only permitted as part of '::' in %r"
373             with self.assertAddressError(msg, addr.split("%")[0]):
374                 ipaddress.IPv6Address(addr)
375         assertBadSplit(":2001:db8::1")
376         assertBadSplit(":1:2:3:4:5:6:7")
377         assertBadSplit(":1:2:3:4:5:6:")
378         assertBadSplit(":6:5:4:3:2:1::")
379         assertBadSplit(":2001:db8::1%scope")
380         assertBadSplit(":1:2:3:4:5:6:7%scope")
381         assertBadSplit(":1:2:3:4:5:6:%scope")
382         assertBadSplit(":6:5:4:3:2:1::%scope")
383     def test_bad_address_split_v6_trailing_colon(self):
384         def assertBadSplit(addr):
385             msg = "Trailing ':' only permitted as part of '::' in %r"
386             with self.assertAddressError(msg, addr.split("%")[0]):
387                 ipaddress.IPv6Address(addr)
388         assertBadSplit("2001:db8::1:")
389         assertBadSplit("1:2:3:4:5:6:7:")
390         assertBadSplit("::1.2.3.4:")
391         assertBadSplit("::7:6:5:4:3:2:")
392         assertBadSplit("2001:db8::1:%scope")
393         assertBadSplit("1:2:3:4:5:6:7:%scope")
394         assertBadSplit("::1.2.3.4:%scope")
395         assertBadSplit("::7:6:5:4:3:2:%scope")
396     def test_bad_v4_part_in(self):
397         def assertBadAddressPart(addr, v4_error):
398             with self.assertAddressError("%s in %r", v4_error, addr.split("%")[0]):
399                 ipaddress.IPv6Address(addr)
400         assertBadAddressPart("3ffe::1.net", "Expected 4 octets in '1.net'")
401         assertBadAddressPart("3ffe::127.0.1", "Expected 4 octets in '127.0.1'")
402         assertBadAddressPart("::1.2.3", "Expected 4 octets in '1.2.3'")
403         assertBadAddressPart("::1.2.3.4.5", "Expected 4 octets in '1.2.3.4.5'")
404         assertBadAddressPart(
405             "3ffe::1.1.1.net",
406             "Only decimal digits permitted in 'net' in '1.1.1.net'",
407         )
408         assertBadAddressPart("3ffe::1.net%scope", "Expected 4 octets in '1.net'")
409         assertBadAddressPart("3ffe::127.0.1%scope", "Expected 4 octets in '127.0.1'")
410         assertBadAddressPart("::1.2.3%scope", "Expected 4 octets in '1.2.3'")
411         assertBadAddressPart("::1.2.3.4.5%scope", "Expected 4 octets in '1.2.3.4.5'")
412         assertBadAddressPart(
413             "3ffe::1.1.1.net%scope",
414             "Only decimal digits permitted in 'net' in '1.1.1.net'",
415         )
416     def test_invalid_characters(self):
417         def assertBadPart(addr, part):
418             msg = "Only hex digits permitted in {!r} in {!r}".format(
419                 part, addr.split("%")[0]
420             )
421             with self.assertAddressError(re.escape(msg)):
422                 ipaddress.IPv6Address(addr)
423         assertBadPart("3ffe::goog", "goog")
424         assertBadPart("3ffe::-0", "-0")
425         assertBadPart("3ffe::+0", "+0")
426         assertBadPart("3ffe::-1", "-1")
427         assertBadPart("1.2.3.4::", "1.2.3.4")
428         assertBadPart("1234:axy::b", "axy")
429         assertBadPart("3ffe::goog%scope", "goog")
430         assertBadPart("3ffe::-0%scope", "-0")
431         assertBadPart("3ffe::+0%scope", "+0")
432         assertBadPart("3ffe::-1%scope", "-1")
433         assertBadPart("1.2.3.4::%scope", "1.2.3.4")
434         assertBadPart("1234:axy::b%scope", "axy")
435     def test_part_length(self):
436         def assertBadPart(addr, part):
437             msg = "At most 4 characters permitted in %r in %r"
438             with self.assertAddressError(msg, part, addr.split("%")[0]):
439                 ipaddress.IPv6Address(addr)
440         assertBadPart("::00000", "00000")
441         assertBadPart("3ffe::10000", "10000")
442         assertBadPart("02001:db8::", "02001")
443         assertBadPart("2001:888888::1", "888888")
444         assertBadPart("::00000%scope", "00000")
445         assertBadPart("3ffe::10000%scope", "10000")
446         assertBadPart("02001:db8::%scope", "02001")
447         assertBadPart("2001:888888::1%scope", "888888")
448     def test_pickle(self):
449         self.pickle_test("2001:db8::")
450     def test_weakref(self):
451         weakref.ref(self.factory("2001:db8::"))
452         weakref.ref(self.factory("2001:db8::%scope"))
453 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
454 class NetmaskTestMixin_v4(CommonTestMixin_v4):
455     def test_no_mask(self):
456         for address in ("1.2.3.4", 0x01020304, b"\x01\x02\x03\x04"):
457             net = self.factory(address)
458             self.assertEqual(str(net), "1.2.3.4/32")
459             self.assertEqual(str(net.netmask), "255.255.255.255")
460             self.assertEqual(str(net.hostmask), "0.0.0.0")
461     def test_split_netmask(self):
462         addr = "1.2.3.4/32/24"
463         with self.assertAddressError("Only one '/' permitted in %r" % addr):
464             self.factory(addr)
465     def test_address_errors(self):
466         def assertBadAddress(addr, details):
467             with self.assertAddressError(details):
468                 self.factory(addr)
469         assertBadAddress("/", "Address cannot be empty")
470         assertBadAddress("/8", "Address cannot be empty")
471         assertBadAddress("bogus", "Expected 4 octets")
472         assertBadAddress("google.com", "Expected 4 octets")
473         assertBadAddress("10/8", "Expected 4 octets")
474         assertBadAddress("::1.2.3.4", "Only decimal digits")
475         assertBadAddress("1.2.3.256", re.escape("256 (&gt; 255)"))
476     def test_valid_netmask(self):
477         self.assertEqual(str(self.factory("192.0.2.0/255.255.255.0")), "192.0.2.0/24")
478         for i in range(0, 33):
479             net_str = "0.0.0.0/%d" % i
480             net = self.factory(net_str)
481             self.assertEqual(str(net), net_str)
482             self.assertEqual(str(self.factory("0.0.0.0/%s" % net.netmask)), net_str)
483             self.assertEqual(str(self.factory("0.0.0.0/0%d" % i)), net_str)
484             if i in (32, 0):
485                 net_str = "0.0.0.0/%d" % (32 - i)
486             self.assertEqual(str(self.factory("0.0.0.0/%s" % net.hostmask)), net_str)
487     def test_netmask_errors(self):
488         def assertBadNetmask(addr, netmask):
489             msg = "%r is not a valid netmask" % netmask
490             with self.assertNetmaskError(re.escape(msg)):
491                 self.factory("{}/{}".format(addr, netmask))
492         assertBadNetmask("1.2.3.4", "")
493         assertBadNetmask("1.2.3.4", "-1")
494         assertBadNetmask("1.2.3.4", "+1")
495         assertBadNetmask("1.2.3.4", " 1 ")
496         assertBadNetmask("1.2.3.4", "0x1")
497         assertBadNetmask("1.2.3.4", "33")
498         assertBadNetmask("1.2.3.4", "254.254.255.256")
499         assertBadNetmask("1.2.3.4", "1.a.2.3")
500         assertBadNetmask("1.1.1.1", "254.xyz.2.3")
501         assertBadNetmask("1.1.1.1", "240.255.0.0")
502         assertBadNetmask("1.1.1.1", "255.254.128.0")
503         assertBadNetmask("1.1.1.1", "0.1.127.255")
504         assertBadNetmask("1.1.1.1", "pudding")
505         assertBadNetmask("1.1.1.1", "::")
506     def test_netmask_in_tuple_errors(self):
507         def assertBadNetmask(addr, netmask):
508             msg = "%r is not a valid netmask" % netmask
509             with self.assertNetmaskError(re.escape(msg)):
510                 self.factory((addr, netmask))
511         assertBadNetmask("1.1.1.1", -1)
512         assertBadNetmask("1.1.1.1", 33)
513     def test_pickle(self):
514         self.pickle_test("192.0.2.0/27")
515         self.pickle_test("192.0.2.0/31")  # IPV4LENGTH - 1
516         self.pickle_test("192.0.2.0")  # IPV4LENGTH
517 class InterfaceTestCase_v4(BaseTestCase, NetmaskTestMixin_v4):
518     factory = ipaddress.IPv4Interface
519 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
520 class NetworkTestCase_v4(BaseTestCase, NetmaskTestMixin_v4):
521     factory = ipaddress.IPv4Network
522     def test_subnet_of(self):
523         self.assertFalse(
524             self.factory("10.0.0.0/30").subnet_of(self.factory("10.0.1.0/24"))
525         )
526         self.assertTrue(
527             self.factory("10.0.0.0/30").subnet_of(self.factory("10.0.0.0/24"))
528         )
529         self.assertFalse(
530 <a name="0"></a>            self.factory("10.0.0.0/30").subnet_of(self.factory("10.0.1.0/24"))
531         )
532         self<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.assertFalse(
533             self.factory("10.0.1.0/24").subnet_of(self.factory("10.0.0.0/30"))
534         )
535     def test_supernet_of(self):
536         self.assertFalse(
537             self.factory("10.0.0.0/30").supernet_of(self.factory(</b></font>"10.0.1.0/24"))
538         )
539         self.assertFalse(
540             self.factory("10.0.0.0/30").supernet_of(self.factory("10.0.0.0/24"))
541         )
542         self.assertFalse(
543             self.factory("10.0.0.0/30").supernet_of(self.factory("10.0.1.0/24"))
544         )
545         self.assertTrue(
546             self.factory("10.0.0.0/24").supernet_of(self.factory("10.0.0.0/30"))
547         )
548     def test_subnet_of_mixed_types(self):
549         with self.assertRaises(TypeError):
550             ipaddress.IPv4Network("10.0.0.0/30").supernet_of(
551                 ipaddress.IPv6Network("::1/128")
552             )
553         with self.assertRaises(TypeError):
554             ipaddress.IPv6Network("::1/128").supernet_of(
555                 ipaddress.IPv4Network("10.0.0.0/30")
556             )
557         with self.assertRaises(TypeError):
558             ipaddress.IPv4Network("10.0.0.0/30").subnet_of(
559                 ipaddress.IPv6Network("::1/128")
560             )
561         with self.assertRaises(TypeError):
562             ipaddress.IPv6Network("::1/128").subnet_of(
563                 ipaddress.IPv4Network("10.0.0.0/30")
564             )
565 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
566 class NetmaskTestMixin_v6(CommonTestMixin_v6):
567     def test_no_mask(self):
568         for address in ("::1", 1, b"\x00" * 15 + b"\x01"):
569             net = self.factory(address)
570             self.assertEqual(str(net), "::1/128")
571             self.assertEqual(
572                 str(net.netmask), "ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
573             )
574             self.assertEqual(str(net.hostmask), "::")
575         scoped_net = self.factory("::1%scope")
576         self.assertEqual(str(scoped_net), "::1%scope/128")
577         self.assertEqual(
578             str(scoped_net.netmask), "ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff"
579         )
580         self.assertEqual(str(scoped_net.hostmask), "::")
581     def test_split_netmask(self):
582         addr = "cafe:cafe::/128/190"
583         with self.assertAddressError("Only one '/' permitted in %r" % addr):
584             self.factory(addr)
585         scoped_addr = "cafe:cafe::%scope/128/190"
586         with self.assertAddressError("Only one '/' permitted in %r" % scoped_addr):
587             self.factory(scoped_addr)
588     def test_address_errors(self):
589         def assertBadAddress(addr, details):
590             with self.assertAddressError(details):
591                 self.factory(addr)
592         assertBadAddress("/", "Address cannot be empty")
593         assertBadAddress("/8", "Address cannot be empty")
594         assertBadAddress("google.com", "At least 3 parts")
595         assertBadAddress("1.2.3.4", "At least 3 parts")
596         assertBadAddress("10/8", "At least 3 parts")
597         assertBadAddress("1234:axy::b", "Only hex digits")
598         assertBadAddress("/%scope", "Address cannot be empty")
599         assertBadAddress("/%scope8", "Address cannot be empty")
600         assertBadAddress("google.com%scope", "At least 3 parts")
601         assertBadAddress("1.2.3.4%scope", "At least 3 parts")
602         assertBadAddress("10%scope/8", "At least 3 parts")
603         assertBadAddress("1234:axy::b%scope", "Only hex digits")
604     def test_valid_netmask(self):
605         self.assertEqual(str(self.factory("2001:db8::/32")), "2001:db8::/32")
606         for i in range(0, 129):
607             net_str = "::/%d" % i
608             self.assertEqual(str(self.factory(net_str)), net_str)
609             self.assertEqual(str(self.factory("::/0%d" % i)), net_str)
610         self.assertEqual(
611             str(self.factory("2001:db8::%scope/32")), "2001:db8::%scope/32"
612         )
613         for i in range(0, 129):
614             net_str = "::/%d" % i
615             self.assertEqual(str(self.factory(net_str)), net_str)
616             self.assertEqual(str(self.factory("::/0%d" % i)), net_str)
617     def test_netmask_errors(self):
618         def assertBadNetmask(addr, netmask):
619             msg = "%r is not a valid netmask" % netmask
620             with self.assertNetmaskError(re.escape(msg)):
621                 self.factory("{}/{}".format(addr, netmask))
622         assertBadNetmask("::1", "")
623         assertBadNetmask("::1", "::1")
624         assertBadNetmask("::1", "1::")
625         assertBadNetmask("::1", "-1")
626         assertBadNetmask("::1", "+1")
627         assertBadNetmask("::1", " 1 ")
628         assertBadNetmask("::1", "0x1")
629         assertBadNetmask("::1", "129")
630         assertBadNetmask("::1", "1.2.3.4")
631         assertBadNetmask("::1", "pudding")
632         assertBadNetmask("::", "::")
633         assertBadNetmask("::1%scope", "pudding")
634     def test_netmask_in_tuple_errors(self):
635         def assertBadNetmask(addr, netmask):
636             msg = "%r is not a valid netmask" % netmask
637             with self.assertNetmaskError(re.escape(msg)):
638                 self.factory((addr, netmask))
639         assertBadNetmask("::1", -1)
640         assertBadNetmask("::1", 129)
641         assertBadNetmask("::1%scope", 129)
642     def test_pickle(self):
643         self.pickle_test("2001:db8::1000/124")
644         self.pickle_test("2001:db8::1000/127")  # IPV6LENGTH - 1
645         self.pickle_test("2001:db8::1000")  # IPV6LENGTH
646         self.pickle_test("2001:db8::1000%scope")  # IPV6LENGTH
647 class InterfaceTestCase_v6(BaseTestCase, NetmaskTestMixin_v6):
648     factory = ipaddress.IPv6Interface
649 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
650 class NetworkTestCase_v6(BaseTestCase, NetmaskTestMixin_v6):
651     factory = ipaddress.IPv6Network
652     def test_subnet_of(self):
653         self.assertFalse(
654             self.factory("2000:999::/56").subnet_of(self.factory("2000:aaa::/48"))
655         )
656         self.assertTrue(
657             self.factory("2000:aaa::/56").subnet_of(self.factory("2000:aaa::/48"))
658         )
659         self.assertFalse(
660             self.factory("2000:bbb::/56").subnet_of(self.factory("2000:aaa::/48"))
661         )
662         self.assertFalse(
663             self.factory("2000:aaa::/48").subnet_of(self.factory("2000:aaa::/56"))
664         )
665         self.assertFalse(
666             self.factory("2000:999::%scope/56").subnet_of(
667 <a name="2"></a>                self.factory("2000:aaa::%scope/48")
668             )
669         )
670         self<font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.assertTrue(
671             self.factory("2000:aaa::%scope/56").subnet_of(
672                 self.factory("2000:aaa::%scope/48")
673             )
674         )
675     def test_supernet_of(self):
676         self.assertFalse(
677             self.factory(</b></font>"2000:999::/56").supernet_of(self.factory("2000:aaa::/48"))
678         )
679         self.assertFalse(
680             self.factory("2000:aaa::/56").supernet_of(self.factory("2000:aaa::/48"))
681         )
682         self.assertFalse(
683             self.factory("2000:bbb::/56").supernet_of(self.factory("2000:aaa::/48"))
684         )
685         self.assertTrue(
686             self.factory("2000:aaa::/48").supernet_of(self.factory("2000:aaa::/56"))
687         )
688 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
689 class FactoryFunctionErrors(BaseTestCase):
690     def assertFactoryError(self, factory, kind):
691         addr = "camelot"
692         msg = "%r does not appear to be an IPv4 or IPv6 %s"
693         with self.assertCleanError(ValueError, msg, addr, kind):
694             factory(addr)
695     def test_ip_address(self):
696         self.assertFactoryError(ipaddress.ip_address, "address")
697     def test_ip_interface(self):
698         self.assertFactoryError(ipaddress.ip_interface, "interface")
699     def test_ip_network(self):
700         self.assertFactoryError(ipaddress.ip_network, "network")
701 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
702 class ComparisonTests(TestCase):
703     v4addr = ipaddress.IPv4Address(1)
704     v4net = ipaddress.IPv4Network(1)
705     v4intf = ipaddress.IPv4Interface(1)
706     v6addr = ipaddress.IPv6Address(1)
707     v6net = ipaddress.IPv6Network(1)
708     v6intf = ipaddress.IPv6Interface(1)
709     v6addr_scoped = ipaddress.IPv6Address("::1%scope")
710     v6net_scoped = ipaddress.IPv6Network("::1%scope")
711     v6intf_scoped = ipaddress.IPv6Interface("::1%scope")
712     v4_addresses = [v4addr, v4intf]
713     v4_objects = v4_addresses + [v4net]
714     v6_addresses = [v6addr, v6intf]
715     v6_objects = v6_addresses + [v6net]
716     v6_scoped_addresses = [v6addr_scoped, v6intf_scoped]
717     v6_scoped_objects = v6_scoped_addresses + [v6net_scoped]
718     objects = v4_objects + v6_objects
719     objects_with_scoped = objects + v6_scoped_objects
720     v4addr2 = ipaddress.IPv4Address(2)
721     v4net2 = ipaddress.IPv4Network(2)
722     v4intf2 = ipaddress.IPv4Interface(2)
723     v6addr2 = ipaddress.IPv6Address(2)
724     v6net2 = ipaddress.IPv6Network(2)
725     v6intf2 = ipaddress.IPv6Interface(2)
726     v6addr2_scoped = ipaddress.IPv6Address("::2%scope")
727     v6net2_scoped = ipaddress.IPv6Network("::2%scope")
728     v6intf2_scoped = ipaddress.IPv6Interface("::2%scope")
729     def test_foreign_type_equality(self):
730         other = object()
731         for obj in self.objects_with_scoped:
732             self.assertNotEqual(obj, other)
733             self.assertFalse(obj == other)
734             self.assertEqual(obj.__eq__(other), NotImplemented)
735             self.assertEqual(obj.__ne__(other), NotImplemented)
736     def test_mixed_type_equality(self):
737         for lhs in self.objects:
738             for rhs in self.objects:
739                 if lhs is rhs:
740                     continue
741                 self.assertNotEqual(lhs, rhs)
742     def test_scoped_ipv6_equality(self):
743         for lhs, rhs in zip(self.v6_objects, self.v6_scoped_objects):
744             self.assertNotEqual(lhs, rhs)
745     def test_v4_with_v6_scoped_equality(self):
746         for lhs in self.v4_objects:
747             for rhs in self.v6_scoped_objects:
748                 self.assertNotEqual(lhs, rhs)
749     def test_same_type_equality(self):
750         for obj in self.objects_with_scoped:
751             self.assertEqual(obj, obj)
752             self.assertLessEqual(obj, obj)
753             self.assertGreaterEqual(obj, obj)
754     def test_same_type_ordering(self):
755         for lhs, rhs in (
756             (self.v4addr, self.v4addr2),
757             (self.v4net, self.v4net2),
758             (self.v4intf, self.v4intf2),
759             (self.v6addr, self.v6addr2),
760             (self.v6net, self.v6net2),
761             (self.v6intf, self.v6intf2),
762             (self.v6addr_scoped, self.v6addr2_scoped),
763             (self.v6net_scoped, self.v6net2_scoped),
764             (self.v6intf_scoped, self.v6intf2_scoped),
765         ):
766             self.assertNotEqual(lhs, rhs)
767             self.assertLess(lhs, rhs)
768             self.assertLessEqual(lhs, rhs)
769             self.assertGreater(rhs, lhs)
770             self.assertGreaterEqual(rhs, lhs)
771             self.assertFalse(lhs &gt; rhs)
772             self.assertFalse(rhs &lt; lhs)
773             self.assertFalse(lhs &gt;= rhs)
774             self.assertFalse(rhs &lt;= lhs)
775     def test_containment(self):
776         for obj in self.v4_addresses:
777             self.assertIn(obj, self.v4net)
778         for obj in self.v6_addresses + self.v6_scoped_addresses:
779             self.assertIn(obj, self.v6net)
780         for obj in self.v6_addresses + self.v6_scoped_addresses:
781             self.assertIn(obj, self.v6net_scoped)
782         for obj in self.v4_objects + [self.v6net, self.v6net_scoped]:
783             self.assertNotIn(obj, self.v6net)
784         for obj in self.v4_objects + [self.v6net, self.v6net_scoped]:
785             self.assertNotIn(obj, self.v6net_scoped)
786         for obj in self.v6_objects + self.v6_scoped_objects + [self.v4net]:
787             self.assertNotIn(obj, self.v4net)
788     def test_mixed_type_ordering(self):
789         for lhs in self.objects_with_scoped:
790             for rhs in self.objects_with_scoped:
791                 if isinstance(lhs, type(rhs)) or isinstance(rhs, type(lhs)):
792                     continue
793                 self.assertRaises(TypeError, lambda: lhs &lt; rhs)
794                 self.assertRaises(TypeError, lambda: lhs &gt; rhs)
795                 self.assertRaises(TypeError, lambda: lhs &lt;= rhs)
796                 self.assertRaises(TypeError, lambda: lhs &gt;= rhs)
797     def test_foreign_type_ordering(self):
798         other = object()
799         for obj in self.objects_with_scoped:
800             with self.assertRaises(TypeError):
801                 obj &lt; other
802             with self.assertRaises(TypeError):
803                 obj &gt; other
804             with self.assertRaises(TypeError):
805                 obj &lt;= other
806             with self.assertRaises(TypeError):
807                 obj &gt;= other
808             self.assertTrue(obj &lt; LARGEST)
809             self.assertFalse(obj &gt; LARGEST)
810             self.assertTrue(obj &lt;= LARGEST)
811             self.assertFalse(obj &gt;= LARGEST)
812             self.assertFalse(obj &lt; SMALLEST)
813             self.assertTrue(obj &gt; SMALLEST)
814             self.assertFalse(obj &lt;= SMALLEST)
815             self.assertTrue(obj &gt;= SMALLEST)
816     def test_mixed_type_key(self):
817         v4_ordered = [self.v4addr, self.v4net, self.v4intf]
818         v6_ordered = [self.v6addr, self.v6net, self.v6intf]
819         v6_scoped_ordered = [self.v6addr_scoped, self.v6net_scoped, self.v6intf_scoped]
820         self.assertEqual(
821             v4_ordered, sorted(self.v4_objects, key=ipaddress.get_mixed_type_key)
822         )
823         self.assertEqual(
824             v6_ordered, sorted(self.v6_objects, key=ipaddress.get_mixed_type_key)
825         )
826         self.assertEqual(
827             v6_scoped_ordered,
828             sorted(self.v6_scoped_objects, key=ipaddress.get_mixed_type_key),
829         )
830         self.assertEqual(
831             v4_ordered + v6_scoped_ordered,
832             sorted(
833                 self.v4_objects + self.v6_scoped_objects,
834                 key=ipaddress.get_mixed_type_key,
835             ),
836         )
837         self.assertEqual(NotImplemented, ipaddress.get_mixed_type_key(object))
838     def test_incompatible_versions(self):
839         v4addr = ipaddress.ip_address("1.1.1.1")
840         v4net = ipaddress.ip_network("1.1.1.1")
841         v6addr = ipaddress.ip_address("::1")
842         v6net = ipaddress.ip_network("::1")
843         v6addr_scoped = ipaddress.ip_address("::1%scope")
844         v6net_scoped = ipaddress.ip_network("::1%scope")
845         self.assertRaises(TypeError, v4addr.__lt__, v6addr)
846         self.assertRaises(TypeError, v4addr.__gt__, v6addr)
847         self.assertRaises(TypeError, v4net.__lt__, v6net)
848         self.assertRaises(TypeError, v4net.__gt__, v6net)
849         self.assertRaises(TypeError, v6addr.__lt__, v4addr)
850         self.assertRaises(TypeError, v6addr.__gt__, v4addr)
851         self.assertRaises(TypeError, v6net.__lt__, v4net)
852         self.assertRaises(TypeError, v6net.__gt__, v4net)
853         self.assertRaises(TypeError, v4addr.__lt__, v6addr_scoped)
854         self.assertRaises(TypeError, v4addr.__gt__, v6addr_scoped)
855         self.assertRaises(TypeError, v4net.__lt__, v6net_scoped)
856         self.assertRaises(TypeError, v4net.__gt__, v6net_scoped)
857         self.assertRaises(TypeError, v6addr_scoped.__lt__, v4addr)
858         self.assertRaises(TypeError, v6addr_scoped.__gt__, v4addr)
859         self.assertRaises(TypeError, v6net_scoped.__lt__, v4net)
860         self.assertRaises(TypeError, v6net_scoped.__gt__, v4net)
861 @skipIf(sys.version_info &gt;= (3, 9, 5), "We use builtin ipaddress on Python &gt;= 3.9.5")
862 class IpaddrUnitTest(TestCase):
863     def setUp(self):
864         self.ipv4_address = ipaddress.IPv4Address("1.2.3.4")
865         self.ipv4_interface = ipaddress.IPv4Interface("1.2.3.4/24")
866         self.ipv4_network = ipaddress.IPv4Network("1.2.3.0/24")
867         self.ipv6_address = ipaddress.IPv6Interface("2001:658:22a:cafe:200:0:0:1")
868         self.ipv6_interface = ipaddress.IPv6Interface("2001:658:22a:cafe:200:0:0:1/64")
869         self.ipv6_network = ipaddress.IPv6Network("2001:658:22a:cafe::/64")
870         self.ipv6_scoped_address = ipaddress.IPv6Interface(
871             "2001:658:22a:cafe:200:0:0:1%scope"
872         )
873         self.ipv6_scoped_interface = ipaddress.IPv6Interface(
874             "2001:658:22a:cafe:200:0:0:1%scope/64"
875         )
876         self.ipv6_scoped_network = ipaddress.IPv6Network("2001:658:22a:cafe::%scope/64")
877     def testRepr(self):
878         self.assertEqual(
879             "IPv4Interface('1.2.3.4/32')", repr(ipaddress.IPv4Interface("1.2.3.4"))
880         )
881         self.assertEqual(
882             "IPv6Interface('::1/128')", repr(ipaddress.IPv6Interface("::1"))
883         )
884         self.assertEqual(
885             "IPv6Interface('::1%scope/128')", repr(ipaddress.IPv6Interface("::1%scope"))
886         )
887     def testIPv4Tuple(self):
888         ip = ipaddress.IPv4Address("192.0.2.1")
889         net = ipaddress.IPv4Network("192.0.2.1/32")
890         self.assertEqual(ipaddress.IPv4Network(("192.0.2.1", 32)), net)
891         self.assertEqual(ipaddress.IPv4Network((ip, 32)), net)
892         self.assertEqual(ipaddress.IPv4Network((3221225985, 32)), net)
893         self.assertEqual(ipaddress.IPv4Network(("192.0.2.1", "255.255.255.255")), net)
894         self.assertEqual(ipaddress.IPv4Network((ip, "255.255.255.255")), net)
895         self.assertEqual(ipaddress.IPv4Network((3221225985, "255.255.255.255")), net)
896         with self.assertRaises(ValueError):
897             ipaddress.IPv4Network(("192.0.2.1", 24))
898         with self.assertRaises(ValueError):
899             ipaddress.IPv4Network((ip, 24))
900         with self.assertRaises(ValueError):
901             ipaddress.IPv4Network((3221225985, 24))
902         with self.assertRaises(ValueError):
903             ipaddress.IPv4Network(("192.0.2.1", "255.255.255.0"))
904         with self.assertRaises(ValueError):
905             ipaddress.IPv4Network((ip, "255.255.255.0"))
906         with self.assertRaises(ValueError):
907             ipaddress.IPv4Network((3221225985, "255.255.255.0"))
908         net = ipaddress.IPv4Network("192.0.2.0/24")
909         self.assertEqual(ipaddress.IPv4Network(("192.0.2.1", 24), strict=False), net)
910         self.assertEqual(ipaddress.IPv4Network((ip, 24), strict=False), net)
911         self.assertEqual(ipaddress.IPv4Network((3221225985, 24), strict=False), net)
912         self.assertEqual(
913             ipaddress.IPv4Network(("192.0.2.1", "255.255.255.0"), strict=False), net
914         )
915         self.assertEqual(
916             ipaddress.IPv4Network((ip, "255.255.255.0"), strict=False), net
917         )
918         self.assertEqual(
919             ipaddress.IPv4Network((3221225985, "255.255.255.0"), strict=False), net
920         )
921         ip = ipaddress.IPv4Address("192.0.2.0")
922         net = ipaddress.IPv4Network("192.0.2.0/24")
923         self.assertEqual(ipaddress.IPv4Network(("192.0.2.0", "255.255.255.0")), net)
924         self.assertEqual(ipaddress.IPv4Network((ip, "255.255.255.0")), net)
925         self.assertEqual(ipaddress.IPv4Network((3221225984, "255.255.255.0")), net)
926         self.assertEqual(ipaddress.IPv4Network(("192.0.2.0", 24)), net)
927         self.assertEqual(ipaddress.IPv4Network((ip, 24)), net)
928         self.assertEqual(ipaddress.IPv4Network((3221225984, 24)), net)
929         self.assertEqual(
930             ipaddress.IPv4Interface(("192.0.2.1", 24)),
931             ipaddress.IPv4Interface("192.0.2.1/24"),
932         )
933         self.assertEqual(
934             ipaddress.IPv4Interface((3221225985, 24)),
935             ipaddress.IPv4Interface("192.0.2.1/24"),
936         )
937     def testIPv6Tuple(self):
938         ip = ipaddress.IPv6Address("2001:db8::")
939         net = ipaddress.IPv6Network("2001:db8::/128")
940         self.assertEqual(ipaddress.IPv6Network(("2001:db8::", "128")), net)
941         self.assertEqual(
942             ipaddress.IPv6Network((42540766411282592856903984951653826560, 128)), net
943         )
944         self.assertEqual(ipaddress.IPv6Network((ip, "128")), net)
945         ip = ipaddress.IPv6Address("2001:db8::")
946         net = ipaddress.IPv6Network("2001:db8::/96")
947         self.assertEqual(ipaddress.IPv6Network(("2001:db8::", "96")), net)
948         self.assertEqual(
949             ipaddress.IPv6Network((42540766411282592856903984951653826560, 96)), net
950         )
951         self.assertEqual(ipaddress.IPv6Network((ip, "96")), net)
952         ip_scoped = ipaddress.IPv6Address("2001:db8::%scope")
953         ip = ipaddress.IPv6Address("2001:db8::1")
954         with self.assertRaises(ValueError):
955             ipaddress.IPv6Network(("2001:db8::1", 96))
956         with self.assertRaises(ValueError):
957             ipaddress.IPv6Network((42540766411282592856903984951653826561, 96))
958         with self.assertRaises(ValueError):
959             ipaddress.IPv6Network((ip, 96))
960         net = ipaddress.IPv6Network("2001:db8::/96")
961         self.assertEqual(ipaddress.IPv6Network(("2001:db8::1", 96), strict=False), net)
962         self.assertEqual(
963             ipaddress.IPv6Network(
964                 (42540766411282592856903984951653826561, 96), strict=False
965             ),
966             net,
967         )
968         self.assertEqual(ipaddress.IPv6Network((ip, 96), strict=False), net)
969         self.assertEqual(
970             ipaddress.IPv6Interface(("2001:db8::1", "96")),
971             ipaddress.IPv6Interface("2001:db8::1/96"),
972         )
973         self.assertEqual(
974             ipaddress.IPv6Interface((42540766411282592856903984951653826561, "96")),
975             ipaddress.IPv6Interface("2001:db8::1/96"),
976         )
977         ip_scoped = ipaddress.IPv6Address("2001:db8::1%scope")
978         with self.assertRaises(ValueError):
979             ipaddress.IPv6Network(("2001:db8::1%scope", 96))
980         with self.assertRaises(ValueError):
981             ipaddress.IPv6Network((ip_scoped, 96))
982     def testAddressIntMath(self):
983         self.assertEqual(
984             ipaddress.IPv4Address("1.1.1.1") + 255, ipaddress.IPv4Address("1.1.2.0")
985         )
986         self.assertEqual(
987             ipaddress.IPv4Address("1.1.1.1") - 256, ipaddress.IPv4Address("1.1.0.1")
988         )
989         self.assertEqual(
990             ipaddress.IPv6Address("::1") + (2 ** 16 - 2),
991             ipaddress.IPv6Address("::ffff"),
992         )
993         self.assertEqual(
994             ipaddress.IPv6Address("::ffff") - (2 ** 16 - 2),
995             ipaddress.IPv6Address("::1"),
996         )
997         self.assertNotEqual(
998             ipaddress.IPv6Address("::1%scope") + (2 ** 16 - 2),
999             ipaddress.IPv6Address("::ffff%scope"),
1000         )
1001         self.assertNotEqual(
1002             ipaddress.IPv6Address("::ffff%scope") - (2 ** 16 - 2),
1003             ipaddress.IPv6Address("::1%scope"),
1004         )
1005     def testInvalidIntToBytes(self):
1006         self.assertRaises(ValueError, ipaddress.v4_int_to_packed, -1)
1007         self.assertRaises(
1008             ValueError, ipaddress.v4_int_to_packed, 2 ** ipaddress.IPV4LENGTH
1009         )
1010         self.assertRaises(ValueError, ipaddress.v6_int_to_packed, -1)
1011         self.assertRaises(
1012             ValueError, ipaddress.v6_int_to_packed, 2 ** ipaddress.IPV6LENGTH
1013         )
1014     def testInternals(self):
1015         ip1 = ipaddress.IPv4Address("10.10.10.10")
1016         ip2 = ipaddress.IPv4Address("10.10.10.11")
1017         ip3 = ipaddress.IPv4Address("10.10.10.12")
1018         self.assertEqual(list(ipaddress._find_address_range([ip1])), [(ip1, ip1)])
1019         self.assertEqual(
1020             list(ipaddress._find_address_range([ip1, ip3])), [(ip1, ip1), (ip3, ip3)]
1021         )
1022         self.assertEqual(
1023             list(ipaddress._find_address_range([ip1, ip2, ip3])), [(ip1, ip3)]
1024         )
1025         self.assertEqual(128, ipaddress._count_righthand_zero_bits(0, 128))
1026         self.assertEqual("IPv4Network('1.2.3.0/24')", repr(self.ipv4_network))
1027     def testGetNetwork(self):
1028         self.assertEqual(int(self.ipv4_network.network_address), 16909056)
1029         self.assertEqual(str(self.ipv4_network.network_address), "1.2.3.0")
1030         self.assertEqual(
1031             int(self.ipv6_network.network_address),
1032             42540616829182469433403647294022090752,
1033         )
1034         self.assertEqual(str(self.ipv6_network.network_address), "2001:658:22a:cafe::")
1035         self.assertEqual(str(self.ipv6_network.hostmask), "::ffff:ffff:ffff:ffff")
1036         self.assertEqual(
1037             int(self.ipv6_scoped_network.network_address),
1038             42540616829182469433403647294022090752,
1039         )
1040         self.assertEqual(
1041             str(self.ipv6_scoped_network.network_address), "2001:658:22a:cafe::%scope"
1042         )
1043         self.assertEqual(
1044             str(self.ipv6_scoped_network.hostmask), "::ffff:ffff:ffff:ffff"
1045         )
1046     def testIpFromInt(self):
1047         self.assertEqual(self.ipv4_interface._ip, ipaddress.IPv4Interface(16909060)._ip)
1048         ipv4 = ipaddress.ip_network("1.2.3.4")
1049         ipv6 = ipaddress.ip_network("2001:658:22a:cafe:200:0:0:1")
1050         ipv6_scoped = ipaddress.ip_network("2001:658:22a:cafe:200:0:0:1%scope")
1051         self.assertEqual(ipv4, ipaddress.ip_network(int(ipv4.network_address)))
1052         self.assertEqual(ipv6, ipaddress.ip_network(int(ipv6.network_address)))
1053         self.assertNotEqual(
1054             ipv6_scoped, ipaddress.ip_network(int(ipv6_scoped.network_address))
1055         )
1056         v6_int = 42540616829182469433547762482097946625
1057         self.assertEqual(self.ipv6_interface._ip, ipaddress.IPv6Interface(v6_int)._ip)
1058         self.assertEqual(
1059             self.ipv6_scoped_interface._ip, ipaddress.IPv6Interface(v6_int)._ip
1060         )
1061         self.assertEqual(ipaddress.ip_network(self.ipv4_address._ip).version, 4)
1062         self.assertEqual(ipaddress.ip_network(self.ipv6_address._ip).version, 6)
1063         self.assertEqual(ipaddress.ip_network(self.ipv6_scoped_address._ip).version, 6)
1064     def testIpFromPacked(self):
1065         address = ipaddress.ip_address
1066         self.assertEqual(
1067             self.ipv4_interface._ip, ipaddress.ip_interface(b"\x01\x02\x03\x04")._ip
1068         )
1069         self.assertEqual(address("255.254.253.252"), address(b"\xff\xfe\xfd\xfc"))
1070         self.assertEqual(
1071             self.ipv6_interface.ip,
1072             ipaddress.ip_interface(
1073                 b"\x20\x01\x06\x58\x02\x2a\xca\xfe\x02\x00\x00\x00\x00\x00\x00\x01"
1074             ).ip,
1075         )
1076         self.assertEqual(
1077             address("ffff:2:3:4:ffff::"),
1078             address(b"\xff\xff\x00\x02\x00\x03\x00\x04" + b"\xff\xff" + b"\x00" * 6),
1079         )
1080         self.assertEqual(address("::"), address(b"\x00" * 16))
1081     def testGetIp(self):
1082         self.assertEqual(int(self.ipv4_interface.ip), 16909060)
1083         self.assertEqual(str(self.ipv4_interface.ip), "1.2.3.4")
1084         self.assertEqual(
1085             int(self.ipv6_interface.ip), 42540616829182469433547762482097946625
1086         )
1087         self.assertEqual(str(self.ipv6_interface.ip), "2001:658:22a:cafe:200::1")
1088         self.assertEqual(
1089             int(self.ipv6_scoped_interface.ip), 42540616829182469433547762482097946625
1090         )
1091         self.assertEqual(str(self.ipv6_scoped_interface.ip), "2001:658:22a:cafe:200::1")
1092     def testGetScopeId(self):
1093         self.assertEqual(self.ipv6_address.scope_id, None)
1094         self.assertEqual(str(self.ipv6_scoped_address.scope_id), "scope")
1095         self.assertEqual(self.ipv6_interface.scope_id, None)
1096         self.assertEqual(str(self.ipv6_scoped_interface.scope_id), "scope")
1097         self.assertEqual(self.ipv6_network.network_address.scope_id, None)
1098         self.assertEqual(
1099             str(self.ipv6_scoped_network.network_address.scope_id), "scope"
1100         )
1101     def testGetNetmask(self):
1102         self.assertEqual(int(self.ipv4_network.netmask), 4294967040)
1103         self.assertEqual(str(self.ipv4_network.netmask), "255.255.255.0")
1104         self.assertEqual(
1105             int(self.ipv6_network.netmask), 340282366920938463444927863358058659840
1106         )
1107         self.assertEqual(self.ipv6_network.prefixlen, 64)
1108         self.assertEqual(
1109             int(self.ipv6_scoped_network.netmask),
1110             340282366920938463444927863358058659840,
1111         )
1112         self.assertEqual(self.ipv6_scoped_network.prefixlen, 64)
1113     def testZeroNetmask(self):
1114         ipv4_zero_netmask = ipaddress.IPv4Interface("1.2.3.4/0")
1115         self.assertEqual(int(ipv4_zero_netmask.network.netmask), 0)
1116         self.assertEqual(ipv4_zero_netmask._prefix_from_prefix_string("0"), 0)
1117         ipv6_zero_netmask = ipaddress.IPv6Interface("::1/0")
1118         self.assertEqual(int(ipv6_zero_netmask.network.netmask), 0)
1119         self.assertEqual(ipv6_zero_netmask._prefix_from_prefix_string("0"), 0)
1120         ipv6_scoped_zero_netmask = ipaddress.IPv6Interface("::1%scope/0")
1121         self.assertEqual(int(ipv6_scoped_zero_netmask.network.netmask), 0)
1122         self.assertEqual(ipv6_scoped_zero_netmask._prefix_from_prefix_string("0"), 0)
1123     def testIPv4Net(self):
1124         net = ipaddress.IPv4Network("127.0.0.0/0.0.0.255")
1125         self.assertEqual(net.prefixlen, 24)
1126     def testGetBroadcast(self):
1127         self.assertEqual(int(self.ipv4_network.broadcast_address), 16909311)
1128         self.assertEqual(str(self.ipv4_network.broadcast_address), "1.2.3.255")
1129         self.assertEqual(
1130             int(self.ipv6_network.broadcast_address),
1131             42540616829182469451850391367731642367,
1132         )
1133         self.assertEqual(
1134             str(self.ipv6_network.broadcast_address),
1135             "2001:658:22a:cafe:ffff:ffff:ffff:ffff",
1136         )
1137         self.assertEqual(
1138             int(self.ipv6_scoped_network.broadcast_address),
1139             42540616829182469451850391367731642367,
1140         )
1141         self.assertEqual(
1142             str(self.ipv6_scoped_network.broadcast_address),
1143             "2001:658:22a:cafe:ffff:ffff:ffff:ffff",
1144         )
1145     def testGetPrefixlen(self):
1146         self.assertEqual(self.ipv4_interface.network.prefixlen, 24)
1147         self.assertEqual(self.ipv6_interface.network.prefixlen, 64)
1148         self.assertEqual(self.ipv6_scoped_interface.network.prefixlen, 64)
1149     def testGetSupernet(self):
1150         self.assertEqual(self.ipv4_network.supernet().prefixlen, 23)
1151         self.assertEqual(str(self.ipv4_network.supernet().network_address), "1.2.2.0")
1152         self.assertEqual(
1153             ipaddress.IPv4Interface("0.0.0.0/0").network.supernet(),
1154             ipaddress.IPv4Network("0.0.0.0/0"),
1155         )
1156         self.assertEqual(self.ipv6_network.supernet().prefixlen, 63)
1157         self.assertEqual(
1158             str(self.ipv6_network.supernet().network_address), "2001:658:22a:cafe::"
1159         )
1160         self.assertEqual(
1161             ipaddress.IPv6Interface("::0/0").network.supernet(),
1162             ipaddress.IPv6Network("::0/0"),
1163         )
1164         self.assertEqual(self.ipv6_scoped_network.supernet().prefixlen, 63)
1165         self.assertEqual(
1166             str(self.ipv6_scoped_network.supernet().network_address),
1167             "2001:658:22a:cafe::",
1168         )
1169     def testGetSupernet3(self):
1170         self.assertEqual(self.ipv4_network.supernet(3).prefixlen, 21)
1171         self.assertEqual(str(self.ipv4_network.supernet(3).network_address), "1.2.0.0")
1172         self.assertEqual(self.ipv6_network.supernet(3).prefixlen, 61)
1173         self.assertEqual(
1174             str(self.ipv6_network.supernet(3).network_address), "2001:658:22a:caf8::"
1175         )
1176         self.assertEqual(self.ipv6_scoped_network.supernet(3).prefixlen, 61)
1177         self.assertEqual(
1178             str(self.ipv6_scoped_network.supernet(3).network_address),
1179             "2001:658:22a:caf8::",
1180         )
1181     def testGetSupernet4(self):
1182         self.assertRaises(
1183             ValueError, self.ipv4_network.supernet, prefixlen_diff=2, new_prefix=1
1184         )
1185         self.assertRaises(ValueError, self.ipv4_network.supernet, new_prefix=25)
1186         self.assertEqual(
1187             self.ipv4_network.supernet(prefixlen_diff=2),
1188             self.ipv4_network.supernet(new_prefix=22),
1189         )
1190         self.assertRaises(
1191             ValueError, self.ipv6_network.supernet, prefixlen_diff=2, new_prefix=1
1192         )
1193         self.assertRaises(ValueError, self.ipv6_network.supernet, new_prefix=65)
1194         self.assertEqual(
1195             self.ipv6_network.supernet(prefixlen_diff=2),
1196             self.ipv6_network.supernet(new_prefix=62),
1197         )
1198         self.assertRaises(
1199             ValueError,
1200             self.ipv6_scoped_network.supernet,
1201             prefixlen_diff=2,
1202             new_prefix=1,
1203         )
1204         self.assertRaises(ValueError, self.ipv6_scoped_network.supernet, new_prefix=65)
1205         self.assertEqual(
1206             self.ipv6_scoped_network.supernet(prefixlen_diff=2),
1207             self.ipv6_scoped_network.supernet(new_prefix=62),
1208         )
1209     def testHosts(self):
1210         hosts = list(self.ipv4_network.hosts())
1211         self.assertEqual(254, len(hosts))
1212         self.assertEqual(ipaddress.IPv4Address("1.2.3.1"), hosts[0])
1213         self.assertEqual(ipaddress.IPv4Address("1.2.3.254"), hosts[-1])
1214         ipv6_network = ipaddress.IPv6Network("2001:658:22a:cafe::/120")
1215         hosts = list(ipv6_network.hosts())
1216         self.assertEqual(255, len(hosts))
1217         self.assertEqual(ipaddress.IPv6Address("2001:658:22a:cafe::1"), hosts[0])
1218         self.assertEqual(ipaddress.IPv6Address("2001:658:22a:cafe::ff"), hosts[-1])
1219         ipv6_scoped_network = ipaddress.IPv6Network("2001:658:22a:cafe::%scope/120")
1220         hosts = list(ipv6_scoped_network.hosts())
1221         self.assertEqual(255, len(hosts))
1222         self.assertEqual(ipaddress.IPv6Address("2001:658:22a:cafe::1"), hosts[0])
1223         self.assertEqual(ipaddress.IPv6Address("2001:658:22a:cafe::ff"), hosts[-1])
1224         addrs = [ipaddress.IPv4Address("2.0.0.0"), ipaddress.IPv4Address("2.0.0.1")]
1225         str_args = "2.0.0.0/31"
1226         tpl_args = ("2.0.0.0", 31)
1227         self.assertEqual(addrs, list(ipaddress.ip_network(str_args).hosts()))
1228         self.assertEqual(addrs, list(ipaddress.ip_network(tpl_args).hosts()))
1229         self.assertEqual(
1230             list(ipaddress.ip_network(str_args).hosts()),
1231             list(ipaddress.ip_network(tpl_args).hosts()),
1232         )
1233         addrs = [ipaddress.IPv4Address("1.2.3.4")]
1234         str_args = "1.2.3.4/32"
1235         tpl_args = ("1.2.3.4", 32)
1236         self.assertEqual(addrs, list(ipaddress.ip_network(str_args).hosts()))
1237         self.assertEqual(addrs, list(ipaddress.ip_network(tpl_args).hosts()))
1238         self.assertEqual(
1239             list(ipaddress.ip_network(str_args).hosts()),
1240             list(ipaddress.ip_network(tpl_args).hosts()),
1241         )
1242         addrs = [
1243             ipaddress.IPv6Address("2001:658:22a:cafe::"),
1244             ipaddress.IPv6Address("2001:658:22a:cafe::1"),
1245         ]
1246         str_args = "2001:658:22a:cafe::/127"
1247         tpl_args = ("2001:658:22a:cafe::", 127)
1248         self.assertEqual(addrs, list(ipaddress.ip_network(str_args).hosts()))
1249         self.assertEqual(addrs, list(ipaddress.ip_network(tpl_args).hosts()))
1250         self.assertEqual(
1251             list(ipaddress.ip_network(str_args).hosts()),
1252             list(ipaddress.ip_network(tpl_args).hosts()),
1253         )
1254         addrs = [
1255             ipaddress.IPv6Address("2001:658:22a:cafe::1"),
1256         ]
1257         str_args = "2001:658:22a:cafe::1/128"
1258         tpl_args = ("2001:658:22a:cafe::1", 128)
1259         self.assertEqual(addrs, list(ipaddress.ip_network(str_args).hosts()))
1260         self.assertEqual(addrs, list(ipaddress.ip_network(tpl_args).hosts()))
1261         self.assertEqual(
1262             list(ipaddress.ip_network(str_args).hosts()),
1263             list(ipaddress.ip_network(tpl_args).hosts()),
1264         )
1265     def testFancySubnetting(self):
1266         self.assertEqual(
1267             sorted(self.ipv4_network.subnets(prefixlen_diff=3)),
1268             sorted(self.ipv4_network.subnets(new_prefix=27)),
1269         )
1270         self.assertRaises(ValueError, list, self.ipv4_network.subnets(new_prefix=23))
1271         self.assertRaises(
1272             ValueError, list, self.ipv4_network.subnets(prefixlen_diff=3, new_prefix=27)
1273         )
1274         self.assertEqual(
1275             sorted(self.ipv6_network.subnets(prefixlen_diff=4)),
1276             sorted(self.ipv6_network.subnets(new_prefix=68)),
1277         )
1278         self.assertRaises(ValueError, list, self.ipv6_network.subnets(new_prefix=63))
1279         self.assertRaises(
1280             ValueError, list, self.ipv6_network.subnets(prefixlen_diff=4, new_prefix=68)
1281         )
1282         self.assertEqual(
1283             sorted(self.ipv6_scoped_network.subnets(prefixlen_diff=4)),
1284             sorted(self.ipv6_scoped_network.subnets(new_prefix=68)),
1285         )
1286         self.assertRaises(
1287             ValueError, list, self.ipv6_scoped_network.subnets(new_prefix=63)
1288         )
1289         self.assertRaises(
1290             ValueError,
1291             list,
1292             self.ipv6_scoped_network.subnets(prefixlen_diff=4, new_prefix=68),
1293         )
1294     def testGetSubnets(self):
1295         self.assertEqual(list(self.ipv4_network.subnets())[0].prefixlen, 25)
1296         self.assertEqual(
1297             str(list(self.ipv4_network.subnets())[0].network_address), "1.2.3.0"
1298         )
1299         self.assertEqual(
1300             str(list(self.ipv4_network.subnets())[1].network_address), "1.2.3.128"
1301         )
1302         self.assertEqual(list(self.ipv6_network.subnets())[0].prefixlen, 65)
1303         self.assertEqual(list(self.ipv6_scoped_network.subnets())[0].prefixlen, 65)
1304     def testGetSubnetForSingle32(self):
1305         ip = ipaddress.IPv4Network("1.2.3.4/32")
1306         subnets1 = [str(x) for x in ip.subnets()]
1307         subnets2 = [str(x) for x in ip.subnets(2)]
1308         self.assertEqual(subnets1, ["1.2.3.4/32"])
1309         self.assertEqual(subnets1, subnets2)
1310     def testGetSubnetForSingle128(self):
1311         ip = ipaddress.IPv6Network("::1/128")
1312         subnets1 = [str(x) for x in ip.subnets()]
1313         subnets2 = [str(x) for x in ip.subnets(2)]
1314         self.assertEqual(subnets1, ["::1/128"])
1315         self.assertEqual(subnets1, subnets2)
1316         ip_scoped = ipaddress.IPv6Network("::1%scope/128")
1317         subnets1 = [str(x) for x in ip_scoped.subnets()]
1318         subnets2 = [str(x) for x in ip_scoped.subnets(2)]
1319         self.assertEqual(subnets1, ["::1%scope/128"])
1320         self.assertEqual(subnets1, subnets2)
1321     def testSubnet2(self):
1322         ips = [str(x) for x in self.ipv4_network.subnets(2)]
1323         self.assertEqual(
1324             ips, ["1.2.3.0/26", "1.2.3.64/26", "1.2.3.128/26", "1.2.3.192/26"]
1325         )
1326         ipsv6 = [str(x) for x in self.ipv6_network.subnets(2)]
1327         self.assertEqual(
1328             ipsv6,
1329             [
1330                 "2001:658:22a:cafe::/66",
1331                 "2001:658:22a:cafe:4000::/66",
1332                 "2001:658:22a:cafe:8000::/66",
1333                 "2001:658:22a:cafe:c000::/66",
1334             ],
1335         )
1336     def testGetSubnets3(self):
1337         subnets = [str(x) for x in self.ipv4_network.subnets(8)]
1338         self.assertEqual(subnets[:3], ["1.2.3.0/32", "1.2.3.1/32", "1.2.3.2/32"])
1339         self.assertEqual(subnets[-3:], ["1.2.3.253/32", "1.2.3.254/32", "1.2.3.255/32"])
1340         self.assertEqual(len(subnets), 256)
1341         ipv6_network = ipaddress.IPv6Network("2001:658:22a:cafe::/120")
1342         subnets = [str(x) for x in ipv6_network.subnets(8)]
1343         self.assertEqual(
1344             subnets[:3],
1345             [
1346                 "2001:658:22a:cafe::/128",
1347                 "2001:658:22a:cafe::1/128",
1348                 "2001:658:22a:cafe::2/128",
1349             ],
1350         )
1351         self.assertEqual(
1352             subnets[-3:],
1353             [
1354                 "2001:658:22a:cafe::fd/128",
1355                 "2001:658:22a:cafe::fe/128",
1356                 "2001:658:22a:cafe::ff/128",
1357             ],
1358         )
1359         self.assertEqual(len(subnets), 256)
1360     def testSubnetFailsForLargeCidrDiff(self):
1361         self.assertRaises(ValueError, list, self.ipv4_interface.network.subnets(9))
1362         self.assertRaises(ValueError, list, self.ipv4_network.subnets(9))
1363         self.assertRaises(ValueError, list, self.ipv6_interface.network.subnets(65))
1364         self.assertRaises(ValueError, list, self.ipv6_network.subnets(65))
1365         self.assertRaises(
1366             ValueError, list, self.ipv6_scoped_interface.network.subnets(65)
1367         )
1368         self.assertRaises(ValueError, list, self.ipv6_scoped_network.subnets(65))
1369     def testSupernetFailsForLargeCidrDiff(self):
1370         self.assertRaises(ValueError, self.ipv4_interface.network.supernet, 25)
1371         self.assertRaises(ValueError, self.ipv6_interface.network.supernet, 65)
1372         self.assertRaises(ValueError, self.ipv6_scoped_interface.network.supernet, 65)
1373     def testSubnetFailsForNegativeCidrDiff(self):
1374         self.assertRaises(ValueError, list, self.ipv4_interface.network.subnets(-1))
1375         self.assertRaises(ValueError, list, self.ipv4_network.subnets(-1))
1376         self.assertRaises(ValueError, list, self.ipv6_interface.network.subnets(-1))
1377         self.assertRaises(ValueError, list, self.ipv6_network.subnets(-1))
1378         self.assertRaises(
1379             ValueError, list, self.ipv6_scoped_interface.network.subnets(-1)
1380         )
1381         self.assertRaises(ValueError, list, self.ipv6_scoped_network.subnets(-1))
1382     def testGetNum_Addresses(self):
1383         self.assertEqual(self.ipv4_network.num_addresses, 256)
1384         self.assertEqual(list(self.ipv4_network.subnets())[0].num_addresses, 128)
1385         self.assertEqual(self.ipv4_network.supernet().num_addresses, 512)
1386         self.assertEqual(self.ipv6_network.num_addresses, 18446744073709551616)
1387         self.assertEqual(
1388             list(self.ipv6_network.subnets())[0].num_addresses, 9223372036854775808
1389         )
1390         self.assertEqual(
1391             self.ipv6_network.supernet().num_addresses, 36893488147419103232
1392         )
1393         self.assertEqual(self.ipv6_scoped_network.num_addresses, 18446744073709551616)
1394         self.assertEqual(
1395             list(self.ipv6_scoped_network.subnets())[0].num_addresses,
1396             9223372036854775808,
1397         )
1398         self.assertEqual(
1399             self.ipv6_scoped_network.supernet().num_addresses, 36893488147419103232
1400         )
1401     def testContains(self):
1402         self.assertIn(ipaddress.IPv4Interface("1.2.3.128/25"), self.ipv4_network)
1403         self.assertNotIn(ipaddress.IPv4Interface("1.2.4.1/24"), self.ipv4_network)
1404         addr1 = ipaddress.IPv4Address("1.2.3.37")
1405         self.assertIn(addr1, self.ipv4_network)
1406         self.assertFalse(
1407             ipaddress.IPv4Network("1.1.0.0/16").__contains__(
1408                 ipaddress.IPv4Network("1.0.0.0/15")
1409             )
1410         )
1411     def testNth(self):
1412         self.assertEqual(str(self.ipv4_network[5]), "1.2.3.5")
1413         self.assertRaises(IndexError, self.ipv4_network.__getitem__, 256)
1414         self.assertEqual(str(self.ipv6_network[5]), "2001:658:22a:cafe::5")
1415         self.assertRaises(IndexError, self.ipv6_network.__getitem__, 1 &lt;&lt; 64)
1416         self.assertEqual(str(self.ipv6_scoped_network[5]), "2001:658:22a:cafe::5")
1417         self.assertRaises(IndexError, self.ipv6_scoped_network.__getitem__, 1 &lt;&lt; 64)
1418     def testGetitem(self):
1419         addr = ipaddress.IPv4Network("172.31.255.128/255.255.255.240")
1420         self.assertEqual(28, addr.prefixlen)
1421         addr_list = list(addr)
1422         self.assertEqual("172.31.255.128", str(addr_list[0]))
1423         self.assertEqual("172.31.255.128", str(addr[0]))
1424         self.assertEqual("172.31.255.143", str(addr_list[-1]))
1425         self.assertEqual("172.31.255.143", str(addr[-1]))
1426         self.assertEqual(addr_list[-1], addr[-1])
1427     def testEqual(self):
1428         self.assertTrue(self.ipv4_interface == ipaddress.IPv4Interface("1.2.3.4/24"))
1429         self.assertFalse(self.ipv4_interface == ipaddress.IPv4Interface("1.2.3.4/23"))
1430         self.assertFalse(self.ipv4_interface == ipaddress.IPv6Interface("::1.2.3.4/24"))
1431         self.assertFalse(
1432             self.ipv4_interface == ipaddress.IPv6Interface("::1.2.3.4%scope/24")
1433         )
1434         self.assertFalse(self.ipv4_interface == "")
1435         self.assertFalse(self.ipv4_interface == [])
1436         self.assertFalse(self.ipv4_interface == 2)
1437         self.assertTrue(
1438             self.ipv6_interface
1439             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/64")
1440         )
1441         self.assertFalse(
1442             self.ipv6_interface
1443             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/63")
1444         )
1445         self.assertFalse(self.ipv6_interface == ipaddress.IPv4Interface("1.2.3.4/23"))
1446         self.assertFalse(self.ipv6_interface == "")
1447         self.assertFalse(self.ipv6_interface == [])
1448         self.assertFalse(self.ipv6_interface == 2)
1449         self.assertTrue(
1450             self.ipv6_scoped_interface
1451             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1%scope/64")
1452         )
1453         self.assertFalse(
1454             self.ipv6_scoped_interface
1455             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1%scope/63")
1456         )
1457         self.assertFalse(
1458             self.ipv6_scoped_interface
1459             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/64")
1460         )
1461         self.assertFalse(
1462             self.ipv6_scoped_interface
1463             == ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/63")
1464         )
1465         self.assertFalse(
1466             self.ipv6_scoped_interface == ipaddress.IPv4Interface("1.2.3.4/23")
1467         )
1468         self.assertFalse(self.ipv6_scoped_interface == "")
1469         self.assertFalse(self.ipv6_scoped_interface == [])
1470         self.assertFalse(self.ipv6_scoped_interface == 2)
1471     def testNotEqual(self):
1472         self.assertFalse(self.ipv4_interface != ipaddress.IPv4Interface("1.2.3.4/24"))
1473         self.assertTrue(self.ipv4_interface != ipaddress.IPv4Interface("1.2.3.4/23"))
1474         self.assertTrue(self.ipv4_interface != ipaddress.IPv6Interface("::1.2.3.4/24"))
1475         self.assertTrue(
1476             self.ipv4_interface != ipaddress.IPv6Interface("::1.2.3.4%scope/24")
1477         )
1478         self.assertTrue(self.ipv4_interface != "")
1479         self.assertTrue(self.ipv4_interface != [])
1480         self.assertTrue(self.ipv4_interface != 2)
1481         self.assertTrue(self.ipv4_address != ipaddress.IPv4Address("1.2.3.5"))
1482         self.assertTrue(self.ipv4_address != "")
1483         self.assertTrue(self.ipv4_address != [])
1484         self.assertTrue(self.ipv4_address != 2)
1485         self.assertFalse(
1486             self.ipv6_interface
1487             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/64")
1488         )
1489         self.assertTrue(
1490             self.ipv6_interface
1491             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/63")
1492         )
1493         self.assertTrue(self.ipv6_interface != ipaddress.IPv4Interface("1.2.3.4/23"))
1494         self.assertTrue(self.ipv6_interface != "")
1495         self.assertTrue(self.ipv6_interface != [])
1496         self.assertTrue(self.ipv6_interface != 2)
1497         self.assertTrue(self.ipv6_address != ipaddress.IPv4Address("1.2.3.4"))
1498         self.assertTrue(self.ipv6_address != "")
1499         self.assertTrue(self.ipv6_address != [])
1500         self.assertTrue(self.ipv6_address != 2)
1501         self.assertFalse(
1502             self.ipv6_scoped_interface
1503             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1%scope/64")
1504         )
1505         self.assertTrue(
1506             self.ipv6_scoped_interface
1507             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1%scope/63")
1508         )
1509         self.assertTrue(
1510             self.ipv6_scoped_interface
1511             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/64")
1512         )
1513         self.assertTrue(
1514             self.ipv6_scoped_interface
1515             != ipaddress.IPv6Interface("2001:658:22a:cafe:200::1/63")
1516         )
1517         self.assertTrue(
1518             self.ipv6_scoped_interface != ipaddress.IPv4Interface("1.2.3.4/23")
1519         )
1520         self.assertTrue(self.ipv6_scoped_interface != "")
1521         self.assertTrue(self.ipv6_scoped_interface != [])
1522         self.assertTrue(self.ipv6_scoped_interface != 2)
1523         self.assertTrue(self.ipv6_scoped_address != ipaddress.IPv4Address("1.2.3.4"))
1524         self.assertTrue(self.ipv6_scoped_address != "")
1525         self.assertTrue(self.ipv6_scoped_address != [])
1526         self.assertTrue(self.ipv6_scoped_address != 2)
1527     def testSlash32Constructor(self):
1528         self.assertEqual(
1529             str(ipaddress.IPv4Interface("1.2.3.4/255.255.255.255")), "1.2.3.4/32"
1530         )
1531     def testSlash128Constructor(self):
1532         self.assertEqual(str(ipaddress.IPv6Interface("::1/128")), "::1/128")
1533         self.assertEqual(str(ipaddress.IPv6Interface("::1%scope/128")), "::1%scope/128")
1534     def testSlash0Constructor(self):
1535         self.assertEqual(str(ipaddress.IPv4Interface("1.2.3.4/0.0.0.0")), "1.2.3.4/0")
1536     def testCollapsing(self):
1537         ip1 = ipaddress.IPv4Address("1.1.1.0")
1538         ip2 = ipaddress.IPv4Address("1.1.1.1")
1539         ip3 = ipaddress.IPv4Address("1.1.1.2")
1540         ip4 = ipaddress.IPv4Address("1.1.1.3")
1541         ip5 = ipaddress.IPv4Address("1.1.1.4")
1542         ip6 = ipaddress.IPv4Address("1.1.1.0")
1543         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3, ip4, ip5, ip6])
1544         self.assertEqual(
1545             list(collapsed),
1546             [ipaddress.IPv4Network("1.1.1.0/30"), ipaddress.IPv4Network("1.1.1.4/32")],
1547         )
1548         ip1 = ipaddress.IPv4Address("1.1.1.0")
1549         ip2 = ipaddress.IPv4Address("1.1.1.1")
1550         ip3 = ipaddress.IPv4Address("1.1.1.2")
1551         ip4 = ipaddress.IPv4Address("1.1.1.3")
1552         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3, ip4])
1553         self.assertEqual(list(collapsed), [ipaddress.IPv4Network("1.1.1.0/30")])
1554         ip1 = ipaddress.IPv4Network("1.1.0.0/24")
1555         ip2 = ipaddress.IPv4Network("1.1.1.0/24")
1556         ip3 = ipaddress.IPv4Network("1.1.2.0/24")
1557         ip4 = ipaddress.IPv4Network("1.1.3.0/24")
1558         ip5 = ipaddress.IPv4Network("1.1.4.0/24")
1559         ip6 = ipaddress.IPv4Network("1.1.0.0/22")
1560         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3, ip4, ip5, ip6])
1561         self.assertEqual(
1562             list(collapsed),
1563             [ipaddress.IPv4Network("1.1.0.0/22"), ipaddress.IPv4Network("1.1.4.0/24")],
1564         )
1565         collapsed = ipaddress.collapse_addresses([ip1, ip2])
1566         self.assertEqual(list(collapsed), [ipaddress.IPv4Network("1.1.0.0/23")])
1567         ip_same1 = ip_same2 = ipaddress.IPv4Network("1.1.1.1/32")
1568         self.assertEqual(
1569             list(ipaddress.collapse_addresses([ip_same1, ip_same2])), [ip_same1]
1570         )
1571         ip_same1 = ip_same2 = ipaddress.IPv4Address("1.1.1.1")
1572         self.assertEqual(
1573             list(ipaddress.collapse_addresses([ip_same1, ip_same2])),
1574             [ipaddress.ip_network("1.1.1.1/32")],
1575         )
1576         ip1 = ipaddress.IPv6Network("2001::/100")
1577         ip2 = ipaddress.IPv6Network("2001::/120")
1578         ip3 = ipaddress.IPv6Network("2001::/96")
1579         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3])
1580         self.assertEqual(list(collapsed), [ip3])
1581         ip1 = ipaddress.IPv6Network("2001::%scope/100")
1582         ip2 = ipaddress.IPv6Network("2001::%scope/120")
1583         ip3 = ipaddress.IPv6Network("2001::%scope/96")
1584         collapsed = ipaddress.collapse_addresses([ip1, ip2, ip3])
1585         self.assertEqual(list(collapsed), [ip3])
1586         addr_tuples = [
1587             (ipaddress.ip_address("1.1.1.1"), ipaddress.ip_address("::1")),
1588             (ipaddress.IPv4Network("1.1.0.0/24"), ipaddress.IPv6Network("2001::/120")),
1589             (ipaddress.IPv4Network("1.1.0.0/32"), ipaddress.IPv6Network("2001::/128")),
1590         ]
1591         for ip1, ip2 in addr_tuples:
1592             self.assertRaises(TypeError, ipaddress.collapse_addresses, [ip1, ip2])
1593         addr_tuples = [
1594             (ipaddress.ip_address("1.1.1.1"), ipaddress.ip_address("::1%scope")),
1595             (
1596                 ipaddress.IPv4Network("1.1.0.0/24"),
1597                 ipaddress.IPv6Network("2001::%scope/120"),
1598             ),
1599             (
1600                 ipaddress.IPv4Network("1.1.0.0/32"),
1601                 ipaddress.IPv6Network("2001::%scope/128"),
1602             ),
1603         ]
1604         for ip1, ip2 in addr_tuples:
1605             self.assertRaises(TypeError, ipaddress.collapse_addresses, [ip1, ip2])
1606     def testSummarizing(self):
1607         summarize = ipaddress.summarize_address_range
1608         ip1 = ipaddress.ip_address("1.1.1.0")
1609         ip2 = ipaddress.ip_address("1.1.1.255")
1610         class IPv7Address(ipaddress.IPv6Address):
1611             @property
1612             def version(self):
1613                 return 7
1614         ip_invalid1 = IPv7Address("::1")
1615         ip_invalid2 = IPv7Address("::1")
1616         self.assertRaises(ValueError, list, summarize(ip_invalid1, ip_invalid2))
1617         self.assertRaises(TypeError, list, summarize(ip1, ipaddress.IPv6Address("::1")))
1618         self.assertRaises(
1619             TypeError, list, summarize(ip1, ipaddress.IPv6Address("::1%scope"))
1620         )
1621         self.assertEqual(
1622             list(summarize(ip1, ip2))[0], ipaddress.ip_network("1.1.1.0/24")
1623         )
1624         ip2 = ipaddress.ip_address("1.1.1.8")
1625         self.assertEqual(
1626             list(summarize(ip1, ip2)),
1627             [ipaddress.ip_network("1.1.1.0/29"), ipaddress.ip_network("1.1.1.8")],
1628         )
1629         ip1 = ipaddress.IPv4Address(0)
1630         ip2 = ipaddress.IPv4Address(ipaddress.IPv4Address._ALL_ONES)
1631         self.assertEqual(
1632             [ipaddress.IPv4Network("0.0.0.0/0")], list(summarize(ip1, ip2))
1633         )
1634         ip1 = ipaddress.ip_address("1::")
1635         ip2 = ipaddress.ip_address("1:ffff:ffff:ffff:ffff:ffff:ffff:ffff")
1636         self.assertEqual(list(summarize(ip1, ip2))[0], ipaddress.ip_network("1::/16"))
1637         ip2 = ipaddress.ip_address("2::")
1638         self.assertEqual(
1639             list(summarize(ip1, ip2)),
1640             [ipaddress.ip_network("1::/16"), ipaddress.ip_network("2::/128")],
1641         )
1642         ip1 = ipaddress.ip_address("1::%scope")
1643         ip2 = ipaddress.ip_address("1:ffff:ffff:ffff:ffff:ffff:ffff:ffff%scope")
1644         self.assertEqual(list(summarize(ip1, ip2))[0], ipaddress.ip_network("1::/16"))
1645         ip2 = ipaddress.ip_address("2::%scope")
1646         self.assertEqual(
1647             list(summarize(ip1, ip2)),
1648             [ipaddress.ip_network("1::/16"), ipaddress.ip_network("2::/128")],
1649         )
1650         self.assertRaises(
1651             ValueError,
1652             list,
1653             summarize(ipaddress.ip_address("1.1.1.0"), ipaddress.ip_address("1.1.0.0")),
1654         )
1655         self.assertRaises(
1656             TypeError,
1657             list,
1658             summarize(ipaddress.ip_network("1.1.1.0"), ipaddress.ip_network("1.1.0.0")),
1659         )
1660         self.assertRaises(
1661             TypeError,
1662             list,
1663             summarize(ipaddress.ip_network("1.1.1.0"), ipaddress.ip_network("1.1.0.0")),
1664         )
1665         self.assertRaises(
1666             TypeError,
1667             list,
1668             summarize(ipaddress.ip_address("::"), ipaddress.ip_network("1.1.0.0")),
1669         )
1670     def testAddressComparison(self):
1671         self.assertTrue(
1672             ipaddress.ip_address("1.1.1.1") &lt;= ipaddress.ip_address("1.1.1.1")
1673         )
1674         self.assertTrue(
1675             ipaddress.ip_address("1.1.1.1") &lt;= ipaddress.ip_address("1.1.1.2")
1676         )
1677         self.assertTrue(ipaddress.ip_address("::1") &lt;= ipaddress.ip_address("::1"))
1678         self.assertTrue(ipaddress.ip_address("::1") &lt;= ipaddress.ip_address("::2"))
1679         self.assertTrue(
1680             ipaddress.ip_address("::1%scope") &lt;= ipaddress.ip_address("::1%scope")
1681         )
1682         self.assertTrue(
1683             ipaddress.ip_address("::1%scope") &lt;= ipaddress.ip_address("::2%scope")
1684         )
1685     def testInterfaceComparison(self):
1686         self.assertTrue(
1687             ipaddress.ip_interface("1.1.1.1/24") == ipaddress.ip_interface("1.1.1.1/24")
1688         )
1689         self.assertTrue(
1690             ipaddress.ip_interface("1.1.1.1/16") &lt; ipaddress.ip_interface("1.1.1.1/24")
1691         )
1692         self.assertTrue(
1693             ipaddress.ip_interface("1.1.1.1/24") &lt; ipaddress.ip_interface("1.1.1.2/24")
1694         )
1695         self.assertTrue(
1696             ipaddress.ip_interface("1.1.1.2/16") &lt; ipaddress.ip_interface("1.1.1.1/24")
1697         )
1698         self.assertTrue(
1699             ipaddress.ip_interface("1.1.1.1/24") &gt; ipaddress.ip_interface("1.1.1.1/16")
1700         )
1701         self.assertTrue(
1702             ipaddress.ip_interface("1.1.1.2/24") &gt; ipaddress.ip_interface("1.1.1.1/24")
1703         )
1704         self.assertTrue(
1705             ipaddress.ip_interface("1.1.1.1/24") &gt; ipaddress.ip_interface("1.1.1.2/16")
1706         )
1707         self.assertTrue(
1708             ipaddress.ip_interface("::1/64") == ipaddress.ip_interface("::1/64")
1709         )
1710         self.assertTrue(
1711             ipaddress.ip_interface("::1/64") &lt; ipaddress.ip_interface("::1/80")
1712         )
1713         self.assertTrue(
1714             ipaddress.ip_interface("::1/64") &lt; ipaddress.ip_interface("::2/64")
1715         )
1716         self.assertTrue(
1717             ipaddress.ip_interface("::2/48") &lt; ipaddress.ip_interface("::1/64")
1718         )
1719         self.assertTrue(
1720             ipaddress.ip_interface("::1/80") &gt; ipaddress.ip_interface("::1/64")
1721         )
1722         self.assertTrue(
1723             ipaddress.ip_interface("::2/64") &gt; ipaddress.ip_interface("::1/64")
1724         )
1725         self.assertTrue(
1726             ipaddress.ip_interface("::1/64") &gt; ipaddress.ip_interface("::2/48")
1727         )
1728         self.assertTrue(
1729             ipaddress.ip_interface("::1%scope/64")
1730             == ipaddress.ip_interface("::1%scope/64")
1731         )
1732         self.assertTrue(
1733             ipaddress.ip_interface("::1%scope/64")
1734             &lt; ipaddress.ip_interface("::1%scope/80")
1735         )
1736         self.assertTrue(
1737             ipaddress.ip_interface("::1%scope/64")
1738             &lt; ipaddress.ip_interface("::2%scope/64")
1739         )
1740         self.assertTrue(
1741             ipaddress.ip_interface("::2%scope/48")
1742             &lt; ipaddress.ip_interface("::1%scope/64")
1743         )
1744         self.assertTrue(
1745             ipaddress.ip_interface("::1%scope/80")
1746             &gt; ipaddress.ip_interface("::1%scope/64")
1747         )
1748         self.assertTrue(
1749             ipaddress.ip_interface("::2%scope/64")
1750             &gt; ipaddress.ip_interface("::1%scope/64")
1751         )
1752         self.assertTrue(
1753             ipaddress.ip_interface("::1%scope/64")
1754             &gt; ipaddress.ip_interface("::2%scope/48")
1755         )
1756         self.assertFalse(
1757             ipaddress.ip_interface("::1%scope/64") == ipaddress.ip_interface("::1/64")
1758         )
1759         self.assertTrue(
1760             ipaddress.ip_interface("::1%scope/64") &lt; ipaddress.ip_interface("::1/80")
1761         )
1762         self.assertTrue(
1763             ipaddress.ip_interface("::1%scope/64") &lt; ipaddress.ip_interface("::2/64")
1764         )
1765         self.assertTrue(
1766             ipaddress.ip_interface("::2%scope/48") &lt; ipaddress.ip_interface("::1/64")
1767         )
1768         self.assertTrue(
1769             ipaddress.ip_interface("::1%scope/80") &gt; ipaddress.ip_interface("::1/64")
1770         )
1771         self.assertTrue(
1772             ipaddress.ip_interface("::2%scope/64") &gt; ipaddress.ip_interface("::1/64")
1773         )
1774         self.assertTrue(
1775             ipaddress.ip_interface("::1%scope/64") &gt; ipaddress.ip_interface("::2/48")
1776         )
1777         self.assertFalse(
1778             ipaddress.ip_interface("::1/64") == ipaddress.ip_interface("::1%scope/64")
1779         )
1780         self.assertTrue(
1781             ipaddress.ip_interface("::1/64") &lt; ipaddress.ip_interface("::1%scope/80")
1782         )
1783         self.assertTrue(
1784             ipaddress.ip_interface("::1/64") &lt; ipaddress.ip_interface("::2%scope/64")
1785         )
1786         self.assertTrue(
1787             ipaddress.ip_interface("::2/48") &lt; ipaddress.ip_interface("::1%scope/64")
1788         )
1789         self.assertTrue(
1790             ipaddress.ip_interface("::1/80") &gt; ipaddress.ip_interface("::1%scope/64")
1791         )
1792         self.assertTrue(
1793             ipaddress.ip_interface("::2/64") &gt; ipaddress.ip_interface("::1%scope/64")
1794         )
1795         self.assertTrue(
1796             ipaddress.ip_interface("::1/64") &gt; ipaddress.ip_interface("::2%scope/48")
1797         )
1798     def testNetworkComparison(self):
1799         ip1 = ipaddress.IPv4Network("1.1.1.0/24")
1800         ip2 = ipaddress.IPv4Network("1.1.1.0/32")
1801         ip3 = ipaddress.IPv4Network("1.1.2.0/24")
1802         self.assertTrue(ip1 &lt; ip3)
1803         self.assertTrue(ip3 &gt; ip2)
1804         self.assertEqual(ip1.compare_networks(ip1), 0)
1805         self.assertEqual(ip1.compare_networks(ip2), -1)
1806         self.assertEqual(ip2.compare_networks(ip1), 1)
1807         self.assertEqual(ip1.compare_networks(ip3), -1)
1808         self.assertEqual(ip3.compare_networks(ip1), 1)
1809         self.assertTrue(ip1._get_networks_key() &lt; ip3._get_networks_key())
1810         ip1 = ipaddress.IPv6Network("2001:2000::/96")
1811         ip2 = ipaddress.IPv6Network("2001:2001::/96")
1812         ip3 = ipaddress.IPv6Network("2001:ffff:2000::/96")
1813         self.assertTrue(ip1 &lt; ip3)
1814         self.assertTrue(ip3 &gt; ip2)
1815         self.assertEqual(ip1.compare_networks(ip3), -1)
1816         self.assertTrue(ip1._get_networks_key() &lt; ip3._get_networks_key())
1817         self.assertRaises(
1818             TypeError, self.ipv4_network.compare_networks, self.ipv6_network
1819         )
1820         ipv6 = ipaddress.IPv6Interface("::/0")
1821         ipv4 = ipaddress.IPv4Interface("0.0.0.0/0")
1822         self.assertRaises(TypeError, ipv4.__lt__, ipv6)
1823         self.assertRaises(TypeError, ipv4.__gt__, ipv6)
1824         self.assertRaises(TypeError, ipv6.__lt__, ipv4)
1825         self.assertRaises(TypeError, ipv6.__gt__, ipv4)
1826         ip1 = ipaddress.ip_network("10.1.2.128/25")
1827         self.assertFalse(ip1 &lt; ip1)
1828         self.assertFalse(ip1 &gt; ip1)
1829         ip2 = ipaddress.ip_network("10.1.3.0/24")
1830         self.assertTrue(ip1 &lt; ip2)
1831         self.assertFalse(ip2 &lt; ip1)
1832         self.assertFalse(ip1 &gt; ip2)
1833         self.assertTrue(ip2 &gt; ip1)
1834         ip3 = ipaddress.ip_network("10.1.3.0/25")
1835         self.assertTrue(ip2 &lt; ip3)
1836         self.assertFalse(ip3 &lt; ip2)
1837         self.assertFalse(ip2 &gt; ip3)
1838         self.assertTrue(ip3 &gt; ip2)
1839         ip1 = ipaddress.ip_network("10.10.10.0/31")
1840         ip2 = ipaddress.ip_network("10.10.10.0")
1841         ip3 = ipaddress.ip_network("10.10.10.2/31")
1842         ip4 = ipaddress.ip_network("10.10.10.2")
1843         sorted = [ip1, ip2, ip3, ip4]
1844         unsorted = [ip2, ip4, ip1, ip3]
1845         unsorted.sort()
1846         self.assertEqual(sorted, unsorted)
1847         unsorted = [ip4, ip1, ip3, ip2]
1848         unsorted.sort()
1849         self.assertEqual(sorted, unsorted)
1850         self.assertIs(ip1.__lt__(ipaddress.ip_address("10.10.10.0")), NotImplemented)
1851         self.assertIs(ip2.__lt__(ipaddress.ip_address("10.10.10.0")), NotImplemented)
1852         self.assertTrue(
1853             ipaddress.ip_network("1.1.1.1") &lt;= ipaddress.ip_network("1.1.1.1")
1854         )
1855         self.assertTrue(
1856             ipaddress.ip_network("1.1.1.1") &lt;= ipaddress.ip_network("1.1.1.2")
1857         )
1858         self.assertFalse(
1859             ipaddress.ip_network("1.1.1.2") &lt;= ipaddress.ip_network("1.1.1.1")
1860         )
1861         self.assertTrue(ipaddress.ip_network("::1") &lt;= ipaddress.ip_network("::1"))
1862         self.assertTrue(ipaddress.ip_network("::1") &lt;= ipaddress.ip_network("::2"))
1863         self.assertFalse(ipaddress.ip_network("::2") &lt;= ipaddress.ip_network("::1"))
1864     def testStrictNetworks(self):
1865         self.assertRaises(ValueError, ipaddress.ip_network, "192.168.1.1/24")
1866         self.assertRaises(ValueError, ipaddress.ip_network, "::1/120")
1867         self.assertRaises(ValueError, ipaddress.ip_network, "::1%scope/120")
1868     def testOverlaps(self):
1869         other = ipaddress.IPv4Network("1.2.3.0/30")
1870         other2 = ipaddress.IPv4Network("1.2.2.0/24")
1871         other3 = ipaddress.IPv4Network("1.2.2.64/26")
1872         self.assertTrue(self.ipv4_network.overlaps(other))
1873         self.assertFalse(self.ipv4_network.overlaps(other2))
1874         self.assertTrue(other2.overlaps(other3))
1875     def testEmbeddedIpv4(self):
1876         ipv4_string = "192.168.0.1"
1877         ipv4 = ipaddress.IPv4Interface(ipv4_string)
1878         v4compat_ipv6 = ipaddress.IPv6Interface("::%s" % ipv4_string)
1879         self.assertEqual(int(v4compat_ipv6.ip), int(ipv4.ip))
1880         v4mapped_ipv6 = ipaddress.IPv6Interface("::ffff:%s" % ipv4_string)
1881         self.assertNotEqual(v4mapped_ipv6.ip, ipv4.ip)
1882         self.assertRaises(
1883             ipaddress.AddressValueError, ipaddress.IPv6Interface, "2001:1.1.1.1:1.1.1.1"
1884         )
1885     def testIPv6AddressTooLarge(self):
1886         self.assertEqual(
1887             ipaddress.ip_address("::FFFF:192.0.2.1"),
1888             ipaddress.ip_address("::FFFF:c000:201"),
1889         )
1890         self.assertEqual(
1891             ipaddress.ip_address("FFFF::192.0.2.1"),
1892             ipaddress.ip_address("FFFF::c000:201"),
1893         )
1894         self.assertEqual(
1895             ipaddress.ip_address("::FFFF:192.0.2.1%scope"),
1896             ipaddress.ip_address("::FFFF:c000:201%scope"),
1897         )
1898         self.assertEqual(
1899             ipaddress.ip_address("FFFF::192.0.2.1%scope"),
1900             ipaddress.ip_address("FFFF::c000:201%scope"),
1901         )
1902         self.assertNotEqual(
1903             ipaddress.ip_address("::FFFF:192.0.2.1%scope"),
1904             ipaddress.ip_address("::FFFF:c000:201"),
1905         )
1906         self.assertNotEqual(
1907             ipaddress.ip_address("FFFF::192.0.2.1%scope"),
1908             ipaddress.ip_address("FFFF::c000:201"),
1909         )
1910         self.assertNotEqual(
1911             ipaddress.ip_address("::FFFF:192.0.2.1"),
1912             ipaddress.ip_address("::FFFF:c000:201%scope"),
1913         )
1914         self.assertNotEqual(
1915             ipaddress.ip_address("FFFF::192.0.2.1"),
1916             ipaddress.ip_address("FFFF::c000:201%scope"),
1917         )
1918     def testIPVersion(self):
1919         self.assertEqual(self.ipv4_address.version, 4)
1920         self.assertEqual(self.ipv6_address.version, 6)
1921         self.assertEqual(self.ipv6_scoped_address.version, 6)
1922     def testMaxPrefixLength(self):
1923         self.assertEqual(self.ipv4_interface.max_prefixlen, 32)
1924         self.assertEqual(self.ipv6_interface.max_prefixlen, 128)
1925         self.assertEqual(self.ipv6_scoped_interface.max_prefixlen, 128)
1926     def testPacked(self):
1927         self.assertEqual(self.ipv4_address.packed, b"\x01\x02\x03\x04")
1928         self.assertEqual(
1929             ipaddress.IPv4Interface("255.254.253.252").packed, b"\xff\xfe\xfd\xfc"
1930         )
1931         self.assertEqual(
1932             self.ipv6_address.packed,
1933             b"\x20\x01\x06\x58\x02\x2a\xca\xfe\x02\x00\x00\x00\x00\x00\x00\x01",
1934         )
1935         self.assertEqual(
1936             ipaddress.IPv6Interface("ffff:2:3:4:ffff::").packed,
1937             b"\xff\xff\x00\x02\x00\x03\x00\x04\xff\xff" + b"\x00" * 6,
1938         )
1939         self.assertEqual(
1940             ipaddress.IPv6Interface("::1:0:0:0:0").packed,
1941             b"\x00" * 6 + b"\x00\x01" + b"\x00" * 8,
1942         )
1943         self.assertEqual(
1944             self.ipv6_scoped_address.packed,
1945             b"\x20\x01\x06\x58\x02\x2a\xca\xfe\x02\x00\x00\x00\x00\x00\x00\x01",
1946         )
1947         self.assertEqual(
1948             ipaddress.IPv6Interface("ffff:2:3:4:ffff::%scope").packed,
1949             b"\xff\xff\x00\x02\x00\x03\x00\x04\xff\xff" + b"\x00" * 6,
1950         )
1951         self.assertEqual(
1952             ipaddress.IPv6Interface("::1:0:0:0:0%scope").packed,
1953             b"\x00" * 6 + b"\x00\x01" + b"\x00" * 8,
1954         )
1955     def testIpType(self):
1956         ipv4net = ipaddress.ip_network("1.2.3.4")
1957         ipv4addr = ipaddress.ip_address("1.2.3.4")
1958         ipv6net = ipaddress.ip_network("::1.2.3.4")
1959         ipv6addr = ipaddress.ip_address("::1.2.3.4")
1960         self.assertEqual(ipaddress.IPv4Network, type(ipv4net))
1961         self.assertEqual(ipaddress.IPv4Address, type(ipv4addr))
1962         self.assertEqual(ipaddress.IPv6Network, type(ipv6net))
1963         self.assertEqual(ipaddress.IPv6Address, type(ipv6addr))
1964     def testReservedIpv4(self):
1965         self.assertEqual(True, ipaddress.ip_interface("224.1.1.1/31").is_multicast)
1966         self.assertEqual(False, ipaddress.ip_network("240.0.0.0").is_multicast)
1967         self.assertEqual(True, ipaddress.ip_network("240.0.0.0").is_reserved)
1968         self.assertEqual(True, ipaddress.ip_interface("192.168.1.1/17").is_private)
1969         self.assertEqual(False, ipaddress.ip_network("192.169.0.0").is_private)
1970         self.assertEqual(True, ipaddress.ip_network("10.255.255.255").is_private)
1971         self.assertEqual(False, ipaddress.ip_network("11.0.0.0").is_private)
1972         self.assertEqual(False, ipaddress.ip_network("11.0.0.0").is_reserved)
1973         self.assertEqual(True, ipaddress.ip_network("172.31.255.255").is_private)
1974         self.assertEqual(False, ipaddress.ip_network("172.32.0.0").is_private)
1975         self.assertEqual(True, ipaddress.ip_network("169.254.1.0/24").is_link_local)
1976         self.assertEqual(
1977             True, ipaddress.ip_interface("169.254.100.200/24").is_link_local
1978         )
1979         self.assertEqual(
1980             False, ipaddress.ip_interface("169.255.100.200/24").is_link_local
1981         )
1982         self.assertEqual(True, ipaddress.ip_network("127.100.200.254/32").is_loopback)
1983         self.assertEqual(True, ipaddress.ip_network("127.42.0.0/16").is_loopback)
1984         self.assertEqual(False, ipaddress.ip_network("128.0.0.0").is_loopback)
1985         self.assertEqual(False, ipaddress.ip_network("100.64.0.0/10").is_private)
1986         self.assertEqual(False, ipaddress.ip_network("100.64.0.0/10").is_global)
1987         self.assertEqual(True, ipaddress.ip_network("192.0.2.128/25").is_private)
1988         self.assertEqual(True, ipaddress.ip_network("192.0.3.0/24").is_global)
1989         self.assertEqual(True, ipaddress.ip_address("0.0.0.0").is_unspecified)
1990         self.assertEqual(True, ipaddress.ip_address("224.1.1.1").is_multicast)
1991         self.assertEqual(False, ipaddress.ip_address("240.0.0.0").is_multicast)
1992         self.assertEqual(True, ipaddress.ip_address("240.0.0.1").is_reserved)
1993         self.assertEqual(False, ipaddress.ip_address("239.255.255.255").is_reserved)
1994         self.assertEqual(True, ipaddress.ip_address("192.168.1.1").is_private)
1995         self.assertEqual(False, ipaddress.ip_address("192.169.0.0").is_private)
1996         self.assertEqual(True, ipaddress.ip_address("10.255.255.255").is_private)
1997         self.assertEqual(False, ipaddress.ip_address("11.0.0.0").is_private)
1998         self.assertEqual(True, ipaddress.ip_address("172.31.255.255").is_private)
1999         self.assertEqual(False, ipaddress.ip_address("172.32.0.0").is_private)
2000         self.assertEqual(True, ipaddress.ip_address("169.254.100.200").is_link_local)
2001         self.assertEqual(False, ipaddress.ip_address("169.255.100.200").is_link_local)
2002         self.assertTrue(ipaddress.ip_address("192.0.7.1").is_global)
2003         self.assertFalse(ipaddress.ip_address("203.0.113.1").is_global)
2004         self.assertEqual(True, ipaddress.ip_address("127.100.200.254").is_loopback)
2005         self.assertEqual(True, ipaddress.ip_address("127.42.0.0").is_loopback)
2006         self.assertEqual(False, ipaddress.ip_address("128.0.0.0").is_loopback)
2007         self.assertEqual(True, ipaddress.ip_network("0.0.0.0").is_unspecified)
2008     def testReservedIpv6(self):
2009         self.assertEqual(True, ipaddress.ip_network("ffff::").is_multicast)
2010         self.assertEqual(True, ipaddress.ip_network(2 ** 128 - 1).is_multicast)
2011         self.assertEqual(True, ipaddress.ip_network("ff00::").is_multicast)
2012         self.assertEqual(False, ipaddress.ip_network("fdff::").is_multicast)
2013         self.assertEqual(True, ipaddress.ip_network("fecf::").is_site_local)
2014         self.assertEqual(
2015             True, ipaddress.ip_network("feff:ffff:ffff:ffff::").is_site_local
2016         )
2017         self.assertEqual(False, ipaddress.ip_network("fbf:ffff::").is_site_local)
2018         self.assertEqual(False, ipaddress.ip_network("ff00::").is_site_local)
2019         self.assertEqual(True, ipaddress.ip_network("fc00::").is_private)
2020         self.assertEqual(True, ipaddress.ip_network("fc00:ffff:ffff:ffff::").is_private)
2021         self.assertEqual(False, ipaddress.ip_network("fbff:ffff::").is_private)
2022         self.assertEqual(False, ipaddress.ip_network("fe00::").is_private)
2023         self.assertEqual(True, ipaddress.ip_network("fea0::").is_link_local)
2024         self.assertEqual(True, ipaddress.ip_network("febf:ffff::").is_link_local)
2025         self.assertEqual(False, ipaddress.ip_network("fe7f:ffff::").is_link_local)
2026         self.assertEqual(False, ipaddress.ip_network("fec0::").is_link_local)
2027         self.assertEqual(True, ipaddress.ip_interface("0:0::0:01").is_loopback)
2028         self.assertEqual(False, ipaddress.ip_interface("::1/127").is_loopback)
2029         self.assertEqual(False, ipaddress.ip_network("::").is_loopback)
2030         self.assertEqual(False, ipaddress.ip_network("::2").is_loopback)
2031         self.assertEqual(True, ipaddress.ip_network("0::0").is_unspecified)
2032         self.assertEqual(False, ipaddress.ip_network("::1").is_unspecified)
2033         self.assertEqual(False, ipaddress.ip_network("::/127").is_unspecified)
2034         self.assertEqual(True, ipaddress.ip_network("2001::1/128").is_private)
2035         self.assertEqual(True, ipaddress.ip_network("200::1/128").is_global)
2036         self.assertEqual(True, ipaddress.ip_address("ffff::").is_multicast)
2037         self.assertEqual(True, ipaddress.ip_address(2 ** 128 - 1).is_multicast)
2038         self.assertEqual(True, ipaddress.ip_address("ff00::").is_multicast)
2039         self.assertEqual(False, ipaddress.ip_address("fdff::").is_multicast)
2040         self.assertEqual(True, ipaddress.ip_address("fecf::").is_site_local)
2041         self.assertEqual(
2042             True, ipaddress.ip_address("feff:ffff:ffff:ffff::").is_site_local
2043         )
2044         self.assertEqual(False, ipaddress.ip_address("fbf:ffff::").is_site_local)
2045         self.assertEqual(False, ipaddress.ip_address("ff00::").is_site_local)
2046         self.assertEqual(True, ipaddress.ip_address("fc00::").is_private)
2047         self.assertEqual(True, ipaddress.ip_address("fc00:ffff:ffff:ffff::").is_private)
2048         self.assertEqual(False, ipaddress.ip_address("fbff:ffff::").is_private)
2049         self.assertEqual(False, ipaddress.ip_address("fe00::").is_private)
2050         self.assertEqual(True, ipaddress.ip_address("fea0::").is_link_local)
2051         self.assertEqual(True, ipaddress.ip_address("febf:ffff::").is_link_local)
2052         self.assertEqual(False, ipaddress.ip_address("fe7f:ffff::").is_link_local)
2053         self.assertEqual(False, ipaddress.ip_address("fec0::").is_link_local)
2054         self.assertEqual(True, ipaddress.ip_address("0:0::0:01").is_loopback)
2055         self.assertEqual(True, ipaddress.ip_address("::1").is_loopback)
2056         self.assertEqual(False, ipaddress.ip_address("::2").is_loopback)
2057         self.assertEqual(True, ipaddress.ip_address("0::0").is_unspecified)
2058         self.assertEqual(False, ipaddress.ip_address("::1").is_unspecified)
2059         self.assertEqual(True, ipaddress.ip_address("100::").is_reserved)
2060         self.assertEqual(True, ipaddress.ip_network("4000::1/128").is_reserved)
2061     def testIpv4Mapped(self):
2062         self.assertEqual(
2063             ipaddress.ip_address("::ffff:192.168.1.1").ipv4_mapped,
2064             ipaddress.ip_address("192.168.1.1"),
2065         )
2066         self.assertEqual(ipaddress.ip_address("::c0a8:101").ipv4_mapped, None)
2067         self.assertEqual(
2068             ipaddress.ip_address("::ffff:c0a8:101").ipv4_mapped,
2069             ipaddress.ip_address("192.168.1.1"),
2070         )
2071     def testAddrExclude(self):
2072         addr1 = ipaddress.ip_network("10.1.1.0/24")
2073         addr2 = ipaddress.ip_network("10.1.1.0/26")
2074         addr3 = ipaddress.ip_network("10.2.1.0/24")
2075         addr4 = ipaddress.ip_address("10.1.1.0")
2076         addr5 = ipaddress.ip_network("2001:db8::0/32")
2077         addr6 = ipaddress.ip_network("10.1.1.5/32")
2078         self.assertEqual(
2079             sorted(list(addr1.address_exclude(addr2))),
2080             [
2081                 ipaddress.ip_network("10.1.1.64/26"),
2082                 ipaddress.ip_network("10.1.1.128/25"),
2083             ],
2084         )
2085         self.assertRaises(ValueError, list, addr1.address_exclude(addr3))
2086         self.assertRaises(TypeError, list, addr1.address_exclude(addr4))
2087         self.assertRaises(TypeError, list, addr1.address_exclude(addr5))
2088         self.assertEqual(list(addr1.address_exclude(addr1)), [])
2089         self.assertEqual(
2090             sorted(list(addr1.address_exclude(addr6))),
2091             [
2092                 ipaddress.ip_network("10.1.1.0/30"),
2093                 ipaddress.ip_network("10.1.1.4/32"),
2094                 ipaddress.ip_network("10.1.1.6/31"),
2095                 ipaddress.ip_network("10.1.1.8/29"),
2096                 ipaddress.ip_network("10.1.1.16/28"),
2097                 ipaddress.ip_network("10.1.1.32/27"),
2098                 ipaddress.ip_network("10.1.1.64/26"),
2099                 ipaddress.ip_network("10.1.1.128/25"),
2100             ],
2101         )
2102     def testHash(self):
2103         self.assertEqual(
2104             hash(ipaddress.ip_interface("10.1.1.0/24")),
2105             hash(ipaddress.ip_interface("10.1.1.0/24")),
2106         )
2107         self.assertEqual(
2108             hash(ipaddress.ip_network("10.1.1.0/24")),
2109             hash(ipaddress.ip_network("10.1.1.0/24")),
2110         )
2111         self.assertEqual(
2112             hash(ipaddress.ip_address("10.1.1.0")),
2113             hash(ipaddress.ip_address("10.1.1.0")),
2114         )
2115         self.assertEqual(
2116             hash(ipaddress.ip_address("1.2.3.4")),
2117             hash(ipaddress.ip_address(int(ipaddress.ip_address("1.2.3.4")._ip))),
2118         )
2119         ip1 = ipaddress.ip_address("10.1.1.0")
2120         ip2 = ipaddress.ip_address("1::")
2121         dummy = {}
2122         dummy[self.ipv4_address] = None
2123         dummy[self.ipv6_address] = None
2124         dummy[ip1] = None
2125         dummy[ip2] = None
2126         self.assertIn(self.ipv4_address, dummy)
2127         self.assertIn(ip2, dummy)
2128     def testIPBases(self):
2129         net = self.ipv4_network
2130         self.assertEqual("1.2.3.0/24", net.compressed)
2131         net = self.ipv6_network
2132         self.assertRaises(ValueError, net._string_from_ip_int, 2 ** 128 + 1)
2133     def testIPv6NetworkHelpers(self):
2134         net = self.ipv6_network
2135         self.assertEqual("2001:658:22a:cafe::/64", net.with_prefixlen)
2136         self.assertEqual("2001:658:22a:cafe::/ffff:ffff:ffff:ffff::", net.with_netmask)
2137         self.assertEqual("2001:658:22a:cafe::/::ffff:ffff:ffff:ffff", net.with_hostmask)
2138         self.assertEqual("2001:658:22a:cafe::/64", str(net))
2139     def testIPv4NetworkHelpers(self):
2140         net = self.ipv4_network
2141         self.assertEqual("1.2.3.0/24", net.with_prefixlen)
2142         self.assertEqual("1.2.3.0/255.255.255.0", net.with_netmask)
2143         self.assertEqual("1.2.3.0/0.0.0.255", net.with_hostmask)
2144         self.assertEqual("1.2.3.0/24", str(net))
2145     def testCopyConstructor(self):
2146         addr1 = ipaddress.ip_network("10.1.1.0/24")
2147         addr2 = ipaddress.ip_network(addr1)
2148         addr3 = ipaddress.ip_interface("2001:658:22a:cafe:200::1/64")
2149         addr4 = ipaddress.ip_interface(addr3)
2150         addr5 = ipaddress.IPv4Address("1.1.1.1")
2151         addr6 = ipaddress.IPv6Address("2001:658:22a:cafe:200::1")
2152         self.assertEqual(addr1, addr2)
2153         self.assertEqual(addr3, addr4)
2154         self.assertEqual(addr5, ipaddress.IPv4Address(addr5))
2155         self.assertEqual(addr6, ipaddress.IPv6Address(addr6))
2156     def testCompressIPv6Address(self):
2157         test_addresses = {
2158             "1:2:3:4:5:6:7:8": "1:2:3:4:5:6:7:8/128",
2159             "2001:0:0:4:0:0:0:8": "2001:0:0:4::8/128",
2160             "2001:0:0:4:5:6:7:8": "2001::4:5:6:7:8/128",
2161             "2001:0:3:4:5:6:7:8": "2001:0:3:4:5:6:7:8/128",
2162             "0:0:3:0:0:0:0:ffff": "0:0:3::ffff/128",
2163             "0:0:0:4:0:0:0:ffff": "::4:0:0:0:ffff/128",
2164             "0:0:0:0:5:0:0:ffff": "::5:0:0:ffff/128",
2165             "1:0:0:4:0:0:7:8": "1::4:0:0:7:8/128",
2166             "0:0:0:0:0:0:0:0": "::/128",
2167             "0:0:0:0:0:0:0:0/0": "::/0",
2168             "0:0:0:0:0:0:0:1": "::1/128",
2169             "2001:0658:022a:cafe:0000:0000:0000:0000/66": "2001:658:22a:cafe::/66",
2170             "::1.2.3.4": "::102:304/128",
2171             "1:2:3:4:5:ffff:1.2.3.4": "1:2:3:4:5:ffff:102:304/128",
2172             "::7:6:5:4:3:2:1": "0:7:6:5:4:3:2:1/128",
2173             "::7:6:5:4:3:2:0": "0:7:6:5:4:3:2:0/128",
2174             "7:6:5:4:3:2:1::": "7:6:5:4:3:2:1:0/128",
2175             "0:6:5:4:3:2:1::": "0:6:5:4:3:2:1:0/128",
2176         }
2177         for uncompressed, compressed in list(test_addresses.items()):
2178             self.assertEqual(compressed, str(ipaddress.IPv6Interface(uncompressed)))
2179     def testExplodeShortHandIpStr(self):
2180         addr1 = ipaddress.IPv6Interface("2001::1")
2181         addr2 = ipaddress.IPv6Address("2001:0:5ef5:79fd:0:59d:a0e5:ba1")
2182         addr3 = ipaddress.IPv6Network("2001::/96")
2183         addr4 = ipaddress.IPv4Address("192.168.178.1")
2184         self.assertEqual("2001:0000:0000:0000:0000:0000:0000:0001/128", addr1.exploded)
2185         self.assertEqual(
2186             "0000:0000:0000:0000:0000:0000:0000:0001/128",
2187             ipaddress.IPv6Interface("::1/128").exploded,
2188         )
2189         self.assertEqual("2001:0000:5ef5:79fd:0000:059d:a0e5:0ba1", addr2.exploded)
2190         self.assertEqual("2001:0000:0000:0000:0000:0000:0000:0000/96", addr3.exploded)
2191         self.assertEqual("192.168.178.1", addr4.exploded)
2192     def testReversePointer(self):
2193         addr1 = ipaddress.IPv4Address("127.0.0.1")
2194         addr2 = ipaddress.IPv6Address("2001:db8::1")
2195         self.assertEqual("1.0.0.127.in-addr.arpa", addr1.reverse_pointer)
2196         self.assertEqual(
2197             "1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8."
2198             + "b.d.0.1.0.0.2.ip6.arpa",
2199             addr2.reverse_pointer,
2200         )
2201     def testIntRepresentation(self):
2202         self.assertEqual(16909060, int(self.ipv4_address))
2203         self.assertEqual(42540616829182469433547762482097946625, int(self.ipv6_address))
2204     def testForceVersion(self):
2205         self.assertEqual(ipaddress.ip_network(1).version, 4)
2206         self.assertEqual(ipaddress.IPv6Network(1).version, 6)
2207     def testWithStar(self):
2208         self.assertEqual(self.ipv4_interface.with_prefixlen, "1.2.3.4/24")
2209         self.assertEqual(self.ipv4_interface.with_netmask, "1.2.3.4/255.255.255.0")
2210         self.assertEqual(self.ipv4_interface.with_hostmask, "1.2.3.4/0.0.0.255")
2211         self.assertEqual(
2212             self.ipv6_interface.with_prefixlen, "2001:658:22a:cafe:200::1/64"
2213         )
2214         self.assertEqual(
2215             self.ipv6_interface.with_netmask,
2216             "2001:658:22a:cafe:200::1/ffff:ffff:ffff:ffff::",
2217         )
2218         self.assertEqual(
2219             self.ipv6_interface.with_hostmask,
2220             "2001:658:22a:cafe:200::1/::ffff:ffff:ffff:ffff",
2221         )
2222     def testNetworkElementCaching(self):
2223         self.assertNotIn("broadcast_address", self.ipv4_network._cache)
2224         self.assertNotIn("hostmask", self.ipv4_network._cache)
2225         self.assertEqual(
2226             self.ipv4_network.broadcast_address, ipaddress.IPv4Address("1.2.3.255")
2227         )
2228         self.assertEqual(self.ipv4_network.hostmask, ipaddress.IPv4Address("0.0.0.255"))
2229         self.assertIn("broadcast_address", self.ipv4_network._cache)
2230         self.assertIn("hostmask", self.ipv4_network._cache)
2231         self.assertNotIn("broadcast_address", self.ipv6_network._cache)
2232         self.assertNotIn("hostmask", self.ipv6_network._cache)
2233         self.assertEqual(
2234             self.ipv6_network.network_address,
2235             ipaddress.IPv6Address("2001:658:22a:cafe::"),
2236         )
2237         self.assertEqual(
2238             self.ipv6_interface.network.network_address,
2239             ipaddress.IPv6Address("2001:658:22a:cafe::"),
2240         )
2241         self.assertEqual(
2242             self.ipv6_network.broadcast_address,
2243             ipaddress.IPv6Address("2001:658:22a:cafe:ffff:ffff:ffff:ffff"),
2244         )
2245         self.assertEqual(
2246             self.ipv6_network.hostmask, ipaddress.IPv6Address("::ffff:ffff:ffff:ffff")
2247         )
2248         self.assertEqual(
2249             self.ipv6_interface.network.broadcast_address,
2250             ipaddress.IPv6Address("2001:658:22a:cafe:ffff:ffff:ffff:ffff"),
2251         )
2252         self.assertEqual(
2253             self.ipv6_interface.network.hostmask,
2254             ipaddress.IPv6Address("::ffff:ffff:ffff:ffff"),
2255         )
2256         self.assertIn("broadcast_address", self.ipv6_network._cache)
2257         self.assertIn("hostmask", self.ipv6_network._cache)
2258         self.assertIn("broadcast_address", self.ipv6_interface.network._cache)
2259         self.assertIn("hostmask", self.ipv6_interface.network._cache)
2260     def testTeredo(self):
2261         server = ipaddress.IPv4Address("65.54.227.120")
2262         client = ipaddress.IPv4Address("192.0.2.45")
2263         teredo_addr = "2001:0000:4136:e378:8000:63bf:3fff:fdd2"
2264         self.assertEqual((server, client), ipaddress.ip_address(teredo_addr).teredo)
2265         bad_addr = "2000::4136:e378:8000:63bf:3fff:fdd2"
2266         self.assertFalse(ipaddress.ip_address(bad_addr).teredo)
2267         bad_addr = "2001:0001:4136:e378:8000:63bf:3fff:fdd2"
2268         self.assertFalse(ipaddress.ip_address(bad_addr).teredo)
2269         teredo_addr = ipaddress.IPv6Address("2001:0:5ef5:79fd:0:59d:a0e5:ba1")
2270         self.assertEqual(
2271             (
2272                 ipaddress.IPv4Address("94.245.121.253"),
2273                 ipaddress.IPv4Address("95.26.244.94"),
2274             ),
2275             teredo_addr.teredo,
2276         )
2277     def testsixtofour(self):
2278         sixtofouraddr = ipaddress.ip_address("2002:ac1d:2d64::1")
2279         bad_addr = ipaddress.ip_address("2000:ac1d:2d64::1")
2280         self.assertEqual(
2281             ipaddress.IPv4Address("172.29.45.100"), sixtofouraddr.sixtofour
2282         )
2283         self.assertFalse(bad_addr.sixtofour)
2284     def testV4HashIsNotConstant(self):
2285         ipv4_address1 = ipaddress.IPv4Interface("1.2.3.4")
2286         ipv4_address2 = ipaddress.IPv4Interface("2.3.4.5")
2287         self.assertNotEqual(ipv4_address1.__hash__(), ipv4_address2.__hash__())
2288     def testV6HashIsNotConstant(self):
2289         ipv6_address1 = ipaddress.IPv6Interface("2001:658:22a:cafe:200:0:0:1")
2290         ipv6_address2 = ipaddress.IPv6Interface("2001:658:22a:cafe:200:0:0:2")
2291         self.assertNotEqual(ipv6_address1.__hash__(), ipv6_address2.__hash__())
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
