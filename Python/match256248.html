<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for lxd_container.py &amp; bigip.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for lxd_container.py &amp; bigip.py
      </h3>
<h1 align="center">
        1.0%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>lxd_container.py (2.1840873%)<th>bigip.py (0.6698565%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(49-65)<td><a href="#" name="0">(627-646)</a><td align="center"><font color="#ff0000">14</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>lxd_container.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from salt.exceptions import CommandExecutionError, SaltInvocationError
2 __docformat__ = "restructuredtext en"
3 __virtualname__ = "lxd_container"
4 CONTAINER_STATUS_RUNNING = 103
5 CONTAINER_STATUS_FROZEN = 110
6 CONTAINER_STATUS_STOPPED = 102
7 def __virtual__():
8     return (F<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>alse, "lxd module could not be loaded")
9 def present(
10     name,
11     running=None,
12     source=None,
13     profiles=None,
14     config=None,
15     devices=None,
16     architecture="x86_64",
17     ephemeral=False,
18     restart_on_change=False,
19     remote_addr=None,
20     cert=None,
21     key=None,
22     verify_cert=</b></font>True,
23 ):
24     if profiles is None:
25         profiles = ["default"]
26     if source is None:
27         source = {}
28     ret = {
29         "name": name,
30         "running": running,
31         "profiles": profiles,
32         "source": source,
33         "config": config,
34         "devices": devices,
35         "architecture": architecture,
36         "ephemeral": ephemeral,
37         "restart_on_change": restart_on_change,
38         "remote_addr": remote_addr,
39         "cert": cert,
40         "key": key,
41         "verify_cert": verify_cert,
42         "changes": {},
43     }
44     container = None
45     try:
46         container = __salt__["lxd.container_get"](
47             name, remote_addr, cert, key, verify_cert, _raw=True
48         )
49     except CommandExecutionError as e:
50         return _error(ret, str(e))
51     except SaltInvocationError as e:
52         pass
53     if container is None:
54         if __opts__["test"]:
55             msg = 'Would create the container "{}"'.format(name)
56             ret["changes"] = {"created": msg}
57             if running is True:
58                 msg = msg + " and start it."
59                 ret["changes"]["started"] = 'Would start the container "{}"'.format(
60                     name
61                 )
62             ret["changes"] = {"created": msg}
63             return _unchanged(ret, msg)
64         try:
65             __salt__["lxd.container_create"](
66                 name,
67                 source,
68                 profiles,
69                 config,
70                 devices,
71                 architecture,
72                 ephemeral,
73                 True,  # Wait
74                 remote_addr,
75                 cert,
76                 key,
77                 verify_cert,
78             )
79         except CommandExecutionError as e:
80             return _error(ret, str(e))
81         msg = 'Created the container "{}"'.format(name)
82         ret["changes"] = {"created": msg}
83         if running is True:
84             try:
85                 __salt__["lxd.container_start"](
86                     name, remote_addr, cert, key, verify_cert
87                 )
88             except CommandExecutionError as e:
89                 return _error(ret, str(e))
90             msg = msg + " and started it."
91             ret["changes"] = {"started": 'Started the container "{}"'.format(name)}
92         return _success(ret, msg)
93     new_profiles = set(map(str, profiles))
94     old_profiles = set(map(str, container.profiles))
95     container_changed = False
96     profile_changes = []
97     for k in old_profiles.difference(new_profiles):
98         if not __opts__["test"]:
99             profile_changes.append('Removed profile "{}"'.format(k))
100             old_profiles.discard(k)
101         else:
102             profile_changes.append('Would remove profile "{}"'.format(k))
103     for k in new_profiles.difference(old_profiles):
104         if not __opts__["test"]:
105             profile_changes.append('Added profile "{}"'.format(k))
106             old_profiles.add(k)
107         else:
108             profile_changes.append('Would add profile "{}"'.format(k))
109     if profile_changes:
110         container_changed = True
111         ret["changes"]["profiles"] = profile_changes
112         container.profiles = list(old_profiles)
113     config, devices = __salt__["lxd.normalize_input_values"](config, devices)
114     changes = __salt__["lxd.sync_config_devices"](
115         container, config, devices, __opts__["test"]
116     )
117     if changes:
118         container_changed = True
119         ret["changes"].update(changes)
120     is_running = container.status_code == CONTAINER_STATUS_RUNNING
121     if not __opts__["test"]:
122         try:
123             __salt__["lxd.pylxd_save_object"](container)
124         except CommandExecutionError as e:
125             return _error(ret, str(e))
126     if running != is_running:
127         if running is True:
128             if __opts__["test"]:
129                 changes["running"] = "Would start the container"
130                 return _unchanged(
131                     ret,
132                     'Container "{}" would get changed and started.'.format(name),
133                 )
134             else:
135                 container.start(wait=True)
136                 changes["running"] = "Started the container"
137         elif running is False:
138             if __opts__["test"]:
139                 changes["stopped"] = "Would stopped the container"
140                 return _unchanged(
141                     ret,
142                     'Container "{}" would get changed and stopped.'.format(name),
143                 )
144             else:
145                 container.stop(wait=True)
146                 changes["stopped"] = "Stopped the container"
147     if (
148         (running is True or running is None)
149         and is_running
150         and restart_on_change
151         and container_changed
152     ):
153         if __opts__["test"]:
154             changes["restarted"] = "Would restart the container"
155             return _unchanged(ret, 'Would restart the container "{}"'.format(name))
156         else:
157             container.restart(wait=True)
158             changes["restarted"] = 'Container "{}" has been restarted'.format(name)
159             return _success(ret, 'Container "{}" has been restarted'.format(name))
160     if not container_changed:
161         return _success(ret, "No changes")
162     if __opts__["test"]:
163         return _unchanged(ret, 'Container "{}" would get changed.'.format(name))
164     return _success(ret, "{} changes".format(len(ret["changes"].keys())))
165 def absent(name, stop=False, remote_addr=None, cert=None, key=None, verify_cert=True):
166     ret = {
167         "name": name,
168         "stop": stop,
169         "remote_addr": remote_addr,
170         "cert": cert,
171         "key": key,
172         "verify_cert": verify_cert,
173         "changes": {},
174     }
175     try:
176         container = __salt__["lxd.container_get"](
177             name, remote_addr, cert, key, verify_cert, _raw=True
178         )
179     except CommandExecutionError as e:
180         return _error(ret, str(e))
181     except SaltInvocationError as e:
182         return _success(ret, 'Container "{}" not found.'.format(name))
183     if __opts__["test"]:
184         ret["changes"] = {"removed": 'Container "{}" would get deleted.'.format(name)}
185         return _unchanged(ret, ret["changes"]["removed"])
186     if stop and container.status_code == CONTAINER_STATUS_RUNNING:
187         container.stop(wait=True)
188     container.delete(wait=True)
189     ret["changes"]["deleted"] = 'Container "{}" has been deleted.'.format(name)
190     return _success(ret, ret["changes"]["deleted"])
191 def running(
192     name, restart=False, remote_addr=None, cert=None, key=None, verify_cert=True
193 ):
194     ret = {
195         "name": name,
196         "restart": restart,
197         "remote_addr": remote_addr,
198         "cert": cert,
199         "key": key,
200         "verify_cert": verify_cert,
201         "changes": {},
202     }
203     try:
204         container = __salt__["lxd.container_get"](
205             name, remote_addr, cert, key, verify_cert, _raw=True
206         )
207     except CommandExecutionError as e:
208         return _error(ret, str(e))
209     except SaltInvocationError as e:
210         return _error(ret, 'Container "{}" not found'.format(name))
211     is_running = container.status_code == CONTAINER_STATUS_RUNNING
212     if is_running:
213         if not restart:
214             return _success(ret, 'The container "{}" is already running'.format(name))
215         else:
216             if __opts__["test"]:
217                 ret["changes"]["restarted"] = 'Would restart the container "{}"'.format(
218                     name
219                 )
220                 return _unchanged(ret, ret["changes"]["restarted"])
221             else:
222                 container.restart(wait=True)
223                 ret["changes"]["restarted"] = 'Restarted the container "{}"'.format(
224                     name
225                 )
226                 return _success(ret, ret["changes"]["restarted"])
227     if __opts__["test"]:
228         ret["changes"]["started"] = 'Would start the container "{}"'.format(name)
229         return _unchanged(ret, ret["changes"]["started"])
230     container.start(wait=True)
231     ret["changes"]["started"] = 'Started the container "{}"'.format(name)
232     return _success(ret, ret["changes"]["started"])
233 def frozen(name, start=True, remote_addr=None, cert=None, key=None, verify_cert=True):
234     ret = {
235         "name": name,
236         "start": start,
237         "remote_addr": remote_addr,
238         "cert": cert,
239         "key": key,
240         "verify_cert": verify_cert,
241         "changes": {},
242     }
243     try:
244         container = __salt__["lxd.container_get"](
245             name, remote_addr, cert, key, verify_cert, _raw=True
246         )
247     except CommandExecutionError as e:
248         return _error(ret, str(e))
249     except SaltInvocationError as e:
250         return _error(ret, 'Container "{}" not found'.format(name))
251     if container.status_code == CONTAINER_STATUS_FROZEN:
252         return _success(ret, 'Container "{}" is alredy frozen'.format(name))
253     is_running = container.status_code == CONTAINER_STATUS_RUNNING
254     if not is_running and not start:
255         return _error(
256             ret,
257             'Container "{}" is not running and start is False, cannot freeze it'.format(
258                 name
259             ),
260         )
261     elif not is_running and start:
262         if __opts__["test"]:
263             ret["changes"][
264                 "started"
265             ] = 'Would start the container "{}" and freeze it after'.format(name)
266             return _unchanged(ret, ret["changes"]["started"])
267         else:
268             container.start(wait=True)
269             ret["changes"]["started"] = 'Start the container "{}"'.format(name)
270     if __opts__["test"]:
271         ret["changes"]["frozen"] = 'Would freeze the container "{}"'.format(name)
272         return _unchanged(ret, ret["changes"]["frozen"])
273     container.freeze(wait=True)
274     ret["changes"]["frozen"] = 'Froze the container "{}"'.format(name)
275     return _success(ret, ret["changes"]["frozen"])
276 def stopped(name, kill=False, remote_addr=None, cert=None, key=None, verify_cert=True):
277     ret = {
278         "name": name,
279         "kill": kill,
280         "remote_addr": remote_addr,
281         "cert": cert,
282         "key": key,
283         "verify_cert": verify_cert,
284         "changes": {},
285     }
286     try:
287         container = __salt__["lxd.container_get"](
288             name, remote_addr, cert, key, verify_cert, _raw=True
289         )
290     except CommandExecutionError as e:
291         return _error(ret, str(e))
292     except SaltInvocationError as e:
293         return _error(ret, 'Container "{}" not found'.format(name))
294     if container.status_code == CONTAINER_STATUS_STOPPED:
295         return _success(ret, 'Container "{}" is already stopped'.format(name))
296     if __opts__["test"]:
297         ret["changes"]["stopped"] = 'Would stop the container "{}"'.format(name)
298         return _unchanged(ret, ret["changes"]["stopped"])
299     container.stop(force=kill, wait=True)
300     ret["changes"]["stopped"] = 'Stopped the container "{}"'.format(name)
301     return _success(ret, ret["changes"]["stopped"])
302 def migrated(
303     name,
304     remote_addr,
305     cert,
306     key,
307     verify_cert,
308     src_remote_addr,
309     stop_and_start=False,
310     src_cert=None,
311     src_key=None,
312     src_verify_cert=None,
313 ):
314     ret = {
315         "name": name,
316         "remote_addr": remote_addr,
317         "cert": cert,
318         "key": key,
319         "verify_cert": verify_cert,
320         "src_remote_addr": src_remote_addr,
321         "src_and_start": stop_and_start,
322         "src_cert": src_cert,
323         "src_key": src_key,
324         "changes": {},
325     }
326     dest_container = None
327     try:
328         dest_container = __salt__["lxd.container_get"](
329             name, remote_addr, cert, key, verify_cert, _raw=True
330         )
331     except CommandExecutionError as e:
332         return _error(ret, str(e))
333     except SaltInvocationError as e:
334         pass
335     if dest_container is not None:
336         return _success(ret, 'Container "{}" exists on the destination'.format(name))
337     if src_verify_cert is None:
338         src_verify_cert = verify_cert
339     try:
340         __salt__["lxd.container_get"](
341             name, src_remote_addr, src_cert, src_key, src_verify_cert, _raw=True
342         )
343     except CommandExecutionError as e:
344         return _error(ret, str(e))
345     except SaltInvocationError as e:
346         return _error(ret, 'Source Container "{}" not found'.format(name))
347     if __opts__["test"]:
348         ret["changes"][
349             "migrated"
350         ] = 'Would migrate the container "{}" from "{}" to "{}"'.format(
351             name, src_remote_addr, remote_addr
352         )
353         return _unchanged(ret, ret["changes"]["migrated"])
354     try:
355         __salt__["lxd.container_migrate"](
356             name,
357             stop_and_start,
358             remote_addr,
359             cert,
360             key,
361             verify_cert,
362             src_remote_addr,
363             src_cert,
364             src_key,
365             src_verify_cert,
366         )
367     except CommandExecutionError as e:
368         return _error(ret, str(e))
369     ret["changes"]["migrated"] = 'Migrated the container "{}" from "{}" to "{}"'.format(
370         name, src_remote_addr, remote_addr
371     )
372     return _success(ret, ret["changes"]["migrated"])
373 def _success(ret, success_msg):
374     ret["result"] = True
375     ret["comment"] = success_msg
376     if "changes" not in ret:
377         ret["changes"] = {}
378     return ret
379 def _unchanged(ret, msg):
380     ret["result"] = None
381     ret["comment"] = msg
382     if "changes" not in ret:
383         ret["changes"] = {}
384     return ret
385 def _error(ret, err_msg):
386     ret["result"] = False
387     ret["comment"] = err_msg
388     if "changes" not in ret:
389         ret["changes"] = {}
390     return ret
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>bigip.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import salt.utils.json
2 def __virtual__():
3     if "bigip.list_transaction" in __salt__:
4         return "bigip"
5     return (False, "bigip module could not be loaded")
6 def _load_result(response, ret):
7     if response["code"] is None:
8         ret["comment"] = response["content"]
9     elif response["code"] == 401:
10         ret["comment"] = "401 Forbidden: Authentication required!"
11     elif response["code"] == 404:
12         ret["comment"] = response["content"]["message"]
13     elif response["code"] == 200:
14         ret["result"] = True
15         ret["comment"] = (
16             "Listing Current Configuration Only.  "
17             "Not action or changes occurred during the execution of this state."
18         )
19         ret["changes"] = response["content"]
20     else:
21         ret["comment"] = response["content"]["message"]
22     return ret
23 def _strip_key(dictionary, keyword):
24     for key, value in dictionary.items():
25         if key == keyword:
26             dictionary[key] = None
27         elif isinstance(value, dict):
28             _strip_key(value, keyword)
29         elif isinstance(value, list):
30             for item in value:
31                 if isinstance(item, dict):
32                     _strip_key(item, keyword)
33     return dictionary
34 def _check_for_changes(entity_type, ret, existing, modified):
35     ret["result"] = True
36     if isinstance(existing, dict) and isinstance(modified, dict):
37         if "generation" in modified["content"].keys():
38             del modified["content"]["generation"]
39         if "generation" in existing["content"].keys():
40             del existing["content"]["generation"]
41         if modified["content"] == existing["content"]:
42             ret["comment"] = (
43                 "{entity_type} is currently enforced to the desired state.  No changes"
44                 " made.".format(entity_type=entity_type)
45             )
46         else:
47             ret["comment"] = (
48                 "{entity_type} was enforced to the desired state.  Note: Only"
49                 " parameters specified were enforced. See changes for details.".format(
50                     entity_type=entity_type
51                 )
52             )
53             ret["changes"]["old"] = existing["content"]
54             ret["changes"]["new"] = modified["content"]
55     else:
56         if modified == existing:
57             ret["comment"] = (
58                 "{entity_type} is currently enforced to the desired state.  No changes"
59                 " made.".format(entity_type=entity_type)
60             )
61         else:
62             ret["comment"] = (
63                 "{entity_type} was enforced to the desired state.  Note: Only"
64                 " parameters specified were enforced. See changes for details.".format(
65                     entity_type=entity_type
66                 )
67             )
68             ret["changes"]["old"] = existing
69             ret["changes"]["new"] = modified
70     return ret
71 def _test_output(ret, action, params):
72     if action == "list":
73         ret[
74             "comment"
75         ] += "The list action will just list an entity and will make no changes.\n"
76     elif action == "create" or action == "add":
77         ret["comment"] += (
78             "The create action will attempt to create an entity if it does not already"
79             " exist.\n"
80         )
81     elif action == "delete":
82         ret["comment"] += (
83             "The delete action will attempt to delete an existing entity if it"
84             " exists.\n"
85         )
86     elif action == "manage":
87         ret["comment"] += (
88             "The manage action will create a new entity if it does not exist.  If it"
89             " does exist, it will be enforcedto the desired state.\n"
90         )
91     elif action == "modify":
92         ret["comment"] += (
93             "The modify action will attempt to modify an existing entity only if it"
94             " exists.\n"
95         )
96     ret["comment"] += "An iControl REST Request will be made using the parameters:\n"
97     ret["comment"] += salt.utils.json.dumps(params, indent=4)
98     ret["changes"] = {}
99     ret["result"] = None
100     return ret
101 def list_node(hostname, username, password, name):
102     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
103     if __opts__["test"]:
104         return _test_output(
105             ret,
106             "list",
107             params={
108                 "hostname": hostname,
109                 "username": username,
110                 "password": password,
111                 "name": name,
112             },
113         )
114     response = __salt__["bigip.list_node"](hostname, username, password, name)
115     return _load_result(response, ret)
116 def create_node(hostname, username, password, name, address):
117     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
118     if __opts__["test"]:
119         return _test_output(
120             ret,
121             "create",
122             params={
123                 "hostname": hostname,
124                 "username": username,
125                 "password": password,
126                 "name": name,
127                 "address": address,
128             },
129         )
130     existing = __salt__["bigip.list_node"](hostname, username, password, name)
131     if existing["code"] == 200:
132         ret["result"] = True
133         ret["comment"] = "A node by this name currently exists.  No change made."
134     elif existing["code"] == 404:
135         response = __salt__["bigip.create_node"](
136             hostname, username, password, name, address
137         )
138         ret["result"] = True
139         ret["changes"]["old"] = {}
140         ret["changes"]["new"] = response["content"]
141         ret["comment"] = "Node was successfully created."
142     else:
143         ret = _load_result(existing, ret)
144     return ret
145 def manage_node(
146     hostname,
147     username,
148     password,
149     name,
150     address,
151     connection_limit=None,
152     description=None,
153     dynamic_ratio=None,
154     logging=None,
155     monitor=None,
156     rate_limit=None,
157     ratio=None,
158     session=None,
159     node_state=None,
160 ):
161     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
162     if __opts__["test"]:
163         return _test_output(
164             ret,
165             "manage",
166             params={
167                 "hostname": hostname,
168                 "username": username,
169                 "password": password,
170                 "name": name,
171                 "address": address,
172                 "connection_limit": connection_limit,
173                 "description": description,
174                 "dynamic_ratio": dynamic_ratio,
175                 "logging": logging,
176                 "monitor": monitor,
177                 "rate_limit": rate_limit,
178                 "ratio": ratio,
179                 "session": session,
180                 "state:": node_state,
181             },
182         )
183     existing = __salt__["bigip.list_node"](hostname, username, password, name)
184     if existing["code"] == 200:
185         if existing["content"]["address"] != address:
186             ret["result"] = False
187             ret[
188                 "comment"
189             ] = "A node with this name exists but the address does not match."
190         modified = __salt__["bigip.modify_node"](
191             hostname=hostname,
192             username=username,
193             password=password,
194             name=name,
195             connection_limit=connection_limit,
196             description=description,
197             dynamic_ratio=dynamic_ratio,
198             logging=logging,
199             monitor=monitor,
200             rate_limit=rate_limit,
201             ratio=ratio,
202             session=session,
203             state=node_state,
204         )
205         if modified["code"] == 200:
206             ret = _check_for_changes("Node", ret, existing, modified)
207         else:
208             ret = _load_result(modified, ret)
209     elif existing["code"] == 404:
210         new = __salt__["bigip.create_node"](hostname, username, password, name, address)
211         if new["code"] == 200:
212             modified = __salt__["bigip.modify_node"](
213                 hostname=hostname,
214                 username=username,
215                 password=password,
216                 name=name,
217                 connection_limit=connection_limit,
218                 description=description,
219                 dynamic_ratio=dynamic_ratio,
220                 logging=logging,
221                 monitor=monitor,
222                 rate_limit=rate_limit,
223                 ratio=ratio,
224                 session=session,
225                 state=node_state,
226             )
227             if modified["code"] == 200:
228                 ret["result"] = True
229                 ret["comment"] = (
230                     "Node was created and enforced to the desired state.  Note: Only"
231                     " parameters specified were enforced.  See changes for details."
232                 )
233                 ret["changes"]["old"] = {}
234                 ret["changes"]["new"] = modified["content"]
235             else:
236                 deleted = __salt__["bigip.delete_node"](
237                     hostname, username, password, name
238                 )
239                 if deleted["code"] == 200:
240                     ret["comment"] = (
241                         "Node was successfully created but an error occurred during"
242                         " modification. The creation of the node has been rolled back."
243                         " Message is as follows:\n{message}".format(
244                             message=modified["content"]["message"]
245                         )
246                     )
247                 else:
248                     ret["comment"] = (
249                         "Node was successfully created but an error occurred during"
250                         " modification. The creation of the node was not able to be"
251                         " rolled back. Message is as follows:\n"
252                         " {message}\n{message_two}".format(
253                             message=modified["content"]["message"],
254                             message_two=deleted["content"]["message"],
255                         )
256                     )
257         else:
258             ret = _load_result(new, ret)
259     else:
260         ret = _load_result(existing, ret)
261     return ret
262 def modify_node(
263     hostname,
264     username,
265     password,
266     name,
267     connection_limit=None,
268     description=None,
269     dynamic_ratio=None,
270     logging=None,
271     monitor=None,
272     rate_limit=None,
273     ratio=None,
274     session=None,
275     node_state=None,
276 ):
277     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
278     if __opts__["test"]:
279         return _test_output(
280             ret,
281             "modify",
282             params={
283                 "hostname": hostname,
284                 "username": username,
285                 "password": password,
286                 "name": name,
287                 "connection_limit": connection_limit,
288                 "description": description,
289                 "dynamic_ratio": dynamic_ratio,
290                 "logging": logging,
291                 "monitor": monitor,
292                 "rate_limit": rate_limit,
293                 "ratio": ratio,
294                 "session": session,
295                 "state:": node_state,
296             },
297         )
298     existing = __salt__["bigip.list_node"](hostname, username, password, name)
299     if existing["code"] == 200:
300         modified = __salt__["bigip.modify_node"](
301             hostname=hostname,
302             username=username,
303             password=password,
304             name=name,
305             connection_limit=connection_limit,
306             description=description,
307             dynamic_ratio=dynamic_ratio,
308             logging=logging,
309             monitor=monitor,
310             rate_limit=rate_limit,
311             ratio=ratio,
312             session=session,
313             state=node_state,
314         )
315         if modified["code"] == 200:
316             ret = _check_for_changes("Node", ret, existing, modified)
317         else:
318             ret = _load_result(modified, ret)
319     elif existing["code"] == 404:
320         ret["comment"] = "A node with this name was not found."
321     else:
322         ret = _load_result(existing, ret)
323     return ret
324 def delete_node(hostname, username, password, name):
325     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
326     if __opts__["test"]:
327         return _test_output(
328             ret,
329             "delete",
330             params={
331                 "hostname": hostname,
332                 "username": username,
333                 "password": password,
334                 "name": name,
335             },
336         )
337     existing = __salt__["bigip.list_node"](hostname, username, password, name)
338     if existing["code"] == 200:
339         deleted = __salt__["bigip.delete_node"](hostname, username, password, name)
340         if deleted["code"] == 200:
341             ret["result"] = True
342             ret["comment"] = "Node was successfully deleted."
343             ret["changes"]["old"] = existing["content"]
344             ret["changes"]["new"] = {}
345         else:
346             ret = _load_result(existing, ret)
347     elif existing["code"] == 404:
348         ret["result"] = True
349         ret["comment"] = "This node already does not exist. No changes made."
350         ret["changes"]["old"] = {}
351         ret["changes"]["new"] = {}
352     else:
353         ret = _load_result(existing, ret)
354     return ret
355 def list_pool(hostname, username, password, name):
356     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
357     if __opts__["test"]:
358         return _test_output(
359             ret,
360             "list",
361             params={
362                 "hostname": hostname,
363                 "username": username,
364                 "password": password,
365                 "name": name,
366             },
367 <a name="0"></a>        )
368     response = __salt__["bigip.list_pool"](hostname, username, password, name)
369     return _load_result(<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>response, ret)
370 def create_pool(
371     hostname,
372     username,
373     password,
374     name,
375     members=None,
376     allow_nat=None,
377     allow_snat=None,
378     description=None,
379     gateway_failsafe_device=None,
380     ignore_persisted_weight=None,
381     ip_tos_to_client=None,
382     ip_tos_to_server=None,
383     link_qos_to_client=None,
384     link_qos_to_server=None,
385     load_balancing_mode=None,
386     min_active_members=</b></font>None,
387     min_up_members=None,
388     min_up_members_action=None,
389     min_up_members_checking=None,
390     monitor=None,
391     profiles=None,
392     queue_depth_limit=None,
393     queue_on_connection_limit=None,
394     queue_time_limit=None,
395     reselect_tries=None,
396     service_down_action=None,
397     slow_ramp_time=None,
398 ):
399     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
400     if __opts__["test"]:
401         return _test_output(
402             ret,
403             "create",
404             params={
405                 "hostname": hostname,
406                 "username": username,
407                 "password": password,
408                 "name": name,
409                 "members": members,
410                 "allow_nat": allow_nat,
411                 "allow_snat": allow_snat,
412                 "description": description,
413                 "gateway_failsafe_device": gateway_failsafe_device,
414                 "ignore_persisted_weight": ignore_persisted_weight,
415                 "ip_tos_client:": ip_tos_to_client,
416                 "ip_tos_server": ip_tos_to_server,
417                 "link_qos_to_client": link_qos_to_client,
418                 "link_qos_to_server": link_qos_to_server,
419                 "load_balancing_mode": load_balancing_mode,
420                 "min_active_members": min_active_members,
421                 "min_up_members": min_up_members,
422                 "min_up_members_checking": min_up_members_checking,
423                 "monitor": monitor,
424                 "profiles": profiles,
425                 "queue_depth_limit": queue_depth_limit,
426                 "queue_on_connection_limit": queue_on_connection_limit,
427                 "queue_time_limit": queue_time_limit,
428                 "reselect_tries": reselect_tries,
429                 "service_down_action": service_down_action,
430                 "slow_ramp_time": slow_ramp_time,
431             },
432         )
433     existing = __salt__["bigip.list_pool"](hostname, username, password, name)
434     if existing["code"] == 200:
435         ret["result"] = True
436         ret["comment"] = "A pool by this name currently exists.  No change made."
437     elif existing["code"] == 404:
438         response = __salt__["bigip.create_pool"](
439             hostname=hostname,
440             username=username,
441             password=password,
442             name=name,
443             members=members,
444             allow_nat=allow_nat,
445             allow_snat=allow_snat,
446             description=description,
447             gateway_failsafe_device=gateway_failsafe_device,
448             ignore_persisted_weight=ignore_persisted_weight,
449             ip_tos_to_client=ip_tos_to_client,
450             ip_tos_to_server=ip_tos_to_server,
451             link_qos_to_client=link_qos_to_client,
452             link_qos_to_server=link_qos_to_server,
453             load_balancing_mode=load_balancing_mode,
454             min_active_members=min_active_members,
455             min_up_members=min_up_members,
456             min_up_members_action=min_up_members_action,
457             min_up_members_checking=min_up_members_checking,
458             monitor=monitor,
459             profiles=profiles,
460             queue_depth_limit=queue_depth_limit,
461             queue_on_connection_limit=queue_on_connection_limit,
462             queue_time_limit=queue_time_limit,
463             reselect_tries=reselect_tries,
464             service_down_action=service_down_action,
465             slow_ramp_time=slow_ramp_time,
466         )
467         if response["code"] == 200:
468             ret["result"] = True
469             ret["changes"]["old"] = {}
470             ret["changes"]["new"] = response["content"]
471             ret["comment"] = "Pool was successfully created."
472         else:
473             ret = _load_result(existing, ret)
474     else:
475         ret = _load_result(existing, ret)
476     return ret
477 def manage_pool(
478     hostname,
479     username,
480     password,
481     name,
482     allow_nat=None,
483     allow_snat=None,
484     description=None,
485     gateway_failsafe_device=None,
486     ignore_persisted_weight=None,
487     ip_tos_to_client=None,
488     ip_tos_to_server=None,
489     link_qos_to_client=None,
490     link_qos_to_server=None,
491     load_balancing_mode=None,
492     min_active_members=None,
493     min_up_members=None,
494     min_up_members_action=None,
495     min_up_members_checking=None,
496     monitor=None,
497     profiles=None,
498     queue_depth_limit=None,
499     queue_on_connection_limit=None,
500     queue_time_limit=None,
501     reselect_tries=None,
502     service_down_action=None,
503     slow_ramp_time=None,
504 ):
505     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
506     if __opts__["test"]:
507         return _test_output(
508             ret,
509             "manage",
510             params={
511                 "hostname": hostname,
512                 "username": username,
513                 "password": password,
514                 "name": name,
515                 "allow_nat": allow_nat,
516                 "allow_snat": allow_snat,
517                 "description": description,
518                 "gateway_failsafe_device": gateway_failsafe_device,
519                 "ignore_persisted_weight": ignore_persisted_weight,
520                 "ip_tos_client:": ip_tos_to_client,
521                 "ip_tos_server": ip_tos_to_server,
522                 "link_qos_to_client": link_qos_to_client,
523                 "link_qos_to_server": link_qos_to_server,
524                 "load_balancing_mode": load_balancing_mode,
525                 "min_active_members": min_active_members,
526                 "min_up_members": min_up_members,
527                 "min_up_members_checking": min_up_members_checking,
528                 "monitor": monitor,
529                 "profiles": profiles,
530                 "queue_depth_limit": queue_depth_limit,
531                 "queue_on_connection_limit": queue_on_connection_limit,
532                 "queue_time_limit": queue_time_limit,
533                 "reselect_tries": reselect_tries,
534                 "service_down_action": service_down_action,
535                 "slow_ramp_time": slow_ramp_time,
536             },
537         )
538     existing = __salt__["bigip.list_pool"](hostname, username, password, name)
539     if existing["code"] == 200:
540         modified = __salt__["bigip.modify_pool"](
541             hostname=hostname,
542             username=username,
543             password=password,
544             name=name,
545             allow_nat=allow_nat,
546             allow_snat=allow_snat,
547             description=description,
548             gateway_failsafe_device=gateway_failsafe_device,
549             ignore_persisted_weight=ignore_persisted_weight,
550             ip_tos_to_client=ip_tos_to_client,
551             ip_tos_to_server=ip_tos_to_server,
552             link_qos_to_client=link_qos_to_client,
553             link_qos_to_server=link_qos_to_server,
554             load_balancing_mode=load_balancing_mode,
555             min_active_members=min_active_members,
556             min_up_members=min_up_members,
557             min_up_members_action=min_up_members_action,
558             min_up_members_checking=min_up_members_checking,
559             monitor=monitor,
560             profiles=profiles,
561             queue_depth_limit=queue_depth_limit,
562             queue_on_connection_limit=queue_on_connection_limit,
563             queue_time_limit=queue_time_limit,
564             reselect_tries=reselect_tries,
565             service_down_action=service_down_action,
566             slow_ramp_time=slow_ramp_time,
567         )
568         if modified["code"] == 200:
569             del existing["content"]["membersReference"]
570             del modified["content"]["membersReference"]
571             del existing["content"]["selfLink"]
572             del modified["content"]["selfLink"]
573             ret = _check_for_changes("Pool", ret, existing, modified)
574         else:
575             ret = _load_result(modified, ret)
576     elif existing["code"] == 404:
577         new = __salt__["bigip.create_pool"](
578             hostname=hostname,
579             username=username,
580             password=password,
581             name=name,
582             allow_nat=allow_nat,
583             allow_snat=allow_snat,
584             description=description,
585             gateway_failsafe_device=gateway_failsafe_device,
586             ignore_persisted_weight=ignore_persisted_weight,
587             ip_tos_to_client=ip_tos_to_client,
588             ip_tos_to_server=ip_tos_to_server,
589             link_qos_to_client=link_qos_to_client,
590             link_qos_to_server=link_qos_to_server,
591             load_balancing_mode=load_balancing_mode,
592             min_active_members=min_active_members,
593             min_up_members=min_up_members,
594             min_up_members_action=min_up_members_action,
595             min_up_members_checking=min_up_members_checking,
596             monitor=monitor,
597             profiles=profiles,
598             queue_depth_limit=queue_depth_limit,
599             queue_on_connection_limit=queue_on_connection_limit,
600             queue_time_limit=queue_time_limit,
601             reselect_tries=reselect_tries,
602             service_down_action=service_down_action,
603             slow_ramp_time=slow_ramp_time,
604         )
605         if new["code"] == 200:
606             ret["result"] = True
607             ret["comment"] = (
608                 "Pool was created and enforced to the desired state.  Note: Only"
609                 " parameters specified were enforced.  See changes for details."
610             )
611             ret["changes"]["old"] = {}
612             ret["changes"]["new"] = new["content"]
613         else:
614             ret = _load_result(new, ret)
615     else:
616         ret = _load_result(existing, ret)
617     return ret
618 def modify_pool(
619     hostname,
620     username,
621     password,
622     name,
623     allow_nat=None,
624     allow_snat=None,
625     description=None,
626     gateway_failsafe_device=None,
627     ignore_persisted_weight=None,
628     ip_tos_to_client=None,
629     ip_tos_to_server=None,
630     link_qos_to_client=None,
631     link_qos_to_server=None,
632     load_balancing_mode=None,
633     min_active_members=None,
634     min_up_members=None,
635     min_up_members_action=None,
636     min_up_members_checking=None,
637     monitor=None,
638     profiles=None,
639     queue_depth_limit=None,
640     queue_on_connection_limit=None,
641     queue_time_limit=None,
642     reselect_tries=None,
643     service_down_action=None,
644     slow_ramp_time=None,
645 ):
646     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
647     if __opts__["test"]:
648         return _test_output(
649             ret,
650             "modify",
651             params={
652                 "hostname": hostname,
653                 "username": username,
654                 "password": password,
655                 "name": name,
656                 "allow_nat": allow_nat,
657                 "allow_snat": allow_snat,
658                 "description": description,
659                 "gateway_failsafe_device": gateway_failsafe_device,
660                 "ignore_persisted_weight": ignore_persisted_weight,
661                 "ip_tos_client:": ip_tos_to_client,
662                 "ip_tos_server": ip_tos_to_server,
663                 "link_qos_to_client": link_qos_to_client,
664                 "link_qos_to_server": link_qos_to_server,
665                 "load_balancing_mode": load_balancing_mode,
666                 "min_active_members": min_active_members,
667                 "min_up_members": min_up_members,
668                 "min_up_members_checking": min_up_members_checking,
669                 "monitor": monitor,
670                 "profiles": profiles,
671                 "queue_depth_limit": queue_depth_limit,
672                 "queue_on_connection_limit": queue_on_connection_limit,
673                 "queue_time_limit": queue_time_limit,
674                 "reselect_tries": reselect_tries,
675                 "service_down_action": service_down_action,
676                 "slow_ramp_time": slow_ramp_time,
677             },
678         )
679     existing = __salt__["bigip.list_pool"](hostname, username, password, name)
680     if existing["code"] == 200:
681         modified = __salt__["bigip.modify_pool"](
682             hostname=hostname,
683             username=username,
684             password=password,
685             name=name,
686             allow_nat=allow_nat,
687             allow_snat=allow_snat,
688             description=description,
689             gateway_failsafe_device=gateway_failsafe_device,
690             ignore_persisted_weight=ignore_persisted_weight,
691             ip_tos_to_client=ip_tos_to_client,
692             ip_tos_to_server=ip_tos_to_server,
693             link_qos_to_client=link_qos_to_client,
694             link_qos_to_server=link_qos_to_server,
695             load_balancing_mode=load_balancing_mode,
696             min_active_members=min_active_members,
697             min_up_members=min_up_members,
698             min_up_members_action=min_up_members_action,
699             min_up_members_checking=min_up_members_checking,
700             monitor=monitor,
701             profiles=profiles,
702             queue_depth_limit=queue_depth_limit,
703             queue_on_connection_limit=queue_on_connection_limit,
704             queue_time_limit=queue_time_limit,
705             reselect_tries=reselect_tries,
706             service_down_action=service_down_action,
707             slow_ramp_time=slow_ramp_time,
708         )
709         if modified["code"] == 200:
710             del existing["content"]["membersReference"]
711             del modified["content"]["membersReference"]
712             del existing["content"]["selfLink"]
713             del modified["content"]["selfLink"]
714             ret = _check_for_changes("Pool", ret, existing, modified)
715         else:
716             ret = _load_result(modified, ret)
717     elif existing["code"] == 404:
718         ret["comment"] = "A pool with this name was not found."
719     else:
720         ret = _load_result(existing, ret)
721     return ret
722 def delete_pool(hostname, username, password, name):
723     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
724     if __opts__["test"]:
725         return _test_output(
726             ret,
727             "delete",
728             params={
729                 "hostname": hostname,
730                 "username": username,
731                 "password": password,
732                 "name": name,
733             },
734         )
735     existing = __salt__["bigip.list_pool"](hostname, username, password, name)
736     if existing["code"] == 200:
737         deleted = __salt__["bigip.delete_pool"](hostname, username, password, name)
738         if deleted["code"] == 200:
739             ret["result"] = True
740             ret["comment"] = "Pool was successfully deleted."
741             ret["changes"]["old"] = existing["content"]
742             ret["changes"]["new"] = {}
743         else:
744             ret = _load_result(deleted, ret)
745     elif existing["code"] == 404:
746         ret["result"] = True
747         ret["comment"] = "This pool already does not exist. No changes made."
748         ret["changes"]["old"] = {}
749         ret["changes"]["new"] = {}
750     else:
751         ret = _load_result(existing, ret)
752     return ret
753 def manage_pool_members(hostname, username, password, name, members):
754     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
755     if __opts__["test"]:
756         return _test_output(
757             ret,
758             "manage",
759             params={
760                 "hostname": hostname,
761                 "username": username,
762                 "password": password,
763                 "name": name,
764                 "members": members,
765             },
766         )
767     existing = __salt__["bigip.list_pool"](hostname, username, password, name)
768     if existing["code"] == 200:
769         current_members = existing["content"]["membersReference"]["items"]
770         modified = __salt__["bigip.replace_pool_members"](
771             hostname, username, password, name, members
772         )
773         if modified["code"] == 200:
774             new_listing = __salt__["bigip.list_pool"](
775                 hostname, username, password, name
776             )
777             if new_listing["code"] != 200:
778                 ret = _load_result(new_listing, ret)
779                 ret["comment"] = (
780                     "modification of the pool was successful but an error occurred upon"
781                     " retrieving new listing."
782                 )
783                 return ret
784             new_members = new_listing["content"]["membersReference"]["items"]
785             for current_member in current_members:
786                 del current_member["generation"]
787             for new_member in new_members:
788                 del new_member["generation"]
789             ret = _check_for_changes(
790                 "Pool Membership", ret, current_members, new_members
791             )
792         else:
793             ret = _load_result(modified, ret)
794     elif existing["code"] == 404:
795         ret["comment"] = "A pool with this name was not found."
796     else:
797         ret = _load_result(existing, ret)
798     return ret
799 def add_pool_member(hostname, username, password, name, member):
800     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
801     if __opts__["test"]:
802         return _test_output(
803             ret,
804             "add",
805             params={
806                 "hostname": hostname,
807                 "username": username,
808                 "password": password,
809                 "name": name,
810                 "members": member,
811             },
812         )
813     existing_pool = __salt__["bigip.list_pool"](hostname, username, password, name)
814     if existing_pool["code"] == 200:
815         current_members = existing_pool["content"]["membersReference"]["items"]
816         exists = False
817         for current_member in current_members:
818             if current_member["name"] == member["name"]:
819                 exists = True
820                 break
821         if exists:
822             ret["result"] = True
823             ret[
824                 "comment"
825             ] = "Member: {name} already exists within this pool.  No changes made.".format(
826                 name=member["name"]
827             )
828             ret["changes"]["old"] = {}
829             ret["changes"]["new"] = {}
830         else:
831             new_member = __salt__["bigip.add_pool_member"](
832                 hostname, username, password, name, member
833             )
834             if new_member["code"] == 200:
835                 ret["result"] = True
836                 ret[
837                     "comment"
838                 ] = "Member: {name} has been successfully added to the pool.".format(
839                     name=member["name"]
840                 )
841                 ret["changes"]["old"] = {}
842                 pool_listing = __salt__["bigip.list_pool"](
843                     hostname, username, password, name
844                 )
845                 if pool_listing["code"] != 200:
846                     ret = _load_result(new_member, ret)
847                     return ret
848                 members = pool_listing["content"]["membersReference"]["items"]
849                 for current_member in members:
850                     if current_member["name"] == member["name"]:
851                         added_member = current_member
852                         break
853                 ret["changes"]["new"] = added_member
854             else:
855                 ret = _load_result(new_member, ret)
856     elif existing_pool["code"] == 404:
857         ret["comment"] = "A pool with this name was not found."
858     else:
859         ret = _load_result(existing_pool, ret)
860     return ret
861 def modify_pool_member(
862     hostname,
863     username,
864     password,
865     name,
866     member,
867     connection_limit=None,
868     description=None,
869     dynamic_ratio=None,
870     inherit_profile=None,
871     logging=None,
872     monitor=None,
873     priority_group=None,
874     profiles=None,
875     rate_limit=None,
876     ratio=None,
877     session=None,
878     member_state=None,
879 ):
880     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
881     if __opts__["test"]:
882         return _test_output(
883             ret,
884             "modify",
885             params={
886                 "hostname": hostname,
887                 "username": username,
888                 "password": password,
889                 "name": name,
890                 "members": member,
891             },
892         )
893     existing_pool = __salt__["bigip.list_pool"](hostname, username, password, name)
894     if existing_pool["code"] == 200:
895         current_members = existing_pool["content"]["membersReference"]["items"]
896         exists = False
897         for current_member in current_members:
898             if current_member["name"] == member:
899                 exists = True
900                 existing_member = current_member
901                 break
902         if exists:
903             modified = __salt__["bigip.modify_pool_member"](
904                 hostname=hostname,
905                 username=username,
906                 password=password,
907                 name=name,
908                 member=member,
909                 connection_limit=connection_limit,
910                 description=description,
911                 dynamic_ratio=dynamic_ratio,
912                 inherit_profile=inherit_profile,
913                 logging=logging,
914                 monitor=monitor,
915                 priority_group=priority_group,
916                 profiles=profiles,
917                 rate_limit=rate_limit,
918                 ratio=ratio,
919                 session=session,
920                 state=member_state,
921             )
922             new_pool = __salt__["bigip.list_pool"](hostname, username, password, name)
923             if modified["code"] == 200 and modified["code"] == 200:
924                 new_members = new_pool["content"]["membersReference"]["items"]
925                 for new_member in new_members:
926                     if new_member["name"] == member:
927                         modified_member = new_member
928                         break
929                 old = {"content": existing_member}
930                 new = {"content": modified_member}
931                 ret = _check_for_changes(
932                     "Pool Member: {member}".format(member=member), ret, old, new
933                 )
934             else:
935                 ret = _load_result(modified, ret)
936         else:
937             ret[
938                 "comment"
939             ] = "Member: {name} does not exists within this pool.  No changes made.".format(
940                 name=member["name"]
941             )
942     elif existing_pool["code"] == 404:
943         ret["comment"] = "A pool with this name was not found."
944     else:
945         ret = _load_result(existing_pool, ret)
946     return ret
947 def delete_pool_member(hostname, username, password, name, member):
948     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
949     if __opts__["test"]:
950         return _test_output(
951             ret,
952             "delete",
953             params={
954                 "hostname": hostname,
955                 "username": username,
956                 "password": password,
957                 "name": name,
958                 "members": member,
959             },
960         )
961     existing = __salt__["bigip.list_pool"](hostname, username, password, name)
962     if existing["code"] == 200:
963         current_members = existing["content"]["membersReference"]["items"]
964         exists = False
965         for current_member in current_members:
966             if current_member["name"] == member:
967                 exists = True
968                 existing_member = current_member
969                 break
970         if exists:
971             deleted = __salt__["bigip.delete_pool_member"](
972                 hostname, username, password, name, member
973             )
974             if deleted["code"] == 200:
975                 ret["result"] = True
976                 ret[
977                     "comment"
978                 ] = "Pool Member: {member} was successfully deleted.".format(
979                     member=member
980                 )
981                 ret["changes"]["old"] = existing_member
982                 ret["changes"]["new"] = {}
983         else:
984             ret["result"] = True
985             ret["comment"] = "This pool member already does not exist. No changes made."
986             ret["changes"]["old"] = {}
987             ret["changes"]["new"] = {}
988     else:
989         ret = _load_result(existing, ret)
990     return ret
991 def list_virtual(hostname, username, password, name):
992     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
993     if __opts__["test"]:
994         return _test_output(
995             ret,
996             "list",
997             params={
998                 "hostname": hostname,
999                 "username": username,
1000                 "password": password,
1001                 "name": name,
1002             },
1003         )
1004     response = __salt__["bigip.list_virtual"](hostname, username, password, name)
1005     return _load_result(response, ret)
1006 def create_virtual(
1007     hostname,
1008     username,
1009     password,
1010     name,
1011     destination,
1012     pool=None,
1013     address_status=None,
1014     auto_lasthop=None,
1015     bwc_policy=None,
1016     cmp_enabled=None,
1017     connection_limit=None,
1018     dhcp_relay=None,
1019     description=None,
1020     fallback_persistence=None,
1021     flow_eviction_policy=None,
1022     gtm_score=None,
1023     ip_forward=None,
1024     ip_protocol=None,
1025     internal=None,
1026     twelve_forward=None,
1027     last_hop_pool=None,
1028     mask=None,
1029     mirror=None,
1030     nat64=None,
1031     persist=None,
1032     profiles=None,
1033     policies=None,
1034     rate_class=None,
1035     rate_limit=None,
1036     rate_limit_mode=None,
1037     rate_limit_dst=None,
1038     rate_limit_src=None,
1039     rules=None,
1040     related_rules=None,
1041     reject=None,
1042     source=None,
1043     source_address_translation=None,
1044     source_port=None,
1045     virtual_state=None,
1046     traffic_classes=None,
1047     translate_address=None,
1048     translate_port=None,
1049     vlans=None,
1050 ):
1051     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1052     if __opts__["test"]:
1053         return _test_output(
1054             ret,
1055             "create",
1056             params={
1057                 "hostname": hostname,
1058                 "username": username,
1059                 "password": password,
1060                 "name": name,
1061                 "destination": destination,
1062                 "pool": pool,
1063                 "address_status": address_status,
1064                 "auto_lasthop": auto_lasthop,
1065                 "bwc_policy": bwc_policy,
1066                 "cmp_enabled": cmp_enabled,
1067                 "connection_limit": connection_limit,
1068                 "dhcp_relay": dhcp_relay,
1069                 "description": description,
1070                 "fallback_persistence": fallback_persistence,
1071                 "flow_eviction_policy": flow_eviction_policy,
1072                 "gtm_score": gtm_score,
1073                 "ip_forward": ip_forward,
1074                 "ip_protocol": ip_protocol,
1075                 "internal": internal,
1076                 "twelve_forward": twelve_forward,
1077                 "last_hop_pool": last_hop_pool,
1078                 "mask": mask,
1079                 "mirror": mirror,
1080                 "nat64": nat64,
1081                 "persist": persist,
1082                 "profiles": profiles,
1083                 "policies": policies,
1084                 "rate_class": rate_class,
1085                 "rate_limit": rate_limit,
1086                 "rate_limit_mode": rate_limit_mode,
1087                 "rate_limit_dst": rate_limit_dst,
1088                 "rate_limit_src": rate_limit_src,
1089                 "rules": rules,
1090                 "related_rules": related_rules,
1091                 "reject": reject,
1092                 "source": source,
1093                 "source_address_translation": source_address_translation,
1094                 "source_port": source_port,
1095                 "virtual_state": virtual_state,
1096                 "traffic_classes": traffic_classes,
1097                 "translate_address": translate_address,
1098                 "translate_port": translate_port,
1099                 "vlans": vlans,
1100             },
1101         )
1102     existing = __salt__["bigip.list_virtual"](hostname, username, password, name)
1103     if existing["code"] == 200:
1104         ret["result"] = True
1105         ret["comment"] = "A virtual by this name currently exists.  No change made."
1106     elif existing["code"] == 404:
1107         virtual = __salt__["bigip.create_virtual"](
1108             hostname=hostname,
1109             username=username,
1110             password=password,
1111             name=name,
1112             destination=destination,
1113             description=description,
1114             pool=pool,
1115             address_status=address_status,
1116             auto_lasthop=auto_lasthop,
1117             bwc_policy=bwc_policy,
1118             cmp_enabled=cmp_enabled,
1119             connection_limit=connection_limit,
1120             dhcp_relay=dhcp_relay,
1121             fallback_persistence=fallback_persistence,
1122             flow_eviction_policy=flow_eviction_policy,
1123             gtm_score=gtm_score,
1124             ip_forward=ip_forward,
1125             ip_protocol=ip_protocol,
1126             internal=internal,
1127             twelve_forward=twelve_forward,
1128             last_hop_pool=last_hop_pool,
1129             mask=mask,
1130             mirror=mirror,
1131             nat64=nat64,
1132             persist=persist,
1133             profiles=profiles,
1134             policies=policies,
1135             rate_class=rate_class,
1136             rate_limit=rate_limit,
1137             rate_limit_mode=rate_limit_mode,
1138             rate_limit_dst=rate_limit_dst,
1139             rate_limit_src=rate_limit_src,
1140             rules=rules,
1141             related_rules=related_rules,
1142             reject=reject,
1143             source=source,
1144             source_address_translation=source_address_translation,
1145             source_port=source_port,
1146             state=virtual_state,
1147             traffic_classes=traffic_classes,
1148             translate_address=translate_address,
1149             translate_port=translate_port,
1150             vlans=vlans,
1151         )
1152         if virtual["code"] == 200:
1153             ret["result"] = True
1154             ret["changes"]["old"] = {}
1155             ret["changes"]["new"] = virtual["content"]
1156             ret["comment"] = "Virtual was successfully created."
1157         else:
1158             ret = _load_result(existing, ret)
1159     else:
1160         ret = _load_result(existing, ret)
1161     return ret
1162 def manage_virtual(
1163     hostname,
1164     username,
1165     password,
1166     name,
1167     destination,
1168     pool=None,
1169     address_status=None,
1170     auto_lasthop=None,
1171     bwc_policy=None,
1172     cmp_enabled=None,
1173     connection_limit=None,
1174     dhcp_relay=None,
1175     description=None,
1176     fallback_persistence=None,
1177     flow_eviction_policy=None,
1178     gtm_score=None,
1179     ip_forward=None,
1180     ip_protocol=None,
1181     internal=None,
1182     twelve_forward=None,
1183     last_hop_pool=None,
1184     mask=None,
1185     mirror=None,
1186     nat64=None,
1187     persist=None,
1188     profiles=None,
1189     policies=None,
1190     rate_class=None,
1191     rate_limit=None,
1192     rate_limit_mode=None,
1193     rate_limit_dst=None,
1194     rate_limit_src=None,
1195     rules=None,
1196     related_rules=None,
1197     reject=None,
1198     source=None,
1199     source_address_translation=None,
1200     source_port=None,
1201     virtual_state=None,
1202     traffic_classes=None,
1203     translate_address=None,
1204     translate_port=None,
1205     vlans=None,
1206 ):
1207     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1208     if __opts__["test"]:
1209         return _test_output(
1210             ret,
1211             "manage",
1212             params={
1213                 "hostname": hostname,
1214                 "username": username,
1215                 "password": password,
1216                 "name": name,
1217                 "destination": destination,
1218                 "pool": pool,
1219                 "address_status": address_status,
1220                 "auto_lasthop": auto_lasthop,
1221                 "bwc_policy": bwc_policy,
1222                 "cmp_enabled": cmp_enabled,
1223                 "connection_limit": connection_limit,
1224                 "dhcp_relay": dhcp_relay,
1225                 "description": description,
1226                 "fallback_persistence": fallback_persistence,
1227                 "flow_eviction_policy": flow_eviction_policy,
1228                 "gtm_score": gtm_score,
1229                 "ip_forward": ip_forward,
1230                 "ip_protocol": ip_protocol,
1231                 "internal": internal,
1232                 "twelve_forward": twelve_forward,
1233                 "last_hop_pool": last_hop_pool,
1234                 "mask": mask,
1235                 "mirror": mirror,
1236                 "nat64": nat64,
1237                 "persist": persist,
1238                 "profiles": profiles,
1239                 "policies": policies,
1240                 "rate_class": rate_class,
1241                 "rate_limit": rate_limit,
1242                 "rate_limit_mode": rate_limit_mode,
1243                 "rate_limit_dst": rate_limit_dst,
1244                 "rate_limit_src": rate_limit_src,
1245                 "rules": rules,
1246                 "related_rules": related_rules,
1247                 "reject": reject,
1248                 "source": source,
1249                 "source_address_translation": source_address_translation,
1250                 "source_port": source_port,
1251                 "virtual_state": virtual_state,
1252                 "traffic_classes": traffic_classes,
1253                 "translate_address": translate_address,
1254                 "translate_port": translate_port,
1255                 "vlans": vlans,
1256             },
1257         )
1258     existing = __salt__["bigip.list_virtual"](hostname, username, password, name)
1259     if existing["code"] == 200:
1260         modified = __salt__["bigip.modify_virtual"](
1261             hostname=hostname,
1262             username=username,
1263             password=password,
1264             name=name,
1265             destination=destination,
1266             description=description,
1267             pool=pool,
1268             address_status=address_status,
1269             auto_lasthop=auto_lasthop,
1270             bwc_policy=bwc_policy,
1271             cmp_enabled=cmp_enabled,
1272             connection_limit=connection_limit,
1273             dhcp_relay=dhcp_relay,
1274             fallback_persistence=fallback_persistence,
1275             flow_eviction_policy=flow_eviction_policy,
1276             gtm_score=gtm_score,
1277             ip_forward=ip_forward,
1278             ip_protocol=ip_protocol,
1279             internal=internal,
1280             twelve_forward=twelve_forward,
1281             last_hop_pool=last_hop_pool,
1282             mask=mask,
1283             mirror=mirror,
1284             nat64=nat64,
1285             persist=persist,
1286             profiles=profiles,
1287             policies=policies,
1288             rate_class=rate_class,
1289             rate_limit=rate_limit,
1290             rate_limit_mode=rate_limit_mode,
1291             rate_limit_dst=rate_limit_dst,
1292             rate_limit_src=rate_limit_src,
1293             rules=rules,
1294             related_rules=related_rules,
1295             reject=reject,
1296             source=source,
1297             source_address_translation=source_address_translation,
1298             source_port=source_port,
1299             state=virtual_state,
1300             traffic_classes=traffic_classes,
1301             translate_address=translate_address,
1302             translate_port=translate_port,
1303             vlans=vlans,
1304         )
1305         if modified["code"] == 200:
1306             relisting = __salt__["bigip.list_virtual"](
1307                 hostname, username, password, name
1308             )
1309             if relisting["code"] == 200:
1310                 relisting = _strip_key(relisting, "generation")
1311                 existing = _strip_key(existing, "generation")
1312                 ret = _check_for_changes("Virtual", ret, existing, relisting)
1313             else:
1314                 ret = _load_result(relisting, ret)
1315         else:
1316             ret = _load_result(modified, ret)
1317     elif existing["code"] == 404:
1318         virtual = __salt__["bigip.create_virtual"](
1319             hostname=hostname,
1320             username=username,
1321             password=password,
1322             name=name,
1323             destination=destination,
1324             description=description,
1325             pool=pool,
1326             address_status=address_status,
1327             auto_lasthop=auto_lasthop,
1328             bwc_policy=bwc_policy,
1329             cmp_enabled=cmp_enabled,
1330             connection_limit=connection_limit,
1331             dhcp_relay=dhcp_relay,
1332             fallback_persistence=fallback_persistence,
1333             flow_eviction_policy=flow_eviction_policy,
1334             gtm_score=gtm_score,
1335             ip_forward=ip_forward,
1336             ip_protocol=ip_protocol,
1337             internal=internal,
1338             twelve_forward=twelve_forward,
1339             last_hop_pool=last_hop_pool,
1340             mask=mask,
1341             mirror=mirror,
1342             nat64=nat64,
1343             persist=persist,
1344             profiles=profiles,
1345             policies=policies,
1346             rate_class=rate_class,
1347             rate_limit=rate_limit,
1348             rate_limit_mode=rate_limit_mode,
1349             rate_limit_dst=rate_limit_dst,
1350             rate_limit_src=rate_limit_src,
1351             rules=rules,
1352             related_rules=related_rules,
1353             reject=reject,
1354             source=source,
1355             source_address_translation=source_address_translation,
1356             source_port=source_port,
1357             state=virtual_state,
1358             traffic_classes=traffic_classes,
1359             translate_address=translate_address,
1360             translate_port=translate_port,
1361             vlans=vlans,
1362         )
1363         if virtual["code"] == 200:
1364             ret["result"] = True
1365             ret["changes"]["old"] = {}
1366             ret["changes"]["new"] = virtual["content"]
1367             ret[
1368                 "comment"
1369             ] = "Virtual was successfully created and enforced to the desired state."
1370         else:
1371             ret = _load_result(virtual, ret)
1372     else:
1373         ret = _load_result(existing, ret)
1374     return ret
1375 def modify_virtual(
1376     hostname,
1377     username,
1378     password,
1379     name,
1380     destination,
1381     pool=None,
1382     address_status=None,
1383     auto_lasthop=None,
1384     bwc_policy=None,
1385     cmp_enabled=None,
1386     connection_limit=None,
1387     dhcp_relay=None,
1388     description=None,
1389     fallback_persistence=None,
1390     flow_eviction_policy=None,
1391     gtm_score=None,
1392     ip_forward=None,
1393     ip_protocol=None,
1394     internal=None,
1395     twelve_forward=None,
1396     last_hop_pool=None,
1397     mask=None,
1398     mirror=None,
1399     nat64=None,
1400     persist=None,
1401     profiles=None,
1402     policies=None,
1403     rate_class=None,
1404     rate_limit=None,
1405     rate_limit_mode=None,
1406     rate_limit_dst=None,
1407     rate_limit_src=None,
1408     rules=None,
1409     related_rules=None,
1410     reject=None,
1411     source=None,
1412     source_address_translation=None,
1413     source_port=None,
1414     virtual_state=None,
1415     traffic_classes=None,
1416     translate_address=None,
1417     translate_port=None,
1418     vlans=None,
1419 ):
1420     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1421     if __opts__["test"]:
1422         return _test_output(
1423             ret,
1424             "modify",
1425             params={
1426                 "hostname": hostname,
1427                 "username": username,
1428                 "password": password,
1429                 "name": name,
1430                 "destination": destination,
1431                 "pool": pool,
1432                 "address_status": address_status,
1433                 "auto_lasthop": auto_lasthop,
1434                 "bwc_policy": bwc_policy,
1435                 "cmp_enabled": cmp_enabled,
1436                 "connection_limit": connection_limit,
1437                 "dhcp_relay": dhcp_relay,
1438                 "description": description,
1439                 "fallback_persistence": fallback_persistence,
1440                 "flow_eviction_policy": flow_eviction_policy,
1441                 "gtm_score": gtm_score,
1442                 "ip_forward": ip_forward,
1443                 "ip_protocol": ip_protocol,
1444                 "internal": internal,
1445                 "twelve_forward": twelve_forward,
1446                 "last_hop_pool": last_hop_pool,
1447                 "mask": mask,
1448                 "mirror": mirror,
1449                 "nat64": nat64,
1450                 "persist": persist,
1451                 "profiles": profiles,
1452                 "policies": policies,
1453                 "rate_class": rate_class,
1454                 "rate_limit": rate_limit,
1455                 "rate_limit_mode": rate_limit_mode,
1456                 "rate_limit_dst": rate_limit_dst,
1457                 "rate_limit_src": rate_limit_src,
1458                 "rules": rules,
1459                 "related_rules": related_rules,
1460                 "reject": reject,
1461                 "source": source,
1462                 "source_address_translation": source_address_translation,
1463                 "source_port": source_port,
1464                 "virtual_state": virtual_state,
1465                 "traffic_classes": traffic_classes,
1466                 "translate_address": translate_address,
1467                 "translate_port": translate_port,
1468                 "vlans": vlans,
1469             },
1470         )
1471     existing = __salt__["bigip.list_virtual"](hostname, username, password, name)
1472     if existing["code"] == 200:
1473         modified = __salt__["bigip.modify_virtual"](
1474             hostname=hostname,
1475             username=username,
1476             password=password,
1477             name=name,
1478             destination=destination,
1479             description=description,
1480             pool=pool,
1481             address_status=address_status,
1482             auto_lasthop=auto_lasthop,
1483             bwc_policy=bwc_policy,
1484             cmp_enabled=cmp_enabled,
1485             connection_limit=connection_limit,
1486             dhcp_relay=dhcp_relay,
1487             fallback_persistence=fallback_persistence,
1488             flow_eviction_policy=flow_eviction_policy,
1489             gtm_score=gtm_score,
1490             ip_forward=ip_forward,
1491             ip_protocol=ip_protocol,
1492             internal=internal,
1493             twelve_forward=twelve_forward,
1494             last_hop_pool=last_hop_pool,
1495             mask=mask,
1496             mirror=mirror,
1497             nat64=nat64,
1498             persist=persist,
1499             profiles=profiles,
1500             policies=policies,
1501             rate_class=rate_class,
1502             rate_limit=rate_limit,
1503             rate_limit_mode=rate_limit_mode,
1504             rate_limit_dst=rate_limit_dst,
1505             rate_limit_src=rate_limit_src,
1506             rules=rules,
1507             related_rules=related_rules,
1508             reject=reject,
1509             source=source,
1510             source_address_translation=source_address_translation,
1511             source_port=source_port,
1512             state=virtual_state,
1513             traffic_classes=traffic_classes,
1514             translate_address=translate_address,
1515             translate_port=translate_port,
1516             vlans=vlans,
1517         )
1518         if modified["code"] == 200:
1519             relisting = __salt__["bigip.list_virtual"](
1520                 hostname, username, password, name
1521             )
1522             if relisting["code"] == 200:
1523                 relisting = _strip_key(relisting, "generation")
1524                 existing = _strip_key(existing, "generation")
1525                 ret = _check_for_changes("Virtual", ret, existing, relisting)
1526             else:
1527                 ret = _load_result(relisting, ret)
1528         else:
1529             ret = _load_result(modified, ret)
1530     elif existing["code"] == 404:
1531         ret["comment"] = "A Virtual with this name was not found."
1532     else:
1533         ret = _load_result(existing, ret)
1534     return ret
1535 def delete_virtual(hostname, username, password, name):
1536     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1537     if __opts__["test"]:
1538         return _test_output(
1539             ret,
1540             "delete",
1541             params={
1542                 "hostname": hostname,
1543                 "username": username,
1544                 "password": password,
1545                 "name": name,
1546             },
1547         )
1548     existing = __salt__["bigip.list_virtual"](hostname, username, password, name)
1549     if existing["code"] == 200:
1550         deleted = __salt__["bigip.delete_virtual"](hostname, username, password, name)
1551         if deleted["code"] == 200:
1552             ret["result"] = True
1553             ret["comment"] = "Virtual was successfully deleted."
1554             ret["changes"]["old"] = existing["content"]
1555             ret["changes"]["new"] = {}
1556         else:
1557             ret = _load_result(deleted, ret)
1558     elif existing["code"] == 404:
1559         ret["result"] = True
1560         ret["comment"] = "This virtual already does not exist. No changes made."
1561         ret["changes"]["old"] = {}
1562         ret["changes"]["new"] = {}
1563     else:
1564         ret = _load_result(existing, ret)
1565     return ret
1566 def list_monitor(hostname, username, password, monitor_type, name):
1567     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1568     if __opts__["test"]:
1569         return _test_output(
1570             ret,
1571             "list",
1572             params={
1573                 "hostname": hostname,
1574                 "username": username,
1575                 "password": password,
1576                 "monitor_type": monitor_type,
1577                 "name": name,
1578             },
1579         )
1580     response = __salt__["bigip.list_monitor"](
1581         hostname, username, password, monitor_type, name
1582     )
1583     return _load_result(response, ret)
1584 def create_monitor(hostname, username, password, monitor_type, name, **kwargs):
1585     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1586     if __opts__["test"]:
1587         params = {
1588             "hostname": hostname,
1589             "username": username,
1590             "password": password,
1591             "monitor_type": monitor_type,
1592             "name": name,
1593         }
1594         for key, value in kwargs.items():
1595             params[key] = value
1596         return _test_output(ret, "create", params)
1597     existing = __salt__["bigip.list_monitor"](
1598         hostname, username, password, monitor_type, name
1599     )
1600     if existing["code"] == 200:
1601         ret["result"] = True
1602         ret["comment"] = "A monitor by this name currently exists.  No change made."
1603     elif existing["code"] == 404:
1604         response = __salt__["bigip.create_monitor"](
1605             hostname, username, password, monitor_type, name, **kwargs
1606         )
1607         if response["code"] == 200:
1608             ret["result"] = True
1609             ret["changes"]["old"] = {}
1610             ret["changes"]["new"] = response["content"]
1611             ret["comment"] = "Monitor was successfully created."
1612         else:
1613             ret = _load_result(response, ret)
1614     else:
1615         ret = _load_result(existing, ret)
1616     return ret
1617 def manage_monitor(hostname, username, password, monitor_type, name, **kwargs):
1618     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1619     if __opts__["test"]:
1620         params = {
1621             "hostname": hostname,
1622             "username": username,
1623             "password": password,
1624             "monitor_type": monitor_type,
1625             "name": name,
1626         }
1627         for key, value in kwargs.items():
1628             params[key] = value
1629         return _test_output(ret, "manage", params)
1630     existing = __salt__["bigip.list_monitor"](
1631         hostname, username, password, monitor_type, name
1632     )
1633     if existing["code"] == 200:
1634         modified = __salt__["bigip.modify_monitor"](
1635             hostname, username, password, monitor_type, name, **kwargs
1636         )
1637         if modified["code"] == 200:
1638             del existing["content"]["selfLink"]
1639             del modified["content"]["selfLink"]
1640             ret = _check_for_changes("Monitor", ret, existing, modified)
1641         else:
1642             ret = _load_result(modified, ret)
1643     elif existing["code"] == 404:
1644         response = __salt__["bigip.create_monitor"](
1645             hostname, username, password, monitor_type, name, **kwargs
1646         )
1647         if response["code"] == 200:
1648             ret["result"] = True
1649             ret["changes"]["old"] = {}
1650             ret["changes"]["new"] = response["content"]
1651             ret["comment"] = "Monitor was successfully created."
1652         else:
1653             ret = _load_result(response, ret)
1654     else:
1655         ret = _load_result(existing, ret)
1656     return ret
1657 def modify_monitor(hostname, username, password, monitor_type, name, **kwargs):
1658     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1659     if __opts__["test"]:
1660         params = {
1661             "hostname": hostname,
1662             "username": username,
1663             "password": password,
1664             "monitor_type": monitor_type,
1665             "name": name,
1666         }
1667         for key, value in kwargs.items():
1668             params[key] = value
1669         return _test_output(ret, "modify", params)
1670     existing = __salt__["bigip.list_monitor"](
1671         hostname, username, password, monitor_type, name
1672     )
1673     if existing["code"] == 200:
1674         modified = __salt__["bigip.modify_monitor"](
1675             hostname, username, password, monitor_type, name, **kwargs
1676         )
1677         if modified["code"] == 200:
1678             del existing["content"]["selfLink"]
1679             del modified["content"]["selfLink"]
1680             ret = _check_for_changes("Monitor", ret, existing, modified)
1681         else:
1682             ret = _load_result(modified, ret)
1683     elif existing["code"] == 404:
1684         ret["comment"] = "A Monitor with this name was not found."
1685     else:
1686         ret = _load_result(existing, ret)
1687     return ret
1688 def delete_monitor(hostname, username, password, monitor_type, name):
1689     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1690     if __opts__["test"]:
1691         return _test_output(
1692             ret,
1693             "delete",
1694             params={
1695                 "hostname": hostname,
1696                 "username": username,
1697                 "password": password,
1698                 "monitor_type": monitor_type,
1699                 "name": name,
1700             },
1701         )
1702     existing = __salt__["bigip.list_monitor"](
1703         hostname, username, password, monitor_type, name
1704     )
1705     if existing["code"] == 200:
1706         deleted = __salt__["bigip.delete_monitor"](
1707             hostname, username, password, monitor_type, name
1708         )
1709         if deleted["code"] == 200:
1710             ret["result"] = True
1711             ret["comment"] = "Monitor was successfully deleted."
1712             ret["changes"]["old"] = existing["content"]
1713             ret["changes"]["new"] = {}
1714         else:
1715             ret = _load_result(deleted, ret)
1716     elif existing["code"] == 404:
1717         ret["result"] = True
1718         ret["comment"] = "This Monitor already does not exist. No changes made."
1719         ret["changes"]["old"] = {}
1720         ret["changes"]["new"] = {}
1721     else:
1722         ret = _load_result(existing, ret)
1723     return ret
1724 def list_profile(hostname, username, password, profile_type, name):
1725     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1726     if __opts__["test"]:
1727         return _test_output(
1728             ret,
1729             "list",
1730             params={
1731                 "hostname": hostname,
1732                 "username": username,
1733                 "password": password,
1734                 "profile_type": profile_type,
1735                 "name": name,
1736             },
1737         )
1738     response = __salt__["bigip.list_profile"](
1739         hostname, username, password, profile_type, name
1740     )
1741     return _load_result(response, ret)
1742 def create_profile(hostname, username, password, profile_type, name, **kwargs):
1743     r"""
1744     A function to connect to a bigip device and create a profile.
1745     hostname
1746         The host/address of the bigip device
1747     username
1748         The iControl REST username
1749     password
1750         The iControl REST password
1751     profile_type
1752         The type of profile to create
1753     name
1754         The name of the profile to create
1755     kwargs
1756         [ arg=val ] ...
1757         Consult F5 BIGIP user guide for specific options for each profile type.
1758         Typically, tmsh arg names are used.
1759     Special Characters ``|``, ``,`` and ``:`` must be escaped using ``\`` when
1760     used within strings.
1761     Create a new profile if a monitor of this type and name does not already exists.  If it does exists, only
1762     the parameters specified will be enforced.
1763     hostname
1764         The host/address of the bigip device
1765     username
1766         The iControl REST username
1767     password
1768         The iControl REST password
1769     profile_type
1770         The type of profile to create
1771     name
1772         The name of the profile to create
1773     kwargs
1774         [ arg=val ] ...
1775         Consult F5 BIGIP user guide for specific options for each profile type.
1776         Typically, tmsh arg names are used.
1777     Modify an existing profile.  If it does exists, only
1778     the parameters specified will be enforced.
1779     hostname
1780         The host/address of the bigip device
1781     username
1782         The iControl REST username
1783     password
1784         The iControl REST password
1785     profile_type
1786         The type of profile to create
1787     name
1788         The name of the profile to create
1789     kwargs
1790         [ arg=val ] ...
1791         Consult F5 BIGIP user guide for specific options for each monitor type.
1792         Typically, tmsh arg names are used.
1793     Modify an existing profile.  If it does exists, only
1794     the parameters specified will be enforced.
1795     hostname
1796         The host/address of the bigip device
1797     username
1798         The iControl REST username
1799     password
1800         The iControl REST password
1801     profile_type
1802         The type of profile to create
1803     name
1804         The name of the profile to create
1805     kwargs
1806         [ arg=val ] ...
1807         Consult F5 BIGIP user guide for specific options for each profile type.
1808         Typically, tmsh arg names are used.
1809     """
1810     ret = {"name": name, "changes": {}, "result": False, "comment": ""}
1811     if __opts__["test"]:
1812         return _test_output(
1813             ret,
1814             "delete",
1815             params={
1816                 "hostname": hostname,
1817                 "username": username,
1818                 "password": password,
1819                 "profile_type": profile_type,
1820                 "name": name,
1821             },
1822         )
1823     existing = __salt__["bigip.list_profile"](
1824         hostname, username, password, profile_type, name
1825     )
1826     if existing["code"] == 200:
1827         deleted = __salt__["bigip.delete_profile"](
1828             hostname, username, password, profile_type, name
1829         )
1830         if deleted["code"] == 200:
1831             ret["result"] = True
1832             ret["comment"] = "Profile was successfully deleted."
1833             ret["changes"]["old"] = existing["content"]
1834             ret["changes"]["new"] = {}
1835         else:
1836             ret = _load_result(deleted, ret)
1837     elif existing["code"] == 404:
1838         ret["result"] = True
1839         ret["comment"] = "This Profile already does not exist. No changes made."
1840         ret["changes"]["old"] = {}
1841         ret["changes"]["new"] = {}
1842     else:
1843         ret = _load_result(existing, ret)
1844     return ret
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
