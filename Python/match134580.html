<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for client.py &amp; version.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for client.py &amp; version.py
      </h3>
<h1 align="center">
        2.6%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>client.py (8.695652%)<th>version.py (1.5414258%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(45-67)<td><a href="#" name="0">(680-703)</a><td align="center"><font color="#ff0000">24</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>client.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import copy
2 import logging
3 import os
4 import random
5 import salt.client.ssh
6 import salt.config
7 import salt.syspaths
8 import salt.utils.args
9 from salt.exceptions import SaltClientError
10 log = logging.getLogger(__name__)
11 class SSHClient:
12     def __init__(
13         self,
14         c_path=os.path.join(salt.syspaths.CONFIG_DIR, "master"),
15         mopts=None,
16         disable_custom_roster=False,
17     ):
18         if mopts:
19             self.opts = mopts
20         else:
21             if os.path.isdir(c_path):
22                 log.warning(
23                     "%s expects a file path not a directory path(%s) to "
24                     "its 'c_path' keyword argument",
25                     self.__class__.__name__,
26                     c_path,
27                 )
28             self.opts = salt.config.client_config(c_path)
29         self.opts["__disable_custom_roster"] = disable_custom_roster
30     def sanitize_kwargs(self, kwargs):
31         roster_vals = [
32             <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>("host", str),
33             ("ssh_user", str),
34             ("ssh_passwd", str),
35             ("ssh_port", int),
36             ("ssh_sudo", bool),
37             ("ssh_sudo_user", str),
38             ("ssh_priv", str),
39             ("ssh_priv_passwd", str),
40             ("ssh_identities_only", bool),
41             ("ssh_remote_port_forwards", str),
42             ("ssh_options", list),
43             ("ssh_max_procs", int),
44             ("ssh_askpass", bool),
45             ("ssh_key_deploy", bool),
46             ("ssh_update_roster", bool),
47             ("ssh_scan_ports", str),
48             ("ssh_scan_timeout", int),
49             ("ssh_timeout", int),
50             ("ssh_log_file", str),
51             ("raw_shell", bool),
52             ("refresh_cache", bool),
53             ("roster", str),
54             ("roster_file"</b></font>, str),
55             ("rosters", list),
56             ("ignore_host_keys", bool),
57             ("raw_shell", bool),
58             ("extra_filerefs", str),
59             ("min_extra_mods", str),
60             ("thin_extra_mods", str),
61             ("verbose", bool),
62             ("static", bool),
63             ("ssh_wipe", bool),
64             ("rand_thin_dir", bool),
65             ("regen_thin", bool),
66             ("ssh_run_pre_flight", bool),
67             ("no_host_keys", bool),
68             ("saltfile", str),
69         ]
70         sane_kwargs = {}
71         for name, kind in roster_vals:
72             if name not in kwargs:
73                 continue
74             try:
75                 val = kind(kwargs[name])
76             except ValueError:
77                 log.warning("Unable to cast kwarg %s", name)
78                 continue
79             if kind is bool or kind is int:
80                 sane_kwargs[name] = val
81             elif kind is str:
82                 if val.find("ProxyCommand") != -1:
83                     log.warning("Filter unsafe value for kwarg %s", name)
84                     continue
85                 sane_kwargs[name] = val
86             elif kind is list:
87                 sane_val = []
88                 for item in val:
89                     if item.find("ProxyCommand") != -1:
90                         log.warning("Filter unsafe value for kwarg %s", name)
91                         continue
92                     sane_val.append(item)
93                 sane_kwargs[name] = sane_val
94         return sane_kwargs
95     def _prep_ssh(
96         self, tgt, fun, arg=(), timeout=None, tgt_type="glob", kwarg=None, **kwargs
97     ):
98         kwargs = self.sanitize_kwargs(kwargs)
99         opts = copy.deepcopy(self.opts)
100         opts.update(kwargs)
101         if timeout:
102             opts["timeout"] = timeout
103         arg = salt.utils.args.condition_input(arg, kwarg)
104         opts["argv"] = [fun] + arg
105         opts["selected_target_option"] = tgt_type
106         opts["tgt"] = tgt
107         opts["arg"] = arg
108         return salt.client.ssh.SSH(opts)
109     def cmd_iter(
110         self,
111         tgt,
112         fun,
113         arg=(),
114         timeout=None,
115         tgt_type="glob",
116         ret="",
117         kwarg=None,
118         **kwargs
119     ):
120         ssh = self._prep_ssh(tgt, fun, arg, timeout, tgt_type, kwarg, **kwargs)
121         yield from ssh.run_iter(jid=kwargs.get("jid", None))
122     def cmd(
123         self, tgt, fun, arg=(), timeout=None, tgt_type="glob", kwarg=None, **kwargs
124     ):
125         ssh = self._prep_ssh(tgt, fun, arg, timeout, tgt_type, kwarg, **kwargs)
126         final = {}
127         for ret in ssh.run_iter(jid=kwargs.get("jid", None)):
128             final.update(ret)
129         return final
130     def cmd_sync(self, low):
131         kwargs = copy.deepcopy(low)
132         for ignore in ["tgt", "fun", "arg", "timeout", "tgt_type", "kwarg"]:
133             if ignore in kwargs:
134                 del kwargs[ignore]
135         return self.cmd(
136             low["tgt"],
137             low["fun"],
138             low.get("arg", []),
139             low.get("timeout"),
140             low.get("tgt_type"),
141             low.get("kwarg"),
142             **kwargs
143         )
144     def cmd_async(self, low, timeout=None):
145         raise SaltClientError
146     def cmd_subset(
147         self,
148         tgt,
149         fun,
150         arg=(),
151         timeout=None,
152         tgt_type="glob",
153         ret="",
154         kwarg=None,
155         subset=3,
156         **kwargs
157     ):
158         minion_ret = self.cmd(tgt, "sys.list_functions", tgt_type=tgt_type, **kwargs)
159         minions = list(minion_ret)
160         random.shuffle(minions)
161         f_tgt = []
162         for minion in minions:
163             if fun in minion_ret[minion]["return"]:
164                 f_tgt.append(minion)
165             if len(f_tgt) &gt;= subset:
166                 break
167         return self.cmd_iter(
168             f_tgt, fun, arg, timeout, tgt_type="list", ret=ret, kwarg=kwarg, **kwargs
169         )
170     def destroy(self):
171     def __enter__(self):
172         return self
173     def __exit__(self, *args):
174         self.destroy()
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>version.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import operator
2 import platform
3 import re
4 import sys
5 from collections import namedtuple
6 from functools import total_ordering
7 MAX_SIZE = sys.maxsize
8 VERSION_LIMIT = MAX_SIZE - 200
9 @total_ordering
10 class SaltVersion(namedtuple("SaltVersion", "name, info, released")):
11     __slots__ = ()
12     def __new__(cls, name, info, released=False):
13         if isinstance(info, int):
14             info = (info,)
15         return super().__new__(cls, name, info, released)
16     def __eq__(self, other):
17         return self.info == other.info
18     def __gt__(self, other):
19         return self.info &gt; other.info
20 class SaltVersionsInfo(type):
21     _sorted_versions = ()
22     _current_release = None
23     _previous_release = None
24     _next_release = None
25     HYDROGEN      = SaltVersion("Hydrogen"     , info=(2014, 1),  released=True)
26     HELIUM        = SaltVersion("Helium"       , info=(2014, 7),  released=True)
27     LITHIUM       = SaltVersion("Lithium"      , info=(2015, 5),  released=True)
28     BERYLLIUM     = SaltVersion("Beryllium"    , info=(2015, 8),  released=True)
29     BORON         = SaltVersion("Boron"        , info=(2016, 3),  released=True)
30     CARBON        = SaltVersion("Carbon"       , info=(2016, 11), released=True)
31     NITROGEN      = SaltVersion("Nitrogen"     , info=(2017, 7),  released=True)
32     OXYGEN        = SaltVersion("Oxygen"       , info=(2018, 3),  released=True)
33     FLUORINE      = SaltVersion("Fluorine"     , info=(2019, 2),  released=True)
34     NEON          = SaltVersion("Neon"         , info=3000,       released=True)
35     SODIUM        = SaltVersion("Sodium"       , info=3001,       released=True)
36     MAGNESIUM     = SaltVersion("Magnesium"    , info=3002,       released=True)
37     ALUMINIUM     = SaltVersion("Aluminium"    , info=3003,       released=True)
38     SILICON       = SaltVersion("Silicon"      , info=3004,       released=True)
39     PHOSPHORUS    = SaltVersion("Phosphorus"   , info=3005)
40     SULFUR        = SaltVersion("Sulfur"       , info=3006)
41     CHLORINE      = SaltVersion("Chlorine"     , info=3007)
42     ARGON         = SaltVersion("Argon"        , info=3008)
43     POTASSIUM     = SaltVersion("Potassium"    , info=3009)
44     CALCIUM       = SaltVersion("Calcium"      , info=3010)
45     SCANDIUM      = SaltVersion("Scandium"     , info=3011)
46     TITANIUM      = SaltVersion("Titanium"     , info=3012)
47     VANADIUM      = SaltVersion("Vanadium"     , info=3013)
48     CHROMIUM      = SaltVersion("Chromium"     , info=3014)
49     MANGANESE     = SaltVersion("Manganese"    , info=3015)
50     IRON          = SaltVersion("Iron"         , info=3016)
51     COBALT        = SaltVersion("Cobalt"       , info=3017)
52     NICKEL        = SaltVersion("Nickel"       , info=3018)
53     COPPER        = SaltVersion("Copper"       , info=3019)
54     ZINC          = SaltVersion("Zinc"         , info=3020)
55     GALLIUM       = SaltVersion("Gallium"      , info=3021)
56     GERMANIUM     = SaltVersion("Germanium"    , info=3022)
57     ARSENIC       = SaltVersion("Arsenic"      , info=3023)
58     SELENIUM      = SaltVersion("Selenium"     , info=3024)
59     BROMINE       = SaltVersion("Bromine"      , info=3025)
60     KRYPTON       = SaltVersion("Krypton"      , info=3026)
61     RUBIDIUM      = SaltVersion("Rubidium"     , info=3027)
62     STRONTIUM     = SaltVersion("Strontium"    , info=3028)
63     YTTRIUM       = SaltVersion("Yttrium"      , info=3029)
64     ZIRCONIUM     = SaltVersion("Zirconium"    , info=3030)
65     NIOBIUM       = SaltVersion("Niobium"      , info=3031)
66     MOLYBDENUM    = SaltVersion("Molybdenum"   , info=3032)
67     TECHNETIUM    = SaltVersion("Technetium"   , info=3033)
68     RUTHENIUM     = SaltVersion("Ruthenium"    , info=3034)
69     RHODIUM       = SaltVersion("Rhodium"      , info=3035)
70     PALLADIUM     = SaltVersion("Palladium"    , info=3036)
71     SILVER        = SaltVersion("Silver"       , info=3037)
72     CADMIUM       = SaltVersion("Cadmium"      , info=3038)
73     INDIUM        = SaltVersion("Indium"       , info=3039)
74     TIN           = SaltVersion("Tin"          , info=3040)
75     ANTIMONY      = SaltVersion("Antimony"     , info=3041)
76     TELLURIUM     = SaltVersion("Tellurium"    , info=3042)
77     IODINE        = SaltVersion("Iodine"       , info=3043)
78     XENON         = SaltVersion("Xenon"        , info=3044)
79     CESIUM        = SaltVersion("Cesium"       , info=3045)
80     BARIUM        = SaltVersion("Barium"       , info=3046)
81     LANTHANUM     = SaltVersion("Lanthanum"    , info=3047)
82     CERIUM        = SaltVersion("Cerium"       , info=3048)
83     PRASEODYMIUM  = SaltVersion("Praseodymium" , info=3049)
84     NEODYMIUM     = SaltVersion("Neodymium"    , info=3050)
85     PROMETHIUM    = SaltVersion("Promethium"   , info=3051)
86     SAMARIUM      = SaltVersion("Samarium"     , info=3052)
87     EUROPIUM      = SaltVersion("Europium"     , info=3053)
88     GADOLINIUM    = SaltVersion("Gadolinium"   , info=3054)
89     TERBIUM       = SaltVersion("Terbium"      , info=3055)
90     DYSPROSIUM    = SaltVersion("Dysprosium"   , info=3056)
91     HOLMIUM       = SaltVersion("Holmium"      , info=3057)
92     ERBIUM        = SaltVersion("Erbium"       , info=3058)
93     THULIUM       = SaltVersion("Thulium"      , info=3059)
94     YTTERBIUM     = SaltVersion("Ytterbium"    , info=3060)
95     LUTETIUM      = SaltVersion("Lutetium"     , info=3061)
96     HAFNIUM       = SaltVersion("Hafnium"      , info=3062)
97     TANTALUM      = SaltVersion("Tantalum"     , info=3063)
98     TUNGSTEN      = SaltVersion("Tungsten"     , info=3064)
99     RHENIUM       = SaltVersion("Rhenium"      , info=3065)
100     OSMIUM        = SaltVersion("Osmium"       , info=3066)
101     IRIDIUM       = SaltVersion("Iridium"      , info=3067)
102     PLATINUM      = SaltVersion("Platinum"     , info=3068)
103     GOLD          = SaltVersion("Gold"         , info=3069)
104     MERCURY       = SaltVersion("Mercury"      , info=3070)
105     THALLIUM      = SaltVersion("Thallium"     , info=3071)
106     LEAD          = SaltVersion("Lead"         , info=3072)
107     BISMUTH       = SaltVersion("Bismuth"      , info=3073)
108     POLONIUM      = SaltVersion("Polonium"     , info=3074)
109     ASTATINE      = SaltVersion("Astatine"     , info=3075)
110     RADON         = SaltVersion("Radon"        , info=3076)
111     FRANCIUM      = SaltVersion("Francium"     , info=3077)
112     RADIUM        = SaltVersion("Radium"       , info=3078)
113     ACTINIUM      = SaltVersion("Actinium"     , info=3079)
114     THORIUM       = SaltVersion("Thorium"      , info=3080)
115     PROTACTINIUM  = SaltVersion("Protactinium" , info=3081)
116     URANIUM       = SaltVersion("Uranium"      , info=3082)
117     NEPTUNIUM     = SaltVersion("Neptunium"    , info=3083)
118     PLUTONIUM     = SaltVersion("Plutonium"    , info=3084)
119     AMERICIUM     = SaltVersion("Americium"    , info=3085)
120     CURIUM        = SaltVersion("Curium"       , info=3086)
121     BERKELIUM     = SaltVersion("Berkelium"    , info=3087)
122     CALIFORNIUM   = SaltVersion("Californium"  , info=3088)
123     EINSTEINIUM   = SaltVersion("Einsteinium"  , info=3089)
124     FERMIUM       = SaltVersion("Fermium"      , info=3090)
125     MENDELEVIUM   = SaltVersion("Mendelevium"  , info=3091)
126     NOBELIUM      = SaltVersion("Nobelium"     , info=3092)
127     LAWRENCIUM    = SaltVersion("Lawrencium"   , info=3093)
128     RUTHERFORDIUM = SaltVersion("Rutherfordium", info=3094)
129     DUBNIUM       = SaltVersion("Dubnium"      , info=3095)
130     SEABORGIUM    = SaltVersion("Seaborgium"   , info=3096)
131     BOHRIUM       = SaltVersion("Bohrium"      , info=3097)
132     HASSIUM       = SaltVersion("Hassium"      , info=3098)
133     MEITNERIUM    = SaltVersion("Meitnerium"   , info=3099)
134     DARMSTADTIUM  = SaltVersion("Darmstadtium" , info=3100)
135     ROENTGENIUM   = SaltVersion("Roentgenium"  , info=3101)
136     COPERNICIUM   = SaltVersion("Copernicium"  , info=3102)
137     NIHONIUM      = SaltVersion("Nihonium"     , info=3103)
138     FLEROVIUM     = SaltVersion("Flerovium"    , info=3104)
139     MOSCOVIUM     = SaltVersion("Moscovium"    , info=3105)
140     LIVERMORIUM   = SaltVersion("Livermorium"  , info=3106)
141     TENNESSINE    = SaltVersion("Tennessine"   , info=3107)
142     OGANESSON     = SaltVersion("Oganesson"    , info=3108)
143     @classmethod
144     def versions(cls):
145         if not cls._sorted_versions:
146             cls._sorted_versions = sorted(
147                 (getattr(cls, name) for name in dir(cls) if name.isupper()),
148                 key=operator.attrgetter("info"),
149             )
150         return cls._sorted_versions
151     @classmethod
152     def current_release(cls):
153         if cls._current_release is None:
154             for version in cls.versions():
155                 if version.released is False:
156                     cls._current_release = version
157                     break
158         return cls._current_release
159     @classmethod
160     def next_release(cls):
161         if cls._next_release is None:
162             next_release_ahead = False
163             for version in cls.versions():
164                 if next_release_ahead:
165                     cls._next_release = version
166                     break
167                 if version == cls.current_release():
168                     next_release_ahead = True
169         return cls._next_release
170     @classmethod
171     def previous_release(cls):
172         if cls._previous_release is None:
173             previous = None
174             for version in cls.versions():
175                 if version == cls.current_release():
176                     break
177                 previous = version
178             cls._previous_release = previous
179         return cls._previous_release
180 class SaltStackVersion:
181     __slots__ = (
182         "name",
183         "major",
184         "minor",
185         "bugfix",
186         "mbugfix",
187         "pre_type",
188         "pre_num",
189         "noc",
190         "sha",
191     )
192     git_sha_regex = r"(?P&lt;sha&gt;g?[a-f0-9]{7,40})"
193     git_describe_regex = re.compile(
194         r"(?:[^\d]+)?(?P&lt;major&gt;[\d]{1,4})"
195         r"(?:\.(?P&lt;minor&gt;[\d]{1,2}))?"
196         r"(?:\.(?P&lt;bugfix&gt;[\d]{0,2}))?"
197         r"(?:\.(?P&lt;mbugfix&gt;[\d]{0,2}))?"
198         r"(?:(?P&lt;pre_type&gt;rc|a|b|alpha|beta|nb)(?P&lt;pre_num&gt;[\d]+))?"
199         r"(?:(?:.*)(?:\+|-)(?P&lt;noc&gt;(?:0na|[\d]+|n/a))(?:-|\.)" + git_sha_regex + r")?"
200     )
201     git_sha_regex = r"^" + git_sha_regex
202     git_sha_regex = re.compile(git_sha_regex)
203     NAMES = {v.name: v.info for v in SaltVersionsInfo.versions()}
204     LNAMES = {k.lower(): v for (k, v) in iter(NAMES.items())}
205     VNAMES = {v: k for (k, v) in iter(NAMES.items())}
206     RMATCH = {v[:2]: k for (k, v) in iter(NAMES.items())}
207     def __init__(
208         self,  # pylint: disable=C0103
209         major,
210         minor=None,
211         bugfix=None,
212         mbugfix=0,
213         pre_type=None,
214         pre_num=None,
215         noc=0,
216         sha=None,
217     ):
218         if isinstance(major, str):
219             major = int(major)
220         if isinstance(minor, str):
221             if not minor:
222                 minor = None
223             else:
224                 minor = int(minor)
225         if bugfix is None and not self.new_version(major=major):
226             bugfix = 0
227         elif isinstance(bugfix, str):
228             if not bugfix:
229                 bugfix = None
230             else:
231                 bugfix = int(bugfix)
232         if mbugfix is None:
233             mbugfix = 0
234         elif isinstance(mbugfix, str):
235             mbugfix = int(mbugfix)
236         if pre_type is None:
237             pre_type = ""
238         if pre_num is None:
239             pre_num = 0
240         elif isinstance(pre_num, str):
241             pre_num = int(pre_num)
242         if noc is None:
243             noc = 0
244         elif isinstance(noc, str) and noc in ("0na", "n/a"):
245             noc = -1
246         elif isinstance(noc, str):
247             noc = int(noc)
248         self.major = major
249         self.minor = minor
250         self.bugfix = bugfix
251         self.mbugfix = mbugfix
252         self.pre_type = pre_type
253         self.pre_num = pre_num
254         if self.new_version(major):
255             vnames_key = (major,)
256         else:
257             vnames_key = (major, minor)
258         self.name = self.VNAMES.get(vnames_key)
259         self.noc = noc
260         self.sha = sha
261     def new_version(self, major):
262         return bool(int(major) &gt;= 3000 and int(major) &lt; VERSION_LIMIT)
263     @classmethod
264     def parse(cls, version_string):
265         if version_string.lower() in cls.LNAMES:
266             return cls.from_name(version_string)
267         vstr = (
268             version_string.decode()
269             if isinstance(version_string, bytes)
270             else version_string
271         )
272         match = cls.git_describe_regex.match(vstr)
273         if not match:
274             raise ValueError(
275                 "Unable to parse version string: '{}'".format(version_string)
276             )
277         return cls(*match.groups())
278     @classmethod
279     def from_name(cls, name):
280         if name.lower() not in cls.LNAMES:
281             raise ValueError("Named version '{}' is not known".format(name))
282         return cls(*cls.LNAMES[name.lower()])
283     @classmethod
284     def from_last_named_version(cls):
285         import salt.utils.versions
286         salt.utils.versions.warn_until(
287             SaltVersionsInfo.SULFUR,
288             "The use of SaltStackVersion.from_last_named_version() is "
289             "deprecated and set to be removed in {version}. Please use "
290             "SaltStackVersion.current_release() instead.",
291         )
292         return cls.current_release()
293     @classmethod
294     def current_release(cls):
295         return cls(*SaltVersionsInfo.current_release().info)
296     @classmethod
297     def next_release(cls):
298         return cls(*SaltVersionsInfo.next_release().info)
299     @property
300     def sse(self):
301         return 0 &lt; self.major &lt; 2014
302     def min_info(self):
303         info = [self.major]
304         if self.new_version(self.major):
305             if self.minor:
306                 info.append(self.minor)
307         else:
308             info.extend([self.minor, self.bugfix, self.mbugfix])
309         return info
310     @property
311     def info(self):
312         return tuple(self.min_info())
313     @property
314     def pre_info(self):
315         info = self.min_info()
316         info.extend([self.pre_type, self.pre_num])
317         return tuple(info)
318     @property
319     def noc_info(self):
320         info = self.min_info()
321         info.extend([self.pre_type, self.pre_num, self.noc])
322         return tuple(info)
323     @property
324     def full_info(self):
325         info = self.min_info()
326         info.extend([self.pre_type, self.pre_num, self.noc, self.sha])
327         return tuple(info)
328     @property
329     def full_info_all_versions(self):
330         info = [
331             self.major,
332             self.minor,
333             self.bugfix,
334             self.mbugfix,
335             self.pre_type,
336             self.pre_num,
337             self.noc,
338             self.sha,
339         ]
340         return tuple(info)
341     @property
342     def string(self):
343         if self.new_version(self.major):
344             version_string = "{}".format(self.major)
345             if self.minor:
346                 version_string = "{}.{}".format(self.major, self.minor)
347         else:
348             version_string = "{}.{}.{}".format(self.major, self.minor, self.bugfix)
349         if self.mbugfix:
350             version_string += ".{}".format(self.mbugfix)
351         if self.pre_type:
352             version_string += "{}{}".format(self.pre_type, self.pre_num)
353         if self.noc and self.sha:
354             noc = self.noc
355             if noc &lt; 0:
356                 noc = "0na"
357             version_string += "+{}.{}".format(noc, self.sha)
358         return version_string
359     @property
360     def formatted_version(self):
361         if self.name and self.major &gt; 10000:
362             version_string = self.name
363             if self.sse:
364                 version_string += " Enterprise"
365             version_string += " (Unreleased)"
366             return version_string
367         version_string = self.string
368         if self.sse:
369             version_string += " Enterprise"
370         if (self.major, self.minor) in self.RMATCH:
371             version_string += " ({})".format(self.RMATCH[(self.major, self.minor)])
372         return version_string
373     @property
374     def pre_index(self):
375         if self.new_version(self.major):
376             pre_type = 2
377             if not isinstance(self.minor, int):
378                 pre_type = 1
379         else:
380             pre_type = 4
381         return pre_type
382     def __str__(self):
383         return self.string
384     def __compare__(self, other, method):
385         if not isinstance(other, SaltStackVersion):
386             if isinstance(other, str):
387                 other = SaltStackVersion.parse(other)
388             elif isinstance(other, (list, tuple)):
389                 other = SaltStackVersion(*other)
390             else:
391                 raise ValueError(
392                     "Cannot instantiate Version from type '{}'".format(type(other))
393                 )
394         pre_type = self.pre_index
395         other_pre_type = other.pre_index
396         other_noc_info = list(other.noc_info)
397         noc_info = list(self.noc_info)
398         if self.new_version(self.major):
399             if self.minor and not other.minor:
400                 if self.minor &gt; 0:
401                     other_noc_info[1] = 0
402             if not self.minor and other.minor:
403                 if other.minor &gt; 0:
404                     noc_info[1] = 0
405         if self.pre_type and not other.pre_type:
406             other_noc_info[other_pre_type] = "zzzzz"
407         if not self.pre_type and other.pre_type:
408             noc_info[pre_type] = "zzzzz"
409         return method(tuple(noc_info), tuple(other_noc_info))
410     def __lt__(self, other):
411         return self.__compare__(other, lambda _self, _other: _self &lt; _other)
412     def __le__(self, other):
413         return self.__compare__(other, lambda _self, _other: _self &lt;= _other)
414     def __eq__(self, other):
415         return self.__compare__(other, lambda _self, _other: _self == _other)
416     def __ne__(self, other):
417         return self.__compare__(other, lambda _self, _other: _self != _other)
418     def __ge__(self, other):
419         return self.__compare__(other, lambda _self, _other: _self &gt;= _other)
420     def __gt__(self, other):
421         return self.__compare__(other, lambda _self, _other: _self &gt; _other)
422     def __repr__(self):
423         parts = []
424         if self.name:
425             parts.append("name='{}'".format(self.name))
426         parts.extend(["major={}".format(self.major), "minor={}".format(self.minor)])
427         if self.new_version(self.major):
428             if not self.minor:
429                 parts.remove("".join([x for x in parts if re.search("^minor*", x)]))
430         else:
431             parts.extend(["bugfix={}".format(self.bugfix)])
432         if self.mbugfix:
433             parts.append("minor-bugfix={}".format(self.mbugfix))
434         if self.pre_type:
435             parts.append("{}={}".format(self.pre_type, self.pre_num))
436         noc = self.noc
437         if noc == -1:
438             noc = "0na"
439         if noc and self.sha:
440             parts.extend(["noc={}".format(noc), "sha={}".format(self.sha)])
441         return "&lt;{} {}&gt;".format(self.__class__.__name__, " ".join(parts))
442 __saltstack_version__ = SaltStackVersion.current_release()
443 def __discover_version(saltstack_version):
444     import os
445     import subprocess
446     if "SETUP_DIRNAME" in globals():
447         cwd = SETUP_DIRNAME  # pylint: disable=E0602
448         if not os.path.exists(os.path.join(cwd, ".git")):
449             return saltstack_version
450     else:
451         cwd = os.path.abspath(os.path.dirname(__file__))
452         if not os.path.exists(os.path.join(os.path.dirname(cwd), ".git")):
453             return saltstack_version
454     try:
455         kwargs = dict(stdout=subprocess.PIPE, stderr=subprocess.PIPE, cwd=cwd)
456         if not sys.platform.startswith("win"):
457             kwargs["close_fds"] = True
458         process = subprocess.Popen(
459             [
460                 "git",
461                 "describe",
462                 "--tags",
463                 "--long",
464                 "--match",
465                 "v[0-9]*",
466                 "--always",
467             ],
468             **kwargs
469         )
470         out, err = process.communicate()
471         out = out.decode().strip()
472         err = err.decode().strip()
473         if not out or err:
474             return saltstack_version
475         if SaltStackVersion.git_sha_regex.match(out):
476             saltstack_version.sha = out.strip()
477             saltstack_version.noc = -1
478             return saltstack_version
479         return SaltStackVersion.parse(out)
480     except OSError as os_err:
481         if os_err.errno != 2:
482             raise
483     return saltstack_version
484 def __get_version(saltstack_version):
485     try:
486         from salt._version import __saltstack_version__  # pylint: disable=E0611,F0401
487         return __saltstack_version__
488     except ImportError:
489         return __discover_version(saltstack_version)
490 __saltstack_version__ = __get_version(__saltstack_version__)
491 if __saltstack_version__.name:
492     SaltVersionsInfo._current_release = getattr(
493         SaltVersionsInfo, __saltstack_version__.name.upper()
494     )
495 del __get_version
496 __version_info__ = __saltstack_version__.info
497 __version__ = __saltstack_version__.string
498 def salt_information():
499     yield "Salt", __version__
500 def dependency_information(include_salt_cloud=False):
501     """
502         (<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>"Jinja2", "jinja2", "__version__"),
503         ("M2Crypto", "M2Crypto", "version"),
504         ("msgpack", "msgpack", "version"),
505         ("msgpack-pure", "msgpack_pure", "version"),
506         ("pycrypto", "Crypto", "__version__"),
507         ("pycryptodome", "Cryptodome", "version_info"),
508         ("PyYAML", "yaml", "__version__"),
509         ("PyZMQ", "zmq", "__version__"),
510         ("ZMQ", "zmq", "zmq_version"),
511         ("Mako", "mako", "__version__"),
512         ("Tornado", "tornado", "version"),
513         ("timelib", "timelib", "version"),
514         ("dateutil", "dateutil", "__version__"),
515         ("pygit2", "pygit2", "__version__"),
516         ("libgit2", "pygit2", "LIBGIT2_VERSION"),
517         ("smmap", "smmap", "__version__"),
518         ("cffi", "cffi", "__version__"),
519         ("pycparser", "pycparser", "__version__"),
520         ("gitdb", "gitdb", "__version__"),
521         ("gitpython", "git", "__version__"),
522         ("python-gnupg", "gnupg", "__version__"),
523         ("mysql-python", "MySQLdb", "__version__"),
524         ("cherrypy", "cherrypy", "__version__"),
525         ("docker-py"</b></font>, "docker", "__version__"),
526     ]
527     if include_salt_cloud:
528         libs.append(
529             ("Apache Libcloud", "libcloud", "__version__"),
530         )
531     for name, imp, attr in libs:
532         if imp is None:
533             yield name, attr
534             continue
535         try:
536             imp = __import__(imp)
537             version = getattr(imp, attr)
538             if callable(version):
539                 version = version()
540             if isinstance(version, (tuple, list)):
541                 version = ".".join(map(str, version))
542             yield name, version
543         except Exception:  # pylint: disable=broad-except
544             yield name, None
545 def system_information():
546     """
547     Report system versions.
548     """
549     from distro import linux_distribution
550     def system_version():
551         """
552         Return host system version.
553         """
554         lin_ver = linux_distribution()
555         mac_ver = platform.mac_ver()
556         win_ver = platform.win32_ver()
557         if mac_ver[0]:
558             if isinstance(mac_ver[1], (tuple, list)) and "".join(mac_ver[1]):
559                 return " ".join([mac_ver[0], ".".join(mac_ver[1]), mac_ver[2]])
560             else:
561                 return " ".join([mac_ver[0], mac_ver[2]])
562         elif win_ver[0]:
563             return " ".join(win_ver)
564         elif lin_ver[0]:
565             return " ".join(lin_ver)
566         else:
567             return ""
568     if platform.win32_ver()[0]:
569         import win32api  # pylint: disable=3rd-party-module-not-gated
570         import win32con  # pylint: disable=3rd-party-module-not-gated
571         hkey = win32con.HKEY_LOCAL_MACHINE
572         key = "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion"
573         value_name = "ProductName"
574         reg_handle = win32api.RegOpenKey(hkey, key)
575         product_name, _ = win32api.RegQueryValueEx(reg_handle, value_name)
576         version = "Unknown"
577         release = ""
578         if "Server" in product_name:
579             for item in product_name.split(" "):
580                 if re.match(r"\d+", item):
581                     version = item
582                 if re.match(r"^R\d+$", item):
583                     release = item
584             release = "{}Server{}".format(version, release)
585         else:
586             for item in product_name.split(" "):
587                 if re.match(r"^(\d+(\.\d+)?)|Thin|Vista$", item):
588                     version = item
589             release = version
590         _, ver, service_pack, extra = platform.win32_ver()
591         version = " ".join([release, ver, service_pack, extra])
592     else:
593         version = system_version()
594         release = platform.release()
595     system = [
596         ("system", platform.system()),
597         ("dist", " ".join(linux_distribution(full_distribution_name=False))),
598         ("release", release),
599         ("machine", platform.machine()),
600         ("version", version),
601         ("locale", __salt_system_encoding__),
602     ]
603     for name, attr in system:
604         yield name, attr
605         continue
606 def extensions_information():
607     """
608     Gather infomation about any installed salt extensions
609     """
610     import salt.utils.entrypoints
611     extensions = {}
612     for entry_point in salt.utils.entrypoints.iter_entry_points("salt.loader"):
613         dist_nv = salt.utils.entrypoints.name_and_version_from_entry_point(entry_point)
614         if not dist_nv:
615             continue
616         if dist_nv.name in extensions:
617             continue
618         extensions[dist_nv.name] = dist_nv.version
619     return extensions
620 def versions_information(include_salt_cloud=False, include_extensions=True):
621     """
622     Report the versions of dependent software.
623     """
624     salt_info = list(salt_information())
625     lib_info = list(dependency_information(include_salt_cloud))
626     sys_info = list(system_information())
627     info = {
628         "Salt Version": dict(salt_info),
629         "Dependency Versions": dict(lib_info),
630         "System Versions": dict(sys_info),
631     }
632     if include_extensions:
633         extensions_info = extensions_information()
634         if extensions_info:
635             info["Salt Extensions"] = extensions_info
636     return info
637 def versions_report(include_salt_cloud=False, include_extensions=True):
638     """
639     Yield each version properly formatted for console output.
640     """
641     ver_info = versions_information(
642         include_salt_cloud=include_salt_cloud, include_extensions=include_extensions
643     )
644     not_installed = "Not Installed"
645     ns_pad = len(not_installed)
646     lib_pad = max(len(name) for name in ver_info["Dependency Versions"])
647     sys_pad = max(len(name) for name in ver_info["System Versions"])
648     if include_extensions and "Salt Extensions" in ver_info:
649         ext_pad = max(len(name) for name in ver_info["Salt Extensions"])
650     else:
651         ext_pad = 1
652     padding = max(lib_pad, sys_pad, ns_pad, ext_pad) + 1
653     fmt = "{0:&gt;{pad}}: {1}"
654     info = []
655     for ver_type in (
656         "Salt Version",
657         "Dependency Versions",
658         "Salt Extensions",
659         "System Versions",
660     ):
661         if ver_type == "Salt Extensions" and ver_type not in ver_info:
662             continue
663         info.append("{}:".format(ver_type))
664         for name in sorted(ver_info[ver_type], key=lambda x: x.lower()):
665             ver = fmt.format(
666                 name, ver_info[ver_type][name] or not_installed, pad=padding
667             )
668             info.append(ver)
669         info.append(" ")
670     yield from info
671 if __name__ == "__main__":
672     print(__version__)
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
