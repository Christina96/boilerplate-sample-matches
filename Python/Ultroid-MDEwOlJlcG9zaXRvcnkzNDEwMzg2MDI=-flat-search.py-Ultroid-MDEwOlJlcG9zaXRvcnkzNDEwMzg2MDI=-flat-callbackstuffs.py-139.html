
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 13, <button onclick='openModal()' class='match'>CODE CLONE</button></h2>
        <div class="column">
            <h3>Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-search.py</h3>
            <pre><code>1  import os
2  import requests
3  from bs4 import BeautifulSoup as bs
4  try:
5      from PIL import Image
6  except ImportError:
7      Image = None
8  try:
9      import cv2
10  except ImportError:
11      cv2 = None
12  from telethon.tl.types import DocumentAttributeAudio
13  from pyUltroid.fns.misc import google_search
14  from pyUltroid.fns.tools import get_google_images, saavn_search
15  from . import LOGS, async_searcher, con, eod, fast_download, get_string, ultroid_cmd
16  @ultroid_cmd(
17      pattern=&quot;github (.*)&quot;,
18  )
19  async def gitsearch(event):
20      usrname = event.pattern_match.group(1).strip()
21      if not usrname:
22          return await event.eor(get_string(&quot;srch_1&quot;))
23      url = f&quot;https://api.github.com/users/{usrname}&quot;
24      ult = await async_searcher(url, re_json=True)
25      try:
26          uname = ult[&quot;login&quot;]
27          uid = ult[&quot;id&quot;]
28          upic = f&quot;https://avatars.githubusercontent.com/u/{uid}&quot;
29          ulink = ult[&quot;html_url&quot;]
30          uacc = ult[&quot;name&quot;]
31          ucomp = ult[&quot;company&quot;]
32          ublog = ult[&quot;blog&quot;]
33          ulocation = ult[&quot;location&quot;]
34          ubio = ult[&quot;bio&quot;]
35          urepos = ult[&quot;public_repos&quot;]
36          ufollowers = ult[&quot;followers&quot;]
37          ufollowing = ult[&quot;following&quot;]
38      except BaseException:
39          return await event.eor(get_string(&quot;srch_2&quot;))
40      fullusr = f
41      await event.respond(fullusr, file=upic)
42      await event.delete()
43  @ultroid_cmd(
44      pattern=&quot;google( (.*)|$)&quot;,
45      manager=True,
46  )
47  async def google(event):
48      inp = event.pattern_match.group(1).strip()
49      if not inp:
50          return await eod(event, get_string(&quot;autopic_1&quot;))
51      x = await event.eor(get_string(&quot;com_2&quot;))
52      gs = await google_search(inp)
53      if not gs:
54          return await eod(x, get_string(&quot;autopic_2&quot;).format(inp))
55      out = &quot;&quot;
56      for res in gs:
57          text = res[&quot;title&quot;]
58          url = res[&quot;link&quot;]
59          des = res[&quot;description&quot;]
60          out += f&quot; üëâüèª  [{text}]({url})\n`{des}`\n\n&quot;
61      omk = f&quot;**Google Search Query:**\n`{inp}`\n\n**Results:**\n{out}&quot;
62      await x.eor(omk, link_preview=False)
63  @ultroid_cmd(pattern=&quot;img( (.*)|$)&quot;)
64  async def goimg(event):
65      query = event.pattern_match.group(1).strip()
66      if not query:
67          return await event.eor(get_string(&quot;autopic_1&quot;))
68      nn = await event.eor(get_string(&quot;com_1&quot;))
69      lmt = 5
70      if &quot;;&quot; in query:
71          try:
72              lmt = int(query.split(&quot;;&quot;)[1])
73              query = query.split(&quot;;&quot;)[0]
74          except BaseException:
75              pass
76      images = await get_google_images(query)
77      for img in images[:lmt]:
78          try:
79              await event.client.send_file(event.chat_id, file=img[&quot;original&quot;])
80          except Exception as er:
81              LOGS.exception(er)
82      await nn.delete()
83  @ultroid_cmd(pattern=&quot;reverse$&quot;)
84  async def reverse(event):
85      reply = await event.get_reply_message()
86      if not reply:
87          return await event.eor(&quot;`Reply to an Image`&quot;)
88      ult = await event.eor(get_string(&quot;com_1&quot;))
89      dl = await reply.download_media()
90      file = await con.convert(dl, convert_to=&quot;png&quot;)
91      img = Image.open(file)
92      x, y = img.size
93      files = {&quot;encoded_image&quot;: (file, open(file, &quot;rb&quot;))}
94      grs = requests.post(
95          &quot;https://www.google.com/searchbyimage/upload&quot;,
96          files=files,
97          allow_redirects=False,
98      )
99      loc = grs.headers.get(&quot;Location&quot;)
100      response = await async_searcher(
101          loc,
102          headers={
103              &quot;User-Agent&quot;: &quot;Mozilla/5.0 (X11; Linux x86_64; rv:58.0) Gecko/20100101 Firefox/58.0&quot;,
104          },
105      )
106      xx = bs(response, &quot;html.parser&quot;)
107      div = xx.find_all(&quot;div&quot;, {&quot;class&quot;: &quot;r5a77d&quot;})[0]
108      alls = div.find(&quot;a&quot;)
109      link = alls[&quot;href&quot;]
110      text = alls.text
111      await ult.edit(f&quot;`Dimension ~ {x} : {y}`\nSauce ~ [{text}](google.com{link})&quot;)
112      images = await get_google_images(text)
113      for z in images[:2]:
114          try:
115              await event.client.send_file(
116                  event.chat_id,
117                  file=z[&quot;original&quot;],
118                  caption=&quot;Similar Images Realted to Search&quot;,
119              )
120          except Exception as er:
121              LOGS.exception(er)
122      os.remove(file)
123  @ultroid_cmd(
124      pattern=&quot;saavn( (.*)|$)&quot;,
125  )
126  async def siesace(e):
127      song = e.pattern_match.group(1).strip()
128      if not song:
129          return await e.eor(&quot;`Give me Something to Search&quot;, time=5)
130      eve = await e.eor(f&quot;`Searching for {song} on Saavn...`&quot;)
131      try:
132          data = (await saavn_search(song))[0]
133      except IndexError:
134          return await eve.eor(f&quot;`{song} not found on saavn.`&quot;)
135      try:
136          title = data[&quot;title&quot;]
137          url = data[&quot;url&quot;]
138          img = data[&quot;image&quot;]
139          duration = data[&quot;duration&quot;]
140          performer = data[&quot;artists&quot;]
141      except KeyError:
142          return await eve.eor(&quot;`Something went wrong.`&quot;)
<span onclick='openModal()' class='match'>143      song, _ = await fast_download(url, filename=f&quot;{title}.m4a&quot;)
144      thumb, _ = await fast_download(img, filename=f&quot;{title}.jpg&quot;)
</span>145      song, _ = await e.client.fast_uploader(song, to_delete=True)
146      await eve.eor(
147          file=song,
148          text=f&quot;`{title}`\n`From Saavn`&quot;,
149          attributes=[
150              DocumentAttributeAudio(
151                  duration=int(duration),
152                  title=title,
153                  performer=performer,
154              )
155          ],
156          supports_streaming=True,
157          thumb=thumb,
158      )
159      await eve.delete()
160      os.remove(thumb)
</code></pre>
        </div>
        <div class="column">
            <h3>Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-callbackstuffs.py</h3>
            <pre><code>1  import ast
2  import asyncio
3  import re
4  import sys
5  import time
6  from asyncio.exceptions import TimeoutError as AsyncTimeOut
7  from os import execl, remove
8  from random import choice
9  from bs4 import BeautifulSoup as bs
10  try:
11      from pyUltroid.fns.gDrive import GDriveManager
12  except ImportError:
13      GDriveManager = None
14  from telegraph import upload_file as upl
15  from telethon import Button, events
16  from telethon.tl.types import MessageMediaWebPage
17  from telethon.utils import get_peer_id
18  from pyUltroid.fns.helper import fast_download, progress
19  from pyUltroid.fns.tools import Carbon, async_searcher, get_paste, telegraph_client
20  from pyUltroid.startup.loader import Loader
21  from . import *
22  telegraph = telegraph_client()
23  GDrive = GDriveManager() if GDriveManager else None
24  def text_to_url(event):
25      if isinstance(event.media, MessageMediaWebPage):
26          webpage = event.media.webpage
27          if not isinstance(webpage, types.WebPageEmpty) and webpage.type in [&quot;photo&quot;]:
28              return webpage.display_url
29      return event.text
30  _buttons = {
31      &quot;otvars&quot;: {
32          &quot;text&quot;: &quot;Other Variables to set for @TeamUltroid:&quot;,
33          &quot;buttons&quot;: [
34              [
35                  Button.inline(&quot;T·¥Ä…¢ L·¥è…¢…¢·¥á Ä&quot;, data=&quot;taglog&quot;),
36                  Button.inline(&quot;S·¥ú·¥ò·¥á ÄF ô·¥Ä…¥&quot;, data=&quot;cbs_sfban&quot;),
37              ],
38              [
39                  Button.inline(&quot;S·¥ú·¥Ö·¥è M·¥è·¥Ö·¥á&quot;, data=&quot;sudo&quot;),
40                  Button.inline(&quot;H·¥Ä…¥·¥Ö ü·¥á Ä&quot;, data=&quot;hhndlr&quot;),
41              ],
42              [
43                  Button.inline(&quot;Ex·¥õ Ä·¥Ä P ü·¥ú…¢…™…¥s&quot;, data=&quot;plg&quot;),
44                  Button.inline(&quot;A·¥Ö·¥Ö·¥è…¥s&quot;, data=&quot;eaddon&quot;),
45              ],
46              [
47                  Button.inline(&quot;E·¥ç·¥è·¥ä…™ …™…¥ H·¥á ü·¥ò&quot;, data=&quot;emoj&quot;),
48                  Button.inline(&quot;S·¥á·¥õ …¢D Ä…™·¥†·¥á&quot;, data=&quot;gdrive&quot;),
49              ],
50              [
51                  Button.inline(&quot;I…¥ ü…™…¥·¥á P…™·¥Ñ&quot;, data=&quot;inli_pic&quot;),
52                  Button.inline(&quot;S·¥ú·¥Ö·¥è HNDLR&quot;, data=&quot;shndlr&quot;),
53              ],
54              [Button.inline(&quot;D·¥ú·¥Ä ü M·¥è·¥Ö·¥á&quot;, &quot;cbs_oofdm&quot;)],
55              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;setter&quot;)],
56          ],
57      },
58      &quot;sfban&quot;: {
59          &quot;text&quot;: &quot;SuperFban Settings:&quot;,
60          &quot;buttons&quot;: [
61              [Button.inline(&quot;FB·¥Ä…¥ G Ä·¥è·¥ú·¥ò&quot;, data=&quot;sfgrp&quot;)],
62              [Button.inline(&quot;Ex·¥Ñ ü·¥ú·¥Ö·¥á F·¥á·¥Ös&quot;, data=&quot;abs_sfexf&quot;)],
63              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_otvars&quot;)],
64          ],
65      },
66      &quot;apauto&quot;: {
67          &quot;text&quot;: &quot;This&#x27;ll auto approve on outgoing messages&quot;,
68          &quot;buttons&quot;: [
69              [Button.inline(&quot;A·¥ú·¥õ·¥è A·¥ò·¥ò Ä·¥è·¥†·¥á ON&quot;, data=&quot;apon&quot;)],
70              [Button.inline(&quot;A·¥ú·¥õ·¥è A·¥ò·¥ò Ä·¥è·¥†·¥á OFF&quot;, data=&quot;apof&quot;)],
71              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_pmcstm&quot;)],
72          ],
73      },
74      &quot;alvcstm&quot;: {
75          &quot;text&quot;: f&quot;Customise your {HNDLR}alive. Choose from the below options -&quot;,
76          &quot;buttons&quot;: [
77              [Button.inline(&quot;A ü…™·¥†·¥á T·¥áx·¥õ&quot;, data=&quot;abs_alvtx&quot;)],
78              [Button.inline(&quot;A ü…™·¥†·¥á ·¥ç·¥á·¥Ö…™·¥Ä&quot;, data=&quot;alvmed&quot;)],
79              [Button.inline(&quot;D·¥á ü·¥á·¥õ·¥á A ü…™·¥†·¥á M·¥á·¥Ö…™·¥Ä&quot;, data=&quot;delmed&quot;)],
80              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;setter&quot;)],
81          ],
82      },
83      &quot;pmcstm&quot;: {
84          &quot;text&quot;: &quot;Customise your PMPERMIT Settings -&quot;,
85          &quot;buttons&quot;: [
86              [
87                  Button.inline(&quot;P·¥ç T·¥áx·¥õ&quot;, data=&quot;pmtxt&quot;),
88                  Button.inline(&quot;P·¥ç M·¥á·¥Ö…™·¥Ä&quot;, data=&quot;pmmed&quot;),
89              ],
90              [
91                  Button.inline(&quot;A·¥ú·¥õ·¥è A·¥ò·¥ò Ä·¥è·¥†·¥á&quot;, data=&quot;cbs_apauto&quot;),
92                  Button.inline(&quot;PMLOGGER&quot;, data=&quot;pml&quot;),
93              ],
94              [
95                  Button.inline(&quot;S·¥á·¥õ W·¥Ä Ä…¥s&quot;, data=&quot;swarn&quot;),
96                  Button.inline(&quot;D·¥á ü·¥á·¥õ·¥á P·¥ç M·¥á·¥Ö…™·¥Ä&quot;, data=&quot;delpmmed&quot;),
97              ],
98              [Button.inline(&quot;PMPermit Type&quot;, data=&quot;cbs_pmtype&quot;)],
99              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_ppmset&quot;)],
100          ],
101      },
102      &quot;pmtype&quot;: {
103          &quot;text&quot;: &quot;Select the type of PMPermit needed.&quot;,
104          &quot;buttons&quot;: [
105              [Button.inline(&quot;Inline&quot;, data=&quot;inpm_in&quot;)],
106              [Button.inline(&quot;Normal&quot;, data=&quot;inpm_no&quot;)],
107              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_pmcstm&quot;)],
108          ],
109      },
110      &quot;ppmset&quot;: {
111          &quot;text&quot;: &quot;PMPermit Settings:&quot;,
112          &quot;buttons&quot;: [
113              [Button.inline(&quot;T·¥ú Ä…¥ PMP·¥á Ä·¥ç…™·¥õ O…¥&quot;, data=&quot;pmon&quot;)],
114              [Button.inline(&quot;T·¥ú Ä…¥ PMP·¥á Ä·¥ç…™·¥õ O“ì“ì&quot;, data=&quot;pmoff&quot;)],
115              [Button.inline(&quot;C·¥ús·¥õ·¥è·¥ç…™·¥¢·¥á PMP·¥á Ä·¥ç…™·¥õ&quot;, data=&quot;cbs_pmcstm&quot;)],
116              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;setter&quot;)],
117          ],
118      },
119      &quot;chatbot&quot;: {
120          &quot;text&quot;: &quot;From This Feature U can chat with ppls Via ur Assistant Bot.\n[More info](https://t.me/UltroidUpdates/2)&quot;,
121          &quot;buttons&quot;: [
122              [
123                  Button.inline(&quot;C ú·¥Ä·¥õ B·¥è·¥õ  O…¥&quot;, data=&quot;onchbot&quot;),
124                  Button.inline(&quot;C ú·¥Ä·¥õ B·¥è·¥õ  O“ì“ì&quot;, data=&quot;ofchbot&quot;),
125              ],
126              [
127                  Button.inline(&quot;B·¥è·¥õ W·¥á ü·¥Ñ·¥è·¥ç·¥á&quot;, data=&quot;bwel&quot;),
128                  Button.inline(&quot;B·¥è·¥õ W·¥á ü·¥Ñ·¥è·¥ç·¥á M·¥á·¥Ö…™·¥Ä&quot;, data=&quot;botmew&quot;),
129              ],
130              [Button.inline(&quot;B·¥è·¥õ I…¥“ì·¥è T·¥áx·¥õ&quot;, data=&quot;botinfe&quot;)],
131              [Button.inline(&quot;F·¥è Ä·¥Ñ·¥á S·¥ú ôs·¥Ñ Ä…™ ô·¥á&quot;, data=&quot;pmfs&quot;)],
132              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;setter&quot;)],
133          ],
134      },
135      &quot;vcb&quot;: {
136          &quot;text&quot;: &quot;From This Feature U can play songs in group voice chat\n\n[moreinfo](https://t.me/UltroidUpdates/4)&quot;,
137          &quot;buttons&quot;: [
138              [Button.inline(&quot;VC S·¥áss…™·¥è…¥&quot;, data=&quot;abs_vcs&quot;)],
139              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;setter&quot;)],
140          ],
141      },
142      &quot;oofdm&quot;: {
143          &quot;text&quot;: &quot;About [Dual Mode](https://t.me/UltroidUpdates/18)&quot;,
144          &quot;buttons&quot;: [
145              [
146                  Button.inline(&quot;D·¥ú·¥Ä ü M·¥è·¥Ö·¥á O…¥&quot;, &quot;dmof&quot;),
147                  Button.inline(&quot;D·¥ú·¥Ä ü M·¥è·¥Ö·¥á O“ì“ì&quot;, &quot;dmof&quot;),
148              ],
149              [Button.inline(&quot;D·¥ú·¥Ä ü M·¥è·¥Ö·¥á H…¥·¥Ö ü Ä&quot;, &quot;dmhn&quot;)],
150              [Button.inline(&quot;¬´ Back&quot;, data=&quot;cbs_otvars&quot;)],
151          ],
152      },
153      &quot;apiset&quot;: {
154          &quot;text&quot;: get_string(&quot;ast_1&quot;),
155          &quot;buttons&quot;: [
156              [Button.inline(&quot;Remove.bg API&quot;, data=&quot;abs_rmbg&quot;)],
157              [Button.inline(&quot;DEEP API&quot;, data=&quot;abs_dapi&quot;)],
158              [Button.inline(&quot;OCR API&quot;, data=&quot;abs_oapi&quot;)],
159              [Button.inline(&quot;¬´ Back&quot;, data=&quot;setter&quot;)],
160          ],
161      },
162  }
163  _convo = {
164      &quot;rmbg&quot;: {
165          &quot;var&quot;: &quot;RMBG_API&quot;,
166          &quot;name&quot;: &quot;Remove.bg API Key&quot;,
167          &quot;text&quot;: get_string(&quot;ast_2&quot;),
168          &quot;back&quot;: &quot;cbs_apiset&quot;,
169      },
170      &quot;dapi&quot;: {
171          &quot;var&quot;: &quot;DEEP_AI&quot;,
172          &quot;name&quot;: &quot;Deep AI Api Key&quot;,
173          &quot;text&quot;: &quot;Get Your Deep Api from deepai.org and send here.&quot;,
174          &quot;back&quot;: &quot;cbs_apiset&quot;,
175      },
176      &quot;oapi&quot;: {
177          &quot;var&quot;: &quot;OCR_API&quot;,
178          &quot;name&quot;: &quot;Ocr Api Key&quot;,
179          &quot;text&quot;: &quot;Get Your OCR api from ocr.space and send that Here.&quot;,
180          &quot;back&quot;: &quot;cbs_apiset&quot;,
181      },
182      &quot;pmlgg&quot;: {
183          &quot;var&quot;: &quot;PMLOGGROUP&quot;,
184          &quot;name&quot;: &quot;Pm Log Group&quot;,
185          &quot;text&quot;: &quot;Send chat id of chat which you want to save as Pm log Group.&quot;,
186          &quot;back&quot;: &quot;pml&quot;,
187      },
188      &quot;vcs&quot;: {
189          &quot;var&quot;: &quot;VC_SESSION&quot;,
190          &quot;name&quot;: &quot;Vc Session&quot;,
191          &quot;text&quot;: &quot;**Vc session**\nEnter the New session u generated for vc bot.\n\nUse /cancel to terminate the operation.&quot;,
192          &quot;back&quot;: &quot;cbs_vcb&quot;,
193      },
194      &quot;settag&quot;: {
195          &quot;var&quot;: &quot;TAG_LOG&quot;,
196          &quot;name&quot;: &quot;Tag Log Group&quot;,
197          &quot;text&quot;: f&quot;Make a group, add your assistant and make it admin.\nGet the `{HNDLR}id` of that group and send it here for tag logs.\n\nUse /cancel to cancel.&quot;,
198          &quot;back&quot;: &quot;taglog&quot;,
199      },
200      &quot;alvtx&quot;: {
201          &quot;var&quot;: &quot;ALIVE_TEXT&quot;,
202          &quot;name&quot;: &quot;Alive Text&quot;,
203          &quot;text&quot;: &quot;**Alive Text**\nEnter the new alive text.\n\nUse /cancel to terminate the operation.&quot;,
204          &quot;back&quot;: &quot;cbs_alvcstm&quot;,
205      },
206      &quot;sfexf&quot;: {
207          &quot;var&quot;: &quot;EXCLUDE_FED&quot;,
208          &quot;name&quot;: &quot;Excluded Fed&quot;,
209          &quot;text&quot;: &quot;Send the Fed IDs you want to exclude in the ban. Split by a space.\neg`id1 id2 id3`\nSet is as `None` if you dont want any.\nUse /cancel to go back.&quot;,
210          &quot;back&quot;: &quot;cbs_sfban&quot;,
211      },
212  }
213  TOKEN_FILE = &quot;resources/auths/auth_token.txt&quot;
214  @callback(
215      re.compile(
216          &quot;sndplug_(.*)&quot;,
217      ),
218      owner=True,
219  )
220  async def send(eve):
221      key, name = (eve.data_match.group(1)).decode(&quot;UTF-8&quot;).split(&quot;_&quot;)
222      thumb = &quot;resources/extras/inline.jpg&quot;
223      await eve.answer(&quot;‚ñ† Sending ‚ñ†&quot;)
224      data = f&quot;uh_{key}_&quot;
225      index = None
226      if &quot;|&quot; in name:
227          name, index = name.split(&quot;|&quot;)
228      key = &quot;plugins&quot; if key == &quot;Official&quot; else key.lower()
229      plugin = f&quot;{key}/{name}.py&quot;
230      _ = f&quot;pasta-{plugin}&quot;
231      if index is not None:
232          data += f&quot;|{index}&quot;
233          _ += f&quot;|{index}&quot;
234      buttons = [
235          [
236              Button.inline(
237                  &quot;¬´ P·¥Äs·¥õ·¥á ¬ª&quot;,
238                  data=_,
239              )
240          ],
241          [
242              Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=data),
243          ],
244      ]
245      try:
246          await eve.edit(file=plugin, thumb=thumb, buttons=buttons)
247      except Exception as er:
248          await eve.answer(str(er), alert=True)
249  heroku_api, app_name = Var.HEROKU_API, Var.HEROKU_APP_NAME
250  @callback(&quot;updatenow&quot;, owner=True)
251  async def update(eve):
252      repo = Repo()
253      ac_br = repo.active_branch
254      ups_rem = repo.remote(&quot;upstream&quot;)
255      if heroku_api:
256          import heroku3
257          try:
258              heroku = heroku3.from_key(heroku_api)
259              heroku_app = None
260              heroku_applications = heroku.apps()
261          except BaseException as er:
262              LOGS.exception(er)
263              return await eve.edit(&quot;`Wrong HEROKU_API.`&quot;)
264          for app in heroku_applications:
265              if app.name == app_name:
266                  heroku_app = app
267          if not heroku_app:
268              await eve.edit(&quot;`Wrong HEROKU_APP_NAME.`&quot;)
269              repo.__del__()
270              return
271          await eve.edit(get_string(&quot;clst_1&quot;))
272          ups_rem.fetch(ac_br)
273          repo.git.reset(&quot;--hard&quot;, &quot;FETCH_HEAD&quot;)
274          heroku_git_url = heroku_app.git_url.replace(
275              &quot;https://&quot;, f&quot;https://api:{heroku_api}@&quot;
276          )
277          if &quot;heroku&quot; in repo.remotes:
278              remote = repo.remote(&quot;heroku&quot;)
279              remote.set_url(heroku_git_url)
280          else:
281              remote = repo.create_remote(&quot;heroku&quot;, heroku_git_url)
282          try:
283              remote.push(refspec=f&quot;HEAD:refs/heads/{ac_br}&quot;, force=True)
284          except GitCommandError as error:
285              await eve.edit(f&quot;`Here is the error log:\n{error}`&quot;)
286              repo.__del__()
287              return
288          await eve.edit(&quot;`Successfully Updated!\nRestarting, please wait...`&quot;)
289      else:
290          await eve.edit(get_string(&quot;clst_1&quot;))
291          call_back()
292          await bash(&quot;git pull &amp;&amp; pip3 install -r requirements.txt&quot;)
293          execl(sys.executable, sys.executable, &quot;-m&quot;, &quot;pyUltroid&quot;)
294  @callback(re.compile(&quot;changes(.*)&quot;), owner=True)
295  async def changes(okk):
296      match = okk.data_match.group(1).decode(&quot;utf-8&quot;)
297      await okk.answer(get_string(&quot;clst_3&quot;))
298      repo = Repo.init()
299      button = [[Button.inline(&quot;Update Now&quot;, data=&quot;updatenow&quot;)]]
300      changelog, tl_chnglog = await gen_chlog(
301          repo, f&quot;HEAD..upstream/{repo.active_branch}&quot;
302      )
303      cli = &quot;\n\nClick the below button to update!&quot;
304      if not match:
305          try:
306              if len(tl_chnglog) &gt; 700:
307                  tl_chnglog = f&quot;{tl_chnglog[:700]}...&quot;
308                  button.append([Button.inline(&quot;View Complete&quot;, &quot;changesall&quot;)])
309              await okk.edit(&quot;‚Ä¢ Writing Changelogs üìù ‚Ä¢&quot;)
310              img = await Carbon(
311                  file_name=&quot;changelog&quot;,
312                  code=tl_chnglog,
313                  backgroundColor=choice(ATRA_COL),
314                  language=&quot;md&quot;,
315              )
316              return await okk.edit(
317                  f&quot;**‚Ä¢ Ultroid Userbot ‚Ä¢**{cli}&quot;, file=img, buttons=button
318              )
319          except Exception as er:
320              LOGS.exception(er)
321      changelog_str = changelog + cli
322      if len(changelog_str) &gt; 1024:
323          await okk.edit(get_string(&quot;upd_4&quot;))
324          await asyncio.sleep(2)
325          with open(&quot;ultroid_updates.txt&quot;, &quot;w+&quot;) as file:
326              file.write(tl_chnglog)
327          await okk.edit(
328              get_string(&quot;upd_5&quot;),
329              file=&quot;ultroid_updates.txt&quot;,
330              buttons=button,
331          )
332          remove(&quot;ultroid_updates.txt&quot;)
333          return
334      await okk.edit(
335          changelog_str,
336          buttons=button,
337          parse_mode=&quot;html&quot;,
338      )
339  @callback(
340      re.compile(
341          &quot;pasta-(.*)&quot;,
342      ),
343      owner=True,
344  )
345  async def _(e):
346      ok = (e.data_match.group(1)).decode(&quot;UTF-8&quot;)
347      index = None
348      if &quot;|&quot; in ok:
349          ok, index = ok.split(&quot;|&quot;)
350      with open(ok, &quot;r&quot;) as hmm:
351          _, key = await get_paste(hmm.read())
352      link = f&quot;https://spaceb.in/{key}&quot;
353      raw = f&quot;https://spaceb.in/api/v1/documents/{key}/raw&quot;
354      if not _:
355          return await e.answer(key[:30], alert=True)
356      if ok.startswith(&quot;addons&quot;):
357          key = &quot;Addons&quot;
358      elif ok.startswith(&quot;vcbot&quot;):
359          key = &quot;VCBot&quot;
360      else:
361          key = &quot;Official&quot;
362      data = f&quot;uh_{key}_&quot;
363      if index is not None:
364          data += f&quot;|{index}&quot;
365      await e.edit(
366          &quot;&quot;,
367          buttons=[
368              [Button.url(&quot;L…™…¥·¥ã&quot;, link), Button.url(&quot;R·¥Ä·¥°&quot;, raw)],
369              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=data)],
370          ],
371      )
372  @callback(re.compile(&quot;cbs_(.*)&quot;), owner=True)
373  async def _edit_to(event):
374      match = event.data_match.group(1).decode(&quot;utf-8&quot;)
375      data = _buttons.get(match)
376      if not data:
377          return
378      await event.edit(data[&quot;text&quot;], buttons=data[&quot;buttons&quot;], link_preview=False)
379  @callback(re.compile(&quot;abs_(.*)&quot;), owner=True)
380  async def convo_handler(event: events.CallbackQuery):
381      match = event.data_match.group(1).decode(&quot;utf-8&quot;)
382      if not _convo.get(match):
383          return
384      await event.delete()
385      get_ = _convo[match]
386      back = get_[&quot;back&quot;]
387      async with event.client.conversation(event.sender_id) as conv:
388          await conv.send_message(get_[&quot;text&quot;])
389          response = await conv.get_response()
390          themssg = response.message
391          try:
392              themssg = ast.literal_eval(themssg)
393          except Exception:
394              pass
395          if themssg == &quot;/cancel&quot;:
396              return await conv.send_message(
397                  &quot;Cancelled!!&quot;,
398                  buttons=get_back_button(back),
399              )
400          await setit(event, get_[&quot;var&quot;], themssg)
401          await conv.send_message(
402              f&quot;{get_[&#x27;name&#x27;]} changed to `{themssg}`&quot;,
403              buttons=get_back_button(back),
404          )
405  @callback(&quot;authorise&quot;, owner=True)
406  async def _(e):
407      if not e.is_private:
408          return
409      url = GDrive._create_token_file()
410      await e.edit(&quot;Go to the below link and send the code!&quot;)
411      async with asst.conversation(e.sender_id) as conv:
412          await conv.send_message(url)
413          code = await conv.get_response()
414          if GDrive._create_token_file(code=code.text):
415              await conv.send_message(
416                  &quot;`Success!\nYou are all set to use Google Drive with Ultroid Userbot.`&quot;,
417                  buttons=Button.inline(&quot;Main Menu&quot;, data=&quot;setter&quot;),
418              )
419          else:
420              await conv.send_message(&quot;Wrong code! Click authorise again.&quot;)
421  @callback(&quot;folderid&quot;, owner=True, func=lambda x: x.is_private)
422  async def _(e):
423      if not e.is_private:
424          return
425      msg = (
426          &quot;Send your FOLDER ID\n\n&quot;
427          + &quot;For FOLDER ID:\n&quot;
428          + &quot;1. Open Google Drive App.\n&quot;
429          + &quot;2. Create Folder.\n&quot;
430          + &quot;3. Make that folder public.\n&quot;
431          + &quot;4. Send link of that folder.&quot;
432      )
433      await e.delete()
434      async with asst.conversation(e.sender_id, timeout=150) as conv:
435          await conv.send_message(msg)
436          repl = await conv.get_response()
437          id = repl.text
438          if id.startswith(&quot;https&quot;):
439              id = id.split(&quot;?id=&quot;)[-1]
440          udB.set_key(&quot;GDRIVE_FOLDER_ID&quot;, id)
441          await repl.reply(
442              &quot;`Success.`&quot;,
443              buttons=get_back_button(&quot;gdrive&quot;),
444          )
445  @callback(&quot;gdrive&quot;, owner=True)
446  async def _(e):
447      if not e.is_private:
448          return
449      await e.edit(
450          &quot;Click Authorise and send the code.\n\nYou can use your own CLIENT ID and SECRET by [this](https://t.me/UltroidUpdates/37)&quot;,
451          buttons=[
452              [
453                  Button.inline(&quot;Folder ID&quot;, data=&quot;folderid&quot;),
454                  Button.inline(&quot;Authorise&quot;, data=&quot;authorise&quot;),
455              ],
456              [Button.inline(&quot;¬´ Back&quot;, data=&quot;cbs_otvars&quot;)],
457          ],
458          link_preview=False,
459      )
460  @callback(&quot;dmof&quot;, owner=True)
461  async def rhwhe(e):
462      if udB.get_key(&quot;DUAL_MODE&quot;):
463          udB.del_key(&quot;DUAL_MODE&quot;)
464          key = &quot;Off&quot;
465      else:
466          udB.set_key(&quot;DUAL_MODE&quot;, &quot;True&quot;)
467          key = &quot;On&quot;
468      Msg = f&quot;Dual Mode : {key}&quot;
469      await e.edit(Msg, buttons=get_back_button(&quot;cbs_otvars&quot;))
470  @callback(&quot;dmhn&quot;, owner=True)
471  async def hndlrr(event):
472      await event.delete()
473      pru = event.sender_id
474      var = &quot;DUAL_HNDLR&quot;
475      name = &quot;Dual Handler&quot;
476      CH = udB.get_key(var) or &quot;/&quot;
477      async with event.client.conversation(pru) as conv:
478          await conv.send_message(
479              f&quot;Send The Symbol Which u want as Handler/Trigger to use your Assistant bot\nUr Current Handler is [ `{CH}` ]\n\n use /cancel to cancel.&quot;,
480          )
481          response = conv.wait_event(events.NewMessage(chats=pru))
482          response = await response
483          themssg = response.message.message
484          if themssg == &quot;/cancel&quot;:
485              await conv.send_message(
486                  &quot;Cancelled!!&quot;,
487                  buttons=get_back_button(&quot;cbs_otvars&quot;),
488              )
489          elif len(themssg) &gt; 1:
490              await conv.send_message(
491                  &quot;Incorrect Handler&quot;,
492                  buttons=get_back_button(&quot;cbs_otvars&quot;),
493              )
494          else:
495              await setit(event, var, themssg)
496              await conv.send_message(
497                  f&quot;{name} changed to {themssg}&quot;,
498                  buttons=get_back_button(&quot;cbs_otvars&quot;),
499              )
500  @callback(&quot;emoj&quot;, owner=True)
501  async def emoji(event):
502      await event.delete()
503      pru = event.sender_id
504      var = &quot;EMOJI_IN_HELP&quot;
505      name = f&quot;Emoji in `{HNDLR}help` menu&quot;
506      async with event.client.conversation(pru) as conv:
507          await conv.send_message(&quot;Send emoji u want to set üôÉ.\n\nUse /cancel to cancel.&quot;)
508          response = conv.wait_event(events.NewMessage(chats=pru))
509          response = await response
510          themssg = response.message.message
511          if themssg == &quot;/cancel&quot;:
512              await conv.send_message(
513                  &quot;Cancelled!!&quot;,
514                  buttons=get_back_button(&quot;cbs_otvars&quot;),
515              )
516          elif themssg.startswith((&quot;/&quot;, HNDLR)):
517              await conv.send_message(
518                  &quot;Incorrect Emoji&quot;,
519                  buttons=get_back_button(&quot;cbs_otvars&quot;),
520              )
521          else:
522              await setit(event, var, themssg)
523              await conv.send_message(
524                  f&quot;{name} changed to {themssg}\n&quot;,
525                  buttons=get_back_button(&quot;cbs_otvars&quot;),
526              )
527  @callback(&quot;plg&quot;, owner=True)
528  async def pluginch(event):
529      await event.delete()
530      pru = event.sender_id
531      var = &quot;PLUGIN_CHANNEL&quot;
532      name = &quot;Plugin Channel&quot;
533      async with event.client.conversation(pru) as conv:
534          await conv.send_message(
535              &quot;Send id or username of a channel from where u want to install all plugins\n\nOur Channel~ @ultroidplugins\n\nUse /cancel to cancel.&quot;,
536          )
537          response = conv.wait_event(events.NewMessage(chats=pru))
538          response = await response
539          themssg = response.message.message
540          if themssg == &quot;/cancel&quot;:
541              await conv.send_message(
542                  &quot;Cancelled!!&quot;,
543                  buttons=get_back_button(&quot;cbs_otvars&quot;),
544              )
545          elif themssg.startswith((&quot;/&quot;, HNDLR)):
546              await conv.send_message(
547                  &quot;Incorrect channel&quot;,
548                  buttons=get_back_button(&quot;cbs_otvars&quot;),
549              )
550          else:
551              await setit(event, var, themssg)
552              await conv.send_message(
553                  f&quot;{name} changed to {themssg}\n After Setting All Things Do Restart&quot;,
554                  buttons=get_back_button(&quot;cbs_otvars&quot;),
555              )
556  @callback(&quot;hhndlr&quot;, owner=True)
557  async def hndlrr(event):
558      await event.delete()
559      pru = event.sender_id
560      var = &quot;HNDLR&quot;
561      name = &quot;Handler/ Trigger&quot;
562      async with event.client.conversation(pru) as conv:
563          await conv.send_message(
564              f&quot;Send The Symbol Which u want as Handler/Trigger to use bot\nUr Current Handler is [ `{HNDLR}` ]\n\n use /cancel to cancel.&quot;,
565          )
566          response = conv.wait_event(events.NewMessage(chats=pru))
567          response = await response
568          themssg = response.message.message
569          if themssg == &quot;/cancel&quot;:
570              await conv.send_message(
571                  &quot;Cancelled!!&quot;,
572                  buttons=get_back_button(&quot;cbs_otvars&quot;),
573              )
574          elif len(themssg) &gt; 1:
575              await conv.send_message(
576                  &quot;Incorrect Handler&quot;,
577                  buttons=get_back_button(&quot;cbs_otvars&quot;),
578              )
579          elif themssg.startswith((&quot;/&quot;, &quot;#&quot;, &quot;@&quot;)):
580              await conv.send_message(
581                  &quot;This cannot be used as handler&quot;,
582                  buttons=get_back_button(&quot;cbs_otvars&quot;),
583              )
584          else:
585              await setit(event, var, themssg)
586              await conv.send_message(
587                  f&quot;{name} changed to {themssg}&quot;,
588                  buttons=get_back_button(&quot;cbs_otvars&quot;),
589              )
590  @callback(&quot;shndlr&quot;, owner=True)
591  async def hndlrr(event):
592      await event.delete()
593      pru = event.sender_id
594      var = &quot;SUDO_HNDLR&quot;
595      name = &quot;Sudo Handler&quot;
596      async with event.client.conversation(pru) as conv:
597          await conv.send_message(
598              &quot;Send The Symbol Which u want as Sudo Handler/Trigger to use bot\n\n use /cancel to cancel.&quot;
599          )
600          response = conv.wait_event(events.NewMessage(chats=pru))
601          response = await response
602          themssg = response.message.message
603          if themssg == &quot;/cancel&quot;:
604              await conv.send_message(
605                  &quot;Cancelled!!&quot;,
606                  buttons=get_back_button(&quot;cbs_otvars&quot;),
607              )
608          elif len(themssg) &gt; 1:
609              await conv.send_message(
610                  &quot;Incorrect Handler&quot;,
611                  buttons=get_back_button(&quot;cbs_otvars&quot;),
612              )
613          elif themssg.startswith((&quot;/&quot;, &quot;#&quot;, &quot;@&quot;)):
614              await conv.send_message(
615                  &quot;This cannot be used as handler&quot;,
616                  buttons=get_back_button(&quot;cbs_otvars&quot;),
617              )
618          else:
619              await setit(event, var, themssg)
620              await conv.send_message(
621                  f&quot;{name} changed to {themssg}&quot;,
622                  buttons=get_back_button(&quot;cbs_otvars&quot;),
623              )
624  @callback(&quot;taglog&quot;, owner=True)
625  async def tagloggrr(e):
626      BUTTON = [
627          [Button.inline(&quot;SET TAG LOG&quot;, data=&quot;abs_settag&quot;)],
628          [Button.inline(&quot;DELETE TAG LOG&quot;, data=&quot;deltag&quot;)],
629          get_back_button(&quot;cbs_otvars&quot;),
630      ]
631      await e.edit(
632          &quot;Choose Options&quot;,
633          buttons=BUTTON,
634      )
635  @callback(&quot;deltag&quot;, owner=True)
636  async def _(e):
637      udB.del_key(&quot;TAG_LOG&quot;)
638      await e.answer(&quot;Done!!! Tag Logger has been turned Off&quot;)
639  @callback(&quot;eaddon&quot;, owner=True)
640  async def pmset(event):
641      BT = (
642          [Button.inline(&quot;A·¥Ö·¥Ö·¥è…¥s  O“ì“ì&quot;, data=&quot;edof&quot;)]
643          if udB.get_key(&quot;ADDONS&quot;)
644          else [Button.inline(&quot;A·¥Ö·¥Ö·¥è…¥s  O…¥&quot;, data=&quot;edon&quot;)]
645      )
646      await event.edit(
647          &quot;ADDONS~ Extra Plugins:&quot;,
648          buttons=[
649              BT,
650              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_otvars&quot;)],
651          ],
652      )
653  @callback(&quot;edon&quot;, owner=True)
654  async def eddon(event):
655      var = &quot;ADDONS&quot;
656      await setit(event, var, &quot;True&quot;)
657      await event.edit(
658          &quot;Done! ADDONS has been turned on!!\n\n After Setting All Things Do Restart&quot;,
659          buttons=get_back_button(&quot;eaddon&quot;),
660      )
661  @callback(&quot;edof&quot;, owner=True)
662  async def eddof(event):
663      udB.set_key(&quot;ADDONS&quot;, &quot;False&quot;)
664      await event.edit(
665          &quot;Done! ADDONS has been turned off!! After Setting All Things Do Restart&quot;,
666          buttons=get_back_button(&quot;eaddon&quot;),
667      )
668  @callback(&quot;sudo&quot;, owner=True)
669  async def pmset(event):
670      BT = (
671          [Button.inline(&quot;S·¥ú·¥Ö·¥è M·¥è·¥Ö·¥á  O“ì“ì&quot;, data=&quot;ofsudo&quot;)]
672          if udB.get_key(&quot;SUDO&quot;)
673          else [Button.inline(&quot;S·¥ú·¥Ö·¥è M·¥è·¥Ö·¥á  O…¥&quot;, data=&quot;onsudo&quot;)]
674      )
675      await event.edit(
676          f&quot;SUDO MODE ~ Some peoples can use ur Bot which u selected. To know More use `{HNDLR}help sudo`&quot;,
677          buttons=[
678              BT,
679              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_otvars&quot;)],
680          ],
681      )
682  @callback(&quot;onsudo&quot;, owner=True)
683  async def eddon(event):
684      var = &quot;SUDO&quot;
685      await setit(event, var, &quot;True&quot;)
686      await event.edit(
687          &quot;Done! SUDO MODE has been turned on!!\n\n After Setting All Things Do Restart&quot;,
688          buttons=get_back_button(&quot;sudo&quot;),
689      )
690  @callback(&quot;ofsudo&quot;, owner=True)
691  async def eddof(event):
692      var = &quot;SUDO&quot;
693      await setit(event, var, &quot;False&quot;)
694      await event.edit(
695          &quot;Done! SUDO MODE has been turned off!! After Setting All Things Do Restart&quot;,
696          buttons=get_back_button(&quot;sudo&quot;),
697      )
698  @callback(&quot;sfgrp&quot;, owner=True)
699  async def sfgrp(event):
700      await event.delete()
701      name = &quot;FBan Group ID&quot;
702      var = &quot;FBAN_GROUP_ID&quot;
703      pru = event.sender_id
704      async with asst.conversation(pru) as conv:
705          await conv.send_message(
706              f&quot;Make a group, add @MissRose_Bot, send `{HNDLR}id`, copy that and send it here.\nUse /cancel to go back.&quot;,
707          )
708          response = conv.wait_event(events.NewMessage(chats=pru))
709          response = await response
710          themssg = response.message.message
711          if themssg == &quot;/cancel&quot;:
712              return await conv.send_message(
713                  &quot;Cancelled!!&quot;,
714                  buttons=get_back_button(&quot;cbs_sfban&quot;),
715              )
716          await setit(event, var, themssg)
717          await conv.send_message(
718              f&quot;{name} changed to {themssg}&quot;,
719              buttons=get_back_button(&quot;cbs_sfban&quot;),
720          )
721  @callback(&quot;alvmed&quot;, owner=True)
722  async def media(event):
723      await event.delete()
724      pru = event.sender_id
725      var = &quot;ALIVE_PIC&quot;
726      name = &quot;Alive Media&quot;
727      async with event.client.conversation(pru) as conv:
728          await conv.send_message(
729              &quot;**Alive Media**\nSend me a pic/gif/media to set as alive media.\n\nUse /cancel to terminate the operation.&quot;,
730          )
731          response = await conv.get_response()
732          try:
733              themssg = response.message
734              if themssg == &quot;/cancel&quot;:
735                  return await conv.send_message(
736                      &quot;Operation cancelled!!&quot;,
737                      buttons=get_back_button(&quot;cbs_alvcstm&quot;),
738                  )
739          except BaseException as er:
740              LOGS.exception(er)
741          if (
742              not (response.text).startswith(&quot;/&quot;)
743              and response.text != &quot;&quot;
744              and (not response.media or isinstance(response.media, MessageMediaWebPage))
745          ):
746              url = text_to_url(response)
747          elif response.sticker:
748              url = response.file.id
749          else:
750              media = await event.client.download_media(response, &quot;alvpc&quot;)
751              try:
752                  x = upl(media)
753                  url = f&quot;https://graph.org/{x[0]}&quot;
754                  remove(media)
755              except BaseException as er:
756                  LOGS.exception(er)
757                  return await conv.send_message(
758                      &quot;Terminated.&quot;,
759                      buttons=get_back_button(&quot;cbs_alvcstm&quot;),
760                  )
761          await setit(event, var, url)
762          await conv.send_message(
763              f&quot;{name} has been set.&quot;,
764              buttons=get_back_button(&quot;cbs_alvcstm&quot;),
765          )
766  @callback(&quot;delmed&quot;, owner=True)
767  async def dell(event):
768      try:
769          udB.del_key(&quot;ALIVE_PIC&quot;)
770          return await event.edit(
771              get_string(&quot;clst_5&quot;), buttons=get_back_button(&quot;cbs_alabs_vcstm&quot;)
772          )
773      except BaseException as er:
774          LOGS.exception(er)
775          return await event.edit(
776              get_string(&quot;clst_4&quot;),
777              buttons=get_back_button(&quot;cbs_alabs_vcstm&quot;),
778          )
779  @callback(&quot;inpm_in&quot;, owner=True)
780  async def inl_on(event):
781      var = &quot;INLINE_PM&quot;
782      await setit(event, var, &quot;True&quot;)
783      await event.edit(
784          &quot;Done!! PMPermit type has been set to inline!&quot;,
785          buttons=[[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_pmtype&quot;)]],
786      )
787  @callback(&quot;inpm_no&quot;, owner=True)
788  async def inl_on(event):
789      var = &quot;INLINE_PM&quot;
790      await setit(event, var, &quot;False&quot;)
791      await event.edit(
792          &quot;Done!! PMPermit type has been set to normal!&quot;,
793          buttons=[[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_pmtype&quot;)]],
794      )
795  @callback(&quot;pmtxt&quot;, owner=True)
796  async def name(event):
797      await event.delete()
798      pru = event.sender_id
799      var = &quot;PM_TEXT&quot;
800      name = &quot;PM Text&quot;
801      async with event.client.conversation(pru) as conv:
802          await conv.send_message(
803              &quot;**PM Text**\nEnter the new Pmpermit text.\n\nu can use `{name}` `{fullname}` `{count}` `{mention}` `{username}` to get this from user Too\n\nUse /cancel to terminate the operation.&quot;,
804          )
805          response = conv.wait_event(events.NewMessage(chats=pru))
806          response = await response
807          themssg = response.message.message
808          if themssg == &quot;/cancel&quot;:
809              return await conv.send_message(
810                  &quot;Cancelled!!&quot;,
811                  buttons=get_back_button(&quot;cbs_pmcstm&quot;),
812              )
813          if len(themssg) &gt; 4090:
814              return await conv.send_message(
815                  &quot;Message too long!\nGive a shorter message please!!&quot;,
816                  buttons=get_back_button(&quot;cbs_pmcstm&quot;),
817              )
818          await setit(event, var, themssg)
819          await conv.send_message(
820              f&quot;{name} changed to {themssg}\n\nAfter Setting All Things Do restart&quot;,
821              buttons=get_back_button(&quot;cbs_pmcstm&quot;),
822          )
823  @callback(&quot;swarn&quot;, owner=True)
824  async def name(event):
825      m = range(1, 10)
826      tultd = [Button.inline(f&quot;{x}&quot;, data=f&quot;wrns_{x}&quot;) for x in m]
827      lst = list(zip(tultd[::3], tultd[1::3], tultd[2::3]))
828      lst.append([Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_pmcstm&quot;)])
829      await event.edit(
830          &quot;Select the number of warnings for a user before getting blocked in PMs.&quot;,
831          buttons=lst,
832      )
833  @callback(re.compile(b&quot;wrns_(.*)&quot;), owner=True)
834  async def set_wrns(event):
835      value = int(event.data_match.group(1).decode(&quot;UTF-8&quot;))
836      if dn := udB.set_key(&quot;PMWARNS&quot;, value):
837          await event.edit(
838              f&quot;PM Warns Set to {value}.\nNew users will have {value} chances in PMs before getting banned.&quot;,
839              buttons=get_back_button(&quot;cbs_pmcstm&quot;),
840          )
841      else:
842          await event.edit(
843              f&quot;Something went wrong, please check your {HNDLR}logs!&quot;,
844              buttons=get_back_button(&quot;cbs_pmcstm&quot;),
845          )
846  @callback(&quot;pmmed&quot;, owner=True)
847  async def media(event):
848      await event.delete()
849      pru = event.sender_id
850      var = &quot;PMPIC&quot;
851      name = &quot;PM Media&quot;
852      async with event.client.conversation(pru) as conv:
853          await conv.send_message(
854              &quot;**PM Media**\nSend me a pic/gif/sticker/link  to set as pmpermit media.\n\nUse /cancel to terminate the operation.&quot;,
855          )
856          response = await conv.get_response()
857          try:
858              themssg = response.message
859              if themssg == &quot;/cancel&quot;:
860                  return await conv.send_message(
861                      &quot;Operation cancelled!!&quot;,
862                      buttons=get_back_button(&quot;cbs_pmcstm&quot;),
863                  )
864          except BaseException as er:
865              LOGS.exception(er)
866          media = await event.client.download_media(response, &quot;pmpc&quot;)
867          if (
868              not (response.text).startswith(&quot;/&quot;)
869              and response.text != &quot;&quot;
870              and (not response.media or isinstance(response.media, MessageMediaWebPage))
871          ):
872              url = text_to_url(response)
873          elif response.sticker:
874              url = response.file.id
875          else:
876              try:
877                  x = upl(media)
878                  url = f&quot;https://graph.org/{x[0]}&quot;
879                  remove(media)
880              except BaseException as er:
881                  LOGS.exception(er)
882                  return await conv.send_message(
883                      &quot;Terminated.&quot;,
884                      buttons=get_back_button(&quot;cbs_pmcstm&quot;),
885                  )
886          await setit(event, var, url)
887          await conv.send_message(
888              f&quot;{name} has been set.&quot;,
889              buttons=get_back_button(&quot;cbs_pmcstm&quot;),
890          )
891  @callback(&quot;delpmmed&quot;, owner=True)
892  async def dell(event):
893      try:
894          udB.del_key(&quot;PMPIC&quot;)
895          return await event.edit(
896              get_string(&quot;clst_5&quot;), buttons=get_back_button(&quot;cbs_pmcstm&quot;)
897          )
898      except BaseException as er:
899          LOGS.exception(er)
900          return await event.edit(
901              get_string(&quot;clst_4&quot;),
902              buttons=[[Button.inline(&quot;¬´ S·¥á·¥õ·¥õ…™…¥…¢s&quot;, data=&quot;setter&quot;)]],
903          )
904  @callback(&quot;apon&quot;, owner=True)
905  async def apon(event):
906      var = &quot;AUTOAPPROVE&quot;
907      await setit(event, var, &quot;True&quot;)
908      await event.edit(
909          &quot;Done!! AUTOAPPROVE  Started!!&quot;,
910          buttons=[[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_apauto&quot;)]],
911      )
912  @callback(&quot;apof&quot;, owner=True)
913  async def apof(event):
914      try:
915          udB.set_key(&quot;AUTOAPPROVE&quot;, &quot;False&quot;)
916          return await event.edit(
917              &quot;Done! AUTOAPPROVE Stopped!!&quot;,
918              buttons=[[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_apauto&quot;)]],
919          )
920      except BaseException as er:
921          LOGS.exception(er)
922          return await event.edit(
923              get_string(&quot;clst_4&quot;),
924              buttons=[[Button.inline(&quot;¬´ S·¥á·¥õ·¥õ…™…¥…¢s&quot;, data=&quot;setter&quot;)]],
925          )
926  @callback(&quot;pml&quot;, owner=True)
927  async def l_vcs(event):
928      BT = (
929          [Button.inline(&quot;PMLOGGER OFF&quot;, data=&quot;pmlogof&quot;)]
930          if udB.get_key(&quot;PMLOG&quot;)
931          else [Button.inline(&quot;PMLOGGER ON&quot;, data=&quot;pmlog&quot;)]
932      )
933      await event.edit(
934          &quot;PMLOGGER This Will Forward Ur Pm to Ur Private Group -&quot;,
935          buttons=[
936              BT,
937              [Button.inline(&quot;P·¥çL·¥è…¢…¢·¥á Ä G Ä·¥è·¥ú·¥ò&quot;, &quot;abs_pmlgg&quot;)],
938              [Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_pmcstm&quot;)],
939          ],
940      )
941  @callback(&quot;pmlog&quot;, owner=True)
942  async def pmlog(event):
943      await setit(event, &quot;PMLOG&quot;, &quot;True&quot;)
944      await event.edit(
945          &quot;Done!! PMLOGGER  Started!!&quot;,
946          buttons=[[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;pml&quot;)]],
947      )
948  @callback(&quot;pmlogof&quot;, owner=True)
949  async def pmlogof(event):
950      try:
951          udB.del_key(&quot;PMLOG&quot;)
952          return await event.edit(
953              &quot;Done! PMLOGGER Stopped!!&quot;,
954              buttons=[[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;pml&quot;)]],
955          )
956      except BaseException as er:
957          LOGS.exception(er)
958          return await event.edit(
959              get_string(&quot;clst_4&quot;),
960              buttons=[[Button.inline(&quot;¬´ S·¥á·¥õ·¥õ…™…¥…¢s&quot;, data=&quot;setter&quot;)]],
961          )
962  @callback(&quot;pmon&quot;, owner=True)
963  async def pmonn(event):
964      var = &quot;PMSETTING&quot;
965      await setit(event, var, &quot;True&quot;)
966      await event.edit(
967          &quot;Done! PMPermit has been turned on!!&quot;,
968          buttons=[[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_ppmset&quot;)]],
969      )
970  @callback(&quot;pmoff&quot;, owner=True)
971  async def pmofff(event):
972      var = &quot;PMSETTING&quot;
973      await setit(event, var, &quot;False&quot;)
974      await event.edit(
975          &quot;Done! PMPermit has been turned off!!&quot;,
976          buttons=[[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_ppmset&quot;)]],
977      )
978  @callback(&quot;botmew&quot;, owner=True)
979  async def hhh(e):
980      async with e.client.conversation(e.chat_id) as conv:
981          await conv.send_message(&quot;Send Any Media to keep at your Bot&#x27;s welcome &quot;)
982          msg = await conv.get_response()
983          if not msg.media or msg.text.startswith(&quot;/&quot;):
984              return await conv.send_message(
985                  &quot;Terminated!&quot;, buttons=get_back_button(&quot;cbs_chatbot&quot;)
986              )
987          udB.set_key(&quot;STARTMEDIA&quot;, msg.file.id)
988          await conv.send_message(&quot;Done!&quot;, buttons=get_back_button(&quot;cbs_chatbot&quot;))
989  @callback(&quot;botinfe&quot;, owner=True)
990  async def hhh(e):
991      async with e.client.conversation(e.chat_id) as conv:
992          await conv.send_message(
993              &quot;Send message to set to Display, when user Press Info button in Bot Welcome!\n\nsend `False` to completely remove that button..&quot;
994          )
995          msg = await conv.get_response()
996          if msg.media or msg.text.startswith(&quot;/&quot;):
997              return await conv.send_message(
998                  &quot;Terminated!&quot;, buttons=get_back_button(&quot;cbs_chatbot&quot;)
999              )
1000          udB.set_key(&quot;BOT_INFO_START&quot;, msg.text)
1001          await conv.send_message(&quot;Done!&quot;, buttons=get_back_button(&quot;cbs_chatbot&quot;))
1002  @callback(&quot;pmfs&quot;, owner=True)
1003  async def heheh(event):
1004      Ll = []
1005      err = &quot;&quot;
1006      async with event.client.conversation(event.chat_id) as conv:
1007          await conv.send_message(
1008              &quot;‚Ä¢ Send The Chat Id(s), which you want user to Join Before using Chat/Pm Bot\n\n‚Ä¢ Send /clear to disable PmBot Force sub..\n‚Ä¢ ‚Ä¢ Send /cancel to stop this process..&quot;
1009          )
1010          await conv.send_message(
1011              &quot;Example : \n`-1001234567\n-100778888`\n\nFor Multiple Chat(s).&quot;
1012          )
1013          try:
1014              msg = await conv.get_response()
1015          except AsyncTimeOut:
1016              return await conv.send_message(&quot;**‚Ä¢ TimeUp!**\nStart from /start back.&quot;)
1017          if not msg.text or msg.text.startswith(&quot;/&quot;):
1018              timyork = &quot;Cancelled!&quot;
1019              if msg.text == &quot;/clear&quot;:
1020                  udB.del_key(&quot;PMBOT_FSUB&quot;)
1021                  timyork = &quot;Done! Force Subscribe Stopped\nRestart your Bot!&quot;
1022              return await conv.send_message(
1023                  &quot;Cancelled!&quot;, buttons=get_back_button(&quot;cbs_chatbot&quot;)
1024              )
1025          for chat in msg.message.split(&quot;\n&quot;):
1026              if chat.startswith(&quot;-&quot;) or chat.isdigit():
1027                  chat = int(chat)
1028              try:
1029                  CHSJSHS = await event.client.get_entity(chat)
1030                  Ll.append(get_peer_id(CHSJSHS))
1031              except Exception as er:
1032                  err += f&quot;**{chat}** : {er}\n&quot;
1033          if err:
1034              return await conv.send_message(err)
1035          udB.set_key(&quot;PMBOT_FSUB&quot;, str(Ll))
1036          await conv.send_message(
1037              &quot;Done!\nRestart Your Bot.&quot;, buttons=get_back_button(&quot;cbs_chatbot&quot;)
1038          )
1039  @callback(&quot;bwel&quot;, owner=True)
1040  async def name(event):
1041      await event.delete()
1042      pru = event.sender_id
1043      var = &quot;STARTMSG&quot;
1044      name = &quot;Bot Welcome Message:&quot;
1045      async with event.client.conversation(pru) as conv:
1046          await conv.send_message(
1047              &quot;**BOT WELCOME MSG**\nEnter the msg which u want to show when someone start your assistant Bot.\nYou Can use `{me}` , `{mention}` Parameters Too\nUse /cancel to terminate the operation.&quot;,
1048          )
1049          response = conv.wait_event(events.NewMessage(chats=pru))
1050          response = await response
1051          themssg = response.message.message
1052          if themssg == &quot;/cancel&quot;:
1053              return await conv.send_message(
1054                  &quot;Cancelled!!&quot;,
1055                  buttons=get_back_button(&quot;cbs_chatbot&quot;),
1056              )
1057          await setit(event, var, themssg)
1058          await conv.send_message(
1059              f&quot;{name} changed to {themssg}&quot;,
1060              buttons=get_back_button(&quot;cbs_chatbot&quot;),
1061          )
1062  @callback(&quot;onchbot&quot;, owner=True)
1063  async def chon(event):
1064      var = &quot;PMBOT&quot;
1065      await setit(event, var, &quot;True&quot;)
1066      Loader(path=&quot;assistant/pmbot.py&quot;, key=&quot;PM Bot&quot;).load()
1067      if AST_PLUGINS.get(&quot;pmbot&quot;):
1068          for i, e in AST_PLUGINS[&quot;pmbot&quot;]:
1069              event.client.remove_event_handler(i)
1070          for i, e in AST_PLUGINS[&quot;pmbot&quot;]:
1071              event.client.add_event_handler(i, events.NewMessage(**e))
1072      await event.edit(
1073          &quot;Done! Now u Can Chat With People Via This Bot&quot;,
1074          buttons=[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_chatbot&quot;)],
1075      )
1076  @callback(&quot;ofchbot&quot;, owner=True)
1077  async def chon(event):
1078      var = &quot;PMBOT&quot;
1079      await setit(event, var, &quot;False&quot;)
1080      if AST_PLUGINS.get(&quot;pmbot&quot;):
1081          for i, e in AST_PLUGINS[&quot;pmbot&quot;]:
1082              event.client.remove_event_handler(i)
1083      await event.edit(
1084          &quot;Done! Chat People Via This Bot Stopped.&quot;,
1085          buttons=[Button.inline(&quot;¬´ B·¥Ä·¥Ñ·¥ã&quot;, data=&quot;cbs_chatbot&quot;)],
1086      )
1087  @callback(&quot;inli_pic&quot;, owner=True)
1088  async def media(event):
1089      await event.delete()
1090      pru = event.sender_id
1091      var = &quot;INLINE_PIC&quot;
1092      name = &quot;Inline Media&quot;
1093      async with event.client.conversation(pru) as conv:
1094          await conv.send_message(
1095              &quot;**Inline Media**\nSend me a pic/gif/ or link  to set as inline media.\n\nUse /cancel to terminate the operation.&quot;,
1096          )
1097          response = await conv.get_response()
1098          try:
1099              themssg = response.message
1100              if themssg == &quot;/cancel&quot;:
1101                  return await conv.send_message(
1102                      &quot;Operation cancelled!!&quot;,
1103                      buttons=get_back_button(&quot;setter&quot;),
1104                  )
1105          except BaseException as er:
1106              LOGS.exception(er)
1107          media = await event.client.download_media(response, &quot;inlpic&quot;)
1108          if (
1109              not (response.text).startswith(&quot;/&quot;)
1110              and response.text != &quot;&quot;
1111              and (not response.media or isinstance(response.media, MessageMediaWebPage))
1112          ):
1113              url = text_to_url(response)
1114          else:
1115              try:
1116                  x = upl(media)
1117                  url = f&quot;https://graph.org/{x[0]}&quot;
1118                  remove(media)
1119              except BaseException as er:
1120                  LOGS.exception(er)
1121                  return await conv.send_message(
1122                      &quot;Terminated.&quot;,
1123                      buttons=get_back_button(&quot;setter&quot;),
1124                  )
1125          await setit(event, var, url)
1126          await conv.send_message(
1127              f&quot;{name} has been set.&quot;,
1128              buttons=get_back_button(&quot;setter&quot;),
1129          )
1130  FD_MEDIA = {}
1131  @callback(re.compile(&quot;fd(.*)&quot;), owner=True)
1132  async def fdroid_dler(event):
1133      uri = event.data_match.group(1).decode(&quot;utf-8&quot;)
1134      if FD_MEDIA.get(uri):
1135          return await event.edit(file=FD_MEDIA[uri])
1136      await event.answer(&quot;‚Ä¢ Starting Download ‚Ä¢&quot;, alert=True)
1137      await event.edit(&quot;‚Ä¢ Downloading.. ‚Ä¢&quot;)
1138      URL = f&quot;https://f-droid.org/packages/{uri}&quot;
1139      conte = await async_searcher(URL, re_content=True)
1140      BSC = bs(conte, &quot;html.parser&quot;, from_encoding=&quot;utf-8&quot;)
1141      dl_ = BSC.find(&quot;p&quot;, &quot;package-version-download&quot;).find(&quot;a&quot;)[&quot;href&quot;]
1142      title = BSC.find(&quot;h3&quot;, &quot;package-name&quot;).text.strip()
1143      thumb = BSC.find(&quot;img&quot;, &quot;package-icon&quot;)[&quot;src&quot;]
1144      if thumb.startswith(&quot;/&quot;):
1145          thumb = f&quot;https://f-droid.org{thumb}&quot;
<span onclick='openModal()' class='match'>1146      thumb, _ = await fast_download(thumb, filename=f&quot;{uri}.png&quot;)
1147      s_time = time.time()
</span>1148      file, _ = await fast_download(
1149          dl_,
1150          filename=f&quot;{title}.apk&quot;,
1151          progress_callback=lambda d, t: asyncio.get_event_loop().create_task(
1152              progress(
1153                  d,
1154                  t,
1155                  event,
1156                  s_time,
1157                  &quot;Downloading...&quot;,
1158              )
1159          ),
1160      )
1161      time.time()
1162      n_file = await event.client.fast_uploader(
1163          file, show_progress=True, event=event, message=&quot;Uploading...&quot;, to_delete=True
1164      )
1165      buttons = Button.switch_inline(&quot;Search Back&quot;, query=&quot;fdroid&quot;, same_peer=True)
1166      try:
1167          msg = await event.edit(
1168              f&quot;**‚Ä¢ [{title}]({URL}) ‚Ä¢**&quot;, file=n_file, thumb=thumb, buttons=buttons
1169          )
1170      except Exception as er:
1171          LOGS.exception(er)
1172          try:
1173              msg = await event.client.edit_message(
1174                  await event.get_input_chat(),
1175                  event.message_id,
1176                  f&quot;**‚Ä¢ [{title}]({URL}) ‚Ä¢**&quot;,
1177                  buttons=buttons,
1178                  thumb=thumb,
1179                  file=n_file,
1180              )
1181          except Exception as er:
1182              os.remove(thumb)
1183              LOGS.exception(er)
1184              return await event.edit(f&quot;**ERROR**: `{er}`&quot;, buttons=buttons)
1185      if msg and hasattr(msg, &quot;media&quot;):
1186          FD_MEDIA.update({uri: msg.media})
1187      os.remove(thumb)
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-search.py</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-callbackstuffs.py</div>
                </div>
                <div class="column column_space"><pre><code>143      song, _ = await fast_download(url, filename=f&quot;{title}.m4a&quot;)
144      thumb, _ = await fast_download(img, filename=f&quot;{title}.jpg&quot;)
</pre></code></div>
                <div class="column column_space"><pre><code>1146      thumb, _ = await fast_download(thumb, filename=f&quot;{uri}.png&quot;)
1147      s_time = time.time()
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    