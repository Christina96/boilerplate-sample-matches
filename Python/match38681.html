<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_layman.py &amp; test_jboss7.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_layman.py &amp; test_jboss7.py
      </h3>
<h1 align="center">
        6.8%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_layman.py (31.034483%)<th>test_jboss7.py (3.8461537%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(22-25)<td><a href="#" name="0">(689-703)</a><td align="center"><font color="#ff0000">15</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(42-44)<td><a href="#" name="1">(470-481)</a><td align="center"><font color="#cc0000">12</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_layman.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import pytest
2 import salt.states.layman as layman
3 from tests.support.mock import MagicMock, patch
4 @pytest.fixture
5 def configure_loader_modules():
6     return {layman: {}}
7 def test_present():
8     name = "sunrise"
9 <a name="0"></a>
10     ret = {"name": name, "result": True, "comment": "", "changes": {}}
11     mock <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>= MagicMock(side_effect=[[name], []])
12     with patch.dict(layman.__salt__, {"layman.list_local": mock}):
13         comt = "Overlay {} already present".format(name)
14         ret.update({"comment"</b></font>: comt})
15         assert layman.present(name) == ret
16         with patch.dict(layman.__opts__, {"test": True}):
17             comt = "Overlay {} is set to be added".format(name)
18             ret.update({"comment": comt, "result": None})
19             assert layman.present(name) == ret
20 def test_absent():
21     name = "sunrise"
22 <a name="1"></a>
23     ret = {"name": name, "result": True, "comment": "", "changes": {}}
24     mock <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>= MagicMock(side_effect=[[], [name]])
25     with patch.dict(layman.__salt__, {"layman.list_local": mock}):
26         comt = "Overlay {} already absent".format(</b></font>name)
27         ret.update({"comment": comt})
28         assert layman.absent(name) == ret
29         with patch.dict(layman.__opts__, {"test": True}):
30             comt = "Overlay {} is set to be deleted".format(name)
31             ret.update({"comment": comt, "result": None})
32             assert layman.absent(name) == ret
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_jboss7.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import salt.states.jboss7 as jboss7
2 from salt.exceptions import CommandExecutionError
3 from tests.support.mixins import LoaderModuleMockMixin
4 from tests.support.mock import MagicMock, patch
5 from tests.support.unit import TestCase
6 class JBoss7StateTestCase(TestCase, LoaderModuleMockMixin):
7     def setup_loader_modules(self):
8         return {
9             jboss7: {
10                 "__salt__": {
11                     "jboss7.read_datasource": MagicMock(),
12                     "jboss7.create_datasource": MagicMock(),
13                     "jboss7.update_datasource": MagicMock(),
14                     "jboss7.remove_datasource": MagicMock(),
15                     "jboss7.read_simple_binding": MagicMock(),
16                     "jboss7.create_simple_binding": MagicMock(),
17                     "jboss7.update_simple_binding": MagicMock(),
18                     "jboss7.undeploy": MagicMock(),
19                     "jboss7.deploy": MagicMock,
20                     "file.get_managed": MagicMock,
21                     "file.manage_file": MagicMock,
22                     "jboss7.list_deployments": MagicMock,
23                 },
24                 "__env__": "base",
25             }
26         }
27     def test_should_not_redeploy_unchanged(self):
28         parameters = {
29             "target_file": "some_artifact",
30             "undeploy_force": False,
31             "undeploy": "some_artifact",
32             "source": "some_artifact_on_master",
33         }
34         jboss_conf = {"cli_path": "somewhere", "controller": "some_controller"}
35         def list_deployments(jboss_config):
36             return ["some_artifact"]
37         def file_get_managed(
38             name,
39             template,
40             source,
41             source_hash,
42             source_hash_name,
43             user,
44             group,
45             mode,
46             attrs,
47             saltenv,
48             context,
49             defaults,
50             skip_verify,
51             kwargs,
52         ):
53             return "sfn", "hash", ""
54         def file_manage_file(
55             name,
56             sfn,
57             ret,
58             source,
59             source_sum,
60             user,
61             group,
62             mode,
63             attrs,
64             saltenv,
65             backup,
66             makedirs,
67             template,
68             show_diff,
69             contents,
70             dir_mode,
71         ):
72             return {"result": True, "changes": False}
73         jboss7_undeploy_mock = MagicMock()
74         jboss7_deploy_mock = MagicMock()
75         file_get_managed = MagicMock(side_effect=file_get_managed)
76         file_manage_file = MagicMock(side_effect=file_manage_file)
77         list_deployments_mock = MagicMock(side_effect=list_deployments)
78         with patch.dict(
79             jboss7.__salt__,
80             {
81                 "jboss7.undeploy": jboss7_undeploy_mock,
82                 "jboss7.deploy": jboss7_deploy_mock,
83                 "file.get_managed": file_get_managed,
84                 "file.manage_file": file_manage_file,
85                 "jboss7.list_deployments": list_deployments_mock,
86             },
87         ):
88             result = jboss7.deployed(
89                 name="unchanged", jboss_config=jboss_conf, salt_source=parameters
90             )
91             self.assertFalse(jboss7_undeploy_mock.called)
92             self.assertFalse(jboss7_deploy_mock.called)
93     def test_should_redeploy_changed(self):
94         parameters = {
95             "target_file": "some_artifact",
96             "undeploy_force": False,
97             "undeploy": "some_artifact",
98             "source": "some_artifact_on_master",
99         }
100         jboss_conf = {"cli_path": "somewhere", "controller": "some_controller"}
101         def list_deployments(jboss_config):
102             return ["some_artifact"]
103         def file_get_managed(
104             name,
105             template,
106             source,
107             source_hash,
108             source_hash_name,
109             user,
110             group,
111             mode,
112             attrs,
113             saltenv,
114             context,
115             defaults,
116             skip_verify,
117             kwargs,
118         ):
119             return "sfn", "hash", ""
120         def file_manage_file(
121             name,
122             sfn,
123             ret,
124             source,
125             source_sum,
126             user,
127             group,
128             mode,
129             attrs,
130             saltenv,
131             backup,
132             makedirs,
133             template,
134             show_diff,
135             contents,
136             dir_mode,
137         ):
138             return {"result": True, "changes": True}
139         jboss7_undeploy_mock = MagicMock()
140         jboss7_deploy_mock = MagicMock()
141         file_get_managed = MagicMock(side_effect=file_get_managed)
142         file_manage_file = MagicMock(side_effect=file_manage_file)
143         list_deployments_mock = MagicMock(side_effect=list_deployments)
144         with patch.dict(
145             jboss7.__salt__,
146             {
147                 "jboss7.undeploy": jboss7_undeploy_mock,
148                 "jboss7.deploy": jboss7_deploy_mock,
149                 "file.get_managed": file_get_managed,
150                 "file.manage_file": file_manage_file,
151                 "jboss7.list_deployments": list_deployments_mock,
152             },
153         ):
154             result = jboss7.deployed(
155                 name="unchanged", jboss_config=jboss_conf, salt_source=parameters
156             )
157             self.assertTrue(jboss7_undeploy_mock.called)
158             self.assertTrue(jboss7_deploy_mock.called)
159     def test_should_deploy_different_artifact(self):
160         parameters = {
161             "target_file": "some_artifact",
162             "undeploy_force": False,
163             "undeploy": "some_artifact",
164             "source": "some_artifact_on_master",
165         }
166         jboss_conf = {"cli_path": "somewhere", "controller": "some_controller"}
167         def list_deployments(jboss_config):
168             return ["some_other_artifact"]
169         def file_get_managed(
170             name,
171             template,
172             source,
173             source_hash,
174             source_hash_name,
175             user,
176             group,
177             mode,
178             attrs,
179             saltenv,
180             context,
181             defaults,
182             skip_verify,
183             kwargs,
184         ):
185             return "sfn", "hash", ""
186         def file_manage_file(
187             name,
188             sfn,
189             ret,
190             source,
191             source_sum,
192             user,
193             group,
194             mode,
195             attrs,
196             saltenv,
197             backup,
198             makedirs,
199             template,
200             show_diff,
201             contents,
202             dir_mode,
203         ):
204             return {"result": True, "changes": False}
205         jboss7_undeploy_mock = MagicMock()
206         jboss7_deploy_mock = MagicMock()
207         file_get_managed = MagicMock(side_effect=file_get_managed)
208         file_manage_file = MagicMock(side_effect=file_manage_file)
209         list_deployments_mock = MagicMock(side_effect=list_deployments)
210         with patch.dict(
211             jboss7.__salt__,
212             {
213                 "jboss7.undeploy": jboss7_undeploy_mock,
214                 "jboss7.deploy": jboss7_deploy_mock,
215                 "file.get_managed": file_get_managed,
216                 "file.manage_file": file_manage_file,
217                 "jboss7.list_deployments": list_deployments_mock,
218             },
219         ):
220             result = jboss7.deployed(
221                 name="unchanged", jboss_config=jboss_conf, salt_source=parameters
222             )
223             self.assertFalse(jboss7_undeploy_mock.called)
224             self.assertTrue(jboss7_deploy_mock.called)
225     def test_should_redploy_undeploy_force(self):
226         parameters = {
227             "target_file": "some_artifact",
228             "undeploy_force": True,
229             "undeploy": "some_artifact",
230             "source": "some_artifact_on_master",
231         }
232         jboss_conf = {"cli_path": "somewhere", "controller": "some_controller"}
233         def list_deployments(jboss_config):
234             return ["some_artifact"]
235         def file_get_managed(
236             name,
237             template,
238             source,
239             source_hash,
240             source_hash_name,
241             user,
242             group,
243             mode,
244             attrs,
245             saltenv,
246             context,
247             defaults,
248             skip_verify,
249             kwargs,
250         ):
251             return "sfn", "hash", ""
252         def file_manage_file(
253             name,
254             sfn,
255             ret,
256             source,
257             source_sum,
258             user,
259             group,
260             mode,
261             attrs,
262             saltenv,
263             backup,
264             makedirs,
265             template,
266             show_diff,
267             contents,
268             dir_mode,
269         ):
270             return {"result": True, "changes": False}
271         jboss7_undeploy_mock = MagicMock()
272         jboss7_deploy_mock = MagicMock()
273         file_get_managed = MagicMock(side_effect=file_get_managed)
274         file_manage_file = MagicMock(side_effect=file_manage_file)
275         list_deployments_mock = MagicMock(side_effect=list_deployments)
276         with patch.dict(
277             jboss7.__salt__,
278             {
279                 "jboss7.undeploy": jboss7_undeploy_mock,
280                 "jboss7.deploy": jboss7_deploy_mock,
281                 "file.get_managed": file_get_managed,
282                 "file.manage_file": file_manage_file,
283                 "jboss7.list_deployments": list_deployments_mock,
284             },
285         ):
286             result = jboss7.deployed(
287                 name="unchanged", jboss_config=jboss_conf, salt_source=parameters
288             )
289             self.assertTrue(jboss7_undeploy_mock.called)
290             self.assertTrue(jboss7_deploy_mock.called)
291     def test_should_create_new_datasource_if_not_exists(self):
292         datasource_properties = {"connection-url": "jdbc:/old-connection-url"}
293         ds_status = {"created": False}
294         def read_func(jboss_config, name, profile):
295             if ds_status["created"]:
296                 return {"success": True, "result": datasource_properties}
297             else:
298                 return {"success": False, "err_code": "JBAS014807"}
299         def create_func(jboss_config, name, datasource_properties, profile):
300             ds_status["created"] = True
301             return {"success": True}
302         read_mock = MagicMock(side_effect=read_func)
303         create_mock = MagicMock(side_effect=create_func)
304         update_mock = MagicMock()
305         with patch.dict(
306             jboss7.__salt__,
307             {
308                 "jboss7.read_datasource": read_mock,
309                 "jboss7.create_datasource": create_mock,
310                 "jboss7.update_datasource": update_mock,
311             },
312         ):
313             result = jboss7.datasource_exists(
314                 name="appDS",
315                 jboss_config={},
316                 datasource_properties=datasource_properties,
317                 profile=None,
318             )
319             create_mock.assert_called_with(
320                 name="appDS",
321                 jboss_config={},
322                 datasource_properties=datasource_properties,
323                 profile=None,
324             )
325             self.assertFalse(update_mock.called)
326             self.assertEqual(result["comment"], "Datasource created.")
327     def test_should_update_the_datasource_if_exists(self):
328         ds_status = {"updated": False}
329         def read_func(jboss_config, name, profile):
330             if ds_status["updated"]:
331                 return {
332                     "success": True,
333                     "result": {"connection-url": "jdbc:/new-connection-url"},
334                 }
335             else:
336                 return {
337                     "success": True,
338                     "result": {"connection-url": "jdbc:/old-connection-url"},
339                 }
340         def update_func(jboss_config, name, new_properties, profile):
341             ds_status["updated"] = True
342             return {"success": True}
343         read_mock = MagicMock(side_effect=read_func)
344         create_mock = MagicMock()
345         update_mock = MagicMock(side_effect=update_func)
346         with patch.dict(
347             jboss7.__salt__,
348             {
349                 "jboss7.read_datasource": read_mock,
350                 "jboss7.create_datasource": create_mock,
351                 "jboss7.update_datasource": update_mock,
352             },
353         ):
354             result = jboss7.datasource_exists(
355                 name="appDS",
356                 jboss_config={},
357                 datasource_properties={"connection-url": "jdbc:/new-connection-url"},
358                 profile=None,
359             )
360             update_mock.assert_called_with(
361                 name="appDS",
362                 jboss_config={},
363                 new_properties={"connection-url": "jdbc:/new-connection-url"},
364                 profile=None,
365             )
366             self.assertTrue(read_mock.called)
367             self.assertEqual(result["comment"], "Datasource updated.")
368     def test_should_recreate_the_datasource_if_specified(self):
369         read_mock = MagicMock(
370             return_value={
371                 "success": True,
372                 "result": {"connection-url": "jdbc:/same-connection-url"},
373             }
374         )
375         create_mock = MagicMock(return_value={"success": True})
376         remove_mock = MagicMock(return_value={"success": True})
377         update_mock = MagicMock()
378         with patch.dict(
379             jboss7.__salt__,
380             {
381                 "jboss7.read_datasource": read_mock,
382                 "jboss7.create_datasource": create_mock,
383                 "jboss7.remove_datasource": remove_mock,
384                 "jboss7.update_datasource": update_mock,
385             },
386         ):
387             result = jboss7.datasource_exists(
388                 name="appDS",
389                 jboss_config={},
390                 datasource_properties={"connection-url": "jdbc:/same-connection-url"},
391                 recreate=True,
392             )
393             remove_mock.assert_called_with(name="appDS", jboss_config={}, profile=None)
394             create_mock.assert_called_with(
395                 name="appDS",
396                 jboss_config={},
397                 datasource_properties={"connection-url": "jdbc:/same-connection-url"},
398                 profile=None,
399             )
400             self.assertEqual(result["changes"]["removed"], "appDS")
401             self.assertEqual(result["changes"]["created"], "appDS")
402     def test_should_inform_if_the_datasource_has_not_changed(self):
403         read_mock = MagicMock(
404             return_value={
405                 "success": True,
406                 "result": {"connection-url": "jdbc:/same-connection-url"},
407             }
408 <a name="1"></a>        )
409         create_mock = MagicMock()
410         remove_mock = MagicMock()
411         update_mock <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>= MagicMock(return_value={"success": True})
412         with patch.dict(
413             jboss7.__salt__,
414             {
415                 "jboss7.read_datasource": read_mock,
416                 "jboss7.create_datasource": create_mock,
417                 "jboss7.remove_datasource": remove_mock,
418                 "jboss7.update_datasource": update_mock,
419             },
420         ):
421             result = jboss7.datasource_exists(</b></font>
422                 name="appDS",
423                 jboss_config={},
424                 datasource_properties={"connection-url": "jdbc:/old-connection-url"},
425             )
426             update_mock.assert_called_with(
427                 name="appDS",
428                 jboss_config={},
429                 new_properties={"connection-url": "jdbc:/old-connection-url"},
430                 profile=None,
431             )
432             self.assertFalse(create_mock.called)
433             self.assertEqual(result["comment"], "Datasource not changed.")
434     def test_should_create_binding_if_not_exists(self):
435         binding_status = {"created": False}
436         def read_func(jboss_config, binding_name, profile):
437             if binding_status["created"]:
438                 return {"success": True, "result": {"value": "DEV"}}
439             else:
440                 return {"success": False, "err_code": "JBAS014807"}
441         def create_func(jboss_config, binding_name, value, profile):
442             binding_status["created"] = True
443             return {"success": True}
444         read_mock = MagicMock(side_effect=read_func)
445         create_mock = MagicMock(side_effect=create_func)
446         update_mock = MagicMock()
447         with patch.dict(
448             jboss7.__salt__,
449             {
450                 "jboss7.read_simple_binding": read_mock,
451                 "jboss7.create_simple_binding": create_mock,
452                 "jboss7.update_simple_binding": update_mock,
453             },
454         ):
455             result = jboss7.bindings_exist(
456                 name="bindings", jboss_config={}, bindings={"env": "DEV"}, profile=None
457             )
458             create_mock.assert_called_with(
459                 jboss_config={}, binding_name="env", value="DEV", profile=None
460             )
461             self.assertEqual(update_mock.call_count, 0)
462             self.assertEqual(result["changes"], {"added": "env:DEV\n"})
463             self.assertEqual(result["comment"], "Bindings changed.")
464     def test_should_update_bindings_if_exists_and_different(self):
465         binding_status = {"updated": False}
466         def read_func(jboss_config, binding_name, profile):
467             if binding_status["updated"]:
468                 return {"success": True, "result": {"value": "DEV2"}}
469             else:
470                 return {"success": True, "result": {"value": "DEV"}}
471         def update_func(jboss_config, binding_name, value, profile):
472             binding_status["updated"] = True
473             return {"success": True}
474         read_mock = MagicMock(side_effect=read_func)
475         create_mock = MagicMock()
476         update_mock = MagicMock(side_effect=update_func)
477         with patch.dict(
478             jboss7.__salt__,
479             {
480                 "jboss7.read_simple_binding": read_mock,
481                 "jboss7.create_simple_binding": create_mock,
482                 "jboss7.update_simple_binding": update_mock,
483             },
484         ):
485             result = jboss7.bindings_exist(
486                 name="bindings", jboss_config={}, bindings={"env": "DEV2"}, profile=None
487             )
488             update_mock.assert_called_with(
489                 jboss_config={}, binding_name="env", value="DEV2", profile=None
490             )
491             self.assertEqual(create_mock.call_count, 0)
492             self.assertEqual(result["changes"], {"changed": "env:DEV-&gt;DEV2\n"})
493             self.assertEqual(result["comment"], "Bindings changed.")
494     def test_should_not_update_bindings_if_same(self):
495         read_mock = MagicMock(
496             return_value={"success": True, "result": {"value": "DEV2"}}
497         )
498         create_mock = MagicMock()
499         update_mock = MagicMock()
500         with patch.dict(
501             jboss7.__salt__,
502             {
503                 "jboss7.read_simple_binding": read_mock,
504                 "jboss7.create_simple_binding": create_mock,
505                 "jboss7.update_simple_binding": update_mock,
506             },
507         ):
508             result = jboss7.bindings_exist(
509                 name="bindings", jboss_config={}, bindings={"env": "DEV2"}
510             )
511             self.assertEqual(create_mock.call_count, 0)
512             self.assertEqual(update_mock.call_count, 0)
513             self.assertEqual(result["changes"], {})
514             self.assertEqual(result["comment"], "Bindings not changed.")
515     def test_should_raise_exception_if_cannot_create_binding(self):
516         def read_func(jboss_config, binding_name, profile):
517             return {"success": False, "err_code": "JBAS014807"}
518         def create_func(jboss_config, binding_name, value, profile):
519             return {"success": False, "failure-description": "Incorrect binding name."}
520         read_mock = MagicMock(side_effect=read_func)
521         create_mock = MagicMock(side_effect=create_func)
522         update_mock = MagicMock()
523         with patch.dict(
524             jboss7.__salt__,
525             {
526                 "jboss7.read_simple_binding": read_mock,
527                 "jboss7.create_simple_binding": create_mock,
528                 "jboss7.update_simple_binding": update_mock,
529             },
530         ):
531             try:
532                 jboss7.bindings_exist(
533                     name="bindings",
534                     jboss_config={},
535                     bindings={"env": "DEV2"},
536                     profile=None,
537                 )
538                 self.fail("An exception should be thrown")
539             except CommandExecutionError as e:
540                 self.assertEqual(str(e), "Incorrect binding name.")
541     def test_should_raise_exception_if_cannot_update_binding(self):
542         def read_func(jboss_config, binding_name, profile):
543             return {"success": True, "result": {"value": "DEV"}}
544         def update_func(jboss_config, binding_name, value, profile):
545             return {"success": False, "failure-description": "Incorrect binding name."}
546         read_mock = MagicMock(side_effect=read_func)
547         create_mock = MagicMock()
548         update_mock = MagicMock(side_effect=update_func)
549         with patch.dict(
550             jboss7.__salt__,
551             {
552                 "jboss7.read_simple_binding": read_mock,
553                 "jboss7.create_simple_binding": create_mock,
554                 "jboss7.update_simple_binding": update_mock,
555             },
556         ):
557             try:
558                 jboss7.bindings_exist(
559                     name="bindings",
560                     jboss_config={},
561                     bindings={"env": "!@#!///some weird value"},
562                     profile=None,
563                 )
564                 self.fail("An exception should be thrown")
565             except CommandExecutionError as e:
566                 self.assertEqual(str(e), "Incorrect binding name.")
567     def test_datasource_exist_create_datasource_good_code(self):
568         jboss_config = {
569             "cli_path": "/home/ch44d/Desktop/wildfly-18.0.0.Final/bin/jboss-cli.sh",
570             "controller": "127.0.0.1: 9990",
571             "cli_user": "user",
572             "cli_password": "user",
573         }
574         datasource_properties = {
575             "driver - name": "h2",
576             "connection - url": "jdbc:sqlserver://127.0.0.1:1433;DatabaseName=test_s2",
577             "jndi - name": (
578                 "java:/home/ch44d/Desktop/sqljdbc_7.4/enu/mssql-jdbc-7.4.1.jre8.jar"
579             ),
580             "user - name": "user",
581             "password": "user",
582             "use - java - context": True,
583         }
584         read_datasource = MagicMock(
585             return_value={"success": False, "err_code": "WFLYCTL0216"}
586 <a name="0"></a>        )
587         error_msg = "Error: -1"
588         create_datasource <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>= MagicMock(
589             return_value={"success": False, "stdout": error_msg}
590         )
591         with patch.dict(
592             jboss7.__salt__,
593             {
594                 "jboss7.read_datasource": read_datasource,
595                 "jboss7.create_datasource": create_datasource,
596             },
597         ):
598             ret = jboss7.datasource_exists("SQL", jboss_config, datasource_properties)
599             self.assertTrue("result" in ret)
600             self.</b></font>assertFalse(ret["result"])
601             self.assertTrue("comment" in ret)
602             self.assertTrue(error_msg in ret["comment"])
603             read_datasource.assert_called_once()
604             create_datasource.assert_called_once()
605     def test_datasource_exist_create_datasource_bad_code(self):
606         jboss_config = {
607             "cli_path": "/home/ch44d/Desktop/wildfly-18.0.0.Final/bin/jboss-cli.sh",
608             "controller": "127.0.0.1: 9990",
609             "cli_user": "user",
610             "cli_password": "user",
611         }
612         datasource_properties = {
613             "driver - name": "h2",
614             "connection - url": "jdbc:sqlserver://127.0.0.1:1433;DatabaseName=test_s2",
615             "jndi - name": (
616                 "java:/home/ch44d/Desktop/sqljdbc_7.4/enu/mssql-jdbc-7.4.1.jre8.jar"
617             ),
618             "user - name": "user",
619             "password": "user",
620             "use - java - context": True,
621         }
622         read_datasource = MagicMock(
623             return_value={
624                 "success": False,
625                 "err_code": "WFLYCTL0217",
626                 "failure-description": "Something happened",
627             }
628         )
629         with patch.dict(jboss7.__salt__, {"jboss7.read_datasource": read_datasource}):
630             self.assertRaises(
631                 CommandExecutionError,
632                 jboss7.datasource_exists,
633                 "SQL",
634                 jboss_config,
635                 datasource_properties,
636             )
637             read_datasource.assert_called_once()
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
