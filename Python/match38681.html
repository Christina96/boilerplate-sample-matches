<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_layman.py &amp; test_jboss7.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_layman.py &amp; test_jboss7.py
      </h3>
<h1 align="center">
        6.8%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_layman.py (31.034483%)<th>test_jboss7.py (3.8461537%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(22-25)<td><a href="#" name="0">(689-703)</a><td align="center"><font color="#ff0000">15</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(42-44)<td><a href="#" name="1">(470-481)</a><td align="center"><font color="#cc0000">12</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_layman.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
"""
    :codeauthor: Jayesh Kariya &lt;jayeshk@saltstack.com&gt;
"""
import pytest
import salt.states.layman as layman
from tests.support.mock import MagicMock, patch
@pytest.fixture
def configure_loader_modules():
    return {layman: {}}
def test_present():
    """
    Test to verify that the overlay is present.
    """
    name = "sunrise"
    ret = {"name": name, "result": True, "comment": "", "changes": {}}
    mock <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>= MagicMock(side_effect=[[name], []])
    with patch.dict(layman.__salt__, {"layman.list_local": mock}):
        comt = "Overlay {} already present".format(name)
        ret.update({"comment"</b></font>: comt})
        assert layman.present(name) == ret
        with patch.dict(layman.__opts__, {"test": True}):
            comt = "Overlay {} is set to be added".format(name)
            ret.update({"comment": comt, "result": None})
            assert layman.present(name) == ret
def test_absent():
    """
    Test to verify that the overlay is absent.
    """
    name = "sunrise"
    ret = {"name": name, "result": True, "comment": "", "changes": {}}
    mock <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>= MagicMock(side_effect=[[], [name]])
    with patch.dict(layman.__salt__, {"layman.list_local": mock}):
        comt = "Overlay {} already absent".format(</b></font>name)
        ret.update({"comment": comt})
        assert layman.absent(name) == ret
        with patch.dict(layman.__opts__, {"test": True}):
            comt = "Overlay {} is set to be deleted".format(name)
            ret.update({"comment": comt, "result": None})
            assert layman.absent(name) == ret
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_jboss7.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
import salt.states.jboss7 as jboss7
from salt.exceptions import CommandExecutionError
from tests.support.mixins import LoaderModuleMockMixin
from tests.support.mock import MagicMock, patch
from tests.support.unit import TestCase
class JBoss7StateTestCase(TestCase, LoaderModuleMockMixin):
    def setup_loader_modules(self):
        return {
            jboss7: {
                "__salt__": {
                    "jboss7.read_datasource": MagicMock(),
                    "jboss7.create_datasource": MagicMock(),
                    "jboss7.update_datasource": MagicMock(),
                    "jboss7.remove_datasource": MagicMock(),
                    "jboss7.read_simple_binding": MagicMock(),
                    "jboss7.create_simple_binding": MagicMock(),
                    "jboss7.update_simple_binding": MagicMock(),
                    "jboss7.undeploy": MagicMock(),
                    "jboss7.deploy": MagicMock,
                    "file.get_managed": MagicMock,
                    "file.manage_file": MagicMock,
                    "jboss7.list_deployments": MagicMock,
                },
                "__env__": "base",
            }
        }
    def test_should_not_redeploy_unchanged(self):
        parameters = {
            "target_file": "some_artifact",
            "undeploy_force": False,
            "undeploy": "some_artifact",
            "source": "some_artifact_on_master",
        }
        jboss_conf = {"cli_path": "somewhere", "controller": "some_controller"}
        def list_deployments(jboss_config):
            return ["some_artifact"]
        def file_get_managed(
            name,
            template,
            source,
            source_hash,
            source_hash_name,
            user,
            group,
            mode,
            attrs,
            saltenv,
            context,
            defaults,
            skip_verify,
            kwargs,
        ):
            return "sfn", "hash", ""
        def file_manage_file(
            name,
            sfn,
            ret,
            source,
            source_sum,
            user,
            group,
            mode,
            attrs,
            saltenv,
            backup,
            makedirs,
            template,
            show_diff,
            contents,
            dir_mode,
        ):
            return {"result": True, "changes": False}
        jboss7_undeploy_mock = MagicMock()
        jboss7_deploy_mock = MagicMock()
        file_get_managed = MagicMock(side_effect=file_get_managed)
        file_manage_file = MagicMock(side_effect=file_manage_file)
        list_deployments_mock = MagicMock(side_effect=list_deployments)
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.undeploy": jboss7_undeploy_mock,
                "jboss7.deploy": jboss7_deploy_mock,
                "file.get_managed": file_get_managed,
                "file.manage_file": file_manage_file,
                "jboss7.list_deployments": list_deployments_mock,
            },
        ):
            result = jboss7.deployed(
                name="unchanged", jboss_config=jboss_conf, salt_source=parameters
            )
            self.assertFalse(jboss7_undeploy_mock.called)
            self.assertFalse(jboss7_deploy_mock.called)
    def test_should_redeploy_changed(self):
        parameters = {
            "target_file": "some_artifact",
            "undeploy_force": False,
            "undeploy": "some_artifact",
            "source": "some_artifact_on_master",
        }
        jboss_conf = {"cli_path": "somewhere", "controller": "some_controller"}
        def list_deployments(jboss_config):
            return ["some_artifact"]
        def file_get_managed(
            name,
            template,
            source,
            source_hash,
            source_hash_name,
            user,
            group,
            mode,
            attrs,
            saltenv,
            context,
            defaults,
            skip_verify,
            kwargs,
        ):
            return "sfn", "hash", ""
        def file_manage_file(
            name,
            sfn,
            ret,
            source,
            source_sum,
            user,
            group,
            mode,
            attrs,
            saltenv,
            backup,
            makedirs,
            template,
            show_diff,
            contents,
            dir_mode,
        ):
            return {"result": True, "changes": True}
        jboss7_undeploy_mock = MagicMock()
        jboss7_deploy_mock = MagicMock()
        file_get_managed = MagicMock(side_effect=file_get_managed)
        file_manage_file = MagicMock(side_effect=file_manage_file)
        list_deployments_mock = MagicMock(side_effect=list_deployments)
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.undeploy": jboss7_undeploy_mock,
                "jboss7.deploy": jboss7_deploy_mock,
                "file.get_managed": file_get_managed,
                "file.manage_file": file_manage_file,
                "jboss7.list_deployments": list_deployments_mock,
            },
        ):
            result = jboss7.deployed(
                name="unchanged", jboss_config=jboss_conf, salt_source=parameters
            )
            self.assertTrue(jboss7_undeploy_mock.called)
            self.assertTrue(jboss7_deploy_mock.called)
    def test_should_deploy_different_artifact(self):
        parameters = {
            "target_file": "some_artifact",
            "undeploy_force": False,
            "undeploy": "some_artifact",
            "source": "some_artifact_on_master",
        }
        jboss_conf = {"cli_path": "somewhere", "controller": "some_controller"}
        def list_deployments(jboss_config):
            return ["some_other_artifact"]
        def file_get_managed(
            name,
            template,
            source,
            source_hash,
            source_hash_name,
            user,
            group,
            mode,
            attrs,
            saltenv,
            context,
            defaults,
            skip_verify,
            kwargs,
        ):
            return "sfn", "hash", ""
        def file_manage_file(
            name,
            sfn,
            ret,
            source,
            source_sum,
            user,
            group,
            mode,
            attrs,
            saltenv,
            backup,
            makedirs,
            template,
            show_diff,
            contents,
            dir_mode,
        ):
            return {"result": True, "changes": False}
        jboss7_undeploy_mock = MagicMock()
        jboss7_deploy_mock = MagicMock()
        file_get_managed = MagicMock(side_effect=file_get_managed)
        file_manage_file = MagicMock(side_effect=file_manage_file)
        list_deployments_mock = MagicMock(side_effect=list_deployments)
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.undeploy": jboss7_undeploy_mock,
                "jboss7.deploy": jboss7_deploy_mock,
                "file.get_managed": file_get_managed,
                "file.manage_file": file_manage_file,
                "jboss7.list_deployments": list_deployments_mock,
            },
        ):
            result = jboss7.deployed(
                name="unchanged", jboss_config=jboss_conf, salt_source=parameters
            )
            self.assertFalse(jboss7_undeploy_mock.called)
            self.assertTrue(jboss7_deploy_mock.called)
    def test_should_redploy_undeploy_force(self):
        parameters = {
            "target_file": "some_artifact",
            "undeploy_force": True,
            "undeploy": "some_artifact",
            "source": "some_artifact_on_master",
        }
        jboss_conf = {"cli_path": "somewhere", "controller": "some_controller"}
        def list_deployments(jboss_config):
            return ["some_artifact"]
        def file_get_managed(
            name,
            template,
            source,
            source_hash,
            source_hash_name,
            user,
            group,
            mode,
            attrs,
            saltenv,
            context,
            defaults,
            skip_verify,
            kwargs,
        ):
            return "sfn", "hash", ""
        def file_manage_file(
            name,
            sfn,
            ret,
            source,
            source_sum,
            user,
            group,
            mode,
            attrs,
            saltenv,
            backup,
            makedirs,
            template,
            show_diff,
            contents,
            dir_mode,
        ):
            return {"result": True, "changes": False}
        jboss7_undeploy_mock = MagicMock()
        jboss7_deploy_mock = MagicMock()
        file_get_managed = MagicMock(side_effect=file_get_managed)
        file_manage_file = MagicMock(side_effect=file_manage_file)
        list_deployments_mock = MagicMock(side_effect=list_deployments)
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.undeploy": jboss7_undeploy_mock,
                "jboss7.deploy": jboss7_deploy_mock,
                "file.get_managed": file_get_managed,
                "file.manage_file": file_manage_file,
                "jboss7.list_deployments": list_deployments_mock,
            },
        ):
            result = jboss7.deployed(
                name="unchanged", jboss_config=jboss_conf, salt_source=parameters
            )
            self.assertTrue(jboss7_undeploy_mock.called)
            self.assertTrue(jboss7_deploy_mock.called)
    def test_should_create_new_datasource_if_not_exists(self):
        datasource_properties = {"connection-url": "jdbc:/old-connection-url"}
        ds_status = {"created": False}
        def read_func(jboss_config, name, profile):
            if ds_status["created"]:
                return {"success": True, "result": datasource_properties}
            else:
                return {"success": False, "err_code": "JBAS014807"}
        def create_func(jboss_config, name, datasource_properties, profile):
            ds_status["created"] = True
            return {"success": True}
        read_mock = MagicMock(side_effect=read_func)
        create_mock = MagicMock(side_effect=create_func)
        update_mock = MagicMock()
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_datasource": read_mock,
                "jboss7.create_datasource": create_mock,
                "jboss7.update_datasource": update_mock,
            },
        ):
            result = jboss7.datasource_exists(
                name="appDS",
                jboss_config={},
                datasource_properties=datasource_properties,
                profile=None,
            )
            create_mock.assert_called_with(
                name="appDS",
                jboss_config={},
                datasource_properties=datasource_properties,
                profile=None,
            )
            self.assertFalse(update_mock.called)
            self.assertEqual(result["comment"], "Datasource created.")
    def test_should_update_the_datasource_if_exists(self):
        ds_status = {"updated": False}
        def read_func(jboss_config, name, profile):
            if ds_status["updated"]:
                return {
                    "success": True,
                    "result": {"connection-url": "jdbc:/new-connection-url"},
                }
            else:
                return {
                    "success": True,
                    "result": {"connection-url": "jdbc:/old-connection-url"},
                }
        def update_func(jboss_config, name, new_properties, profile):
            ds_status["updated"] = True
            return {"success": True}
        read_mock = MagicMock(side_effect=read_func)
        create_mock = MagicMock()
        update_mock = MagicMock(side_effect=update_func)
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_datasource": read_mock,
                "jboss7.create_datasource": create_mock,
                "jboss7.update_datasource": update_mock,
            },
        ):
            result = jboss7.datasource_exists(
                name="appDS",
                jboss_config={},
                datasource_properties={"connection-url": "jdbc:/new-connection-url"},
                profile=None,
            )
            update_mock.assert_called_with(
                name="appDS",
                jboss_config={},
                new_properties={"connection-url": "jdbc:/new-connection-url"},
                profile=None,
            )
            self.assertTrue(read_mock.called)
            self.assertEqual(result["comment"], "Datasource updated.")
    def test_should_recreate_the_datasource_if_specified(self):
        read_mock = MagicMock(
            return_value={
                "success": True,
                "result": {"connection-url": "jdbc:/same-connection-url"},
            }
        )
        create_mock = MagicMock(return_value={"success": True})
        remove_mock = MagicMock(return_value={"success": True})
        update_mock = MagicMock()
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_datasource": read_mock,
                "jboss7.create_datasource": create_mock,
                "jboss7.remove_datasource": remove_mock,
                "jboss7.update_datasource": update_mock,
            },
        ):
            result = jboss7.datasource_exists(
                name="appDS",
                jboss_config={},
                datasource_properties={"connection-url": "jdbc:/same-connection-url"},
                recreate=True,
            )
            remove_mock.assert_called_with(name="appDS", jboss_config={}, profile=None)
            create_mock.assert_called_with(
                name="appDS",
                jboss_config={},
                datasource_properties={"connection-url": "jdbc:/same-connection-url"},
                profile=None,
            )
            self.assertEqual(result["changes"]["removed"], "appDS")
            self.assertEqual(result["changes"]["created"], "appDS")
    def test_should_inform_if_the_datasource_has_not_changed(self):
        read_mock = MagicMock(
            return_value={
                "success": True,
                "result": {"connection-url": "jdbc:/same-connection-url"},
            }
        create_mock = MagicMock()
        remove_mock = MagicMock()
        update_mock <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>= MagicMock(return_value={"success": True})
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_datasource": read_mock,
                "jboss7.create_datasource": create_mock,
                "jboss7.remove_datasource": remove_mock,
                "jboss7.update_datasource": update_mock,
            },
        ):
            result = jboss7.datasource_exists(</b></font>
                name="appDS",
                jboss_config={},
                datasource_properties={"connection-url": "jdbc:/old-connection-url"},
            )
            update_mock.assert_called_with(
                name="appDS",
                jboss_config={},
                new_properties={"connection-url": "jdbc:/old-connection-url"},
                profile=None,
            )
            self.assertFalse(create_mock.called)
            self.assertEqual(result["comment"], "Datasource not changed.")
    def test_should_create_binding_if_not_exists(self):
        binding_status = {"created": False}
        def read_func(jboss_config, binding_name, profile):
            if binding_status["created"]:
                return {"success": True, "result": {"value": "DEV"}}
            else:
                return {"success": False, "err_code": "JBAS014807"}
        def create_func(jboss_config, binding_name, value, profile):
            binding_status["created"] = True
            return {"success": True}
        read_mock = MagicMock(side_effect=read_func)
        create_mock = MagicMock(side_effect=create_func)
        update_mock = MagicMock()
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_simple_binding": read_mock,
                "jboss7.create_simple_binding": create_mock,
                "jboss7.update_simple_binding": update_mock,
            },
        ):
            result = jboss7.bindings_exist(
                name="bindings", jboss_config={}, bindings={"env": "DEV"}, profile=None
            )
            create_mock.assert_called_with(
                jboss_config={}, binding_name="env", value="DEV", profile=None
            )
            self.assertEqual(update_mock.call_count, 0)
            self.assertEqual(result["changes"], {"added": "env:DEV\n"})
            self.assertEqual(result["comment"], "Bindings changed.")
    def test_should_update_bindings_if_exists_and_different(self):
        binding_status = {"updated": False}
        def read_func(jboss_config, binding_name, profile):
            if binding_status["updated"]:
                return {"success": True, "result": {"value": "DEV2"}}
            else:
                return {"success": True, "result": {"value": "DEV"}}
        def update_func(jboss_config, binding_name, value, profile):
            binding_status["updated"] = True
            return {"success": True}
        read_mock = MagicMock(side_effect=read_func)
        create_mock = MagicMock()
        update_mock = MagicMock(side_effect=update_func)
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_simple_binding": read_mock,
                "jboss7.create_simple_binding": create_mock,
                "jboss7.update_simple_binding": update_mock,
            },
        ):
            result = jboss7.bindings_exist(
                name="bindings", jboss_config={}, bindings={"env": "DEV2"}, profile=None
            )
            update_mock.assert_called_with(
                jboss_config={}, binding_name="env", value="DEV2", profile=None
            )
            self.assertEqual(create_mock.call_count, 0)
            self.assertEqual(result["changes"], {"changed": "env:DEV-&gt;DEV2\n"})
            self.assertEqual(result["comment"], "Bindings changed.")
    def test_should_not_update_bindings_if_same(self):
        read_mock = MagicMock(
            return_value={"success": True, "result": {"value": "DEV2"}}
        )
        create_mock = MagicMock()
        update_mock = MagicMock()
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_simple_binding": read_mock,
                "jboss7.create_simple_binding": create_mock,
                "jboss7.update_simple_binding": update_mock,
            },
        ):
            result = jboss7.bindings_exist(
                name="bindings", jboss_config={}, bindings={"env": "DEV2"}
            )
            self.assertEqual(create_mock.call_count, 0)
            self.assertEqual(update_mock.call_count, 0)
            self.assertEqual(result["changes"], {})
            self.assertEqual(result["comment"], "Bindings not changed.")
    def test_should_raise_exception_if_cannot_create_binding(self):
        def read_func(jboss_config, binding_name, profile):
            return {"success": False, "err_code": "JBAS014807"}
        def create_func(jboss_config, binding_name, value, profile):
            return {"success": False, "failure-description": "Incorrect binding name."}
        read_mock = MagicMock(side_effect=read_func)
        create_mock = MagicMock(side_effect=create_func)
        update_mock = MagicMock()
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_simple_binding": read_mock,
                "jboss7.create_simple_binding": create_mock,
                "jboss7.update_simple_binding": update_mock,
            },
        ):
            try:
                jboss7.bindings_exist(
                    name="bindings",
                    jboss_config={},
                    bindings={"env": "DEV2"},
                    profile=None,
                )
                self.fail("An exception should be thrown")
            except CommandExecutionError as e:
                self.assertEqual(str(e), "Incorrect binding name.")
    def test_should_raise_exception_if_cannot_update_binding(self):
        def read_func(jboss_config, binding_name, profile):
            return {"success": True, "result": {"value": "DEV"}}
        def update_func(jboss_config, binding_name, value, profile):
            return {"success": False, "failure-description": "Incorrect binding name."}
        read_mock = MagicMock(side_effect=read_func)
        create_mock = MagicMock()
        update_mock = MagicMock(side_effect=update_func)
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_simple_binding": read_mock,
                "jboss7.create_simple_binding": create_mock,
                "jboss7.update_simple_binding": update_mock,
            },
        ):
            try:
                jboss7.bindings_exist(
                    name="bindings",
                    jboss_config={},
                    bindings={"env": "!@#!///some weird value"},
                    profile=None,
                )
                self.fail("An exception should be thrown")
            except CommandExecutionError as e:
                self.assertEqual(str(e), "Incorrect binding name.")
    def test_datasource_exist_create_datasource_good_code(self):
        jboss_config = {
            "cli_path": "/home/ch44d/Desktop/wildfly-18.0.0.Final/bin/jboss-cli.sh",
            "controller": "127.0.0.1: 9990",
            "cli_user": "user",
            "cli_password": "user",
        }
        datasource_properties = {
            "driver - name": "h2",
            "connection - url": "jdbc:sqlserver://127.0.0.1:1433;DatabaseName=test_s2",
            "jndi - name": (
                "java:/home/ch44d/Desktop/sqljdbc_7.4/enu/mssql-jdbc-7.4.1.jre8.jar"
            ),
            "user - name": "user",
            "password": "user",
            "use - java - context": True,
        }
        read_datasource = MagicMock(
            return_value={"success": False, "err_code": "WFLYCTL0216"}
        error_msg = "Error: -1"
        create_datasource <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>= MagicMock(
            return_value={"success": False, "stdout": error_msg}
        )
        with patch.dict(
            jboss7.__salt__,
            {
                "jboss7.read_datasource": read_datasource,
                "jboss7.create_datasource": create_datasource,
            },
        ):
            ret = jboss7.datasource_exists("SQL", jboss_config, datasource_properties)
            self.assertTrue("result" in ret)
            self.</b></font>assertFalse(ret["result"])
            self.assertTrue("comment" in ret)
            self.assertTrue(error_msg in ret["comment"])
            read_datasource.assert_called_once()
            create_datasource.assert_called_once()
    def test_datasource_exist_create_datasource_bad_code(self):
        jboss_config = {
            "cli_path": "/home/ch44d/Desktop/wildfly-18.0.0.Final/bin/jboss-cli.sh",
            "controller": "127.0.0.1: 9990",
            "cli_user": "user",
            "cli_password": "user",
        }
        datasource_properties = {
            "driver - name": "h2",
            "connection - url": "jdbc:sqlserver://127.0.0.1:1433;DatabaseName=test_s2",
            "jndi - name": (
                "java:/home/ch44d/Desktop/sqljdbc_7.4/enu/mssql-jdbc-7.4.1.jre8.jar"
            ),
            "user - name": "user",
            "password": "user",
            "use - java - context": True,
        }
        read_datasource = MagicMock(
            return_value={
                "success": False,
                "err_code": "WFLYCTL0217",
                "failure-description": "Something happened",
            }
        )
        with patch.dict(jboss7.__salt__, {"jboss7.read_datasource": read_datasource}):
            self.assertRaises(
                CommandExecutionError,
                jboss7.datasource_exists,
                "SQL",
                jboss_config,
                datasource_properties,
            )
            read_datasource.assert_called_once()
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
