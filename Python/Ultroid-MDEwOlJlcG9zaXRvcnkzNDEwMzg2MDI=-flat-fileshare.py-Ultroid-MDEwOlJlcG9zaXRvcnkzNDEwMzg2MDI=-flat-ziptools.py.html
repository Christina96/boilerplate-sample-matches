
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 3.9215686274509802%, Tokens: 9</h2>
        <div class="column">
            <h3>Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-fileshare.py</h3>
            <pre><code>1  from . import get_help
2  __doc__ = get_help("help_fileshare")
3  import os
<span onclick='openModal()' class='match'>4  from pyUltroid.dB.filestore_db import del_stored, get_stored_msg, list_all_stored_msgs
5  from pyUltroid.fns.tools import get_file_link
6  from . import HNDLR, asst, get_string, in_pattern, udB, ultroid_bot, ultroid_cmd
7  @ultroid_cmd(pattern="store$")
8  async def filestoreplg(event):
9      msg = await event.get_reply_message()
</span>10      if not msg:
11          return await event.eor(get_string("fsh_3"), time=10)
12      filehash = await get_file_link(msg)
13      link_to_file = f"https://t.me/{asst.me.username}?start={filehash}"
14      await event.eor(
15          get_string("fsh_2").format(link_to_file),
16          link_preview=False,
17      )
18  @ultroid_cmd("delstored ?(.*)")
19  async def _(event):
20      match = event.pattern_match.group(1)
21      if not match:
22          return await event.eor("`Give stored film's link to delete.`", time=5)
23      match = match.split("?start=")
24      botusername = match[0].split("/")[-1]
25      if botusername != asst.me.username:
26          return await event.eor(
27              "`Message/Media of provided link was not stored by this bot.`", time=5
28          )
29      msg_id = get_stored_msg(match[1])
30      if not msg_id:
31          return await event.eor(
32              "`Message/Media of provided link was already deleted.`", time=5
33          )
34      del_stored(match[1])
35      await ultroid_bot.delete_messages(udB.get_key("LOG_CHANNEL"), int(msg_id))
36      await event.eor("__Deleted__")
37  @ultroid_cmd("liststored$")
38  async def liststored(event):
39      files = list_all_stored_msgs()
40      if not files:
41          return await event.eor(get_string("fsh_4"), time=5)
42      msg = "**Stored files:**\n"
43      for c, i in enumerate(files, start=1):
44          msg += f"`{c}`. https://t.me/{asst.me.username}?start={i}\n"
45      if len(msg) > 4095:
46          with open("liststored.txt", "w") as f:
47              f.write(msg.replace("**", "").replace("`", ""))
48          await event.reply(get_string("fsh_1"), file="liststored.txt")
49          os.remove("liststored.txt")
50          return
51      await event.eor(msg, link_preview=False)
52  @in_pattern("filestore", owner=True)
53  async def file_short(event):
54      all_ = list_all_stored_msgs()
55      res = []
56      if all_:
57          LOG_CHA = udB.get_key("LOG_CHANNEL")
58          for msg in all_[:50]:
59              m_id = get_stored_msg(msg)
60              if not m_id:
61                  continue
62              message = await asst.get_messages(LOG_CHA, ids=m_id)
63              if not message:
64                  continue
65              if message.media:
66                  res.append(await event.builder.document(title=msg, file=message.media))
67              elif message.text:
68                  res.append(
69                      await event.builder.article(title=message.text, text=message.text)
70                  )
71      if not res:
72          title = "You have no stored file :("
73          text = f"{title}\n\nRead `{HNDLR}help fileshare` to know how to store."
74          return await event.answer([await event.builder.article(title=title, text=text)])
75      await event.answer(res, switch_pm="• File Store •", switch_pm_param="start")
</code></pre>
        </div>
        <div class="column">
            <h3>Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-ziptools.py</h3>
            <pre><code><span onclick='openModal()' class='match'>1  import os
2  import time
3  from . import (
4      HNDLR,
5      ULTConfig,
6      asyncio,
7      bash,
8      downloader,
9      get_all_files,
10      get_string,
11      ultroid_cmd,
12      uploader,
13  )
14  @ultroid_cmd(pattern="zip( (.*)|$)")
15  async def zipp(event):
16      reply = await event.get_reply_message()
</span>17      t = time.time()
18      if not reply:
19          await event.eor(get_string("zip_1"))
20          return
21      xx = await event.eor(get_string("com_1"))
22      if reply.media:
23          if hasattr(reply.media, "document"):
24              file = reply.media.document
25              image = await downloader(
26                  reply.file.name, reply.media.document, xx, t, get_string("com_5")
27              )
28              file = image.name
29          else:
30              file = await event.download_media(reply)
31      inp = file.replace(file.split(".")[-1], "zip")
32      if event.pattern_match.group(1).strip():
33          await bash(
34              f"zip -r --password {event.pattern_match.group(1).strip()} {inp} {file}"
35          )
36      else:
37          await bash(f"zip -r {inp} {file}")
38      k = time.time()
39      xxx = await uploader(inp, inp, k, xx, get_string("com_6"))
40      await event.client.send_file(
41          event.chat_id,
42          xxx,
43          force_document=True,
44          thumb=ULTConfig.thumb,
45          caption=f"`{xxx.name}`",
46          reply_to=reply,
47      )
48      os.remove(inp)
49      os.remove(file)
50      await xx.delete()
51  @ultroid_cmd(pattern="unzip( (.*)|$)")
52  async def unzipp(event):
53      reply = await event.get_reply_message()
54      file = event.pattern_match.group(1).strip()
55      t = time.time()
56      if not ((reply and reply.media) or file):
57          await event.eor(get_string("zip_1"))
58          return
59      xx = await event.eor(get_string("com_1"))
60      if reply.media:
61          if not hasattr(reply.media, "document"):
62              return await xx.edit(get_string("zip_3"))
63          file = reply.media.document
64          if not reply.file.name.endswith(("zip", "rar", "exe")):
65              return await xx.edit(get_string("zip_3"))
66          image = await downloader(
67              reply.file.name, reply.media.document, xx, t, get_string("com_5")
68          )
69          file = image.name
70      if os.path.isdir("unzip"):
71          await bash("rm -rf unzip")
72      os.mkdir("unzip")
73      await bash(f"7z x {file} -aoa -ounzip")
74      await asyncio.sleep(4)
75      ok = get_all_files("unzip")
76      for x in ok:
77          k = time.time()
78          xxx = await uploader(x, x, k, xx, get_string("com_6"))
79          await event.client.send_file(
80              event.chat_id,
81              xxx,
82              force_document=True,
83              thumb=ULTConfig.thumb,
84              caption=f"`{xxx.name}`",
85          )
86      await xx.delete()
87  @ultroid_cmd(pattern="addzip$")
88  async def azipp(event):
89      reply = await event.get_reply_message()
90      t = time.time()
91      if not (reply and reply.media):
92          await event.eor(get_string("zip_1"))
93          return
94      xx = await event.eor(get_string("com_1"))
95      if not os.path.isdir("zip"):
96          os.mkdir("zip")
97      if reply.media:
98          if hasattr(reply.media, "document"):
99              file = reply.media.document
100              image = await downloader(
101                  f"zip/{reply.file.name}",
102                  reply.media.document,
103                  xx,
104                  t,
105                  get_string("com_5"),
106              )
107              file = image.name
108          else:
109              file = await event.download_media(reply.media, "zip/")
110      await xx.edit(
111          f"Downloaded `{file}` succesfully\nNow Reply To Other Files To Add And Zip all at once"
112      )
113  @ultroid_cmd(pattern="dozip( (.*)|$)")
114  async def do_zip(event):
115      if not os.path.isdir("zip"):
116          return await event.eor(get_string("zip_2").format(HNDLR))
117      xx = await event.eor(get_string("com_1"))
118      if event.pattern_match.group(1).strip():
119          await bash(
120          )
121      else:
122      k = time.time()
123      xxx = await uploader("ultroid.zip", "ultroid.zip", k, xx, get_string("com_6"))
124      await event.client.send_file(
125          event.chat_id,
126          xxx,
127          force_document=True,
128          thumb=ULTConfig.thumb,
129      )
130      await bash("rm -rf zip")
131      os.remove("ultroid.zip")
132      await xx.delete()
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-fileshare.py</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-ziptools.py</div>
                </div>
                <div class="column column_space"><pre><code>4  from pyUltroid.dB.filestore_db import del_stored, get_stored_msg, list_all_stored_msgs
5  from pyUltroid.fns.tools import get_file_link
6  from . import HNDLR, asst, get_string, in_pattern, udB, ultroid_bot, ultroid_cmd
7  @ultroid_cmd(pattern="store$")
8  async def filestoreplg(event):
9      msg = await event.get_reply_message()
</pre></code></div>
                <div class="column column_space"><pre><code>1  import os
2  import time
3  from . import (
4      HNDLR,
5      ULTConfig,
6      asyncio,
7      bash,
8      downloader,
9      get_all_files,
10      get_string,
11      ultroid_cmd,
12      uploader,
13  )
14  @ultroid_cmd(pattern="zip( (.*)|$)")
15  async def zipp(event):
16      reply = await event.get_reply_message()
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    