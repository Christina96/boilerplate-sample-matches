<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_win_autoruns.py &amp; test_keystone_2.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_win_autoruns.py &amp; test_keystone_2.py
      </h3>
<h1 align="center">
        2.4%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_win_autoruns.py (25.0%)<th>test_keystone_2.py (1.2618296%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(11-22)<td><a href="#" name="0">(201-213)</a><td align="center"><font color="#ff0000">12</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_win_autoruns.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import pytest
2 import salt.modules.win_autoruns as win_autoruns
3 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>@pytest.fixture
4 def define_key():
5     return [
6         "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
7         "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /reg:64",
8         "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
9     ]
10 @pytest.fixture
11 def configure_loader_modules():
12     return {wi</b></font>n_autoruns: {}}
13 def test_list(define_key):
14     with patch("os.listdir", MagicMock(return_value=[])):
15         ret = {
16             define_key[0]: ["SALT"],
17             define_key[1]: ["SALT"],
18             define_key[2]: ["SALT"],
19         }
20         mock = MagicMock(return_value="Windows 7")
21         with patch.dict(win_autoruns.__grains__, {"osfullname": mock}):
22             mock = MagicMock(return_value="SALT")
23             with patch.dict(win_autoruns.__salt__, {"cmd.run": mock}):
24                 assert win_autoruns.list_() == ret
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_keystone_2.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import salt.modules.config as config
2 import salt.modules.keystone as keystone
3 from tests.support.mixins import LoaderModuleMockMixin
4 from tests.support.mock import MagicMock, call, patch
5 from tests.support.unit import TestCase
6 class MockEC2:
7     def __init__(self):
8         self.access = ""
9         self.secret = ""
10         self.tenant_id = ""
11         self.user_id = ""
12         self.connection_args = ""
13         self.profile = ""
14     @staticmethod
15     def create(userid, tenantid):
16         cr_ec2 = MockEC2()
17         cr_ec2.tenant_id = tenantid
18         cr_ec2.user_id = userid
19         return cr_ec2
20     def delete(self, userid, accesskey):
21         self.access = accesskey
22         self.user_id = userid
23         return True
24     @staticmethod
25     def get(user_id, access, profile, **connection_args):
26         cr_ec2 = MockEC2()
27         cr_ec2.profile = profile
28         cr_ec2.access = access
29         cr_ec2.user_id = user_id
30         cr_ec2.connection_args = connection_args
31         return cr_ec2
32     @staticmethod
33     def list(user_id):
34         cr_ec2 = MockEC2()
35         cr_ec2.user_id = user_id
36         return [cr_ec2]
37 class MockEndpoints:
38     def __init__(self):
39         self.id = "007"
40         self.region = "RegionOne"
41         self.adminurl = "adminurl"
42         self.internalurl = "internalurl"
43         self.publicurl = "publicurl"
44         self.service_id = "117"
45     @staticmethod
46     def list():
47         return [MockEndpoints()]
48     @staticmethod
49     def create(region, service_id, publicurl, adminurl, internalurl):
50         return (region, service_id, publicurl, adminurl, internalurl)
51     @staticmethod
52     def delete(id):
53         return id
54 class MockServices:
55     flag = None
56     def __init__(self):
57         self.id = "117"
58         self.name = "iptables"
59         self.description = "description"
60         self.type = "type"
61     @staticmethod
62     def create(name, service_type, description):
63         service = MockServices()
64         service.id = "005"
65         service.name = name
66         service.description = description
67         service.type = service_type
68         return service
69     def get(self, service_id):
70         service = MockServices()
71         if self.flag == 1:
72             service.id = "asd"
73             return [service]
74         elif self.flag == 2:
75             service.id = service_id
76             return service
77         return [service]
78     def list(self):
79         service = MockServices()
80         if self.flag == 1:
81             service.id = "asd"
82             return [service]
83         return [service]
84     @staticmethod
85     def delete(service_id):
86         return service_id
87 class MockRoles:
88     flag = None
89     def __init__(self):
90         self.id = "113"
91         self.name = "nova"
92         self.user_id = "446"
93         self.tenant_id = "a1a1"
94     @staticmethod
95     def create(name):
96         return name
97     def get(self, role_id):
98         role = MockRoles()
99         if self.flag == 1:
100             role.id = None
101             return role
102         role.id = role_id
103         return role
104     @staticmethod
105     def list():
106         return [MockRoles()]
107     @staticmethod
108     def delete(role):
109         """
110     <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>@staticmethod
111     def add_user_role(user_id, role_id, tenant_id):
112         """
113         Mock of add_user_role method
114         """
115         return (user_id, role_id, tenant_id)
116     @staticmethod
117     def remove_user_role(user_id, role_id, tenant_id):
118         """
119         Mock of remove_user_role method
120         """
121         return (us</b></font>er_id, role_id, tenant_id)
122     @staticmethod
123     def roles_for_user(user, tenant):
124         """
125         Mock of roles_for_user method
126         """
127         role = MockRoles()
128         role.user_id = user
129         role.tenant_id = tenant
130         return [role]
131 class MockTenants:
132     """
133     Mock of Tenants class
134     """
135     flag = None
136     def __init__(self):
137         self.id = "446"
138         self.name = "nova"
139         self.description = "description"
140         self.enabled = "True"
141     @staticmethod
142     def create(name, description, enabled):
143         """
144         Mock of create method
145         """
146         tenant = MockTenants()
147         tenant.name = name
148         tenant.description = description
149         tenant.enabled = enabled
150         return tenant
151     def get(self, tenant_id):
152         """
153         Mock of get method
154         """
155         tenant = MockTenants()
156         if self.flag == 1:
157             tenant.id = None
158             return tenant
159         tenant.id = tenant_id
160         return tenant
161     @staticmethod
162     def list():
163         """
164         Mock of list method
165         """
166         return [MockTenants()]
167     @staticmethod
168     def delete(tenant_id):
169         """
170         Mock of delete method
171         """
172         return tenant_id
173 class MockServiceCatalog:
174     """
175     Mock of ServiceCatalog class
176     """
177     def __init__(self):
178         self.id = "446"
179         self.expires = "No"
180         self.user_id = "admin"
181         self.tenant_id = "ae04"
182     def get_token(self):
183         """
184         Mock of get_token method
185         """
186         return {
187             "id": self.id,
188             "expires": self.expires,
189             "user_id": self.user_id,
190             "tenant_id": self.tenant_id,
191         }
192 class MockUsers:
193     """
194     Mock of Users class
195     """
196     flag = None
197     def __init__(self):
198         self.id = "446"
199         self.name = "nova"
200         self.email = "salt@saltstack.com"
201         self.enabled = "True"
202         self.tenant_id = "a1a1"
203         self.password = "salt"
204     def create(self, name, password, email, tenant_id, enabled):
205         """
206         Mock of create method
207         """
208         user = MockUsers()
209         user.name = name
210         user.password = password
211         user.email = email
212         user.enabled = enabled
213         self.tenant_id = tenant_id
214         return user
215     def get(self, user_id):
216         """
217         Mock of get method
218         """
219         user = MockUsers()
220         if self.flag == 1:
221             user.id = None
222             return user
223         user.id = user_id
224         return user
225     @staticmethod
226     def list():
227         """
228         Mock of list method
229         """
230         return [MockUsers()]
231     @staticmethod
232     def delete(user_id):
233         """
234         Mock of delete method
235         """
236         return user_id
237     @staticmethod
238     def update(user, name, email, enabled):
239         """
240         Mock of update method
241         """
242         return (user, name, email, enabled)
243     @staticmethod
244     def update_password(user, password):
245         """
246         Mock of update_password method
247         """
248         return (user, password)
249 class Unauthorized(Exception):
250     """
251     The base exception class for all exceptions.
252     """
253     def __init__(self, message="Test"):
254         super().__init__(message)
255         self.msg = message
256 class AuthorizationFailure(Exception):
257     """
258     Additional exception class to Unauthorized.
259     """
260     def __init__(self, message="Test"):
261         super().__init__(message)
262         self.msg = message
263 class MockExceptions:
264     """
265     Mock of exceptions class
266     """
267     def __init__(self):
268         self.Unauthorized = Unauthorized
269         self.AuthorizationFailure = AuthorizationFailure
270 class MockKeystoneClient:
271     """
272     Mock of keystoneclient module
273     """
274     def __init__(self):
275         self.exceptions = MockExceptions()
276 class MockClient:
277     """
278     Mock of Client class
279     """
280     flag = None
281     def __init__(self, profile=None, **conn_args):
282         self.ec2 = MockEC2()
283         self.endpoints = MockEndpoints()
284         self.services = MockServices()
285         self.roles = MockRoles()
286         self.tenants = MockTenants()
287         self.service_catalog = MockServiceCatalog()
288         self.users = MockUsers()
289     def Client(self, **kwargs):
290         """
291         Mock of Client method
292         """
293         if self.flag == 1:
294             raise Unauthorized
295         return True
296 class KeystoneTestCase(TestCase, LoaderModuleMockMixin):
297     """
298     Test cases for salt.modules.keystone
299     """
300     def setup_loader_modules(self):
301         return {
302             keystone: {
303                 "auth": MockClient,
304                 "client": MockClient(),
305                 "keystoneclient": MockKeystoneClient(),
306                 "__salt__": {"config.get": config.get},
307                 "__opts__": {},
308             },
309             config: {"__opts__": {}},
310         }
311     def test_ec2_credentials_create(self):
312         """
313         Test if it create EC2-compatible credentials for user per tenant
314         """
315         self.assertDictEqual(
316             keystone.ec2_credentials_create(), {"Error": "Could not resolve User ID"}
317         )
318         self.assertDictEqual(
319             keystone.ec2_credentials_create(user_id="salt"),
320             {"Error": "Could not resolve Tenant ID"},
321         )
322         self.assertDictEqual(
323             keystone.ec2_credentials_create(user_id="salt", tenant_id="72278"),
324             {"access": "", "tenant_id": "72278", "secret": "", "user_id": "salt"},
325         )
326     def test_ec2_credentials_delete(self):
327         """
328         Test if it delete EC2-compatible credentials
329         """
330         self.assertDictEqual(
331             keystone.ec2_credentials_delete(), {"Error": "Could not resolve User ID"}
332         )
333         self.assertEqual(
334             keystone.ec2_credentials_delete(user_id="salt", access_key="72278"),
335             'ec2 key "72278" deleted under user id "salt"',
336         )
337     def test_ec2_credentials_get(self):
338         """
339         Test if it return ec2_credentials for a user
340         (keystone ec2-credentials-get)
341         """
342         self.assertDictEqual(
343             keystone.ec2_credentials_get(), {"Error": "Unable to resolve user id"}
344         )
345         self.assertDictEqual(
346             keystone.ec2_credentials_get(user_id="salt"),
347             {"Error": "Access key is required"},
348         )
349         self.assertDictEqual(
350             keystone.ec2_credentials_get(
351                 user_id="salt", access="72278", profile="openstack1"
352             ),
353             {
354                 "salt": {
355                     "access": "72278",
356                     "secret": "",
357                     "tenant": "",
358                     "user_id": "salt",
359                 }
360             },
361         )
362     def test_ec2_credentials_list(self):
363         """
364         Test if it return a list of ec2_credentials
365         for a specific user (keystone ec2-credentials-list)
366         """
367         self.assertDictEqual(
368             keystone.ec2_credentials_list(), {"Error": "Unable to resolve user id"}
369         )
370         self.assertDictEqual(
371             keystone.ec2_credentials_list(user_id="salt", profile="openstack1"),
372             {"salt": {"access": "", "secret": "", "tenant_id": "", "user_id": "salt"}},
373         )
374     def test_endpoint_get(self):
375         """
376         Test if it return a specific endpoint (keystone endpoint-get)
377         """
378         self.assertDictEqual(
379             keystone.endpoint_get("nova", "RegionOne", profile="openstack"),
380             {"Error": "Could not find the specified service"},
381         )
382         ret = {"Error": "Could not find endpoint for the specified service"}
383         MockServices.flag = 1
384         self.assertDictEqual(
385             keystone.endpoint_get("iptables", "RegionOne", profile="openstack"), ret
386         )
387         MockServices.flag = 0
388         self.assertDictEqual(
389             keystone.endpoint_get("iptables", "RegionOne", profile="openstack"),
390             {
391                 "adminurl": "adminurl",
392                 "id": "007",
393                 "internalurl": "internalurl",
394                 "publicurl": "publicurl",
395                 "region": "RegionOne",
396                 "service_id": "117",
397             },
398         )
399     def test_endpoint_list(self):
400         """
401         Test if it return a list of available endpoints
402         (keystone endpoints-list)
403         """
404         self.assertDictEqual(
405             keystone.endpoint_list(profile="openstack1"),
406             {
407                 "007": {
408                     "adminurl": "adminurl",
409                     "id": "007",
410                     "internalurl": "internalurl",
411                     "publicurl": "publicurl",
412                     "region": "RegionOne",
413                     "service_id": "117",
414                 }
415             },
416         )
417     def test_endpoint_create(self):
418         """
419         Test if it create an endpoint for an Openstack service
420         """
421         self.assertDictEqual(
422             keystone.endpoint_create("nova"),
423             {"Error": "Could not find the specified service"},
424         )
425         MockServices.flag = 2
426         self.assertDictEqual(
427             keystone.endpoint_create(
428                 "iptables",
429                 "http://public/url",
430                 "http://internal/url",
431                 "http://adminurl/url",
432                 "RegionOne",
433             ),
434             {
435                 "adminurl": "adminurl",
436                 "id": "007",
437                 "internalurl": "internalurl",
438                 "publicurl": "publicurl",
439                 "region": "RegionOne",
440                 "service_id": "117",
441             },
442         )
443     def test_endpoint_delete(self):
444         """
445         Test if it delete an endpoint for an Openstack service
446         """
447         ret = {"Error": "Could not find any endpoints for the service"}
448         self.assertDictEqual(keystone.endpoint_delete("nova", "RegionOne"), ret)
449         with patch.object(
450             keystone, "endpoint_get", MagicMock(side_effect=[{"id": "117"}, None])
451         ):
452             self.assertTrue(keystone.endpoint_delete("iptables", "RegionOne"))
453     def test_role_create(self):
454         """
455         Test if it create named role
456         """
457         self.assertDictEqual(
458             keystone.role_create("nova"), {"Error": 'Role "nova" already exists'}
459         )
460         self.assertDictEqual(
461             keystone.role_create("iptables"), {"Error": "Unable to resolve role id"}
462         )
463     def test_role_delete(self):
464         """
465         Test if it delete a role (keystone role-delete)
466         """
467         self.assertDictEqual(
468             keystone.role_delete(), {"Error": "Unable to resolve role id"}
469         )
470         self.assertEqual(keystone.role_delete("iptables"), "Role ID iptables deleted")
471     def test_role_get(self):
472         """
473         Test if it return a specific roles (keystone role-get)
474         """
475         self.assertDictEqual(
476             keystone.role_get(), {"Error": "Unable to resolve role id"}
477         )
478         self.assertDictEqual(
479             keystone.role_get(name="nova"), {"nova": {"id": "113", "name": "nova"}}
480         )
481     def test_role_list(self):
482         """
483         Test if it return a list of available roles (keystone role-list)
484         """
485         self.assertDictEqual(
486             keystone.role_list(),
487             {
488                 "nova": {
489                     "id": "113",
490                     "name": "nova",
491                     "tenant_id": "a1a1",
492                     "user_id": "446",
493                 }
494             },
495         )
496     def test_service_create(self):
497         """
498         Test if it add service to Keystone service catalog
499         """
500         MockServices.flag = 2
501         self.assertDictEqual(
502             keystone.service_create("nova", "compute", "OpenStack Service"),
503             {
504                 "iptables": {
505                     "description": "description",
506                     "id": "005",
507                     "name": "iptables",
508                     "type": "type",
509                 }
510             },
511         )
512     def test_service_delete(self):
513         """
514         Test if it delete a service from Keystone service catalog
515         """
516         self.assertEqual(
517             keystone.service_delete("iptables"),
518             'Keystone service ID "iptables" deleted',
519         )
520     def test_service_get(self):
521         """
522         Test if it return a list of available services (keystone services-list)
523         """
524         MockServices.flag = 0
525         self.assertDictEqual(
526             keystone.service_get(), {"Error": "Unable to resolve service id"}
527         )
528         MockServices.flag = 2
529         self.assertDictEqual(
530             keystone.service_get(service_id="c965"),
531             {
532                 "iptables": {
533                     "description": "description",
534                     "id": "c965",
535                     "name": "iptables",
536                     "type": "type",
537                 }
538             },
539         )
540     def test_service_list(self):
541         """
542         Test if it return a list of available services (keystone services-list)
543         """
544         MockServices.flag = 0
545         self.assertDictEqual(
546             keystone.service_list(profile="openstack1"),
547             {
548                 "iptables": {
549                     "description": "description",
550                     "id": "117",
551                     "name": "iptables",
552                     "type": "type",
553                 }
554             },
555         )
556     def test_tenant_create(self):
557         """
558         Test if it create a keystone tenant
559         """
560         self.assertDictEqual(
561             keystone.tenant_create("nova"),
562             {
563                 "nova": {
564                     "description": "description",
565                     "id": "446",
566                     "name": "nova",
567                     "enabled": "True",
568                 }
569             },
570         )
571     def test_tenant_delete(self):
572         """
573         Test if it delete a tenant (keystone tenant-delete)
574         """
575         self.assertDictEqual(
576             keystone.tenant_delete(), {"Error": "Unable to resolve tenant id"}
577         )
578         self.assertEqual(keystone.tenant_delete("nova"), "Tenant ID nova deleted")
579     def test_tenant_get(self):
580         """
581         Test if it return a specific tenants (keystone tenant-get)
582         """
583         self.assertDictEqual(
584             keystone.tenant_get(), {"Error": "Unable to resolve tenant id"}
585         )
586         self.assertDictEqual(
587             keystone.tenant_get(tenant_id="446"),
588             {
589                 "nova": {
590                     "description": "description",
591                     "id": "446",
592                     "name": "nova",
593                     "enabled": "True",
594                 }
595             },
596         )
597     def test_tenant_list(self):
598         """
599         Test if it return a list of available tenants (keystone tenants-list)
600         """
601         self.assertDictEqual(
602             keystone.tenant_list(),
603             {
604                 "nova": {
605                     "description": "description",
606                     "id": "446",
607                     "name": "nova",
608                     "enabled": "True",
609                 }
610             },
611         )
612     def test_tenant_update(self):
613         """
614         Test if it update a tenant's information (keystone tenant-update)
615         """
616         self.assertDictEqual(
617             keystone.tenant_update(), {"Error": "Unable to resolve tenant id"}
618         )
619     def test_token_get(self):
620         """
621         Test if it return the configured tokens (keystone token-get)
622         """
623         self.assertDictEqual(
624             keystone.token_get(),
625             {"expires": "No", "id": "446", "tenant_id": "ae04", "user_id": "admin"},
626         )
627     def test_user_list(self):
628         """
629         Test if it return a list of available users (keystone user-list)
630         """
631         self.assertDictEqual(
632             keystone.user_list(),
633             {
634                 "nova": {
635                     "name": "nova",
636                     "tenant_id": "a1a1",
637                     "enabled": "True",
638                     "id": "446",
639                     "password": "salt",
640                     "email": "salt@saltstack.com",
641                 }
642             },
643         )
644     def test_user_get(self):
645         """
646         Test if it return a specific users (keystone user-get)
647         """
648         self.assertDictEqual(
649             keystone.user_get(), {"Error": "Unable to resolve user id"}
650         )
651         self.assertDictEqual(
652             keystone.user_get(user_id="446"),
653             {
654                 "nova": {
655                     "name": "nova",
656                     "tenant_id": "a1a1",
657                     "enabled": "True",
658                     "id": "446",
659                     "password": "salt",
660                     "email": "salt@saltstack.com",
661                 }
662             },
663         )
664     def test_user_create(self):
665         """
666         Test if it create a user (keystone user-create)
667         """
668         self.assertDictEqual(
669             keystone.user_create(
670                 name="nova",
671                 password="salt",
672                 email="salt@saltstack.com",
673                 tenant_id="a1a1",
674             ),
675             {
676                 "nova": {
677                     "name": "nova",
678                     "tenant_id": "a1a1",
679                     "enabled": "True",
680                     "id": "446",
681                     "password": "salt",
682                     "email": "salt@saltstack.com",
683                 }
684             },
685         )
686     def test_user_delete(self):
687         """
688         Test if it delete a user (keystone user-delete)
689         """
690         self.assertDictEqual(
691             keystone.user_delete(), {"Error": "Unable to resolve user id"}
692         )
693         self.assertEqual(keystone.user_delete("nova"), "User ID nova deleted")
694     def test_user_update(self):
695         """
696         Test if it update a user's information (keystone user-update)
697         """
698         self.assertDictEqual(
699             keystone.user_update(), {"Error": "Unable to resolve user id"}
700         )
701         self.assertEqual(keystone.user_update("nova"), "Info updated for user ID nova")
702     def test_user_verify_password(self):
703         """
704         Test if it verify a user's password
705         """
706         mock = MagicMock(return_value="http://127.0.0.1:35357/v2.0")
707         with patch.dict(keystone.__salt__, {"config.option": mock}):
708             self.assertDictEqual(
709                 keystone.user_verify_password(),
710                 {"Error": "Unable to resolve user name"},
711             )
712             self.assertTrue(keystone.user_verify_password(user_id="446", name="nova"))
713             MockClient.flag = 1
714             self.assertFalse(keystone.user_verify_password(user_id="446", name="nova"))
715     def test_user_password_update(self):
716         """
717         Test if it update a user's password (keystone user-password-update)
718         """
719         self.assertDictEqual(
720             keystone.user_password_update(), {"Error": "Unable to resolve user id"}
721         )
722         self.assertEqual(
723             keystone.user_password_update("nova"), "Password updated for user ID nova"
724         )
725     def test_user_role_add(self):
726         """
727         Test if it add role for user in tenant (keystone user-role-add)
728         """
729         self.assertEqual(
730             keystone.user_role_add(user="nova", tenant="nova", role="nova"),
731             '"nova" role added for user "nova" for "nova" tenant/project',
732         )
733         MockRoles.flag = 1
734         self.assertDictEqual(
735             keystone.user_role_add(user="nova", tenant="nova", role="nova"),
736             {"Error": "Unable to resolve role id"},
737         )
738         MockTenants.flag = 1
739         self.assertDictEqual(
740             keystone.user_role_add(user="nova", tenant="nova"),
741             {"Error": "Unable to resolve tenant/project id"},
742         )
743         MockUsers.flag = 1
744         self.assertDictEqual(
745             keystone.user_role_add(user="nova"), {"Error": "Unable to resolve user id"}
746         )
747     def test_user_role_remove(self):
748         """
749         Test if it add role for user in tenant (keystone user-role-add)
750         """
751         MockUsers.flag = 1
752         self.assertDictEqual(
753             keystone.user_role_remove(user="nova"),
754             {"Error": "Unable to resolve user id"},
755         )
756         MockUsers.flag = 0
757         MockTenants.flag = 1
758         self.assertDictEqual(
759             keystone.user_role_remove(user="nova", tenant="nova"),
760             {"Error": "Unable to resolve tenant/project id"},
761         )
762         MockTenants.flag = 0
763         MockRoles.flag = 1
764         self.assertDictEqual(
765             keystone.user_role_remove(user="nova", tenant="nova", role="nova"),
766             {"Error": "Unable to resolve role id"},
767         )
768         ret = '"nova" role removed for user "nova" under "nova" tenant'
769         MockRoles.flag = 0
770         self.assertEqual(
771             keystone.user_role_remove(user="nova", tenant="nova", role="nova"), ret
772         )
773     def test_user_role_list(self):
774         """
775         Test if it return a list of available user_roles
776         (keystone user-roles-list)
777         """
778         self.assertDictEqual(
779             keystone.user_role_list(user="nova"),
780             {"Error": "Unable to resolve user or tenant/project id"},
781         )
782         self.assertDictEqual(
783             keystone.user_role_list(user_name="nova", tenant_name="nova"),
784             {
785                 "nova": {
786                     "id": "113",
787                     "name": "nova",
788                     "tenant_id": "446",
789                     "user_id": "446",
790                 }
791             },
792         )
793     def test_api_version_verify_ssl(self):
794         """
795         test api_version when using verify_ssl
796         """
797         test_verify = [True, False, None]
798         conn_args = {
799             "keystone.user": "admin",
800             "connection_password": "password",
801             "connection_tenant": "admin",
802             "connection_tenant_id": "id",
803             "connection_auth_url": "https://127.0.0.1/v2.0/",
804             "connection_verify_ssl": True,
805         }
806         http_ret = {"dict": {"version": {"id": "id_test"}}}
807         for verify in test_verify:
808             mock_http = MagicMock(return_value=http_ret)
809             patch_http = patch("salt.utils.http.query", mock_http)
810             conn_args["connection_verify_ssl"] = verify
811             if verify is None:
812                 conn_args.pop("connection_verify_ssl")
813                 verify = True
814             with patch_http:
815                 ret = keystone.api_version(**conn_args)
816             self.assertEqual(
817                 mock_http.call_args_list,
818                 [
819                     call(
820                         "https://127.0.0.1/v2.0/",
821                         decode=True,
822                         decode_type="json",
823                         verify_ssl=verify,
824                     )
825                 ],
826             )
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
