
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 11.411411411411411%, Tokens: 9, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>sonnet-MDEwOlJlcG9zaXRvcnk4NzA2NzIxMg==-flat-reshape.py</h3>
            <pre><code>1  from typing import Optional, Sequence
2  import numpy as np
3  from sonnet.src import base
4  from sonnet.src import once
5  from sonnet.src import types
6  import tensorflow as tf
7  def reshape(inputs: tf.Tensor,
8              output_shape: types.ShapeLike,
9              preserve_dims: int = 1,
10              name: Optional[str] = None) -> tf.Tensor:
11    return Reshape(output_shape, preserve_dims, name=name)(inputs)
12  def flatten(inputs: tf.Tensor, name: str = "flatten") -> tf.Tensor:
13    return Flatten(name=name)(inputs)
14  def _infer_shape(output_shape: types.ShapeLike, dimensions: Sequence[int]):
15    n = np.prod(dimensions)
16    v = np.array(output_shape)
17    m = abs(np.prod(v))
18    v[v == -1] = n // m
19    return tuple(v)
20  class Reshape(base.Module):
21    def __init__(self,
22                 output_shape: types.ShapeLike,
23                 preserve_dims: int = 1,
24                 name: Optional[str] = None):
25      super().__init__(name=name)
26      if preserve_dims <= 0:
27        raise ValueError("Argument preserve_dims should be >= 1.")
28      self._output_shape = output_shape
29      self._preserve_dims = preserve_dims
30    @once.once
31    def _initialize(self, inputs: tf.Tensor):
32      if inputs.shape.rank < self._preserve_dims:
33        raise ValueError("Input tensor has {} dimensions, should have at least "
34                         "as many as preserve_dims={}".format(
35                             inputs.shape.rank, self._preserve_dims))
36      self._input_shape = inputs.shape
37    def __call__(self, inputs: tf.Tensor) -> tf.Tensor:
38      self._initialize(inputs)
39      output_shape = tuple(self._output_shape)
40      if -1 in output_shape:
41        reshaped_shape = inputs.shape[self._preserve_dims:]
42        if reshaped_shape.is_fully_defined():
43          output_shape = _infer_shape(output_shape, reshaped_shape)
44      preserved_shape = inputs.shape[:self._preserve_dims]
45      if preserved_shape.is_fully_defined():
46        output = tf.reshape(inputs, tuple(preserved_shape) + output_shape)
47      else:
48        dynamic_preserved_shape = tf.shape(inputs)[:self._preserve_dims]
49        output = tf.reshape(
50            inputs, tf.concat([dynamic_preserved_shape, output_shape], axis=0))
51      return output
52    @base.no_name_scope
53    def reversed(self, name: Optional[str] = None) -> "Reshape":
54      if name is None:
55        name = self.name + "_reversed"
56      return Reshape(
57          output_shape=self._input_shape[self._preserve_dims:],
58          preserve_dims=self._preserve_dims,
59          name=name)
60  class Flatten(Reshape):
<span onclick='openModal()' class='match'>61    def __init__(self, preserve_dims: int = 1, name: Optional[str] = None):
62      super().__init__(output_shape=(-1,), preserve_dims=preserve_dims, name=name)
</span></code></pre>
        </div>
        <div class="column">
            <h3>sonnet-MDEwOlJlcG9zaXRvcnk4NzA2NzIxMg==-flat-depthwise_conv.py</h3>
            <pre><code>1  from typing import Optional, Sequence, Union
2  import numpy as np
3  from sonnet.src import base
4  from sonnet.src import initializers
5  from sonnet.src import once
6  from sonnet.src import utils
7  import tensorflow as tf
8  class DepthwiseConv2D(base.Module):
9    def __init__(self,
10                 kernel_shape: Union[int, Sequence[int]],
11                 channel_multiplier: int = 1,
12                 stride: Union[int, Sequence[int]] = 1,
13                 rate: Union[int, Sequence[int]] = 1,
14                 padding: str = "SAME",
15                 with_bias: bool = True,
16                 w_init: Optional[initializers.Initializer] = None,
17                 b_init: Optional[initializers.Initializer] = None,
<span onclick='openModal()' class='match'>18                 data_format: str = "NHWC",
19                 name: Optional[str] = None):
20      super().__init__(name=name)
21      self.channel_multiplier = channel_multiplier
</span>22      self.kernel_shape = kernel_shape
23      self.data_format = data_format
24      self._channel_index = utils.get_channel_index(data_format)
25      stride = utils.replicate(stride, 2, "stride")
26      if self._channel_index == 1:
27        self.stride = (1, 1) + stride
28      else:
29        self.stride = (1,) + stride + (1,)
30      self.rate = utils.replicate(rate, 2, "rate")
31      self.padding = padding
32      self.with_bias = with_bias
33      self.w_init = w_init
34      if with_bias:
35        self.b_init = b_init if b_init is not None else initializers.Zeros()
36      elif b_init is not None:
37        raise ValueError("When not using a bias the b_init must be None.")
38    def __call__(self, inputs: tf.Tensor) -> tf.Tensor:
39      self._initialize(inputs)
40      outputs = tf.nn.depthwise_conv2d(inputs,
41                                       self.w,
42                                       strides=self.stride,
43                                       dilations=self.rate,
44                                       padding=self.padding,
45                                       data_format=self.data_format)
46      if self.with_bias:
47        outputs = tf.nn.bias_add(outputs, self.b,
48                                 data_format=self.data_format)
49      return outputs
50    @once.once
51    def _initialize(self, inputs: tf.Tensor):
52      self.input_channels = inputs.shape[self._channel_index]
53      if self.input_channels is None:
54        raise ValueError("The number of input channels must be known.")
55      dtype = inputs.dtype
56      weight_shape = utils.replicate(self.kernel_shape, 2, "kernel_shape")
57      weight_shape = weight_shape + (self.input_channels, self.channel_multiplier)
58      if self.w_init is None:
59        fan_in_shape = weight_shape[:2]
60        stddev = 1 / np.sqrt(np.prod(fan_in_shape))
61        self.w_init = initializers.TruncatedNormal(stddev=stddev)
62      self.w = tf.Variable(self.w_init(weight_shape, dtype), name="w")
63      output_channels = self.input_channels * self.channel_multiplier
64      if self.with_bias:
65        self.b = tf.Variable(self.b_init((output_channels,), dtype), name="b")
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from sonnet-MDEwOlJlcG9zaXRvcnk4NzA2NzIxMg==-flat-reshape.py</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from sonnet-MDEwOlJlcG9zaXRvcnk4NzA2NzIxMg==-flat-depthwise_conv.py</div>
                </div>
                <div class="column column_space"><pre><code>61    def __init__(self, preserve_dims: int = 1, name: Optional[str] = None):
62      super().__init__(output_shape=(-1,), preserve_dims=preserve_dims, name=name)
</pre></code></div>
                <div class="column column_space"><pre><code>18                 data_format: str = "NHWC",
19                 name: Optional[str] = None):
20      super().__init__(name=name)
21      self.channel_multiplier = channel_multiplier
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    