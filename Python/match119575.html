<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for rte.py &amp; npo.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for rte.py &amp; npo.py
      </h3>
<h1 align="center">
        2.6%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>rte.py (6.451613%)<th>npo.py (1.664355%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(114-165)<td><a href="#" name="0">(32-75)</a><td align="center"><font color="#ff0000">12</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>rte.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from __future__ import unicode_literals
2 import re
3 from .common import InfoExtractor
4 from ..compat import compat_HTTPError
5 from ..utils import (
6     float_or_none,
7     parse_iso8601,
8     str_or_none,
9     try_get,
10     unescapeHTML,
11     url_or_none,
12     ExtractorError,
13 )
14 class RteBaseIE(InfoExtractor):
15     def _real_extract(self, url):
16         item_id = self._match_id(url)
17         info_dict = {}
18         formats = []
19         ENDPOINTS = (
20             'https://feeds.rasset.ie/rteavgen/player/playlist?type=iptv&amp;format=json&amp;showId=',
21             'http://www.rte.ie/rteavgen/getplaylist/?type=web&amp;format=json&amp;id=',
22         )
23         for num, ep_url in enumerate(ENDPOINTS, start=1):
24             try:
25                 data = self._download_json(ep_url + item_id, item_id)
26             except ExtractorError as ee:
27                 if num &lt; len(ENDPOINTS) or formats:
28                     continue
29                 if isinstance(ee.cause, compat_HTTPError) and ee.cause.code == 404:
30                     error_info = self._parse_json(ee.cause.read().decode(), item_id, fatal=False)
31                     if error_info:
32                         raise ExtractorError(
33                             '%s said: %s' % (self.IE_NAME, error_info['message']),
34                             expected=True)
35                 raise
36             show = try_get(data, lambda x: x['shows'][0], dict)
37             if not show:
38                 continue
39             if not info_dict:
40                 title = unescapeHTML(show['title'])
41                 description = unescapeHTML(show.get('description'))
42                 thumbnail = show.get('thumbnail')
43                 duration = float_or_none(show.get('duration'), 1000)
44                 timestamp = parse_iso8601(show.get('published'))
45                 info_dict = {
46                     'id': item_id,
47                     'title': title,
48                     'description': description,
49                     'thumbnail': thumbnail,
50                     'timestamp': timestamp,
51                     'duration': duration,
52                 }
53             mg = try_get(show, lambda x: x['media:group'][0], dict)
54             if not mg:
55                 continue
56             if mg.get('url'):
57                 m = re.match(r'(?P&lt;url&gt;rtmpe?://[^/]+)/(?P&lt;app&gt;.+)/(?P&lt;playpath&gt;mp4:.*)', mg['url'])
58                 if m:
59                     m = m.groupdict()
60                     formats.append({
61                         'url': m['url'] + '/' + m['app'],
62                         'app': m['app'],
63                         'play_path': m['playpath'],
64                         'player_url': url,
65                         'ext': 'flv',
66                         'format_id': 'rtmp',
67                     })
68             if mg.get('hls_server') and mg.get('hls_url'):
69                 formats.extend(self._extract_m3u8_formats(
70                     mg['hls_server'] + mg['hls_url'], item_id, 'mp4',
71                     entry_protocol='m3u8_native', m3u8_id='hls', fatal=False))
72             if mg.get('hds_server') and mg.get('hds_url'):
73                 formats.extend(self._extract_f4m_formats(
74                     mg['hds_server'] + mg['hds_url'], item_id,
75                     f4m_id='hds', fatal=False))
76             mg_rte_server = str_or_none(mg.get('rte:server'))
77             mg_url = str_or_none(mg.get('url'))
78             if mg_rte_server and mg_url:
79                 hds_url = url_or_none(mg_rte_server + mg_url)
80                 if hds_url:
81                     formats.extend(self._extract_f4m_formats(
82                         hds_url, item_id, f4m_id='hds', fatal=False))
83         self._sort_formats(formats)
84         info_dict['formats'] = formats
85         return info_dict
86 class RteIE(RteBaseIE):
87     IE_NAME = 'rte'
88     IE_DESC = 'Raidió Teilifís Éireann TV'
89     _VALID_URL = r'https?://(?:www\.)?rte\.ie/player/[^/]{2,3}/show/[^/]+/(?P&lt;id&gt;[0-9]+)'
90     _TEST = {
91 <a name="0"></a>        'url': 'http://www.rte.ie/player/ie/show/iwitness-862/10478715/',
92         'md5': '4a76eb3396d98f697e6e8110563d2604',
93         'info_dict': {
94             '<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>id': '10478715',
95             'ext': 'mp4',
96             'title': 'iWitness',
97             'thumbnail': r're:^https?://.*\.jpg$',
98             'description': 'The spirit of Ireland, one voice and one minute at a time.',
99             'duration': 60.046,
100             'upload_date': '20151012',
101             'timestamp': 1444694160,
102         },
103     }
104 class RteRadioIE(RteBaseIE):
105     IE_NAME = 'rte:radio'
106     IE_DESC = 'Raidió Teilifís Éireann radio'
107     _VALID_URL = r'https?://(?:www\.)?rte\.ie/radio/utils/radioplayer/rteradioweb\.html#!rii=(?:b?[0-9]*)(?:%3A|:|%5F|_)(?P&lt;id&gt;[0-9]+)'
108     _TESTS = [{
109         'url': 'http://www.rte.ie/radio/utils/radioplayer/rteradioweb.html#!rii=16:10507902:2414:27-12-2015:',
110         'md5': 'c79ccb2c195998440065456b69760411',
111         'info_dict': {
112             'id': '10507902',
113             'ext': 'mp4',
114             'title': 'Gloria',
115             'thumbnail': r're:^https?://.*\.jpg$',
116             'description': 'md5:9ce124a7fb41559ec68f06387cabddf0',
117             'timestamp': 1451203200,
118             'upload_date': '20151227',
119             'duration': 7230.0,
120         },
121     }, {
122         'url': 'http://rte.ie/radio/utils/radioplayer/rteradioweb.html#!rii=b16_3250678_8861_06-04-2012_',
123         'info_dict': {
124             'id': '3250678',
125             'ext': 'flv',
126             'title': 'The Lyric Concert with Paul Herriott',
127             'thumbnail': r're:^https?://.*\.jpg$',
128             'description': '',
129             'timestamp': 1333742400,
130             'upload_date': '20120406',
131             'duration': 7199.016,
132         },
133         'params': {
134             'skip_download'</b></font>: True,
135         },
136     }]
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>npo.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from __future__ import unicode_literals
2 import re
3 from .common import InfoExtractor
4 from ..compat import (
5     compat_HTTPError,
6     compat_str,
7 )
8 from ..utils import (
9     determine_ext,
10     ExtractorError,
11     fix_xml_ampersands,
12     int_or_none,
13     merge_dicts,
14     orderedSet,
15     parse_duration,
16     qualities,
17     str_or_none,
18     strip_jsonp,
19     unified_strdate,
20     unified_timestamp,
21     url_or_none,
22     urlencode_postdata,
23 )
24 class NPOBaseIE(InfoExtractor):
25 <a name="0"></a>    def _get_token(self, video_id):
26         return self._download_json(
27             'http://ida.omroep.nl/app.php/auth', video_id,
28             note='Downloading token')['<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>token']
29 class NPOIE(NPOBaseIE):
30     IE_NAME = 'npo'
31     IE_DESC = 'npo.nl, ntr.nl, omroepwnl.nl, zapp.nl and npo3.nl'
32     _VALID_URL = r'''(?x)
33                     (?:
34                         npo:|
35                         https?://
36                             (?:www\.)?
37                             (?:
38                                 npo\.nl/(?:[^/]+/)*|
39                                 (?:ntr|npostart)\.nl/(?:[^/]+/){2,}|
40                                 omroepwnl\.nl/video/fragment/[^/]+__|
41                                 (?:zapp|npo3)\.nl/(?:[^/]+/){2,}
42                             )
43                         )
44                         (?P&lt;id&gt;[^/?#]+)
45                 '''
46     _TESTS = [{
47         'url': 'http://www.npo.nl/nieuwsuur/22-06-2014/VPWON_1220719',
48         'md5': '4b3f9c429157ec4775f2c9cb7b911016',
49         'info_dict': {
50             'id': 'VPWON_1220719',
51             'ext': 'm4v',
52             'title': 'Nieuwsuur',
53             'description': 'Dagelijks tussen tien en elf: nieuws, sport en achtergronden.',
54             'upload_date': '20140622',
55         },
56     }, {
57         'url': 'http://www.npo.nl/de-mega-mike-mega-thomas-show/27-02-2009/VARA_101191800',
58         'md5': 'da50a5787dbfc1603c4ad80f31c5120b',
59         'info_dict': {
60             'id': 'VARA_101191800',
61             'ext': 'm4v',
62             'title': 'De Mega Mike &amp; Mega Thomas show: The best of.',
63             'description': 'md5:3b74c97fc9d6901d5a665aac0e5400f4',
64             'upload_date': '20090227',
65             'duration': 2400,
66         },
67     }, {
68         'url'</b></font>: 'http://www.npo.nl/tegenlicht/25-02-2013/VPWON_1169289',
69         'md5': 'f8065e4e5a7824068ed3c7e783178f2c',
70         'info_dict': {
71             'id': 'VPWON_1169289',
72             'ext': 'm4v',
73             'title': 'Tegenlicht: Zwart geld. De toekomst komt uit Afrika',
74             'description': 'md5:52cf4eefbc96fffcbdc06d024147abea',
75             'upload_date': '20130225',
76             'duration': 3000,
77         },
78     }, {
79         'url': 'http://www.npo.nl/de-nieuwe-mens-deel-1/21-07-2010/WO_VPRO_043706',
80         'info_dict': {
81             'id': 'WO_VPRO_043706',
82             'ext': 'm4v',
83             'title': 'De nieuwe mens - Deel 1',
84             'description': 'md5:518ae51ba1293ffb80d8d8ce90b74e4b',
85             'duration': 4680,
86         },
87         'params': {
88             'skip_download': True,
89         }
90     }, {
91         'url': 'http://www.npo.nl/hoe-gaat-europa-verder-na-parijs/10-01-2015/WO_NOS_762771',
92         'info_dict': {
93             'id': 'WO_NOS_762771',
94             'ext': 'mp4',
95             'title': 'Hoe gaat Europa verder na Parijs?',
96         },
97         'params': {
98             'skip_download': True,
99         }
100     }, {
101         'url': 'http://www.ntr.nl/Aap-Poot-Pies/27/detail/Aap-poot-pies/VPWON_1233944#content',
102         'info_dict': {
103             'id': 'VPWON_1233944',
104             'ext': 'm4v',
105             'title': 'Aap, poot, pies',
106             'description': 'md5:c9c8005d1869ae65b858e82c01a91fde',
107             'upload_date': '20150508',
108             'duration': 599,
109         },
110         'params': {
111             'skip_download': True,
112         }
113     }, {
114         'url': 'http://www.omroepwnl.nl/video/fragment/vandaag-de-dag-verkiezingen__POMS_WNL_853698',
115         'info_dict': {
116             'id': 'POW_00996502',
117             'ext': 'm4v',
118             'title': '''"Dit is wel een 'landslide'..."''',
119             'description': 'md5:f8d66d537dfb641380226e31ca57b8e8',
120             'upload_date': '20150508',
121             'duration': 462,
122         },
123         'params': {
124             'skip_download': True,
125         }
126     }, {
127         'url': 'http://www.npo.nl/jouw-stad-rotterdam/29-01-2017/RBX_FUNX_6683215/RBX_FUNX_7601437',
128         'info_dict': {
129             'id': 'RBX_FUNX_6683215',
130             'ext': 'mp3',
131             'title': 'Jouw Stad Rotterdam',
132             'description': 'md5:db251505244f097717ec59fabc372d9f',
133         },
134         'params': {
135             'skip_download': True,
136         }
137     }, {
138         'url': 'http://www.zapp.nl/de-bzt-show/gemist/KN_1687547',
139         'only_matching': True,
140     }, {
141         'url': 'http://www.zapp.nl/de-bzt-show/filmpjes/POMS_KN_7315118',
142         'only_matching': True,
143     }, {
144         'url': 'http://www.zapp.nl/beste-vrienden-quiz/extra-video-s/WO_NTR_1067990',
145         'only_matching': True,
146     }, {
147         'url': 'https://www.npo3.nl/3onderzoekt/16-09-2015/VPWON_1239870',
148         'only_matching': True,
149     }, {
150         'url': 'npo:LI_NL1_4188102',
151         'only_matching': True,
152     }, {
153         'url': 'http://www.npo.nl/radio-gaga/13-06-2017/BNN_101383373',
154         'only_matching': True,
155     }, {
156         'url': 'https://www.zapp.nl/1803-skelterlab/instructie-video-s/740-instructievideo-s/POMS_AT_11736927',
157         'only_matching': True,
158     }, {
159         'url': 'https://www.npostart.nl/broodje-gezond-ei/28-05-2018/KN_1698996',
160         'only_matching': True,
161     }, {
162         'url': 'https://npo.nl/KN_1698996',
163         'only_matching': True,
164     }]
165     @classmethod
166     def suitable(cls, url):
167         return (False if any(ie.suitable(url)
168                 for ie in (NPOLiveIE, NPORadioIE, NPORadioFragmentIE))
169                 else super(NPOIE, cls).suitable(url))
170     def _real_extract(self, url):
171         video_id = self._match_id(url)
172         return self._get_info(url, video_id) or self._get_old_info(video_id)
173     def _get_info(self, url, video_id):
174         token = self._download_json(
175             'https://www.npostart.nl/api/token', video_id,
176             'Downloading token', headers={
177                 'Referer': url,
178                 'X-Requested-With': 'XMLHttpRequest',
179             })['token']
180         player = self._download_json(
181             'https://www.npostart.nl/player/%s' % video_id, video_id,
182             'Downloading player JSON', data=urlencode_postdata({
183                 'autoplay': 0,
184                 'share': 1,
185                 'pageUrl': url,
186                 'hasAdConsent': 0,
187                 '_token': token,
188             }))
189         player_token = player['token']
190         drm = False
191         format_urls = set()
192         formats = []
193         for profile in ('hls', 'dash-widevine', 'dash-playready', 'smooth'):
194             streams = self._download_json(
195                 'https://start-player.npo.nl/video/%s/streams' % video_id,
196                 video_id, 'Downloading %s profile JSON' % profile, fatal=False,
197                 query={
198                     'profile': profile,
199                     'quality': 'npo',
200                     'tokenId': player_token,
201                     'streamType': 'broadcast',
202                 })
203             if not streams:
204                 continue
205             stream = streams.get('stream')
206             if not isinstance(stream, dict):
207                 continue
208             stream_url = url_or_none(stream.get('src'))
209             if not stream_url or stream_url in format_urls:
210                 continue
211             format_urls.add(stream_url)
212             if stream.get('protection') is not None or stream.get('keySystemOptions') is not None:
213                 drm = True
214                 continue
215             stream_type = stream.get('type')
216             stream_ext = determine_ext(stream_url)
217             if stream_type == 'application/dash+xml' or stream_ext == 'mpd':
218                 formats.extend(self._extract_mpd_formats(
219                     stream_url, video_id, mpd_id='dash', fatal=False))
220             elif stream_type == 'application/vnd.apple.mpegurl' or stream_ext == 'm3u8':
221                 formats.extend(self._extract_m3u8_formats(
222                     stream_url, video_id, ext='mp4',
223                     entry_protocol='m3u8_native', m3u8_id='hls', fatal=False))
224             elif re.search(r'\.isml?/Manifest', stream_url):
225                 formats.extend(self._extract_ism_formats(
226                     stream_url, video_id, ism_id='mss', fatal=False))
227             else:
228                 formats.append({
229                     'url': stream_url,
230                 })
231         if not formats:
232             if drm:
233                 raise ExtractorError('This video is DRM protected.', expected=True)
234             return
235         self._sort_formats(formats)
236         info = {
237             'id': video_id,
238             'title': video_id,
239             'formats': formats,
240         }
241         embed_url = url_or_none(player.get('embedUrl'))
242         if embed_url:
243             webpage = self._download_webpage(
244                 embed_url, video_id, 'Downloading embed page', fatal=False)
245             if webpage:
246                 video = self._parse_json(
247                     self._search_regex(
248                         r'\bvideo\s*=\s*({.+?})\s*;', webpage, 'video',
249                         default='{}'), video_id)
250                 if video:
251                     title = video.get('episodeTitle')
252                     subtitles = {}
253                     subtitles_list = video.get('subtitles')
254                     if isinstance(subtitles_list, list):
255                         for cc in subtitles_list:
256                             cc_url = url_or_none(cc.get('src'))
257                             if not cc_url:
258                                 continue
259                             lang = str_or_none(cc.get('language')) or 'nl'
260                             subtitles.setdefault(lang, []).append({
261                                 'url': cc_url,
262                             })
263                     return merge_dicts({
264                         'title': title,
265                         'description': video.get('description'),
266                         'thumbnail': url_or_none(
267                             video.get('still_image_url') or video.get('orig_image_url')),
268                         'duration': int_or_none(video.get('duration')),
269                         'timestamp': unified_timestamp(video.get('broadcastDate')),
270                         'creator': video.get('channel'),
271                         'series': video.get('title'),
272                         'episode': title,
273                         'episode_number': int_or_none(video.get('episodeNumber')),
274                         'subtitles': subtitles,
275                     }, info)
276         return info
277     def _get_old_info(self, video_id):
278         metadata = self._download_json(
279             'http://e.omroep.nl/metadata/%s' % video_id,
280             video_id,
281             transform_source=strip_jsonp,
282         )
283         error = metadata.get('error')
284         if error:
285             raise ExtractorError(error, expected=True)
286         video_id = metadata.get('prid') or video_id
287         title = metadata['titel']
288         sub_title = metadata.get('aflevering_titel')
289         if sub_title and sub_title != title:
290             title += ': %s' % sub_title
291         token = self._get_token(video_id)
292         formats = []
293         urls = set()
294         def is_legal_url(format_url):
295             return format_url and format_url not in urls and re.match(
296                 r'^(?:https?:)?//', format_url)
297         QUALITY_LABELS = ('Laag', 'Normaal', 'Hoog')
298         QUALITY_FORMATS = ('adaptive', 'wmv_sb', 'h264_sb', 'wmv_bb', 'h264_bb', 'wvc1_std', 'h264_std')
299         quality_from_label = qualities(QUALITY_LABELS)
300         quality_from_format_id = qualities(QUALITY_FORMATS)
301         items = self._download_json(
302             'http://ida.omroep.nl/app.php/%s' % video_id, video_id,
303             'Downloading formats JSON', query={
304                 'adaptive': 'yes',
305                 'token': token,
306             })['items'][0]
307         for num, item in enumerate(items):
308             item_url = item.get('url')
309             if not is_legal_url(item_url):
310                 continue
311             urls.add(item_url)
312             format_id = self._search_regex(
313                 r'video/ida/([^/]+)', item_url, 'format id',
314                 default=None)
315             item_label = item.get('label')
316             def add_format_url(format_url):
317                 width = int_or_none(self._search_regex(
318                     r'(\d+)[xX]\d+', format_url, 'width', default=None))
319                 height = int_or_none(self._search_regex(
320                     r'\d+[xX](\d+)', format_url, 'height', default=None))
321                 if item_label in QUALITY_LABELS:
322                     quality = quality_from_label(item_label)
323                     f_id = item_label
324                 elif item_label in QUALITY_FORMATS:
325                     quality = quality_from_format_id(format_id)
326                     f_id = format_id
327                 else:
328                     quality, f_id = [None] * 2
329                 formats.append({
330                     'url': format_url,
331                     'format_id': f_id,
332                     'width': width,
333                     'height': height,
334                     'quality': quality,
335                 })
336             if item.get('contentType') in ('url', 'audio'):
337                 add_format_url(item_url)
338                 continue
339             try:
340                 stream_info = self._download_json(
341                     item_url + '&amp;type=json', video_id,
342                     'Downloading %s stream JSON'
343                     % item_label or item.get('format') or format_id or num)
344             except ExtractorError as ee:
345                 if isinstance(ee.cause, compat_HTTPError) and ee.cause.code == 404:
346                     error = (self._parse_json(
347                         ee.cause.read().decode(), video_id,
348                         fatal=False) or {}).get('errorstring')
349                     if error:
350                         raise ExtractorError(error, expected=True)
351                 raise
352             if isinstance(stream_info, compat_str):
353                 if not stream_info.startswith('http'):
354                     continue
355                 video_url = stream_info
356             else:
357                 video_url = stream_info.get('url')
358             if not video_url or 'vodnotavailable.' in video_url or video_url in urls:
359                 continue
360             urls.add(video_url)
361             if determine_ext(video_url) == 'm3u8':
362                 formats.extend(self._extract_m3u8_formats(
363                     video_url, video_id, ext='mp4',
364                     entry_protocol='m3u8_native', m3u8_id='hls', fatal=False))
365             else:
366                 add_format_url(video_url)
367         is_live = metadata.get('medium') == 'live'
368         if not is_live:
369             for num, stream in enumerate(metadata.get('streams', [])):
370                 stream_url = stream.get('url')
371                 if not is_legal_url(stream_url):
372                     continue
373                 urls.add(stream_url)
374                 stream_type = stream.get('type', '').lower()
375                 if stream_type in ['ss', 'ms']:
376                     continue
377                 if stream_type == 'hds':
378                     f4m_formats = self._extract_f4m_formats(
379                         stream_url, video_id, fatal=False)
380                     for f4m_format in f4m_formats:
381                         f4m_format['preference'] = -1
382                     formats.extend(f4m_formats)
383                 elif stream_type == 'hls':
384                     formats.extend(self._extract_m3u8_formats(
385                         stream_url, video_id, ext='mp4', fatal=False))
386                 elif '.asf' in stream_url:
387                     asx = self._download_xml(
388                         stream_url, video_id,
389                         'Downloading stream %d ASX playlist' % num,
390                         transform_source=fix_xml_ampersands, fatal=False)
391                     if not asx:
392                         continue
393                     ref = asx.find('./ENTRY/Ref')
394                     if ref is None:
395                         continue
396                     video_url = ref.get('href')
397                     if not video_url or video_url in urls:
398                         continue
399                     urls.add(video_url)
400                     formats.append({
401                         'url': video_url,
402                         'ext': stream.get('formaat', 'asf'),
403                         'quality': stream.get('kwaliteit'),
404                         'preference': -10,
405                     })
406                 else:
407                     formats.append({
408                         'url': stream_url,
409                         'quality': stream.get('kwaliteit'),
410                     })
411         self._sort_formats(formats)
412         subtitles = {}
413         if metadata.get('tt888') == 'ja':
414             subtitles['nl'] = [{
415                 'ext': 'vtt',
416                 'url': 'http://tt888.omroep.nl/tt888/%s' % video_id,
417             }]
418         return {
419             'id': video_id,
420             'title': self._live_title(title) if is_live else title,
421             'description': metadata.get('info'),
422             'thumbnail': metadata.get('images', [{'url': None}])[-1]['url'],
423             'upload_date': unified_strdate(metadata.get('gidsdatum')),
424             'duration': parse_duration(metadata.get('tijdsduur')),
425             'formats': formats,
426             'subtitles': subtitles,
427             'is_live': is_live,
428         }
429 class NPOLiveIE(NPOBaseIE):
430     IE_NAME = 'npo.nl:live'
431     _VALID_URL = r'https?://(?:www\.)?npo(?:start)?\.nl/live(?:/(?P&lt;id&gt;[^/?#&amp;]+))?'
432     _TESTS = [{
433         'url': 'http://www.npo.nl/live/npo-1',
434         'info_dict': {
435             'id': 'LI_NL1_4188102',
436             'display_id': 'npo-1',
437             'ext': 'mp4',
438             'title': 're:^NPO 1 [0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}$',
439             'is_live': True,
440         },
441         'params': {
442             'skip_download': True,
443         }
444     }, {
445         'url': 'http://www.npo.nl/live',
446         'only_matching': True,
447     }, {
448         'url': 'https://www.npostart.nl/live/npo-1',
449         'only_matching': True,
450     }]
451     def _real_extract(self, url):
452         display_id = self._match_id(url) or 'npo-1'
453         webpage = self._download_webpage(url, display_id)
454         live_id = self._search_regex(
455             [r'media-id="([^"]+)"', r'data-prid="([^"]+)"'], webpage, 'live id')
456         return {
457             '_type': 'url_transparent',
458             'url': 'npo:%s' % live_id,
459             'ie_key': NPOIE.ie_key(),
460             'id': live_id,
461             'display_id': display_id,
462         }
463 class NPORadioIE(InfoExtractor):
464     IE_NAME = 'npo.nl:radio'
465     _VALID_URL = r'https?://(?:www\.)?npo\.nl/radio/(?P&lt;id&gt;[^/]+)'
466     _TEST = {
467         'url': 'http://www.npo.nl/radio/radio-1',
468         'info_dict': {
469             'id': 'radio-1',
470             'ext': 'mp3',
471             'title': 're:^NPO Radio 1 [0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}$',
472             'is_live': True,
473         },
474         'params': {
475             'skip_download': True,
476         }
477     }
478     @classmethod
479     def suitable(cls, url):
480         return False if NPORadioFragmentIE.suitable(url) else super(NPORadioIE, cls).suitable(url)
481     @staticmethod
482     def _html_get_attribute_regex(attribute):
483         return r'{0}\s*=\s*\'([^\']+)\''.format(attribute)
484     def _real_extract(self, url):
485         video_id = self._match_id(url)
486         webpage = self._download_webpage(url, video_id)
487         title = self._html_search_regex(
488             self._html_get_attribute_regex('data-channel'), webpage, 'title')
489         stream = self._parse_json(
490             self._html_search_regex(self._html_get_attribute_regex('data-streams'), webpage, 'data-streams'),
491             video_id)
492         codec = stream.get('codec')
493         return {
494             'id': video_id,
495             'url': stream['url'],
496             'title': self._live_title(title),
497             'acodec': codec,
498             'ext': codec,
499             'is_live': True,
500         }
501 class NPORadioFragmentIE(InfoExtractor):
502     IE_NAME = 'npo.nl:radio:fragment'
503     _VALID_URL = r'https?://(?:www\.)?npo\.nl/radio/[^/]+/fragment/(?P&lt;id&gt;\d+)'
504     _TEST = {
505         'url': 'http://www.npo.nl/radio/radio-5/fragment/174356',
506         'md5': 'dd8cc470dad764d0fdc70a9a1e2d18c2',
507         'info_dict': {
508             'id': '174356',
509             'ext': 'mp3',
510             'title': 'Jubileumconcert Willeke Alberti',
511         },
512     }
513     def _real_extract(self, url):
514         audio_id = self._match_id(url)
515         webpage = self._download_webpage(url, audio_id)
516         title = self._html_search_regex(
517             r'href="/radio/[^/]+/fragment/%s" title="([^"]+)"' % audio_id,
518             webpage, 'title')
519         audio_url = self._search_regex(
520             r"data-streams='([^']+)'", webpage, 'audio url')
521         return {
522             'id': audio_id,
523             'url': audio_url,
524             'title': title,
525         }
526 class NPODataMidEmbedIE(InfoExtractor):
527     def _real_extract(self, url):
528         display_id = self._match_id(url)
529         webpage = self._download_webpage(url, display_id)
530         video_id = self._search_regex(
531             r'data-mid=(["\'])(?P&lt;id&gt;(?:(?!\1).)+)\1', webpage, 'video_id', group='id')
532         return {
533             '_type': 'url_transparent',
534             'ie_key': 'NPO',
535             'url': 'npo:%s' % video_id,
536             'display_id': display_id
537         }
538 class SchoolTVIE(NPODataMidEmbedIE):
539     IE_NAME = 'schooltv'
540     _VALID_URL = r'https?://(?:www\.)?schooltv\.nl/video/(?P&lt;id&gt;[^/?#&amp;]+)'
541     _TEST = {
542         'url': 'http://www.schooltv.nl/video/ademhaling-de-hele-dag-haal-je-adem-maar-wat-gebeurt-er-dan-eigenlijk-in-je-lichaam/',
543         'info_dict': {
544             'id': 'WO_NTR_429477',
545             'display_id': 'ademhaling-de-hele-dag-haal-je-adem-maar-wat-gebeurt-er-dan-eigenlijk-in-je-lichaam',
546             'title': 'Ademhaling: De hele dag haal je adem. Maar wat gebeurt er dan eigenlijk in je lichaam?',
547             'ext': 'mp4',
548             'description': 'md5:abfa0ff690adb73fd0297fd033aaa631'
549         },
550         'params': {
551             'skip_download': True
552         }
553     }
554 class HetKlokhuisIE(NPODataMidEmbedIE):
555     IE_NAME = 'hetklokhuis'
556     _VALID_URL = r'https?://(?:www\.)?hetklokhuis\.nl/[^/]+/\d+/(?P&lt;id&gt;[^/?#&amp;]+)'
557     _TEST = {
558         'url': 'http://hetklokhuis.nl/tv-uitzending/3471/Zwaartekrachtsgolven',
559         'info_dict': {
560             'id': 'VPWON_1260528',
561             'display_id': 'Zwaartekrachtsgolven',
562             'ext': 'm4v',
563             'title': 'Het Klokhuis: Zwaartekrachtsgolven',
564             'description': 'md5:c94f31fb930d76c2efa4a4a71651dd48',
565             'upload_date': '20170223',
566         },
567         'params': {
568             'skip_download': True
569         }
570     }
571 class NPOPlaylistBaseIE(NPOIE):
572     def _real_extract(self, url):
573         playlist_id = self._match_id(url)
574         webpage = self._download_webpage(url, playlist_id)
575         entries = [
576             self.url_result('npo:%s' % video_id if not video_id.startswith('http') else video_id)
577             for video_id in orderedSet(re.findall(self._PLAYLIST_ENTRY_RE, webpage))
578         ]
579         playlist_title = self._html_search_regex(
580             self._PLAYLIST_TITLE_RE, webpage, 'playlist title',
581             default=None) or self._og_search_title(webpage)
582         return self.playlist_result(entries, playlist_id, playlist_title)
583 class VPROIE(NPOPlaylistBaseIE):
584     IE_NAME = 'vpro'
585     _VALID_URL = r'https?://(?:www\.)?(?:(?:tegenlicht\.)?vpro|2doc)\.nl/(?:[^/]+/)*(?P&lt;id&gt;[^/]+)\.html'
586     _PLAYLIST_TITLE_RE = (r'&lt;h1[^&gt;]+class=["\'].*?\bmedia-platform-title\b.*?["\'][^&gt;]*&gt;([^&lt;]+)',
587                           r'&lt;h5[^&gt;]+class=["\'].*?\bmedia-platform-subtitle\b.*?["\'][^&gt;]*&gt;([^&lt;]+)')
588     _PLAYLIST_ENTRY_RE = r'data-media-id="([^"]+)"'
589     _TESTS = [
590         {
591             'url': 'http://tegenlicht.vpro.nl/afleveringen/2012-2013/de-toekomst-komt-uit-afrika.html',
592             'md5': 'f8065e4e5a7824068ed3c7e783178f2c',
593             'info_dict': {
594                 'id': 'VPWON_1169289',
595                 'ext': 'm4v',
596                 'title': 'De toekomst komt uit Afrika',
597                 'description': 'md5:52cf4eefbc96fffcbdc06d024147abea',
598                 'upload_date': '20130225',
599             },
600             'skip': 'Video gone',
601         },
602         {
603             'url': 'http://www.vpro.nl/programmas/2doc/2015/sergio-herman.html',
604             'info_dict': {
605                 'id': 'sergio-herman',
606                 'title': 'sergio herman: fucking perfect',
607             },
608             'playlist_count': 2,
609         },
610         {
611             'url': 'http://www.vpro.nl/programmas/2doc/2015/education-education.html',
612             'info_dict': {
613                 'id': 'education-education',
614                 'title': 'education education',
615             },
616             'playlist_count': 2,
617         },
618         {
619             'url': 'http://www.2doc.nl/documentaires/series/2doc/2015/oktober/de-tegenprestatie.html',
620             'info_dict': {
621                 'id': 'de-tegenprestatie',
622                 'title': 'De Tegenprestatie',
623             },
624             'playlist_count': 2,
625         }, {
626             'url': 'http://www.2doc.nl/speel~VARA_101375237~mh17-het-verdriet-van-nederland~.html',
627             'info_dict': {
628                 'id': 'VARA_101375237',
629                 'ext': 'm4v',
630                 'title': 'MH17: Het verdriet van Nederland',
631                 'description': 'md5:09e1a37c1fdb144621e22479691a9f18',
632                 'upload_date': '20150716',
633             },
634             'params': {
635                 'skip_download': True
636             },
637         }
638     ]
639 class WNLIE(NPOPlaylistBaseIE):
640     IE_NAME = 'wnl'
641     _VALID_URL = r'https?://(?:www\.)?omroepwnl\.nl/video/detail/(?P&lt;id&gt;[^/]+)__\d+'
642     _PLAYLIST_TITLE_RE = r'(?s)&lt;h1[^&gt;]+class="subject"[^&gt;]*&gt;(.+?)&lt;/h1&gt;'
643     _PLAYLIST_ENTRY_RE = r'&lt;a[^&gt;]+href="([^"]+)"[^&gt;]+class="js-mid"[^&gt;]*&gt;Deel \d+'
644     _TESTS = [{
645         'url': 'http://www.omroepwnl.nl/video/detail/vandaag-de-dag-6-mei__060515',
646         'info_dict': {
647             'id': 'vandaag-de-dag-6-mei',
648             'title': 'Vandaag de Dag 6 mei',
649         },
650         'playlist_count': 4,
651     }]
652 class AndereTijdenIE(NPOPlaylistBaseIE):
653     IE_NAME = 'anderetijden'
654     _VALID_URL = r'https?://(?:www\.)?anderetijden\.nl/programma/(?:[^/]+/)+(?P&lt;id&gt;[^/?#&amp;]+)'
655     _PLAYLIST_TITLE_RE = r'(?s)&lt;h1[^&gt;]+class=["\'].*?\bpage-title\b.*?["\'][^&gt;]*&gt;(.+?)&lt;/h1&gt;'
656     _PLAYLIST_ENTRY_RE = r'&lt;figure[^&gt;]+class=["\']episode-container episode-page["\'][^&gt;]+data-prid=["\'](.+?)["\']'
657     _TESTS = [{
658         'url': 'http://anderetijden.nl/programma/1/Andere-Tijden/aflevering/676/Duitse-soldaten-over-de-Slag-bij-Arnhem',
659         'info_dict': {
660             'id': 'Duitse-soldaten-over-de-Slag-bij-Arnhem',
661             'title': 'Duitse soldaten over de Slag bij Arnhem',
662         },
663         'playlist_count': 3,
664     }]
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
