<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_state_format_slots.py &amp; test_symlink_1.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_state_format_slots.py &amp; test_symlink_1.py
      </h3>
<h1 align="center">
        7.0%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_state_format_slots.py (9.404388%)<th>test_symlink_1.py (5.6497173%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(130-137)<td><a href="#" name="0">(72-77)</a><td align="center"><font color="#ff0000">17</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(5-19)<td><a href="#" name="1">(9-22)</a><td align="center"><font color="#c30000">13</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_state_format_slots.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>import logging
2 import pytest  # pylint: disable=unused-import
3 import salt.exceptions
4 import salt.state
5 import salt.utils.files
6 import salt.utils.platform
7 from tests.support.mock import MagicMock, patch
8 from tests.support.unit import skipIf
9 log = logging.getLogger(__name__)
10 @pytest.fixture
11 def</b></font> state_obj():
12     with patch("salt.state.State._gather_pillar"):
13         minion_opts = salt.config.DEFAULT_MINION_OPTS.copy()
14         yield salt.state.State(minion_opts)
15 def test_format_slots_no_slots(state_obj):
16     cdata = {"args": ["arg"], "kwargs": {"key": "val"}}
17     state_obj.format_slots(cdata)
18     assert cdata == {"args": ["arg"], "kwargs": {"key": "val"}}
19 @pytest.mark.slow_test
20 def test_format_slots_arg(state_obj):
21     cdata = {
22         "args": ["__slot__:salt:mod.fun(fun_arg, fun_key=fun_val)"],
23         "kwargs": {"key": "val"},
24     }
25     mock = MagicMock(return_value="fun_return")
26     with patch.dict(state_obj.functions, {"mod.fun": mock}):
27         state_obj.format_slots(cdata)
28     mock.assert_called_once_with("fun_arg", fun_key="fun_val")
29     assert cdata == {"args": ["fun_return"], "kwargs": {"key": "val"}}
30 @pytest.mark.slow_test
31 def test_format_slots_dict_arg(state_obj):
32     cdata = {
33         "args": [{"subarg": "__slot__:salt:mod.fun(fun_arg, fun_key=fun_val)"}],
34         "kwargs": {"key": "val"},
35     }
36     mock = MagicMock(return_value="fun_return")
37     with patch.dict(state_obj.functions, {"mod.fun": mock}):
38         state_obj.format_slots(cdata)
39     mock.assert_called_once_with("fun_arg", fun_key="fun_val")
40     assert cdata == {"args": [{"subarg": "fun_return"}], "kwargs": {"key": "val"}}
41 @pytest.mark.slow_test
42 def test_format_slots_listdict_arg(state_obj):
43     cdata = {
44         "args": [[{"subarg": "__slot__:salt:mod.fun(fun_arg, fun_key=fun_val)"}]],
45         "kwargs": {"key": "val"},
46     }
47     mock = MagicMock(return_value="fun_return")
48     with patch.dict(state_obj.functions, {"mod.fun": mock}):
49         state_obj.format_slots(cdata)
50     mock.assert_called_once_with("fun_arg", fun_key="fun_val")
51     assert cdata == {"args": [[{"subarg": "fun_return"}]], "kwargs": {"key": "val"}}
52 @pytest.mark.slow_test
53 def test_format_slots_liststr_arg(state_obj):
54     cdata = {
55         "args": [["__slot__:salt:mod.fun(fun_arg, fun_key=fun_val)"]],
56         "kwargs": {"key": "val"},
57     }
58     mock = MagicMock(return_value="fun_return")
59     with patch.dict(state_obj.functions, {"mod.fun": mock}):
60         state_obj.format_slots(cdata)
61     mock.assert_called_once_with("fun_arg", fun_key="fun_val")
62     assert cdata == {"args": [["fun_return"]], "kwargs": {"key": "val"}}
63 @pytest.mark.slow_test
64 def test_format_slots_kwarg(state_obj):
65     cdata = {
66         "args": ["arg"],
67         "kwargs": {"key": "__slot__:salt:mod.fun(fun_arg, fun_key=fun_val)"},
68     }
69     mock = MagicMock(return_value="fun_return")
70     with patch.dict(state_obj.functions, {"mod.fun": mock}):
71         state_obj.format_slots(cdata)
72     mock.assert_called_once_with("fun_arg", fun_key="fun_val")
73     assert cdata == {"args": ["arg"], "kwargs": {"key": "fun_return"}}
74 @pytest.mark.slow_test
75 def test_format_slots_multi(state_obj):
76     cdata = {
77         "args": [
78             "__slot__:salt:test_mod.fun_a(a_arg, a_key=a_kwarg)",
79             "__slot__:salt:test_mod.fun_b(b_arg, b_key=b_kwarg)",
80         ],
81         "kwargs": {
82             "kw_key_1": "__slot__:salt:test_mod.fun_c(c_arg, c_key=c_kwarg)",
83 <a name="0"></a>            "kw_key_2": "__slot__:salt:test_mod.fun_d(d_arg, d_key=d_kwarg)",
84         },
85     }
86     mock_a <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>= MagicMock(return_value="fun_a_return")
87     mock_b = MagicMock(return_value="fun_b_return")
88     mock_c = MagicMock(return_value="fun_c_return")
89     mock_d = MagicMock(return_value="fun_d_return")
90     with patch.dict(
91         state_obj.functions,
92         {
93             "test_mod.fun_a"</b></font>: mock_a,
94             "test_mod.fun_b": mock_b,
95             "test_mod.fun_c": mock_c,
96             "test_mod.fun_d": mock_d,
97         },
98     ):
99         state_obj.format_slots(cdata)
100     mock_a.assert_called_once_with("a_arg", a_key="a_kwarg")
101     mock_b.assert_called_once_with("b_arg", b_key="b_kwarg")
102     mock_c.assert_called_once_with("c_arg", c_key="c_kwarg")
103     mock_d.assert_called_once_with("d_arg", d_key="d_kwarg")
104     assert cdata == {
105         "args": ["fun_a_return", "fun_b_return"],
106         "kwargs": {"kw_key_1": "fun_c_return", "kw_key_2": "fun_d_return"},
107     }
108 @pytest.mark.slow_test
109 def test_format_slots_malformed(state_obj):
110     sls_data = {
111         "args": [
112             "__slot__:NOT_SUPPORTED:not.called()",
113             "__slot__:salt:not.called(",
114             "__slot__:salt:",
115             "__slot__:salt",
116             "__slot__:",
117             "__slot__",
118         ],
119         "kwargs": {
120             "key3": "__slot__:NOT_SUPPORTED:not.called()",
121             "key4": "__slot__:salt:not.called(",
122             "key5": "__slot__:salt:",
123             "key6": "__slot__:salt",
124             "key7": "__slot__:",
125             "key8": "__slot__",
126         },
127     }
128     cdata = sls_data.copy()
129     mock = MagicMock(return_value="return")
130     with patch.dict(state_obj.functions, {"not.called": mock}):
131         state_obj.format_slots(cdata)
132     mock.assert_not_called()
133     assert cdata == sls_data
134 @pytest.mark.slow_test
135 def test_slot_traverse_dict(state_obj):
136     cdata = {
137         "args": ["arg"],
138         "kwargs": {"key": "__slot__:salt:mod.fun(fun_arg, fun_key=fun_val).key1"},
139     }
140     return_data = {"key1": "value1"}
141     mock = MagicMock(return_value=return_data)
142     with patch.dict(state_obj.functions, {"mod.fun": mock}):
143         state_obj.format_slots(cdata)
144     mock.assert_called_once_with("fun_arg", fun_key="fun_val")
145     assert cdata == {"args": ["arg"], "kwargs": {"key": "value1"}}
146 @pytest.mark.slow_test
147 def test_slot_append(state_obj):
148     cdata = {
149         "args": ["arg"],
150         "kwargs": {
151             "key": "__slot__:salt:mod.fun(fun_arg, fun_key=fun_val).key1 ~ thing~",
152         },
153     }
154     return_data = {"key1": "value1"}
155     mock = MagicMock(return_value=return_data)
156     with patch.dict(state_obj.functions, {"mod.fun": mock}):
157         state_obj.format_slots(cdata)
158     mock.assert_called_once_with("fun_arg", fun_key="fun_val")
159     assert cdata == {"args": ["arg"], "kwargs": {"key": "value1thing~"}}
160 @skipIf(
161     salt.utils.platform.is_windows(),
162     "Skipped until parallel states can be fixed on Windows",
163 )
164 def test_format_slots_parallel(state_obj):
165     high_data = {
166         "always-changes-and-succeeds": {
167             "test": [
168                 {"changes": True},
169                 {"comment": "__slot__:salt:test.echo(fun_return)"},
170                 {"parallel": True},
171                 "configurable_test_state",
172                 {"order": 10000},
173             ],
174             "__env__": "base",
175             "__sls__": "parallel_slots",
176         }
177     }
178     state_obj.jid = "123"
179     res = state_obj.call_high(high_data)
180     state_obj.jid = None
181     [(_, data)] = res.items()
182     assert data["comment"] == "fun_return"
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_symlink_1.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import logging
2 import os
3 import pytest
4 import salt.serializers.json as jsonserializer
5 <a name="1"></a>import salt.serializers.msgpack as msgpackserializer
6 import salt.serializers.plist as plistserializer
7 import salt.serializers.python as pythonserializer
8 <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>import salt.serializers.yaml as yamlserializer
9 import salt.states.file as filestate
10 import salt.utils.files
11 import salt.utils.json
12 import salt.utils.platform
13 import salt.utils.win_functions
14 import salt.utils.yaml
15 from tests.support.mock import MagicMock, patch
16 log = logging.getLogger(__name__)
17 @pytest.fixture
18 def</b></font> configure_loader_modules():
19     return {
20         filestate: {
21             "__env__": "base",
22             "__salt__": {"file.manage_file": False},
23             "__serializers__": {
24                 "yaml.serialize": yamlserializer.serialize,
25                 "yaml.seserialize": yamlserializer.serialize,
26                 "python.serialize": pythonserializer.serialize,
27                 "json.serialize": jsonserializer.serialize,
28                 "plist.serialize": plistserializer.serialize,
29                 "msgpack.serialize": msgpackserializer.serialize,
30             },
31             "__opts__": {"test": False, "cachedir": ""},
32             "__instance_id__": "",
33             "__low__": {},
34             "__utils__": {},
35         }
36     }
37 def test_symlink():
38     name = os.sep + os.path.join("tmp", "testfile.txt")
39     target = salt.utils.files.mkstemp()
40     test_dir = os.sep + "tmp"
41     user = "salt"
42     if salt.utils.platform.is_windows():
43         group = "salt"
44     else:
45         group = "saltstack"
46     def return_val(kwargs):
47         val = {
48             "name": name,
49             "result": False,
50             "comment": "",
51             "changes": {},
52         }
53         val.update(kwargs)
54         return val
55     mock_t = MagicMock(return_value=True)
56     mock_f = MagicMock(return_value=False)
57 <a name="0"></a>    mock_empty = MagicMock(return_value="")
58     mock_uid = MagicMock(return_value="U1001")
59     mock_gid = MagicMock(return_value="g1001")
60     mock_target <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>= MagicMock(return_value=target)
61     mock_user = MagicMock(return_value=user)
62     mock_grp = MagicMock(return_value=group)
63     mock_os_error = MagicMock(side_effect=OSError)
64     with patch.dict(filestate.__salt__, {"config.manage_mode"</b></font>: mock_t}):
65         comt = "Must provide name to file.symlink"
66         ret = return_val({"comment": comt, "name": ""})
67         assert filestate.symlink("", target) == ret
68     with patch.dict(
69         filestate.__salt__,
70         {
71             "config.manage_mode": mock_t,
72             "file.user_to_uid": mock_empty,
73             "file.group_to_gid": mock_empty,
74             "user.info": mock_empty,
75             "user.current": mock_user,
76         },
77     ):
78         if salt.utils.platform.is_windows():
79             comt = "User {} does not exist".format(user)
80             ret = return_val({"comment": comt, "name": name})
81         else:
82             comt = "User {} does not exist. Group {} does not exist.".format(
83                 user, group
84             )
85             ret = return_val({"comment": comt, "name": name})
86         assert filestate.symlink(name, target, user=user, group=group) == ret
87     with patch.dict(
88         filestate.__salt__,
89         {
90             "config.manage_mode": mock_t,
91             "file.user_to_uid": mock_uid,
92             "file.group_to_gid": mock_gid,
93             "file.is_link": mock_f,
94             "user.info": mock_empty,
95             "user.current": mock_user,
96         },
97     ), patch.dict(filestate.__opts__, {"test": True}), patch.object(
98         os.path, "exists", mock_f
99     ):
100         if salt.utils.platform.is_windows():
101             comt = "User {} does not exist".format(user)
102             ret = return_val(
103                 {"comment": comt, "result": False, "name": name, "changes": {}}
104             )
105         else:
106             comt = "Symlink {} to {} is set for creation".format(name, target)
107             ret = return_val(
108                 {"comment": comt, "result": None, "changes": {"new": name}}
109             )
110         assert filestate.symlink(name, target, user=user, group=group) == ret
111     with patch.dict(
112         filestate.__salt__,
113         {
114             "config.manage_mode": mock_t,
115             "file.user_to_uid": mock_uid,
116             "file.group_to_gid": mock_gid,
117             "file.is_link": mock_f,
118             "user.info": mock_empty,
119             "user.current": mock_user,
120         },
121     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
122         os.path, "isdir", mock_f
123     ), patch.object(
124         os.path, "exists", mock_f
125     ):
126         if salt.utils.platform.is_windows():
127             comt = "User {} does not exist".format(user)
128             ret = return_val(
129                 {"comment": comt, "result": False, "name": name, "changes": {}}
130             )
131         else:
132             comt = "Directory {} for symlink is not present".format(test_dir)
133             ret = return_val({"comment": comt, "result": False, "changes": {}})
134         assert filestate.symlink(name, target, user=user, group=group) == ret
135     with patch.dict(
136         filestate.__salt__,
137         {
138             "config.manage_mode": mock_t,
139             "file.user_to_uid": mock_uid,
140             "file.group_to_gid": mock_gid,
141             "file.is_link": mock_t,
142             "file.readlink": mock_target,
143             "user.info": mock_empty,
144             "user.current": mock_user,
145         },
146     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
147         os.path, "isdir", mock_t
148     ), patch.object(
149         salt.states.file, "_check_symlink_ownership", mock_t
150     ), patch(
151         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
152     ):
153         if salt.utils.platform.is_windows():
154             comt = "Symlink {} is present and owned by {}".format(name, user)
155         else:
156             comt = "Symlink {} is present and owned by {}:{}".format(name, user, group)
157         ret = return_val({"comment": comt, "result": True, "changes": {}})
158         assert filestate.symlink(name, target, user=user, group=group) == ret
159     with patch.dict(
160         filestate.__salt__,
161         {
162             "config.manage_mode": mock_t,
163             "file.user_to_uid": mock_uid,
164             "file.group_to_gid": mock_gid,
165             "file.is_link": mock_f,
166             "file.readlink": mock_target,
167             "user.info": mock_empty,
168             "user.current": mock_user,
169         },
170     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
171         os.path, "isdir", mock_t
172     ), patch.object(
173         os.path, "exists", mock_t
174     ), patch.object(
175         os.path, "lexists", mock_t
176     ), patch(
177         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
178     ):
179         comt = (
180             "Symlink &amp; backup dest exists and Force not set. {} -&gt; "
181             "{} - backup: {}".format(name, target, os.path.join(test_dir, "SALT"))
182         )
183         ret.update({"comment": comt, "result": False, "changes": {}})
184         assert (
185             filestate.symlink(name, target, user=user, group=group, backupname="SALT")
186             == ret
187         )
188     with patch.dict(
189         filestate.__salt__,
190         {
191             "config.manage_mode": mock_t,
192             "file.user_to_uid": mock_uid,
193             "file.group_to_gid": mock_gid,
194             "file.is_link": mock_f,
195             "file.readlink": mock_target,
196             "user.info": mock_empty,
197             "user.current": mock_user,
198         },
199     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
200         os.path, "exists", mock_t
201     ), patch.object(
202         os.path, "isfile", mock_t
203     ), patch.object(
204         os.path, "isdir", mock_t
205     ), patch(
206         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
207     ):
208         comt = "Backupname must be an absolute path or a file name: {}".format(
209             "tmp/SALT"
210         )
211         ret.update({"comment": comt, "result": False, "changes": {}})
212         assert (
213             filestate.symlink(
214                 name, target, user=user, group=group, backupname="tmp/SALT"
215             )
216             == ret
217         )
218     with patch.dict(
219         filestate.__salt__,
220         {
221             "config.manage_mode": mock_t,
222             "file.user_to_uid": mock_uid,
223             "file.group_to_gid": mock_gid,
224             "file.is_link": mock_f,
225             "file.readlink": mock_target,
226             "user.info": mock_empty,
227             "user.current": mock_user,
228         },
229     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
230         os.path, "isdir", mock_t
231     ), patch.object(
232         os.path, "exists", mock_t
233     ), patch.object(
234         os.path, "isfile", mock_t
235     ), patch(
236         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
237     ):
238         comt = "File exists where the symlink {} should be".format(name)
239         ret = return_val({"comment": comt, "changes": {}, "result": False})
240         assert filestate.symlink(name, target, user=user, group=group) == ret
241     with patch.dict(
242         filestate.__salt__,
243         {
244             "config.manage_mode": mock_t,
245             "file.user_to_uid": mock_uid,
246             "file.group_to_gid": mock_gid,
247             "file.is_link": mock_f,
248             "file.readlink": mock_target,
249             "file.symlink": mock_t,
250             "user.info": mock_t,
251             "file.lchown": mock_f,
252         },
253     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
254         os.path, "isdir", MagicMock(side_effect=[True, False])
255     ), patch.object(
256         os.path, "isdir", mock_t
257     ), patch.object(
258         os.path, "exists", mock_t
259     ), patch(
260         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
261     ):
262         comt = "Directory exists where the symlink {} should be".format(name)
263         ret = return_val({"comment": comt, "result": False, "changes": {}})
264         assert filestate.symlink(name, target, user=user, group=group) == ret
265     with patch.dict(
266         filestate.__salt__,
267         {
268             "config.manage_mode": mock_t,
269             "file.user_to_uid": mock_uid,
270             "file.group_to_gid": mock_gid,
271             "file.is_link": mock_f,
272             "file.readlink": mock_target,
273             "file.symlink": mock_os_error,
274             "user.info": mock_t,
275             "file.lchown": mock_f,
276         },
277     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
278         os.path, "isdir", MagicMock(side_effect=[True, False])
279     ), patch.object(
280         os.path, "isfile", mock_f
281     ), patch(
282         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
283     ):
284         comt = "Unable to create new symlink {} -&gt; {}: ".format(name, target)
285         ret = return_val({"comment": comt, "result": False, "changes": {}})
286         assert filestate.symlink(name, target, user=user, group=group) == ret
287     with patch.dict(
288         filestate.__salt__,
289         {
290             "config.manage_mode": mock_t,
291             "file.user_to_uid": mock_uid,
292             "file.group_to_gid": mock_gid,
293             "file.is_link": mock_f,
294             "file.readlink": mock_target,
295             "file.symlink": mock_t,
296             "user.info": mock_t,
297             "file.lchown": mock_f,
298             "file.get_user": mock_user,
299             "file.get_group": mock_grp,
300         },
301     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
302         os.path, "isdir", MagicMock(side_effect=[True, False])
303     ), patch.object(
304         os.path, "isfile", mock_f
305     ), patch(
306         "salt.states.file._check_symlink_ownership", return_value=True
307     ), patch(
308         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
309     ):
310         comt = "Created new symlink {} -&gt; {}".format(name, target)
311         ret = return_val({"comment": comt, "result": True, "changes": {"new": name}})
312         assert filestate.symlink(name, target, user=user, group=group) == ret
313     with patch.dict(
314         filestate.__salt__,
315         {
316             "config.manage_mode": mock_t,
317             "file.user_to_uid": mock_uid,
318             "file.group_to_gid": mock_gid,
319             "file.is_link": mock_f,
320             "file.readlink": mock_target,
321             "file.symlink": mock_t,
322             "user.info": mock_t,
323             "file.lchown": mock_f,
324             "file.get_user": mock_empty,
325             "file.get_group": mock_empty,
326         },
327     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
328         os.path, "isdir", MagicMock(side_effect=[True, False])
329     ), patch.object(
330         os.path, "isfile", mock_f
331     ), patch(
332         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
333     ), patch(
334         "salt.states.file._set_symlink_ownership", return_value=False
335     ), patch(
336         "salt.states.file._check_symlink_ownership", return_value=False
337     ):
338         comt = (
339             "Created new symlink {} -&gt; {}, but was unable to set "
340             "ownership to {}:{}".format(name, target, user, group)
341         )
342         ret = return_val({"comment": comt, "result": False, "changes": {"new": name}})
343         assert filestate.symlink(name, target, user=user, group=group) == ret
344     with patch.dict(
345         filestate.__salt__,
346         {
347             "config.manage_mode": mock_t,
348             "file.user_to_uid": mock_uid,
349             "file.group_to_gid": mock_gid,
350             "file.is_link": mock_f,
351             "file.readlink": mock_target,
352             "file.symlink": mock_t,
353             "user.info": mock_t,
354             "file.lchown": mock_f,
355             "file.get_user": mock_empty,
356             "file.get_group": mock_empty,
357         },
358     ), patch.dict(filestate.__opts__, {"test": False}), patch.object(
359         os.path, "isdir", MagicMock(side_effect=[True, False])
360     ), patch.object(
361         os.path, "isfile", mock_f
362     ), patch(
363         "salt.utils.win_functions.get_sid_from_name", return_value="test-sid"
364     ), patch(
365         "salt.states.file._set_symlink_ownership", return_value=True
366     ), patch(
367         "salt.states.file._check_symlink_ownership", return_value=True
368     ):
369         group = None
370         comt = "Created new symlink {} -&gt; {}".format(name, target)
371         ret = return_val({"comment": comt, "result": True, "changes": {"new": name}})
372         res = filestate.symlink(name, target, user=user, group=user)
373         assert res == ret
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
