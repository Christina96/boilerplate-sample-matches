<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for test_salt_auth.py & test_stringutils.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for test_salt_auth.py & test_stringutils.py
      </h3>
      <h1 align="center">
        2.7%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>test_salt_auth.py (9.523809%)<TH>test_stringutils.py (1.6073478%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match127873-0.html#0',2,'match127873-1.html#0',3)" NAME="0">(33-36)<TD><A HREF="javascript:ZweiFrames('match127873-0.html#0',2,'match127873-1.html#0',3)" NAME="0">(192-199)</A><TD ALIGN=center><FONT COLOR="#ff0000">14</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_salt_auth.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
&quot;&quot;&quot;
    tests.integration.shell.auth
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
&quot;&quot;&quot;


import logging

import pytest
import salt.utils.platform
import salt.utils.pycrypto

log = logging.getLogger(__name__)

pytestmark = [
    pytest.mark.slow_test,
    pytest.mark.skip_if_not_root,
    pytest.mark.destructive_test,
    pytest.mark.skip_on_windows,
]

USERA = &quot;saltdev-auth&quot;
USERA_PWD = &quot;saltdev&quot;


@pytest.fixture(scope=&quot;module&quot;)
def saltdev_account(sminion):
    try:
        assert sminion.functions.user.add(USERA, createhome=False)
<A NAME="0"></A>        assert sminion.functions.shadow.set_password(
            USERA,
            USERA_PWD
            if salt<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match127873-1.html#0',3,'match127873-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>.utils.platform.is_darwin()
            else salt.utils.pycrypto.gen_hash(password=USERA_PWD),
        )
        assert USERA in sminion.functions.user.list_users(</B></FONT>)
        # Run tests
        yield
    finally:
        sminion.functions.user.delete(USERA, remove=True)


SALTOPS = &quot;saltops&quot;


@pytest.fixture(scope=&quot;module&quot;)
def saltops_group(sminion):
    try:
        assert sminion.functions.group.add(SALTOPS)
        # Run tests
        yield
    finally:
        sminion.functions.group.delete(SALTOPS)


USERB = &quot;saltdev-adm&quot;
USERB_PWD = USERA_PWD


@pytest.fixture(scope=&quot;module&quot;)
def saltadm_account(sminion, saltops_group):
    try:
        assert sminion.functions.user.add(USERB, groups=[SALTOPS], createhome=False)
        assert sminion.functions.shadow.set_password(
            USERB,
            USERB_PWD
            if salt.utils.platform.is_darwin()
            else salt.utils.pycrypto.gen_hash(password=USERB_PWD),
        )
        assert USERB in sminion.functions.user.list_users()
        # Run tests
        yield
    finally:
        sminion.functions.user.delete(USERB, remove=True)


def test_pam_auth_valid_user(salt_minion, salt_cli, saltdev_account):
    &quot;&quot;&quot;
    test that pam auth mechanism works with a valid user
    &quot;&quot;&quot;
    # test user auth against pam
    ret = salt_cli.run(
        &quot;-a&quot;,
        &quot;pam&quot;,
        &quot;--username&quot;,
        USERA,
        &quot;--password&quot;,
        USERA_PWD,
        &quot;test.ping&quot;,
        minion_tgt=salt_minion.id,
    )
    assert ret.exitcode == 0
    assert ret.json is True


def test_pam_auth_invalid_user(salt_minion, salt_cli, saltdev_account):
    &quot;&quot;&quot;
    test pam auth mechanism errors for an invalid user
    &quot;&quot;&quot;
    ret = salt_cli.run(
        &quot;-a&quot;,
        &quot;pam&quot;,
        &quot;--username&quot;,
        &quot;nouser&quot;,
        &quot;--password&quot;,
        &quot;1234&quot;,
        &quot;test.ping&quot;,
        minion_tgt=salt_minion.id,
    )
    assert ret.stdout == &quot;Authentication error occurred.&quot;


def test_pam_auth_valid_group(salt_minion, salt_cli, saltadm_account):
    &quot;&quot;&quot;
    test that pam auth mechanism works for a valid group
    &quot;&quot;&quot;
    # test group auth against pam: saltadm is not configured in
    # external_auth, but saltops is and saldadm is a member of saltops
    ret = salt_cli.run(
        &quot;-a&quot;,
        &quot;pam&quot;,
        &quot;--username&quot;,
        USERB,
        &quot;--password&quot;,
        USERB_PWD,
        &quot;test.ping&quot;,
        minion_tgt=salt_minion.id,
    )
    assert ret.exitcode == 0
    assert ret.json is True
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_stringutils.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
&quot;&quot;&quot;
Tests for stringutils utility file.
&quot;&quot;&quot;

import builtins
import re
import sys
import textwrap

import pytest
import salt.utils.stringutils
from tests.support.mock import patch
from tests.support.unit import LOREM_IPSUM


@pytest.fixture(scope=&quot;function&quot;)
def unicode():
    UNICODE = &quot;中国語 (繁体)&quot;
    STR = BYTES = UNICODE.encode(&quot;utf-8&quot;)
    return UNICODE, STR, BYTES


@pytest.fixture(scope=&quot;function&quot;)
def eggs():
    # This is an example of a unicode string with й constructed using two separate
    # code points. Do not modify it.
    eggs = &quot;\u044f\u0438\u0306\u0446\u0430&quot;
    return eggs


@pytest.fixture(scope=&quot;function&quot;)
def latin1_unicode():
    LATIN1_UNICODE = &quot;räksmörgås&quot;
    LATIN1_BYTES = LATIN1_UNICODE.encode(&quot;latin-1&quot;)
    return LATIN1_UNICODE, LATIN1_BYTES


@pytest.fixture()
def single_txt():
    return &quot;&quot;&quot;
# set variable identifying the chroot you work in (used in the prompt below)
if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
&quot;&quot;&quot;


@pytest.fixture()
def double_txt():
    return &quot;&quot;&quot;
# set variable identifying the chroot you work in (used in the prompt below)
if [ -z &quot;$debian_chroot&quot; ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
&quot;&quot;&quot;


@pytest.fixture()
def single_double_txt():
    return &quot;&quot;&quot;
# set variable identifying the chroot you work in (used in the prompt below)
if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi

# set variable identifying the chroot you work in (used in the prompt below)
if [ -z &quot;$debian_chroot&quot; ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
&quot;&quot;&quot;


@pytest.fixture()
def single_double_same_line_txt():
    return &quot;&quot;&quot;
# set variable identifying the chroot you work in (used in the prompt below)
if [ -z '$debian_chroot' ] &amp;&amp; [ -r &quot;/etc/debian_chroot&quot; ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
&quot;&quot;&quot;


@pytest.fixture()
def match():
    return &quot;&quot;&quot;
# set variable identifying the chroot you work in (used in the prompt below)
if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi


# set variable identifying the chroot you work in (used in the prompt below)
if [ -z &quot;$debian_chroot&quot; ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi


# set variable identifying the chroot you work in (used in the prompt below)
if [ -z &quot;$debian_chroot&quot; ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi


# set variable identifying the chroot you work in (used in the prompt below)
if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi


# set variable identifying the chroot you work in (used in the prompt below)
if [ -z '$debian_chroot' ] &amp;&amp; [ -r &quot;/etc/debian_chroot&quot; ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
&quot;&quot;&quot;


def test_single_quotes(single_txt, match):
    regex = salt.utils.stringutils.build_whitespace_split_regex(single_txt)
    assert re.search(regex, match)


def test_double_quotes(double_txt, match):
    regex = salt.utils.stringutils.build_whitespace_split_regex(double_txt)
    assert re.search(regex, match)


def test_single_and_double_quotes(single_double_txt, match):
    regex = salt.utils.stringutils.build_whitespace_split_regex(single_double_txt)
    assert re.search(regex, match)


def test_issue_2227(single_double_same_line_txt, match):
    regex = salt.utils.stringutils.build_whitespace_split_regex(
        single_double_same_line_txt
    )
    assert re.search(regex, match)


def test_contains_whitespace():
    does_contain_whitespace = &quot;A brown fox jumped over the red hen.&quot;
    does_not_contain_whitespace = &quot;Abrownfoxjumpedovertheredhen.&quot;

    assert salt.utils.stringutils.contains_whitespace(does_contain_whitespace) is True
    assert (
        salt.utils.stringutils.contains_whitespace(does_not_contain_whitespace) is False
    )


def test_to_num():
    assert salt.utils.stringutils.to_num(&quot;7&quot;) == 7
    assert isinstance(salt.utils.stringutils.to_num(&quot;7&quot;), int)
    assert salt.utils.stringutils.to_num(&quot;7.0&quot;) == 7
    assert isinstance(salt.utils.stringutils.to_num(&quot;7.0&quot;), float)
    assert salt.utils.stringutils.to_num(&quot;Seven&quot;) == &quot;Seven&quot;
    assert isinstance(salt.utils.stringutils.to_num(&quot;Seven&quot;), str)


def test_to_none():
    assert salt.utils.stringutils.to_none(&quot;&quot;) is None
    assert salt.utils.stringutils.to_none(&quot;  &quot;) is None
    # Ensure that we do not inadvertently convert certain strings or 0 to None
    assert salt.utils.stringutils.to_none(&quot;None&quot;) is not None
    assert salt.utils.stringutils.to_none(0) is not None


def test_is_binary():
    assert salt.utils.stringutils.is_binary(LOREM_IPSUM) is False
    # Also test bytestring
    assert (
        salt.utils.stringutils.is_binary(salt.utils.stringutils.is_binary(LOREM_IPSUM))
        is False
    )

    zero_str = &quot;{}{}&quot;.format(LOREM_IPSUM, &quot;\0&quot;)
    assert salt.utils.stringutils.is_binary(zero_str) is True
    # Also test bytestring
    assert (
        salt.utils.stringutils.is_binary(salt.utils.stringutils.to_bytes(zero_str))
        is True
    )

    # To to ensure safe exit if str passed doesn't evaluate to True
    assert salt.utils.stringutils.is_binary(&quot;&quot;) is False
    assert salt.utils.stringutils.is_binary(b&quot;&quot;) is False

    nontext = 3 * &quot;&quot;.join([chr(x) for x in range(1, 32) if x not in (8, 9, 10, 12, 13)])
    almost_bin_str = &quot;{}{}&quot;.format(LOREM_IPSUM[:100], nontext[:42])

<A NAME="0"></A>    assert salt.utils.stringutils.is_binary(almost_bin_str) is False
    # Also test bytestring
    assert (
        salt<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match127873-0.html#0',2,'match127873-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>.utils.stringutils.is_binary(
            salt.utils.stringutils.to_bytes(almost_bin_str)
        )
        is False
    )

    bin_str = almost_bin_str + &quot;\x01&quot;
    assert salt.utils.stringutils.is_binary(</B></FONT>bin_str) is True
    # Also test bytestring
    assert (
        salt.utils.stringutils.is_binary(salt.utils.stringutils.to_bytes(bin_str))
        is True
    )


def test_to_str(unicode):
    UNICODE = unicode[0]
    BYTES = unicode[2]

    for x in (123, (1, 2, 3), [1, 2, 3], {1: 23}, None):
        assert pytest.raises(TypeError, salt.utils.stringutils.to_str, x)
    assert salt.utils.stringutils.to_str(&quot;plugh&quot;) == &quot;plugh&quot;
    assert salt.utils.stringutils.to_str(&quot;áéíóúý&quot;, &quot;utf-8&quot;) == &quot;áéíóúý&quot;
    assert salt.utils.stringutils.to_str(BYTES, &quot;utf-8&quot;) == UNICODE
    assert salt.utils.stringutils.to_str(bytearray(BYTES), &quot;utf-8&quot;) == UNICODE
    # Test situation when a minion returns incorrect utf-8 string because of... million reasons
    ut2 = b&quot;\x9c&quot;
    assert pytest.raises(
        UnicodeDecodeError, salt.utils.stringutils.to_str, ut2, &quot;utf-8&quot;
    )
    assert salt.utils.stringutils.to_str(ut2, &quot;utf-8&quot;, &quot;replace&quot;) == &quot;\ufffd&quot;
    assert pytest.raises(
        UnicodeDecodeError,
        salt.utils.stringutils.to_str,
        bytearray(ut2),
        &quot;utf-8&quot;,
    )
    assert salt.utils.stringutils.to_str(bytearray(ut2), &quot;utf-8&quot;, &quot;replace&quot;) == &quot;\ufffd&quot;


def test_to_bytes(unicode):
    UNICODE = unicode[0]
    BYTES = unicode[2]

    for x in (123, (1, 2, 3), [1, 2, 3], {1: 23}, None):
        assert pytest.raises(TypeError, salt.utils.stringutils.to_bytes, x)

    assert salt.utils.stringutils.to_bytes(&quot;xyzzy&quot;) == b&quot;xyzzy&quot;
    assert salt.utils.stringutils.to_bytes(BYTES) == BYTES
    assert salt.utils.stringutils.to_bytes(bytearray(BYTES)) == BYTES
    assert salt.utils.stringutils.to_bytes(UNICODE, &quot;utf-8&quot;) == BYTES

    # Test utf-8 fallback with ascii default encoding
    with patch.object(builtins, &quot;__salt_system_encoding__&quot;, &quot;ascii&quot;):
        assert salt.utils.stringutils.to_bytes(&quot;Ψ&quot;) == b&quot;\xce\xa8&quot;


def test_to_unicode(eggs, unicode, latin1_unicode):
    UNICODE = unicode[0]
    BYTES = unicode[2]
    LATIN1_UNICODE = latin1_unicode[0]
    LATIN1_BYTES = latin1_unicode[1]

    assert salt.utils.stringutils.to_unicode(eggs, normalize=True) == &quot;яйца&quot;
    assert salt.utils.stringutils.to_unicode(eggs, normalize=False) != &quot;яйца&quot;
    assert (
        salt.utils.stringutils.to_unicode(LATIN1_BYTES, encoding=&quot;latin-1&quot;)
        == LATIN1_UNICODE
    )
    assert salt.utils.stringutils.to_unicode(&quot;plugh&quot;) == &quot;plugh&quot;
    assert salt.utils.stringutils.to_unicode(&quot;áéíóúý&quot;) == &quot;áéíóúý&quot;
    assert salt.utils.stringutils.to_unicode(BYTES, &quot;utf-8&quot;) == UNICODE
    assert salt.utils.stringutils.to_unicode(bytearray(BYTES), &quot;utf-8&quot;) == UNICODE


def test_to_unicode_multi_encoding(latin1_unicode):
    LATIN1_UNICODE = latin1_unicode[0]
    LATIN1_BYTES = latin1_unicode[1]
    assert (
        salt.utils.stringutils.to_unicode(LATIN1_BYTES, encoding=(&quot;utf-8&quot;, &quot;latin1&quot;))
        == LATIN1_UNICODE
    )


def test_build_whitespace_split_regex():
    # With 3.7+,  re.escape only escapes special characters, no longer
    # escaping all characters other than ASCII letters, numbers and
    # underscores.  This includes commas.
    if sys.version_info &gt;= (3, 7):
        expected_regex = (
            &quot;(?m)^(?:[\\s]+)?Lorem(?:[\\s]+)?ipsum(?:[\\s]+)?dolor(?:[\\s]+)?sit(?:[\\s]+)?amet,&quot;
            &quot;(?:[\\s]+)?$&quot;
        )
    else:
        expected_regex = (
            &quot;(?m)^(?:[\\s]+)?Lorem(?:[\\s]+)?ipsum(?:[\\s]+)?dolor(?:[\\s]+)?sit(?:[\\s]+)?amet\\,&quot;
            &quot;(?:[\\s]+)?$&quot;
        )
    assert (
        salt.utils.stringutils.build_whitespace_split_regex(
            &quot; &quot;.join(LOREM_IPSUM.split()[:5])
        )
        == expected_regex
    )


def test_get_context():
    expected_context = textwrap.dedent(
        &quot;&quot;&quot;\
        ---
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque eget urna a arcu lacinia sagittis.
        Sed scelerisque, lacus eget malesuada vestibulum, justo diam facilisis tortor, in sodales dolor
        [...]
        ---&quot;&quot;&quot;
    )
    assert (
        salt.utils.stringutils.get_context(LOREM_IPSUM, 1, num_lines=1)
        == expected_context
    )


def test_get_context_has_enough_context():
    template = &quot;1\n2\n3\n4\n5\n6\n7\n8\n9\na\nb\nc\nd\ne\nf&quot;
    context = salt.utils.stringutils.get_context(template, 8)
    expected = &quot;---\n[...]\n3\n4\n5\n6\n7\n8\n9\na\nb\nc\nd\n[...]\n---&quot;
    assert expected == context


def test_get_context_at_top_of_file():
    template = &quot;1\n2\n3\n4\n5\n6\n7\n8\n9\na\nb\nc\nd\ne\nf&quot;
    context = salt.utils.stringutils.get_context(template, 1)
    expected = &quot;---\n1\n2\n3\n4\n5\n6\n[...]\n---&quot;
    assert expected == context


def test_get_context_at_bottom_of_file():
    template = &quot;1\n2\n3\n4\n5\n6\n7\n8\n9\na\nb\nc\nd\ne\nf&quot;
    context = salt.utils.stringutils.get_context(template, 15)
    expected = &quot;---\n[...]\na\nb\nc\nd\ne\nf\n---&quot;
    assert expected == context


def test_get_context_2_context_lines():
    template = &quot;1\n2\n3\n4\n5\n6\n7\n8\n9\na\nb\nc\nd\ne\nf&quot;
    context = salt.utils.stringutils.get_context(template, 8, num_lines=2)
    expected = &quot;---\n[...]\n6\n7\n8\n9\na\n[...]\n---&quot;
    assert expected == context


def test_get_context_with_marker():
    template = &quot;1\n2\n3\n4\n5\n6\n7\n8\n9\na\nb\nc\nd\ne\nf&quot;
    context = salt.utils.stringutils.get_context(
        template, 8, num_lines=2, marker=&quot; &lt;---&quot;
    )
    expected = &quot;---\n[...]\n6\n7\n8 &lt;---\n9\na\n[...]\n---&quot;
    assert expected == context


def test_expr_match():
    val = &quot;foo/bar/baz&quot;
    # Exact match
    assert salt.utils.stringutils.expr_match(val, val) is True
    # Glob match
    assert salt.utils.stringutils.expr_match(val, &quot;foo/*/baz&quot;) is True
    # Glob non-match
    assert salt.utils.stringutils.expr_match(val, &quot;foo/*/bar&quot;) is False
    # Regex match
    assert salt.utils.stringutils.expr_match(val, r&quot;foo/\w+/baz&quot;) is True
    # Regex non-match
    assert salt.utils.stringutils.expr_match(val, r&quot;foo/\w/baz&quot;) is False


def test_check_whitelist_blacklist():
    &quot;&quot;&quot;
    Ensure that whitelist matching works on both PY2 and PY3
    &quot;&quot;&quot;
    whitelist = [&quot;one/two/three&quot;, r&quot;web[0-9]&quot;]
    blacklist = [&quot;four/five/six&quot;, r&quot;web[5-9]&quot;]

    # Tests with string whitelist/blacklist
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_one&quot;,
            whitelist=whitelist[1],
            blacklist=None,
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_one&quot;,
            whitelist=whitelist[1],
            blacklist=[],
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web1&quot;,
            whitelist=whitelist[1],
            blacklist=None,
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web1&quot;,
            whitelist=whitelist[1],
            blacklist=[],
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=None,
            blacklist=blacklist[1],
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=[],
            blacklist=blacklist[1],
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_five&quot;,
            whitelist=None,
            blacklist=blacklist[1],
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_five&quot;,
            whitelist=[],
            blacklist=blacklist[1],
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=whitelist[1],
            blacklist=blacklist[1],
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web4&quot;,
            whitelist=whitelist[1],
            blacklist=blacklist[1],
        )
        is True
    )

    # Tests with list whitelist/blacklist
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_one&quot;,
            whitelist=whitelist,
            blacklist=None,
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_one&quot;,
            whitelist=whitelist,
            blacklist=[],
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web1&quot;,
            whitelist=whitelist,
            blacklist=None,
        )
        is True
    )

    assert salt.utils.stringutils.check_whitelist_blacklist(
        &quot;web1&quot;,
        whitelist=whitelist,
        blacklist=[],
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=None,
            blacklist=blacklist,
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=[],
            blacklist=blacklist,
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_five&quot;,
            whitelist=None,
            blacklist=blacklist,
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_five&quot;,
            whitelist=[],
            blacklist=blacklist,
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=whitelist,
            blacklist=blacklist,
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web4&quot;,
            whitelist=whitelist,
            blacklist=blacklist,
        )
        is True
    )

    # Tests with set whitelist/blacklist
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_one&quot;,
            whitelist=set(whitelist),
            blacklist=None,
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_one&quot;,
            whitelist=set(whitelist),
            blacklist=set(),
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web1&quot;,
            whitelist=set(whitelist),
            blacklist=None,
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web1&quot;,
            whitelist=set(whitelist),
            blacklist=set(),
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=None,
            blacklist=set(blacklist),
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=set(),
            blacklist=set(blacklist),
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_five&quot;,
            whitelist=None,
            blacklist=set(blacklist),
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web_five&quot;,
            whitelist=set(),
            blacklist=set(blacklist),
        )
        is True
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web5&quot;,
            whitelist=set(whitelist),
            blacklist=set(blacklist),
        )
        is False
    )

    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            &quot;web4&quot;,
            whitelist=set(whitelist),
            blacklist=set(blacklist),
        )
        is True
    )

    # Test with invalid type for whitelist/blacklist
    assert pytest.raises(
        TypeError,
        salt.utils.stringutils.check_whitelist_blacklist,
        &quot;foo&quot;,
        whitelist=123,
    )
    assert pytest.raises(
        TypeError,
        salt.utils.stringutils.check_whitelist_blacklist,
        &quot;foo&quot;,
        blacklist=123,
    )


def test_check_include_exclude_empty():
    assert salt.utils.stringutils.check_include_exclude(&quot;/some/test&quot;) is True


def test_check_include_exclude_exclude():
    assert (
        salt.utils.stringutils.check_include_exclude(&quot;/some/test&quot;, None, &quot;*test*&quot;)
        is False
    )


def test_check_include_exclude_exclude_list():
    assert (
        salt.utils.stringutils.check_include_exclude(&quot;/some/test&quot;, None, [&quot;*test&quot;])
        is False
    )


def test_check_include_exclude_exclude_include():
    assert (
        salt.utils.stringutils.check_include_exclude(&quot;/some/test&quot;, &quot;*test*&quot;, &quot;/some/&quot;)
        is True
    )


def test_check_include_exclude_regex():
    assert (
        salt.utils.stringutils.check_include_exclude(
            &quot;/some/test&quot;, None, &quot;E@/some/(test|other)&quot;
        )
        is False
    )
</PRE>
</div>
  </div>
</body>
</html>
