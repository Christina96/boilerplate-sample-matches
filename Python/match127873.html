<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_salt_auth.py &amp; test_stringutils.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_salt_auth.py &amp; test_stringutils.py
      </h3>
<h1 align="center">
        2.7%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_salt_auth.py (9.523809%)<th>test_stringutils.py (1.6073478%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(33-36)<td><a href="#" name="0">(192-199)</a><td align="center"><font color="#ff0000">14</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_salt_auth.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import logging
2 import pytest
3 import salt.utils.platform
4 import salt.utils.pycrypto
5 log = logging.getLogger(__name__)
6 pytestmark = [
7     pytest.mark.slow_test,
8     pytest.mark.skip_if_not_root,
9     pytest.mark.destructive_test,
10     pytest.mark.skip_on_windows,
11 ]
12 USERA = "saltdev-auth"
13 USERA_PWD = "saltdev"
14 @pytest.fixture(scope="module")
15 def saltdev_account(sminion):
16     try:
17         assert sminion.functions.user.add(USERA, createhome=False)
18 <a name="0"></a>        assert sminion.functions.shadow.set_password(
19             USERA,
20             USERA_PWD
21             if salt<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.utils.platform.is_darwin()
22             else salt.utils.pycrypto.gen_hash(password=USERA_PWD),
23         )
24         assert USERA in sminion.functions.user.list_users(</b></font>)
25         yield
26     finally:
27         sminion.functions.user.delete(USERA, remove=True)
28 SALTOPS = "saltops"
29 @pytest.fixture(scope="module")
30 def saltops_group(sminion):
31     try:
32         assert sminion.functions.group.add(SALTOPS)
33         yield
34     finally:
35         sminion.functions.group.delete(SALTOPS)
36 USERB = "saltdev-adm"
37 USERB_PWD = USERA_PWD
38 @pytest.fixture(scope="module")
39 def saltadm_account(sminion, saltops_group):
40     try:
41         assert sminion.functions.user.add(USERB, groups=[SALTOPS], createhome=False)
42         assert sminion.functions.shadow.set_password(
43             USERB,
44             USERB_PWD
45             if salt.utils.platform.is_darwin()
46             else salt.utils.pycrypto.gen_hash(password=USERB_PWD),
47         )
48         assert USERB in sminion.functions.user.list_users()
49         yield
50     finally:
51         sminion.functions.user.delete(USERB, remove=True)
52 def test_pam_auth_valid_user(salt_minion, salt_cli, saltdev_account):
53     ret = salt_cli.run(
54         "-a",
55         "pam",
56         "--username",
57         USERA,
58         "--password",
59         USERA_PWD,
60         "test.ping",
61         minion_tgt=salt_minion.id,
62     )
63     assert ret.exitcode == 0
64     assert ret.json is True
65 def test_pam_auth_invalid_user(salt_minion, salt_cli, saltdev_account):
66     ret = salt_cli.run(
67         "-a",
68         "pam",
69         "--username",
70         "nouser",
71         "--password",
72         "1234",
73         "test.ping",
74         minion_tgt=salt_minion.id,
75     )
76     assert ret.stdout == "Authentication error occurred."
77 def test_pam_auth_valid_group(salt_minion, salt_cli, saltadm_account):
78     ret = salt_cli.run(
79         "-a",
80         "pam",
81         "--username",
82         USERB,
83         "--password",
84         USERB_PWD,
85         "test.ping",
86         minion_tgt=salt_minion.id,
87     )
88     assert ret.exitcode == 0
89     assert ret.json is True
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_stringutils.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import builtins
2 import re
3 import sys
4 import textwrap
5 import pytest
6 import salt.utils.stringutils
7 from tests.support.mock import patch
8 from tests.support.unit import LOREM_IPSUM
9 @pytest.fixture(scope="function")
10 def unicode():
11     UNICODE = "中国語 (繁体)"
12     STR = BYTES = UNICODE.encode("utf-8")
13     return UNICODE, STR, BYTES
14 @pytest.fixture(scope="function")
15 def eggs():
16     eggs = "\u044f\u0438\u0306\u0446\u0430"
17     return eggs
18 @pytest.fixture(scope="function")
19 def latin1_unicode():
20     LATIN1_UNICODE = "räksmörgås"
21     LATIN1_BYTES = LATIN1_UNICODE.encode("latin-1")
22     return LATIN1_UNICODE, LATIN1_BYTES
23 @pytest.fixture()
24 def single_txt():
25     return """
26 if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
27     debian_chroot=$(cat /etc/debian_chroot)
28 fi
29 @pytest.fixture()
30 def single_double_txt():
31     return """
32 if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
33     debian_chroot=$(cat /etc/debian_chroot)
34 fi
35 if [ -z "$debian_chroot" ] &amp;&amp; [ -r /etc/debian_chroot ]; then
36     debian_chroot=$(cat /etc/debian_chroot)
37 fi
38 @pytest.fixture()
39 def match():
40     return """
41 if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
42     debian_chroot=$(cat /etc/debian_chroot)
43 fi
44 if [ -z "$debian_chroot" ] &amp;&amp; [ -r /etc/debian_chroot ]; then
45     debian_chroot=$(cat /etc/debian_chroot)
46 fi
47 if [ -z "$debian_chroot" ] &amp;&amp; [ -r /etc/debian_chroot ]; then
48     debian_chroot=$(cat /etc/debian_chroot)
49 fi
50 if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
51     debian_chroot=$(cat /etc/debian_chroot)
52 fi
53 if [ -z '$debian_chroot' ] &amp;&amp; [ -r "/etc/debian_chroot" ]; then
54     debian_chroot=$(cat /etc/debian_chroot)
55 fi
56         salt<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.utils.stringutils.is_binary(
57             salt.utils.stringutils.to_bytes(almost_bin_str)
58         )
59         is False
60     )
61     bin_str = almost_bin_str + "\x01"
62     assert salt.utils.stringutils.is_binary(</b></font>bin_str) is True
63     assert (
64         salt.utils.stringutils.is_binary(salt.utils.stringutils.to_bytes(bin_str))
65         is True
66     )
67 def test_to_str(unicode):
68     UNICODE = unicode[0]
69     BYTES = unicode[2]
70     for x in (123, (1, 2, 3), [1, 2, 3], {1: 23}, None):
71         assert pytest.raises(TypeError, salt.utils.stringutils.to_str, x)
72     assert salt.utils.stringutils.to_str("plugh") == "plugh"
73     assert salt.utils.stringutils.to_str("áéíóúý", "utf-8") == "áéíóúý"
74     assert salt.utils.stringutils.to_str(BYTES, "utf-8") == UNICODE
75     assert salt.utils.stringutils.to_str(bytearray(BYTES), "utf-8") == UNICODE
76     ut2 = b"\x9c"
77     assert pytest.raises(
78         UnicodeDecodeError, salt.utils.stringutils.to_str, ut2, "utf-8"
79     )
80     assert salt.utils.stringutils.to_str(ut2, "utf-8", "replace") == "\ufffd"
81     assert pytest.raises(
82         UnicodeDecodeError,
83         salt.utils.stringutils.to_str,
84         bytearray(ut2),
85         "utf-8",
86     )
87     assert salt.utils.stringutils.to_str(bytearray(ut2), "utf-8", "replace") == "\ufffd"
88 def test_to_bytes(unicode):
89     UNICODE = unicode[0]
90     BYTES = unicode[2]
91     for x in (123, (1, 2, 3), [1, 2, 3], {1: 23}, None):
92         assert pytest.raises(TypeError, salt.utils.stringutils.to_bytes, x)
93     assert salt.utils.stringutils.to_bytes("xyzzy") == b"xyzzy"
94     assert salt.utils.stringutils.to_bytes(BYTES) == BYTES
95     assert salt.utils.stringutils.to_bytes(bytearray(BYTES)) == BYTES
96     assert salt.utils.stringutils.to_bytes(UNICODE, "utf-8") == BYTES
97     with patch.object(builtins, "__salt_system_encoding__", "ascii"):
98         assert salt.utils.stringutils.to_bytes("Ψ") == b"\xce\xa8"
99 def test_to_unicode(eggs, unicode, latin1_unicode):
100     UNICODE = unicode[0]
101     BYTES = unicode[2]
102     LATIN1_UNICODE = latin1_unicode[0]
103     LATIN1_BYTES = latin1_unicode[1]
104     assert salt.utils.stringutils.to_unicode(eggs, normalize=True) == "яйца"
105     assert salt.utils.stringutils.to_unicode(eggs, normalize=False) != "яйца"
106     assert (
107         salt.utils.stringutils.to_unicode(LATIN1_BYTES, encoding="latin-1")
108         == LATIN1_UNICODE
109     )
110     assert salt.utils.stringutils.to_unicode("plugh") == "plugh"
111     assert salt.utils.stringutils.to_unicode("áéíóúý") == "áéíóúý"
112     assert salt.utils.stringutils.to_unicode(BYTES, "utf-8") == UNICODE
113     assert salt.utils.stringutils.to_unicode(bytearray(BYTES), "utf-8") == UNICODE
114 def test_to_unicode_multi_encoding(latin1_unicode):
115     LATIN1_UNICODE = latin1_unicode[0]
116     LATIN1_BYTES = latin1_unicode[1]
117     assert (
118         salt.utils.stringutils.to_unicode(LATIN1_BYTES, encoding=("utf-8", "latin1"))
119         == LATIN1_UNICODE
120     )
121 def test_build_whitespace_split_regex():
122     if sys.version_info &gt;= (3, 7):
123         expected_regex = (
124             "(?m)^(?:[\\s]+)?Lorem(?:[\\s]+)?ipsum(?:[\\s]+)?dolor(?:[\\s]+)?sit(?:[\\s]+)?amet,"
125             "(?:[\\s]+)?$"
126         )
127     else:
128         expected_regex = (
129             "(?m)^(?:[\\s]+)?Lorem(?:[\\s]+)?ipsum(?:[\\s]+)?dolor(?:[\\s]+)?sit(?:[\\s]+)?amet\\,"
130             "(?:[\\s]+)?$"
131         )
132     assert (
133         salt.utils.stringutils.build_whitespace_split_regex(
134             " ".join(LOREM_IPSUM.split()[:5])
135         )
136         == expected_regex
137     )
138 def test_get_context():
139     expected_context = textwrap.dedent(
140     Ensure that whitelist matching works on both PY2 and PY3
141     """
142     whitelist = ["one/two/three", r"web[0-9]"]
143     blacklist = ["four/five/six", r"web[5-9]"]
144     assert (
145         salt.utils.stringutils.check_whitelist_blacklist(
146             "web_one",
147             whitelist=whitelist[1],
148             blacklist=None,
149         )
150         is False
151     )
152     assert (
153         salt.utils.stringutils.check_whitelist_blacklist(
154             "web_one",
155             whitelist=whitelist[1],
156             blacklist=[],
157         )
158         is False
159     )
160     assert (
161         salt.utils.stringutils.check_whitelist_blacklist(
162             "web1",
163             whitelist=whitelist[1],
164             blacklist=None,
165         )
166         is True
167     )
168     assert (
169         salt.utils.stringutils.check_whitelist_blacklist(
170             "web1",
171             whitelist=whitelist[1],
172             blacklist=[],
173         )
174         is True
175     )
176     assert (
177         salt.utils.stringutils.check_whitelist_blacklist(
178             "web5",
179             whitelist=None,
180             blacklist=blacklist[1],
181         )
182         is False
183     )
184     assert (
185         salt.utils.stringutils.check_whitelist_blacklist(
186             "web5",
187             whitelist=[],
188             blacklist=blacklist[1],
189         )
190         is False
191     )
192     assert (
193         salt.utils.stringutils.check_whitelist_blacklist(
194             "web_five",
195             whitelist=None,
196             blacklist=blacklist[1],
197         )
198         is True
199     )
200     assert (
201         salt.utils.stringutils.check_whitelist_blacklist(
202             "web_five",
203             whitelist=[],
204             blacklist=blacklist[1],
205         )
206         is True
207     )
208     assert (
209         salt.utils.stringutils.check_whitelist_blacklist(
210             "web5",
211             whitelist=whitelist[1],
212             blacklist=blacklist[1],
213         )
214         is False
215     )
216     assert (
217         salt.utils.stringutils.check_whitelist_blacklist(
218             "web4",
219             whitelist=whitelist[1],
220             blacklist=blacklist[1],
221         )
222         is True
223     )
224     assert (
225         salt.utils.stringutils.check_whitelist_blacklist(
226             "web_one",
227             whitelist=whitelist,
228             blacklist=None,
229         )
230         is False
231     )
232     assert (
233         salt.utils.stringutils.check_whitelist_blacklist(
234             "web_one",
235             whitelist=whitelist,
236             blacklist=[],
237         )
238         is False
239     )
240     assert (
241         salt.utils.stringutils.check_whitelist_blacklist(
242             "web1",
243             whitelist=whitelist,
244             blacklist=None,
245         )
246         is True
247     )
248     assert salt.utils.stringutils.check_whitelist_blacklist(
249         "web1",
250         whitelist=whitelist,
251         blacklist=[],
252     )
253     assert (
254         salt.utils.stringutils.check_whitelist_blacklist(
255             "web5",
256             whitelist=None,
257             blacklist=blacklist,
258         )
259         is False
260     )
261     assert (
262         salt.utils.stringutils.check_whitelist_blacklist(
263             "web5",
264             whitelist=[],
265             blacklist=blacklist,
266         )
267         is False
268     )
269     assert (
270         salt.utils.stringutils.check_whitelist_blacklist(
271             "web_five",
272             whitelist=None,
273             blacklist=blacklist,
274         )
275         is True
276     )
277     assert (
278         salt.utils.stringutils.check_whitelist_blacklist(
279             "web_five",
280             whitelist=[],
281             blacklist=blacklist,
282         )
283         is True
284     )
285     assert (
286         salt.utils.stringutils.check_whitelist_blacklist(
287             "web5",
288             whitelist=whitelist,
289             blacklist=blacklist,
290         )
291         is False
292     )
293     assert (
294         salt.utils.stringutils.check_whitelist_blacklist(
295             "web4",
296             whitelist=whitelist,
297             blacklist=blacklist,
298         )
299         is True
300     )
301     assert (
302         salt.utils.stringutils.check_whitelist_blacklist(
303             "web_one",
304             whitelist=set(whitelist),
305             blacklist=None,
306         )
307         is False
308     )
309     assert (
310         salt.utils.stringutils.check_whitelist_blacklist(
311             "web_one",
312             whitelist=set(whitelist),
313             blacklist=set(),
314         )
315         is False
316     )
317     assert (
318         salt.utils.stringutils.check_whitelist_blacklist(
319             "web1",
320             whitelist=set(whitelist),
321             blacklist=None,
322         )
323         is True
324     )
325     assert (
326         salt.utils.stringutils.check_whitelist_blacklist(
327             "web1",
328             whitelist=set(whitelist),
329             blacklist=set(),
330         )
331         is True
332     )
333     assert (
334         salt.utils.stringutils.check_whitelist_blacklist(
335             "web5",
336             whitelist=None,
337             blacklist=set(blacklist),
338         )
339         is False
340     )
341     assert (
342         salt.utils.stringutils.check_whitelist_blacklist(
343             "web5",
344             whitelist=set(),
345             blacklist=set(blacklist),
346         )
347         is False
348     )
349     assert (
350         salt.utils.stringutils.check_whitelist_blacklist(
351             "web_five",
352             whitelist=None,
353             blacklist=set(blacklist),
354         )
355         is True
356     )
357     assert (
358         salt.utils.stringutils.check_whitelist_blacklist(
359             "web_five",
360             whitelist=set(),
361             blacklist=set(blacklist),
362         )
363         is True
364     )
365     assert (
366         salt.utils.stringutils.check_whitelist_blacklist(
367             "web5",
368             whitelist=set(whitelist),
369             blacklist=set(blacklist),
370         )
371         is False
372     )
373     assert (
374         salt.utils.stringutils.check_whitelist_blacklist(
375             "web4",
376             whitelist=set(whitelist),
377             blacklist=set(blacklist),
378         )
379         is True
380     )
381     assert pytest.raises(
382         TypeError,
383         salt.utils.stringutils.check_whitelist_blacklist,
384         "foo",
385         whitelist=123,
386     )
387     assert pytest.raises(
388         TypeError,
389         salt.utils.stringutils.check_whitelist_blacklist,
390         "foo",
391         blacklist=123,
392     )
393 def test_check_include_exclude_empty():
394     assert salt.utils.stringutils.check_include_exclude("/some/test") is True
395 def test_check_include_exclude_exclude():
396     assert (
397         salt.utils.stringutils.check_include_exclude("/some/test", None, "*test*")
398         is False
399     )
400 def test_check_include_exclude_exclude_list():
401     assert (
402         salt.utils.stringutils.check_include_exclude("/some/test", None, ["*test"])
403         is False
404     )
405 def test_check_include_exclude_exclude_include():
406     assert (
407         salt.utils.stringutils.check_include_exclude("/some/test", "*test*", "/some/")
408         is True
409     )
410 def test_check_include_exclude_regex():
411     assert (
412         salt.utils.stringutils.check_include_exclude(
413             "/some/test", None, "E@/some/(test|other)"
414         )
415         is False
416     )
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
