<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_salt_auth.py &amp; test_stringutils.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_salt_auth.py &amp; test_stringutils.py
      </h3>
<h1 align="center">
        2.7%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_salt_auth.py (9.523809%)<th>test_stringutils.py (1.6073478%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(33-36)<td><a href="#" name="0">(192-199)</a><td align="center"><font color="#ff0000">14</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_salt_auth.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
import logging
import pytest
import salt.utils.platform
import salt.utils.pycrypto
log = logging.getLogger(__name__)
pytestmark = [
    pytest.mark.slow_test,
    pytest.mark.skip_if_not_root,
    pytest.mark.destructive_test,
    pytest.mark.skip_on_windows,
]
USERA = "saltdev-auth"
USERA_PWD = "saltdev"
@pytest.fixture(scope="module")
def saltdev_account(sminion):
    try:
        assert sminion.functions.user.add(USERA, createhome=False)
<a name="0"></a>        assert sminion.functions.shadow.set_password(
            USERA,
            USERA_PWD
            if salt<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.utils.platform.is_darwin()
            else salt.utils.pycrypto.gen_hash(password=USERA_PWD),
        )
        assert USERA in sminion.functions.user.list_users(</b></font>)
        yield
    finally:
        sminion.functions.user.delete(USERA, remove=True)
SALTOPS = "saltops"
@pytest.fixture(scope="module")
def saltops_group(sminion):
    try:
        assert sminion.functions.group.add(SALTOPS)
        yield
    finally:
        sminion.functions.group.delete(SALTOPS)
USERB = "saltdev-adm"
USERB_PWD = USERA_PWD
@pytest.fixture(scope="module")
def saltadm_account(sminion, saltops_group):
    try:
        assert sminion.functions.user.add(USERB, groups=[SALTOPS], createhome=False)
        assert sminion.functions.shadow.set_password(
            USERB,
            USERB_PWD
            if salt.utils.platform.is_darwin()
            else salt.utils.pycrypto.gen_hash(password=USERB_PWD),
        )
        assert USERB in sminion.functions.user.list_users()
        yield
    finally:
        sminion.functions.user.delete(USERB, remove=True)
def test_pam_auth_valid_user(salt_minion, salt_cli, saltdev_account):
    ret = salt_cli.run(
        "-a",
        "pam",
        "--username",
        USERA,
        "--password",
        USERA_PWD,
        "test.ping",
        minion_tgt=salt_minion.id,
    )
    assert ret.exitcode == 0
    assert ret.json is True
def test_pam_auth_invalid_user(salt_minion, salt_cli, saltdev_account):
    ret = salt_cli.run(
        "-a",
        "pam",
        "--username",
        "nouser",
        "--password",
        "1234",
        "test.ping",
        minion_tgt=salt_minion.id,
    )
    assert ret.stdout == "Authentication error occurred."
def test_pam_auth_valid_group(salt_minion, salt_cli, saltadm_account):
    ret = salt_cli.run(
        "-a",
        "pam",
        "--username",
        USERB,
        "--password",
        USERB_PWD,
        "test.ping",
        minion_tgt=salt_minion.id,
    )
    assert ret.exitcode == 0
    assert ret.json is True
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_stringutils.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
import builtins
import re
import sys
import textwrap
import pytest
import salt.utils.stringutils
from tests.support.mock import patch
from tests.support.unit import LOREM_IPSUM
@pytest.fixture(scope="function")
def unicode():
    UNICODE = "中国語 (繁体)"
    STR = BYTES = UNICODE.encode("utf-8")
    return UNICODE, STR, BYTES
@pytest.fixture(scope="function")
def eggs():
    eggs = "\u044f\u0438\u0306\u0446\u0430"
    return eggs
@pytest.fixture(scope="function")
def latin1_unicode():
    LATIN1_UNICODE = "räksmörgås"
    LATIN1_BYTES = LATIN1_UNICODE.encode("latin-1")
    return LATIN1_UNICODE, LATIN1_BYTES
@pytest.fixture()
def single_txt():
    return """
if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
@pytest.fixture()
def single_double_txt():
    return """
if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
if [ -z "$debian_chroot" ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
@pytest.fixture()
def match():
    return """
if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
if [ -z "$debian_chroot" ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
if [ -z "$debian_chroot" ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
if [ -z '$debian_chroot' ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
if [ -z '$debian_chroot' ] &amp;&amp; [ -r "/etc/debian_chroot" ]; then
    debian_chroot=$(cat /etc/debian_chroot)
fi
        salt<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.utils.stringutils.is_binary(
            salt.utils.stringutils.to_bytes(almost_bin_str)
        )
        is False
    )
    bin_str = almost_bin_str + "\x01"
    assert salt.utils.stringutils.is_binary(</b></font>bin_str) is True
    assert (
        salt.utils.stringutils.is_binary(salt.utils.stringutils.to_bytes(bin_str))
        is True
    )
def test_to_str(unicode):
    UNICODE = unicode[0]
    BYTES = unicode[2]
    for x in (123, (1, 2, 3), [1, 2, 3], {1: 23}, None):
        assert pytest.raises(TypeError, salt.utils.stringutils.to_str, x)
    assert salt.utils.stringutils.to_str("plugh") == "plugh"
    assert salt.utils.stringutils.to_str("áéíóúý", "utf-8") == "áéíóúý"
    assert salt.utils.stringutils.to_str(BYTES, "utf-8") == UNICODE
    assert salt.utils.stringutils.to_str(bytearray(BYTES), "utf-8") == UNICODE
    ut2 = b"\x9c"
    assert pytest.raises(
        UnicodeDecodeError, salt.utils.stringutils.to_str, ut2, "utf-8"
    )
    assert salt.utils.stringutils.to_str(ut2, "utf-8", "replace") == "\ufffd"
    assert pytest.raises(
        UnicodeDecodeError,
        salt.utils.stringutils.to_str,
        bytearray(ut2),
        "utf-8",
    )
    assert salt.utils.stringutils.to_str(bytearray(ut2), "utf-8", "replace") == "\ufffd"
def test_to_bytes(unicode):
    UNICODE = unicode[0]
    BYTES = unicode[2]
    for x in (123, (1, 2, 3), [1, 2, 3], {1: 23}, None):
        assert pytest.raises(TypeError, salt.utils.stringutils.to_bytes, x)
    assert salt.utils.stringutils.to_bytes("xyzzy") == b"xyzzy"
    assert salt.utils.stringutils.to_bytes(BYTES) == BYTES
    assert salt.utils.stringutils.to_bytes(bytearray(BYTES)) == BYTES
    assert salt.utils.stringutils.to_bytes(UNICODE, "utf-8") == BYTES
    with patch.object(builtins, "__salt_system_encoding__", "ascii"):
        assert salt.utils.stringutils.to_bytes("Ψ") == b"\xce\xa8"
def test_to_unicode(eggs, unicode, latin1_unicode):
    UNICODE = unicode[0]
    BYTES = unicode[2]
    LATIN1_UNICODE = latin1_unicode[0]
    LATIN1_BYTES = latin1_unicode[1]
    assert salt.utils.stringutils.to_unicode(eggs, normalize=True) == "яйца"
    assert salt.utils.stringutils.to_unicode(eggs, normalize=False) != "яйца"
    assert (
        salt.utils.stringutils.to_unicode(LATIN1_BYTES, encoding="latin-1")
        == LATIN1_UNICODE
    )
    assert salt.utils.stringutils.to_unicode("plugh") == "plugh"
    assert salt.utils.stringutils.to_unicode("áéíóúý") == "áéíóúý"
    assert salt.utils.stringutils.to_unicode(BYTES, "utf-8") == UNICODE
    assert salt.utils.stringutils.to_unicode(bytearray(BYTES), "utf-8") == UNICODE
def test_to_unicode_multi_encoding(latin1_unicode):
    LATIN1_UNICODE = latin1_unicode[0]
    LATIN1_BYTES = latin1_unicode[1]
    assert (
        salt.utils.stringutils.to_unicode(LATIN1_BYTES, encoding=("utf-8", "latin1"))
        == LATIN1_UNICODE
    )
def test_build_whitespace_split_regex():
    if sys.version_info &gt;= (3, 7):
        expected_regex = (
            "(?m)^(?:[\\s]+)?Lorem(?:[\\s]+)?ipsum(?:[\\s]+)?dolor(?:[\\s]+)?sit(?:[\\s]+)?amet,"
            "(?:[\\s]+)?$"
        )
    else:
        expected_regex = (
            "(?m)^(?:[\\s]+)?Lorem(?:[\\s]+)?ipsum(?:[\\s]+)?dolor(?:[\\s]+)?sit(?:[\\s]+)?amet\\,"
            "(?:[\\s]+)?$"
        )
    assert (
        salt.utils.stringutils.build_whitespace_split_regex(
            " ".join(LOREM_IPSUM.split()[:5])
        )
        == expected_regex
    )
def test_get_context():
    expected_context = textwrap.dedent(
    Ensure that whitelist matching works on both PY2 and PY3
    """
    whitelist = ["one/two/three", r"web[0-9]"]
    blacklist = ["four/five/six", r"web[5-9]"]
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_one",
            whitelist=whitelist[1],
            blacklist=None,
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_one",
            whitelist=whitelist[1],
            blacklist=[],
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web1",
            whitelist=whitelist[1],
            blacklist=None,
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web1",
            whitelist=whitelist[1],
            blacklist=[],
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=None,
            blacklist=blacklist[1],
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=[],
            blacklist=blacklist[1],
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_five",
            whitelist=None,
            blacklist=blacklist[1],
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_five",
            whitelist=[],
            blacklist=blacklist[1],
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=whitelist[1],
            blacklist=blacklist[1],
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web4",
            whitelist=whitelist[1],
            blacklist=blacklist[1],
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_one",
            whitelist=whitelist,
            blacklist=None,
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_one",
            whitelist=whitelist,
            blacklist=[],
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web1",
            whitelist=whitelist,
            blacklist=None,
        )
        is True
    )
    assert salt.utils.stringutils.check_whitelist_blacklist(
        "web1",
        whitelist=whitelist,
        blacklist=[],
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=None,
            blacklist=blacklist,
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=[],
            blacklist=blacklist,
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_five",
            whitelist=None,
            blacklist=blacklist,
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_five",
            whitelist=[],
            blacklist=blacklist,
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=whitelist,
            blacklist=blacklist,
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web4",
            whitelist=whitelist,
            blacklist=blacklist,
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_one",
            whitelist=set(whitelist),
            blacklist=None,
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_one",
            whitelist=set(whitelist),
            blacklist=set(),
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web1",
            whitelist=set(whitelist),
            blacklist=None,
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web1",
            whitelist=set(whitelist),
            blacklist=set(),
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=None,
            blacklist=set(blacklist),
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=set(),
            blacklist=set(blacklist),
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_five",
            whitelist=None,
            blacklist=set(blacklist),
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web_five",
            whitelist=set(),
            blacklist=set(blacklist),
        )
        is True
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web5",
            whitelist=set(whitelist),
            blacklist=set(blacklist),
        )
        is False
    )
    assert (
        salt.utils.stringutils.check_whitelist_blacklist(
            "web4",
            whitelist=set(whitelist),
            blacklist=set(blacklist),
        )
        is True
    )
    assert pytest.raises(
        TypeError,
        salt.utils.stringutils.check_whitelist_blacklist,
        "foo",
        whitelist=123,
    )
    assert pytest.raises(
        TypeError,
        salt.utils.stringutils.check_whitelist_blacklist,
        "foo",
        blacklist=123,
    )
def test_check_include_exclude_empty():
    assert salt.utils.stringutils.check_include_exclude("/some/test") is True
def test_check_include_exclude_exclude():
    assert (
        salt.utils.stringutils.check_include_exclude("/some/test", None, "*test*")
        is False
    )
def test_check_include_exclude_exclude_list():
    assert (
        salt.utils.stringutils.check_include_exclude("/some/test", None, ["*test"])
        is False
    )
def test_check_include_exclude_exclude_include():
    assert (
        salt.utils.stringutils.check_include_exclude("/some/test", "*test*", "/some/")
        is True
    )
def test_check_include_exclude_regex():
    assert (
        salt.utils.stringutils.check_include_exclude(
            "/some/test", None, "E@/some/(test|other)"
        )
        is False
    )
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
