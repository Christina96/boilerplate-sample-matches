
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 16, <button onclick='openModal()' class='match'>CODE CLONE</button></h2>
        <div class="column">
            <h3>Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-tools_13.py</h3>
            <pre><code>1  import glob
2  import io
3  import os
4  import secrets
5  from asyncio.exceptions import TimeoutError as AsyncTimeout
6  try:
7      import cv2
8  except ImportError:
9      cv2 = None
10  try:
11      from playwright.async_api import async_playwright
12  except ImportError:
13      async_playwright = None
14  try:
15      from htmlwebshot import WebShot
16  except ImportError:
17      WebShot = None
18  from telethon.errors.rpcerrorlist import MessageTooLongError, YouBlockedUserError
19  from telethon.tl.types import (
20      ChannelParticipantAdmin,
21      ChannelParticipantsBots,
22      DocumentAttributeVideo,
23  )
24  from pyUltroid.fns.tools import metadata, translate
25  from . import (
26      HNDLR,
27      LOGS,
28      ULTConfig,
29      async_searcher,
30      bash,
31      check_filename,
32      con,
33      download_file,
34      eor,
35      get_string,
36  )
37  from . import humanbytes as hb
38  from . import inline_mention, is_url_ok, json_parser, mediainfo, ultroid_cmd
39  @ultroid_cmd(pattern=&quot;tr( (.*)|$)&quot;, manager=True)
40  async def _(event):
41      input = event.pattern_match.group(1).strip().split(maxsplit=1)
42      txt = input[1] if len(input) &gt; 1 else None
43      if input:
44          input = input[0]
45      if txt:
<span onclick='openModal()' class='match'>46          text = txt
47      elif event.is_reply:
48          previous_message = await event.get_reply_message()
49          text = previous_message.message
</span>50      else:
51          return await eor(
52              event, f&quot;`{HNDLR}tr LanguageCode` as reply to a message&quot;, time=5
53          )
54      lan = input or &quot;en&quot;
55      try:
56          tt = translate(text, lang_tgt=lan)
57          output_str = f&quot;**TRANSLATED** to {lan}\n{tt}&quot;
58          await event.eor(output_str)
59      except Exception as exc:
60          LOGS.exception(exc)
61          await event.eor(str(exc), time=5)
62  @ultroid_cmd(
63      pattern=&quot;id( (.*)|$)&quot;,
64      manager=True,
65  )
66  async def _(event):
67      ult = event
68      match = event.pattern_match.group(1).strip()
69      if match:
70          try:
71              ids = await event.client.parse_id(match)
72          except Exception as er:
73              return await event.eor(str(er))
74          return await event.eor(
75              f&quot;**Chat ID:**  `{event.chat_id}`\n**User ID:**  `{ids}`&quot;
76          )
77      data = f&quot;**Current Chat ID:**  `{event.chat_id}`&quot;
78      if event.reply_to_msg_id:
79          event = await event.get_reply_message()
80          data += f&quot;\n**From User ID:**  `{event.sender_id}`&quot;
81      if event.media:
82          bot_api_file_id = event.file.id
83          data += f&quot;\n**Bot API File ID:**  `{bot_api_file_id}`&quot;
84      data += f&quot;\n**Msg ID:**  `{event.id}`&quot;
85      await ult.eor(data)
86  @ultroid_cmd(pattern=&quot;bots( (.*)|$)&quot;, groups_only=True, manager=True)
87  async def _(ult):
88      mentions = &quot;‚Ä¢ **Bots in this Chat**: \n&quot;
89      if input_str := ult.pattern_match.group(1).strip():
90          mentions = f&quot;‚Ä¢ **Bots in **{input_str}: \n&quot;
91          try:
92              chat = await ult.client.parse_id(input_str)
93          except Exception as e:
94              return await ult.eor(str(e))
95      else:
96          chat = ult.chat_id
97      try:
98          async for x in ult.client.iter_participants(
99              chat,
100              filter=ChannelParticipantsBots,
101          ):
102              if isinstance(x.participant, ChannelParticipantAdmin):
103                  mentions += f&quot;\n‚öúÔ∏è {inline_mention(x)} `{x.id}`&quot;
104              else:
105                  mentions += f&quot;\n‚Ä¢ {inline_mention(x)} `{x.id}`&quot;
106      except Exception as e:
107          mentions += f&quot; {str(e)}&quot; + &quot;\n&quot;
108      await ult.eor(mentions)
109  @ultroid_cmd(
110      pattern=&quot;hl( (.*)|$)&quot;,
111  )
112  async def _(ult):
113      input_ = ult.pattern_match.group(1).strip()
114      if not input_:
115          return await ult.eor(&quot;`Input some link`&quot;, time=5)
116      text = None
117      if len(input_.split()) &gt; 1:
118          spli_ = input_.split()
119          input_ = spli_[0]
120          text = spli_[1]
121      if not text:
122          text = &quot;„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§„Ö§&quot;
123      await ult.eor(f&quot;[{text}]({input_})&quot;, link_preview=False)
124  @ultroid_cmd(
125      pattern=&quot;circle$&quot;,
126  )
127  async def _(e):
128      reply = await e.get_reply_message()
129      if not (reply and reply.media):
130          return await e.eor(&quot;`Reply to a gif or audio file only.`&quot;)
131      if &quot;audio&quot; in mediainfo(reply.media):
132          msg = await e.eor(&quot;`Downloading...`&quot;)
133          try:
134              bbbb = await reply.download_media(thumb=-1)
135          except TypeError:
136              bbbb = ULTConfig.thumb
137          im = cv2.imread(bbbb)
138          dsize = (512, 512)
139          output = cv2.resize(im, dsize, interpolation=cv2.INTER_AREA)
140          cv2.imwrite(&quot;img.jpg&quot;, output)
141          thumb = &quot;img.jpg&quot;
142          audio, _ = await e.client.fast_downloader(reply.document)
143          await msg.edit(&quot;`Creating video note...`&quot;)
144          await bash(
145              f&#x27;ffmpeg -i &quot;{thumb}&quot; -i &quot;{audio.name}&quot; -preset ultrafast -c:a libmp3lame -ab 64 circle.mp4 -y&#x27;
146          )
147          await msg.edit(&quot;`Uploading...`&quot;)
148          data = await metadata(&quot;circle.mp4&quot;)
149          file, _ = await e.client.fast_uploader(&quot;circle.mp4&quot;, to_delete=True)
150          await e.client.send_file(
151              e.chat_id,
152              file,
153              thumb=thumb,
154              reply_to=reply,
155              attributes=[
156                  DocumentAttributeVideo(
157                      duration=min(data[&quot;duration&quot;], 60),
158                      w=512,
159                      h=512,
160                      round_message=True,
161                  )
162              ],
163          )
164          await msg.delete()
165          [os.remove(k) for k in [audio.name, thumb]]
166      elif mediainfo(reply.media) == &quot;gif&quot; or mediainfo(reply.media).startswith(&quot;video&quot;):
167          msg = await e.eor(&quot;**Creating video note**&quot;)
168          file = await reply.download_media(&quot;resources/downloads/&quot;)
169          if file.endswith(&quot;.webm&quot;):
170              nfile = await con.ffmpeg_convert(file, &quot;file.mp4&quot;)
171              os.remove(file)
172              file = nfile
173          if file:
174              await e.client.send_file(
175                  e.chat_id,
176                  file,
177                  video_note=True,
178                  thumb=ULTConfig.thumb,
179                  reply_to=reply,
180              )
181              os.remove(file)
182          await msg.delete()
183      else:
184          await e.eor(&quot;`Reply to a gif or audio file only.`&quot;)
185  FilesEMOJI = {
186      &quot;py&quot;: &quot;üêç&quot;,
187      &quot;json&quot;: &quot;üîÆ&quot;,
188      (&quot;sh&quot;, &quot;bat&quot;): &quot;‚å®Ô∏è&quot;,
189      (&quot;.mkv&quot;, &quot;.mp4&quot;, &quot;.avi&quot;, &quot;.gif&quot;, &quot;webm&quot;): &quot;üé•&quot;,
190      (&quot;.mp3&quot;, &quot;.ogg&quot;, &quot;.m4a&quot;, &quot;.opus&quot;): &quot;üîä&quot;,
191      (&quot;.jpg&quot;, &quot;.jpeg&quot;, &quot;.png&quot;, &quot;.webp&quot;, &quot;.ico&quot;): &quot;üñº&quot;,
192      (&quot;.txt&quot;, &quot;.text&quot;, &quot;.log&quot;): &quot;üìÑ&quot;,
193      (&quot;.apk&quot;, &quot;.xapk&quot;): &quot;üì≤&quot;,
194      (&quot;.pdf&quot;, &quot;.epub&quot;): &quot;üìó&quot;,
195      (&quot;.zip&quot;, &quot;.rar&quot;): &quot;üóú&quot;,
196      (&quot;.exe&quot;, &quot;.iso&quot;): &quot;‚öô&quot;,
197  }
198  @ultroid_cmd(
199      pattern=&quot;ls( (.*)|$)&quot;,
200  )
201  async def _(e):
202      files = e.pattern_match.group(1).strip()
203      if not files:
204          files = &quot;*&quot;
205      elif files.endswith(&quot;/&quot;):
206          files += &quot;*&quot;
207      elif &quot;*&quot; not in files:
208      files = glob.glob(files)
209      if not files:
210          return await e.eor(&quot;`Directory Empty or Incorrect.`&quot;, time=5)
211      folders = []
212      allfiles = []
213      for file in sorted(files):
214          if os.path.isdir(file):
215              folders.append(f&quot;üìÇ {file}&quot;)
216          else:
217              for ext in FilesEMOJI.keys():
218                  if file.endswith(ext):
219                      allfiles.append(f&quot;{FilesEMOJI[ext]} {file}&quot;)
220                      break
221              else:
222                  if &quot;.&quot; in str(file)[1:]:
223                      allfiles.append(f&quot;üè∑ {file}&quot;)
224                  else:
225                      allfiles.append(f&quot;üìí {file}&quot;)
226      omk = [*sorted(folders), *sorted(allfiles)]
227      text = &quot;&quot;
228      fls, fos = 0, 0
229      flc, foc = 0, 0
230      for i in omk:
231          try:
232              emoji = i.split()[0]
233              name = i.split(maxsplit=1)[1]
234              nam = name.split(&quot;/&quot;)[-1]
235              if os.path.isdir(name):
236                  size = 0
237                  for path, dirs, files in os.walk(name):
238                      for f in files:
239                          fp = os.path.join(path, f)
240                          size += os.path.getsize(fp)
241                  if hb(size):
242                      text += f&quot;{emoji} `{nam}`  `{hb(size)}&quot; + &quot;`\n&quot;
243                      fos += size
244                  else:
245                      text += f&quot;{emoji} `{nam}`&quot; + &quot;\n&quot;
246                  foc += 1
247              else:
248                  if hb(int(os.path.getsize(name))):
249                      text += (
250                          emoji
251                          + f&quot; `{nam}`&quot;
252                          + &quot;  `&quot;
253                          + hb(int(os.path.getsize(name)))
254                          + &quot;`\n&quot;
255                      )
256                      fls += int(os.path.getsize(name))
257                  else:
258                      text += f&quot;{emoji} `{nam}`&quot; + &quot;\n&quot;
259                  flc += 1
260          except BaseException:
261              pass
262      tfos, tfls, ttol = hb(fos), hb(fls), hb(fos + fls)
263      if not hb(fos):
264          tfos = &quot;0 B&quot;
265      if not hb(fls):
266          tfls = &quot;0 B&quot;
267      if not hb(fos + fls):
268          ttol = &quot;0 B&quot;
269      text += f&quot;\n\n`Folders` :  `{foc}` :   `{tfos}`\n`Files` :       `{flc}` :   `{tfls}`\n`Total` :       `{flc+foc}` :   `{ttol}`&quot;
270      try:
271          if (flc + foc) &gt; 100:
272              text = text.replace(&quot;`&quot;, &quot;&quot;)
273          await e.eor(text)
274      except MessageTooLongError:
275          with io.BytesIO(str.encode(text)) as out_file:
276              out_file.name = &quot;output.txt&quot;
277              await e.reply(f&quot;`{e.text}`&quot;, file=out_file, thumb=ULTConfig.thumb)
278          await e.delete()
279  @ultroid_cmd(
280      pattern=&quot;sg( (.*)|$)&quot;,
281  )
282  async def lastname(steal):
283      mat = steal.pattern_match.group(1).strip()
284      message = await steal.get_reply_message()
285      if mat:
286          try:
287              user_id = await steal.client.parse_id(mat)
288          except ValueError:
289              user_id = mat
290      elif message:
291          user_id = message.sender_id
292      else:
293          return await steal.eor(&quot;`Use this command with reply or give Username/id...`&quot;)
294      chat = &quot;@SangMataInfo_bot&quot;
295      id = f&quot;/search_id {user_id}&quot;
296      lol = await steal.eor(get_string(&quot;com_1&quot;))
297      try:
298          async with steal.client.conversation(chat) as conv:
299              try:
300                  msg = await conv.send_message(id)
301                  response = await conv.get_response()
302                  respond = await conv.get_response()
303                  responds = await conv.get_response()
304              except YouBlockedUserError:
305                  return await lol.edit(&quot;Please unblock @sangmatainfo_bot and try again&quot;)
306              if (
307                  (response and response.text == &quot;No records found&quot;)
308                  or (respond and respond.text == &quot;No records found&quot;)
309                  or (responds and responds.text == &quot;No records found&quot;)
310              ):
311                  await lol.edit(&quot;No records found for this user&quot;)
312                  await steal.client.delete_messages(conv.chat_id, [msg.id, response.id])
313              elif response.text.startswith(&quot;üîó&quot;):
314                  await lol.edit(respond.message)
315                  await lol.reply(responds.message)
316              elif respond.text.startswith(&quot;üîó&quot;):
317                  await lol.edit(response.message)
318                  await lol.reply(responds.message)
319              else:
320                  await lol.edit(respond.message)
321                  await lol.reply(response.message)
322              await steal.client.delete_messages(
323                  conv.chat_id,
324                  [msg.id, responds.id, respond.id, response.id],
325              )
326      except AsyncTimeout:
327          await lol.edit(&quot;Error: @SangMataInfo_bot is not responding!.&quot;)
328  @ultroid_cmd(pattern=&quot;webshot( (.*)|$)&quot;)
329  async def webss(event):
330      xx = await event.eor(get_string(&quot;com_1&quot;))
331      xurl = event.pattern_match.group(1).strip()
332      if not xurl:
333          return await xx.eor(get_string(&quot;wbs_1&quot;), time=5)
334      if not (await is_url_ok(xurl)):
335          return await xx.eor(get_string(&quot;wbs_2&quot;), time=5)
336      path, pic = check_filename(&quot;shot.png&quot;), None
337      if async_playwright:
338          try:
339              async with async_playwright() as playwright:
340                  chrome = await playwright.chromium.launch()
341                  page = await chrome.new_page()
342                  await page.goto(xurl)
343                  await page.screenshot(path=path, full_page=True)
344                  pic = path
345          except Exception as er:
346              LOGS.exception(er)
347              await xx.respond(f&quot;Error with playwright:\n`{er}`&quot;)
348      if WebShot and not pic:
349          try:
350              shot = WebShot(
351                  quality=88, flags=[&quot;--enable-javascript&quot;, &quot;--no-stop-slow-scripts&quot;]
352              )
353              pic = await shot.create_pic_async(url=xurl)
354          except Exception as er:
355              LOGS.exception(er)
356      if not pic:
357          pic, msg = await download_file(
358              f&quot;https://shot.screenshotapi.net/screenshot?&amp;url={xurl}&amp;output=image&amp;file_type=png&amp;wait_for_event=load&quot;,
359              path,
360              validate=True,
361          )
362          if msg:
363              await xx.edit(json_parser(msg, indent=1))
364              return
365      if pic:
366          await xx.reply(
367              get_string(&quot;wbs_3&quot;).format(xurl),
368              file=pic,
369              link_preview=False,
370              force_document=True,
371          )
372          os.remove(pic)
373      await xx.delete()
374  @ultroid_cmd(pattern=&quot;shorturl&quot;)
375  async def magic(event):
376      try:
377          match = event.text.split(maxsplit=1)[1].strip()
378      except IndexError:
379          return await event.eor(&quot;`Provide url to turn into tiny...`&quot;)
380      data = {
381          &quot;url&quot;: match.split()[0],
382          &quot;id&quot;: match[1] if len(match) &gt; 1 else secrets.token_urlsafe(6),
383      }
384      data = await async_searcher(
385          &quot;https://tiny.ultroid.tech/api/new&quot;,
386          data=data,
387          post=True,
388          re_json=True,
389      )
390      response = data.get(&quot;response&quot;, {})
391      if not response.get(&quot;status&quot;):
392          return await event.eor(f&#x27;**ERROR :** `{response[&quot;message&quot;]}`&#x27;)
393      await event.eor(
394          f&quot;‚Ä¢ **Ultroid Tiny**\n‚Ä¢ Given Url : {url}\n‚Ä¢ Shorten Url : {data[&#x27;response&#x27;][&#x27;tinyUrl&#x27;]}&quot;
395      )
</code></pre>
        </div>
        <div class="column">
            <h3>Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-utilities.py</h3>
            <pre><code>1  import calendar
2  import html
3  import io
4  import os
5  import pathlib
6  import time
7  from datetime import datetime as dt
8  try:
9      from PIL import Image
10  except ImportError:
11      Image = None
12  from pyUltroid._misc._assistant import asst_cmd
13  from pyUltroid.dB.gban_mute_db import is_gbanned
14  from pyUltroid.fns.tools import get_chat_and_msgid
15  try:
16      from telegraph import upload_file as uf
17  except ImportError:
18      uf = None
19  from telethon.errors.rpcerrorlist import ChatForwardsRestrictedError, UserBotError
20  from telethon.events import NewMessage
21  from telethon.tl.custom import Dialog
22  from telethon.tl.functions.channels import (
23      GetAdminedPublicChannelsRequest,
24      InviteToChannelRequest,
25      LeaveChannelRequest,
26  )
27  from telethon.tl.functions.contacts import GetBlockedRequest
28  from telethon.tl.functions.messages import AddChatUserRequest, GetAllStickersRequest
29  from telethon.tl.functions.users import GetFullUserRequest
30  from telethon.tl.types import (
31      Channel,
32      Chat,
33      InputMediaPoll,
34      Poll,
35      PollAnswer,
36      TLObject,
37      User,
38  )
39  from telethon.utils import get_peer_id
40  from pyUltroid.fns.info import get_chat_info
41  from . import (
42      HNDLR,
43      LOGS,
44      Image,
45      ReTrieveFile,
46      Telegraph,
47      asst,
48      async_searcher,
49      bash,
50      check_filename,
51      eod,
52      eor,
53      get_paste,
54      get_string,
55      inline_mention,
56      json_parser,
57      mediainfo,
58      udB,
59      ultroid_cmd,
60  )
61  TMP_DOWNLOAD_DIRECTORY = &quot;resources/downloads/&quot;
62  _copied_msg = {}
63  @ultroid_cmd(pattern=&quot;kickme$&quot;, fullsudo=True)
64  async def leave(ult):
65      await ult.eor(f&quot;`{ult.client.me.first_name} has left this group, bye!!.`&quot;)
66      await ult.client(LeaveChannelRequest(ult.chat_id))
67  @ultroid_cmd(
68      pattern=&quot;date$&quot;,
69  )
70  async def date(event):
71      m = dt.now().month
72      y = dt.now().year
73      d = dt.now().strftime(&quot;Date - %B %d, %Y\nTime- %H:%M:%S&quot;)
74      k = calendar.month(y, m)
75      await event.eor(f&quot;`{k}\n\n{d}`&quot;)
76  @ultroid_cmd(
77      pattern=&quot;listreserved$&quot;,
78  )
79  async def _(event):
80      result = await event.client(GetAdminedPublicChannelsRequest())
81      if not result.chats:
82          return await event.eor(&quot;`No username Reserved`&quot;)
83      output_str = &quot;&quot;.join(
84          f&quot;- {channel_obj.title} @{channel_obj.username} \n&quot;
85          for channel_obj in result.chats
86      )
87      await event.eor(output_str)
88  @ultroid_cmd(
89      pattern=&quot;stats$&quot;,
90  )
91  async def stats(
92      event: NewMessage.Event,
93  ):
94      ok = await event.eor(&quot;`Collecting stats...`&quot;)
95      start_time = time.time()
96      private_chats = 0
97      bots = 0
98      groups = 0
99      broadcast_channels = 0
100      admin_in_groups = 0
101      creator_in_groups = 0
102      admin_in_broadcast_channels = 0
103      creator_in_channels = 0
104      unread_mentions = 0
105      unread = 0
106      dialog: Dialog
107      async for dialog in event.client.iter_dialogs():
108          entity = dialog.entity
109          if isinstance(entity, Channel) and entity.broadcast:
110              broadcast_channels += 1
111              if entity.creator or entity.admin_rights:
112                  admin_in_broadcast_channels += 1
113              if entity.creator:
114                  creator_in_channels += 1
115          elif (isinstance(entity, Channel) and entity.megagroup) or isinstance(
116              entity, Chat
117          ):
118              groups += 1
119              if entity.creator or entity.admin_rights:
120                  admin_in_groups += 1
121              if entity.creator:
122                  creator_in_groups += 1
123          elif isinstance(entity, User):
124              private_chats += 1
125              if entity.bot:
126                  bots += 1
127          unread_mentions += dialog.unread_mentions_count
128          unread += dialog.unread_count
129      stop_time = time.time() - start_time
130      try:
131          ct = (await event.client(GetBlockedRequest(1, 0))).count
132      except AttributeError:
133          ct = 0
134      try:
135          sp = await event.client(GetAllStickersRequest(0))
136          sp_count = len(sp.sets)
137      except BaseException:
138          sp_count = 0
139      full_name = inline_mention(event.client.me)
140      response = f&quot;üî∏ **Stats for {full_name}** \n\n&quot;
141      response += f&quot;**Private Chats:** {private_chats} \n&quot;
142      response += f&quot;**  ‚Ä¢‚Ä¢ **`Users: {private_chats - bots}` \n&quot;
143      response += f&quot;**  ‚Ä¢‚Ä¢ **`Bots: {bots}` \n&quot;
144      response += f&quot;**Groups:** {groups} \n&quot;
145      response += f&quot;**Channels:** {broadcast_channels} \n&quot;
146      response += f&quot;**Admin in Groups:** {admin_in_groups} \n&quot;
147      response += f&quot;**  ‚Ä¢‚Ä¢ **`Creator: {creator_in_groups}` \n&quot;
148      response += f&quot;**  ‚Ä¢‚Ä¢ **`Admin Rights: {admin_in_groups - creator_in_groups}` \n&quot;
149      response += f&quot;**Admin in Channels:** {admin_in_broadcast_channels} \n&quot;
150      response += f&quot;**  ‚Ä¢‚Ä¢ **`Creator: {creator_in_channels}` \n&quot;
151      response += f&quot;**  ‚Ä¢‚Ä¢ **`Admin Rights: {admin_in_broadcast_channels - creator_in_channels}` \n&quot;
152      response += f&quot;**Unread:** {unread} \n&quot;
153      response += f&quot;**Unread Mentions:** {unread_mentions} \n&quot;
154      response += f&quot;**Blocked Users:** {ct}\n&quot;
155      response += f&quot;**Total Stickers Pack Installed :** `{sp_count}`\n\n&quot;
156      response += f&quot;**__It Took:__** {stop_time:.02f}s \n&quot;
157      await ok.edit(response)
158  @ultroid_cmd(pattern=&quot;paste( (.*)|$)&quot;, manager=True, allow_all=True)
159  async def _(event):
160      try:
161          input_str = event.text.split(maxsplit=1)[1]
162      except IndexError:
163          input_str = None
164      xx = await event.eor(&quot;` „Ää Pasting... „Äã `&quot;)
165      downloaded_file_name = None
166      if input_str:
<span onclick='openModal()' class='match'>167          message = input_str
168      elif event.reply_to_msg_id:
169          previous_message = await event.get_reply_message()
170          if previous_message.media:
</span>171              downloaded_file_name = await event.client.download_media(
172                  previous_message,
173                  &quot;./resources/downloads&quot;,
174              )
175              with open(downloaded_file_name, &quot;r&quot;) as fd:
176                  message = fd.read()
177              os.remove(downloaded_file_name)
178          else:
179              message = previous_message.message
180      else:
181          message = None
182      if not message:
183          return await xx.eor(
184              &quot;`Reply to a Message/Document or Give me Some Text !`&quot;, time=5
185          )
186      done, key = await get_paste(message)
187      if not done:
188          return await xx.eor(key)
189      link = f&quot;https://spaceb.in/{key}&quot;
190      raw = f&quot;https://spaceb.in/api/v1/documents/{key}/raw&quot;
191      reply_text = (
192          f&quot;‚Ä¢ **Pasted to SpaceBin :** [Space]({link})\n‚Ä¢ **Raw Url :** : [Raw]({raw})&quot;
193      )
194      try:
195          if event.client._bot:
196              return await xx.eor(reply_text)
197          ok = await event.client.inline_query(asst.me.username, f&quot;pasta-{key}&quot;)
198          await ok[0].click(event.chat_id, reply_to=event.reply_to_msg_id, hide_via=True)
199          await xx.delete()
200      except BaseException as e:
201          LOGS.exception(e)
202          await xx.edit(reply_text)
203  @ultroid_cmd(
204      pattern=&quot;info( (.*)|$)&quot;,
205      manager=True,
206  )
207  async def _(event):
208      if match := event.pattern_match.group(1).strip():
209          try:
210              user = await event.client.parse_id(match)
211          except Exception as er:
212              return await event.eor(str(er))
213      elif event.is_reply:
214          rpl = await event.get_reply_message()
215          user = rpl.sender_id
216      else:
217          user = event.chat_id
218      xx = await event.eor(get_string(&quot;com_1&quot;))
219      try:
220          _ = await event.client.get_entity(user)
221      except Exception as er:
222          return await xx.edit(f&quot;**ERROR :** {er}&quot;)
223      if not isinstance(_, User):
224          try:
225              peer = get_peer_id(_)
226              photo, capt = await get_chat_info(_, event)
227              if is_gbanned(peer):
228                  capt += &quot;\n‚Ä¢&lt;b&gt; Is Gbanned:&lt;/b&gt; &lt;code&gt;True&lt;/code&gt;&quot;
229              if not photo:
230                  return await xx.eor(capt, parse_mode=&quot;html&quot;)
231              await event.client.send_message(
232                  event.chat_id, capt[:1024], file=photo, parse_mode=&quot;html&quot;
233              )
234              await xx.delete()
235          except Exception as er:
236              await event.eor(&quot;**ERROR ON CHATINFO**\n&quot; + str(er))
237          return
238      try:
239          full_user = (await event.client(GetFullUserRequest(user))).full_user
240      except Exception as er:
241          return await xx.edit(f&quot;ERROR : {er}&quot;)
242      user = _
243      user_photos = (
244          await event.client.get_profile_photos(user.id, limit=0)
245      ).total or &quot;NaN&quot;
246      user_id = user.id
247      first_name = html.escape(user.first_name)
248      if first_name is not None:
249          first_name = first_name.replace(&quot;\u2060&quot;, &quot;&quot;)
250      last_name = user.last_name
251      last_name = (
252          last_name.replace(&quot;\u2060&quot;, &quot;&quot;) if last_name else (&quot;Last Name not found&quot;)
253      )
254      user_bio = full_user.about
255      if user_bio is not None:
256          user_bio = html.escape(full_user.about)
257      common_chats = full_user.common_chats_count
258      if user.photo:
259          dc_id = user.photo.dc_id
260      else:
261          dc_id = &quot;Need a Profile Picture to check this&quot;
262      caption = .format(
263          user_id,
264          user_id,
265          first_name,
266          last_name,
267          user_bio,
268          dc_id,
269          user_photos,
270          user.restricted,
271          user.verified,
272          user.premium,
273          user.bot,
274          common_chats,
275      )
276      if chk := is_gbanned(user_id):
277          caption += f
278      await event.client.send_message(
279          event.chat_id,
280          caption,
281          reply_to=event.reply_to_msg_id,
282          parse_mode=&quot;HTML&quot;,
283          file=full_user.profile_photo,
284          force_document=False,
285          silent=True,
286      )
287      await xx.delete()
288  @ultroid_cmd(
289      pattern=&quot;invite( (.*)|$)&quot;,
290      groups_only=True,
291  )
292  async def _(ult):
293      xx = await ult.eor(get_string(&quot;com_1&quot;))
294      to_add_users = ult.pattern_match.group(1).strip()
295      if not ult.is_channel and ult.is_group:
296          for user_id in to_add_users.split(&quot; &quot;):
297              try:
298                  await ult.client(
299                      AddChatUserRequest(
300                          chat_id=ult.chat_id,
301                          user_id=await ult.client.parse_id(user_id),
302                          fwd_limit=1000000,
303                      ),
304                  )
305                  await xx.edit(f&quot;Successfully invited `{user_id}` to `{ult.chat_id}`&quot;)
306              except Exception as e:
307                  await xx.edit(str(e))
308      else:
309          for user_id in to_add_users.split(&quot; &quot;):
310              try:
311                  await ult.client(
312                      InviteToChannelRequest(
313                          channel=ult.chat_id,
314                          users=[await ult.client.parse_id(user_id)],
315                      ),
316                  )
317                  await xx.edit(f&quot;Successfully invited `{user_id}` to `{ult.chat_id}`&quot;)
318              except UserBotError:
319                  await xx.edit(
320                      f&quot;Bots can only be added as Admins in Channel.\nBetter Use `{HNDLR}promote {user_id}`&quot;
321                  )
322              except Exception as e:
323                  await xx.edit(str(e))
324  @ultroid_cmd(
325      pattern=&quot;rmbg($| (.*))&quot;,
326  )
327  async def abs_rmbg(event):
328      RMBG_API = udB.get_key(&quot;RMBG_API&quot;)
329      if not RMBG_API:
330          return await event.eor(
331              &quot;Get your API key from [here](https://www.remove.bg/) for this plugin to work.&quot;,
332          )
333      match = event.pattern_match.group(1).strip()
334      reply = await event.get_reply_message()
335      if match and os.path.exists(match):
336          dl = match
337      elif reply and reply.media:
338          if reply.document and reply.document.thumbs:
339              dl = await reply.download_media(thumb=-1)
340          else:
341              dl = await reply.download_media()
342      else:
343          return await eod(
344              event, f&quot;Use `{HNDLR}rmbg` as reply to a pic to remove its background.&quot;
345          )
346      if not (dl and dl.endswith((&quot;webp&quot;, &quot;jpg&quot;, &quot;png&quot;, &quot;jpeg&quot;))):
347          os.remove(dl)
348          return await event.eor(get_string(&quot;com_4&quot;))
349      if dl.endswith(&quot;webp&quot;):
350          file = f&quot;{dl}.png&quot;
351          Image.open(dl).save(file)
352          os.remove(dl)
353          dl = file
354      xx = await event.eor(&quot;`Sending to remove.bg`&quot;)
355      dn, out = await ReTrieveFile(dl)
356      os.remove(dl)
357      if not dn:
358          dr = out[&quot;errors&quot;][0]
359          de = dr.get(&quot;detail&quot;, &quot;&quot;)
360          return await xx.edit(
361              f&quot;**ERROR ~** `{dr[&#x27;title&#x27;]}`,\n`{de}`&quot;,
362          )
363      zz = Image.open(out)
364      if zz.mode != &quot;RGB&quot;:
365          zz.convert(&quot;RGB&quot;)
366      wbn = check_filename(&quot;ult-rmbg.webp&quot;)
367      zz.save(wbn, &quot;webp&quot;)
368      await event.client.send_file(
369          event.chat_id,
370          out,
371          force_document=True,
372          reply_to=reply,
373      )
374      await event.client.send_file(event.chat_id, wbn, reply_to=reply)
375      os.remove(out)
376      os.remove(wbn)
377      await xx.delete()
378  @ultroid_cmd(
379      pattern=&quot;telegraph( (.*)|$)&quot;,
380  )
381  async def telegraphcmd(event):
382      xx = await event.eor(get_string(&quot;com_1&quot;))
383      match = event.pattern_match.group(1).strip() or &quot;Ultroid&quot;
384      reply = await event.get_reply_message()
385      if not reply:
386          return await xx.eor(&quot;`Reply to Message.`&quot;)
387      if not reply.media and reply.message:
388          content = reply.message
389      else:
390          getit = await reply.download_media()
391          dar = mediainfo(reply.media)
392          if dar == &quot;sticker&quot;:
393              file = f&quot;{getit}.png&quot;
394              Image.open(getit).save(file)
395              os.remove(getit)
396              getit = file
397          elif dar.endswith(&quot;animated&quot;):
398              file = f&quot;{getit}.gif&quot;
399              await bash(f&quot;lottie_convert.py &#x27;{getit}&#x27; {file}&quot;)
400              os.remove(getit)
401              getit = file
402          if &quot;document&quot; not in dar:
403              try:
404                  nn = f&quot;https://graph.org{uf(getit)[0]}&quot;
405                  amsg = f&quot;Uploaded to [Telegraph]({nn}) !&quot;
406              except Exception as e:
407                  amsg = f&quot;Error : {e}&quot;
408              os.remove(getit)
409              return await xx.eor(amsg)
410          content = pathlib.Path(getit).read_text()
411          os.remove(getit)
412      makeit = Telegraph.create_page(title=match, content=[content])
413      await xx.eor(
414          f&quot;Pasted to Telegraph : [Telegraph]({makeit[&#x27;url&#x27;]})&quot;, link_preview=False
415      )
416  @ultroid_cmd(pattern=&quot;json( (.*)|$)&quot;)
417  async def _(event):
418      reply_to_id = None
419      match = event.pattern_match.group(1).strip()
420      if event.reply_to_msg_id:
421          msg = await event.get_reply_message()
422          reply_to_id = event.reply_to_msg_id
423      else:
424          msg = event
425          reply_to_id = event.message.id
426      if match and hasattr(msg, match.split()[0]):
427          msg = getattr(msg, match.split()[0])
428          try:
429              if hasattr(msg, &quot;to_json&quot;):
430                  msg = msg.to_json(ensure_ascii=False, indent=1)
431              elif hasattr(msg, &quot;to_dict&quot;):
432                  msg = json_parser(msg.to_dict(), indent=1)
433              else:
434                  msg = TLObject.stringify(msg)
435          except Exception:
436              pass
437          msg = str(msg)
438      else:
439          msg = json_parser(msg.to_json(), indent=1)
440      if &quot;-t&quot; in match:
441          try:
442              data = json_parser(msg)
443              msg = json_parser(
444                  {key: data[key] for key in data.keys() if data[key]}, indent=1
445              )
446          except Exception:
447              pass
448      if len(msg) &gt; 4096:
449          with io.BytesIO(str.encode(msg)) as out_file:
450              out_file.name = &quot;json-ult.txt&quot;
451              await event.client.send_file(
452                  event.chat_id,
453                  out_file,
454                  force_document=True,
455                  allow_cache=False,
456                  reply_to=reply_to_id,
457              )
458              await event.delete()
459      else:
460          await event.eor(f&quot;```{msg or None}```&quot;)
461  @ultroid_cmd(pattern=&quot;suggest( (.*)|$)&quot;, manager=True)
462  async def sugg(event):
463      sll = event.text.split(maxsplit=1)
464      try:
465          text = sll[1]
466      except IndexError:
467          text = None
468      if not (event.is_reply or text):
469          return await eod(
470              event,
471              &quot;`Please reply to a message to make a suggestion poll!`&quot;,
472          )
473      if event.is_reply and not text:
474          reply = await event.get_reply_message()
475          if reply.text and len(reply.text) &lt; 35:
476              text = reply.text
477          else:
478              text = &quot;Do you Agree to Replied Suggestion ?&quot;
479      reply_to = event.reply_to_msg_id if event.is_reply else event.id
480      try:
481          await event.client.send_file(
482              event.chat_id,
483              file=InputMediaPoll(
484                  poll=Poll(
485                      id=12345,
486                      question=text,
487                      answers=[PollAnswer(&quot;Yes&quot;, b&quot;1&quot;), PollAnswer(&quot;No&quot;, b&quot;2&quot;)],
488                  ),
489              ),
490              reply_to=reply_to,
491          )
492      except Exception as e:
493          return await eod(event, f&quot;`Oops, you can&#x27;t send polls here!\n\n{e}`&quot;)
494      await event.delete()
495  @ultroid_cmd(pattern=&quot;ipinfo( (.*)|$)&quot;)
496  async def ipinfo(event):
497      ip = event.text.split()
498      ipaddr = &quot;&quot;
499      try:
500          ipaddr = f&quot;/{ip[1]}&quot;
501      except IndexError:
502          ipaddr = &quot;&quot;
503      det = await async_searcher(f&quot;https://ipinfo.io{ipaddr}/geo&quot;, re_json=True)
504      try:
505          ip = det[&quot;ip&quot;]
506          city = det[&quot;city&quot;]
507          region = det[&quot;region&quot;]
508          country = det[&quot;country&quot;]
509          cord = det[&quot;loc&quot;]
510          try:
511              zipc = det[&quot;postal&quot;]
512          except KeyError:
513              zipc = &quot;None&quot;
514          tz = det[&quot;timezone&quot;]
515          await eor(
516              event,
517              .format(
518                  ip,
519                  city,
520                  region,
521                  country,
522                  cord,
523                  zipc,
524                  tz,
525              ),
526          )
527      except BaseException:
528          err = det[&quot;error&quot;][&quot;title&quot;]
529          msg = det[&quot;error&quot;][&quot;message&quot;]
530          await event.eor(f&quot;ERROR:\n{err}\n{msg}&quot;, time=5)
531  @ultroid_cmd(
532      pattern=&quot;cpy$&quot;,
533  )
534  async def copp(event):
535      msg = await event.get_reply_message()
536      if not msg:
537          return await event.eor(f&quot;Use `{HNDLR}cpy` as reply to a message!&quot;, time=5)
538      _copied_msg[&quot;CLIPBOARD&quot;] = msg
539      await event.eor(f&quot;Copied. Use `{HNDLR}pst` to paste!&quot;, time=10)
540  @asst_cmd(pattern=&quot;pst$&quot;)
541  async def pepsodent(event):
542      await toothpaste(event)
543  @ultroid_cmd(
544      pattern=&quot;pst$&quot;,
545  )
546  async def colgate(event):
547      await toothpaste(event)
548  async def toothpaste(event):
549      try:
550          await event.respond(_copied_msg[&quot;CLIPBOARD&quot;])
551      except KeyError:
552          return await eod(
553              event,
554              f&quot;Nothing was copied! Use `{HNDLR}cpy` as reply to a message first!&quot;,
555          )
556      except Exception as ex:
557          return await event.eor(str(ex), time=5)
558      await event.delete()
559  @ultroid_cmd(pattern=&quot;thumb$&quot;)
560  async def thumb_dl(event):
561      reply = await event.get_reply_message()
562      if not (reply and reply.file):
563          return await eod(event, get_string(&quot;th_1&quot;), time=5)
564      if not reply.file.media.thumbs:
565          return await eod(event, get_string(&quot;th_2&quot;))
566      await event.eor(get_string(&quot;com_1&quot;))
567      x = await event.get_reply_message()
568      m = await x.download_media(thumb=-1)
569      await event.reply(file=m)
570      os.remove(m)
571  @ultroid_cmd(pattern=&quot;getmsg( ?(.*)|$)&quot;)
572  async def get_restriced_msg(event):
573      match = event.pattern_match.group(1).strip()
574      if not match:
575          await event.eor(&quot;`Please provide a link!`&quot;, time=5)
576          return
577      xx = await event.eor(get_string(&quot;com_1&quot;))
578      chat, msg = get_chat_and_msgid(match)
579      if not (chat and msg):
580          return await event.eor(
581              f&quot;{get_string(&#x27;gms_1&#x27;)}!\nEg: `https://t.me/TeamUltroid/3 or `https://t.me/c/1313492028/3`&quot;
582          )
583      try:
584          message = await event.client.get_messages(chat, ids=msg)
585      except BaseException as er:
586          return await event.eor(f&quot;**ERROR**\n`{er}`&quot;)
587      try:
588          await event.client.send_message(event.chat_id, message)
589          await xx.try_delete()
590          return
591      except ChatForwardsRestrictedError:
592          pass
593      if message.media:
594          thumb = None
595          if message.document.thumbs:
596              thumb = await message.download_media(thumb=-1)
597          media, _ = await event.client.fast_downloader(
598              message.document,
599              show_progress=True,
600              event=xx,
601              message=f&quot;Downloading {message.file.name}...&quot;,
602          )
603          await xx.edit(&quot;`Uploading...`&quot;)
604          uploaded, _ = await event.client.fast_uploader(
605              media.name, event=xx, show_progress=True, to_delete=True
606          )
607          typ = not bool(message.video)
608          await event.reply(
609              message.text,
610              file=uploaded,
611              supports_streaming=typ,
612              force_document=typ,
613              thumb=thumb,
614              attributes=message.document.attributes,
615          )
616          await xx.delete()
617          if thumb:
618              os.remove(thumb)
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-tools_13.py</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Ultroid-MDEwOlJlcG9zaXRvcnkzNDEwMzg2MDI=-flat-utilities.py</div>
                </div>
                <div class="column column_space"><pre><code>46          text = txt
47      elif event.is_reply:
48          previous_message = await event.get_reply_message()
49          text = previous_message.message
</pre></code></div>
                <div class="column column_space"><pre><code>167          message = input_str
168      elif event.reply_to_msg_id:
169          previous_message = await event.get_reply_message()
170          if previous_message.media:
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    