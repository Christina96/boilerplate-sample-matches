<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for test_cdl.py & test_cc.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for test_cdl.py & test_cc.py
      </h3>
      <h1 align="center">
        56.4%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>test_cdl.py (66.61184%)<TH>test_cc.py (48.913044%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#0',2,'match2-1.html#0',3)" NAME="0">(1033-1092)<TD><A HREF="javascript:ZweiFrames('match2-0.html#0',2,'match2-1.html#0',3)" NAME="0">(779-834)</A><TD ALIGN=center><FONT COLOR="#ff0000">52</FONT>
<TR><TD BGCOLOR="#f63526"><FONT COLOR="#f63526">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#1',2,'match2-1.html#1',3)" NAME="1">(961-1004)<TD><A HREF="javascript:ZweiFrames('match2-0.html#1',2,'match2-1.html#1',3)" NAME="1">(648-683)</A><TD ALIGN=center><FONT COLOR="#c40000">40</FONT>
<TR><TD BGCOLOR="#980517"><FONT COLOR="#980517">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#2',2,'match2-1.html#2',3)" NAME="2">(719-752)<TD><A HREF="javascript:ZweiFrames('match2-0.html#2',2,'match2-1.html#2',3)" NAME="2">(314-347)</A><TD ALIGN=center><FONT COLOR="#b50000">37</FONT>
<TR><TD BGCOLOR="#53858b"><FONT COLOR="#53858b">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#3',2,'match2-1.html#3',3)" NAME="3">(15-629)<TD><A HREF="javascript:ZweiFrames('match2-0.html#3',2,'match2-1.html#3',3)" NAME="3">(16-186)</A><TD ALIGN=center><FONT COLOR="#9c0000">32</FONT>
<TR><TD BGCOLOR="#6cc417"><FONT COLOR="#6cc417">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#4',2,'match2-1.html#4',3)" NAME="4">(752-784)<TD><A HREF="javascript:ZweiFrames('match2-0.html#4',2,'match2-1.html#4',3)" NAME="4">(383-415)</A><TD ALIGN=center><FONT COLOR="#700000">23</FONT>
<TR><TD BGCOLOR="#151b8d"><FONT COLOR="#151b8d">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#5',2,'match2-1.html#5',3)" NAME="5">(631-655)<TD><A HREF="javascript:ZweiFrames('match2-0.html#5',2,'match2-1.html#5',3)" NAME="5">(269-295)</A><TD ALIGN=center><FONT COLOR="#660000">21</FONT>
<TR><TD BGCOLOR="#8c8774"><FONT COLOR="#8c8774">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#6',2,'match2-1.html#6',3)" NAME="6">(1142-1150)<TD><A HREF="javascript:ZweiFrames('match2-0.html#6',2,'match2-1.html#6',3)" NAME="6">(568-578)</A><TD ALIGN=center><FONT COLOR="#620000">20</FONT>
<TR><TD BGCOLOR="#38a4a5"><FONT COLOR="#38a4a5">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#7',2,'match2-1.html#7',3)" NAME="7">(924-931)<TD><A HREF="javascript:ZweiFrames('match2-0.html#7',2,'match2-1.html#7',3)" NAME="7">(451-460)</A><TD ALIGN=center><FONT COLOR="#620000">20</FONT>
<TR><TD BGCOLOR="#c58917"><FONT COLOR="#c58917">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#8',2,'match2-1.html#8',3)" NAME="8">(1095-1100)<TD><A HREF="javascript:ZweiFrames('match2-0.html#8',2,'match2-1.html#8',3)" NAME="8">(604-611)</A><TD ALIGN=center><FONT COLOR="#5d0000">19</FONT>
<TR><TD BGCOLOR="#83a33a"><FONT COLOR="#83a33a">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#9',2,'match2-1.html#9',3)" NAME="9">(1195-1202)<TD><A HREF="javascript:ZweiFrames('match2-0.html#9',2,'match2-1.html#9',3)" NAME="9">(508-515)</A><TD ALIGN=center><FONT COLOR="#580000">18</FONT>
<TR><TD BGCOLOR="#ad5910"><FONT COLOR="#ad5910">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#10',2,'match2-1.html#10',3)" NAME="10">(1168-1175)<TD><A HREF="javascript:ZweiFrames('match2-0.html#10',2,'match2-1.html#10',3)" NAME="10">(478-485)</A><TD ALIGN=center><FONT COLOR="#580000">18</FONT>
<TR><TD BGCOLOR="#b041ff"><FONT COLOR="#b041ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#11',2,'match2-1.html#11',3)" NAME="11">(1020-1024)<TD><A HREF="javascript:ZweiFrames('match2-0.html#11',2,'match2-1.html#11',3)" NAME="11">(541-545)</A><TD ALIGN=center><FONT COLOR="#530000">17</FONT>
<TR><TD BGCOLOR="#571b7e"><FONT COLOR="#571b7e">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#12',2,'match2-1.html#12',3)" NAME="12">(1204-1211)<TD><A HREF="javascript:ZweiFrames('match2-0.html#12',2,'match2-1.html#12',3)" NAME="12">(769-778)</A><TD ALIGN=center><FONT COLOR="#4e0000">16</FONT>
<TR><TD BGCOLOR="#3b9c9c"><FONT COLOR="#3b9c9c">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#13',2,'match2-1.html#13',3)" NAME="13">(1177-1195)<TD><A HREF="javascript:ZweiFrames('match2-0.html#13',2,'match2-1.html#13',3)" NAME="13">(871-883)</A><TD ALIGN=center><FONT COLOR="#4e0000">16</FONT>
<TR><TD BGCOLOR="#842dce"><FONT COLOR="#842dce">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#14',2,'match2-1.html#14',3)" NAME="14">(1152-1168)<TD><A HREF="javascript:ZweiFrames('match2-0.html#14',2,'match2-1.html#14',3)" NAME="14">(853-865)</A><TD ALIGN=center><FONT COLOR="#4e0000">16</FONT>
<TR><TD BGCOLOR="#f52887"><FONT COLOR="#f52887">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#15',2,'match2-1.html#15',3)" NAME="15">(944-958)<TD><A HREF="javascript:ZweiFrames('match2-0.html#15',2,'match2-1.html#15',3)" NAME="15">(710-723)</A><TD ALIGN=center><FONT COLOR="#490000">15</FONT>
<TR><TD BGCOLOR="#2981b2"><FONT COLOR="#2981b2">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#16',2,'match2-1.html#16',3)" NAME="16">(673-708)<TD><A HREF="javascript:ZweiFrames('match2-0.html#16',2,'match2-1.html#16',3)" NAME="16">(845-851)</A><TD ALIGN=center><FONT COLOR="#3f0000">13</FONT>
<TR><TD BGCOLOR="#3090c7"><FONT COLOR="#3090c7">-</FONT><TD><A HREF="javascript:ZweiFrames('match2-0.html#17',2,'match2-1.html#17',3)" NAME="17">(1026-1027)<TD><A HREF="javascript:ZweiFrames('match2-0.html#17',2,'match2-1.html#17',3)" NAME="17">(890-891)</A><TD ALIGN=center><FONT COLOR="#3a0000">12</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_cdl.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
#!/usr/bin/env python
&quot;&quot;&quot;
Tests the cdl related functions of cdl_convert

REQUIREMENTS:

mock
&quot;&quot;&quot;

#==============================================================================
# IMPORTS
<A NAME="3"></A>#==============================================================================

# Standard Imports
<FONT color="#53858b"><A HREF="javascript:ZweiFrames('match2-1.html#3',3,'match2-top.html#3',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>try:
    from unittest import mock
except ImportError:
    import mock
import os
import sys
import tempfile
import unittest
from xml.etree import ElementTree

# Grab our test's path and append the cdL_convert root directory

# There has to be a better method than:
# 1) Getting our current directory
# 2) Splitting into list
# 3) Splicing out the last 3 entries (filepath, test dir, tools dir)
# 4) Joining
# 5) Appending to our Python path.

sys.path.append('/'.join(os.path.realpath(__file__).split('/')[:-2]))

import cdl_convert

#==============================================================================
# GLOBALS
#==============================================================================

# parse_cdl ===================================================================

CDL_FULL = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorDecisionList xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;
    &lt;Description&gt;CDL description 1&lt;/Description&gt;
    &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
    &lt;Description&gt;CDL description 2&lt;/Description&gt;
    &lt;ColorDecision&gt;
        &lt;Description&gt;CD description 1&lt;/Description&gt;
        &lt;InputDescription&gt;CD Input Desc Text&lt;/InputDescription&gt;
        &lt;Description&gt;CD description 2&lt;/Description&gt;
        &lt;MediaRef ref=&quot;/best/path/ever.dpx&quot;/&gt;
        &lt;Description&gt;CD description 3&lt;/Description&gt;
        &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
            &lt;Description&gt;CC description 1&lt;/Description&gt;
            &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
            &lt;Description&gt;CC description 2&lt;/Description&gt;
            &lt;SOPNode&gt;
                &lt;Description&gt;Sop description 1&lt;/Description&gt;
                &lt;Description&gt;Sop description 2&lt;/Description&gt;
                &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
                &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
                &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
                &lt;Description&gt;Sop description 3&lt;/Description&gt;
            &lt;/SOPNode&gt;
            &lt;Description&gt;CC description 3&lt;/Description&gt;
            &lt;SATNode&gt;
                &lt;Description&gt;Sat description 1&lt;/Description&gt;
                &lt;Saturation&gt;1.09&lt;/Saturation&gt;
                &lt;Description&gt;Sat description 2&lt;/Description&gt;
            &lt;/SATNode&gt;
            &lt;Description&gt;CC description 4&lt;/Description&gt;
            &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
            &lt;Description&gt;CC description 5&lt;/Description&gt;
        &lt;/ColorCorrection&gt;
        &lt;ViewingDescription&gt;CD WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
            &lt;SopNode&gt;
                &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
                &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
                &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
            &lt;/SopNode&gt;
            &lt;SatNode&gt;
                &lt;Saturation&gt;1.01&lt;/Saturation&gt;
            &lt;/SatNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;relative/path/13.jpg&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;f51.200&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ColorCorrection id=&quot;f55.100&quot;&gt;
            &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
            &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
            &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
            &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
            &lt;SopNode&gt;
                &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
                &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
                &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
                &lt;Power&gt;3271893.993 .0000998 0.0000000000000000113&lt;/Power&gt;
            &lt;/SopNode&gt;
            &lt;SatNode&gt;
                &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
            &lt;/SatNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
        &lt;Description&gt;&lt;/Description&gt;
        &lt;Description&gt;CD description 1&lt;/Description&gt;
        &lt;ColorCorrection id=&quot;f54.112&quot;&gt;
            &lt;ASC_SAT&gt;
                &lt;Saturation&gt;1.01&lt;/Saturation&gt;
            &lt;/ASC_SAT&gt;
            &lt;ASC_SOP&gt;
                &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
                &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
                &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
            &lt;/ASC_SOP&gt;
        &lt;/ColorCorrection&gt;
        &lt;Description&gt;CD description 2&lt;/Description&gt;
        &lt;InputDescription&gt;CD Input Desc Text 2&lt;/InputDescription&gt;
    &lt;/ColorDecision&gt;
    &lt;Description&gt;CDL description 3&lt;/Description&gt;
    &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
    &lt;Description&gt;CDL description 4&lt;/Description&gt;
    &lt;ColorDecision&gt;
        &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
        &lt;ColorCorrection id=&quot;burp_100.x12&quot;&gt;
            &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
            &lt;Description&gt;&lt;/Description&gt;
            &lt;SOPNode&gt;
                &lt;Description&gt;&lt;/Description&gt;
                &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
                &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
                &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
            &lt;/SOPNode&gt;
            &lt;Description&gt;&lt;/Description&gt;
            &lt;InputDescription&gt;&lt;/InputDescription&gt;
            &lt;SatNode&gt;
                &lt;Saturation&gt;1.09&lt;/Saturation&gt;
                &lt;Description&gt;&lt;/Description&gt;
            &lt;/SatNode&gt;
            &lt;Description&gt;&lt;/Description&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ViewingDescription&gt;12345&lt;/ViewingDescription&gt;
        &lt;ColorCorrectionRef ref=&quot;f54.112&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;Description&gt;CDL description 5&lt;/Description&gt;
&lt;/ColorDecisionList&gt;
&quot;&quot;&quot;

CDL_ODD = r&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorDecisionList&gt;
    &lt;Description&gt;&lt;/Description&gt;
    &lt;InputDescription&gt;&lt;/InputDescription&gt;
    &lt;Description&gt;CDL description 1&lt;/Description&gt;
    &lt;Description&gt;&lt;/Description&gt;
    &lt;Description&gt;&lt;/Description&gt;
    &lt;Description&gt;&lt;/Description&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;C:\\Windows\File\Path&quot;/&gt;
        &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Description&gt;Sop description 1&lt;/Description&gt;
                &lt;Description&gt;Sop description 2&lt;/Description&gt;
                &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
                &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
                &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
                &lt;Description&gt;Sop description 3&lt;/Description&gt;
            &lt;/SOPNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
            &lt;SopNode&gt;
                &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
                &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
                &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
            &lt;/SopNode&gt;
        &lt;/ColorCorrection&gt;
        &lt;MediaRef ref=&quot;relative\windows\path&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;ColorDecision&gt;
        &lt;Description&gt;&lt;/Description&gt;
        &lt;InputDescription&gt;&lt;/InputDescription&gt;
        &lt;Description&gt;CD description 1&lt;/Description&gt;
        &lt;Description&gt;&lt;/Description&gt;
        &lt;Description&gt;&lt;/Description&gt;
        &lt;Description&gt;&lt;/Description&gt;
        &lt;ColorCorrectionRef ref=&quot;014_xf_seqGrade_v01&quot;/&gt;
        &lt;MediaRef ref=&quot;./sameDirectory/loser.####.fbx&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;../lateralDirectory/file.lives.here.0120.dpx&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;missingRef&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;http://www.google.com/logo.jpg&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;alsoMissingRef&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;serv://proto/uri:area:full?query=result#fragment&quot;/&gt;
        &lt;ColorCorrection id=&quot;burp_200.x15&quot;&gt;
            &lt;SatNode&gt;
                &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
                &lt;Saturation&gt;1.01&lt;/Saturation&gt;
            &lt;/SatNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
        &lt;MediaRef ref=&quot;..\.\..\..\..\This\should\not\be\legal\&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;f51.200&quot;/&gt;
    &lt;/ColorDecision&gt;
&lt;/ColorDecisionList&gt;
&quot;&quot;&quot;

# write_cdl ===================================================================

CDL_FULL_WRITE = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorDecisionList xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;
    &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
    &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
    &lt;Description&gt;CDL description 1&lt;/Description&gt;
    &lt;Description&gt;CDL description 2&lt;/Description&gt;
    &lt;Description&gt;CDL description 3&lt;/Description&gt;
    &lt;Description&gt;CDL description 4&lt;/Description&gt;
    &lt;Description&gt;CDL description 5&lt;/Description&gt;
    &lt;ColorDecision&gt;
        &lt;InputDescription&gt;CD Input Desc Text&lt;/InputDescription&gt;
        &lt;ViewingDescription&gt;CD WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
        &lt;Description&gt;CD description 1&lt;/Description&gt;
        &lt;Description&gt;CD description 2&lt;/Description&gt;
        &lt;Description&gt;CD description 3&lt;/Description&gt;
        &lt;MediaRef ref=&quot;/best/path/ever.dpx&quot;/&gt;
        &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
            &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
            &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
            &lt;Description&gt;CC description 1&lt;/Description&gt;
            &lt;Description&gt;CC description 2&lt;/Description&gt;
            &lt;Description&gt;CC description 3&lt;/Description&gt;
            &lt;Description&gt;CC description 4&lt;/Description&gt;
            &lt;Description&gt;CC description 5&lt;/Description&gt;
            &lt;SOPNode&gt;
                &lt;Description&gt;Sop description 1&lt;/Description&gt;
                &lt;Description&gt;Sop description 2&lt;/Description&gt;
                &lt;Description&gt;Sop description 3&lt;/Description&gt;
                &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
                &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
                &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
            &lt;/SOPNode&gt;
            &lt;SATNode&gt;
                &lt;Description&gt;Sat description 1&lt;/Description&gt;
                &lt;Description&gt;Sat description 2&lt;/Description&gt;
                &lt;Saturation&gt;1.09&lt;/Saturation&gt;
            &lt;/SATNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
                &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
                &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
            &lt;/SOPNode&gt;
            &lt;SATNode&gt;
                &lt;Saturation&gt;1.01&lt;/Saturation&gt;
            &lt;/SATNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;relative/path/13.jpg&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;f51.200&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ColorCorrection id=&quot;f55.100&quot;&gt;
            &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
            &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
            &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
            &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
            &lt;SOPNode&gt;
                &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
                &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
                &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
                &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
            &lt;/SOPNode&gt;
            &lt;SATNode&gt;
                &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
            &lt;/SATNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;InputDescription&gt;CD Input Desc Text 2&lt;/InputDescription&gt;
        &lt;Description&gt;CD description 1&lt;/Description&gt;
        &lt;Description&gt;CD description 2&lt;/Description&gt;
        &lt;ColorCorrection id=&quot;f54.112&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
                &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
                &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
            &lt;/SOPNode&gt;
            &lt;SATNode&gt;
                &lt;Saturation&gt;1.01&lt;/Saturation&gt;
            &lt;/SATNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ColorCorrection id=&quot;burp_100.x12&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
                &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
                &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
            &lt;/SOPNode&gt;
            &lt;SATNode&gt;
                &lt;Saturation&gt;1.09&lt;/Saturation&gt;
            &lt;/SATNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;ViewingDescription&gt;12345&lt;/ViewingDescription&gt;
        &lt;ColorCorrectionRef ref=&quot;f54.112&quot;/&gt;
    &lt;/ColorDecision&gt;
&lt;/ColorDecisionList&gt;
&quot;&quot;&quot;

CDL_FULL_WRITE_CCC = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrectionCollection xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;
    &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
    &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
    &lt;Description&gt;CDL description 1&lt;/Description&gt;
    &lt;Description&gt;CDL description 2&lt;/Description&gt;
    &lt;Description&gt;CDL description 3&lt;/Description&gt;
    &lt;Description&gt;CDL description 4&lt;/Description&gt;
    &lt;Description&gt;CDL description 5&lt;/Description&gt;
    &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
        &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
        &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
        &lt;Description&gt;CC description 1&lt;/Description&gt;
        &lt;Description&gt;CC description 2&lt;/Description&gt;
        &lt;Description&gt;CC description 3&lt;/Description&gt;
        &lt;Description&gt;CC description 4&lt;/Description&gt;
        &lt;Description&gt;CC description 5&lt;/Description&gt;
        &lt;SOPNode&gt;
            &lt;Description&gt;Sop description 1&lt;/Description&gt;
            &lt;Description&gt;Sop description 2&lt;/Description&gt;
            &lt;Description&gt;Sop description 3&lt;/Description&gt;
            &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
            &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
            &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
        &lt;/SOPNode&gt;
        &lt;SATNode&gt;
            &lt;Description&gt;Sat description 1&lt;/Description&gt;
            &lt;Description&gt;Sat description 2&lt;/Description&gt;
            &lt;Saturation&gt;1.09&lt;/Saturation&gt;
        &lt;/SATNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
            &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
            &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
        &lt;/SOPNode&gt;
        &lt;SATNode&gt;
            &lt;Saturation&gt;1.01&lt;/Saturation&gt;
        &lt;/SATNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
            &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
            &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
        &lt;/SOPNode&gt;
        &lt;SATNode&gt;
            &lt;Saturation&gt;1.01&lt;/Saturation&gt;
        &lt;/SATNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;f55.100&quot;&gt;
        &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
        &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
        &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
        &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
        &lt;SOPNode&gt;
            &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
            &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
            &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
            &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
        &lt;/SOPNode&gt;
        &lt;SATNode&gt;
            &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
        &lt;/SATNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;f54.112&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
            &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
            &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
        &lt;/SOPNode&gt;
        &lt;SATNode&gt;
            &lt;Saturation&gt;1.01&lt;/Saturation&gt;
        &lt;/SATNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;burp_100.x12&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
            &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
            &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
        &lt;/SOPNode&gt;
        &lt;SATNode&gt;
            &lt;Saturation&gt;1.09&lt;/Saturation&gt;
        &lt;/SATNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;f54.112&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
            &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
            &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
        &lt;/SOPNode&gt;
        &lt;SATNode&gt;
            &lt;Saturation&gt;1.01&lt;/Saturation&gt;
        &lt;/SATNode&gt;
    &lt;/ColorCorrection&gt;
&lt;/ColorCorrectionCollection&gt;
&quot;&quot;&quot;

CDL_ODD_WRITE = r&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorDecisionList xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;
    &lt;Description&gt;CDL description 1&lt;/Description&gt;
    &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;C:\\Windows\File\Path&quot;/&gt;
        &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Description&gt;Sop description 1&lt;/Description&gt;
                &lt;Description&gt;Sop description 2&lt;/Description&gt;
                &lt;Description&gt;Sop description 3&lt;/Description&gt;
                &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
                &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
                &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
            &lt;/SOPNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;relative\windows\path&quot;/&gt;
        &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
                &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
                &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
            &lt;/SOPNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;Description&gt;CD description 1&lt;/Description&gt;
        &lt;MediaRef ref=&quot;./sameDirectory/loser.####.fbx&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;014_xf_seqGrade_v01&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;../lateralDirectory/file.lives.here.0120.dpx&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;missingRef&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;http://www.google.com/logo.jpg&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;alsoMissingRef&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;serv://proto/uri:area:full?query=result#fragment&quot;/&gt;
        &lt;ColorCorrection id=&quot;burp_200.x15&quot;&gt;
            &lt;SATNode&gt;
                &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
                &lt;Saturation&gt;1.01&lt;/Saturation&gt;
            &lt;/SATNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
        &lt;MediaRef ref=&quot;..\.\..\..\..\This\should\not\be\legal\&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;f51.200&quot;/&gt;
    &lt;/ColorDecision&gt;
&lt;/ColorDecisionList&gt;
&quot;&quot;&quot;

CDL_ODD_WRITE_RESOLVED = r&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorDecisionList xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;
    &lt;Description&gt;CDL description 1&lt;/Description&gt;
    &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;C:\\Windows\File\Path&quot;/&gt;
        &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Description&gt;Sop description 1&lt;/Description&gt;
                &lt;Description&gt;Sop description 2&lt;/Description&gt;
                &lt;Description&gt;Sop description 3&lt;/Description&gt;
                &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
                &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
                &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
            &lt;/SOPNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;relative\windows\path&quot;/&gt;
        &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
                &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
                &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
            &lt;/SOPNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;Description&gt;CD description 1&lt;/Description&gt;
        &lt;MediaRef ref=&quot;./sameDirectory/loser.####.fbx&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;014_xf_seqGrade_v01&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;../lateralDirectory/file.lives.here.0120.dpx&quot;/&gt;
        &lt;ColorCorrection id=&quot;missingRef&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Slope&gt;1.0 2.0 1.0&lt;/Slope&gt;
                &lt;Offset&gt;0.0 0.0 0.0&lt;/Offset&gt;
                &lt;Power&gt;1.0 1.0 1.0&lt;/Power&gt;
            &lt;/SOPNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;http://www.google.com/logo.jpg&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;alsoMissingRef&quot;/&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;MediaRef ref=&quot;serv://proto/uri:area:full?query=result#fragment&quot;/&gt;
        &lt;ColorCorrection id=&quot;burp_200.x15&quot;&gt;
            &lt;SATNode&gt;
                &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
                &lt;Saturation&gt;1.01&lt;/Saturation&gt;
            &lt;/SATNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
    &lt;ColorDecision&gt;
        &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
        &lt;MediaRef ref=&quot;..\.\..\..\..\This\should\not\be\legal\&quot;/&gt;
        &lt;ColorCorrectionRef ref=&quot;f51.200&quot;/&gt;
    &lt;/ColorDecision&gt;
&lt;/ColorDecisionList&gt;
&quot;&quot;&quot;

CDL_ODD_WRITE_CCC = r&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrectionCollection xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;
    &lt;Description&gt;CDL description 1&lt;/Description&gt;
    &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Description&gt;Sop description 1&lt;/Description&gt;
            &lt;Description&gt;Sop description 2&lt;/Description&gt;
            &lt;Description&gt;Sop description 3&lt;/Description&gt;
            &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
            &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
            &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
        &lt;/SOPNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
            &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
            &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
        &lt;/SOPNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Description&gt;Sop description 1&lt;/Description&gt;
            &lt;Description&gt;Sop description 2&lt;/Description&gt;
            &lt;Description&gt;Sop description 3&lt;/Description&gt;
            &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
            &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
            &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
        &lt;/SOPNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;burp_200.x15&quot;&gt;
        &lt;SATNode&gt;
            &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
            &lt;Saturation&gt;1.01&lt;/Saturation&gt;
        &lt;/SATNode&gt;
    &lt;/ColorCorrection&gt;
    &lt;ColorCorrection id=&quot;f51.200&quot;&gt;
        &lt;SOPNode&gt;
            &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
            &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
            &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
        &lt;/SOPNode&gt;
    &lt;/ColorCorrection&gt;
&lt;/ColorCorrectionCollection&gt;
&quot;&quot;&quot;

CDL_BAD_TAG = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorDecisionBlist xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;
    &lt;Description&gt;CCC description 1&lt;/Description&gt;
    &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;ColorDecision&gt;
        &lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
            &lt;SOPNode&gt;
                &lt;Description&gt;Sop description 1&lt;/Description&gt;
                &lt;Description&gt;Sop description 2&lt;/Description&gt;
                &lt;Description&gt;Sop description 3&lt;/Description&gt;
                &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
                &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
                &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
            &lt;/SOPNode&gt;
        &lt;/ColorCorrection&gt;
    &lt;/ColorDecision&gt;
&lt;/ColorDecisionBlist&gt;
&quot;&quot;&quot;

# misc ========================================================================

<A NAME="5"></A>UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
LOWER =</B></FONT> 'abcdefghijklmnopqrstuvwxyz'

<FONT color="#151b8d"><A HREF="javascript:ZweiFrames('match2-1.html#5',3,'match2-top.html#5',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>if sys.version_info[0] &gt;= 3:
    enc = lambda x: bytes(x, 'UTF-8')
else:
    enc = lambda x: x

if sys.version_info[0] &gt;= 3:
    builtins = 'builtins'
else:
    builtins = '__builtin__'

#==============================================================================
# TEST CLASSES
#==============================================================================


class TestParseCDLFull(unittest.TestCase):
    &quot;&quot;&quot;Tests a full CDL parse&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.desc = [
            'CDL description 1'</B></FONT>,
            'CDL description 2',
            'CDL description 3',
            'CDL description 4',
            'CDL description 5'
        ]
        self.input_desc = 'CDL Input Desc Text'
        self.viewing_desc = 'CDL Viewing Desc Text'
        self.color_correction_ids = [
            '014_xf_seqGrade_v01',
            'f51.200',
            'f51.200',
            'f55.100',
            'f54.112',
            'burp_100.x12',
<A NAME="16"></A>            'f54.112',
        ]
        self.media_ref_refs = [
            <FONT color="#2981b2"><A HREF="javascript:ZweiFrames('match2-1.html#16',3,'match2-top.html#16',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>&quot;/best/path/ever.dpx&quot;,
            None,
            &quot;relative/path/13.jpg&quot;,
            None,
            None,
            None,
            None,
        ]
        self.color_decision_descs = [
            ['CD description 1', 'CD description 2', 'CD description 3'],
            [],
            [],
            [],
            ['CD description 1', 'CD description 2'],
            [],
            [],
        ]
        self.color_decision_input_descs = [
            'CD Input Desc Text',
            None,
            None,
            None,
            'CD Input Desc Text 2',
            None,
            None,
        ]
        self.color_decision_viewing_descs = [
            'CD WOOD VIEWER!? ////',
            None,
            None,
            None,
            None,
            None,
            '12345'
        ]
        self.</B></FONT>color_decision_is_ref = [
            False,
            False,
            True,
            False,
            False,
            False,
            True,
<A NAME="2"></A>        ]

        # Build our cdl
        <FONT color="#980517"><A HREF="javascript:ZweiFrames('match2-1.html#2',3,'match2-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CDL_FULL))
            self.filename = f.name

        self.node = cdl_convert.parse_cdl(self.filename)

    #==========================================================================

    def tearDown(self):
        # The system should clean these up automatically,
        # but we'll be neat.
        os.remove(self.filename)
        # We need to clear the ColorCorrection member dictionary so we don't
        # have to worry about non-unique ids.
        cdl_convert.reset_all()

    #==========================================================================
    # TESTS
    #==========================================================================

    def test_file_in(self):
        &quot;&quot;&quot;Tests that the input_file has been set to the file in value&quot;&quot;&quot;
        self.assertEqual(
            self.filename,
            self.node.file_in
        )

    #==========================================================================

    def test_type(self):
<A NAME="4"></A>        &quot;&quot;&quot;Makes sure type is still set to ccc&quot;&quot;&quot;
        self.assertEqual(
            'cdl',
            self.node.</B></FONT><FONT color="#6cc417"><A HREF="javascript:ZweiFrames('match2-1.html#4',3,'match2-top.html#4',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>type
        )

    #==========================================================================

    def test_descs(self):
        &quot;&quot;&quot;Tests that the desc fields have been set correctly&quot;&quot;&quot;
        self.assertEqual(
            self.desc,
            self.node.desc
        )

    #==========================================================================

    def test_viewing_desc(self):
        &quot;&quot;&quot;Tests that the viewing desc has been set correctly&quot;&quot;&quot;
        self.assertEqual(
            self.viewing_desc,
            self.node.viewing_desc
        )

    #==========================================================================

    def test_input_desc(self):
        &quot;&quot;&quot;Tests that the input desc has been set correctly&quot;&quot;&quot;
        self.assertEqual(
            self.input_desc,
            self.node.input_desc
        )

    #==========================================================================

    def</B></FONT> test_parse_cc_results(self):
        &quot;&quot;&quot;Tests that the parser picked up all the cc's&quot;&quot;&quot;
        id_list = [i.cc.id for i in self.node.color_decisions]
        self.assertEqual(
            self.color_correction_ids,
            id_list
        )

    #==========================================================================

    def test_media_ref_refs(self):
        &quot;&quot;&quot;Tests that all media ref refs were parsed correctly&quot;&quot;&quot;
        ref_list = [
            i.media_ref.ref if i.media_ref else None for i in self.node.color_decisions
        ]
        self.assertEqual(
            self.media_ref_refs,
            ref_list
        )

    #==========================================================================

    def test_color_decision_descs(self):
        &quot;&quot;&quot;Tests that color decision descs are parsed correctly&quot;&quot;&quot;
        desc_list = [
            i.desc for i in self.node.color_decisions
        ]
        self.assertEqual(
            self.color_decision_descs,
            desc_list
        )

    #==========================================================================

    def test_color_decision_input_descs(self):
        &quot;&quot;&quot;Tests that color decision input descs are parsed correctly&quot;&quot;&quot;
        desc_list = [
            i.input_desc for i in self.node.color_decisions
        ]
        self.assertEqual(
            self.color_decision_input_descs,
            desc_list
        )

    #==========================================================================

    def test_color_decision_viewing_descs(self):
        &quot;&quot;&quot;Tests that color decision viewing descs are parsed correctly&quot;&quot;&quot;
        desc_list = [
            i.viewing_desc for i in self.node.color_decisions
        ]
        self.assertEqual(
            self.color_decision_viewing_descs,
            desc_list
        )

    #==========================================================================

    def test_color_decision_is_ref(self):
        &quot;&quot;&quot;Tests that color decision references are parsed correctly&quot;&quot;&quot;
        ref_list = [
            i.is_ref for i in self.node.color_decisions
        ]
        self.assertEqual(
            self.color_decision_is_ref,
            ref_list
        )


class TestParseCDLOdd(TestParseCDLFull):
    &quot;&quot;&quot;Tests an odd CDL parse&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.desc = [
            'CDL description 1',
            'Raised1 saturation a little!?! ag... \/Offset',
            'Raised2 saturation a little!?! ag... \/Offset',
        ]
        self.input_desc = None
        self.viewing_desc = None
        self.color_correction_ids = [
            '014_xf_seqGrade_v01',
            'f51.200',
            '014_xf_seqGrade_v01',
            'missingRef',
            'alsoMissingRef',
            'burp_200.x15',
            'f51.200'
        ]
        self.media_ref_refs = [
            &quot;C:\\\\Windows\\File\\Path&quot;,
            &quot;relative\\windows\\path&quot;,
            &quot;./sameDirectory/loser.####.fbx&quot;,
            &quot;../lateralDirectory/file.lives.here.0120.dpx&quot;,
            &quot;http://www.google.com/logo.jpg&quot;,
            &quot;serv://proto/uri:area:full?query=result#fragment&quot;,
            &quot;..\\.\\..\\..\\..\\This\\should\\not\\be\\legal\\&quot;
        ]
        self.color_decision_descs = [
            [],
            [],
            ['CD description 1'],
            [],
            [],
            [],
            ['Raised2 saturation a little!?! ag... \/Offset']
        ]
        self.color_decision_input_descs = [
            None,
            None,
            None,
            None,
            None,
            None,
            None,
        ]
        self.color_decision_viewing_descs = [
            None,
            None,
            None,
            None,
            None,
            None,
            None,
        ]
        self.color_decision_is_ref = [
            False,
            False,
            True,
            True,
            True,
            False,
            True,
<A NAME="7"></A>        ]

        # Build our ccc
        <FONT color="#38a4a5"><A HREF="javascript:ZweiFrames('match2-1.html#7',3,'match2-top.html#7',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CDL_ODD))
            self.filename = f.name

        self.node = cdl_convert.parse_cdl(self.filename)


class</B></FONT> TestParseCDLExceptions(unittest.TestCase):
    &quot;&quot;&quot;Tests that we run into the correct exceptions with bad XMLs&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.filename = None

<A NAME="15"></A>    def tearDown(self):
        if self.filename:
            os.remove(self.filename)
        cdl_convert.reset_all(<FONT color="#f52887"><A HREF="javascript:ZweiFrames('match2-1.html#15',3,'match2-top.html#15',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>)

    #==========================================================================
    # TESTS
    #==========================================================================

    def testBadTag(self):
        &quot;&quot;&quot;Tests that a bad root tag raises a ValueError&quot;&quot;&quot;

        # Build our cdl
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CDL_BAD_TAG))
            self.filename = f.name

<A NAME="1"></A>        self.</B></FONT>assertRaises(
            ValueError,
            cdl_convert.parse_cdl,
            self<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match2-1.html#1',3,'match2-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>.filename,
        )

    #==========================================================================

    def testEmptyCDL(self):
        &quot;&quot;&quot;Tests that an empty CCC file raises a ValueError&quot;&quot;&quot;

        emptyCDL = ('&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n'
                    '&lt;ColorDecisionList xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;\n'
                    '&lt;/ColorDecisionList&gt;')

        # Build our cdl
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(emptyCDL))
            self.filename = f.name

        self.assertRaises(
            ValueError,
            cdl_convert.parse_cdl,
            self.filename,
        )

    #==========================================================================

    def testEmptyCD(self):
        &quot;&quot;&quot;Tests that an empty ColorDecision file raises a ValueError&quot;&quot;&quot;

        emptyCDL = ('&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n'
                    '&lt;ColorDecisionList xmlns=&quot;urn:ASC:CDL:v1.01&quot;&gt;\n'
                    '\t&lt;ColorDecision&gt;\n'
                    '\t\t&lt;MediaRef ref=&quot;bestref.dpx&quot;/&gt;\n'
                    '\t&lt;/ColorDecision&gt;\n'
                    '&lt;/ColorDecisionList&gt;')

        # Build our ccc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(emptyCDL))
            self.filename = f.name

        self.assertRaises(
            ValueError,
            cdl_convert.parse_cdl,
            self.</B></FONT>filename,
        )

class TestWriteCDLFull(unittest.TestCase):
    &quot;&quot;&quot;Tests a full write of the CDL file

    This is an integration style test. If parse_cdl stops working, this stops
    working.

    &quot;&quot;&quot;
    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================
<A NAME="11"></A>
    def setUp(self):
        # Build our cdl
        <FONT color="#b041ff"><A HREF="javascript:ZweiFrames('match2-1.html#11',3,'match2-top.html#11',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CDL_FULL))
            self.filename = f.name
<A NAME="17"></A>
        self.cdl = cdl_convert.parse_cdl(self.</B></FONT>filename)

        self<FONT color="#3090c7"><A HREF="javascript:ZweiFrames('match2-1.html#17',3,'match2-top.html#17',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>.target_xml_root = enc(CDL_FULL_WRITE)
        self.target_xml = enc('\n'.join(CDL_FULL_WRITE.split('\n')[</B></FONT>1:]))

    #==========================================================================
<A NAME="0"></A>
    def tearDown(self):
        os.remove(self.filename)
        cdl_convert<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match2-1.html#0',3,'match2-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>.reset_all()

    #==========================================================================
    # TESTS
    #==========================================================================

    def test_root_xml(self):
        &quot;&quot;&quot;Tests that root_xml returns the full XML as expected&quot;&quot;&quot;
        self.assertEqual(
            self.target_xml_root,
            self.cdl.xml_root
        )

    #==========================================================================

    def test_base_xml(self):
        &quot;&quot;&quot;Tests that the xml atrib returns the XML minus root as expected&quot;&quot;&quot;
        self.assertEqual(
            self.target_xml,
            self.cdl.xml
        )

    #==========================================================================

    def test_element(self):
        &quot;&quot;&quot;Tests that the element returned is an etree type&quot;&quot;&quot;
        self.assertEqual(
            'ColorDecisionList',
            self.cdl.element.tag
        )

    #==========================================================================

    def test_write(self):
        &quot;&quot;&quot;Tests writing the cdl itself&quot;&quot;&quot;
        mockOpen = mock.mock_open()

        self.cdl._file_out = 'bobs_big_file.cdl'

        with mock.patch(builtins + '.open', mockOpen, create=True):
            cdl_convert.write_cdl(self.cdl)

        mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')

        mockOpen().write.assert_called_once_with(self.target_xml_root)


class TestWriteCDLFullAsCCC(TestWriteCDLFull):
    &quot;&quot;&quot;Tests an write of the CDL file as a CCC file

    This is an integration style test. If parse_cdl stops working, this stops
    working.

    &quot;&quot;&quot;
    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
<A NAME="8"></A>        cdl_convert.reset_all(</B></FONT>)

        # Build our ccc
        <FONT color="#c58917"><A HREF="javascript:ZweiFrames('match2-1.html#8',3,'match2-top.html#8',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CDL_FULL))
            self.filename = f.name

        self.cdl = cdl_convert.parse_cdl(self.filename)
        self.cdl.</B></FONT>set_to_ccc()

        self.target_xml_root = enc(CDL_FULL_WRITE_CCC)
        self.target_xml = enc('\n'.join(CDL_FULL_WRITE_CCC.split('\n')[1:]))

    #==========================================================================

    def test_element(self):
        &quot;&quot;&quot;Tests that the element returned is an etree type&quot;&quot;&quot;
        self.assertEqual(
            'ColorCorrectionCollection',
            self.cdl.element.tag
        )

    #==========================================================================

    def test_write(self):
        &quot;&quot;&quot;Tests writing the cdl itself&quot;&quot;&quot;
        mockOpen = mock.mock_open()

        self.cdl._file_out = 'bobs_big_file.cdl'

        with mock.patch(builtins + '.open', mockOpen, create=True):
            cdl_convert.write_ccc(self.cdl)

        mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')

        mockOpen().write.assert_called_once_with(self.target_xml_root)


class TestWriteCDLOddAsCCC(TestWriteCDLFullAsCCC):
    &quot;&quot;&quot;Tests an write of the CDL file as a CCC file

    This is an integration style test. If parse_cdl stops working, this stops
    working.

    &quot;&quot;&quot;
    #==========================================================================
    # SETUP &amp; TEARDOWN
<A NAME="6"></A>    #==========================================================================

    def setUp(self):
        cdl_convert.reset_all<FONT color="#8c8774"><A HREF="javascript:ZweiFrames('match2-1.html#6',3,'match2-top.html#6',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>()

        # Build our ccc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CDL_ODD))
            self.filename = f.name

<A NAME="14"></A>        self.cdl = cdl_convert.parse_cdl(self.filename)
        self.cdl.</B></FONT>set_to_ccc()

        self<FONT color="#842dce"><A HREF="javascript:ZweiFrames('match2-1.html#14',3,'match2-top.html#14',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>.target_xml_root = enc(CDL_ODD_WRITE_CCC)
        self.target_xml = enc('\n'.join(CDL_ODD_WRITE_CCC.split('\n')[1:]))


class TestWriteCDLOdd(TestWriteCDLFull):
    &quot;&quot;&quot;Tests an odd write of the CDL file

    This is an integration style test. If parse_cdl stops working, this stops
    working.

    &quot;&quot;&quot;
    #==========================================================================
    # SETUP &amp; TEARDOWN
<A NAME="10"></A>    #==========================================================================

    def setUp(self):
        cdl_convert.</B></FONT>reset_all<FONT color="#ad5910"><A HREF="javascript:ZweiFrames('match2-1.html#10',3,'match2-top.html#10',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>()

        # Build our ccc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CDL_ODD))
            self.filename = f.name
<A NAME="13"></A>
        self.cdl = cdl_convert.parse_cdl(self.</B></FONT>filename)

        self<FONT color="#3b9c9c"><A HREF="javascript:ZweiFrames('match2-1.html#13',3,'match2-top.html#13',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>.target_xml_root = enc(CDL_ODD_WRITE)
        self.target_xml = enc('\n'.join(CDL_ODD_WRITE.split('\n')[1:]))

class TestWriteCDLOddReferenceFix(TestWriteCDLFull):
    &quot;&quot;&quot;Tests an odd write of the CDL file

    This is an integration style test. If parse_cdl stops working, this stops
    working.

    In this test, we'll create a ColorCorrection that matches the reference
    id.

    &quot;&quot;&quot;
    #==========================================================================
    # SETUP &amp; TEARDOWN
<A NAME="9"></A>    #==========================================================================

    def setUp(self):
        cdl_convert.</B></FONT>reset_all<FONT color="#83a33a"><A HREF="javascript:ZweiFrames('match2-1.html#9',3,'match2-top.html#9',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>()

        # Build our ccc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CDL_ODD))
            self.filename = f.name
<A NAME="12"></A>
        self.cdl = cdl_convert.parse_cdl(self.</B></FONT>filename)
        cc = cdl_convert.ColorCorrection(&quot;missingRef&quot;)
        cc<FONT color="#571b7e"><A HREF="javascript:ZweiFrames('match2-1.html#12',3,'match2-top.html#12',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>.slope = [1.0, 2.0, 1.0]

        self.target_xml_root = enc(CDL_ODD_WRITE_RESOLVED)
        self.target_xml = enc('\n'.join(CDL_ODD_WRITE_RESOLVED.split('\n')[1:]))

    #==========================================================================

    def</B></FONT> testMissingRef(self):
        &quot;&quot;&quot;Tests what happens with a missing ref and HALT&quot;&quot;&quot;
        cdl_convert.config.HALT_ON_ERROR = True

        # We shouldn't stop just because a ref is missing
        mockOpen = mock.mock_open()

        self.cdl._file_out = 'bobs_big_file.cdl'

        with mock.patch(builtins + '.open', mockOpen, create=True):
            cdl_convert.write_cdl(self.cdl)

        mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')

        mockOpen().write.assert_called_once_with(self.target_xml_root)

        cdl_convert.config.HALT_ON_ERROR = False

#==============================================================================
# RUNNER
#==============================================================================
if __name__ == '__main__':
    unittest.main()
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_cc.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
#!/usr/bin/env python
&quot;&quot;&quot;
Tests the cc related functions of cdl_convert

REQUIREMENTS:

mock
&quot;&quot;&quot;

#==============================================================================
# IMPORTS
#==============================================================================
<A NAME="3"></A>
# Standard Imports
from decimal import Decimal
<FONT color="#53858b"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#3',2,'match2-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>try:
    from unittest import mock
except ImportError:
    import mock
import os
import sys
import tempfile
import unittest
from xml.etree import ElementTree

# Grab our test's path and append the cdL_convert root directory

# There has to be a better method than:
# 1) Getting our current directory
# 2) Splitting into list
# 3) Splicing out the last 3 entries (filepath, test dir, tools dir)
# 4) Joining
# 5) Appending to our Python path.

sys.path.append('/'.join(os.path.realpath(__file__).split('/')[:-2]))

import cdl_convert

#==============================================================================
# GLOBALS
#==============================================================================

# We'll save out different and broken XMLs by hand.

# Parse XMLs ==================================================================

# Valid XMLs ==================================================================

CC_FULL = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
    &lt;Description&gt;CC description 1&lt;/Description&gt;
    &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
    &lt;Description&gt;CC description 2&lt;/Description&gt;
    &lt;SOPNode&gt;
        &lt;Description&gt;Sop description 1&lt;/Description&gt;
        &lt;Description&gt;Sop description 2&lt;/Description&gt;
        &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
        &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
        &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
        &lt;Description&gt;Sop description 3&lt;/Description&gt;
    &lt;/SOPNode&gt;
    &lt;Description&gt;CC description 3&lt;/Description&gt;
    &lt;SATNode&gt;
        &lt;Description&gt;Sat description 1&lt;/Description&gt;
        &lt;Saturation&gt;1.09&lt;/Saturation&gt;
        &lt;Description&gt;Sat description 2&lt;/Description&gt;
    &lt;/SATNode&gt;
    &lt;Description&gt;CC description 4&lt;/Description&gt;
    &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
    &lt;Description&gt;CC description 5&lt;/Description&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_BASIC = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;f51.200&quot;&gt;
    &lt;SopNode&gt;
        &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
        &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
        &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
    &lt;/SopNode&gt;
    &lt;SatNode&gt;
        &lt;Saturation&gt;1.01&lt;/Saturation&gt;
    &lt;/SatNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

# The following characters don't seem to be allowed in id fields:
CC_ODD = r&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;f55.100\\\\\//////&quot;&gt;
    &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
    &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
    &lt;SopNode&gt;
        &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
        &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
        &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
        &lt;Power&gt;3271893.993 .0000998 0.0000000000000000113&lt;/Power&gt;
    &lt;/SopNode&gt;
    &lt;SatNode&gt;
        &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
    &lt;/SatNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_BASIC_ORDER = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;f54.112&quot;&gt;
    &lt;ASC_SAT&gt;
        &lt;Saturation&gt;1.01&lt;/Saturation&gt;
    &lt;/ASC_SAT&gt;
    &lt;ASC_SOP&gt;
        &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
        &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
        &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
    &lt;/ASC_SOP&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_BLANK_METADATA = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;burp_100.x12&quot;&gt;
    &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
    &lt;Description&gt;&lt;/Description&gt;
    &lt;SOPNode&gt;
        &lt;Description&gt;&lt;/Description&gt;
        &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
        &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
        &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
    &lt;/SOPNode&gt;
    &lt;Description&gt;&lt;/Description&gt;
    &lt;InputDescription&gt;&lt;/InputDescription&gt;
    &lt;SatNode&gt;
        &lt;Saturation&gt;1.09&lt;/Saturation&gt;
        &lt;Description&gt;&lt;/Description&gt;
    &lt;/SatNode&gt;
    &lt;Description&gt;&lt;/Description&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_NO_SOP = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;burp_200.x15&quot;&gt;
    &lt;SatNode&gt;
        &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
        &lt;Saturation&gt;1.01&lt;/Saturation&gt;
    &lt;/SatNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_NO_SAT = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;burp_300.x35&quot;&gt;
    &lt;SopNode&gt;
        &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
        &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
        &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
    &lt;/SopNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

# Bad XMLs ====================================================================

CC_NO_ID = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection&gt;
    &lt;SopNode&gt;
        &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
        &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
        &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
    &lt;/SopNode&gt;
    &lt;SatNode&gt;
        &lt;Saturation&gt;1.01&lt;/Saturation&gt;
    &lt;/SatNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_BLANK_ID = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;&quot;&gt;
    &lt;SopNode&gt;
        &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
        &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
        &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
    &lt;/SopNode&gt;
    &lt;SatNode&gt;
        &lt;Saturation&gt;1.01&lt;/Saturation&gt;
    &lt;/SatNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_NEGATIVE_SLOPE =</B></FONT> &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;dsds&quot;&gt;
    &lt;SopNode&gt;
        &lt;Slope&gt;-0.2331 0.678669 1.0758&lt;/Slope&gt;
        &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
        &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
    &lt;/SopNode&gt;
    &lt;SatNode&gt;
        &lt;Saturation&gt;1.01&lt;/Saturation&gt;
    &lt;/SatNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

# Write XMLs ==================================================================

CC_FULL_WRITE = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;014_xf_seqGrade_v01&quot;&gt;
    &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
    &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
    &lt;Description&gt;CC description 1&lt;/Description&gt;
    &lt;Description&gt;CC description 2&lt;/Description&gt;
    &lt;Description&gt;CC description 3&lt;/Description&gt;
    &lt;Description&gt;CC description 4&lt;/Description&gt;
    &lt;Description&gt;CC description 5&lt;/Description&gt;
    &lt;SOPNode&gt;
        &lt;Description&gt;Sop description 1&lt;/Description&gt;
        &lt;Description&gt;Sop description 2&lt;/Description&gt;
        &lt;Description&gt;Sop description 3&lt;/Description&gt;
        &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
        &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
        &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
    &lt;/SOPNode&gt;
    &lt;SATNode&gt;
        &lt;Description&gt;Sat description 1&lt;/Description&gt;
        &lt;Description&gt;Sat description 2&lt;/Description&gt;
        &lt;Saturation&gt;1.09&lt;/Saturation&gt;
    &lt;/SATNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

# The following characters don't seem to be allowed in id fields:
CC_ODD_WRITE = r&quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;f55.100&quot;&gt;
    &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
    &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
    &lt;Description&gt;Raised saturation1 a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;Description&gt;Raised saturation2 a little!?! ag... \/Offset&lt;/Description&gt;
    &lt;SOPNode&gt;
        &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
        &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
        &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
        &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
    &lt;/SOPNode&gt;
    &lt;SATNode&gt;
        &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
    &lt;/SATNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_NO_SOP_WRITE = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;burp_200.x15&quot;&gt;
    &lt;SATNode&gt;
        &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
        &lt;Saturation&gt;1.0128109381&lt;/Saturation&gt;
    &lt;/SATNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

CC_NO_SAT_WRITE = &quot;&quot;&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ColorCorrection id=&quot;burp_300.x35&quot;&gt;
    &lt;SOPNode&gt;
        &lt;Slope&gt;1.233321 0.678669 1.0758&lt;/Slope&gt;
        &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
        &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
    &lt;/SOPNode&gt;
&lt;/ColorCorrection&gt;
&quot;&quot;&quot;

# misc ========================================================================

<A NAME="5"></A>UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
LOWER = 'abcdefghijklmnopqrstuvwxyz'

<FONT color="#151b8d"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#5',2,'match2-top.html#5',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>if sys.version_info[0] &gt;= 3:
    enc = lambda x: bytes(x, 'UTF-8')
else:
    enc = lambda x: x

if sys.version_info[0] &gt;= 3:
    builtins = 'builtins'
else:
    builtins = '__builtin__'

#==============================================================================
# TEST CLASSES
#==============================================================================

# parse_cc ====================================================================


class TestParseCCBasic(unittest.TestCase):
    &quot;&quot;&quot;Tests parsing a cc xml&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.id = &quot;014_xf_seqGrade_v01&quot;
        self.</B></FONT>desc = [
            'CC description 1', 'CC description 2', 'CC description 3',
            'CC description 4', 'CC description 5'
        ]
        self.input_desc = 'Input Desc Text'
        self.viewing_desc = 'Viewing Desc Text'

        self.sop_node_desc = [
            'Sop description 1', 'Sop description 2', 'Sop description 3'
        ]
        self.slope = decimalize(1.014, 1.0104, 0.62)
        self.offset = decimalize(-0.00315, -0.00124, 0.3103)
        self.power = decimalize(1.0, 0.9983, 1.0)
        self.sat_node_desc = [
            'Sat description 1', 'Sat description 2'
        ]
<A NAME="2"></A>        self.sat = Decimal('1.09')

        # Build our cc
        <FONT color="#980517"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#2',2,'match2-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_FULL))
            self.filename = f.name

        self.cdl = cdl_convert.parse_cc(self.filename)

    #==========================================================================

    def tearDown(self):
        # The system should clean these up automatically,
        # but we'll be neat.
        os.remove(self.filename)
        # We need to clear the ColorCorrection member dictionary so we don't
        # have to worry about non-unique ids.
        cdl_convert.reset_all()

    #==========================================================================
    # TESTS
    #==========================================================================

    def testId(self):
        &quot;&quot;&quot;Tests that id was set to id attrib&quot;&quot;&quot;
        self.assertEqual(
            self.id,
            self.cdl.id
        )

    #==========================================================================

    def testDesc(self):
        &quot;&quot;&quot;Tests that desc was set to desc element&quot;&quot;&quot;
        self.assertEqual(
            self.desc,
            self.</B></FONT>cdl.desc
        )

    #==========================================================================

    def testInputDesc(self):
        &quot;&quot;&quot;Tests that input description was set&quot;&quot;&quot;
        self.assertEqual(
            self.input_desc,
            self.cdl.input_desc
        )

    #==========================================================================

    def testViewingDesc(self):
        &quot;&quot;&quot;Tests that viewing description was set&quot;&quot;&quot;
        self.assertEqual(
            self.viewing_desc,
            self.cdl.viewing_desc
        )

    #==========================================================================

    def testSopDesc(self):
        &quot;&quot;&quot;Tests that desc was set to sop node's desc element&quot;&quot;&quot;
        self.assertEqual(
            self.sop_node_desc,
            self.cdl.sop_node.desc
        )

    #==========================================================================

    def testSatDesc(self):
<A NAME="4"></A>        &quot;&quot;&quot;Tests that desc was set to sat node's desc element&quot;&quot;&quot;
        self.assertEqual(
            self.sat_node_desc,
            self.cdl.sat_node.<FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#4',2,'match2-top.html#4',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>desc
        )

    #==========================================================================

    def testSlope(self):
        &quot;&quot;&quot;Tests that slope was set correctly&quot;&quot;&quot;
        self.assertEqual(
            self.slope,
            self.cdl.slope
        )

    #==========================================================================

    def testOffset(self):
        &quot;&quot;&quot;Tests that offset was set correctly&quot;&quot;&quot;
        self.assertEqual(
            self.offset,
            self.cdl.offset
        )

    #==========================================================================

    def testPower(self):
        &quot;&quot;&quot;Tests that power was set correctly&quot;&quot;&quot;
        self.assertEqual(
            self.power,
            self.cdl.power
        )

    #==========================================================================

    def</B></FONT> testSat(self):
        &quot;&quot;&quot;Tests that sat was set correctly&quot;&quot;&quot;
        self.assertEqual(
            self.sat,
            self.cdl.sat
        )

#==============================================================================


class TestParseCCOdd(TestParseCCBasic):
    &quot;&quot;&quot;Tests parsing a cc xml with odd values&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.id = &quot;f55.100&quot;  # This will have been _sanitized()
        self.desc = [
            'Raised saturation a little!?! ag... \/Offset',
            'Raised saturation a little!?! ag... \/Offset',
        ]
        self.input_desc = 'METAL VIEWER!!! \/\/'
        self.viewing_desc = 'WOOD VIEWER!? ////'

        self.sop_node_desc = [
            'Raised saturation a little!?! ag... \/Offset'
        ]
        self.slope = decimalize(137829.329, 4327890.9833, 3489031.003)
        self.offset = decimalize(-3424.011, -342789423.013, -4238923.11)
        self.power = decimalize(3271893.993, .0000998, 0.0000000000000000113)
        self.sat_node_desc = []
<A NAME="7"></A>        self.sat = Decimal('1798787.01')

        # Build our cc
        <FONT color="#38a4a5"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#7',2,'match2-top.html#7',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_ODD))
            self.filename = f.name

        self.cdl = cdl_convert.parse_cc(self.filename)

#==============================================================================


class</B></FONT> TestParseCCBasic(TestParseCCBasic):
    &quot;&quot;&quot;Tests parsing a cc xml with minimal values&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.id = &quot;f51.200&quot;
        self.desc = []
        self.input_desc = None
        self.viewing_desc = None

        self.sop_node_desc = []
        self.slope = decimalize(0.2331, 0.678669, 1.0758)
<A NAME="10"></A>        self.offset = decimalize(0.031, 0.128, -0.096)
        self.power = decimalize(1.8, 0.97, 0.961)
        self.sat_node_desc = []
        self.sat = Decimal<FONT color="#ad5910"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#10',2,'match2-top.html#10',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>('1.01')

        # Build our cc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_BASIC))
            self.filename = f.name

        self.cdl = cdl_convert.parse_cc(self.</B></FONT>filename)

#==============================================================================


class TestParseCCBasicOrder(TestParseCCBasic):
    &quot;&quot;&quot;Tests parsing a cc xml with minimal, but out of order values&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.id = &quot;f54.112&quot;
        self.desc = []
        self.input_desc = None
        self.viewing_desc = None

        self.sop_node_desc = []
        self.slope = decimalize(0.2331, 0.678669, 1.0758)
<A NAME="9"></A>        self.offset = decimalize(0.031, 0.128, -0.096)
        self.power = decimalize(1.8, 0.97, 0.961)
        self.sat_node_desc = []
        self.sat = Decimal<FONT color="#83a33a"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#9',2,'match2-top.html#9',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>('1.01')

        # Build our cc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_BASIC_ORDER))
            self.filename = f.name

        self.cdl = cdl_convert.parse_cc(self.</B></FONT>filename)

#==============================================================================


class TestParseCCBlankMetadata(TestParseCCBasic):
    &quot;&quot;&quot;Tests parsing a cc xml with blank metadata fields&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.id = &quot;burp_100.x12&quot;
        self.desc = []
        self.input_desc = None
        self.viewing_desc = None

        self.sop_node_desc = []
        self.slope = decimalize(1.014, 1.0104, 0.62)
        self.offset = decimalize(-0.00315, -0.00124, 0.3103)
        self.power = decimalize(1.0, 0.9983, 1.0)
        self.sat_node_desc = []
<A NAME="11"></A>        self.sat = Decimal('1.09')

        # Build our cc
        <FONT color="#b041ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#11',2,'match2-top.html#11',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_BLANK_METADATA))
            self.filename = f.name

        self.cdl = cdl_convert.parse_cc(self.</B></FONT>filename)

#==============================================================================


class TestParseCCNoSop(TestParseCCBasic):
    &quot;&quot;&quot;Tests parsing a cc xml with no SOP data&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.id = &quot;burp_200.x15&quot;
        self.desc = []
        self.input_desc = None
        self.viewing_desc = None

        self.sop_node_desc = []
        self.slope = decimalize(1.0, 1.0, 1.0)
<A NAME="6"></A>        self.offset = decimalize(0.0, 0.0, 0.0)
        self.power = decimalize(1.0, 1.0, 1.0)
        self.sat_node_desc = ['I am a lovely sat node']
        self.sat = Decimal<FONT color="#8c8774"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#6',2,'match2-top.html#6',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>('1.01')

        # Build our cc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_NO_SOP))
            self.filename = f.name

        self.cdl = cdl_convert.parse_cc(self.filename)

        # We need to call a SOP value to initialize the SOP subnode
        self.cdl.</B></FONT>slope

#==============================================================================


class TestParseCCNoSat(TestParseCCBasic):
    &quot;&quot;&quot;Tests parsing a cc xml with no sat data&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.id = &quot;burp_300.x35&quot;
        self.desc = []
        self.input_desc = None
        self.viewing_desc = None

        self.sop_node_desc = []
        self.slope = decimalize(0.2331, 0.678669, 1.0758)
        self.offset = decimalize(0.031, 0.128, -0.096)
        self.power = decimalize(1.8, 0.97, 0.961)
        self.sat_node_desc = []
<A NAME="8"></A>        self.sat = Decimal('1.0')

        # Build our cc
        <FONT color="#c58917"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#8',2,'match2-top.html#8',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_NO_SAT))
            self.filename = f.name

        self.cdl = cdl_convert.parse_cc(self.filename)

        # We need to call a SAT value to initialize the SAT subnode
        self.cdl.</B></FONT>sat

#==============================================================================


class TestParseCCExceptions(unittest.TestCase):
    &quot;&quot;&quot;Tests parse_cc's response to some bad xml files&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        self.file = None

    #==========================================================================

    def tearDown(self):
        cdl_convert.reset_all()
        if self.file:
            os.remove(self.file)

    #==========================================================================
    # TESTS
    #==========================================================================

    def testNoId(self):
        &quot;&quot;&quot;Tests that not finding an id attrib works&quot;&quot;&quot;

        # Build our cc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_NO_ID))
            self.file = f.name

<A NAME="1"></A>        cc = cdl_convert.parse_cc(self.file)
        self.assertEqual(
            '001',
            cc<FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#1',2,'match2-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>.id
        )

    #==========================================================================

    def testNotColorCorrection(self):
        &quot;&quot;&quot;Tests that an XML with a root tag that's not ColorCorrection&quot;&quot;&quot;
        xml = &quot;&lt;ColorBlurection&gt;\n&lt;/ColorBlurection&gt;\n&quot;


        # Build our cc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(xml))
            self.file = f.name

        self.assertRaises(
            ValueError,
            cdl_convert.parse_cc,
            self.file
        )

    #==========================================================================

    def testEmptyColorCorrection(self):
        &quot;&quot;&quot;Tests that an empty XML raises ValueError&quot;&quot;&quot;
        xml = '&lt;ColorCorrection id=&quot;hdjshd&quot;&gt;\n&lt;/ColorCorrection&gt;\n'

        # Build our cc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(xml))
            self.file = f.name

        self.assertRaises(
            ValueError,
            cdl_convert.parse_cc,
            self.</B></FONT>file
        )

    #==========================================================================

    def testBlankId(self):
        &quot;&quot;&quot;Tests that a blank id field ValueError&quot;&quot;&quot;

        # Build our cc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_BLANK_ID))
            self.file = f.name

        cdl_convert.config.HALT_ON_ERROR = True

        self.assertRaises(
            ValueError,
            cdl_convert.parse_cc,
            self.file
        )

        cdl_convert.config.HALT_ON_ERROR = False

        cdl = cdl_convert.parse_cc(self.file)
<A NAME="15"></A>
        self.assertEqual(
            '001',
            cdl.<FONT color="#f52887"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#15',2,'match2-top.html#15',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>id
        )

    #==========================================================================

    def testNegativeSlope(self):
        &quot;&quot;&quot;Tests that a negative slope raises a ValueError&quot;&quot;&quot;

        # Build our cc
        with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
            f.write(enc(CC_NEGATIVE_SLOPE))
            self.file = f.name

        cdl_convert.</B></FONT>config.HALT_ON_ERROR = True

        self.assertRaises(
            ValueError,
            cdl_convert.parse_cc,
            self.file
        )

        cdl_convert.config.HALT_ON_ERROR = False
        cdl_convert.reset_all()

        cdl = cdl_convert.parse_cc(self.file)

        self.assertEqual(
            decimalize(0.0, 0.678669, 1.0758),
            cdl.slope,
        )

# write_cc ====================================================================


class TestWriteCCFull(unittest.TestCase):
    &quot;&quot;&quot;Tests full writing of CC XML&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        cdl_convert.reset_all()
        self.cdl = cdl_convert.ColorCorrection(&quot;014_xf_seqGrade_v01&quot;, '')
        self.cdl.desc = [
            'CC description 1', 'CC description 2', 'CC description 3',
            'CC description 4', 'CC description 5'
        ]
        self.cdl.input_desc = 'Input Desc Text'
        self.cdl.viewing_desc = 'Viewing Desc Text'

        self.cdl.slope = (1.014, 1.0104, 0.62)
        self.cdl.offset = (-0.00315, -0.00124, 0.3103)
        self.cdl.power = (1.0, 0.9983, 1.0)
        self.cdl.sop_node.desc = [
            'Sop description 1', 'Sop description 2', 'Sop description 3'
<A NAME="12"></A>        ]

        self.cdl.sat = 1.09
        self.cdl.sat_node<FONT color="#571b7e"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#12',2,'match2-top.html#12',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>.desc = [
            'Sat description 1', 'Sat description 2'
        ]

        self.target_xml_root = enc(CC_FULL_WRITE)
        self.target_xml = enc('\n'.join(CC_FULL_WRITE.split('\n')[1:]))

<A NAME="0"></A>    #==========================================================================

    def</B></FONT> tearDown(self):
        cdl_convert<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#0',2,'match2-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>.reset_all()

    #==========================================================================
    # TESTS
    #==========================================================================

    def test_root_xml(self):
        &quot;&quot;&quot;Tests that root_xml returns the full XML as expected&quot;&quot;&quot;
        self.assertEqual(
            self.target_xml_root,
            self.cdl.xml_root
        )

    #==========================================================================

    def test_base_xml(self):
        &quot;&quot;&quot;Tests that the xml atrib returns the XML minus root as expected&quot;&quot;&quot;
        self.assertEqual(
            self.target_xml,
            self.cdl.xml
        )

    #==========================================================================

    def test_element(self):
        &quot;&quot;&quot;Tests that the element returned is an etree type&quot;&quot;&quot;
        self.assertEqual(
            'ColorCorrection',
            self.cdl.element.tag
        )

    #==========================================================================

    def test_write(self):
        &quot;&quot;&quot;Tests writing the cc itself&quot;&quot;&quot;
        mockOpen = mock.mock_open()

        self.cdl._file_out = 'bobs_big_file.cc'

        with mock.patch(builtins + '.open', mockOpen, create=True):
            cdl_convert.write_cc(self.cdl)

        mockOpen.assert_called_once_with('bobs_big_file.cc', 'wb')

        mockOpen().write.assert_called_once_with(self.target_xml_root)


class TestWriteCCOdd(TestWriteCCFull):
    &quot;&quot;&quot;Tests odd writing of CC XML&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        cdl_convert.reset_all(</B></FONT>)
        self.cdl = cdl_convert.ColorCorrection(&quot;f55.100&quot;, '')
        self.cdl.desc = [
            'Raised saturation1 a little!?! ag... \/Offset',
            'Raised saturation2 a little!?! ag... \/Offset',
        ]
        self.cdl.input_desc = 'METAL VIEWER!!! \/\/'
        self.cdl.viewing_desc = 'WOOD VIEWER!? ////'
<A NAME="16"></A>
        self.cdl.slope = (137829.329, 4327890.9833, 3489031.003)
        self.cdl.offset = (-3424.011, -342789423.013, -4238923.11)
        self<FONT color="#2981b2"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#16',2,'match2-top.html#16',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>.cdl.power = (3271893.993, .0000998, 0.0000000000000000113)
        self.cdl.sop_node.desc = [
            'Raised saturation a little!?! ag... \/Offset'
        ]

<A NAME="14"></A>        self.cdl.sat = 1798787.01
        self.cdl.</B></FONT>sat_node.desc = []

        self<FONT color="#842dce"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#14',2,'match2-top.html#14',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>.target_xml_root = enc(CC_ODD_WRITE)
        self.target_xml = enc('\n'.join(CC_ODD_WRITE.split('\n')[1:]))


class TestWriteCCNoSop(TestWriteCCFull):
    &quot;&quot;&quot;Tests writing a CC XML with no SOP node&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        cdl_convert.</B></FONT>reset_all()
        self.cdl = cdl_convert.ColorCorrection(&quot;burp_200.x15&quot;, '')

<A NAME="13"></A>        self.cdl.sat = 1.0128109381
        self.cdl.sat_node.desc = ['I am a lovely sat node']

        self<FONT color="#3b9c9c"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#13',2,'match2-top.html#13',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>.target_xml_root = enc(CC_NO_SOP_WRITE)
        self.target_xml = enc('\n'.join(CC_NO_SOP_WRITE.split('\n')[1:]))


class TestWriteCCNoSat(TestWriteCCFull):
    &quot;&quot;&quot;Tests writing a CC XML with no SAT node&quot;&quot;&quot;

    #==========================================================================
    # SETUP &amp; TEARDOWN
    #==========================================================================

    def setUp(self):
        cdl_convert.</B></FONT>reset_all()
        self.cdl = cdl_convert.ColorCorrection(&quot;burp_300.x35&quot;, '')

        self.cdl.slope = (1.233321, 0.678669, 1.0758)
<A NAME="17"></A>        self.cdl.offset = (0.031, 0.128, -0.096)
        self.cdl.power = (1.8, 0.97, 0.961)

        self<FONT color="#3090c7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#17',2,'match2-top.html#17',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>.target_xml_root = enc(CC_NO_SAT_WRITE)
        self.target_xml = enc('\n'.join(CC_NO_SAT_WRITE.split('\n')[</B></FONT>1:]))

#==============================================================================
# FUNCTIONS
#==============================================================================


def decimalize(*args):
    &quot;&quot;&quot;Converts a list of floats/ints to Decimal list&quot;&quot;&quot;
    return tuple([Decimal(str(i)) for i in args])

#==============================================================================
# RUNNER
#==============================================================================
if __name__ == '__main__':
    unittest.main()
</PRE>
</div>
  </div>
</body>
</html>
