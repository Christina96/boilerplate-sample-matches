<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_cdl.py &amp; test_cc.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_cdl.py &amp; test_cc.py
      </h3>
<h1 align="center">
        56.4%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_cdl.py (66.61184%)<th>test_cc.py (48.913044%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(1033-1092)<td><a href="#" name="0">(779-834)</a><td align="center"><font color="#ff0000">52</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(961-1004)<td><a href="#" name="1">(648-683)</a><td align="center"><font color="#c40000">40</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(719-752)<td><a href="#" name="2">(314-347)</a><td align="center"><font color="#b50000">37</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(15-629)<td><a href="#" name="3">(16-186)</a><td align="center"><font color="#9c0000">32</font>
<tr onclick='openModal("#6cc417")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#6cc417"><font color="#6cc417">-</font><td><a href="#" name="4">(752-784)<td><a href="#" name="4">(383-415)</a><td align="center"><font color="#700000">23</font>
<tr onclick='openModal("#151b8d")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#151b8d"><font color="#151b8d">-</font><td><a href="#" name="5">(631-655)<td><a href="#" name="5">(269-295)</a><td align="center"><font color="#660000">21</font>
<tr onclick='openModal("#8c8774")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#8c8774"><font color="#8c8774">-</font><td><a href="#" name="6">(1142-1150)<td><a href="#" name="6">(568-578)</a><td align="center"><font color="#620000">20</font>
<tr onclick='openModal("#38a4a5")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#38a4a5"><font color="#38a4a5">-</font><td><a href="#" name="7">(924-931)<td><a href="#" name="7">(451-460)</a><td align="center"><font color="#620000">20</font>
<tr onclick='openModal("#c58917")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#c58917"><font color="#c58917">-</font><td><a href="#" name="8">(1095-1100)<td><a href="#" name="8">(604-611)</a><td align="center"><font color="#5d0000">19</font>
<tr onclick='openModal("#83a33a")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#83a33a"><font color="#83a33a">-</font><td><a href="#" name="9">(1195-1202)<td><a href="#" name="9">(508-515)</a><td align="center"><font color="#580000">18</font>
<tr onclick='openModal("#ad5910")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#ad5910"><font color="#ad5910">-</font><td><a href="#" name="10">(1168-1175)<td><a href="#" name="10">(478-485)</a><td align="center"><font color="#580000">18</font>
<tr onclick='openModal("#b041ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#b041ff"><font color="#b041ff">-</font><td><a href="#" name="11">(1020-1024)<td><a href="#" name="11">(541-545)</a><td align="center"><font color="#530000">17</font>
<tr onclick='openModal("#571b7e")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#571b7e"><font color="#571b7e">-</font><td><a href="#" name="12">(1204-1211)<td><a href="#" name="12">(769-778)</a><td align="center"><font color="#4e0000">16</font>
<tr onclick='openModal("#3b9c9c")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#3b9c9c"><font color="#3b9c9c">-</font><td><a href="#" name="13">(1177-1195)<td><a href="#" name="13">(871-883)</a><td align="center"><font color="#4e0000">16</font>
<tr onclick='openModal("#842dce")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#842dce"><font color="#842dce">-</font><td><a href="#" name="14">(1152-1168)<td><a href="#" name="14">(853-865)</a><td align="center"><font color="#4e0000">16</font>
<tr onclick='openModal("#f52887")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f52887"><font color="#f52887">-</font><td><a href="#" name="15">(944-958)<td><a href="#" name="15">(710-723)</a><td align="center"><font color="#490000">15</font>
<tr onclick='openModal("#2981b2")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#2981b2"><font color="#2981b2">-</font><td><a href="#" name="16">(673-708)<td><a href="#" name="16">(845-851)</a><td align="center"><font color="#3f0000">13</font>
<tr onclick='openModal("#3090c7")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#3090c7"><font color="#3090c7">-</font><td><a href="#" name="17">(1026-1027)<td><a href="#" name="17">(890-891)</a><td align="center"><font color="#3a0000">12</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_cdl.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>try:
2     from unittest import mock
3 except ImportError:
4     import mock
5 import os
6 import sys
7 import tempfile
8 import unittest
9 from xml.etree import ElementTree
10 sys.path.append('/'.join(os.path.realpath(__file__).split('/')[:-2]))
11 import cdl_convert
12 CDL_FULL = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
13 &lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;
14     &lt;Description&gt;CDL description 1&lt;/Description&gt;
15     &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
16     &lt;Description&gt;CDL description 2&lt;/Description&gt;
17     &lt;ColorDecision&gt;
18         &lt;Description&gt;CD description 1&lt;/Description&gt;
19         &lt;InputDescription&gt;CD Input Desc Text&lt;/InputDescription&gt;
20         &lt;Description&gt;CD description 2&lt;/Description&gt;
21         &lt;MediaRef ref="/best/path/ever.dpx"/&gt;
22         &lt;Description&gt;CD description 3&lt;/Description&gt;
23         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
24             &lt;Description&gt;CC description 1&lt;/Description&gt;
25             &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
26             &lt;Description&gt;CC description 2&lt;/Description&gt;
27             &lt;SOPNode&gt;
28                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
29                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
30                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
31                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
32                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
33                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
34             &lt;/SOPNode&gt;
35             &lt;Description&gt;CC description 3&lt;/Description&gt;
36             &lt;SATNode&gt;
37                 &lt;Description&gt;Sat description 1&lt;/Description&gt;
38                 &lt;Saturation&gt;1.09&lt;/Saturation&gt;
39                 &lt;Description&gt;Sat description 2&lt;/Description&gt;
40             &lt;/SATNode&gt;
41             &lt;Description&gt;CC description 4&lt;/Description&gt;
42             &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
43             &lt;Description&gt;CC description 5&lt;/Description&gt;
44         &lt;/ColorCorrection&gt;
45         &lt;ViewingDescription&gt;CD WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
46     &lt;/ColorDecision&gt;
47     &lt;ColorDecision&gt;
48         &lt;ColorCorrection id="f51.200"&gt;
49             &lt;SopNode&gt;
50                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
51                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
52                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
53             &lt;/SopNode&gt;
54             &lt;SatNode&gt;
55                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
56             &lt;/SatNode&gt;
57         &lt;/ColorCorrection&gt;
58     &lt;/ColorDecision&gt;
59     &lt;ColorDecision&gt;
60         &lt;MediaRef ref="relative/path/13.jpg"/&gt;
61         &lt;ColorCorrectionRef ref="f51.200"/&gt;
62     &lt;/ColorDecision&gt;
63     &lt;ColorDecision&gt;
64         &lt;ColorCorrection id="f55.100"&gt;
65             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
66             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
67             &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
68             &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
69             &lt;SopNode&gt;
70                 &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
71                 &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
72                 &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
73                 &lt;Power&gt;3271893.993 .0000998 0.0000000000000000113&lt;/Power&gt;
74             &lt;/SopNode&gt;
75             &lt;SatNode&gt;
76                 &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
77             &lt;/SatNode&gt;
78         &lt;/ColorCorrection&gt;
79     &lt;/ColorDecision&gt;
80     &lt;ColorDecision&gt;
81         &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
82         &lt;Description&gt;&lt;/Description&gt;
83         &lt;Description&gt;CD description 1&lt;/Description&gt;
84         &lt;ColorCorrection id="f54.112"&gt;
85             &lt;ASC_SAT&gt;
86                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
87             &lt;/ASC_SAT&gt;
88             &lt;ASC_SOP&gt;
89                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
90                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
91                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
92             &lt;/ASC_SOP&gt;
93         &lt;/ColorCorrection&gt;
94         &lt;Description&gt;CD description 2&lt;/Description&gt;
95         &lt;InputDescription&gt;CD Input Desc Text 2&lt;/InputDescription&gt;
96     &lt;/ColorDecision&gt;
97     &lt;Description&gt;CDL description 3&lt;/Description&gt;
98     &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
99     &lt;Description&gt;CDL description 4&lt;/Description&gt;
100     &lt;ColorDecision&gt;
101         &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
102         &lt;ColorCorrection id="burp_100.x12"&gt;
103             &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
104             &lt;Description&gt;&lt;/Description&gt;
105             &lt;SOPNode&gt;
106                 &lt;Description&gt;&lt;/Description&gt;
107                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
108                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
109                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
110             &lt;/SOPNode&gt;
111             &lt;Description&gt;&lt;/Description&gt;
112             &lt;InputDescription&gt;&lt;/InputDescription&gt;
113             &lt;SatNode&gt;
114                 &lt;Saturation&gt;1.09&lt;/Saturation&gt;
115                 &lt;Description&gt;&lt;/Description&gt;
116             &lt;/SatNode&gt;
117             &lt;Description&gt;&lt;/Description&gt;
118         &lt;/ColorCorrection&gt;
119     &lt;/ColorDecision&gt;
120     &lt;ColorDecision&gt;
121         &lt;ViewingDescription&gt;12345&lt;/ViewingDescription&gt;
122         &lt;ColorCorrectionRef ref="f54.112"/&gt;
123     &lt;/ColorDecision&gt;
124     &lt;Description&gt;CDL description 5&lt;/Description&gt;
125 &lt;/ColorDecisionList&gt;
126 """
127 CDL_ODD = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
128 &lt;ColorDecisionList&gt;
129     &lt;Description&gt;&lt;/Description&gt;
130     &lt;InputDescription&gt;&lt;/InputDescription&gt;
131     &lt;Description&gt;CDL description 1&lt;/Description&gt;
132     &lt;Description&gt;&lt;/Description&gt;
133     &lt;Description&gt;&lt;/Description&gt;
134     &lt;Description&gt;&lt;/Description&gt;
135     &lt;ColorDecision&gt;
136         &lt;MediaRef ref="C:\\Windows\File\Path"/&gt;
137         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
138             &lt;SOPNode&gt;
139                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
140                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
141                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
142                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
143                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
144                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
145             &lt;/SOPNode&gt;
146         &lt;/ColorCorrection&gt;
147     &lt;/ColorDecision&gt;
148     &lt;ColorDecision&gt;
149         &lt;ColorCorrection id="f51.200"&gt;
150             &lt;SopNode&gt;
151                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
152                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
153                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
154             &lt;/SopNode&gt;
155         &lt;/ColorCorrection&gt;
156         &lt;MediaRef ref="relative\windows\path"/&gt;
157     &lt;/ColorDecision&gt;
158     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
159     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
160     &lt;ColorDecision&gt;
161         &lt;Description&gt;&lt;/Description&gt;
162         &lt;InputDescription&gt;&lt;/InputDescription&gt;
163         &lt;Description&gt;CD description 1&lt;/Description&gt;
164         &lt;Description&gt;&lt;/Description&gt;
165         &lt;Description&gt;&lt;/Description&gt;
166         &lt;Description&gt;&lt;/Description&gt;
167         &lt;ColorCorrectionRef ref="014_xf_seqGrade_v01"/&gt;
168         &lt;MediaRef ref="./sameDirectory/loser.####.fbx"/&gt;
169     &lt;/ColorDecision&gt;
170     &lt;ColorDecision&gt;
171         &lt;MediaRef ref="../lateralDirectory/file.lives.here.0120.dpx"/&gt;
172         &lt;ColorCorrectionRef ref="missingRef"/&gt;
173     &lt;/ColorDecision&gt;
174     &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
175     &lt;ColorDecision&gt;
176         &lt;MediaRef ref="http://www.google.com/logo.jpg"/&gt;
177         &lt;ColorCorrectionRef ref="alsoMissingRef"/&gt;
178     &lt;/ColorDecision&gt;
179     &lt;ColorDecision&gt;
180         &lt;MediaRef ref="serv://proto/uri:area:full?query=result#fragment"/&gt;
181         &lt;ColorCorrection id="burp_200.x15"&gt;
182             &lt;SatNode&gt;
183                 &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
184                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
185             &lt;/SatNode&gt;
186         &lt;/ColorCorrection&gt;
187     &lt;/ColorDecision&gt;
188     &lt;ColorDecision&gt;
189         &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
190         &lt;MediaRef ref="..\.\..\..\..\This\should\not\be\legal\"/&gt;
191         &lt;ColorCorrectionRef ref="f51.200"/&gt;
192     &lt;/ColorDecision&gt;
193 &lt;/ColorDecisionList&gt;
194 """
195 CDL_FULL_WRITE = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
196 &lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;
197     &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
198     &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
199     &lt;Description&gt;CDL description 1&lt;/Description&gt;
200     &lt;Description&gt;CDL description 2&lt;/Description&gt;
201     &lt;Description&gt;CDL description 3&lt;/Description&gt;
202     &lt;Description&gt;CDL description 4&lt;/Description&gt;
203     &lt;Description&gt;CDL description 5&lt;/Description&gt;
204     &lt;ColorDecision&gt;
205         &lt;InputDescription&gt;CD Input Desc Text&lt;/InputDescription&gt;
206         &lt;ViewingDescription&gt;CD WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
207         &lt;Description&gt;CD description 1&lt;/Description&gt;
208         &lt;Description&gt;CD description 2&lt;/Description&gt;
209         &lt;Description&gt;CD description 3&lt;/Description&gt;
210         &lt;MediaRef ref="/best/path/ever.dpx"/&gt;
211         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
212             &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
213             &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
214             &lt;Description&gt;CC description 1&lt;/Description&gt;
215             &lt;Description&gt;CC description 2&lt;/Description&gt;
216             &lt;Description&gt;CC description 3&lt;/Description&gt;
217             &lt;Description&gt;CC description 4&lt;/Description&gt;
218             &lt;Description&gt;CC description 5&lt;/Description&gt;
219             &lt;SOPNode&gt;
220                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
221                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
222                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
223                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
224                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
225                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
226             &lt;/SOPNode&gt;
227             &lt;SATNode&gt;
228                 &lt;Description&gt;Sat description 1&lt;/Description&gt;
229                 &lt;Description&gt;Sat description 2&lt;/Description&gt;
230                 &lt;Saturation&gt;1.09&lt;/Saturation&gt;
231             &lt;/SATNode&gt;
232         &lt;/ColorCorrection&gt;
233     &lt;/ColorDecision&gt;
234     &lt;ColorDecision&gt;
235         &lt;ColorCorrection id="f51.200"&gt;
236             &lt;SOPNode&gt;
237                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
238                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
239                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
240             &lt;/SOPNode&gt;
241             &lt;SATNode&gt;
242                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
243             &lt;/SATNode&gt;
244         &lt;/ColorCorrection&gt;
245     &lt;/ColorDecision&gt;
246     &lt;ColorDecision&gt;
247         &lt;MediaRef ref="relative/path/13.jpg"/&gt;
248         &lt;ColorCorrectionRef ref="f51.200"/&gt;
249     &lt;/ColorDecision&gt;
250     &lt;ColorDecision&gt;
251         &lt;ColorCorrection id="f55.100"&gt;
252             &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
253             &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
254             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
255             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
256             &lt;SOPNode&gt;
257                 &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
258                 &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
259                 &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
260                 &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
261             &lt;/SOPNode&gt;
262             &lt;SATNode&gt;
263                 &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
264             &lt;/SATNode&gt;
265         &lt;/ColorCorrection&gt;
266     &lt;/ColorDecision&gt;
267     &lt;ColorDecision&gt;
268         &lt;InputDescription&gt;CD Input Desc Text 2&lt;/InputDescription&gt;
269         &lt;Description&gt;CD description 1&lt;/Description&gt;
270         &lt;Description&gt;CD description 2&lt;/Description&gt;
271         &lt;ColorCorrection id="f54.112"&gt;
272             &lt;SOPNode&gt;
273                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
274                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
275                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
276             &lt;/SOPNode&gt;
277             &lt;SATNode&gt;
278                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
279             &lt;/SATNode&gt;
280         &lt;/ColorCorrection&gt;
281     &lt;/ColorDecision&gt;
282     &lt;ColorDecision&gt;
283         &lt;ColorCorrection id="burp_100.x12"&gt;
284             &lt;SOPNode&gt;
285                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
286                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
287                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
288             &lt;/SOPNode&gt;
289             &lt;SATNode&gt;
290                 &lt;Saturation&gt;1.09&lt;/Saturation&gt;
291             &lt;/SATNode&gt;
292         &lt;/ColorCorrection&gt;
293     &lt;/ColorDecision&gt;
294     &lt;ColorDecision&gt;
295         &lt;ViewingDescription&gt;12345&lt;/ViewingDescription&gt;
296         &lt;ColorCorrectionRef ref="f54.112"/&gt;
297     &lt;/ColorDecision&gt;
298 &lt;/ColorDecisionList&gt;
299 """
300 CDL_FULL_WRITE_CCC = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
301 &lt;ColorCorrectionCollection xmlns="urn:ASC:CDL:v1.01"&gt;
302     &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
303     &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
304     &lt;Description&gt;CDL description 1&lt;/Description&gt;
305     &lt;Description&gt;CDL description 2&lt;/Description&gt;
306     &lt;Description&gt;CDL description 3&lt;/Description&gt;
307     &lt;Description&gt;CDL description 4&lt;/Description&gt;
308     &lt;Description&gt;CDL description 5&lt;/Description&gt;
309     &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
310         &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
311         &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
312         &lt;Description&gt;CC description 1&lt;/Description&gt;
313         &lt;Description&gt;CC description 2&lt;/Description&gt;
314         &lt;Description&gt;CC description 3&lt;/Description&gt;
315         &lt;Description&gt;CC description 4&lt;/Description&gt;
316         &lt;Description&gt;CC description 5&lt;/Description&gt;
317         &lt;SOPNode&gt;
318             &lt;Description&gt;Sop description 1&lt;/Description&gt;
319             &lt;Description&gt;Sop description 2&lt;/Description&gt;
320             &lt;Description&gt;Sop description 3&lt;/Description&gt;
321             &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
322             &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
323             &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
324         &lt;/SOPNode&gt;
325         &lt;SATNode&gt;
326             &lt;Description&gt;Sat description 1&lt;/Description&gt;
327             &lt;Description&gt;Sat description 2&lt;/Description&gt;
328             &lt;Saturation&gt;1.09&lt;/Saturation&gt;
329         &lt;/SATNode&gt;
330     &lt;/ColorCorrection&gt;
331     &lt;ColorCorrection id="f51.200"&gt;
332         &lt;SOPNode&gt;
333             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
334             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
335             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
336         &lt;/SOPNode&gt;
337         &lt;SATNode&gt;
338             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
339         &lt;/SATNode&gt;
340     &lt;/ColorCorrection&gt;
341     &lt;ColorCorrection id="f51.200"&gt;
342         &lt;SOPNode&gt;
343             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
344             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
345             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
346         &lt;/SOPNode&gt;
347         &lt;SATNode&gt;
348             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
349         &lt;/SATNode&gt;
350     &lt;/ColorCorrection&gt;
351     &lt;ColorCorrection id="f55.100"&gt;
352         &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
353         &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
354         &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
355         &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
356         &lt;SOPNode&gt;
357             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
358             &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
359             &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
360             &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
361         &lt;/SOPNode&gt;
362         &lt;SATNode&gt;
363             &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
364         &lt;/SATNode&gt;
365     &lt;/ColorCorrection&gt;
366     &lt;ColorCorrection id="f54.112"&gt;
367         &lt;SOPNode&gt;
368             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
369             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
370             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
371         &lt;/SOPNode&gt;
372         &lt;SATNode&gt;
373             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
374         &lt;/SATNode&gt;
375     &lt;/ColorCorrection&gt;
376     &lt;ColorCorrection id="burp_100.x12"&gt;
377         &lt;SOPNode&gt;
378             &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
379             &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
380             &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
381         &lt;/SOPNode&gt;
382         &lt;SATNode&gt;
383             &lt;Saturation&gt;1.09&lt;/Saturation&gt;
384         &lt;/SATNode&gt;
385     &lt;/ColorCorrection&gt;
386     &lt;ColorCorrection id="f54.112"&gt;
387         &lt;SOPNode&gt;
388             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
389             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
390             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
391         &lt;/SOPNode&gt;
392         &lt;SATNode&gt;
393             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
394         &lt;/SATNode&gt;
395     &lt;/ColorCorrection&gt;
396 &lt;/ColorCorrectionCollection&gt;
397 """
398 CDL_ODD_WRITE = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
399 &lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;
400     &lt;Description&gt;CDL description 1&lt;/Description&gt;
401     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
402     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
403     &lt;ColorDecision&gt;
404         &lt;MediaRef ref="C:\\Windows\File\Path"/&gt;
405         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
406             &lt;SOPNode&gt;
407                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
408                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
409                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
410                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
411                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
412                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
413             &lt;/SOPNode&gt;
414         &lt;/ColorCorrection&gt;
415     &lt;/ColorDecision&gt;
416     &lt;ColorDecision&gt;
417         &lt;MediaRef ref="relative\windows\path"/&gt;
418         &lt;ColorCorrection id="f51.200"&gt;
419             &lt;SOPNode&gt;
420                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
421                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
422                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
423             &lt;/SOPNode&gt;
424         &lt;/ColorCorrection&gt;
425     &lt;/ColorDecision&gt;
426     &lt;ColorDecision&gt;
427         &lt;Description&gt;CD description 1&lt;/Description&gt;
428         &lt;MediaRef ref="./sameDirectory/loser.####.fbx"/&gt;
429         &lt;ColorCorrectionRef ref="014_xf_seqGrade_v01"/&gt;
430     &lt;/ColorDecision&gt;
431     &lt;ColorDecision&gt;
432         &lt;MediaRef ref="../lateralDirectory/file.lives.here.0120.dpx"/&gt;
433         &lt;ColorCorrectionRef ref="missingRef"/&gt;
434     &lt;/ColorDecision&gt;
435     &lt;ColorDecision&gt;
436         &lt;MediaRef ref="http://www.google.com/logo.jpg"/&gt;
437         &lt;ColorCorrectionRef ref="alsoMissingRef"/&gt;
438     &lt;/ColorDecision&gt;
439     &lt;ColorDecision&gt;
440         &lt;MediaRef ref="serv://proto/uri:area:full?query=result#fragment"/&gt;
441         &lt;ColorCorrection id="burp_200.x15"&gt;
442             &lt;SATNode&gt;
443                 &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
444                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
445             &lt;/SATNode&gt;
446         &lt;/ColorCorrection&gt;
447     &lt;/ColorDecision&gt;
448     &lt;ColorDecision&gt;
449         &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
450         &lt;MediaRef ref="..\.\..\..\..\This\should\not\be\legal\"/&gt;
451         &lt;ColorCorrectionRef ref="f51.200"/&gt;
452     &lt;/ColorDecision&gt;
453 &lt;/ColorDecisionList&gt;
454 """
455 CDL_ODD_WRITE_RESOLVED = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
456 &lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;
457     &lt;Description&gt;CDL description 1&lt;/Description&gt;
458     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
459     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
460     &lt;ColorDecision&gt;
461         &lt;MediaRef ref="C:\\Windows\File\Path"/&gt;
462         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
463             &lt;SOPNode&gt;
464                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
465                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
466                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
467                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
468                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
469                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
470             &lt;/SOPNode&gt;
471         &lt;/ColorCorrection&gt;
472     &lt;/ColorDecision&gt;
473     &lt;ColorDecision&gt;
474         &lt;MediaRef ref="relative\windows\path"/&gt;
475         &lt;ColorCorrection id="f51.200"&gt;
476             &lt;SOPNode&gt;
477                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
478                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
479                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
480             &lt;/SOPNode&gt;
481         &lt;/ColorCorrection&gt;
482     &lt;/ColorDecision&gt;
483     &lt;ColorDecision&gt;
484         &lt;Description&gt;CD description 1&lt;/Description&gt;
485         &lt;MediaRef ref="./sameDirectory/loser.####.fbx"/&gt;
486         &lt;ColorCorrectionRef ref="014_xf_seqGrade_v01"/&gt;
487     &lt;/ColorDecision&gt;
488     &lt;ColorDecision&gt;
489         &lt;MediaRef ref="../lateralDirectory/file.lives.here.0120.dpx"/&gt;
490         &lt;ColorCorrection id="missingRef"&gt;
491             &lt;SOPNode&gt;
492                 &lt;Slope&gt;1.0 2.0 1.0&lt;/Slope&gt;
493                 &lt;Offset&gt;0.0 0.0 0.0&lt;/Offset&gt;
494                 &lt;Power&gt;1.0 1.0 1.0&lt;/Power&gt;
495             &lt;/SOPNode&gt;
496         &lt;/ColorCorrection&gt;
497     &lt;/ColorDecision&gt;
498     &lt;ColorDecision&gt;
499         &lt;MediaRef ref="http://www.google.com/logo.jpg"/&gt;
500         &lt;ColorCorrectionRef ref="alsoMissingRef"/&gt;
501     &lt;/ColorDecision&gt;
502     &lt;ColorDecision&gt;
503         &lt;MediaRef ref="serv://proto/uri:area:full?query=result#fragment"/&gt;
504         &lt;ColorCorrection id="burp_200.x15"&gt;
505             &lt;SATNode&gt;
506                 &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
507                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
508             &lt;/SATNode&gt;
509         &lt;/ColorCorrection&gt;
510     &lt;/ColorDecision&gt;
511     &lt;ColorDecision&gt;
512         &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
513         &lt;MediaRef ref="..\.\..\..\..\This\should\not\be\legal\"/&gt;
514         &lt;ColorCorrectionRef ref="f51.200"/&gt;
515     &lt;/ColorDecision&gt;
516 &lt;/ColorDecisionList&gt;
517 """
518 CDL_ODD_WRITE_CCC = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
519 &lt;ColorCorrectionCollection xmlns="urn:ASC:CDL:v1.01"&gt;
520     &lt;Description&gt;CDL description 1&lt;/Description&gt;
521     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
522     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
523     &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
524         &lt;SOPNode&gt;
525             &lt;Description&gt;Sop description 1&lt;/Description&gt;
526             &lt;Description&gt;Sop description 2&lt;/Description&gt;
527             &lt;Description&gt;Sop description 3&lt;/Description&gt;
528             &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
529             &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
530             &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
531         &lt;/SOPNode&gt;
532     &lt;/ColorCorrection&gt;
533     &lt;ColorCorrection id="f51.200"&gt;
534         &lt;SOPNode&gt;
535             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
536             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
537             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
538         &lt;/SOPNode&gt;
539     &lt;/ColorCorrection&gt;
540     &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
541         &lt;SOPNode&gt;
542             &lt;Description&gt;Sop description 1&lt;/Description&gt;
543             &lt;Description&gt;Sop description 2&lt;/Description&gt;
544             &lt;Description&gt;Sop description 3&lt;/Description&gt;
545             &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
546             &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
547             &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
548         &lt;/SOPNode&gt;
549     &lt;/ColorCorrection&gt;
550     &lt;ColorCorrection id="burp_200.x15"&gt;
551         &lt;SATNode&gt;
552             &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
553             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
554         &lt;/SATNode&gt;
555     &lt;/ColorCorrection&gt;
556     &lt;ColorCorrection id="f51.200"&gt;
557         &lt;SOPNode&gt;
558             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
559             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
560             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
561         &lt;/SOPNode&gt;
562     &lt;/ColorCorrection&gt;
563 &lt;/ColorCorrectionCollection&gt;
564 """
565 CDL_BAD_TAG = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
566 &lt;ColorDecisionBlist xmlns="urn:ASC:CDL:v1.01"&gt;
567     &lt;Description&gt;CCC description 1&lt;/Description&gt;
568     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
569     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
570     &lt;ColorDecision&gt;
571         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
572             &lt;SOPNode&gt;
573                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
574                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
575                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
576                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
577                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
578                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
579             &lt;/SOPNode&gt;
580         &lt;/ColorCorrection&gt;
581     &lt;/ColorDecision&gt;
582 &lt;/ColorDecisionBlist&gt;
583 """
584 <a name="5"></a>UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
585 LOWER =</b></font> 'abcdefghijklmnopqrstuvwxyz'
586 <font color="#151b8d"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>if sys.version_info[0] &gt;= 3:
587     enc = lambda x: bytes(x, 'UTF-8')
588 else:
589     enc = lambda x: x
590 if sys.version_info[0] &gt;= 3:
591     builtins = 'builtins'
592 else:
593     builtins = '__builtin__'
594 class TestParseCDLFull(unittest.TestCase):
595     def setUp(self):
596         self.desc = [
597             'CDL description 1'</b></font>,
598             'CDL description 2',
599             'CDL description 3',
600             'CDL description 4',
601             'CDL description 5'
602         ]
603         self.input_desc = 'CDL Input Desc Text'
604         self.viewing_desc = 'CDL Viewing Desc Text'
605         self.color_correction_ids = [
606             '014_xf_seqGrade_v01',
607             'f51.200',
608             'f51.200',
609             'f55.100',
610             'f54.112',
611             'burp_100.x12',
612 <a name="16"></a>            'f54.112',
613         ]
614         self.media_ref_refs = [
615             <font color="#2981b2"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>"/best/path/ever.dpx",
616             None,
617             "relative/path/13.jpg",
618             None,
619             None,
620             None,
621             None,
622         ]
623         self.color_decision_descs = [
624             ['CD description 1', 'CD description 2', 'CD description 3'],
625             [],
626             [],
627             [],
628             ['CD description 1', 'CD description 2'],
629             [],
630             [],
631         ]
632         self.color_decision_input_descs = [
633             'CD Input Desc Text',
634             None,
635             None,
636             None,
637             'CD Input Desc Text 2',
638             None,
639             None,
640         ]
641         self.color_decision_viewing_descs = [
642             'CD WOOD VIEWER!? ////',
643             None,
644             None,
645             None,
646             None,
647             None,
648             '12345'
649         ]
650         self.</b></font>color_decision_is_ref = [
651             False,
652             False,
653             True,
654             False,
655             False,
656             False,
657             True,
658 <a name="2"></a>        ]
659         <font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
660             f.write(enc(CDL_FULL))
661             self.filename = f.name
662         self.node = cdl_convert.parse_cdl(self.filename)
663     def tearDown(self):
664         os.remove(self.filename)
665         cdl_convert.reset_all()
666     def test_file_in(self):
667         self.assertEqual(
668             self.filename,
669             self.node.file_in
670         )
671     def test_type(self):
672 <a name="4"></a>        """Makes sure type is still set to ccc"""
673         self.assertEqual(
674             'cdl',
675             self.node.</b></font><font color="#6cc417"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>type
676         )
677     def test_descs(self):
678         self.assertEqual(
679             self.desc,
680             self.node.desc
681         )
682     def test_viewing_desc(self):
683         self.assertEqual(
684             self.viewing_desc,
685             self.node.viewing_desc
686         )
687     def test_input_desc(self):
688         self.assertEqual(
689             self.input_desc,
690             self.node.input_desc
691         )
692     def</b></font> test_parse_cc_results(self):
693         id_list = [i.cc.id for i in self.node.color_decisions]
694         self.assertEqual(
695             self.color_correction_ids,
696             id_list
697         )
698     def test_media_ref_refs(self):
699         ref_list = [
700             i.media_ref.ref if i.media_ref else None for i in self.node.color_decisions
701         ]
702         self.assertEqual(
703             self.media_ref_refs,
704             ref_list
705         )
706     def test_color_decision_descs(self):
707         desc_list = [
708             i.desc for i in self.node.color_decisions
709         ]
710         self.assertEqual(
711             self.color_decision_descs,
712             desc_list
713         )
714     def test_color_decision_input_descs(self):
715         desc_list = [
716             i.input_desc for i in self.node.color_decisions
717         ]
718         self.assertEqual(
719             self.color_decision_input_descs,
720             desc_list
721         )
722     def test_color_decision_viewing_descs(self):
723         desc_list = [
724             i.viewing_desc for i in self.node.color_decisions
725         ]
726         self.assertEqual(
727             self.color_decision_viewing_descs,
728             desc_list
729         )
730     def test_color_decision_is_ref(self):
731         ref_list = [
732             i.is_ref for i in self.node.color_decisions
733         ]
734         self.assertEqual(
735             self.color_decision_is_ref,
736             ref_list
737         )
738 class TestParseCDLOdd(TestParseCDLFull):
739     def setUp(self):
740         self.desc = [
741             'CDL description 1',
742             'Raised1 saturation a little!?! ag... \/Offset',
743             'Raised2 saturation a little!?! ag... \/Offset',
744         ]
745         self.input_desc = None
746         self.viewing_desc = None
747         self.color_correction_ids = [
748             '014_xf_seqGrade_v01',
749             'f51.200',
750             '014_xf_seqGrade_v01',
751             'missingRef',
752             'alsoMissingRef',
753             'burp_200.x15',
754             'f51.200'
755         ]
756         self.media_ref_refs = [
757             "C:\\\\Windows\\File\\Path",
758             "relative\\windows\\path",
759             "./sameDirectory/loser.####.fbx",
760             "../lateralDirectory/file.lives.here.0120.dpx",
761             "http://www.google.com/logo.jpg",
762             "serv://proto/uri:area:full?query=result#fragment",
763             "..\\.\\..\\..\\..\\This\\should\\not\\be\\legal\\"
764         ]
765         self.color_decision_descs = [
766             [],
767             [],
768             ['CD description 1'],
769             [],
770             [],
771             [],
772             ['Raised2 saturation a little!?! ag... \/Offset']
773         ]
774         self.color_decision_input_descs = [
775             None,
776             None,
777             None,
778             None,
779             None,
780             None,
781             None,
782         ]
783         self.color_decision_viewing_descs = [
784             None,
785             None,
786             None,
787             None,
788             None,
789             None,
790             None,
791         ]
792         self.color_decision_is_ref = [
793             False,
794             False,
795             True,
796             True,
797             True,
798             False,
799             True,
800 <a name="7"></a>        ]
801         <font color="#38a4a5"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
802             f.write(enc(CDL_ODD))
803             self.filename = f.name
804         self.node = cdl_convert.parse_cdl(self.filename)
805 class</b></font> TestParseCDLExceptions(unittest.TestCase):
806     def setUp(self):
807         self.filename = None
808 <a name="15"></a>    def tearDown(self):
809         if self.filename:
810             os.remove(self.filename)
811         cdl_convert.reset_all(<font color="#f52887"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>)
812     def testBadTag(self):
813         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
814             f.write(enc(CDL_BAD_TAG))
815             self.filename = f.name
816 <a name="1"></a>        self.</b></font>assertRaises(
817             ValueError,
818             cdl_convert.parse_cdl,
819             self<font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.filename,
820         )
821     def testEmptyCDL(self):
822         emptyCDL = ('&lt;?xml version="1.0" encoding="UTF-8"?&gt;\n'
823                     '&lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;\n'
824                     '&lt;/ColorDecisionList&gt;')
825         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
826             f.write(enc(emptyCDL))
827             self.filename = f.name
828         self.assertRaises(
829             ValueError,
830             cdl_convert.parse_cdl,
831             self.filename,
832         )
833     def testEmptyCD(self):
834         emptyCDL = ('&lt;?xml version="1.0" encoding="UTF-8"?&gt;\n'
835                     '&lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;\n'
836                     '\t&lt;ColorDecision&gt;\n'
837                     '\t\t&lt;MediaRef ref="bestref.dpx"/&gt;\n'
838                     '\t&lt;/ColorDecision&gt;\n'
839                     '&lt;/ColorDecisionList&gt;')
840         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
841             f.write(enc(emptyCDL))
842             self.filename = f.name
843         self.assertRaises(
844             ValueError,
845             cdl_convert.parse_cdl,
846             self.</b></font>filename,
847         )
848 class TestWriteCDLFull(unittest.TestCase):
849 <a name="11"></a>
850     def setUp(self):
851         <font color="#b041ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
852             f.write(enc(CDL_FULL))
853             self.filename = f.name
854 <a name="17"></a>
855         self.cdl = cdl_convert.parse_cdl(self.</b></font>filename)
856         self<font color="#3090c7"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.target_xml_root = enc(CDL_FULL_WRITE)
857         self.target_xml = enc('\n'.join(CDL_FULL_WRITE.split('\n')[</b></font>1:]))
858 <a name="0"></a>
859     def tearDown(self):
860         os.remove(self.filename)
861         cdl_convert<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.reset_all()
862     def test_root_xml(self):
863         self.assertEqual(
864             self.target_xml_root,
865             self.cdl.xml_root
866         )
867     def test_base_xml(self):
868         self.assertEqual(
869             self.target_xml,
870             self.cdl.xml
871         )
872     def test_element(self):
873         self.assertEqual(
874             'ColorDecisionList',
875             self.cdl.element.tag
876         )
877     def test_write(self):
878         mockOpen = mock.mock_open()
879         self.cdl._file_out = 'bobs_big_file.cdl'
880         with mock.patch(builtins + '.open', mockOpen, create=True):
881             cdl_convert.write_cdl(self.cdl)
882         mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')
883         mockOpen().write.assert_called_once_with(self.target_xml_root)
884 class TestWriteCDLFullAsCCC(TestWriteCDLFull):
885     def setUp(self):
886 <a name="8"></a>        cdl_convert.reset_all(</b></font>)
887         <font color="#c58917"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
888             f.write(enc(CDL_FULL))
889             self.filename = f.name
890         self.cdl = cdl_convert.parse_cdl(self.filename)
891         self.cdl.</b></font>set_to_ccc()
892         self.target_xml_root = enc(CDL_FULL_WRITE_CCC)
893         self.target_xml = enc('\n'.join(CDL_FULL_WRITE_CCC.split('\n')[1:]))
894     def test_element(self):
895         self.assertEqual(
896             'ColorCorrectionCollection',
897             self.cdl.element.tag
898         )
899     def test_write(self):
900         mockOpen = mock.mock_open()
901         self.cdl._file_out = 'bobs_big_file.cdl'
902         with mock.patch(builtins + '.open', mockOpen, create=True):
903             cdl_convert.write_ccc(self.cdl)
904         mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')
905         mockOpen().write.assert_called_once_with(self.target_xml_root)
906 class TestWriteCDLOddAsCCC(TestWriteCDLFullAsCCC):
907     def setUp(self):
908         cdl_convert.reset_all<font color="#8c8774"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>()
909         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
910             f.write(enc(CDL_ODD))
911             self.filename = f.name
912 <a name="14"></a>        self.cdl = cdl_convert.parse_cdl(self.filename)
913         self.cdl.</b></font>set_to_ccc()
914         self<font color="#842dce"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.target_xml_root = enc(CDL_ODD_WRITE_CCC)
915         self.target_xml = enc('\n'.join(CDL_ODD_WRITE_CCC.split('\n')[1:]))
916 class TestWriteCDLOdd(TestWriteCDLFull):
917     def setUp(self):
918         cdl_convert.</b></font>reset_all<font color="#ad5910"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>()
919         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
920             f.write(enc(CDL_ODD))
921             self.filename = f.name
922 <a name="13"></a>
923         self.cdl = cdl_convert.parse_cdl(self.</b></font>filename)
924         self<font color="#3b9c9c"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.target_xml_root = enc(CDL_ODD_WRITE)
925         self.target_xml = enc('\n'.join(CDL_ODD_WRITE.split('\n')[1:]))
926 class TestWriteCDLOddReferenceFix(TestWriteCDLFull):
927     def setUp(self):
928         cdl_convert.</b></font>reset_all<font color="#83a33a"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>()
929         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
930             f.write(enc(CDL_ODD))
931             self.filename = f.name
932 <a name="12"></a>
933         self.cdl = cdl_convert.parse_cdl(self.</b></font>filename)
934         cc = cdl_convert.ColorCorrection("missingRef")
935         cc<font color="#571b7e"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.slope = [1.0, 2.0, 1.0]
936         self.target_xml_root = enc(CDL_ODD_WRITE_RESOLVED)
937         self.target_xml = enc('\n'.join(CDL_ODD_WRITE_RESOLVED.split('\n')[1:]))
938     def</b></font> testMissingRef(self):
939         cdl_convert.config.HALT_ON_ERROR = True
940         mockOpen = mock.mock_open()
941         self.cdl._file_out = 'bobs_big_file.cdl'
942         with mock.patch(builtins + '.open', mockOpen, create=True):
943             cdl_convert.write_cdl(self.cdl)
944         mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')
945         mockOpen().write.assert_called_once_with(self.target_xml_root)
946         cdl_convert.config.HALT_ON_ERROR = False
947 if __name__ == '__main__':
948     unittest.main()
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_cc.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <a name="3"></a>
2 from decimal import Decimal
3 <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>try:
4     from unittest import mock
5 except ImportError:
6     import mock
7 import os
8 import sys
9 import tempfile
10 import unittest
11 from xml.etree import ElementTree
12 sys.path.append('/'.join(os.path.realpath(__file__).split('/')[:-2]))
13 import cdl_convert
14 CC_FULL = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
15 &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
16     &lt;Description&gt;CC description 1&lt;/Description&gt;
17     &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
18     &lt;Description&gt;CC description 2&lt;/Description&gt;
19     &lt;SOPNode&gt;
20         &lt;Description&gt;Sop description 1&lt;/Description&gt;
21         &lt;Description&gt;Sop description 2&lt;/Description&gt;
22         &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
23         &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
24         &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
25         &lt;Description&gt;Sop description 3&lt;/Description&gt;
26     &lt;/SOPNode&gt;
27     &lt;Description&gt;CC description 3&lt;/Description&gt;
28     &lt;SATNode&gt;
29         &lt;Description&gt;Sat description 1&lt;/Description&gt;
30         &lt;Saturation&gt;1.09&lt;/Saturation&gt;
31         &lt;Description&gt;Sat description 2&lt;/Description&gt;
32     &lt;/SATNode&gt;
33     &lt;Description&gt;CC description 4&lt;/Description&gt;
34     &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
35     &lt;Description&gt;CC description 5&lt;/Description&gt;
36 &lt;/ColorCorrection&gt;
37 """
38 CC_BASIC = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
39 &lt;ColorCorrection id="f51.200"&gt;
40     &lt;SopNode&gt;
41         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
42         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
43         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
44     &lt;/SopNode&gt;
45     &lt;SatNode&gt;
46         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
47     &lt;/SatNode&gt;
48 &lt;/ColorCorrection&gt;
49 """
50 CC_ODD = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
51 &lt;ColorCorrection id="f55.100\\\\\//////"&gt;
52     &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
53     &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
54     &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
55     &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
56     &lt;SopNode&gt;
57         &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
58         &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
59         &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
60         &lt;Power&gt;3271893.993 .0000998 0.0000000000000000113&lt;/Power&gt;
61     &lt;/SopNode&gt;
62     &lt;SatNode&gt;
63         &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
64     &lt;/SatNode&gt;
65 &lt;/ColorCorrection&gt;
66 """
67 CC_BASIC_ORDER = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
68 &lt;ColorCorrection id="f54.112"&gt;
69     &lt;ASC_SAT&gt;
70         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
71     &lt;/ASC_SAT&gt;
72     &lt;ASC_SOP&gt;
73         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
74         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
75         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
76     &lt;/ASC_SOP&gt;
77 &lt;/ColorCorrection&gt;
78 """
79 CC_BLANK_METADATA = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
80 &lt;ColorCorrection id="burp_100.x12"&gt;
81     &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
82     &lt;Description&gt;&lt;/Description&gt;
83     &lt;SOPNode&gt;
84         &lt;Description&gt;&lt;/Description&gt;
85         &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
86         &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
87         &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
88     &lt;/SOPNode&gt;
89     &lt;Description&gt;&lt;/Description&gt;
90     &lt;InputDescription&gt;&lt;/InputDescription&gt;
91     &lt;SatNode&gt;
92         &lt;Saturation&gt;1.09&lt;/Saturation&gt;
93         &lt;Description&gt;&lt;/Description&gt;
94     &lt;/SatNode&gt;
95     &lt;Description&gt;&lt;/Description&gt;
96 &lt;/ColorCorrection&gt;
97 """
98 CC_NO_SOP = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
99 &lt;ColorCorrection id="burp_200.x15"&gt;
100     &lt;SatNode&gt;
101         &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
102         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
103     &lt;/SatNode&gt;
104 &lt;/ColorCorrection&gt;
105 """
106 CC_NO_SAT = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
107 &lt;ColorCorrection id="burp_300.x35"&gt;
108     &lt;SopNode&gt;
109         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
110         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
111         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
112     &lt;/SopNode&gt;
113 &lt;/ColorCorrection&gt;
114 """
115 CC_NO_ID = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
116 &lt;ColorCorrection&gt;
117     &lt;SopNode&gt;
118         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
119         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
120         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
121     &lt;/SopNode&gt;
122     &lt;SatNode&gt;
123         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
124     &lt;/SatNode&gt;
125 &lt;/ColorCorrection&gt;
126 """
127 CC_BLANK_ID = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
128 &lt;ColorCorrection id=""&gt;
129     &lt;SopNode&gt;
130         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
131         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
132         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
133     &lt;/SopNode&gt;
134     &lt;SatNode&gt;
135         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
136     &lt;/SatNode&gt;
137 &lt;/ColorCorrection&gt;
138 """
139 CC_NEGATIVE_SLOPE =</b></font> """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
140 &lt;ColorCorrection id="dsds"&gt;
141     &lt;SopNode&gt;
142         &lt;Slope&gt;-0.2331 0.678669 1.0758&lt;/Slope&gt;
143         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
144         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
145     &lt;/SopNode&gt;
146     &lt;SatNode&gt;
147         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
148     &lt;/SatNode&gt;
149 &lt;/ColorCorrection&gt;
150 """
151 CC_FULL_WRITE = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
152 &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
153     &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
154     &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
155     &lt;Description&gt;CC description 1&lt;/Description&gt;
156     &lt;Description&gt;CC description 2&lt;/Description&gt;
157     &lt;Description&gt;CC description 3&lt;/Description&gt;
158     &lt;Description&gt;CC description 4&lt;/Description&gt;
159     &lt;Description&gt;CC description 5&lt;/Description&gt;
160     &lt;SOPNode&gt;
161         &lt;Description&gt;Sop description 1&lt;/Description&gt;
162         &lt;Description&gt;Sop description 2&lt;/Description&gt;
163         &lt;Description&gt;Sop description 3&lt;/Description&gt;
164         &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
165         &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
166         &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
167     &lt;/SOPNode&gt;
168     &lt;SATNode&gt;
169         &lt;Description&gt;Sat description 1&lt;/Description&gt;
170         &lt;Description&gt;Sat description 2&lt;/Description&gt;
171         &lt;Saturation&gt;1.09&lt;/Saturation&gt;
172     &lt;/SATNode&gt;
173 &lt;/ColorCorrection&gt;
174 """
175 CC_ODD_WRITE = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
176 &lt;ColorCorrection id="f55.100"&gt;
177     &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
178     &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
179     &lt;Description&gt;Raised saturation1 a little!?! ag... \/Offset&lt;/Description&gt;
180     &lt;Description&gt;Raised saturation2 a little!?! ag... \/Offset&lt;/Description&gt;
181     &lt;SOPNode&gt;
182         &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
183         &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
184         &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
185         &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
186     &lt;/SOPNode&gt;
187     &lt;SATNode&gt;
188         &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
189     &lt;/SATNode&gt;
190 &lt;/ColorCorrection&gt;
191 """
192 CC_NO_SOP_WRITE = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
193 &lt;ColorCorrection id="burp_200.x15"&gt;
194     &lt;SATNode&gt;
195         &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
196         &lt;Saturation&gt;1.0128109381&lt;/Saturation&gt;
197     &lt;/SATNode&gt;
198 &lt;/ColorCorrection&gt;
199 """
200 CC_NO_SAT_WRITE = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
201 &lt;ColorCorrection id="burp_300.x35"&gt;
202     &lt;SOPNode&gt;
203         &lt;Slope&gt;1.233321 0.678669 1.0758&lt;/Slope&gt;
204         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
205         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
206     &lt;/SOPNode&gt;
207 &lt;/ColorCorrection&gt;
208 """
209 <a name="5"></a>UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
210 LOWER = 'abcdefghijklmnopqrstuvwxyz'
211 <font color="#151b8d"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>if sys.version_info[0] &gt;= 3:
212     enc = lambda x: bytes(x, 'UTF-8')
213 else:
214     enc = lambda x: x
215 if sys.version_info[0] &gt;= 3:
216     builtins = 'builtins'
217 else:
218     builtins = '__builtin__'
219 class TestParseCCBasic(unittest.TestCase):
220     def setUp(self):
221         self.id = "014_xf_seqGrade_v01"
222         self.</b></font>desc = [
223             'CC description 1', 'CC description 2', 'CC description 3',
224             'CC description 4', 'CC description 5'
225         ]
226         self.input_desc = 'Input Desc Text'
227         self.viewing_desc = 'Viewing Desc Text'
228         self.sop_node_desc = [
229             'Sop description 1', 'Sop description 2', 'Sop description 3'
230         ]
231         self.slope = decimalize(1.014, 1.0104, 0.62)
232         self.offset = decimalize(-0.00315, -0.00124, 0.3103)
233         self.power = decimalize(1.0, 0.9983, 1.0)
234         self.sat_node_desc = [
235             'Sat description 1', 'Sat description 2'
236         ]
237 <a name="2"></a>        self.sat = Decimal('1.09')
238         <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
239             f.write(enc(CC_FULL))
240             self.filename = f.name
241         self.cdl = cdl_convert.parse_cc(self.filename)
242     def tearDown(self):
243         os.remove(self.filename)
244         cdl_convert.reset_all()
245     def testId(self):
246         self.assertEqual(
247             self.id,
248             self.cdl.id
249         )
250     def testDesc(self):
251         self.assertEqual(
252             self.desc,
253             self.</b></font>cdl.desc
254         )
255     def testInputDesc(self):
256         self.assertEqual(
257             self.input_desc,
258             self.cdl.input_desc
259         )
260     def testViewingDesc(self):
261         self.assertEqual(
262             self.viewing_desc,
263             self.cdl.viewing_desc
264         )
265     def testSopDesc(self):
266         self.assertEqual(
267             self.sop_node_desc,
268             self.cdl.sop_node.desc
269         )
270     def testSatDesc(self):
271 <a name="4"></a>        """Tests that desc was set to sat node's desc element"""
272         self.assertEqual(
273             self.sat_node_desc,
274             self.cdl.sat_node.<font color="#6cc417"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>desc
275         )
276     def testSlope(self):
277         self.assertEqual(
278             self.slope,
279             self.cdl.slope
280         )
281     def testOffset(self):
282         self.assertEqual(
283             self.offset,
284             self.cdl.offset
285         )
286     def testPower(self):
287         self.assertEqual(
288             self.power,
289             self.cdl.power
290         )
291     def</b></font> testSat(self):
292         self.assertEqual(
293             self.sat,
294             self.cdl.sat
295         )
296 class TestParseCCOdd(TestParseCCBasic):
297     def setUp(self):
298         self.id = "f55.100"  # This will have been _sanitized()
299         self.desc = [
300             'Raised saturation a little!?! ag... \/Offset',
301             'Raised saturation a little!?! ag... \/Offset',
302         ]
303         self.input_desc = 'METAL VIEWER!!! \/\/'
304         self.viewing_desc = 'WOOD VIEWER!? ////'
305         self.sop_node_desc = [
306             'Raised saturation a little!?! ag... \/Offset'
307         ]
308         self.slope = decimalize(137829.329, 4327890.9833, 3489031.003)
309         self.offset = decimalize(-3424.011, -342789423.013, -4238923.11)
310         self.power = decimalize(3271893.993, .0000998, 0.0000000000000000113)
311         self.sat_node_desc = []
312 <a name="7"></a>        self.sat = Decimal('1798787.01')
313         <font color="#38a4a5"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
314             f.write(enc(CC_ODD))
315             self.filename = f.name
316         self.cdl = cdl_convert.parse_cc(self.filename)
317 class</b></font> TestParseCCBasic(TestParseCCBasic):
318     def setUp(self):
319         self.id = "f51.200"
320         self.desc = []
321         self.input_desc = None
322         self.viewing_desc = None
323         self.sop_node_desc = []
324         self.slope = decimalize(0.2331, 0.678669, 1.0758)
325 <a name="10"></a>        self.offset = decimalize(0.031, 0.128, -0.096)
326         self.power = decimalize(1.8, 0.97, 0.961)
327         self.sat_node_desc = []
328         self.sat = Decimal<font color="#ad5910"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>('1.01')
329         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
330             f.write(enc(CC_BASIC))
331             self.filename = f.name
332         self.cdl = cdl_convert.parse_cc(self.</b></font>filename)
333 class TestParseCCBasicOrder(TestParseCCBasic):
334     def setUp(self):
335         self.id = "f54.112"
336         self.desc = []
337         self.input_desc = None
338         self.viewing_desc = None
339         self.sop_node_desc = []
340         self.slope = decimalize(0.2331, 0.678669, 1.0758)
341 <a name="9"></a>        self.offset = decimalize(0.031, 0.128, -0.096)
342         self.power = decimalize(1.8, 0.97, 0.961)
343         self.sat_node_desc = []
344         self.sat = Decimal<font color="#83a33a"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>('1.01')
345         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
346             f.write(enc(CC_BASIC_ORDER))
347             self.filename = f.name
348         self.cdl = cdl_convert.parse_cc(self.</b></font>filename)
349 class TestParseCCBlankMetadata(TestParseCCBasic):
350     def setUp(self):
351         self.id = "burp_100.x12"
352         self.desc = []
353         self.input_desc = None
354         self.viewing_desc = None
355         self.sop_node_desc = []
356         self.slope = decimalize(1.014, 1.0104, 0.62)
357         self.offset = decimalize(-0.00315, -0.00124, 0.3103)
358         self.power = decimalize(1.0, 0.9983, 1.0)
359         self.sat_node_desc = []
360 <a name="11"></a>        self.sat = Decimal('1.09')
361         <font color="#b041ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
362             f.write(enc(CC_BLANK_METADATA))
363             self.filename = f.name
364         self.cdl = cdl_convert.parse_cc(self.</b></font>filename)
365 class TestParseCCNoSop(TestParseCCBasic):
366     def setUp(self):
367         self.id = "burp_200.x15"
368         self.desc = []
369         self.input_desc = None
370         self.viewing_desc = None
371         self.sop_node_desc = []
372         self.slope = decimalize(1.0, 1.0, 1.0)
373 <a name="6"></a>        self.offset = decimalize(0.0, 0.0, 0.0)
374         self.power = decimalize(1.0, 1.0, 1.0)
375         self.sat_node_desc = ['I am a lovely sat node']
376         self.sat = Decimal<font color="#8c8774"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>('1.01')
377         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
378             f.write(enc(CC_NO_SOP))
379             self.filename = f.name
380         self.cdl = cdl_convert.parse_cc(self.filename)
381         self.cdl.</b></font>slope
382 class TestParseCCNoSat(TestParseCCBasic):
383     def setUp(self):
384         self.id = "burp_300.x35"
385         self.desc = []
386         self.input_desc = None
387         self.viewing_desc = None
388         self.sop_node_desc = []
389         self.slope = decimalize(0.2331, 0.678669, 1.0758)
390         self.offset = decimalize(0.031, 0.128, -0.096)
391         self.power = decimalize(1.8, 0.97, 0.961)
392         self.sat_node_desc = []
393 <a name="8"></a>        self.sat = Decimal('1.0')
394         <font color="#c58917"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
395             f.write(enc(CC_NO_SAT))
396             self.filename = f.name
397         self.cdl = cdl_convert.parse_cc(self.filename)
398         self.cdl.</b></font>sat
399 class TestParseCCExceptions(unittest.TestCase):
400     def setUp(self):
401         self.file = None
402     def tearDown(self):
403         cdl_convert.reset_all()
404         if self.file:
405             os.remove(self.file)
406     def testNoId(self):
407         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
408             f.write(enc(CC_NO_ID))
409             self.file = f.name
410 <a name="1"></a>        cc = cdl_convert.parse_cc(self.file)
411         self.assertEqual(
412             '001',
413             cc<font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.id
414         )
415     def testNotColorCorrection(self):
416         xml = "&lt;ColorBlurection&gt;\n&lt;/ColorBlurection&gt;\n"
417         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
418             f.write(enc(xml))
419             self.file = f.name
420         self.assertRaises(
421             ValueError,
422             cdl_convert.parse_cc,
423             self.file
424         )
425     def testEmptyColorCorrection(self):
426         xml = '&lt;ColorCorrection id="hdjshd"&gt;\n&lt;/ColorCorrection&gt;\n'
427         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
428             f.write(enc(xml))
429             self.file = f.name
430         self.assertRaises(
431             ValueError,
432             cdl_convert.parse_cc,
433             self.</b></font>file
434         )
435     def testBlankId(self):
436         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
437             f.write(enc(CC_BLANK_ID))
438             self.file = f.name
439         cdl_convert.config.HALT_ON_ERROR = True
440         self.assertRaises(
441             ValueError,
442             cdl_convert.parse_cc,
443             self.file
444         )
445         cdl_convert.config.HALT_ON_ERROR = False
446         cdl = cdl_convert.parse_cc(self.file)
447 <a name="15"></a>
448         self.assertEqual(
449             '001',
450             cdl.<font color="#f52887"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>id
451         )
452     def testNegativeSlope(self):
453         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
454             f.write(enc(CC_NEGATIVE_SLOPE))
455             self.file = f.name
456         cdl_convert.</b></font>config.HALT_ON_ERROR = True
457         self.assertRaises(
458             ValueError,
459             cdl_convert.parse_cc,
460             self.file
461         )
462         cdl_convert.config.HALT_ON_ERROR = False
463         cdl_convert.reset_all()
464         cdl = cdl_convert.parse_cc(self.file)
465         self.assertEqual(
466             decimalize(0.0, 0.678669, 1.0758),
467             cdl.slope,
468         )
469 class TestWriteCCFull(unittest.TestCase):
470     def setUp(self):
471         cdl_convert.reset_all()
472         self.cdl = cdl_convert.ColorCorrection("014_xf_seqGrade_v01", '')
473         self.cdl.desc = [
474             'CC description 1', 'CC description 2', 'CC description 3',
475             'CC description 4', 'CC description 5'
476         ]
477         self.cdl.input_desc = 'Input Desc Text'
478         self.cdl.viewing_desc = 'Viewing Desc Text'
479         self.cdl.slope = (1.014, 1.0104, 0.62)
480         self.cdl.offset = (-0.00315, -0.00124, 0.3103)
481         self.cdl.power = (1.0, 0.9983, 1.0)
482         self.cdl.sop_node.desc = [
483             'Sop description 1', 'Sop description 2', 'Sop description 3'
484 <a name="12"></a>        ]
485         self.cdl.sat = 1.09
486         self.cdl.sat_node<font color="#571b7e"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.desc = [
487             'Sat description 1', 'Sat description 2'
488         ]
489         self.target_xml_root = enc(CC_FULL_WRITE)
490         self.target_xml = enc('\n'.join(CC_FULL_WRITE.split('\n')[1:]))
491     def</b></font> tearDown(self):
492         cdl_convert<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.reset_all()
493     def test_root_xml(self):
494         self.assertEqual(
495             self.target_xml_root,
496             self.cdl.xml_root
497         )
498     def test_base_xml(self):
499         self.assertEqual(
500             self.target_xml,
501             self.cdl.xml
502         )
503     def test_element(self):
504         self.assertEqual(
505             'ColorCorrection',
506             self.cdl.element.tag
507         )
508     def test_write(self):
509         mockOpen = mock.mock_open()
510         self.cdl._file_out = 'bobs_big_file.cc'
511         with mock.patch(builtins + '.open', mockOpen, create=True):
512             cdl_convert.write_cc(self.cdl)
513         mockOpen.assert_called_once_with('bobs_big_file.cc', 'wb')
514         mockOpen().write.assert_called_once_with(self.target_xml_root)
515 class TestWriteCCOdd(TestWriteCCFull):
516     def setUp(self):
517         cdl_convert.reset_all(</b></font>)
518         self.cdl = cdl_convert.ColorCorrection("f55.100", '')
519         self.cdl.desc = [
520             'Raised saturation1 a little!?! ag... \/Offset',
521             'Raised saturation2 a little!?! ag... \/Offset',
522         ]
523         self.cdl.input_desc = 'METAL VIEWER!!! \/\/'
524         self.cdl.viewing_desc = 'WOOD VIEWER!? ////'
525 <a name="16"></a>
526         self.cdl.slope = (137829.329, 4327890.9833, 3489031.003)
527         self.cdl.offset = (-3424.011, -342789423.013, -4238923.11)
528         self<font color="#2981b2"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.cdl.power = (3271893.993, .0000998, 0.0000000000000000113)
529         self.cdl.sop_node.desc = [
530             'Raised saturation a little!?! ag... \/Offset'
531         ]
532 <a name="14"></a>        self.cdl.sat = 1798787.01
533         self.cdl.</b></font>sat_node.desc = []
534         self<font color="#842dce"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.target_xml_root = enc(CC_ODD_WRITE)
535         self.target_xml = enc('\n'.join(CC_ODD_WRITE.split('\n')[1:]))
536 class TestWriteCCNoSop(TestWriteCCFull):
537     def setUp(self):
538         cdl_convert.</b></font>reset_all()
539         self.cdl = cdl_convert.ColorCorrection("burp_200.x15", '')
540 <a name="13"></a>        self.cdl.sat = 1.0128109381
541         self.cdl.sat_node.desc = ['I am a lovely sat node']
542         self<font color="#3b9c9c"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.target_xml_root = enc(CC_NO_SOP_WRITE)
543         self.target_xml = enc('\n'.join(CC_NO_SOP_WRITE.split('\n')[1:]))
544 class TestWriteCCNoSat(TestWriteCCFull):
545     def setUp(self):
546         cdl_convert.</b></font>reset_all()
547         self.cdl = cdl_convert.ColorCorrection("burp_300.x35", '')
548         self.cdl.slope = (1.233321, 0.678669, 1.0758)
549 <a name="17"></a>        self.cdl.offset = (0.031, 0.128, -0.096)
550         self.cdl.power = (1.8, 0.97, 0.961)
551         self<font color="#3090c7"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.target_xml_root = enc(CC_NO_SAT_WRITE)
552         self.target_xml = enc('\n'.join(CC_NO_SAT_WRITE.split('\n')[</b></font>1:]))
553 def decimalize(*args):
554     return tuple([Decimal(str(i)) for i in args])
555 if __name__ == '__main__':
556     unittest.main()
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
