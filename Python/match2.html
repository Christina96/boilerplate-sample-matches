<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_cdl.py &amp; test_cc.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_cdl.py &amp; test_cc.py
      </h3>
<h1 align="center">
        56.4%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_cdl.py (66.61184%)<th>test_cc.py (48.913044%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(1033-1092)<td><a href="#" name="0">(779-834)</a><td align="center"><font color="#ff0000">52</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(961-1004)<td><a href="#" name="1">(648-683)</a><td align="center"><font color="#c40000">40</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(719-752)<td><a href="#" name="2">(314-347)</a><td align="center"><font color="#b50000">37</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(15-629)<td><a href="#" name="3">(16-186)</a><td align="center"><font color="#9c0000">32</font>
<tr onclick='openModal("#6cc417")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#6cc417"><font color="#6cc417">-</font><td><a href="#" name="4">(752-784)<td><a href="#" name="4">(383-415)</a><td align="center"><font color="#700000">23</font>
<tr onclick='openModal("#151b8d")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#151b8d"><font color="#151b8d">-</font><td><a href="#" name="5">(631-655)<td><a href="#" name="5">(269-295)</a><td align="center"><font color="#660000">21</font>
<tr onclick='openModal("#8c8774")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#8c8774"><font color="#8c8774">-</font><td><a href="#" name="6">(1142-1150)<td><a href="#" name="6">(568-578)</a><td align="center"><font color="#620000">20</font>
<tr onclick='openModal("#38a4a5")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#38a4a5"><font color="#38a4a5">-</font><td><a href="#" name="7">(924-931)<td><a href="#" name="7">(451-460)</a><td align="center"><font color="#620000">20</font>
<tr onclick='openModal("#c58917")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#c58917"><font color="#c58917">-</font><td><a href="#" name="8">(1095-1100)<td><a href="#" name="8">(604-611)</a><td align="center"><font color="#5d0000">19</font>
<tr onclick='openModal("#83a33a")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#83a33a"><font color="#83a33a">-</font><td><a href="#" name="9">(1195-1202)<td><a href="#" name="9">(508-515)</a><td align="center"><font color="#580000">18</font>
<tr onclick='openModal("#ad5910")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#ad5910"><font color="#ad5910">-</font><td><a href="#" name="10">(1168-1175)<td><a href="#" name="10">(478-485)</a><td align="center"><font color="#580000">18</font>
<tr onclick='openModal("#b041ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#b041ff"><font color="#b041ff">-</font><td><a href="#" name="11">(1020-1024)<td><a href="#" name="11">(541-545)</a><td align="center"><font color="#530000">17</font>
<tr onclick='openModal("#571b7e")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#571b7e"><font color="#571b7e">-</font><td><a href="#" name="12">(1204-1211)<td><a href="#" name="12">(769-778)</a><td align="center"><font color="#4e0000">16</font>
<tr onclick='openModal("#3b9c9c")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#3b9c9c"><font color="#3b9c9c">-</font><td><a href="#" name="13">(1177-1195)<td><a href="#" name="13">(871-883)</a><td align="center"><font color="#4e0000">16</font>
<tr onclick='openModal("#842dce")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#842dce"><font color="#842dce">-</font><td><a href="#" name="14">(1152-1168)<td><a href="#" name="14">(853-865)</a><td align="center"><font color="#4e0000">16</font>
<tr onclick='openModal("#f52887")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f52887"><font color="#f52887">-</font><td><a href="#" name="15">(944-958)<td><a href="#" name="15">(710-723)</a><td align="center"><font color="#490000">15</font>
<tr onclick='openModal("#2981b2")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#2981b2"><font color="#2981b2">-</font><td><a href="#" name="16">(673-708)<td><a href="#" name="16">(845-851)</a><td align="center"><font color="#3f0000">13</font>
<tr onclick='openModal("#3090c7")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#3090c7"><font color="#3090c7">-</font><td><a href="#" name="17">(1026-1027)<td><a href="#" name="17">(890-891)</a><td align="center"><font color="#3a0000">12</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_cdl.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>try:
2     from unittest import mock
3 except ImportError:
4     import mock
5 import os
6 import sys
7 import tempfile
8 import unittest
9 from xml.etree import ElementTree
10 sys.path.append('/'.join(os.path.realpath(__file__).split('/')[:-2]))
11 import cdl_convert
12 CDL_FULL = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
13 &lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;
14     &lt;Description&gt;CDL description 1&lt;/Description&gt;
15     &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
16     &lt;Description&gt;CDL description 2&lt;/Description&gt;
17     &lt;ColorDecision&gt;
18         &lt;Description&gt;CD description 1&lt;/Description&gt;
19         &lt;InputDescription&gt;CD Input Desc Text&lt;/InputDescription&gt;
20         &lt;Description&gt;CD description 2&lt;/Description&gt;
21         &lt;MediaRef ref="/best/path/ever.dpx"/&gt;
22         &lt;Description&gt;CD description 3&lt;/Description&gt;
23         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
24             &lt;Description&gt;CC description 1&lt;/Description&gt;
25             &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
26             &lt;Description&gt;CC description 2&lt;/Description&gt;
27             &lt;SOPNode&gt;
28                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
29                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
30                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
31                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
32                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
33                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
34             &lt;/SOPNode&gt;
35             &lt;Description&gt;CC description 3&lt;/Description&gt;
36             &lt;SATNode&gt;
37                 &lt;Description&gt;Sat description 1&lt;/Description&gt;
38                 &lt;Saturation&gt;1.09&lt;/Saturation&gt;
39                 &lt;Description&gt;Sat description 2&lt;/Description&gt;
40             &lt;/SATNode&gt;
41             &lt;Description&gt;CC description 4&lt;/Description&gt;
42             &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
43             &lt;Description&gt;CC description 5&lt;/Description&gt;
44         &lt;/ColorCorrection&gt;
45         &lt;ViewingDescription&gt;CD WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
46     &lt;/ColorDecision&gt;
47     &lt;ColorDecision&gt;
48         &lt;ColorCorrection id="f51.200"&gt;
49             &lt;SopNode&gt;
50                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
51                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
52                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
53             &lt;/SopNode&gt;
54             &lt;SatNode&gt;
55                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
56             &lt;/SatNode&gt;
57         &lt;/ColorCorrection&gt;
58     &lt;/ColorDecision&gt;
59     &lt;ColorDecision&gt;
60         &lt;MediaRef ref="relative/path/13.jpg"/&gt;
61         &lt;ColorCorrectionRef ref="f51.200"/&gt;
62     &lt;/ColorDecision&gt;
63     &lt;ColorDecision&gt;
64         &lt;ColorCorrection id="f55.100"&gt;
65             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
66             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
67             &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
68             &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
69             &lt;SopNode&gt;
70                 &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
71                 &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
72                 &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
73                 &lt;Power&gt;3271893.993 .0000998 0.0000000000000000113&lt;/Power&gt;
74             &lt;/SopNode&gt;
75             &lt;SatNode&gt;
76                 &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
77             &lt;/SatNode&gt;
78         &lt;/ColorCorrection&gt;
79     &lt;/ColorDecision&gt;
80     &lt;ColorDecision&gt;
81         &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
82         &lt;Description&gt;&lt;/Description&gt;
83         &lt;Description&gt;CD description 1&lt;/Description&gt;
84         &lt;ColorCorrection id="f54.112"&gt;
85             &lt;ASC_SAT&gt;
86                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
87             &lt;/ASC_SAT&gt;
88             &lt;ASC_SOP&gt;
89                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
90                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
91                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
92             &lt;/ASC_SOP&gt;
93         &lt;/ColorCorrection&gt;
94         &lt;Description&gt;CD description 2&lt;/Description&gt;
95         &lt;InputDescription&gt;CD Input Desc Text 2&lt;/InputDescription&gt;
96     &lt;/ColorDecision&gt;
97     &lt;Description&gt;CDL description 3&lt;/Description&gt;
98     &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
99     &lt;Description&gt;CDL description 4&lt;/Description&gt;
100     &lt;ColorDecision&gt;
101         &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
102         &lt;ColorCorrection id="burp_100.x12"&gt;
103             &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
104             &lt;Description&gt;&lt;/Description&gt;
105             &lt;SOPNode&gt;
106                 &lt;Description&gt;&lt;/Description&gt;
107                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
108                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
109                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
110             &lt;/SOPNode&gt;
111             &lt;Description&gt;&lt;/Description&gt;
112             &lt;InputDescription&gt;&lt;/InputDescription&gt;
113             &lt;SatNode&gt;
114                 &lt;Saturation&gt;1.09&lt;/Saturation&gt;
115                 &lt;Description&gt;&lt;/Description&gt;
116             &lt;/SatNode&gt;
117             &lt;Description&gt;&lt;/Description&gt;
118         &lt;/ColorCorrection&gt;
119     &lt;/ColorDecision&gt;
120     &lt;ColorDecision&gt;
121         &lt;ViewingDescription&gt;12345&lt;/ViewingDescription&gt;
122         &lt;ColorCorrectionRef ref="f54.112"/&gt;
123     &lt;/ColorDecision&gt;
124     &lt;Description&gt;CDL description 5&lt;/Description&gt;
125 &lt;/ColorDecisionList&gt;
126 """
127 CDL_ODD = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
128 &lt;ColorDecisionList&gt;
129     &lt;Description&gt;&lt;/Description&gt;
130     &lt;InputDescription&gt;&lt;/InputDescription&gt;
131     &lt;Description&gt;CDL description 1&lt;/Description&gt;
132     &lt;Description&gt;&lt;/Description&gt;
133     &lt;Description&gt;&lt;/Description&gt;
134     &lt;Description&gt;&lt;/Description&gt;
135     &lt;ColorDecision&gt;
136         &lt;MediaRef ref="C:\\Windows\File\Path"/&gt;
137         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
138             &lt;SOPNode&gt;
139                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
140                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
141                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
142                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
143                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
144                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
145             &lt;/SOPNode&gt;
146         &lt;/ColorCorrection&gt;
147     &lt;/ColorDecision&gt;
148     &lt;ColorDecision&gt;
149         &lt;ColorCorrection id="f51.200"&gt;
150             &lt;SopNode&gt;
151                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
152                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
153                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
154             &lt;/SopNode&gt;
155         &lt;/ColorCorrection&gt;
156         &lt;MediaRef ref="relative\windows\path"/&gt;
157     &lt;/ColorDecision&gt;
158     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
159     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
160     &lt;ColorDecision&gt;
161         &lt;Description&gt;&lt;/Description&gt;
162         &lt;InputDescription&gt;&lt;/InputDescription&gt;
163         &lt;Description&gt;CD description 1&lt;/Description&gt;
164         &lt;Description&gt;&lt;/Description&gt;
165         &lt;Description&gt;&lt;/Description&gt;
166         &lt;Description&gt;&lt;/Description&gt;
167         &lt;ColorCorrectionRef ref="014_xf_seqGrade_v01"/&gt;
168         &lt;MediaRef ref="./sameDirectory/loser.####.fbx"/&gt;
169     &lt;/ColorDecision&gt;
170     &lt;ColorDecision&gt;
171         &lt;MediaRef ref="../lateralDirectory/file.lives.here.0120.dpx"/&gt;
172         &lt;ColorCorrectionRef ref="missingRef"/&gt;
173     &lt;/ColorDecision&gt;
174     &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
175     &lt;ColorDecision&gt;
176         &lt;MediaRef ref="http://www.google.com/logo.jpg"/&gt;
177         &lt;ColorCorrectionRef ref="alsoMissingRef"/&gt;
178     &lt;/ColorDecision&gt;
179     &lt;ColorDecision&gt;
180         &lt;MediaRef ref="serv://proto/uri:area:full?query=result#fragment"/&gt;
181         &lt;ColorCorrection id="burp_200.x15"&gt;
182             &lt;SatNode&gt;
183                 &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
184                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
185             &lt;/SatNode&gt;
186         &lt;/ColorCorrection&gt;
187     &lt;/ColorDecision&gt;
188     &lt;ColorDecision&gt;
189         &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
190         &lt;MediaRef ref="..\.\..\..\..\This\should\not\be\legal\"/&gt;
191         &lt;ColorCorrectionRef ref="f51.200"/&gt;
192     &lt;/ColorDecision&gt;
193 &lt;/ColorDecisionList&gt;
194 """
195 CDL_FULL_WRITE = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
196 &lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;
197     &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
198     &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
199     &lt;Description&gt;CDL description 1&lt;/Description&gt;
200     &lt;Description&gt;CDL description 2&lt;/Description&gt;
201     &lt;Description&gt;CDL description 3&lt;/Description&gt;
202     &lt;Description&gt;CDL description 4&lt;/Description&gt;
203     &lt;Description&gt;CDL description 5&lt;/Description&gt;
204     &lt;ColorDecision&gt;
205         &lt;InputDescription&gt;CD Input Desc Text&lt;/InputDescription&gt;
206         &lt;ViewingDescription&gt;CD WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
207         &lt;Description&gt;CD description 1&lt;/Description&gt;
208         &lt;Description&gt;CD description 2&lt;/Description&gt;
209         &lt;Description&gt;CD description 3&lt;/Description&gt;
210         &lt;MediaRef ref="/best/path/ever.dpx"/&gt;
211         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
212             &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
213             &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
214             &lt;Description&gt;CC description 1&lt;/Description&gt;
215             &lt;Description&gt;CC description 2&lt;/Description&gt;
216             &lt;Description&gt;CC description 3&lt;/Description&gt;
217             &lt;Description&gt;CC description 4&lt;/Description&gt;
218             &lt;Description&gt;CC description 5&lt;/Description&gt;
219             &lt;SOPNode&gt;
220                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
221                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
222                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
223                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
224                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
225                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
226             &lt;/SOPNode&gt;
227             &lt;SATNode&gt;
228                 &lt;Description&gt;Sat description 1&lt;/Description&gt;
229                 &lt;Description&gt;Sat description 2&lt;/Description&gt;
230                 &lt;Saturation&gt;1.09&lt;/Saturation&gt;
231             &lt;/SATNode&gt;
232         &lt;/ColorCorrection&gt;
233     &lt;/ColorDecision&gt;
234     &lt;ColorDecision&gt;
235         &lt;ColorCorrection id="f51.200"&gt;
236             &lt;SOPNode&gt;
237                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
238                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
239                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
240             &lt;/SOPNode&gt;
241             &lt;SATNode&gt;
242                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
243             &lt;/SATNode&gt;
244         &lt;/ColorCorrection&gt;
245     &lt;/ColorDecision&gt;
246     &lt;ColorDecision&gt;
247         &lt;MediaRef ref="relative/path/13.jpg"/&gt;
248         &lt;ColorCorrectionRef ref="f51.200"/&gt;
249     &lt;/ColorDecision&gt;
250     &lt;ColorDecision&gt;
251         &lt;ColorCorrection id="f55.100"&gt;
252             &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
253             &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
254             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
255             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
256             &lt;SOPNode&gt;
257                 &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
258                 &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
259                 &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
260                 &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
261             &lt;/SOPNode&gt;
262             &lt;SATNode&gt;
263                 &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
264             &lt;/SATNode&gt;
265         &lt;/ColorCorrection&gt;
266     &lt;/ColorDecision&gt;
267     &lt;ColorDecision&gt;
268         &lt;InputDescription&gt;CD Input Desc Text 2&lt;/InputDescription&gt;
269         &lt;Description&gt;CD description 1&lt;/Description&gt;
270         &lt;Description&gt;CD description 2&lt;/Description&gt;
271         &lt;ColorCorrection id="f54.112"&gt;
272             &lt;SOPNode&gt;
273                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
274                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
275                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
276             &lt;/SOPNode&gt;
277             &lt;SATNode&gt;
278                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
279             &lt;/SATNode&gt;
280         &lt;/ColorCorrection&gt;
281     &lt;/ColorDecision&gt;
282     &lt;ColorDecision&gt;
283         &lt;ColorCorrection id="burp_100.x12"&gt;
284             &lt;SOPNode&gt;
285                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
286                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
287                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
288             &lt;/SOPNode&gt;
289             &lt;SATNode&gt;
290                 &lt;Saturation&gt;1.09&lt;/Saturation&gt;
291             &lt;/SATNode&gt;
292         &lt;/ColorCorrection&gt;
293     &lt;/ColorDecision&gt;
294     &lt;ColorDecision&gt;
295         &lt;ViewingDescription&gt;12345&lt;/ViewingDescription&gt;
296         &lt;ColorCorrectionRef ref="f54.112"/&gt;
297     &lt;/ColorDecision&gt;
298 &lt;/ColorDecisionList&gt;
299 """
300 CDL_FULL_WRITE_CCC = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
301 &lt;ColorCorrectionCollection xmlns="urn:ASC:CDL:v1.01"&gt;
302     &lt;InputDescription&gt;CDL Input Desc Text&lt;/InputDescription&gt;
303     &lt;ViewingDescription&gt;CDL Viewing Desc Text&lt;/ViewingDescription&gt;
304     &lt;Description&gt;CDL description 1&lt;/Description&gt;
305     &lt;Description&gt;CDL description 2&lt;/Description&gt;
306     &lt;Description&gt;CDL description 3&lt;/Description&gt;
307     &lt;Description&gt;CDL description 4&lt;/Description&gt;
308     &lt;Description&gt;CDL description 5&lt;/Description&gt;
309     &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
310         &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
311         &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
312         &lt;Description&gt;CC description 1&lt;/Description&gt;
313         &lt;Description&gt;CC description 2&lt;/Description&gt;
314         &lt;Description&gt;CC description 3&lt;/Description&gt;
315         &lt;Description&gt;CC description 4&lt;/Description&gt;
316         &lt;Description&gt;CC description 5&lt;/Description&gt;
317         &lt;SOPNode&gt;
318             &lt;Description&gt;Sop description 1&lt;/Description&gt;
319             &lt;Description&gt;Sop description 2&lt;/Description&gt;
320             &lt;Description&gt;Sop description 3&lt;/Description&gt;
321             &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
322             &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
323             &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
324         &lt;/SOPNode&gt;
325         &lt;SATNode&gt;
326             &lt;Description&gt;Sat description 1&lt;/Description&gt;
327             &lt;Description&gt;Sat description 2&lt;/Description&gt;
328             &lt;Saturation&gt;1.09&lt;/Saturation&gt;
329         &lt;/SATNode&gt;
330     &lt;/ColorCorrection&gt;
331     &lt;ColorCorrection id="f51.200"&gt;
332         &lt;SOPNode&gt;
333             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
334             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
335             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
336         &lt;/SOPNode&gt;
337         &lt;SATNode&gt;
338             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
339         &lt;/SATNode&gt;
340     &lt;/ColorCorrection&gt;
341     &lt;ColorCorrection id="f51.200"&gt;
342         &lt;SOPNode&gt;
343             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
344             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
345             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
346         &lt;/SOPNode&gt;
347         &lt;SATNode&gt;
348             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
349         &lt;/SATNode&gt;
350     &lt;/ColorCorrection&gt;
351     &lt;ColorCorrection id="f55.100"&gt;
352         &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
353         &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
354         &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
355         &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
356         &lt;SOPNode&gt;
357             &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
358             &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
359             &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
360             &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
361         &lt;/SOPNode&gt;
362         &lt;SATNode&gt;
363             &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
364         &lt;/SATNode&gt;
365     &lt;/ColorCorrection&gt;
366     &lt;ColorCorrection id="f54.112"&gt;
367         &lt;SOPNode&gt;
368             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
369             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
370             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
371         &lt;/SOPNode&gt;
372         &lt;SATNode&gt;
373             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
374         &lt;/SATNode&gt;
375     &lt;/ColorCorrection&gt;
376     &lt;ColorCorrection id="burp_100.x12"&gt;
377         &lt;SOPNode&gt;
378             &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
379             &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
380             &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
381         &lt;/SOPNode&gt;
382         &lt;SATNode&gt;
383             &lt;Saturation&gt;1.09&lt;/Saturation&gt;
384         &lt;/SATNode&gt;
385     &lt;/ColorCorrection&gt;
386     &lt;ColorCorrection id="f54.112"&gt;
387         &lt;SOPNode&gt;
388             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
389             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
390             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
391         &lt;/SOPNode&gt;
392         &lt;SATNode&gt;
393             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
394         &lt;/SATNode&gt;
395     &lt;/ColorCorrection&gt;
396 &lt;/ColorCorrectionCollection&gt;
397 """
398 CDL_ODD_WRITE = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
399 &lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;
400     &lt;Description&gt;CDL description 1&lt;/Description&gt;
401     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
402     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
403     &lt;ColorDecision&gt;
404         &lt;MediaRef ref="C:\\Windows\File\Path"/&gt;
405         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
406             &lt;SOPNode&gt;
407                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
408                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
409                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
410                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
411                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
412                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
413             &lt;/SOPNode&gt;
414         &lt;/ColorCorrection&gt;
415     &lt;/ColorDecision&gt;
416     &lt;ColorDecision&gt;
417         &lt;MediaRef ref="relative\windows\path"/&gt;
418         &lt;ColorCorrection id="f51.200"&gt;
419             &lt;SOPNode&gt;
420                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
421                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
422                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
423             &lt;/SOPNode&gt;
424         &lt;/ColorCorrection&gt;
425     &lt;/ColorDecision&gt;
426     &lt;ColorDecision&gt;
427         &lt;Description&gt;CD description 1&lt;/Description&gt;
428         &lt;MediaRef ref="./sameDirectory/loser.####.fbx"/&gt;
429         &lt;ColorCorrectionRef ref="014_xf_seqGrade_v01"/&gt;
430     &lt;/ColorDecision&gt;
431     &lt;ColorDecision&gt;
432         &lt;MediaRef ref="../lateralDirectory/file.lives.here.0120.dpx"/&gt;
433         &lt;ColorCorrectionRef ref="missingRef"/&gt;
434     &lt;/ColorDecision&gt;
435     &lt;ColorDecision&gt;
436         &lt;MediaRef ref="http://www.google.com/logo.jpg"/&gt;
437         &lt;ColorCorrectionRef ref="alsoMissingRef"/&gt;
438     &lt;/ColorDecision&gt;
439     &lt;ColorDecision&gt;
440         &lt;MediaRef ref="serv://proto/uri:area:full?query=result#fragment"/&gt;
441         &lt;ColorCorrection id="burp_200.x15"&gt;
442             &lt;SATNode&gt;
443                 &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
444                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
445             &lt;/SATNode&gt;
446         &lt;/ColorCorrection&gt;
447     &lt;/ColorDecision&gt;
448     &lt;ColorDecision&gt;
449         &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
450         &lt;MediaRef ref="..\.\..\..\..\This\should\not\be\legal\"/&gt;
451         &lt;ColorCorrectionRef ref="f51.200"/&gt;
452     &lt;/ColorDecision&gt;
453 &lt;/ColorDecisionList&gt;
454 """
455 CDL_ODD_WRITE_RESOLVED = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
456 &lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;
457     &lt;Description&gt;CDL description 1&lt;/Description&gt;
458     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
459     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
460     &lt;ColorDecision&gt;
461         &lt;MediaRef ref="C:\\Windows\File\Path"/&gt;
462         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
463             &lt;SOPNode&gt;
464                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
465                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
466                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
467                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
468                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
469                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
470             &lt;/SOPNode&gt;
471         &lt;/ColorCorrection&gt;
472     &lt;/ColorDecision&gt;
473     &lt;ColorDecision&gt;
474         &lt;MediaRef ref="relative\windows\path"/&gt;
475         &lt;ColorCorrection id="f51.200"&gt;
476             &lt;SOPNode&gt;
477                 &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
478                 &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
479                 &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
480             &lt;/SOPNode&gt;
481         &lt;/ColorCorrection&gt;
482     &lt;/ColorDecision&gt;
483     &lt;ColorDecision&gt;
484         &lt;Description&gt;CD description 1&lt;/Description&gt;
485         &lt;MediaRef ref="./sameDirectory/loser.####.fbx"/&gt;
486         &lt;ColorCorrectionRef ref="014_xf_seqGrade_v01"/&gt;
487     &lt;/ColorDecision&gt;
488     &lt;ColorDecision&gt;
489         &lt;MediaRef ref="../lateralDirectory/file.lives.here.0120.dpx"/&gt;
490         &lt;ColorCorrection id="missingRef"&gt;
491             &lt;SOPNode&gt;
492                 &lt;Slope&gt;1.0 2.0 1.0&lt;/Slope&gt;
493                 &lt;Offset&gt;0.0 0.0 0.0&lt;/Offset&gt;
494                 &lt;Power&gt;1.0 1.0 1.0&lt;/Power&gt;
495             &lt;/SOPNode&gt;
496         &lt;/ColorCorrection&gt;
497     &lt;/ColorDecision&gt;
498     &lt;ColorDecision&gt;
499         &lt;MediaRef ref="http://www.google.com/logo.jpg"/&gt;
500         &lt;ColorCorrectionRef ref="alsoMissingRef"/&gt;
501     &lt;/ColorDecision&gt;
502     &lt;ColorDecision&gt;
503         &lt;MediaRef ref="serv://proto/uri:area:full?query=result#fragment"/&gt;
504         &lt;ColorCorrection id="burp_200.x15"&gt;
505             &lt;SATNode&gt;
506                 &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
507                 &lt;Saturation&gt;1.01&lt;/Saturation&gt;
508             &lt;/SATNode&gt;
509         &lt;/ColorCorrection&gt;
510     &lt;/ColorDecision&gt;
511     &lt;ColorDecision&gt;
512         &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
513         &lt;MediaRef ref="..\.\..\..\..\This\should\not\be\legal\"/&gt;
514         &lt;ColorCorrectionRef ref="f51.200"/&gt;
515     &lt;/ColorDecision&gt;
516 &lt;/ColorDecisionList&gt;
517 """
518 CDL_ODD_WRITE_CCC = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
519 &lt;ColorCorrectionCollection xmlns="urn:ASC:CDL:v1.01"&gt;
520     &lt;Description&gt;CDL description 1&lt;/Description&gt;
521     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
522     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
523     &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
524         &lt;SOPNode&gt;
525             &lt;Description&gt;Sop description 1&lt;/Description&gt;
526             &lt;Description&gt;Sop description 2&lt;/Description&gt;
527             &lt;Description&gt;Sop description 3&lt;/Description&gt;
528             &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
529             &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
530             &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
531         &lt;/SOPNode&gt;
532     &lt;/ColorCorrection&gt;
533     &lt;ColorCorrection id="f51.200"&gt;
534         &lt;SOPNode&gt;
535             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
536             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
537             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
538         &lt;/SOPNode&gt;
539     &lt;/ColorCorrection&gt;
540     &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
541         &lt;SOPNode&gt;
542             &lt;Description&gt;Sop description 1&lt;/Description&gt;
543             &lt;Description&gt;Sop description 2&lt;/Description&gt;
544             &lt;Description&gt;Sop description 3&lt;/Description&gt;
545             &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
546             &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
547             &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
548         &lt;/SOPNode&gt;
549     &lt;/ColorCorrection&gt;
550     &lt;ColorCorrection id="burp_200.x15"&gt;
551         &lt;SATNode&gt;
552             &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
553             &lt;Saturation&gt;1.01&lt;/Saturation&gt;
554         &lt;/SATNode&gt;
555     &lt;/ColorCorrection&gt;
556     &lt;ColorCorrection id="f51.200"&gt;
557         &lt;SOPNode&gt;
558             &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
559             &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
560             &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
561         &lt;/SOPNode&gt;
562     &lt;/ColorCorrection&gt;
563 &lt;/ColorCorrectionCollection&gt;
564 """
565 CDL_BAD_TAG = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
566 &lt;ColorDecisionBlist xmlns="urn:ASC:CDL:v1.01"&gt;
567     &lt;Description&gt;CCC description 1&lt;/Description&gt;
568     &lt;Description&gt;Raised1 saturation a little!?! ag... \/Offset&lt;/Description&gt;
569     &lt;Description&gt;Raised2 saturation a little!?! ag... \/Offset&lt;/Description&gt;
570     &lt;ColorDecision&gt;
571         &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
572             &lt;SOPNode&gt;
573                 &lt;Description&gt;Sop description 1&lt;/Description&gt;
574                 &lt;Description&gt;Sop description 2&lt;/Description&gt;
575                 &lt;Description&gt;Sop description 3&lt;/Description&gt;
576                 &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
577                 &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
578                 &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
579             &lt;/SOPNode&gt;
580         &lt;/ColorCorrection&gt;
581     &lt;/ColorDecision&gt;
582 &lt;/ColorDecisionBlist&gt;
583 """
584 LOWER =</b></font> 'abcdefghijklmnopqrstuvwxyz'
585 <font color="#151b8d"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>if sys.version_info[0] &gt;= 3:
586     enc = lambda x: bytes(x, 'UTF-8')
587 else:
588     enc = lambda x: x
589 if sys.version_info[0] &gt;= 3:
590     builtins = 'builtins'
591 else:
592     builtins = '__builtin__'
593 class TestParseCDLFull(unittest.TestCase):
594     def setUp(self):
595         self.desc = [
596             'CDL description 1'</b></font>,
597             'CDL description 2',
598             'CDL description 3',
599             'CDL description 4',
600             'CDL description 5'
601         ]
602         self.input_desc = 'CDL Input Desc Text'
603         self.viewing_desc = 'CDL Viewing Desc Text'
604         self.color_correction_ids = [
605             '014_xf_seqGrade_v01',
606             'f51.200',
607             'f51.200',
608             'f55.100',
609             'f54.112',
610             'burp_100.x12',
611         ]
612         self.media_ref_refs = [
613             <font color="#2981b2"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>"/best/path/ever.dpx",
614             None,
615             "relative/path/13.jpg",
616             None,
617             None,
618             None,
619             None,
620         ]
621         self.color_decision_descs = [
622             ['CD description 1', 'CD description 2', 'CD description 3'],
623             [],
624             [],
625             [],
626             ['CD description 1', 'CD description 2'],
627             [],
628             [],
629         ]
630         self.color_decision_input_descs = [
631             'CD Input Desc Text',
632             None,
633             None,
634             None,
635             'CD Input Desc Text 2',
636             None,
637             None,
638         ]
639         self.color_decision_viewing_descs = [
640             'CD WOOD VIEWER!? ////',
641             None,
642             None,
643             None,
644             None,
645             None,
646             '12345'
647         ]
648         self.</b></font>color_decision_is_ref = [
649             False,
650             False,
651             True,
652             False,
653             False,
654             False,
655             True,
656         <font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
657             f.write(enc(CDL_FULL))
658             self.filename = f.name
659         self.node = cdl_convert.parse_cdl(self.filename)
660     def tearDown(self):
661         os.remove(self.filename)
662         cdl_convert.reset_all()
663     def test_file_in(self):
664         self.assertEqual(
665             self.filename,
666             self.node.file_in
667         )
668     def test_type(self):
669         self.assertEqual(
670             'cdl',
671             self.node.</b></font><font color="#6cc417"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>type
672         )
673     def test_descs(self):
674         self.assertEqual(
675             self.desc,
676             self.node.desc
677         )
678     def test_viewing_desc(self):
679         self.assertEqual(
680             self.viewing_desc,
681             self.node.viewing_desc
682         )
683     def test_input_desc(self):
684         self.assertEqual(
685             self.input_desc,
686             self.node.input_desc
687         )
688     def</b></font> test_parse_cc_results(self):
689         id_list = [i.cc.id for i in self.node.color_decisions]
690         self.assertEqual(
691             self.color_correction_ids,
692             id_list
693         )
694     def test_media_ref_refs(self):
695         ref_list = [
696             i.media_ref.ref if i.media_ref else None for i in self.node.color_decisions
697         ]
698         self.assertEqual(
699             self.media_ref_refs,
700             ref_list
701         )
702     def test_color_decision_descs(self):
703         desc_list = [
704             i.desc for i in self.node.color_decisions
705         ]
706         self.assertEqual(
707             self.color_decision_descs,
708             desc_list
709         )
710     def test_color_decision_input_descs(self):
711         desc_list = [
712             i.input_desc for i in self.node.color_decisions
713         ]
714         self.assertEqual(
715             self.color_decision_input_descs,
716             desc_list
717         )
718     def test_color_decision_viewing_descs(self):
719         desc_list = [
720             i.viewing_desc for i in self.node.color_decisions
721         ]
722         self.assertEqual(
723             self.color_decision_viewing_descs,
724             desc_list
725         )
726     def test_color_decision_is_ref(self):
727         ref_list = [
728             i.is_ref for i in self.node.color_decisions
729         ]
730         self.assertEqual(
731             self.color_decision_is_ref,
732             ref_list
733         )
734 class TestParseCDLOdd(TestParseCDLFull):
735     def setUp(self):
736         self.desc = [
737             'CDL description 1',
738             'Raised1 saturation a little!?! ag... \/Offset',
739             'Raised2 saturation a little!?! ag... \/Offset',
740         ]
741         self.input_desc = None
742         self.viewing_desc = None
743         self.color_correction_ids = [
744             '014_xf_seqGrade_v01',
745             'f51.200',
746             '014_xf_seqGrade_v01',
747             'missingRef',
748             'alsoMissingRef',
749             'burp_200.x15',
750             'f51.200'
751         ]
752         self.media_ref_refs = [
753             "C:\\\\Windows\\File\\Path",
754             "relative\\windows\\path",
755             "./sameDirectory/loser.####.fbx",
756             "../lateralDirectory/file.lives.here.0120.dpx",
757             "http://www.google.com/logo.jpg",
758             "serv://proto/uri:area:full?query=result#fragment",
759             "..\\.\\..\\..\\..\\This\\should\\not\\be\\legal\\"
760         ]
761         self.color_decision_descs = [
762             [],
763             [],
764             ['CD description 1'],
765             [],
766             [],
767             [],
768             ['Raised2 saturation a little!?! ag... \/Offset']
769         ]
770         self.color_decision_input_descs = [
771             None,
772             None,
773             None,
774             None,
775             None,
776             None,
777             None,
778         ]
779         self.color_decision_viewing_descs = [
780             None,
781             None,
782             None,
783             None,
784             None,
785             None,
786             None,
787         ]
788         self.color_decision_is_ref = [
789             False,
790             False,
791             True,
792             True,
793             True,
794             False,
795             True,
796         <font color="#38a4a5"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
797             f.write(enc(CDL_ODD))
798             self.filename = f.name
799         self.node = cdl_convert.parse_cdl(self.filename)
800 class</b></font> TestParseCDLExceptions(unittest.TestCase):
801     def setUp(self):
802         self.filename = None
803         if self.filename:
804             os.remove(self.filename)
805         cdl_convert.reset_all(<font color="#f52887"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>)
806     def testBadTag(self):
807         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
808             f.write(enc(CDL_BAD_TAG))
809             self.filename = f.name
810             ValueError,
811             cdl_convert.parse_cdl,
812             self<font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.filename,
813         )
814     def testEmptyCDL(self):
815         emptyCDL = ('&lt;?xml version="1.0" encoding="UTF-8"?&gt;\n'
816                     '&lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;\n'
817                     '&lt;/ColorDecisionList&gt;')
818         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
819             f.write(enc(emptyCDL))
820             self.filename = f.name
821         self.assertRaises(
822             ValueError,
823             cdl_convert.parse_cdl,
824             self.filename,
825         )
826     def testEmptyCD(self):
827         emptyCDL = ('&lt;?xml version="1.0" encoding="UTF-8"?&gt;\n'
828                     '&lt;ColorDecisionList xmlns="urn:ASC:CDL:v1.01"&gt;\n'
829                     '\t&lt;ColorDecision&gt;\n'
830                     '\t\t&lt;MediaRef ref="bestref.dpx"/&gt;\n'
831                     '\t&lt;/ColorDecision&gt;\n'
832                     '&lt;/ColorDecisionList&gt;')
833         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
834             f.write(enc(emptyCDL))
835             self.filename = f.name
836         self.assertRaises(
837             ValueError,
838             cdl_convert.parse_cdl,
839             self.</b></font>filename,
840         )
841 class TestWriteCDLFull(unittest.TestCase):
842     def setUp(self):
843         <font color="#b041ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
844             f.write(enc(CDL_FULL))
845             self.filename = f.name
846         self.cdl = cdl_convert.parse_cdl(self.</b></font>filename)
847         self<font color="#3090c7"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.target_xml_root = enc(CDL_FULL_WRITE)
848         self.target_xml = enc('\n'.join(CDL_FULL_WRITE.split('\n')[</b></font>1:]))
849     def tearDown(self):
850         os.remove(self.filename)
851         cdl_convert<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.reset_all()
852     def test_root_xml(self):
853         self.assertEqual(
854             self.target_xml_root,
855             self.cdl.xml_root
856         )
857     def test_base_xml(self):
858         self.assertEqual(
859             self.target_xml,
860             self.cdl.xml
861         )
862     def test_element(self):
863         self.assertEqual(
864             'ColorDecisionList',
865             self.cdl.element.tag
866         )
867     def test_write(self):
868         mockOpen = mock.mock_open()
869         self.cdl._file_out = 'bobs_big_file.cdl'
870         with mock.patch(builtins + '.open', mockOpen, create=True):
871             cdl_convert.write_cdl(self.cdl)
872         mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')
873         mockOpen().write.assert_called_once_with(self.target_xml_root)
874 class TestWriteCDLFullAsCCC(TestWriteCDLFull):
875     def setUp(self):
876         <font color="#c58917"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
877             f.write(enc(CDL_FULL))
878             self.filename = f.name
879         self.cdl = cdl_convert.parse_cdl(self.filename)
880         self.cdl.</b></font>set_to_ccc()
881         self.target_xml_root = enc(CDL_FULL_WRITE_CCC)
882         self.target_xml = enc('\n'.join(CDL_FULL_WRITE_CCC.split('\n')[1:]))
883     def test_element(self):
884         self.assertEqual(
885             'ColorCorrectionCollection',
886             self.cdl.element.tag
887         )
888     def test_write(self):
889         mockOpen = mock.mock_open()
890         self.cdl._file_out = 'bobs_big_file.cdl'
891         with mock.patch(builtins + '.open', mockOpen, create=True):
892             cdl_convert.write_ccc(self.cdl)
893         mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')
894         mockOpen().write.assert_called_once_with(self.target_xml_root)
895 class TestWriteCDLOddAsCCC(TestWriteCDLFullAsCCC):
896     def setUp(self):
897         cdl_convert.reset_all<font color="#8c8774"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>()
898         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
899             f.write(enc(CDL_ODD))
900             self.filename = f.name
901         self.cdl.</b></font>set_to_ccc()
902         self<font color="#842dce"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.target_xml_root = enc(CDL_ODD_WRITE_CCC)
903         self.target_xml = enc('\n'.join(CDL_ODD_WRITE_CCC.split('\n')[1:]))
904 class TestWriteCDLOdd(TestWriteCDLFull):
905     def setUp(self):
906         cdl_convert.</b></font>reset_all<font color="#ad5910"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>()
907         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
908             f.write(enc(CDL_ODD))
909             self.filename = f.name
910         self.cdl = cdl_convert.parse_cdl(self.</b></font>filename)
911         self<font color="#3b9c9c"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.target_xml_root = enc(CDL_ODD_WRITE)
912         self.target_xml = enc('\n'.join(CDL_ODD_WRITE.split('\n')[1:]))
913 class TestWriteCDLOddReferenceFix(TestWriteCDLFull):
914     def setUp(self):
915         cdl_convert.</b></font>reset_all<font color="#83a33a"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>()
916         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
917             f.write(enc(CDL_ODD))
918             self.filename = f.name
919         self.cdl = cdl_convert.parse_cdl(self.</b></font>filename)
920         cc = cdl_convert.ColorCorrection("missingRef")
921         cc<font color="#571b7e"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.slope = [1.0, 2.0, 1.0]
922         self.target_xml_root = enc(CDL_ODD_WRITE_RESOLVED)
923         self.target_xml = enc('\n'.join(CDL_ODD_WRITE_RESOLVED.split('\n')[1:]))
924     def</b></font> testMissingRef(self):
925         cdl_convert.config.HALT_ON_ERROR = True
926         mockOpen = mock.mock_open()
927         self.cdl._file_out = 'bobs_big_file.cdl'
928         with mock.patch(builtins + '.open', mockOpen, create=True):
929             cdl_convert.write_cdl(self.cdl)
930         mockOpen.assert_called_once_with('bobs_big_file.cdl', 'wb')
931         mockOpen().write.assert_called_once_with(self.target_xml_root)
932         cdl_convert.config.HALT_ON_ERROR = False
933 if __name__ == '__main__':
934     unittest.main()
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_cc.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from decimal import Decimal
2 <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>try:
3     from unittest import mock
4 except ImportError:
5     import mock
6 import os
7 import sys
8 import tempfile
9 import unittest
10 from xml.etree import ElementTree
11 sys.path.append('/'.join(os.path.realpath(__file__).split('/')[:-2]))
12 import cdl_convert
13 CC_FULL = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
14 &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
15     &lt;Description&gt;CC description 1&lt;/Description&gt;
16     &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
17     &lt;Description&gt;CC description 2&lt;/Description&gt;
18     &lt;SOPNode&gt;
19         &lt;Description&gt;Sop description 1&lt;/Description&gt;
20         &lt;Description&gt;Sop description 2&lt;/Description&gt;
21         &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
22         &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
23         &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
24         &lt;Description&gt;Sop description 3&lt;/Description&gt;
25     &lt;/SOPNode&gt;
26     &lt;Description&gt;CC description 3&lt;/Description&gt;
27     &lt;SATNode&gt;
28         &lt;Description&gt;Sat description 1&lt;/Description&gt;
29         &lt;Saturation&gt;1.09&lt;/Saturation&gt;
30         &lt;Description&gt;Sat description 2&lt;/Description&gt;
31     &lt;/SATNode&gt;
32     &lt;Description&gt;CC description 4&lt;/Description&gt;
33     &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
34     &lt;Description&gt;CC description 5&lt;/Description&gt;
35 &lt;/ColorCorrection&gt;
36 """
37 CC_BASIC = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
38 &lt;ColorCorrection id="f51.200"&gt;
39     &lt;SopNode&gt;
40         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
41         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
42         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
43     &lt;/SopNode&gt;
44     &lt;SatNode&gt;
45         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
46     &lt;/SatNode&gt;
47 &lt;/ColorCorrection&gt;
48 """
49 CC_ODD = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
50 &lt;ColorCorrection id="f55.100\\\\\//////"&gt;
51     &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
52     &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
53     &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
54     &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
55     &lt;SopNode&gt;
56         &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
57         &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
58         &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
59         &lt;Power&gt;3271893.993 .0000998 0.0000000000000000113&lt;/Power&gt;
60     &lt;/SopNode&gt;
61     &lt;SatNode&gt;
62         &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
63     &lt;/SatNode&gt;
64 &lt;/ColorCorrection&gt;
65 """
66 CC_BASIC_ORDER = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
67 &lt;ColorCorrection id="f54.112"&gt;
68     &lt;ASC_SAT&gt;
69         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
70     &lt;/ASC_SAT&gt;
71     &lt;ASC_SOP&gt;
72         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
73         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
74         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
75     &lt;/ASC_SOP&gt;
76 &lt;/ColorCorrection&gt;
77 """
78 CC_BLANK_METADATA = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
79 &lt;ColorCorrection id="burp_100.x12"&gt;
80     &lt;ViewingDescription&gt;&lt;/ViewingDescription&gt;
81     &lt;Description&gt;&lt;/Description&gt;
82     &lt;SOPNode&gt;
83         &lt;Description&gt;&lt;/Description&gt;
84         &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
85         &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
86         &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
87     &lt;/SOPNode&gt;
88     &lt;Description&gt;&lt;/Description&gt;
89     &lt;InputDescription&gt;&lt;/InputDescription&gt;
90     &lt;SatNode&gt;
91         &lt;Saturation&gt;1.09&lt;/Saturation&gt;
92         &lt;Description&gt;&lt;/Description&gt;
93     &lt;/SatNode&gt;
94     &lt;Description&gt;&lt;/Description&gt;
95 &lt;/ColorCorrection&gt;
96 """
97 CC_NO_SOP = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
98 &lt;ColorCorrection id="burp_200.x15"&gt;
99     &lt;SatNode&gt;
100         &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
101         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
102     &lt;/SatNode&gt;
103 &lt;/ColorCorrection&gt;
104 """
105 CC_NO_SAT = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
106 &lt;ColorCorrection id="burp_300.x35"&gt;
107     &lt;SopNode&gt;
108         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
109         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
110         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
111     &lt;/SopNode&gt;
112 &lt;/ColorCorrection&gt;
113 """
114 CC_NO_ID = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
115 &lt;ColorCorrection&gt;
116     &lt;SopNode&gt;
117         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
118         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
119         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
120     &lt;/SopNode&gt;
121     &lt;SatNode&gt;
122         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
123     &lt;/SatNode&gt;
124 &lt;/ColorCorrection&gt;
125 """
126 CC_BLANK_ID = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
127 &lt;ColorCorrection id=""&gt;
128     &lt;SopNode&gt;
129         &lt;Slope&gt;0.2331 0.678669 1.0758&lt;/Slope&gt;
130         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
131         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
132     &lt;/SopNode&gt;
133     &lt;SatNode&gt;
134         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
135     &lt;/SatNode&gt;
136 &lt;/ColorCorrection&gt;
137 """
138 CC_NEGATIVE_SLOPE =</b></font> """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
139 &lt;ColorCorrection id="dsds"&gt;
140     &lt;SopNode&gt;
141         &lt;Slope&gt;-0.2331 0.678669 1.0758&lt;/Slope&gt;
142         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
143         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
144     &lt;/SopNode&gt;
145     &lt;SatNode&gt;
146         &lt;Saturation&gt;1.01&lt;/Saturation&gt;
147     &lt;/SatNode&gt;
148 &lt;/ColorCorrection&gt;
149 """
150 CC_FULL_WRITE = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
151 &lt;ColorCorrection id="014_xf_seqGrade_v01"&gt;
152     &lt;InputDescription&gt;Input Desc Text&lt;/InputDescription&gt;
153     &lt;ViewingDescription&gt;Viewing Desc Text&lt;/ViewingDescription&gt;
154     &lt;Description&gt;CC description 1&lt;/Description&gt;
155     &lt;Description&gt;CC description 2&lt;/Description&gt;
156     &lt;Description&gt;CC description 3&lt;/Description&gt;
157     &lt;Description&gt;CC description 4&lt;/Description&gt;
158     &lt;Description&gt;CC description 5&lt;/Description&gt;
159     &lt;SOPNode&gt;
160         &lt;Description&gt;Sop description 1&lt;/Description&gt;
161         &lt;Description&gt;Sop description 2&lt;/Description&gt;
162         &lt;Description&gt;Sop description 3&lt;/Description&gt;
163         &lt;Slope&gt;1.014 1.0104 0.62&lt;/Slope&gt;
164         &lt;Offset&gt;-0.00315 -0.00124 0.3103&lt;/Offset&gt;
165         &lt;Power&gt;1.0 0.9983 1.0&lt;/Power&gt;
166     &lt;/SOPNode&gt;
167     &lt;SATNode&gt;
168         &lt;Description&gt;Sat description 1&lt;/Description&gt;
169         &lt;Description&gt;Sat description 2&lt;/Description&gt;
170         &lt;Saturation&gt;1.09&lt;/Saturation&gt;
171     &lt;/SATNode&gt;
172 &lt;/ColorCorrection&gt;
173 """
174 CC_ODD_WRITE = r"""&lt;?xml version="1.0" encoding="UTF-8"?&gt;
175 &lt;ColorCorrection id="f55.100"&gt;
176     &lt;InputDescription&gt;METAL VIEWER!!! \/\/&lt;/InputDescription&gt;
177     &lt;ViewingDescription&gt;WOOD VIEWER!? ////&lt;/ViewingDescription&gt;
178     &lt;Description&gt;Raised saturation1 a little!?! ag... \/Offset&lt;/Description&gt;
179     &lt;Description&gt;Raised saturation2 a little!?! ag... \/Offset&lt;/Description&gt;
180     &lt;SOPNode&gt;
181         &lt;Description&gt;Raised saturation a little!?! ag... \/Offset&lt;/Description&gt;
182         &lt;Slope&gt;137829.329 4327890.9833 3489031.003&lt;/Slope&gt;
183         &lt;Offset&gt;-3424.011 -342789423.013 -4238923.11&lt;/Offset&gt;
184         &lt;Power&gt;3271893.993 0.0000998 0.0000000000000000113&lt;/Power&gt;
185     &lt;/SOPNode&gt;
186     &lt;SATNode&gt;
187         &lt;Saturation&gt;1798787.01&lt;/Saturation&gt;
188     &lt;/SATNode&gt;
189 &lt;/ColorCorrection&gt;
190 """
191 CC_NO_SOP_WRITE = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
192 &lt;ColorCorrection id="burp_200.x15"&gt;
193     &lt;SATNode&gt;
194         &lt;Description&gt;I am a lovely sat node&lt;/Description&gt;
195         &lt;Saturation&gt;1.0128109381&lt;/Saturation&gt;
196     &lt;/SATNode&gt;
197 &lt;/ColorCorrection&gt;
198 """
199 CC_NO_SAT_WRITE = """&lt;?xml version="1.0" encoding="UTF-8"?&gt;
200 &lt;ColorCorrection id="burp_300.x35"&gt;
201     &lt;SOPNode&gt;
202         &lt;Slope&gt;1.233321 0.678669 1.0758&lt;/Slope&gt;
203         &lt;Offset&gt;0.031 0.128 -0.096&lt;/Offset&gt;
204         &lt;Power&gt;1.8 0.97 0.961&lt;/Power&gt;
205     &lt;/SOPNode&gt;
206 &lt;/ColorCorrection&gt;
207 """
208 LOWER = 'abcdefghijklmnopqrstuvwxyz'
209 <font color="#151b8d"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>if sys.version_info[0] &gt;= 3:
210     enc = lambda x: bytes(x, 'UTF-8')
211 else:
212     enc = lambda x: x
213 if sys.version_info[0] &gt;= 3:
214     builtins = 'builtins'
215 else:
216     builtins = '__builtin__'
217 class TestParseCCBasic(unittest.TestCase):
218     def setUp(self):
219         self.id = "014_xf_seqGrade_v01"
220         self.</b></font>desc = [
221             'CC description 1', 'CC description 2', 'CC description 3',
222             'CC description 4', 'CC description 5'
223         ]
224         self.input_desc = 'Input Desc Text'
225         self.viewing_desc = 'Viewing Desc Text'
226         self.sop_node_desc = [
227             'Sop description 1', 'Sop description 2', 'Sop description 3'
228         ]
229         self.slope = decimalize(1.014, 1.0104, 0.62)
230         self.offset = decimalize(-0.00315, -0.00124, 0.3103)
231         self.power = decimalize(1.0, 0.9983, 1.0)
232         self.sat_node_desc = [
233             'Sat description 1', 'Sat description 2'
234         ]
235         <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
236             f.write(enc(CC_FULL))
237             self.filename = f.name
238         self.cdl = cdl_convert.parse_cc(self.filename)
239     def tearDown(self):
240         os.remove(self.filename)
241         cdl_convert.reset_all()
242     def testId(self):
243         self.assertEqual(
244             self.id,
245             self.cdl.id
246         )
247     def testDesc(self):
248         self.assertEqual(
249             self.desc,
250             self.</b></font>cdl.desc
251         )
252     def testInputDesc(self):
253         self.assertEqual(
254             self.input_desc,
255             self.cdl.input_desc
256         )
257     def testViewingDesc(self):
258         self.assertEqual(
259             self.viewing_desc,
260             self.cdl.viewing_desc
261         )
262     def testSopDesc(self):
263         self.assertEqual(
264             self.sop_node_desc,
265             self.cdl.sop_node.desc
266         )
267     def testSatDesc(self):
268         self.assertEqual(
269             self.sat_node_desc,
270             self.cdl.sat_node.<font color="#6cc417"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>desc
271         )
272     def testSlope(self):
273         self.assertEqual(
274             self.slope,
275             self.cdl.slope
276         )
277     def testOffset(self):
278         self.assertEqual(
279             self.offset,
280             self.cdl.offset
281         )
282     def testPower(self):
283         self.assertEqual(
284             self.power,
285             self.cdl.power
286         )
287     def</b></font> testSat(self):
288         self.assertEqual(
289             self.sat,
290             self.cdl.sat
291         )
292 class TestParseCCOdd(TestParseCCBasic):
293     def setUp(self):
294         self.id = "f55.100"  # This will have been _sanitized()
295         self.desc = [
296             'Raised saturation a little!?! ag... \/Offset',
297             'Raised saturation a little!?! ag... \/Offset',
298         ]
299         self.input_desc = 'METAL VIEWER!!! \/\/'
300         self.viewing_desc = 'WOOD VIEWER!? ////'
301         self.sop_node_desc = [
302             'Raised saturation a little!?! ag... \/Offset'
303         ]
304         self.slope = decimalize(137829.329, 4327890.9833, 3489031.003)
305         self.offset = decimalize(-3424.011, -342789423.013, -4238923.11)
306         self.power = decimalize(3271893.993, .0000998, 0.0000000000000000113)
307         self.sat_node_desc = []
308         <font color="#38a4a5"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
309             f.write(enc(CC_ODD))
310             self.filename = f.name
311         self.cdl = cdl_convert.parse_cc(self.filename)
312 class</b></font> TestParseCCBasic(TestParseCCBasic):
313     def setUp(self):
314         self.id = "f51.200"
315         self.desc = []
316         self.input_desc = None
317         self.viewing_desc = None
318         self.sop_node_desc = []
319         self.slope = decimalize(0.2331, 0.678669, 1.0758)
320         self.power = decimalize(1.8, 0.97, 0.961)
321         self.sat_node_desc = []
322         self.sat = Decimal<font color="#ad5910"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>('1.01')
323         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
324             f.write(enc(CC_BASIC))
325             self.filename = f.name
326         self.cdl = cdl_convert.parse_cc(self.</b></font>filename)
327 class TestParseCCBasicOrder(TestParseCCBasic):
328     def setUp(self):
329         self.id = "f54.112"
330         self.desc = []
331         self.input_desc = None
332         self.viewing_desc = None
333         self.sop_node_desc = []
334         self.slope = decimalize(0.2331, 0.678669, 1.0758)
335         self.power = decimalize(1.8, 0.97, 0.961)
336         self.sat_node_desc = []
337         self.sat = Decimal<font color="#83a33a"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>('1.01')
338         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
339             f.write(enc(CC_BASIC_ORDER))
340             self.filename = f.name
341         self.cdl = cdl_convert.parse_cc(self.</b></font>filename)
342 class TestParseCCBlankMetadata(TestParseCCBasic):
343     def setUp(self):
344         self.id = "burp_100.x12"
345         self.desc = []
346         self.input_desc = None
347         self.viewing_desc = None
348         self.sop_node_desc = []
349         self.slope = decimalize(1.014, 1.0104, 0.62)
350         self.offset = decimalize(-0.00315, -0.00124, 0.3103)
351         self.power = decimalize(1.0, 0.9983, 1.0)
352         self.sat_node_desc = []
353         <font color="#b041ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
354             f.write(enc(CC_BLANK_METADATA))
355             self.filename = f.name
356         self.cdl = cdl_convert.parse_cc(self.</b></font>filename)
357 class TestParseCCNoSop(TestParseCCBasic):
358     def setUp(self):
359         self.id = "burp_200.x15"
360         self.desc = []
361         self.input_desc = None
362         self.viewing_desc = None
363         self.sop_node_desc = []
364         self.slope = decimalize(1.0, 1.0, 1.0)
365         self.power = decimalize(1.0, 1.0, 1.0)
366         self.sat_node_desc = ['I am a lovely sat node']
367         self.sat = Decimal<font color="#8c8774"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>('1.01')
368         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
369             f.write(enc(CC_NO_SOP))
370             self.filename = f.name
371         self.cdl = cdl_convert.parse_cc(self.filename)
372         self.cdl.</b></font>slope
373 class TestParseCCNoSat(TestParseCCBasic):
374     def setUp(self):
375         self.id = "burp_300.x35"
376         self.desc = []
377         self.input_desc = None
378         self.viewing_desc = None
379         self.sop_node_desc = []
380         self.slope = decimalize(0.2331, 0.678669, 1.0758)
381         self.offset = decimalize(0.031, 0.128, -0.096)
382         self.power = decimalize(1.8, 0.97, 0.961)
383         self.sat_node_desc = []
384         <font color="#c58917"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
385             f.write(enc(CC_NO_SAT))
386             self.filename = f.name
387         self.cdl = cdl_convert.parse_cc(self.filename)
388         self.cdl.</b></font>sat
389 class TestParseCCExceptions(unittest.TestCase):
390     def setUp(self):
391         self.file = None
392     def tearDown(self):
393         cdl_convert.reset_all()
394         if self.file:
395             os.remove(self.file)
396     def testNoId(self):
397         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
398             f.write(enc(CC_NO_ID))
399             self.file = f.name
400         self.assertEqual(
401             '001',
402             cc<font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.id
403         )
404     def testNotColorCorrection(self):
405         xml = "&lt;ColorBlurection&gt;\n&lt;/ColorBlurection&gt;\n"
406         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
407             f.write(enc(xml))
408             self.file = f.name
409         self.assertRaises(
410             ValueError,
411             cdl_convert.parse_cc,
412             self.file
413         )
414     def testEmptyColorCorrection(self):
415         xml = '&lt;ColorCorrection id="hdjshd"&gt;\n&lt;/ColorCorrection&gt;\n'
416         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
417             f.write(enc(xml))
418             self.file = f.name
419         self.assertRaises(
420             ValueError,
421             cdl_convert.parse_cc,
422             self.</b></font>file
423         )
424     def testBlankId(self):
425         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
426             f.write(enc(CC_BLANK_ID))
427             self.file = f.name
428         cdl_convert.config.HALT_ON_ERROR = True
429         self.assertRaises(
430             ValueError,
431             cdl_convert.parse_cc,
432             self.file
433         )
434         cdl_convert.config.HALT_ON_ERROR = False
435         cdl = cdl_convert.parse_cc(self.file)
436         self.assertEqual(
437             '001',
438             cdl.<font color="#f52887"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>id
439         )
440     def testNegativeSlope(self):
441         with tempfile.NamedTemporaryFile(mode='wb', delete=False) as f:
442             f.write(enc(CC_NEGATIVE_SLOPE))
443             self.file = f.name
444         cdl_convert.</b></font>config.HALT_ON_ERROR = True
445         self.assertRaises(
446             ValueError,
447             cdl_convert.parse_cc,
448             self.file
449         )
450         cdl_convert.config.HALT_ON_ERROR = False
451         cdl_convert.reset_all()
452         cdl = cdl_convert.parse_cc(self.file)
453         self.assertEqual(
454             decimalize(0.0, 0.678669, 1.0758),
455             cdl.slope,
456         )
457 class TestWriteCCFull(unittest.TestCase):
458     def setUp(self):
459         cdl_convert.reset_all()
460         self.cdl = cdl_convert.ColorCorrection("014_xf_seqGrade_v01", '')
461         self.cdl.desc = [
462             'CC description 1', 'CC description 2', 'CC description 3',
463             'CC description 4', 'CC description 5'
464         ]
465         self.cdl.input_desc = 'Input Desc Text'
466         self.cdl.viewing_desc = 'Viewing Desc Text'
467         self.cdl.slope = (1.014, 1.0104, 0.62)
468         self.cdl.offset = (-0.00315, -0.00124, 0.3103)
469         self.cdl.power = (1.0, 0.9983, 1.0)
470         self.cdl.sop_node.desc = [
471             'Sop description 1', 'Sop description 2', 'Sop description 3'
472         self.cdl.sat = 1.09
473         self.cdl.sat_node<font color="#571b7e"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.desc = [
474             'Sat description 1', 'Sat description 2'
475         ]
476         self.target_xml_root = enc(CC_FULL_WRITE)
477         self.target_xml = enc('\n'.join(CC_FULL_WRITE.split('\n')[1:]))
478     def</b></font> tearDown(self):
479         cdl_convert<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.reset_all()
480     def test_root_xml(self):
481         self.assertEqual(
482             self.target_xml_root,
483             self.cdl.xml_root
484         )
485     def test_base_xml(self):
486         self.assertEqual(
487             self.target_xml,
488             self.cdl.xml
489         )
490     def test_element(self):
491         self.assertEqual(
492             'ColorCorrection',
493             self.cdl.element.tag
494         )
495     def test_write(self):
496         mockOpen = mock.mock_open()
497         self.cdl._file_out = 'bobs_big_file.cc'
498         with mock.patch(builtins + '.open', mockOpen, create=True):
499             cdl_convert.write_cc(self.cdl)
500         mockOpen.assert_called_once_with('bobs_big_file.cc', 'wb')
501         mockOpen().write.assert_called_once_with(self.target_xml_root)
502 class TestWriteCCOdd(TestWriteCCFull):
503     def setUp(self):
504         cdl_convert.reset_all(</b></font>)
505         self.cdl = cdl_convert.ColorCorrection("f55.100", '')
506         self.cdl.desc = [
507             'Raised saturation1 a little!?! ag... \/Offset',
508             'Raised saturation2 a little!?! ag... \/Offset',
509         ]
510         self.cdl.input_desc = 'METAL VIEWER!!! \/\/'
511         self.cdl.viewing_desc = 'WOOD VIEWER!? ////'
512         self.cdl.slope = (137829.329, 4327890.9833, 3489031.003)
513         self.cdl.offset = (-3424.011, -342789423.013, -4238923.11)
514         self<font color="#2981b2"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.cdl.power = (3271893.993, .0000998, 0.0000000000000000113)
515         self.cdl.sop_node.desc = [
516             'Raised saturation a little!?! ag... \/Offset'
517         ]
518         self.cdl.</b></font>sat_node.desc = []
519         self<font color="#842dce"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.target_xml_root = enc(CC_ODD_WRITE)
520         self.target_xml = enc('\n'.join(CC_ODD_WRITE.split('\n')[1:]))
521 class TestWriteCCNoSop(TestWriteCCFull):
522     def setUp(self):
523         cdl_convert.</b></font>reset_all()
524         self.cdl = cdl_convert.ColorCorrection("burp_200.x15", '')
525         self.cdl.sat_node.desc = ['I am a lovely sat node']
526         self<font color="#3b9c9c"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.target_xml_root = enc(CC_NO_SOP_WRITE)
527         self.target_xml = enc('\n'.join(CC_NO_SOP_WRITE.split('\n')[1:]))
528 class TestWriteCCNoSat(TestWriteCCFull):
529     def setUp(self):
530         cdl_convert.</b></font>reset_all()
531         self.cdl = cdl_convert.ColorCorrection("burp_300.x35", '')
532         self.cdl.slope = (1.233321, 0.678669, 1.0758)
533         self.cdl.power = (1.8, 0.97, 0.961)
534         self<font color="#3090c7"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.target_xml_root = enc(CC_NO_SAT_WRITE)
535         self.target_xml = enc('\n'.join(CC_NO_SAT_WRITE.split('\n')[</b></font>1:]))
536 def decimalize(*args):
537     return tuple([Decimal(str(i)) for i in args])
538 if __name__ == '__main__':
539     unittest.main()
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
