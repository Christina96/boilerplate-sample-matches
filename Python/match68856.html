<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for ign.py &amp; shahid.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for ign.py &amp; shahid.py
      </h3>
<h1 align="center">
        10.0%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>ign.py (10.384615%)<th>shahid.py (9.67742%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(90-95)<td><a href="#" name="0">(164-168)</a><td align="center"><font color="#ff0000">15</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(140-169)<td><a href="#" name="1">(54-83)</a><td align="center"><font color="#cc0000">12</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>ign.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from __future__ import unicode_literals
2 import re
3 from .common import InfoExtractor
4 from ..compat import (
5     compat_parse_qs,
6     compat_urllib_parse_urlparse,
7 )
8 from ..utils import (
9     HEADRequest,
10     determine_ext,
11     int_or_none,
12     parse_iso8601,
13     strip_or_none,
14     try_get,
15 )
16 class IGNBaseIE(InfoExtractor):
17     def _call_api(self, slug):
18         return self._download_json(
19             'http://apis.ign.com/{0}/v3/{0}s/slug/{1}'.format(self._PAGE_TYPE, slug), slug)
20 class IGNIE(IGNBaseIE):
21     _VALID_URL = r'https?://(?:.+?\.ign|www\.pcmag)\.com/videos/(?:\d{4}/\d{2}/\d{2}/)?(?P&lt;id&gt;[^/?&amp;#]+)'
22     IE_NAME = 'ign.com'
23     _PAGE_TYPE = 'video'
24     _TESTS = [{
25         'url': 'http://www.ign.com/videos/2013/06/05/the-last-of-us-review',
26         'md5': 'd2e1586d9987d40fad7867bf96a018ea',
27         'info_dict': {
28             'id': '8f862beef863986b2785559b9e1aa599',
29             'ext': 'mp4',
30             'title': 'The Last of Us Review',
31             'description': 'md5:c8946d4260a4d43a00d5ae8ed998870c',
32             'timestamp': 1370440800,
33             'upload_date': '20130605',
34             'tags': 'count:9',
35         }
36     }, {
37         'url': 'http://www.pcmag.com/videos/2015/01/06/010615-whats-new-now-is-gogo-snooping-on-your-data',
38         'md5': 'f1581a6fe8c5121be5b807684aeac3f6',
39         'info_dict': {
40             'id': 'ee10d774b508c9b8ec07e763b9125b91',
41             'ext': 'mp4',
42             'title': 'What\'s New Now: Is GoGo Snooping on Your Data?',
43             'description': 'md5:817a20299de610bd56f13175386da6fa',
44             'timestamp': 1420571160,
45             'upload_date': '20150106',
46             'tags': 'count:4',
47         }
48     }, {
49         'url': 'https://www.ign.com/videos/is-a-resident-evil-4-remake-on-the-way-ign-daily-fix',
50         'only_matching': True,
51     }]
52     def _real_extract(self, url):
53         display_id = self._match_id(url)
54         video = self._call_api(display_id)
55         video_id = video['videoId']
56         metadata = video['metadata']
57         title = metadata.get('longTitle') or metadata.get('title') or metadata['name']
58         formats = []
59         refs = video.get('refs') or {}
60         m3u8_url = refs.get('m3uUrl')
61         if m3u8_url:
62             formats.extend(self._extract_m3u8_formats(
63                 m3u8_url, video_id, 'mp4', 'm3u8_native',
64                 m3u8_id='hls', fatal=False))
65         f4m_url = refs.get('f4mUrl')
66         if f4m_url:
67             formats.extend(self._extract_f4m_formats(
68                 f4m_url, video_id, f4m_id='hds', fatal=False))
69         for asset in (video.get('assets') or []):
70 <a name="0"></a>            asset_url = asset.get('url')
71             if not asset_url:
72                 continue
73             formats<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.append({
74                 'url': asset_url,
75                 'tbr': int_or_none(asset.get('bitrate'), 1000),
76                 'fps': int_or_none(asset.get('frame_rate')),
77                 'height': int_or_none(asset.get('height')),
78                 'width': int_or_none(asset.get(</b></font>'width')),
79             })
80         mezzanine_url = try_get(video, lambda x: x['system']['mezzanineUrl'])
81         if mezzanine_url:
82             formats.append({
83                 'ext': determine_ext(mezzanine_url, 'mp4'),
84                 'format_id': 'mezzanine',
85                 'preference': 1,
86                 'url': mezzanine_url,
87             })
88         self._sort_formats(formats)
89         thumbnails = []
90         for thumbnail in (video.get('thumbnails') or []):
91             thumbnail_url = thumbnail.get('url')
92             if not thumbnail_url:
93                 continue
94             thumbnails.append({
95                 'url': thumbnail_url,
96             })
97         tags = []
98         for tag in (video.get('tags') or []):
99             display_name = tag.get('displayName')
100             if not display_name:
101                 continue
102             tags.append(display_name)
103         return {
104             'id': video_id,
105             'title': title,
106             'description': strip_or_none(metadata.get('description')),
107             'timestamp': parse_iso8601(metadata.get('publishDate')),
108             'duration': int_or_none(metadata.get('duration')),
109             'display_id': display_id,
110             'thumbnails': thumbnails,
111             'formats': formats,
112             'tags': tags,
113         }
114 <a name="1"></a>
115 class IGNVideoIE(InfoExtractor):
116     _VALID_URL = r'https?://.+?\.ign\.com/(?:[a-z]{2}/)?[^/]+/(?P&lt;id&gt;\d+)/(?:video|trailer)/'
117     _TESTS <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>= [{
118         'url': 'http://me.ign.com/en/videos/112203/video/how-hitman-aims-to-be-different-than-every-other-s',
119         'md5': 'dd9aca7ed2657c4e118d8b261e5e9de1',
120         'info_dict': {
121             'id': 'e9be7ea899a9bbfc0674accc22a36cc8',
122             'ext': 'mp4',
123             'title': 'How Hitman Aims to Be Different Than Every Other Stealth Game - NYCC 2015',
124             'description': 'Taking out assassination targets in Hitman has never been more stylish.',
125             'timestamp': 1444665600,
126             'upload_date': '20151012',
127         }
128     }, {
129         'url': 'http://me.ign.com/ar/angry-birds-2/106533/video/lrd-ldyy-lwl-lfylm-angry-birds',
130         'only_matching': True,
131     }, {
132         'url': 'https://me.ign.com/ar/ratchet-clank-rift-apart/144327/trailer/embed',
133         'only_matching': True,
134     }, {
135         'url': 'http://adria.ign.com/sherlock-season-4/9687/trailer/embed',
136         'only_matching': True,
137     }, {
138         'url': 'https://kr.ign.com/bic-2018/3307/trailer/embed',
139         'only_matching': True,
140     }]
141     def _real_extract(self, url):
142         video_id = self._match_id(</b></font>url)
143         req = HEADRequest(url.rsplit('/', 1)[0] + '/embed')
144         url = self._request_webpage(req, video_id).geturl()
145         ign_url = compat_parse_qs(
146             compat_urllib_parse_urlparse(url).query).get('url', [None])[0]
147         if ign_url:
148             return self.url_result(ign_url, IGNIE.ie_key())
149         return self.url_result(url)
150 class IGNArticleIE(IGNBaseIE):
151     _VALID_URL = r'https?://.+?\.ign\.com/(?:articles(?:/\d{4}/\d{2}/\d{2})?|(?:[a-z]{2}/)?feature/\d+)/(?P&lt;id&gt;[^/?&amp;#]+)'
152     _PAGE_TYPE = 'article'
153     _TESTS = [{
154         'url': 'http://me.ign.com/en/feature/15775/100-little-things-in-gta-5-that-will-blow-your-mind',
155         'info_dict': {
156             'id': '524497489e4e8ff5848ece34',
157             'title': '100 Little Things in GTA 5 That Will Blow Your Mind',
158         },
159         'playlist': [
160             {
161                 'info_dict': {
162                     'id': '5ebbd138523268b93c9141af17bec937',
163                     'ext': 'mp4',
164                     'title': 'GTA 5 Video Review',
165                     'description': 'Rockstar drops the mic on this generation of games. Watch our review of the masterly Grand Theft Auto V.',
166                     'timestamp': 1379339880,
167                     'upload_date': '20130916',
168                 },
169             },
170             {
171                 'info_dict': {
172                     'id': '638672ee848ae4ff108df2a296418ee2',
173                     'ext': 'mp4',
174                     'title': '26 Twisted Moments from GTA 5 in Slow Motion',
175                     'description': 'The twisted beauty of GTA 5 in stunning slow motion.',
176                     'timestamp': 1386878820,
177                     'upload_date': '20131212',
178                 },
179             },
180         ],
181         'params': {
182             'playlist_items': '2-3',
183             'skip_download': True,
184         },
185     }, {
186         'url': 'http://www.ign.com/articles/2014/08/15/rewind-theater-wild-trailer-gamescom-2014?watch',
187         'info_dict': {
188             'id': '53ee806780a81ec46e0790f8',
189             'title': 'Rewind Theater - Wild Trailer Gamescom 2014',
190         },
191         'playlist_count': 2,
192     }, {
193         'url': 'http://www.ign.com/articles/2017/06/08/new-ducktales-short-donalds-birthday-doesnt-go-as-planned',
194         'only_matching': True,
195     }, {
196         'url': 'https://www.ign.com/articles/2021-mvp-named-in-puppy-bowl-xvii',
197         'only_matching': True,
198     }, {
199         'url': 'https://www.ign.com/articles/2014/08/07/sons-of-anarchy-final-season-trailer',
200         'only_matching': True,
201     }, {
202         'url': 'https://www.ign.com/articles/2017/09/20/marvels-the-punisher-watch-the-new-trailer-for-the-netflix-series',
203         'only_matching': True,
204     }, {
205         'url': 'https://www.ign.com/articles/2016/01/16/supergirl-goes-flying-with-martian-manhunter-in-new-clip',
206         'only_matching': True,
207     }]
208     def _real_extract(self, url):
209         display_id = self._match_id(url)
210         article = self._call_api(display_id)
211         def entries():
212             media_url = try_get(article, lambda x: x['mediaRelations'][0]['media']['metadata']['url'])
213             if media_url:
214                 yield self.url_result(media_url, IGNIE.ie_key())
215             for content in (article.get('content') or []):
216                 for video_url in re.findall(r'(?:\[(?:ignvideo\s+url|youtube\s+clip_id)|&lt;iframe[^&gt;]+src)="([^"]+)"', content):
217                     yield self.url_result(video_url)
218         return self.playlist_result(
219             entries(), article.get('articleId'),
220             strip_or_none(try_get(article, lambda x: x['metadata']['headline'])))
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>shahid.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from __future__ import unicode_literals
2 import json
3 import math
4 import re
5 from .aws import AWSIE
6 from ..compat import compat_HTTPError
7 from ..utils import (
8     clean_html,
9     ExtractorError,
10     InAdvancePagedList,
11     int_or_none,
12     parse_iso8601,
13     str_or_none,
14     urlencode_postdata,
15 )
16 class ShahidBaseIE(AWSIE):
17     _AWS_PROXY_HOST = 'api2.shahid.net'
18     _AWS_API_KEY = '2RRtuMHx95aNI1Kvtn2rChEuwsCogUd4samGPjLh'
19     _VALID_URL_BASE = r'https?://shahid\.mbc\.net/[a-z]{2}/'
20     def _handle_error(self, e):
21         fail_data = self._parse_json(
22             e.cause.read().decode('utf-8'), None, fatal=False)
23         if fail_data:
24             faults = fail_data.get('faults', [])
25             faults_message = ', '.join([clean_html(fault['userMessage']) for fault in faults if fault.get('userMessage')])
26             if faults_message:
27                 raise ExtractorError(faults_message, expected=True)
28     def _call_api(self, path, video_id, request=None):
29         query = {}
30         if request:
31             query['request'] = json.dumps(request)
32         try:
33             return self._aws_execute_api({
34                 'uri': '/proxy/v2/' + path,
35                 'access_key': 'AKIAI6X4TYCIXM2B7MUQ',
36                 'secret_key': '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',
37             }, video_id, query)
38         except ExtractorError as e:
39             if isinstance(e.cause, compat_HTTPError):
40                 self._handle_error(e)
41             raise
42 <a name="1"></a>class ShahidIE(ShahidBaseIE):
43     _NETRC_MACHINE = 'shahid'
44     _VALID_URL = ShahidBaseIE._VALID_URL_BASE + r'(?:serie|show|movie)s/[^/]+/(?P&lt;type&gt;episode|clip|movie)-(?P&lt;id&gt;\d+)'
45     _TESTS <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>= [{
46         'url': 'https://shahid.mbc.net/ar/shows/%D9%85%D8%AA%D8%AD%D9%81-%D8%A7%D9%84%D8%AF%D8%AD%D9%8A%D8%AD-%D8%A7%D9%84%D9%85%D9%88%D8%B3%D9%85-1-%D9%83%D9%84%D9%8A%D8%A8-1/clip-816924',
47         'info_dict': {
48             'id': '816924',
49             'ext': 'mp4',
50             'title': 'متحف الدحيح الموسم 1 كليب 1',
51             'timestamp': 1602806400,
52             'upload_date': '20201016',
53             'description': 'برومو',
54             'duration': 22,
55             'categories': ['كوميديا'],
56         },
57         'params': {
58             'skip_download': True,
59         }
60     }, {
61         'url': 'https://shahid.mbc.net/ar/movies/%D8%A7%D9%84%D9%82%D9%86%D8%A7%D8%B5%D8%A9/movie-151746',
62         'only_matching': True
63     }, {
64         'url': 'https://shahid.mbc.net/ar/series/%D9%85%D8%B1%D8%A7%D9%8A%D8%A7-2011-%D8%A7%D9%84%D9%85%D9%88%D8%B3%D9%85-1-%D8%A7%D9%84%D8%AD%D9%84%D9%82%D8%A9-1/episode-90511',
65         'only_matching': True
66     }, {
67         'url': 'https://shahid.mbc.net/en/shows/Ramez-Fi-Al-Shallal-season-1-episode-1/episode-359319',
68         'only_matching': True
69     }]
70     def _real_initialize(self):
71         email, password = self._get_login_info(</b></font>)
72         if email is None:
73             return
74         try:
75             user_data = self._download_json(
76                 'https://shahid.mbc.net/wd/service/users/login',
77                 None, 'Logging in', data=json.dumps({
78                     'email': email,
79                     'password': password,
80                     'basic': 'false',
81                 }).encode('utf-8'), headers={
82                     'Content-Type': 'application/json; charset=UTF-8',
83                 })['user']
84         except ExtractorError as e:
85             if isinstance(e.cause, compat_HTTPError):
86                 self._handle_error(e)
87             raise
88         self._download_webpage(
89             'https://shahid.mbc.net/populateContext',
90             None, 'Populate Context', data=urlencode_postdata({
91                 'firstName': user_data['firstName'],
92                 'lastName': user_data['lastName'],
93                 'userName': user_data['email'],
94                 'csg_user_name': user_data['email'],
95                 'subscriberId': user_data['id'],
96                 'sessionId': user_data['sessionId'],
97             }))
98     def _real_extract(self, url):
99         page_type, video_id = re.match(self._VALID_URL, url).groups()
100         if page_type == 'clip':
101             page_type = 'episode'
102         playout = self._call_api(
103             'playout/new/url/' + video_id, video_id)['playout']
104         if playout.get('drm'):
105             raise ExtractorError('This video is DRM protected.', expected=True)
106         formats = self._extract_m3u8_formats(re.sub(
107             r'aws\.manifestfilter=[\w:;,-]+&amp;?',
108             '', playout['url']), video_id, 'mp4')
109         self._sort_formats(formats)
110         response = self._download_json(
111             'http://api.shahid.net/api/v1_1/%s/%s' % (page_type, video_id),
112             video_id, 'Downloading video JSON', query={
113                 'apiKey': 'sh@hid0nlin3',
114                 'hash': 'b2wMCTHpSmyxGqQjJFOycRmLSex+BpTK/ooxy6vHaqs=',
115             })
116         data = response.get('data', {})
117         error = data.get('error')
118         if error:
119             raise ExtractorError(
120                 '%s returned error: %s' % (self.IE_NAME, '\n'.join(error.values())),
121                 expected=True)
122         video = data[page_type]
123         title = video['title']
124         categories = [
125             category['name']
126             for category in video.get('genres', []) if 'name' in category]
127         return {
128             'id': video_id,
129             'title': title,
130             'description': video.get('description'),
131             'thumbnail': video.get('thumbnailUrl'),
132 <a name="0"></a>            'duration': int_or_none(video.get('duration')),
133             'timestamp': parse_iso8601(video.get('referenceDate')),
134             'categories': categories,
135             'series': video<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.get('showTitle') or video.get('showName'),
136             'season': video.get('seasonTitle'),
137             'season_number': int_or_none(video.get('seasonNumber')),
138             'season_id': str_or_none(video.get('seasonId')),
139             'episode_number': int_or_none(video.get(</b></font>'number')),
140             'episode_id': video_id,
141             'formats': formats,
142         }
143 class ShahidShowIE(ShahidBaseIE):
144     _VALID_URL = ShahidBaseIE._VALID_URL_BASE + r'(?:show|serie)s/[^/]+/(?:show|series)-(?P&lt;id&gt;\d+)'
145     _TESTS = [{
146         'url': 'https://shahid.mbc.net/ar/shows/%D8%B1%D8%A7%D9%85%D8%B2-%D9%82%D8%B1%D8%B4-%D8%A7%D9%84%D8%A8%D8%AD%D8%B1/show-79187',
147         'info_dict': {
148             'id': '79187',
149             'title': 'رامز قرش البحر',
150             'description': 'md5:c88fa7e0f02b0abd39d417aee0d046ff',
151         },
152         'playlist_mincount': 32,
153     }, {
154         'url': 'https://shahid.mbc.net/ar/series/How-to-live-Longer-(The-Big-Think)/series-291861',
155         'only_matching': True
156     }]
157     _PAGE_SIZE = 30
158     def _real_extract(self, url):
159         show_id = self._match_id(url)
160         product = self._call_api(
161             'playableAsset', show_id, {'showId': show_id})['productModel']
162         playlist = product['playlist']
163         playlist_id = playlist['id']
164         show = product.get('show', {})
165         def page_func(page_num):
166             playlist = self._call_api(
167                 'product/playlist', show_id, {
168                     'playListId': playlist_id,
169                     'pageNumber': page_num,
170                     'pageSize': 30,
171                     'sorts': [{
172                         'order': 'DESC',
173                         'type': 'SORTDATE'
174                     }],
175                 })
176             for product in playlist.get('productList', {}).get('products', []):
177                 product_url = product.get('productUrl', []).get('url')
178                 if not product_url:
179                     continue
180                 yield self.url_result(
181                     product_url, 'Shahid',
182                     str_or_none(product.get('id')),
183                     product.get('title'))
184         entries = InAdvancePagedList(
185             page_func,
186             math.ceil(playlist['count'] / self._PAGE_SIZE),
187             self._PAGE_SIZE)
188         return self.playlist_result(
189             entries, show_id, show.get('title'), show.get('description'))
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
