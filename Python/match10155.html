<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for test_gml.py &amp; plot_subgraphs.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for test_gml.py &amp; plot_subgraphs.py
      </h3>
<h1 align="center">
        2.7%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>test_gml.py (1.8205462%)<th>plot_subgraphs.py (5.62249%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(260-265)<td><a href="#" name="0">(53-59)</a><td align="center"><font color="#ff0000">14</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_gml.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from ast import literal_eval
2 import codecs
3 from contextlib import contextmanager
4 import io
5 import math
6 import pytest
7 import networkx as nx
8 from networkx.readwrite.gml import literal_stringizer, literal_destringizer
9 import os
10 import tempfile
11 from textwrap import dedent
12 class TestGraph:
13     @classmethod
14     def setup_class(cls):
15         cls.simple_data = """Creator "me"
16 Version "xx"
17 graph [
18  comment "This is a sample graph"
19  directed 1
20  IsPlanar 1
21  pos  [ x 0 y 1 ]
22  node [
23    id 1
24    label "Node 1"
25    pos [ x 1 y 1 ]
26  ]
27  node [
28     id 2
29     pos [ x 1 y 2 ]
30     label "Node 2"
31     ]
32   node [
33     id 3
34     label "Node 3"
35     pos [ x 1 y 3 ]
36   ]
37   edge [
38     source 1
39     target 2
40     label "Edge from node 1 to node 2"
41     color [line "blue" thickness 3]
42   ]
43   edge [
44     source 2
45     target 3
46     label "Edge from node 2 to node 3"
47   ]
48   edge [
49     source 3
50     target 1
51     label "Edge from node 3 to node 1"
52   ]
53 ]
54         nx.parse_gml(cytoscape_example)
55     def test_parse_gml(self):
56         G = nx.parse_gml(self.simple_data, label="label")
57         assert sorted(G.nodes()) == ["Node 1", "Node 2", "Node 3"]
58         assert [e for e in sorted(G.edges())] == [
59             ("Node 1", "Node 2"),
60             ("Node 2", "Node 3"),
61             ("Node 3", "Node 1"),
62         ]
63         assert [e for e in sorted(G.edges(data=True))] == [
64             (
65                 "Node 1",
66                 "Node 2",
67                 {
68                     "color": {"line": "blue", "thickness": 3},
69                     "label": "Edge from node 1 to node 2",
70                 },
71             ),
72             ("Node 2", "Node 3", {"label": "Edge from node 2 to node 3"}),
73             ("Node 3", "Node 1", {"label": "Edge from node 3 to node 1"}),
74         ]
75     def test_read_gml(self):
76         (fd, fname) = tempfile.mkstemp()
77         fh = open(fname, "w")
78         fh.write(self.simple_data)
79         fh.close()
80         Gin = nx.read_gml(fname, label="label")
81         G = nx.parse_gml(self.simple_data, label="label")
82         assert sorted(G.nodes(data=True)) == sorted(Gin.nodes(data=True))
83         assert sorted(G.edges(data=True)) == sorted(Gin.edges(data=True))
84         os.close(fd)
85         os.unlink(fname)
86     def test_labels_are_strings(self):
87         answer = """graph [
88   node [
89     id 0
90     label "1203"
91   ]
92 ]"""
93         G = nx.Graph()
94         G.add_node(1203)
95         data = "\n".join(nx.generate_gml(G, stringizer=literal_stringizer))
96         assert data == answer
97     def test_relabel_duplicate(self):
98         data = """
99 graph
100 [
101         label   ""
102         directed        1
103         node
104         [
105                 id      0
106                 label   "same"
107         ]
108         node
109         [
110                 id      1
111                 label   "same"
112         ]
113 ]
114         G<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.add_node(node)
115         fobj = tempfile.NamedTemporaryFile()
116         nx.write_gml(G, fobj)
117         fobj.seek(0)
118         data = fobj.read().strip(</b></font>).decode("ascii")
119         answer = """graph [
120   node [
121     id 0
122     label "node&amp;#169;"
123   ]
124 ]"""
125         assert data == answer
126     def test_float_label(self):
127         node = 1.0
128         G = nx.Graph()
129         G.add_node(node)
130         fobj = tempfile.NamedTemporaryFile()
131         nx.write_gml(G, fobj)
132         fobj.seek(0)
133         data = fobj.read().strip().decode("ascii")
134         answer = """graph [
135   node [
136     id 0
137     label "1.0"
138   ]
139 ]"""
140         assert data == answer
141     def test_special_float_label(self):
142         special_floats = [float("nan"), float("+inf"), float("-inf")]
143         try:
144             import numpy as np
145             special_floats += [np.nan, np.inf, np.inf * -1]
146         except ImportError:
147             special_floats += special_floats
148         G = nx.cycle_graph(len(special_floats))
149         attrs = dict(enumerate(special_floats))
150         nx.set_node_attributes(G, attrs, "nodefloat")
151         edges = list(G.edges)
152         attrs = {edges[i]: value for i, value in enumerate(special_floats)}
153         nx.set_edge_attributes(G, attrs, "edgefloat")
154         fobj = tempfile.NamedTemporaryFile()
155         nx.write_gml(G, fobj)
156         fobj.seek(0)
157         data = fobj.read().strip().decode("ascii")
158         answer = """graph [
159   node [
160     id 0
161     label "0"
162     nodefloat NAN
163   ]
164   node [
165     id 1
166     label "1"
167     nodefloat +INF
168   ]
169   node [
170     id 2
171     label "2"
172     nodefloat -INF
173   ]
174   node [
175     id 3
176     label "3"
177     nodefloat NAN
178   ]
179   node [
180     id 4
181     label "4"
182     nodefloat +INF
183   ]
184   node [
185     id 5
186     label "5"
187     nodefloat -INF
188   ]
189   edge [
190     source 0
191     target 1
192     edgefloat NAN
193   ]
194   edge [
195     source 0
196     target 5
197     edgefloat +INF
198   ]
199   edge [
200     source 1
201     target 2
202     edgefloat -INF
203   ]
204   edge [
205     source 2
206     target 3
207     edgefloat NAN
208   ]
209   edge [
210     source 3
211     target 4
212     edgefloat +INF
213   ]
214   edge [
215     source 4
216     target 5
217     edgefloat -INF
218   ]
219 ]"""
220         assert data == answer
221         fobj.seek(0)
222         graph = nx.read_gml(fobj)
223         for indx, value in enumerate(special_floats):
224             node_value = graph.nodes[str(indx)]["nodefloat"]
225             if math.isnan(value):
226                 assert math.isnan(node_value)
227             else:
228                 assert node_value == value
229             edge = edges[indx]
230             string_edge = (str(edge[0]), str(edge[1]))
231             edge_value = graph.edges[string_edge]["edgefloat"]
232             if math.isnan(value):
233                 assert math.isnan(edge_value)
234             else:
235                 assert edge_value == value
236     def test_name(self):
237         G = nx.parse_gml('graph [ name "x" node [ id 0 label "x" ] ]')
238         assert "x" == G.graph["name"]
239         G = nx.parse_gml('graph [ node [ id 0 label "x" ] ]')
240         assert "" == G.name
241         assert "name" not in G.graph
242     def test_graph_types(self):
243         for directed in [None, False, True]:
244             for multigraph in [None, False, True]:
245                 gml = "graph ["
246                 if directed is not None:
247                     gml += " directed " + str(int(directed))
248                 if multigraph is not None:
249                     gml += " multigraph " + str(int(multigraph))
250                 gml += ' node [ id 0 label "0" ]'
251                 gml += " edge [ source 0 target 0 ]"
252                 gml += " ]"
253                 G = nx.parse_gml(gml)
254                 assert bool(directed) == G.is_directed()
255                 assert bool(multigraph) == G.is_multigraph()
256                 gml = "graph [\n"
257                 if directed is True:
258                     gml += "  directed 1\n"
259                 if multigraph is True:
260                     gml += "  multigraph 1\n"
261                 gml += """  node [
262     id 0
263     label "0"
264   ]
265   edge [
266     source 0
267     target 0
268   name "&amp;#38;&amp;#34;&amp;#15;&amp;#17476;&amp;#38;"""
269             + alnu
270             + """;&amp;#38;unknown;"
271 ]"""
272         )
273         assert answer == gml
274     def test_exceptions(self):
275         pytest.raises(ValueError, literal_destringizer, "(")
276         pytest.raises(ValueError, literal_destringizer, "frozenset([1, 2, 3])")
277         pytest.raises(ValueError, literal_destringizer, literal_destringizer)
278         pytest.raises(ValueError, literal_stringizer, frozenset([1, 2, 3]))
279         pytest.raises(ValueError, literal_stringizer, literal_stringizer)
280         with tempfile.TemporaryFile() as f:
281             f.write(codecs.BOM_UTF8 + b"graph[]")
282             f.seek(0)
283             pytest.raises(nx.NetworkXError, nx.read_gml, f)
284         def assert_parse_error(gml):
285             pytest.raises(nx.NetworkXError, nx.parse_gml, gml)
286         assert_parse_error(["graph [\n\n", "]"])
287         assert_parse_error("")
288         assert_parse_error('Creator ""')
289         assert_parse_error("0")
290         assert_parse_error("graph ]")
291         assert_parse_error("graph [ 1 ]")
292         assert_parse_error("graph [ 1.E+2 ]")
293         assert_parse_error('graph [ "A" ]')
294         assert_parse_error("graph [ ] graph ]")
295         assert_parse_error("graph [ ] graph [ ]")
296         assert_parse_error("graph [ data [1, 2, 3] ]")
297         assert_parse_error("graph [ node [ ] ]")
298         assert_parse_error("graph [ node [ id 0 ] ]")
299         nx.parse_gml('graph [ node [ id "a" ] ]', label="id")
300         assert_parse_error("graph [ node [ id 0 label 0 ] node [ id 0 label 1 ] ]")
301         assert_parse_error("graph [ node [ id 0 label 0 ] node [ id 1 label 0 ] ]")
302         assert_parse_error("graph [ node [ id 0 label 0 ] edge [ ] ]")
303         assert_parse_error("graph [ node [ id 0 label 0 ] edge [ source 0 ] ]")
304         nx.parse_gml("graph [edge [ source 0 target 0 ] node [ id 0 label 0 ] ]")
305         assert_parse_error("graph [ node [ id 0 label 0 ] edge [ source 1 target 0 ] ]")
306         assert_parse_error("graph [ node [ id 0 label 0 ] edge [ source 0 target 1 ] ]")
307         assert_parse_error(
308             "graph [ node [ id 0 label 0 ] node [ id 1 label 1 ] "
309             "edge [ source 0 target 1 ] edge [ source 1 target 0 ] ]"
310         )
311         nx.parse_gml(
312             "graph [ node [ id 0 label 0 ] node [ id 1 label 1 ] "
313             "edge [ source 0 target 1 ] edge [ source 1 target 0 ] "
314             "directed 1 ]"
315         )
316         nx.parse_gml(
317             "graph [ node [ id 0 label 0 ] node [ id 1 label 1 ] "
318             "edge [ source 0 target 1 ] edge [ source 0 target 1 ]"
319             "multigraph 1 ]"
320         )
321         nx.parse_gml(
322             "graph [ node [ id 0 label 0 ] node [ id 1 label 1 ] "
323             "edge [ source 0 target 1 key 0 ] edge [ source 0 target 1 ]"
324             "multigraph 1 ]"
325         )
326         assert_parse_error(
327             "graph [ node [ id 0 label 0 ] node [ id 1 label 1 ] "
328             "edge [ source 0 target 1 key 0 ] edge [ source 0 target 1 key 0 ]"
329             "multigraph 1 ]"
330         )
331         nx.parse_gml(
332             "graph [ node [ id 0 label 0 ] node [ id 1 label 1 ] "
333             "edge [ source 0 target 1 key 0 ] edge [ source 1 target 0 key 0 ]"
334             "directed 1 multigraph 1 ]"
335         )
336         nx.parse_gml("graph [edge [ source a target a ] node [ id a label b ] ]")
337         nx.parse_gml(
338             "graph [ node [ id n42 label 0 ] node [ id x43 label 1 ]"
339             "edge [ source n42 target x43 key 0 ]"
340             "edge [ source x43 target n42 key 0 ]"
341             "directed 1 multigraph 1 ]"
342         )
343         assert_parse_error(
344             "graph [edge [ source u'u\4200' target u'u\4200' ] "
345             + "node [ id u'u\4200' label b ] ]"
346         )
347         def assert_generate_error(*args, **kwargs):
348             pytest.raises(
349                 nx.NetworkXError, lambda: list(nx.generate_gml(*args, **kwargs))
350             )
351         G = nx.Graph()
352         G.graph[3] = 3
353         assert_generate_error(G)
354         G = nx.Graph()
355         G.graph["3"] = 3
356         assert_generate_error(G)
357         G = nx.Graph()
358         G.graph["data"] = frozenset([1, 2, 3])
359         assert_generate_error(G, stringizer=literal_stringizer)
360         G = nx.Graph()
361         G.graph["data"] = []
362         assert_generate_error(G)
363         assert_generate_error(G, stringizer=len)
364     def test_label_kwarg(self):
365         G = nx.parse_gml(self.simple_data, label="id")
366         assert sorted(G.nodes) == [1, 2, 3]
367         labels = [G.nodes[n]["label"] for n in sorted(G.nodes)]
368         assert labels == ["Node 1", "Node 2", "Node 3"]
369         G = nx.parse_gml(self.simple_data, label=None)
370         assert sorted(G.nodes) == [1, 2, 3]
371         labels = [G.nodes[n]["label"] for n in sorted(G.nodes)]
372         assert labels == ["Node 1", "Node 2", "Node 3"]
373     def test_outofrange_integers(self):
374         G = nx.Graph()
375         numbers = {
376             "toosmall": (-(2 ** 31)) - 1,
377             "small": -(2 ** 31),
378             "med1": -4,
379             "med2": 0,
380             "med3": 17,
381             "big": (2 ** 31) - 1,
382             "toobig": 2 ** 31,
383         }
384         G.add_node("Node", **numbers)
385         fd, fname = tempfile.mkstemp()
386         try:
387             nx.write_gml(G, fname)
388             G2 = nx.read_gml(fname)
389             for attr, value in G2.nodes["Node"].items():
390                 if attr == "toosmall" or attr == "toobig":
391                     assert type(value) == str
392                 else:
393                     assert type(value) == int
394         finally:
395             os.close(fd)
396             os.unlink(fname)
397 @contextmanager
398 def byte_file():
399     _file_handle = io.BytesIO()
400     yield _file_handle
401     _file_handle.seek(0)
402 class TestPropertyLists:
403     def test_writing_graph_with_multi_element_property_list(self):
404         g = nx.Graph()
405         g.add_node("n1", properties=["element", 0, 1, 2.5, True, False])
406         with byte_file() as f:
407             nx.write_gml(g, f)
408         result = f.read().decode()
409         assert result == dedent(
410         )
411     def test_writing_graph_with_one_element_property_list(self):
412         g = nx.Graph()
413         g.add_node("n1", properties=["element"])
414         with byte_file() as f:
415             nx.write_gml(g, f)
416         result = f.read().decode()
417         assert result == dedent(
418         )
419     def test_reading_graph_with_list_property(self):
420         with byte_file() as f:
421             f.write(
422                 dedent(
423                 ).encode("ascii")
424             )
425             f.seek(0)
426             graph = nx.read_gml(f)
427         assert graph.nodes(data=True)["n1"] == {"properties": ["element", 0, 1, 2.5]}
428     def test_reading_graph_with_single_element_list_property(self):
429         with byte_file() as f:
430             f.write(
431                 dedent(
432                 ).encode("ascii")
433             )
434             f.seek(0)
435             graph = nx.read_gml(f)
436         assert graph.nodes(data=True)["n1"] == {"properties": ["element"]}
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>plot_subgraphs.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 import networkx as nx
2 import matplotlib.pyplot as plt
3 def graph_partitioning(G, plotting=True):
4     supported_nodes = {n for n, d in G.nodes(data="node_type") if d == "supported"}
5     unsupported_nodes = {n for n, d in G.nodes(data="node_type") if d == "unsupported"}
6     H = G.copy()
7     H.remove_edges_from(
8         (n, nbr, d)
9         for n, nbrs in G.adj.items()
10         if n in supported_nodes
11         for nbr, d in nbrs.items()
12         if nbr in unsupported_nodes
13     )
14     H.remove_edges_from(
15         (n, nbr, d)
16         for n, nbrs in G.adj.items()
17         if n in unsupported_nodes
18         for nbr, d in nbrs.items()
19         if nbr in supported_nodes
20     )
21     G_minus_H = nx.DiGraph()
22     G_minus_H.add_edges_from(set(G.edges) - set(H.edges))
23     if plotting:
24         _node_colors = [c for _, c in H.nodes(data="node_color")]
25         _pos = nx.spring_layout(H)
26 <a name="0"></a>        plt.figure(figsize=(8, 8))
27         nx.draw_networkx_edges(H, _pos, alpha=0.3, edge_color="k")
28         nx.draw_networkx_nodes(H, _pos, node_color=_node_colors)
29         nx<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.draw_networkx_labels(H, _pos, font_size=14)
30         plt.axis("off")
31         plt.title("The stripped graph with the edges removed.")
32         plt.show()
33         _pos = nx.spring_layout(G_minus_H)
34         plt.figure(</b></font>figsize=(8, 8))
35         ncl = [G.nodes[n]["node_color"] for n in G_minus_H.nodes]
36         nx.draw_networkx_edges(G_minus_H, _pos, alpha=0.3, edge_color="k")
37         nx.draw_networkx_nodes(G_minus_H, _pos, node_color=ncl)
38         nx.draw_networkx_labels(G_minus_H, _pos, font_size=14)
39         plt.axis("off")
40         plt.title("The removed edges.")
41         plt.show()
42     subgraphs = [
43         H.subgraph(c).copy() for c in nx.connected_components(H.to_undirected())
44     ]
45     return subgraphs, G_minus_H
46 G_ex = nx.DiGraph()
47 G_ex.add_nodes_from(["In"], node_type="input", node_color="b")
48 G_ex.add_nodes_from(["A", "C", "E", "F"], node_type="supported", node_color="g")
49 G_ex.add_nodes_from(["B", "D"], node_type="unsupported", node_color="r")
50 G_ex.add_nodes_from(["Out"], node_type="output", node_color="m")
51 G_ex.add_edges_from(
52     [
53         ("In", "A"),
54         ("A", "B"),
55         ("B", "C"),
56         ("B", "D"),
57         ("D", "E"),
58         ("C", "F"),
59         ("E", "F"),
60         ("F", "Out"),
61     ]
62 )
63 node_color_list = [nc for _, nc in G_ex.nodes(data="node_color")]
64 pos = nx.spectral_layout(G_ex)
65 plt.figure(figsize=(8, 8))
66 nx.draw_networkx_edges(G_ex, pos, alpha=0.3, edge_color="k")
67 nx.draw_networkx_nodes(G_ex, pos, alpha=0.8, node_color=node_color_list)
68 nx.draw_networkx_labels(G_ex, pos, font_size=14)
69 plt.axis("off")
70 plt.title("The original graph.")
71 plt.show()
72 subgraphs_of_G_ex, removed_edges = graph_partitioning(G_ex, plotting=True)
73 for subgraph in subgraphs_of_G_ex:
74     _pos = nx.spring_layout(subgraph)
75     plt.figure(figsize=(8, 8))
76     nx.draw_networkx_edges(subgraph, _pos, alpha=0.3, edge_color="k")
77     node_color_list_c = [nc for _, nc in subgraph.nodes(data="node_color")]
78     nx.draw_networkx_nodes(subgraph, _pos, node_color=node_color_list_c)
79     nx.draw_networkx_labels(subgraph, _pos, font_size=14)
80     plt.axis("off")
81     plt.title("One of the subgraphs.")
82     plt.show()
83 G_ex_r = nx.DiGraph()
84 for subgraph in subgraphs_of_G_ex:
85     G_ex_r = nx.compose(G_ex_r, subgraph)
86 G_ex_r.add_edges_from(removed_edges.edges())
87 assert nx.is_isomorphic(G_ex, G_ex_r)
88 node_color_list = [nc for _, nc in G_ex_r.nodes(data="node_color")]
89 pos = nx.spectral_layout(G_ex_r)
90 plt.figure(figsize=(8, 8))
91 nx.draw_networkx_edges(G_ex_r, pos, alpha=0.3, edge_color="k")
92 nx.draw_networkx_nodes(G_ex_r, pos, alpha=0.8, node_color=node_color_list)
93 nx.draw_networkx_labels(G_ex_r, pos, font_size=14)
94 plt.axis("off")
95 plt.title("The reconstructed graph.")
96 plt.show()
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
