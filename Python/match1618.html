<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for test_rdp_1.py & test_win_snmp_1.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for test_rdp_1.py & test_win_snmp_1.py
      </h3>
      <h1 align="center">
        38.0%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>test_rdp_1.py (63.934425%)<TH>test_win_snmp_1.py (27.083334%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match1618-0.html#0',2,'match1618-1.html#0',3)" NAME="0">(26-38)<TD><A HREF="javascript:ZweiFrames('match1618-0.html#0',2,'match1618-1.html#0',3)" NAME="0">(89-103)</A><TD ALIGN=center><FONT COLOR="#ff0000">21</FONT>
<TR><TD BGCOLOR="#f63526"><FONT COLOR="#f63526">-</FONT><TD><A HREF="javascript:ZweiFrames('match1618-0.html#1',2,'match1618-1.html#1',3)" NAME="1">(39-50)<TD><A HREF="javascript:ZweiFrames('match1618-0.html#1',2,'match1618-1.html#1',3)" NAME="1">(52-61)</A><TD ALIGN=center><FONT COLOR="#da0000">18</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_rdp_1.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
&quot;&quot;&quot;
    :codeauthor: Jayesh Kariya &lt;jayeshk@saltstack.com&gt;
&quot;&quot;&quot;


import salt.modules.rdp as rdp
from tests.support.mixins import LoaderModuleMockMixin
from tests.support.mock import MagicMock, patch
from tests.support.unit import TestCase


class RdpTestCase(TestCase, LoaderModuleMockMixin):
    &quot;&quot;&quot;
    Test cases for salt.modules.rdp
    &quot;&quot;&quot;

    def setup_loader_modules(self):
        return {rdp: {}}

    # 'enable' function tests: 1

    def test_enable(self):
<A NAME="0"></A>        &quot;&quot;&quot;
        Test if it enables RDP the service on the server
        &quot;&quot;&quot;
        mock <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match1618-1.html#0',3,'match1618-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>= MagicMock(return_value=True)
        with patch.dict(rdp.__salt__, {&quot;cmd.run&quot;: mock}), patch(
            &quot;salt.modules.rdp._parse_return_code_powershell&quot;, MagicMock(return_value=0)
        ):
            self.assertTrue(rdp.enable())

    # 'disable' function tests: 1

    def test_disable(self):
        &quot;&quot;&quot;
<A NAME="1"></A>        Test if it disables RDP the service on the server
        &quot;&quot;&quot;
        mock = MagicMock(return_value=</B></FONT>True)
        <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match1618-1.html#1',3,'match1618-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>with patch.dict(rdp.__salt__, {&quot;cmd.run&quot;: mock}), patch(
            &quot;salt.modules.rdp._parse_return_code_powershell&quot;, MagicMock(return_value=0)
        ):
            self.assertTrue(rdp.disable())

    # 'status' function tests: 1

    def test_status(self):
        &quot;&quot;&quot;
        Test if it shows rdp is enabled on the server
        &quot;&quot;&quot;
        mock = MagicMock(return_value=</B></FONT>&quot;1&quot;)
        with patch.dict(rdp.__salt__, {&quot;cmd.run&quot;: mock}):
            self.assertTrue(rdp.status())
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_win_snmp_1.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
&quot;&quot;&quot;
    :synopsis: Unit Tests for Windows SNMP Module 'module.win_snmp'
    :platform: Windows
    :maturity: develop
    .. versionadded:: 2017.7.0
&quot;&quot;&quot;


import salt.modules.win_snmp as win_snmp
from salt.exceptions import CommandExecutionError
from tests.support.mixins import LoaderModuleMockMixin
from tests.support.mock import MagicMock, patch
from tests.support.unit import TestCase

COMMUNITY_NAMES = {&quot;TestCommunity&quot;: &quot;Read Create&quot;}


class WinSnmpTestCase(TestCase, LoaderModuleMockMixin):
    &quot;&quot;&quot;
    Test cases for salt.modules.win_snmp
    &quot;&quot;&quot;

    def setup_loader_modules(self):
        return {win_snmp: {}}

    def test_get_agent_service_types(self):
        &quot;&quot;&quot;
        Test - Get the sysServices types that can be configured.
        &quot;&quot;&quot;
        self.assertIsInstance(win_snmp.get_agent_service_types(), list)

    def test_get_permission_types(self):
        &quot;&quot;&quot;
        Test - Get the permission types that can be configured for communities.
        &quot;&quot;&quot;
        self.assertIsInstance(win_snmp.get_permission_types(), list)

    def test_get_auth_traps_enabled(self):
        &quot;&quot;&quot;
        Test - Determine whether the host is configured to send authentication traps.
        &quot;&quot;&quot;
        mock_value = MagicMock(return_value={&quot;vdata&quot;: 1})
        with patch.dict(win_snmp.__utils__, {&quot;reg.read_value&quot;: mock_value}):
            self.assertTrue(win_snmp.get_auth_traps_enabled())

    def test_set_auth_traps_enabled(self):
        &quot;&quot;&quot;
        Test - Manage the sending of authentication traps.
<A NAME="1"></A>        &quot;&quot;&quot;
        mock_value = MagicMock(return_value=True)
        kwargs = {&quot;status&quot;: True}
        <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match1618-0.html#1',2,'match1618-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>with patch.dict(win_snmp.__utils__, {&quot;reg.set_value&quot;: mock_value}), patch(
            &quot;salt.modules.win_snmp.get_auth_traps_enabled&quot;, MagicMock(return_value=True)
        ):
            self.assertTrue(win_snmp.set_auth_traps_enabled(**kwargs))

    def test_get_community_names(self):
        &quot;&quot;&quot;
        Test - Get the current accepted SNMP community names and their permissions.
        &quot;&quot;&quot;
        mock_ret = MagicMock(return_value=</B></FONT>[{&quot;vdata&quot;: 16, &quot;vname&quot;: &quot;TestCommunity&quot;}])
        mock_false = MagicMock(return_value=False)
        with patch.dict(
            win_snmp.__utils__,
            {&quot;reg.list_values&quot;: mock_ret, &quot;reg.key_exists&quot;: mock_false},
        ):
            self.assertEqual(win_snmp.get_community_names(), COMMUNITY_NAMES)

    def test_get_community_names_gpo(self):
        &quot;&quot;&quot;
        Test - Get the current accepted SNMP community names and their permissions.
        &quot;&quot;&quot;
        mock_ret = MagicMock(return_value=[{&quot;vdata&quot;: &quot;TestCommunity&quot;, &quot;vname&quot;: 1}])
        mock_false = MagicMock(return_value=True)
        with patch.dict(
            win_snmp.__utils__,
            {&quot;reg.list_values&quot;: mock_ret, &quot;reg.key_exists&quot;: mock_false},
        ):
            self.assertEqual(
                win_snmp.get_community_names(), {&quot;TestCommunity&quot;: &quot;Managed by GPO&quot;}
            )

    def test_set_community_names(self):
        &quot;&quot;&quot;
        Test - Manage the SNMP accepted community names and their permissions.
<A NAME="0"></A>        &quot;&quot;&quot;
        mock_true = MagicMock(return_value=True)
        kwargs = {&quot;communities&quot;: COMMUNITY_NAMES}
        mock_false <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match1618-0.html#0',2,'match1618-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>= MagicMock(return_value=False)
        with patch.dict(
            win_snmp.__utils__,
            {&quot;reg.set_value&quot;: mock_true, &quot;reg.key_exists&quot;: mock_false},
        ), patch(
            &quot;salt.modules.win_snmp.get_community_names&quot;,
            MagicMock(return_value=COMMUNITY_NAMES),
        ):
            self.assertTrue(win_snmp.set_community_names(**kwargs))

    def test_set_community_names_gpo(self):
        &quot;&quot;&quot;
        Test - Manage the SNMP accepted community names and their permissions.
        &quot;&quot;&quot;
        mock_true = MagicMock(return_value=</B></FONT>True)
        kwargs = {&quot;communities&quot;: COMMUNITY_NAMES}
        with patch.dict(
            win_snmp.__utils__,
            {&quot;reg.set_value&quot;: mock_true, &quot;reg.key_exists&quot;: mock_true},
        ), patch(
            &quot;salt.modules.win_snmp.get_community_names&quot;,
            MagicMock(return_value=COMMUNITY_NAMES),
        ):
            self.assertRaises(
                CommandExecutionError, win_snmp.set_community_names, **kwargs
            )
</PRE>
</div>
  </div>
</body>
</html>
