<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for fragment.py &amp; test_subtitles.py</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for fragment.py &amp; test_subtitles.py
      </h3>
<h1 align="center">
        2.0%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>fragment.py (2.9126213%)<th>test_subtitles.py (1.5228426%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(145-148)<td><a href="#" name="0">(8-8)</a><td align="center"><font color="#ff0000">12</font>
</td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>fragment.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from __future__ import division, unicode_literals
2 import os
3 import time
4 import json
5 from .common import FileDownloader
6 from .http import HttpFD
7 from ..utils import (
8     error_to_compat_str,
9     encodeFilename,
10     sanitize_open,
11     sanitized_Request,
12 )
13 class HttpQuietDownloader(HttpFD):
14     def to_screen(self, *args, **kargs):
15         pass
16 class FragmentFD(FileDownloader):
17     def report_retry_fragment(self, err, frag_index, count, retries):
18         self.to_screen(
19             '[download] Got server HTTP error: %s. Retrying fragment %d (attempt %d of %s)...'
20             % (error_to_compat_str(err), frag_index, count, self.format_retries(retries)))
21     def report_skip_fragment(self, frag_index):
22         self.to_screen('[download] Skipping fragment %d...' % frag_index)
23     def _prepare_url(self, info_dict, url):
24         headers = info_dict.get('http_headers')
25         return sanitized_Request(url, None, headers) if headers else url
26     def _prepare_and_start_frag_download(self, ctx):
27         self._prepare_frag_download(ctx)
28         self._start_frag_download(ctx)
29     @staticmethod
30     def __do_ytdl_file(ctx):
31         return not ctx['live'] and not ctx['tmpfilename'] == '-'
32     def _read_ytdl_file(self, ctx):
33         assert 'ytdl_corrupt' not in ctx
34         stream, _ = sanitize_open(self.ytdl_filename(ctx['filename']), 'r')
35         try:
36             ctx['fragment_index'] = json.loads(stream.read())['downloader']['current_fragment']['index']
37         except Exception:
38             ctx['ytdl_corrupt'] = True
39         finally:
40             stream.close()
41     def _write_ytdl_file(self, ctx):
42         frag_index_stream, _ = sanitize_open(self.ytdl_filename(ctx['filename']), 'w')
43         downloader = {
44             'current_fragment': {
45                 'index': ctx['fragment_index'],
46             },
47         }
48         if ctx.get('fragment_count') is not None:
49             downloader['fragment_count'] = ctx['fragment_count']
50         frag_index_stream.write(json.dumps({'downloader': downloader}))
51         frag_index_stream.close()
52     def _download_fragment(self, ctx, frag_url, info_dict, headers=None):
53         fragment_filename = '%s-Frag%d' % (ctx['tmpfilename'], ctx['fragment_index'])
54         fragment_info_dict = {
55             'url': frag_url,
56             'http_headers': headers or info_dict.get('http_headers'),
57         }
58         success = ctx['dl'].download(fragment_filename, fragment_info_dict)
59         if not success:
60             return False, None
61         if fragment_info_dict.get('filetime'):
62             ctx['fragment_filetime'] = fragment_info_dict.get('filetime')
63         down, frag_sanitized = sanitize_open(fragment_filename, 'rb')
64         ctx['fragment_filename_sanitized'] = frag_sanitized
65         frag_content = down.read()
66         down.close()
67         return True, frag_content
68     def _append_fragment(self, ctx, frag_content):
69         try:
70             ctx['dest_stream'].write(frag_content)
71             ctx['dest_stream'].flush()
72         finally:
73             if self.__do_ytdl_file(ctx):
74                 self._write_ytdl_file(ctx)
75             if not self.params.get('keep_fragments', False):
76                 os.remove(encodeFilename(ctx['fragment_filename_sanitized']))
77             del ctx['fragment_filename_sanitized']
78     def _prepare_frag_download(self, ctx):
79         if 'live' not in ctx:
80             ctx['live'] = False
81         if not ctx['live']:
82             total_frags_str = '%d' % ctx['total_frags']
83             ad_frags = ctx.get('ad_frags', 0)
84             if ad_frags:
85                 total_frags_str += ' (not including %d ad)' % ad_frags
86         else:
87             total_frags_str = 'unknown (live)'
88         self.to_screen(
89             '[%s] Total fragments: %s' % (self.FD_NAME, total_frags_str))
90         self.report_destination(ctx['filename'])
91         dl = HttpQuietDownloader(
92             self.ydl,
93             {
94 <a name="0"></a>                'continuedl': True,
95                 'quiet': True,
96                 'noprogress': True,
97                 'ratelimit': self<font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>.params.get('ratelimit'),
98                 'retries': self.params.get('retries', 0),
99                 'nopart': self.params.get('nopart', False),
100                 'test': self.params.get(</b></font>'test', False),
101             }
102         )
103         tmpfilename = self.temp_name(ctx['filename'])
104         open_mode = 'wb'
105         resume_len = 0
106         if os.path.isfile(encodeFilename(tmpfilename)):
107             open_mode = 'ab'
108             resume_len = os.path.getsize(encodeFilename(tmpfilename))
109         ctx.update({
110             'tmpfilename': tmpfilename,
111             'fragment_index': 0,
112         })
113         if self.__do_ytdl_file(ctx):
114             if os.path.isfile(encodeFilename(self.ytdl_filename(ctx['filename']))):
115                 self._read_ytdl_file(ctx)
116                 is_corrupt = ctx.get('ytdl_corrupt') is True
117                 is_inconsistent = ctx['fragment_index'] &gt; 0 and resume_len == 0
118                 if is_corrupt or is_inconsistent:
119                     message = (
120                         '.ytdl file is corrupt' if is_corrupt else
121                         'Inconsistent state of incomplete fragment download')
122                     self.report_warning(
123                         '%s. Restarting from the beginning...' % message)
124                     ctx['fragment_index'] = resume_len = 0
125                     if 'ytdl_corrupt' in ctx:
126                         del ctx['ytdl_corrupt']
127                     self._write_ytdl_file(ctx)
128             else:
129                 self._write_ytdl_file(ctx)
130                 assert ctx['fragment_index'] == 0
131         dest_stream, tmpfilename = sanitize_open(tmpfilename, open_mode)
132         ctx.update({
133             'dl': dl,
134             'dest_stream': dest_stream,
135             'tmpfilename': tmpfilename,
136             'complete_frags_downloaded_bytes': resume_len,
137         })
138     def _start_frag_download(self, ctx):
139         resume_len = ctx['complete_frags_downloaded_bytes']
140         total_frags = ctx['total_frags']
141         state = {
142             'status': 'downloading',
143             'downloaded_bytes': resume_len,
144             'fragment_index': ctx['fragment_index'],
145             'fragment_count': total_frags,
146             'filename': ctx['filename'],
147             'tmpfilename': ctx['tmpfilename'],
148         }
149         start = time.time()
150         ctx.update({
151             'started': start,
152             'prev_frag_downloaded_bytes': 0,
153         })
154         def frag_progress_hook(s):
155             if s['status'] not in ('downloading', 'finished'):
156                 return
157             time_now = time.time()
158             state['elapsed'] = time_now - start
159             frag_total_bytes = s.get('total_bytes') or 0
160             if not ctx['live']:
161                 estimated_size = (
162                     (ctx['complete_frags_downloaded_bytes'] + frag_total_bytes)
163                     / (state['fragment_index'] + 1) * total_frags)
164                 state['total_bytes_estimate'] = estimated_size
165             if s['status'] == 'finished':
166                 state['fragment_index'] += 1
167                 ctx['fragment_index'] = state['fragment_index']
168                 state['downloaded_bytes'] += frag_total_bytes - ctx['prev_frag_downloaded_bytes']
169                 ctx['complete_frags_downloaded_bytes'] = state['downloaded_bytes']
170                 ctx['prev_frag_downloaded_bytes'] = 0
171             else:
172                 frag_downloaded_bytes = s['downloaded_bytes']
173                 state['downloaded_bytes'] += frag_downloaded_bytes - ctx['prev_frag_downloaded_bytes']
174                 if not ctx['live']:
175                     state['eta'] = self.calc_eta(
176                         start, time_now, estimated_size - resume_len,
177                         state['downloaded_bytes'] - resume_len)
178                 state['speed'] = s.get('speed') or ctx.get('speed')
179                 ctx['speed'] = state['speed']
180                 ctx['prev_frag_downloaded_bytes'] = frag_downloaded_bytes
181             self._hook_progress(state)
182         ctx['dl'].add_progress_hook(frag_progress_hook)
183         return start
184     def _finish_frag_download(self, ctx):
185         ctx['dest_stream'].close()
186         if self.__do_ytdl_file(ctx):
187             ytdl_filename = encodeFilename(self.ytdl_filename(ctx['filename']))
188             if os.path.isfile(ytdl_filename):
189                 os.remove(ytdl_filename)
190         elapsed = time.time() - ctx['started']
191         if ctx['tmpfilename'] == '-':
192             downloaded_bytes = ctx['complete_frags_downloaded_bytes']
193         else:
194             self.try_rename(ctx['tmpfilename'], ctx['filename'])
195             if self.params.get('updatetime', True):
196                 filetime = ctx.get('fragment_filetime')
197                 if filetime:
198                     try:
199                         os.utime(ctx['filename'], (time.time(), filetime))
200                     except Exception:
201                         pass
202             downloaded_bytes = os.path.getsize(encodeFilename(ctx['filename']))
203         self._hook_progress({
204             'downloaded_bytes': downloaded_bytes,
205             'total_bytes': downloaded_bytes,
206             'filename': ctx['filename'],
207             'status': 'finished',
208             'elapsed': elapsed,
209         })
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>test_subtitles.py</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 from __future__ import unicode_literals
2 <a name="0"></a>import os
3 import sys
4 import unittest
5 sys<font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(</b></font>__file__))))
6 from test.helper import FakeYDL, md5
7 from youtube_dl.extractor import (
8     YoutubeIE,
9     DailymotionIE,
10     TEDIE,
11     VimeoIE,
12     WallaIE,
13     CeskaTelevizeIE,
14     LyndaIE,
15     NPOIE,
16     ComedyCentralIE,
17     NRKTVIE,
18     RaiPlayIE,
19     VikiIE,
20     ThePlatformIE,
21     ThePlatformFeedIE,
22     RTVEALaCartaIE,
23     DemocracynowIE,
24 )
25 class BaseTestSubtitles(unittest.TestCase):
26     url = None
27     IE = None
28     def setUp(self):
29         self.DL = FakeYDL()
30         self.ie = self.IE()
31         self.DL.add_info_extractor(self.ie)
32     def getInfoDict(self):
33         info_dict = self.DL.extract_info(self.url, download=False)
34         return info_dict
35     def getSubtitles(self):
36         info_dict = self.getInfoDict()
37         subtitles = info_dict['requested_subtitles']
38         if not subtitles:
39             return subtitles
40         for sub_info in subtitles.values():
41             if sub_info.get('data') is None:
42                 uf = self.DL.urlopen(sub_info['url'])
43                 sub_info['data'] = uf.read().decode('utf-8')
44         return dict((l, sub_info['data']) for l, sub_info in subtitles.items())
45 class TestYoutubeSubtitles(BaseTestSubtitles):
46     url = 'QRS8MkLhQmM'
47     IE = YoutubeIE
48     def test_youtube_allsubtitles(self):
49         self.DL.params['writesubtitles'] = True
50         self.DL.params['allsubtitles'] = True
51         subtitles = self.getSubtitles()
52         self.assertEqual(len(subtitles.keys()), 13)
53         self.assertEqual(md5(subtitles['en']), '3cb210999d3e021bd6c7f0ea751eab06')
54         self.assertEqual(md5(subtitles['it']), '6d752b98c31f1cf8d597050c7a2cb4b5')
55         for lang in ['fr', 'de']:
56             self.assertTrue(subtitles.get(lang) is not None, 'Subtitles for \'%s\' not extracted' % lang)
57     def test_youtube_subtitles_ttml_format(self):
58         self.DL.params['writesubtitles'] = True
59         self.DL.params['subtitlesformat'] = 'ttml'
60         subtitles = self.getSubtitles()
61         self.assertEqual(md5(subtitles['en']), 'e306f8c42842f723447d9f63ad65df54')
62     def test_youtube_subtitles_vtt_format(self):
63         self.DL.params['writesubtitles'] = True
64         self.DL.params['subtitlesformat'] = 'vtt'
65         subtitles = self.getSubtitles()
66         self.assertEqual(md5(subtitles['en']), '3cb210999d3e021bd6c7f0ea751eab06')
67     def test_youtube_automatic_captions(self):
68         self.url = '8YoUxe5ncPo'
69         self.DL.params['writeautomaticsub'] = True
70         self.DL.params['subtitleslangs'] = ['it']
71         subtitles = self.getSubtitles()
72         self.assertTrue(subtitles['it'] is not None)
73     def test_youtube_translated_subtitles(self):
74         self.url = 'Ky9eprVWzlI'
75         self.DL.params['writeautomaticsub'] = True
76         self.DL.params['subtitleslangs'] = ['it']
77         subtitles = self.getSubtitles()
78         self.assertTrue(subtitles['it'] is not None)
79     def test_youtube_nosubtitles(self):
80         self.DL.expect_warning('video doesn\'t have subtitles')
81         self.url = 'n5BB19UTcdA'
82         self.DL.params['writesubtitles'] = True
83         self.DL.params['allsubtitles'] = True
84         subtitles = self.getSubtitles()
85         self.assertFalse(subtitles)
86 class TestDailymotionSubtitles(BaseTestSubtitles):
87     url = 'http://www.dailymotion.com/video/xczg00'
88     IE = DailymotionIE
89     def test_allsubtitles(self):
90         self.DL.params['writesubtitles'] = True
91         self.DL.params['allsubtitles'] = True
92         subtitles = self.getSubtitles()
93         self.assertTrue(len(subtitles.keys()) &gt;= 6)
94         self.assertEqual(md5(subtitles['en']), '976553874490cba125086bbfea3ff76f')
95         self.assertEqual(md5(subtitles['fr']), '594564ec7d588942e384e920e5341792')
96         for lang in ['es', 'fr', 'de']:
97             self.assertTrue(subtitles.get(lang) is not None, 'Subtitles for \'%s\' not extracted' % lang)
98     def test_nosubtitles(self):
99         self.DL.expect_warning('video doesn\'t have subtitles')
100         self.url = 'http://www.dailymotion.com/video/x12u166_le-zapping-tele-star-du-08-aout-2013_tv'
101         self.DL.params['writesubtitles'] = True
102         self.DL.params['allsubtitles'] = True
103         subtitles = self.getSubtitles()
104         self.assertFalse(subtitles)
105 class TestTedSubtitles(BaseTestSubtitles):
106     url = 'http://www.ted.com/talks/dan_dennett_on_our_consciousness.html'
107     IE = TEDIE
108     def test_allsubtitles(self):
109         self.DL.params['writesubtitles'] = True
110         self.DL.params['allsubtitles'] = True
111         subtitles = self.getSubtitles()
112         self.assertTrue(len(subtitles.keys()) &gt;= 28)
113         self.assertEqual(md5(subtitles['en']), '4262c1665ff928a2dada178f62cb8d14')
114         self.assertEqual(md5(subtitles['fr']), '66a63f7f42c97a50f8c0e90bc7797bb5')
115         for lang in ['es', 'fr', 'de']:
116             self.assertTrue(subtitles.get(lang) is not None, 'Subtitles for \'%s\' not extracted' % lang)
117 class TestVimeoSubtitles(BaseTestSubtitles):
118     url = 'http://vimeo.com/76979871'
119     IE = VimeoIE
120     def test_allsubtitles(self):
121         self.DL.params['writesubtitles'] = True
122         self.DL.params['allsubtitles'] = True
123         subtitles = self.getSubtitles()
124         self.assertEqual(set(subtitles.keys()), set(['de', 'en', 'es', 'fr']))
125         self.assertEqual(md5(subtitles['en']), '8062383cf4dec168fc40a088aa6d5888')
126         self.assertEqual(md5(subtitles['fr']), 'b6191146a6c5d3a452244d853fde6dc8')
127     def test_nosubtitles(self):
128         self.DL.expect_warning('video doesn\'t have subtitles')
129         self.url = 'http://vimeo.com/56015672'
130         self.DL.params['writesubtitles'] = True
131         self.DL.params['allsubtitles'] = True
132         subtitles = self.getSubtitles()
133         self.assertFalse(subtitles)
134 class TestWallaSubtitles(BaseTestSubtitles):
135     url = 'http://vod.walla.co.il/movie/2705958/the-yes-men'
136     IE = WallaIE
137     def test_allsubtitles(self):
138         self.DL.expect_warning('Automatic Captions not supported by this server')
139         self.DL.params['writesubtitles'] = True
140         self.DL.params['allsubtitles'] = True
141         subtitles = self.getSubtitles()
142         self.assertEqual(set(subtitles.keys()), set(['heb']))
143         self.assertEqual(md5(subtitles['heb']), 'e758c5d7cb982f6bef14f377ec7a3920')
144     def test_nosubtitles(self):
145         self.DL.expect_warning('video doesn\'t have subtitles')
146         self.url = 'http://vod.walla.co.il/movie/2642630/one-direction-all-for-one'
147         self.DL.params['writesubtitles'] = True
148         self.DL.params['allsubtitles'] = True
149         subtitles = self.getSubtitles()
150         self.assertFalse(subtitles)
151 class TestCeskaTelevizeSubtitles(BaseTestSubtitles):
152     url = 'http://www.ceskatelevize.cz/ivysilani/10600540290-u6-uzasny-svet-techniky'
153     IE = CeskaTelevizeIE
154     def test_allsubtitles(self):
155         self.DL.expect_warning('Automatic Captions not supported by this server')
156         self.DL.params['writesubtitles'] = True
157         self.DL.params['allsubtitles'] = True
158         subtitles = self.getSubtitles()
159         self.assertEqual(set(subtitles.keys()), set(['cs']))
160         self.assertTrue(len(subtitles['cs']) &gt; 20000)
161     def test_nosubtitles(self):
162         self.DL.expect_warning('video doesn\'t have subtitles')
163         self.url = 'http://www.ceskatelevize.cz/ivysilani/ivysilani/10441294653-hyde-park-civilizace/214411058091220'
164         self.DL.params['writesubtitles'] = True
165         self.DL.params['allsubtitles'] = True
166         subtitles = self.getSubtitles()
167         self.assertFalse(subtitles)
168 class TestLyndaSubtitles(BaseTestSubtitles):
169     url = 'http://www.lynda.com/Bootstrap-tutorials/Using-exercise-files/110885/114408-4.html'
170     IE = LyndaIE
171     def test_allsubtitles(self):
172         self.DL.params['writesubtitles'] = True
173         self.DL.params['allsubtitles'] = True
174         subtitles = self.getSubtitles()
175         self.assertEqual(set(subtitles.keys()), set(['en']))
176         self.assertEqual(md5(subtitles['en']), '09bbe67222259bed60deaa26997d73a7')
177 class TestNPOSubtitles(BaseTestSubtitles):
178     url = 'http://www.npo.nl/nos-journaal/28-08-2014/POW_00722860'
179     IE = NPOIE
180     def test_allsubtitles(self):
181         self.DL.params['writesubtitles'] = True
182         self.DL.params['allsubtitles'] = True
183         subtitles = self.getSubtitles()
184         self.assertEqual(set(subtitles.keys()), set(['nl']))
185         self.assertEqual(md5(subtitles['nl']), 'fc6435027572b63fb4ab143abd5ad3f4')
186 class TestMTVSubtitles(BaseTestSubtitles):
187     url = 'http://www.cc.com/video-clips/p63lk0/adam-devine-s-house-party-chasing-white-swans'
188     IE = ComedyCentralIE
189     def getInfoDict(self):
190         return super(TestMTVSubtitles, self).getInfoDict()['entries'][0]
191     def test_allsubtitles(self):
192         self.DL.params['writesubtitles'] = True
193         self.DL.params['allsubtitles'] = True
194         subtitles = self.getSubtitles()
195         self.assertEqual(set(subtitles.keys()), set(['en']))
196         self.assertEqual(md5(subtitles['en']), '78206b8d8a0cfa9da64dc026eea48961')
197 class TestNRKSubtitles(BaseTestSubtitles):
198     url = 'http://tv.nrk.no/serie/ikke-gjoer-dette-hjemme/DMPV73000411/sesong-2/episode-1'
199     IE = NRKTVIE
200     def test_allsubtitles(self):
201         self.DL.params['writesubtitles'] = True
202         self.DL.params['allsubtitles'] = True
203         subtitles = self.getSubtitles()
204         self.assertEqual(set(subtitles.keys()), set(['no']))
205         self.assertEqual(md5(subtitles['no']), '544fa917d3197fcbee64634559221cc2')
206 class TestRaiPlaySubtitles(BaseTestSubtitles):
207     IE = RaiPlayIE
208     def test_subtitles_key(self):
209         self.url = 'http://www.raiplay.it/video/2014/04/Report-del-07042014-cb27157f-9dd0-4aee-b788-b1f67643a391.html'
210         self.DL.params['writesubtitles'] = True
211         self.DL.params['allsubtitles'] = True
212         subtitles = self.getSubtitles()
213         self.assertEqual(set(subtitles.keys()), set(['it']))
214         self.assertEqual(md5(subtitles['it']), 'b1d90a98755126b61e667567a1f6680a')
215     def test_subtitles_array_key(self):
216         self.url = 'https://www.raiplay.it/video/2020/12/Report---04-01-2021-2e90f1de-8eee-4de4-ac0e-78d21db5b600.html'
217         self.DL.params['writesubtitles'] = True
218         self.DL.params['allsubtitles'] = True
219         subtitles = self.getSubtitles()
220         self.assertEqual(set(subtitles.keys()), set(['it']))
221         self.assertEqual(md5(subtitles['it']), '4b3264186fbb103508abe5311cfcb9cd')
222 class TestVikiSubtitles(BaseTestSubtitles):
223     url = 'http://www.viki.com/videos/1060846v-punch-episode-18'
224     IE = VikiIE
225     def test_allsubtitles(self):
226         self.DL.params['writesubtitles'] = True
227         self.DL.params['allsubtitles'] = True
228         subtitles = self.getSubtitles()
229         self.assertEqual(set(subtitles.keys()), set(['en']))
230         self.assertEqual(md5(subtitles['en']), '53cb083a5914b2d84ef1ab67b880d18a')
231 class TestThePlatformSubtitles(BaseTestSubtitles):
232     url = 'theplatform:JFUjUE1_ehvq'
233     IE = ThePlatformIE
234     def test_allsubtitles(self):
235         self.DL.params['writesubtitles'] = True
236         self.DL.params['allsubtitles'] = True
237         subtitles = self.getSubtitles()
238         self.assertEqual(set(subtitles.keys()), set(['en']))
239         self.assertEqual(md5(subtitles['en']), '97e7670cbae3c4d26ae8bcc7fdd78d4b')
240 class TestThePlatformFeedSubtitles(BaseTestSubtitles):
241     url = 'http://feed.theplatform.com/f/7wvmTC/msnbc_video-p-test?form=json&amp;pretty=true&amp;range=-40&amp;byGuid=n_hardball_5biden_140207'
242     IE = ThePlatformFeedIE
243     def test_allsubtitles(self):
244         self.DL.params['writesubtitles'] = True
245         self.DL.params['allsubtitles'] = True
246         subtitles = self.getSubtitles()
247         self.assertEqual(set(subtitles.keys()), set(['en']))
248         self.assertEqual(md5(subtitles['en']), '48649a22e82b2da21c9a67a395eedade')
249 class TestRtveSubtitles(BaseTestSubtitles):
250     url = 'http://www.rtve.es/alacarta/videos/los-misterios-de-laura/misterios-laura-capitulo-32-misterio-del-numero-17-2-parte/2428621/'
251     IE = RTVEALaCartaIE
252     def test_allsubtitles(self):
253         print('Skipping, only available from Spain')
254         return
255         self.DL.params['writesubtitles'] = True
256         self.DL.params['allsubtitles'] = True
257         subtitles = self.getSubtitles()
258         self.assertEqual(set(subtitles.keys()), set(['es']))
259         self.assertEqual(md5(subtitles['es']), '69e70cae2d40574fb7316f31d6eb7fca')
260 class TestDemocracynowSubtitles(BaseTestSubtitles):
261     url = 'http://www.democracynow.org/shows/2015/7/3'
262     IE = DemocracynowIE
263     def test_allsubtitles(self):
264         self.DL.params['writesubtitles'] = True
265         self.DL.params['allsubtitles'] = True
266         subtitles = self.getSubtitles()
267         self.assertEqual(set(subtitles.keys()), set(['en']))
268         self.assertEqual(md5(subtitles['en']), 'acaca989e24a9e45a6719c9b3d60815c')
269     def test_subtitles_in_page(self):
270         self.url = 'http://www.democracynow.org/2015/7/3/this_flag_comes_down_today_bree'
271         self.DL.params['writesubtitles'] = True
272         self.DL.params['allsubtitles'] = True
273         subtitles = self.getSubtitles()
274         self.assertEqual(set(subtitles.keys()), set(['en']))
275         self.assertEqual(md5(subtitles['en']), 'acaca989e24a9e45a6719c9b3d60815c')
276 if __name__ == '__main__':
277     unittest.main()
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
