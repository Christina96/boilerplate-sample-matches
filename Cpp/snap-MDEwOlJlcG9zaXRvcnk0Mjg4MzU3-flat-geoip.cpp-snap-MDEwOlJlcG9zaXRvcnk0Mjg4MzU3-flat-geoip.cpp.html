
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 14, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-geoip.cpp</h3>
            <pre><code>1  void TGeoIpBs::GetCountryNm(const TStr& IpNumStr, TStr& CountrySNm, TStr& CountryLNm){
2    CountrySNm="--"; CountryLNm="Unknown";
3    TStrV IpSubNumStrV; IpNumStr.SplitOnAllCh('.', IpSubNumStrV, false);
4    int IpSubNum0, IpSubNum1, IpSubNum2, IpSubNum3;
5    uint IpNum;
6    if (
7     IpSubNumStrV[0].IsInt(true, 0, 255, IpSubNum0)&&
8     IpSubNumStrV[1].IsInt(true, 0, 255, IpSubNum1)&&
9     IpSubNumStrV[2].IsInt(true, 0, 255, IpSubNum2)&&
10     IpSubNumStrV[3].IsInt(true, 0, 255, IpSubNum3)){
11      IpNum=16777216*IpSubNum0+65536*IpSubNum1+256*IpSubNum2+IpSubNum3;
12    } else {
13      return;
14    }
15    int CountryId=-1;
16    int IpNumN; CountryMnIpNumV.SearchBin(IpNum+1, IpNumN);
17    if (IpNumN>0){
18      uint MnIpNum=CountryMnIpNumV[IpNumN-1];
19      uint MxIpNum=MnIpNumToMxIpNumCountryIdPrH.GetDat(MnIpNum).Val1;
20      if ((MnIpNum<=IpNum)&&(IpNum<=MxIpNum)){
21        CountryId=MnIpNumToMxIpNumCountryIdPrH.GetDat(MnIpNum).Val2;
22      }
23    }
24    if (CountryId!=-1){
25      CountrySNm=CountrySNmToLNmH.GetKey(CountryId);
26      CountryLNm=CountrySNmToLNmH[CountryId];
27    }
28  }
29  void TGeoIpBs::GetLocation(const TStr& IpNumStr, 
30   TStr& CountrySNm, TStr& CityNm, double& Latitude, double& Longitude){
31    CountrySNm="--"; CityNm="Unknown"; Latitude=0; Longitude=0;
32    TStrV IpSubNumStrV; IpNumStr.SplitOnAllCh('.', IpSubNumStrV, false);
33    int IpSubNum0, IpSubNum1, IpSubNum2, IpSubNum3;
34    uint IpNum;
35    if (
36     IpSubNumStrV[0].IsInt(true, 0, 255, IpSubNum0)&&
37     IpSubNumStrV[1].IsInt(true, 0, 255, IpSubNum1)&&
38     IpSubNumStrV[2].IsInt(true, 0, 255, IpSubNum2)&&
39     IpSubNumStrV[3].IsInt(true, 0, 255, IpSubNum3)){
40      IpNum=16777216*IpSubNum0+65536*IpSubNum1+256*IpSubNum2+IpSubNum3;
41    } else {
42      return;
43    }
44    int LocId=-1;
45    int IpNumN; LocMnIpNumV.SearchBin(IpNum+1, IpNumN);
46    if (IpNumN>0){
47      uint MnIpNum=LocMnIpNumV[IpNumN-1];
48      uint MxIpNum=MnIpNumToMxIpNumLocIdPrH.GetDat(MnIpNum).Val1;
49      if ((MnIpNum<=IpNum)&&(IpNum<=MxIpNum)){
50        LocId=MnIpNumToMxIpNumLocIdPrH.GetDat(MnIpNum).Val2;
51      }
52    }
53    if (LocId!=-1){
54      int CountrySNmId=LocIdToCountryIdCityIdLatitudeLongitudeQuH.GetDat(LocId).Val1;
55      CountrySNm=GeoNmH.GetKey(CountrySNmId);
56      int CityNmId=LocIdToCountryIdCityIdLatitudeLongitudeQuH.GetDat(LocId).Val2;
57      CityNm=GeoNmH.GetKey(CityNmId);
58      Latitude=LocIdToCountryIdCityIdLatitudeLongitudeQuH.GetDat(LocId).Val3;
59      Longitude=LocIdToCountryIdCityIdLatitudeLongitudeQuH.GetDat(LocId).Val4;
60    }
61  }
62  PGeoIpBs TGeoIpBs::LoadCsv(const TStr& GeoIpFPath, const bool& CountriesOnlyP){
63    PGeoIpBs GeoIpBs=TGeoIpBs::New();
64    TStr GeoIpNrFPath=TStr::GetNrFPath(GeoIpFPath);
65    TStr CountryFNm=GeoIpNrFPath+"GeoIPCountryWhois.csv";
66    TStr CityLocationFNm=GeoIpNrFPath+"GeoLiteCity-Location.csv";
67    TStr CityBlocksFNm=GeoIpNrFPath+"GeoLiteCity-Blocks.csv";
68    {PSs Ss=TSs::LoadTxt(ssfCommaSep, CountryFNm, TNotify::StdNotify);
69    for (int Y=0; Y<Ss->GetYLen(); Y++){
70      uint MnIpNum=Ss->At(2, Y).GetUInt();
71      uint MxIpNum=Ss->At(3, Y).GetUInt();;
72      TStr CountrySNm=Ss->At(4, Y);
73      TStr CountryLNm=Ss->At(5, Y);
74      GeoIpBs->CountrySNmToLNmH.AddDat(CountrySNm)=CountryLNm;
75      int CountryId=GeoIpBs->CountrySNmToLNmH.GetKeyId(CountrySNm);
76      GeoIpBs->MnIpNumToMxIpNumCountryIdPrH.AddDat(MnIpNum, TUIntIntPr(MxIpNum, CountryId));
77      GeoIpBs->CountryMnIpNumV.Add(MnIpNum);
78    }
79    printf("Sorting ... ");
<span onclick='openModal()' class='match'>80    GeoIpBs->CountryMnIpNumV.Sort();}
81    printf("Done.\n");
82    if (!CountriesOnlyP){
</span>83      {PSs Ss=TSs::LoadTxt(ssfCommaSep, CityLocationFNm, TNotify::StdNotify, false);
84      for (int Y=2; Y<Ss->GetYLen(); Y++){
85        int LocId=Ss->At(0, Y).GetInt();
86        TStr CountrySNm=Ss->At(1, Y);
87        int CountryId=GeoIpBs->GeoNmH.AddKey(CountrySNm);
88        TStr CityNm=Ss->At(3, Y);
89        int CityId=GeoIpBs->GeoNmH.AddKey(CityNm);
90        double Latitude=Ss->At(5, Y).GetFlt();
91        double Longitude=Ss->At(6, Y).GetFlt();
92        GeoIpBs->LocIdToCountryIdCityIdLatitudeLongitudeQuH.AddDat(
93         LocId, TIntIntFltFltQu(CountryId, CityId, Latitude, Longitude));
94      }}
95      {PSs Ss=TSs::LoadTxt(ssfCommaSep, CityBlocksFNm, TNotify::StdNotify, false);
96      for (int Y=2; Y<Ss->GetYLen(); Y++){
97        uint MnIpNum=Ss->At(0, Y).GetUInt();
98        uint MxIpNum=Ss->At(1, Y).GetUInt();
99        int LocId=Ss->At(2, Y).GetInt();
100        GeoIpBs->MnIpNumToMxIpNumLocIdPrH.AddDat(MnIpNum, TUIntIntPr(MxIpNum, LocId));
101        GeoIpBs->LocMnIpNumV.Add(MnIpNum);
102      }
103      printf("Sorting ... ");
104      GeoIpBs->LocMnIpNumV.Sort();}
105      printf("Done.\n");
106    }
107    return GeoIpBs;
108  }
</code></pre>
        </div>
        <div class="column">
            <h3>snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-geoip.cpp</h3>
            <pre><code>1  void TGeoIpBs::GetCountryNm(const TStr& IpNumStr, TStr& CountrySNm, TStr& CountryLNm){
2    CountrySNm="--"; CountryLNm="Unknown";
3    TStrV IpSubNumStrV; IpNumStr.SplitOnAllCh('.', IpSubNumStrV, false);
4    int IpSubNum0, IpSubNum1, IpSubNum2, IpSubNum3;
5    uint IpNum;
6    if (
7     IpSubNumStrV[0].IsInt(true, 0, 255, IpSubNum0)&&
8     IpSubNumStrV[1].IsInt(true, 0, 255, IpSubNum1)&&
9     IpSubNumStrV[2].IsInt(true, 0, 255, IpSubNum2)&&
10     IpSubNumStrV[3].IsInt(true, 0, 255, IpSubNum3)){
11      IpNum=16777216*IpSubNum0+65536*IpSubNum1+256*IpSubNum2+IpSubNum3;
12    } else {
13      return;
14    }
15    int CountryId=-1;
16    int IpNumN; CountryMnIpNumV.SearchBin(IpNum+1, IpNumN);
17    if (IpNumN>0){
18      uint MnIpNum=CountryMnIpNumV[IpNumN-1];
19      uint MxIpNum=MnIpNumToMxIpNumCountryIdPrH.GetDat(MnIpNum).Val1;
20      if ((MnIpNum<=IpNum)&&(IpNum<=MxIpNum)){
21        CountryId=MnIpNumToMxIpNumCountryIdPrH.GetDat(MnIpNum).Val2;
22      }
23    }
24    if (CountryId!=-1){
25      CountrySNm=CountrySNmToLNmH.GetKey(CountryId);
26      CountryLNm=CountrySNmToLNmH[CountryId];
27    }
28  }
29  void TGeoIpBs::GetLocation(const TStr& IpNumStr, 
30   TStr& CountrySNm, TStr& CityNm, double& Latitude, double& Longitude){
31    CountrySNm="--"; CityNm="Unknown"; Latitude=0; Longitude=0;
32    TStrV IpSubNumStrV; IpNumStr.SplitOnAllCh('.', IpSubNumStrV, false);
33    int IpSubNum0, IpSubNum1, IpSubNum2, IpSubNum3;
34    uint IpNum;
35    if (
36     IpSubNumStrV[0].IsInt(true, 0, 255, IpSubNum0)&&
37     IpSubNumStrV[1].IsInt(true, 0, 255, IpSubNum1)&&
38     IpSubNumStrV[2].IsInt(true, 0, 255, IpSubNum2)&&
39     IpSubNumStrV[3].IsInt(true, 0, 255, IpSubNum3)){
40      IpNum=16777216*IpSubNum0+65536*IpSubNum1+256*IpSubNum2+IpSubNum3;
41    } else {
42      return;
43    }
44    int LocId=-1;
45    int IpNumN; LocMnIpNumV.SearchBin(IpNum+1, IpNumN);
46    if (IpNumN>0){
47      uint MnIpNum=LocMnIpNumV[IpNumN-1];
48      uint MxIpNum=MnIpNumToMxIpNumLocIdPrH.GetDat(MnIpNum).Val1;
49      if ((MnIpNum<=IpNum)&&(IpNum<=MxIpNum)){
50        LocId=MnIpNumToMxIpNumLocIdPrH.GetDat(MnIpNum).Val2;
51      }
52    }
53    if (LocId!=-1){
54      int CountrySNmId=LocIdToCountryIdCityIdLatitudeLongitudeQuH.GetDat(LocId).Val1;
55      CountrySNm=GeoNmH.GetKey(CountrySNmId);
56      int CityNmId=LocIdToCountryIdCityIdLatitudeLongitudeQuH.GetDat(LocId).Val2;
57      CityNm=GeoNmH.GetKey(CityNmId);
58      Latitude=LocIdToCountryIdCityIdLatitudeLongitudeQuH.GetDat(LocId).Val3;
59      Longitude=LocIdToCountryIdCityIdLatitudeLongitudeQuH.GetDat(LocId).Val4;
60    }
61  }
62  PGeoIpBs TGeoIpBs::LoadCsv(const TStr& GeoIpFPath, const bool& CountriesOnlyP){
63    PGeoIpBs GeoIpBs=TGeoIpBs::New();
64    TStr GeoIpNrFPath=TStr::GetNrFPath(GeoIpFPath);
65    TStr CountryFNm=GeoIpNrFPath+"GeoIPCountryWhois.csv";
66    TStr CityLocationFNm=GeoIpNrFPath+"GeoLiteCity-Location.csv";
67    TStr CityBlocksFNm=GeoIpNrFPath+"GeoLiteCity-Blocks.csv";
68    {PSs Ss=TSs::LoadTxt(ssfCommaSep, CountryFNm, TNotify::StdNotify);
69    for (int Y=0; Y<Ss->GetYLen(); Y++){
70      uint MnIpNum=Ss->At(2, Y).GetUInt();
71      uint MxIpNum=Ss->At(3, Y).GetUInt();;
72      TStr CountrySNm=Ss->At(4, Y);
73      TStr CountryLNm=Ss->At(5, Y);
74      GeoIpBs->CountrySNmToLNmH.AddDat(CountrySNm)=CountryLNm;
75      int CountryId=GeoIpBs->CountrySNmToLNmH.GetKeyId(CountrySNm);
76      GeoIpBs->MnIpNumToMxIpNumCountryIdPrH.AddDat(MnIpNum, TUIntIntPr(MxIpNum, CountryId));
77      GeoIpBs->CountryMnIpNumV.Add(MnIpNum);
78    }
79    printf("Sorting ... ");
80    GeoIpBs->CountryMnIpNumV.Sort();}
81    printf("Done.\n");
82    if (!CountriesOnlyP){
83      {PSs Ss=TSs::LoadTxt(ssfCommaSep, CityLocationFNm, TNotify::StdNotify, false);
84      for (int Y=2; Y<Ss->GetYLen(); Y++){
85        int LocId=Ss->At(0, Y).GetInt();
86        TStr CountrySNm=Ss->At(1, Y);
87        int CountryId=GeoIpBs->GeoNmH.AddKey(CountrySNm);
88        TStr CityNm=Ss->At(3, Y);
89        int CityId=GeoIpBs->GeoNmH.AddKey(CityNm);
90        double Latitude=Ss->At(5, Y).GetFlt();
91        double Longitude=Ss->At(6, Y).GetFlt();
92        GeoIpBs->LocIdToCountryIdCityIdLatitudeLongitudeQuH.AddDat(
93         LocId, TIntIntFltFltQu(CountryId, CityId, Latitude, Longitude));
94      }}
95      {PSs Ss=TSs::LoadTxt(ssfCommaSep, CityBlocksFNm, TNotify::StdNotify, false);
96      for (int Y=2; Y<Ss->GetYLen(); Y++){
97        uint MnIpNum=Ss->At(0, Y).GetUInt();
98        uint MxIpNum=Ss->At(1, Y).GetUInt();
99        int LocId=Ss->At(2, Y).GetInt();
100        GeoIpBs->MnIpNumToMxIpNumLocIdPrH.AddDat(MnIpNum, TUIntIntPr(MxIpNum, LocId));
101        GeoIpBs->LocMnIpNumV.Add(MnIpNum);
102      }
103      printf("Sorting ... ");
<span onclick='openModal()' class='match'>104      GeoIpBs->LocMnIpNumV.Sort();}
105      printf("Done.\n");
106    }
</span>107    return GeoIpBs;
108  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-geoip.cpp</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-geoip.cpp</div>
                </div>
                <div class="column column_space"><pre><code>80    GeoIpBs->CountryMnIpNumV.Sort();}
81    printf("Done.\n");
82    if (!CountriesOnlyP){
</pre></code></div>
                <div class="column column_space"><pre><code>104      GeoIpBs->LocMnIpNumV.Sort();}
105      printf("Done.\n");
106    }
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    