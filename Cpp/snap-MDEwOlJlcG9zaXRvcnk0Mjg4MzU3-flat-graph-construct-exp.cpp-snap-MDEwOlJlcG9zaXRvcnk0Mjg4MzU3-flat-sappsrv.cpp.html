
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 7.531380753138076%, Tokens: 9, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-graph-construct-exp.cpp</h3>
            <pre><code>1  #include "stdafx.h"
2  #include <Snap.h>
3  #include <stdio.h>
4  #include <omp.h>
5  #include "benchmark-util.cpp"
6  #include "multimodal.cpp"
7  PSOut StdOut = TStdOut::New();
8  TStopwatch* Sw = TStopwatch::GetInstance();
9  int main(int argc, char* argv[])
10  {
11    TEnv Env(argc, argv);
12    TStr PrefixPath = Env.GetArgs() > 1 ? Env.GetArg(1) : TStr("");
13    Sw->Start(TStopwatch::LoadTables);
14    TTableContext Context;
15    TVec<TPair<PTable,TStr> > NodeTblV = TVec<TPair<PTable,TStr> >();
16    TVec<TQuad<PTable,TStr,TStr,TBool> > EdgeTblV = TVec<TQuad<PTable,TStr,TStr,TBool> >();
17    Schema NodeSchema = Schema();
18    Schema EdgeSchema = Schema();
19    LoadFlickrTables(PrefixPath, Context, NodeTblV, NodeSchema, EdgeTblV, EdgeSchema);
20    Sw->Stop(TStopwatch::LoadTables);
21    Sw->Start(TStopwatch::Preprocess);
22    THash<TStr,TStrH> NStrH;
23    TIntStrH NIdH;
24    Schema S;
25    S.Add(TPair<TStr,TAttrType>("SrcId", atInt));
26    S.Add(TPair<TStr,TAttrType>("DstId", atInt));
27    PTable CombinedTable = TTable::New(S, Context);
28    BuildCombinedEdgeTable(NodeTblV, EdgeTblV, NStrH, NIdH, CombinedTable);
29    Sw->Stop(TStopwatch::Preprocess);
<span onclick='openModal()' class='match'>30    int nExps = 40;
31    for (int i = 0; i < nExps; i++) {
32      Sw->Start(TStopwatch::Compute);
33      PNEANetMP Graph = TSnap::ToTNEANetMP2(CombinedTable, TStr("SrcId"), TStr("DstId"));
34      Sw->Stop(TStopwatch::Compute);
35    }
</span>36    PSOut TimeOut = TFOut::New(PrefixPath + TStr("time.txt"), true);
37    TimeOut->PutStrLn("===== Graph Construction =====");
38    TimeOut->PutStrLn(Env.GetCmLn());
39    TimeOut->PutStrFmtLn("Input Time = %f from %d", Sw->Avg(TStopwatch::LoadTables), Sw->Cnt(TStopwatch::LoadTables));
40    TimeOut->PutStrFmtLn("Preprocessing Time = %f from %d", Sw->Avg(TStopwatch::Preprocess), Sw->Cnt(TStopwatch::Preprocess));
41    TimeOut->PutStrFmtLn("Graph Construction Time = %f from %d", Sw->Avg(TStopwatch::Compute), Sw->Cnt(TStopwatch::Compute));
42    TimeOut->PutStrFmtLn("Allocate Copies = %f from %d", Sw->Avg(TStopwatch::AllocateColumnCopies), Sw->Cnt(TStopwatch::AllocateColumnCopies));
43    TimeOut->PutStrFmtLn("Copy = %f from %d", Sw->Avg(TStopwatch::CopyColumns), Sw->Cnt(TStopwatch::CopyColumns));
44    TimeOut->PutStrFmtLn("Sort = %f from %d", Sw->Avg(TStopwatch::Sort), Sw->Cnt(TStopwatch::Sort));
45    TimeOut->PutStrFmtLn("Group = %f from %d", Sw->Avg(TStopwatch::Group), Sw->Cnt(TStopwatch::Group));
46    TimeOut->PutStrFmtLn("Merge Neighborhood = %f from %d", Sw->Avg(TStopwatch::MergeNeighborhoods), Sw->Cnt(TStopwatch::MergeNeighborhoods));
47    TimeOut->PutStrFmtLn("Add Neighborhood = %f from %d", Sw->Avg(TStopwatch::AddNeighborhoods), Sw->Cnt(TStopwatch::AddNeighborhoods));
48    TimeOut->PutStrFmtLn("Add Edges = %f from %d", Sw->Avg(TStopwatch::AddEdges), Sw->Cnt(TStopwatch::AddEdges));
49  	return 0;
50  }
</code></pre>
        </div>
        <div class="column">
            <h3>snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-sappsrv.cpp</h3>
            <pre><code>1  bool TSAppSrvFun::IsFldNm(const TStrKdV& FldNmValPrV, const TStr& FldNm) {
2  	const int ValN = FldNmValPrV.SearchForw(TStrKd(FldNm, ""));
3  	return (ValN != -1);
4  }
5  TStr TSAppSrvFun::GetFldVal(const TStrKdV& FldNmValPrV, 
6  		const TStr& FldNm, const TStr& DefFldVal) {
7  	const int ValN = FldNmValPrV.SearchForw(TStrKd(FldNm, ""));
8  	return (ValN == -1) ? DefFldVal : FldNmValPrV[ValN].Dat;	
9  }
10  void TSAppSrvFun::GetFldValV(const TStrKdV& FldNmValPrV, const TStr& FldNm, TStrV& FldValV) {
11  	FldValV.Clr();
12  	int ValN = FldNmValPrV.SearchForw(TStrKd(FldNm, ""));
13  	while (ValN != -1) {
14  		FldValV.Add(FldNmValPrV[ValN].Dat);
15  		ValN = FldNmValPrV.SearchForw(TStrKd(FldNm, ""), ValN + 1);
16  	}
17  }
18  bool TSAppSrvFun::IsFldNmVal(const TStrKdV& FldNmValPrV, 
19  		const TStr& FldNm, const TStr& FldVal) {
20  	int ValN = FldNmValPrV.SearchForw(TStrKd(FldNm, ""));
21  	while (ValN != -1) {
22  		if (FldNmValPrV[ValN].Dat == FldVal) { return true; }
23  		ValN = FldNmValPrV.SearchForw(TStrKd(FldNm, ""), ValN + 1);
24  	}
25  	return false;
26  }
27  PXmlDoc TSAppSrvFun::GetErrorRes(const TStr& ErrorStr) {
28  	PXmlTok TopTok = TXmlTok::New("error", ErrorStr);
29  	return TXmlDoc::New(TopTok);
30  }
31  TSAppSrv::TSAppSrv(const int& PortN, const TSAppSrvFunV& SrvFunV, 
32          const PNotify& Notify): TWebSrv(PortN, true, Notify) {
33      for (int SrvFunN = 0; SrvFunN < SrvFunV.Len(); SrvFunN++) {
34          PSAppSrvFun SrvFun =  SrvFunV[SrvFunN];
35          FunNmToFunH.AddDat(SrvFun->GetFunNm(), SrvFun);
36      }
37  	XmlHdStr = "<?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?>\n";
38  }
39  void TSAppSrv::OnHttpRq(const int& SockId, const PHttpRq& HttpRq) {
40      PHttpResp HttpResp;
41      try {
42          EAssertR(HttpRq->IsOk(), "Bad HTTP request!");
43          PUrl RqUrl = HttpRq->GetUrl();
44          EAssertR(RqUrl->IsOk(), "Bad request URL!");
45          PUrl HttpRqUrl = HttpRq->GetUrl();
46          TStr FunNm = HttpRqUrl->GetPathSeg(0);
47          EAssertR(FunNmToFunH.IsKey(FunNm) || FunNm.Empty(), "Unknown function '" + FunNm + "' !");
48          TStrKdV FldNmValPrV;
49          PUrlEnv HttpRqUrlEnv = HttpRq->GetUrlEnv();
50          const int Keys = HttpRqUrlEnv->GetKeys();
51          for (int KeyN = 0; KeyN < Keys; KeyN++) {
52              TStr KeyNm = HttpRqUrlEnv->GetKeyNm(KeyN);
<span onclick='openModal()' class='match'>53              const int Vals = HttpRqUrlEnv->GetVals(KeyN);
54              for (int ValN = 0; ValN < Vals; ValN++) {
55                  TStr Val = HttpRqUrlEnv->GetVal(KeyN, ValN);
56                  FldNmValPrV.Add(TStrKd(KeyNm, Val));
57              }
</span>58          }
59          TStr TimeNow = TTm::GetCurLocTm().GetWebLogDateTimeStr(true);
60          GetNotify()->OnStatus(TStr::Fmt("[%s] Request %s", TimeNow.CStr(), FunNm.CStr()));
61  		PSAppSrvRqEnv RqEnv = TSAppSrvRqEnv::New(this, SockId, HttpRq);
62  		PSIn BodySIn; TStr ContTypeVal;
63  		if (!FunNm.Empty()) {
64  			PSAppSrvFun SrvFun = FunNmToFunH.GetDat(FunNm);
65  			if (SrvFun->GetFunOutType() == saotXml) {
66  				PXmlDoc ResXmlDoc = SrvFun->Exec(FldNmValPrV, RqEnv);        
67  				TStr ResXmlStr; ResXmlDoc->SaveStr(ResXmlStr);
68  				BodySIn = TMIn::New(XmlHdStr + ResXmlStr);
69  				ContTypeVal = THttp::TextXmlFldVal;
70  			} else if (SrvFun->GetFunOutType() == saotJSon) {
71  				TStr ResStr = SrvFun->ExecJSon(FldNmValPrV, RqEnv);
72  				BodySIn = TMIn::New(ResStr);
73  				ContTypeVal = THttp::AppJSonFldVal;
74  			} else {
75  				BodySIn = SrvFun->ExecCustom(FldNmValPrV, RqEnv, ContTypeVal);
76  			}
77  		} else {
78  			PXmlTok TopTok = TXmlTok::New("registered-functions");
79  			int KeyId = FunNmToFunH.FFirstKeyId();
80  			while (FunNmToFunH.FNextKeyId(KeyId)) {
81  				PXmlTok FunTok = TXmlTok::New("function");
82  				FunTok->AddArg("name", FunNmToFunH.GetKey(KeyId));
83  				TopTok->AddSubTok(FunTok);
84  			}
85  			PXmlDoc ResXmlDoc = TXmlDoc::New(TopTok);
86  			TStr ResXmlStr; ResXmlDoc->SaveStr(ResXmlStr);
87  			BodySIn = TMIn::New(XmlHdStr + ResXmlStr);
88  			ContTypeVal = THttp::TextXmlFldVal;
89  		}
90          HttpResp = THttpResp::New(THttp::OkStatusCd, 
91              ContTypeVal, false, BodySIn);
92      } catch (PExcept Except) {
93  		PXmlTok TopTok = TXmlTok::New("error");
94  		TopTok->AddSubTok(TXmlTok::New("message", Except->GetMsgStr()));
95  		TopTok->AddSubTok(TXmlTok::New("location", Except->GetLocStr()));
96  		PXmlDoc ErrorXmlDoc = TXmlDoc::New(TopTok); 
97          TStr ResXmlStr; ErrorXmlDoc->SaveStr(ResXmlStr);
98          HttpResp = THttpResp::New(THttp::OkStatusCd, 
99              THttp::TextHtmlFldVal, false, 
100  			TMIn::New(XmlHdStr + ResXmlStr));
101      } catch (...) {
102  		PXmlDoc ErrorXmlDoc = TXmlDoc::New(TXmlTok::New("error")); 
103          TStr ResXmlStr; ErrorXmlDoc->SaveStr(ResXmlStr);
104          HttpResp = THttpResp::New(THttp::OkStatusCd, 
105              THttp::TextHtmlFldVal, false, 
106  			TMIn::New(XmlHdStr + ResXmlStr));
107      }
108      SendHttpResp(SockId, HttpResp); 
109  }
110  void TSASFunFile::LoadFunFileV(const TStr& FPath, TSAppSrvFunV& SrvFunV) {
111  	TFFile File(FPath, "", false); TStr FNm;
112  	while (File.Next(FNm)) {
113  		TStr FExt = FNm.GetFExt();
114  		TStr FUrl = FNm.GetSubStr(FPath.Len());
115  		FUrl.ChangeChAll('\\', '/');
116  		printf("%s %s %s\n", FNm.CStr(), FExt.CStr(), FUrl.CStr());
117  		if (FExt == ".htm") { SrvFunV.Add(TSASFunFile::New(FUrl, FNm, THttp::TextHtmlFldVal)); }
118  		else if (FExt == ".html") { SrvFunV.Add(TSASFunFile::New(FUrl, FNm, THttp::TextHtmlFldVal)); }
119  		else if (FExt == ".js") { SrvFunV.Add(TSASFunFile::New(FUrl, FNm, THttp::TextJavaScriptFldVal)); }
120  		else if (FExt == ".css") { SrvFunV.Add(TSASFunFile::New(FUrl, FNm, THttp::TextCssFldVal)); }
121  		else if (FExt == ".jpg") { SrvFunV.Add(TSASFunFile::New(FUrl, FNm, THttp::ImageJpgFldVal)); }
122  		else if (FExt == ".jpeg") { SrvFunV.Add(TSASFunFile::New(FUrl, FNm, THttp::ImageJpgFldVal)); }
123  		else if (FExt == ".gif") { SrvFunV.Add(TSASFunFile::New(FUrl, FNm, THttp::ImageGifFldVal)); }
124  		else {
125  			printf("Unknown MIME type for extension '%s' for file '%s'", FExt.CStr(), FNm.CStr());
126  			SrvFunV.Add(TSASFunFile::New(FUrl, FNm, THttp::AppOctetFldVal)); 
127  		}
128  	}	
129  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-graph-construct-exp.cpp</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-sappsrv.cpp</div>
                </div>
                <div class="column column_space"><pre><code>30    int nExps = 40;
31    for (int i = 0; i < nExps; i++) {
32      Sw->Start(TStopwatch::Compute);
33      PNEANetMP Graph = TSnap::ToTNEANetMP2(CombinedTable, TStr("SrcId"), TStr("DstId"));
34      Sw->Stop(TStopwatch::Compute);
35    }
</pre></code></div>
                <div class="column column_space"><pre><code>53              const int Vals = HttpRqUrlEnv->GetVals(KeyN);
54              for (int ValN = 0; ValN < Vals; ValN++) {
55                  TStr Val = HttpRqUrlEnv->GetVal(KeyN, ValN);
56                  FldNmValPrV.Add(TStrKd(KeyNm, Val));
57              }
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    