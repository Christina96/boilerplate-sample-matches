<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Matches for id3v1tag.cpp & mp4coverart.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<body>
  <div style="align-items: center; display: flex; justify-content: space-around;">
    <div>
      <h3 align="center">
Matches for id3v1tag.cpp & mp4coverart.cpp
      </h3>
      <h1 align="center">
        7.8%
      </h1>
      <center>
        <a href="index.html" target="_top">
          INDEX
        </a>
        <span>-</span>
        <a href="help-en.html" target="_top">
          HELP
        </a>
      </center>
    </div>
    <div>
<TABLE BORDER="1" CELLSPACING="0" BGCOLOR="#d0d0d0">
<TR><TH><TH>id3v1tag.cpp (4.9180326%)<TH>mp4coverart.cpp (19.047619%)<TH>Tokens
<TR><TD BGCOLOR="#0000ff"><FONT COLOR="#0000ff">-</FONT><TD><A HREF="javascript:ZweiFrames('match1219-0.html#0',2,'match1219-1.html#0',3)" NAME="0">(127-135)<TD><A HREF="javascript:ZweiFrames('match1219-0.html#0',2,'match1219-1.html#0',3)" NAME="0">(83-92)</A><TD ALIGN=center><FONT COLOR="#ff0000">12</FONT>
</TABLE>
    </div>
  </div>
  <hr>
  <div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>id3v1tag.cpp</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/***************************************************************************
    copyright            : (C) 2002 - 2008 by Scott Wheeler
    email                : wheeler@kde.org
 ***************************************************************************/

/***************************************************************************
 *   This library is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU Lesser General Public License version   *
 *   2.1 as published by the Free Software Foundation.                     *
 *                                                                         *
 *   This library is distributed in the hope that it will be useful, but   *
 *   WITHOUT ANY WARRANTY; without even the implied warranty of            *
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU     *
 *   Lesser General Public License for more details.                       *
 *                                                                         *
 *   You should have received a copy of the GNU Lesser General Public      *
 *   License along with this library; if not, write to the Free Software   *
 *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA         *
 *   02110-1301  USA                                                       *
 *                                                                         *
 *   Alternatively, this file is available under the Mozilla Public        *
 *   License Version 1.1.  You may obtain a copy of the License at         *
 *   http://www.mozilla.org/MPL/                                           *
 ***************************************************************************/

#include &lt;tdebug.h&gt;
#include &lt;tfile.h&gt;

#include &quot;id3v1tag.h&quot;
#include &quot;id3v1genres.h&quot;

using namespace TagLib;
using namespace ID3v1;

namespace
{
  const ID3v1::StringHandler defaultStringHandler;
  const ID3v1::StringHandler *stringHandler = &amp;defaultStringHandler;
}

class ID3v1::Tag::TagPrivate
{
public:
  TagPrivate() :
    file(0),
    tagOffset(0),
    track(0),
    genre(255) {}

  File *file;
  long tagOffset;

  String title;
  String artist;
  String album;
  String year;
  String comment;
  unsigned char track;
  unsigned char genre;
};

////////////////////////////////////////////////////////////////////////////////
// StringHandler implementation
////////////////////////////////////////////////////////////////////////////////

StringHandler::StringHandler()
{
}

String ID3v1::StringHandler::parse(const ByteVector &amp;data) const
{
  return String(data, String::Latin1).stripWhiteSpace();
}

ByteVector ID3v1::StringHandler::render(const String &amp;s) const
{
  if(s.isLatin1())
    return s.data(String::Latin1);
  return ByteVector();
}

////////////////////////////////////////////////////////////////////////////////
// public methods
////////////////////////////////////////////////////////////////////////////////

ID3v1::Tag::Tag() :
  d(new TagPrivate())
{
}

ID3v1::Tag::Tag(File *file, long tagOffset) :
  d(new TagPrivate())
{
  d-&gt;file = file;
  d-&gt;tagOffset = tagOffset;

  read();
}

ID3v1::Tag::~Tag()
{
  delete d;
}

ByteVector ID3v1::Tag::render() const
{
  ByteVector data;

  data.append(fileIdentifier());
  data.append(stringHandler-&gt;render(d-&gt;title).resize(30));
  data.append(stringHandler-&gt;render(d-&gt;artist).resize(30));
  data.append(stringHandler-&gt;render(d-&gt;album).resize(30));
  data.append(stringHandler-&gt;render(d-&gt;year).resize(4));
  data.append(stringHandler-&gt;render(d-&gt;comment).resize(28));
  data.append(char(0));
  data.append(char(d-&gt;track));
  data.append(char(d-&gt;genre));

  return data;
}

ByteVector ID3v1::Tag::fileIdentifier()
{
<A NAME="0"></A>  return ByteVector::fromCString(&quot;TAG&quot;);
}

<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match1219-1.html#0',3,'match1219-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>String ID3v1::Tag::title() const
{
  return d-&gt;title;
}

String ID3v1::Tag::artist() const
{
  return d-&gt;artist;
}</B></FONT>

String ID3v1::Tag::album() const
{
  return d-&gt;album;
}

String ID3v1::Tag::comment() const
{
  return d-&gt;comment;
}

String ID3v1::Tag::genre() const
{
  return ID3v1::genre(d-&gt;genre);
}

unsigned int ID3v1::Tag::year() const
{
  return d-&gt;year.toInt();
}

unsigned int ID3v1::Tag::track() const
{
  return d-&gt;track;
}

void ID3v1::Tag::setTitle(const String &amp;s)
{
  d-&gt;title = s;
}

void ID3v1::Tag::setArtist(const String &amp;s)
{
  d-&gt;artist = s;
}

void ID3v1::Tag::setAlbum(const String &amp;s)
{
  d-&gt;album = s;
}

void ID3v1::Tag::setComment(const String &amp;s)
{
  d-&gt;comment = s;
}

void ID3v1::Tag::setGenre(const String &amp;s)
{
  d-&gt;genre = ID3v1::genreIndex(s);
}

void ID3v1::Tag::setYear(unsigned int i)
{
  d-&gt;year = i &gt; 0 ? String::number(i) : String();
}

void ID3v1::Tag::setTrack(unsigned int i)
{
  d-&gt;track = i &lt; 256 ? i : 0;
}

unsigned int ID3v1::Tag::genreNumber() const
{
  return d-&gt;genre;
}

void ID3v1::Tag::setGenreNumber(unsigned int i)
{
  d-&gt;genre = i &lt; 256 ? i : 255;
}

void ID3v1::Tag::setStringHandler(const StringHandler *handler)
{
  if(handler)
    stringHandler = handler;
  else
    stringHandler = &amp;defaultStringHandler;
}

////////////////////////////////////////////////////////////////////////////////
// protected methods
////////////////////////////////////////////////////////////////////////////////

void ID3v1::Tag::read()
{
  if(d-&gt;file &amp;&amp; d-&gt;file-&gt;isValid()) {
    d-&gt;file-&gt;seek(d-&gt;tagOffset);
    // read the tag -- always 128 bytes
    const ByteVector data = d-&gt;file-&gt;readBlock(128);

    // some initial sanity checking
    if(data.size() == 128 &amp;&amp; data.startsWith(&quot;TAG&quot;))
      parse(data);
    else
      debug(&quot;ID3v1 tag is not valid or could not be read at the specified offset.&quot;);
  }
}

void ID3v1::Tag::parse(const ByteVector &amp;data)
{
  int offset = 3;

  d-&gt;title = stringHandler-&gt;parse(data.mid(offset, 30));
  offset += 30;

  d-&gt;artist = stringHandler-&gt;parse(data.mid(offset, 30));
  offset += 30;

  d-&gt;album = stringHandler-&gt;parse(data.mid(offset, 30));
  offset += 30;

  d-&gt;year = stringHandler-&gt;parse(data.mid(offset, 4));
  offset += 4;

  // Check for ID3v1.1 -- Note that ID3v1 *does not* support &quot;track zero&quot; -- this
  // is not a bug in TagLib.  Since a zeroed byte is what we would expect to
  // indicate the end of a C-String, specifically the comment string, a value of
  // zero must be assumed to be just that.

  if(data[offset + 28] == 0 &amp;&amp; data[offset + 29] != 0) {
    // ID3v1.1 detected

    d-&gt;comment = stringHandler-&gt;parse(data.mid(offset, 28));
    d-&gt;track   = static_cast&lt;unsigned char&gt;(data[offset + 29]);
  }
  else
    d-&gt;comment = data.mid(offset, 30);

  offset += 30;

  d-&gt;genre = static_cast&lt;unsigned char&gt;(data[offset]);
}
</PRE>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>mp4coverart.cpp</span>
<span> - </span>
<span></span>
</center>
</h3>
<HR>
<PRE>
/**************************************************************************
    copyright            : (C) 2009 by Lukáš Lalinský
    email                : lalinsky@gmail.com
 **************************************************************************/

/***************************************************************************
 *   This library is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU Lesser General Public License version   *
 *   2.1 as published by the Free Software Foundation.                     *
 *                                                                         *
 *   This library is distributed in the hope that it will be useful, but   *
 *   WITHOUT ANY WARRANTY; without even the implied warranty of            *
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU     *
 *   Lesser General Public License for more details.                       *
 *                                                                         *
 *   You should have received a copy of the GNU Lesser General Public      *
 *   License along with this library; if not, write to the Free Software   *
 *   Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA         *
 *   02110-1301  USA                                                       *
 *                                                                         *
 *   Alternatively, this file is available under the Mozilla Public        *
 *   License Version 1.1.  You may obtain a copy of the License at         *
 *   http://www.mozilla.org/MPL/                                           *
 ***************************************************************************/

#include &lt;taglib.h&gt;
#include &lt;tdebug.h&gt;
#include &quot;trefcounter.h&quot;
#include &quot;mp4coverart.h&quot;

using namespace TagLib;

class MP4::CoverArt::CoverArtPrivate : public RefCounter
{
public:
  CoverArtPrivate() :
    format(MP4::CoverArt::JPEG) {}

  Format format;
  ByteVector data;
};

////////////////////////////////////////////////////////////////////////////////
// public members
////////////////////////////////////////////////////////////////////////////////

MP4::CoverArt::CoverArt(Format format, const ByteVector &amp;data) :
  d(new CoverArtPrivate())
{
  d-&gt;format = format;
  d-&gt;data = data;
}

MP4::CoverArt::CoverArt(const CoverArt &amp;item) :
  d(item.d)
{
  d-&gt;ref();
}

MP4::CoverArt &amp;
MP4::CoverArt::operator=(const CoverArt &amp;item)
{
  CoverArt(item).swap(*this);
  return *this;
}

void
MP4::CoverArt::swap(CoverArt &amp;item)
{
  using std::swap;

  swap(d, item.d);
}

MP4::CoverArt::~CoverArt()
{
  if(d-&gt;deref()) {
    delete d;
  }
<A NAME="0"></A>}

MP4::CoverArt::Format
<FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match1219-0.html#0',2,'match1219-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>MP4::CoverArt::format() const
{
  return d-&gt;format;
}

ByteVector
MP4::CoverArt::data() const
{
  return d-&gt;data;
}</B></FONT>
</PRE>
</div>
  </div>
</body>
</html>
