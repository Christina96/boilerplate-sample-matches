
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 5.787781350482315%, Tokens: 9, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-acquis.cpp</h3>
            <pre><code>1  void TAcquisBs::SaveAcquisToCpd(
2   const TStr& InAcquisFPath, const TStrV& AcquisLangNmV, const TStr& OutCpdFNm){
3    printf("Saving to %s ...\n", OutCpdFNm.CStr());
4    PSOut SOut=TFOut::New(OutCpdFNm);
5    TFFile FPathFFile(TStr::GetNrFPath(InAcquisFPath)+"*"); TStr FPath;
6    while (FPathFFile.Next(FPath)){
7      if (!FPathFFile.IsDir()){continue;}
8      TStr LangNm=FPath.GetFBase();
9      if (!AcquisLangNmV.Empty()&&(!AcquisLangNmV.IsIn(LangNm))){continue;}
10      printf("%s\n", FPath.CStr());
11      TFFile YearFPathFFile(TStr::GetNrFPath(FPath)+"*"); TStr YearFPath;
12      while (YearFPathFFile.Next(YearFPath)){
13        if (!YearFPathFFile.IsDir()){continue;}
14        TStr YearStr=YearFPath.GetFBase();
15        printf("%s\n", YearFPath.CStr());
16        TFFile FFile(TStr::GetNrFPath(YearFPath)+"*", true); TStr XmlFNm;
17        while (FFile.Next(XmlFNm)){
18          PXmlDoc XmlDoc=TXmlDoc::LoadTxt(XmlFNm);
19          IAssert(XmlDoc->IsOk());
20          TStr DocNm=XmlDoc->GetTok()->GetArgVal("id");
21          TStrV EuroVocCatNmV;
22          PXmlTok EuroVocXmlTok=XmlDoc->GetTagTok("TEI.2|teiHeader|profileDesc|textClass");
23          if (!EuroVocXmlTok.Empty()){
24            for (int TokN=0; TokN<EuroVocXmlTok->GetSubToks(); TokN++){
25              PXmlTok SubXmlTok=EuroVocXmlTok->GetSubTok(TokN);
26              if (SubXmlTok->IsTag("classCode")){
27                IAssert(SubXmlTok->GetArgVal("scheme")=="eurovoc");
28                TStr EuroVocCatNm=SubXmlTok->GetTagVal(SubXmlTok->GetTagNm(), false);
29                EuroVocCatNmV.Add(EuroVocCatNm);
30              }
<span onclick='openModal()' class='match'>31            }
32          }
33          TStrV ParStrV; TStr TitleStr;
34          PXmlTok BodyXmlTok=XmlDoc->GetTagTok("TEI.2|text|body");
35          for (int TokN=0; TokN<BodyXmlTok->GetSubToks(); TokN++){
36            PXmlTok SubXmlTok=BodyXmlTok->GetSubTok(TokN);
</span>37            if (SubXmlTok->IsTag("head")||SubXmlTok->IsTag("p")){
38              if (SubXmlTok->IsTag("head")){
39                TitleStr=SubXmlTok->GetTagVal(SubXmlTok->GetTagNm(), false);}
40              int ParN=SubXmlTok->GetIntArgVal("n", -1);
41              if ((ParStrV.Len()==0)&&(ParN==2)){ParStrV.Add();}
42              IAssert((ParN!=-1)||(ParN-1==ParStrV.Len()));
43              TStr ParStr=SubXmlTok->GetTagVal(SubXmlTok->GetTagNm(), false);
44              ParStrV.Add(ParStr);
45            }
46          }
47          PCpDoc CpDoc=TCpDoc::New();
48          CpDoc->DocNm=DocNm;
49          CpDoc->DateStr=YearStr;
50          CpDoc->TitleStr=TitleStr;
51          CpDoc->ParStrV=ParStrV;
52          CpDoc->TopCdNmV=EuroVocCatNmV;
53          CpDoc->Save(*SOut);
54        }
55      }
56    }
57    printf("\nDone.\n");
58  }
</code></pre>
        </div>
        <div class="column">
            <h3>snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-bowactlearn.cpp</h3>
            <pre><code>1  TBowAL::TBowAL(const PBowDocBs& _BowDocBs, const int& _CId, const double& _SvmC,
2          const double& _SvmJ, const TIntV& _DIdV): BowDocBs(_BowDocBs),
3          SvmC(_SvmC), SvmJ(_SvmJ), CId(_CId) {
4      ALType = baltCat;
5      IAssert(BowDocBs->IsCId(CId));
6      TIntV DIdV = _DIdV;
7      if (DIdV.Len() == 0) { BowDocBs->GetAllDIdV(DIdV); }
8      for (int DIdN = 0; DIdN < DIdV.Len(); DIdN++){
9          int DId = DIdV[DIdN];
10          if (BowDocBs->GetDocCIds(DId) > 0){
11              LabeledDIdV.Add(DIdN);
12          } else {
13              UnlabeledDIdV.Add(DIdN);
14          }
15      }
16      BowDocWgtBs = TBowDocWgtBs::New(BowDocBs, bwwtLogDFNrmTFIDF, 0.0, 0, DIdV);
17      DocSet = TBowDocBs2TrainSet::NewBowAllCat(BowDocBs, BowDocWgtBs, CId, DIdV);
18  }
19  TBowAL::TBowAL(const PBowDocBs& _BowDocBs, const TStr& _QueryStr,
20          const int& _MnPosDocs, const int& _MnNegDocs, const double& _SvmC,
21          const double& _SvmJ, const TIntV& _DIdV): BowDocBs(_BowDocBs),
22          SvmC(_SvmC), SvmJ(_SvmJ),
23          QueryStr(_QueryStr), MnPosDocs(_MnPosDocs), MnNegDocs(_MnNegDocs) {
24      Assert((MnPosDocs > 0) && (MnNegDocs > 0));
25      ALType = baltQuery;
26      InfoRetModeP = true;
27      TIntV DIdV = _DIdV;
28      if (DIdV.Len() == 0) { BowDocBs->GetAllDIdV(DIdV); }
29      BowDocWgtBs = TBowDocWgtBs::New(BowDocBs, bwwtLogDFNrmTFIDF, 0.0, 0, DIdV);
30      QuerySpV = BowDocBs->GetSpVFromHtmlStr(QueryStr, BowDocWgtBs);
31      DocSet = TBowDocBs2TrainSet::NewBowNoCat(BowDocWgtBs, DIdV, 0.0);
32      LabeledDIdV.Clr();
33      UnlabeledDIdV.Gen(DIdV.Len(), 0);
34      for (int DIdN = 0; DIdN < DIdV.Len(); DIdN++) {
35          UnlabeledDIdV.Add(DIdN);
36          IAssert(DIdV[DIdN] == DocSet->GetAttrBowV(DIdN)->GetDId());
37      }
38  }
39  bool TBowAL::GenQueryDIdV(const bool& GenStatP){
40      DistDIdPrV.Clr();
41      if (UnlabeledDIdV.Empty()){return false;}
42      if ((ALType == baltQuery) && InfoRetModeP) {
43          Assert((ALType == baltQuery) && InfoRetModeP);
44          const bool HasPosDocs = DocSet->HasPosVecs(MnPosDocs);
45          const bool HasNegDocs = DocSet->HasNegVecs(MnNegDocs);
46          if (HasPosDocs && HasNegDocs) {
47              InfoRetModeP = false;
48          } else {
49              PBowSim BowSim = TBowSim::New(bstCos);
50              for (int UnLblDIdN = 0; UnLblDIdN < UnlabeledDIdV.Len(); UnLblDIdN++){
51                  PBowSpV DocSpV = DocSet->GetAttrBowV(UnlabeledDIdV[UnLblDIdN]);
52                  double Dist = 1 - BowSim->GetSim(QuerySpV, DocSpV);
53                  DistDIdPrV.Add(TFltIntPr(Dist, DocSpV->GetDId()));
54              }
55              DistDIdPrV.Sort();
56              if (HasPosDocs) { DistDIdPrV.Reverse(); }
57          }
58      }
59      if ((ALType == baltCat) || ((ALType == baltQuery)&&(!InfoRetModeP))) {
60          PSVMModel Md = TSVMModel::NewClsLinear(DocSet, SvmC, SvmJ, LabeledDIdV);
61          for (int UnLblDIdN = 0; UnLblDIdN < UnlabeledDIdV.Len(); UnLblDIdN++){
62              PBowSpV DocSpV = DocSet->GetAttrBowV(UnlabeledDIdV[UnLblDIdN]);
63              double Cfy = Md->GetRes(DocSpV);
64              double Dist = fabs(Cfy);
65              DistDIdPrV.Add(TFltIntPr(Dist, DocSpV->GetDId()));
66          }
67          DistDIdPrV.Sort();
68          if (GenStatP) {
69              TFltV NormalV; Md->GetWgtV(NormalV); TIntFltKdV WIdWgtV;
70              DocSet->GetKeywords(NormalV, WIdWgtV, LabeledDIdV);
71              if (!WIdWgtV.Empty()) {
72                  KeyWdStr = BowDocBs->GetWordStr(WIdWgtV[0].Key);
73                  for (int WIdN = 1; WIdN < WIdWgtV.Len(); WIdN++) {
74                      KeyWdStr += ", " + BowDocBs->GetWordStr(WIdWgtV[WIdN].Key); }
75                  KeyWdStr.ToLc(); KeyWdStr.ChangeChAll('_', ' ');
76              } else {
77                  KeyWdStr = "";
78              }
79              PosDocN = NegDocN = 0;
80              for (int DocN = 0; DocN < DocSet->Len(); DocN++) {
81                  if (DocSet->GetVecParam(DocN) > 0.1) { PosDocN++; }
82                  else if (DocSet->GetVecParam(DocN) < -0.1) { NegDocN++; }
83              }
84              for (int UnLblDIdN = 0; UnLblDIdN < UnlabeledDIdV.Len(); UnLblDIdN++){
85                  PBowSpV DocSpV = DocSet->GetAttrBowV(UnlabeledDIdV[UnLblDIdN]);
86                  double Dist = Md->GetRes(DocSpV);
87                  if (Dist > 0.0) { PosDocN++; }
88                  else { NegDocN++; }
89              }
90          }
91      }
92      return true;
93  }
94  void TBowAL::MarkQueryDoc(const int& QueryDId, const bool& AssignToCatP){
95      int QueryDIdN = -1;
96      for (int DocN = 0; DocN < DocSet->Len(); DocN++) {
97          if (DocSet->GetAttrBowV(DocN)->GetDId() == QueryDId) {
98              QueryDIdN = DocN; break; }
99      }
100      if (QueryDIdN >= 0) {
101          UnlabeledDIdV.DelIfIn(QueryDIdN);
102          LabeledDIdV.AddUnique(QueryDIdN);
103          if (AssignToCatP){
104              if (ALType == baltCat) { BowDocBs->AddDocCId(QueryDId, CId); }
105              DocSet->SetVecParam(QueryDIdN, 1.0);
106          } else {
107              DocSet->SetVecParam(QueryDIdN, -1.0);
108          }
109      } else {
110          InfoNotify(TStr::Fmt("Wrong QueryDId (%d)!", QueryDId)); 
111      }
112  }
113  void TBowAL::MarkUnlabeledPosDocs(){
114      PSVMModel Md = TSVMModel::NewClsLinear(DocSet, SvmC, SvmJ, LabeledDIdV);
115      for (int UnLblDIdN = 0; UnLblDIdN < UnlabeledDIdV.Len(); UnLblDIdN++){
116          PBowSpV DocSpV = DocSet->GetAttrBowV(UnlabeledDIdV[UnLblDIdN]);
117          double Dist = Md->GetRes(DocSpV);
118          if (Dist>0){
119              BowDocBs->AddDocCId(DocSpV->GetDId(), CId);
120          }
121      }
122  }
123  void TBowAL::GetAllPosDocs(TIntV& PosDIdV){
124      for (int LblDIdN = 0; LblDIdN < LabeledDIdV.Len(); LblDIdN++) {
125          if (DocSet->GetVecDId(LabeledDIdV[LblDIdN]) > 0.0) {
126              PosDIdV.Add(DocSet->GetAttrBowV(LabeledDIdV[LblDIdN])->GetDId());
<span onclick='openModal()' class='match'>127          }
128      }
129      PSVMModel Md = TSVMModel::NewClsLinear(DocSet, SvmC, SvmJ, LabeledDIdV);
130      for (int UnLblDIdN = 0; UnLblDIdN < UnlabeledDIdV.Len(); UnLblDIdN++){
131          PBowSpV DocSpV = DocSet->GetAttrBowV(UnlabeledDIdV[UnLblDIdN]);
</span>132          double Dist = Md->GetRes(DocSpV);
133          if (Dist>0){
134              PosDIdV.Add(DocSpV->GetDId());
135          }
136      }
137      PosDIdV.Pack(); PosDIdV.Sort();
138  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-acquis.cpp</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from snap-MDEwOlJlcG9zaXRvcnk0Mjg4MzU3-flat-bowactlearn.cpp</div>
                </div>
                <div class="column column_space"><pre><code>31            }
32          }
33          TStrV ParStrV; TStr TitleStr;
34          PXmlTok BodyXmlTok=XmlDoc->GetTagTok("TEI.2|text|body");
35          for (int TokN=0; TokN<BodyXmlTok->GetSubToks(); TokN++){
36            PXmlTok SubXmlTok=BodyXmlTok->GetSubTok(TokN);
</pre></code></div>
                <div class="column column_space"><pre><code>127          }
128      }
129      PSVMModel Md = TSVMModel::NewClsLinear(DocSet, SvmC, SvmJ, LabeledDIdV);
130      for (int UnLblDIdN = 0; UnLblDIdN < UnlabeledDIdV.Len(); UnLblDIdN++){
131          PBowSpV DocSpV = DocSet->GetAttrBowV(UnlabeledDIdV[UnLblDIdN]);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    