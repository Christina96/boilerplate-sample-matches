<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Matches for pieces_ex_legmoves.c &amp; pieces_legmoves.c</title>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<style>.modal {display: none;position: fixed;z-index: 1;left: 0;top: 0;width: 100%;height: 100%;overflow: auto;background-color: rgb(0, 0, 0);background-color: rgba(0, 0, 0, 0.4);}  .modal-content {height: 250%;background-color: #fefefe;margin: 5% auto;padding: 20px;border: 1px solid #888;width: 80%;}  .close {color: #aaa;float: right;font-size: 20px;font-weight: bold;}  .close:hover, .close:focus {color: black;text-decoration: none;cursor: pointer;}  .column {float: left;width: 50%;}  .row:after {content: ;display: table;clear: both;}  #column1, #column2 {white-space: pre-wrap;}</style></head>
<body>
<div style="align-items: center; display: flex; justify-content: space-around;">
<div>
<h3 align="center">
Matches for pieces_ex_legmoves.c &amp; pieces_legmoves.c
      </h3>
<h1 align="center">
        33.7%
      </h1>
<center>
<a href="#" target="_top">
          INDEX
        </a>
<span>-</span>
<a href="#" target="_top">
          HELP
        </a>
</center>
</div>
<div>
<table bgcolor="#d0d0d0" border="1" cellspacing="0">
<tr><th><th>pieces_ex_legmoves.c (34.951458%)<th>pieces_legmoves.c (32.667877%)<th>Tokens
<tr onclick='openModal("#0000ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#0000ff"><font color="#0000ff">-</font><td><a href="#" name="0">(358-377)<td><a href="#" name="0">(120-139)</a><td align="center"><font color="#ff0000">17</font>
<tr onclick='openModal("#f63526")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#f63526"><font color="#f63526">-</font><td><a href="#" name="1">(295-314)<td><a href="#" name="1">(22-42)</a><td align="center"><font color="#ff0000">17</font>
<tr onclick='openModal("#980517")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#980517"><font color="#980517">-</font><td><a href="#" name="2">(181-192)<td><a href="#" name="2">(186-197)</a><td align="center"><font color="#e10000">15</font>
<tr onclick='openModal("#53858b")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#53858b"><font color="#53858b">-</font><td><a href="#" name="3">(163-174)<td><a href="#" name="3">(169-180)</a><td align="center"><font color="#e10000">15</font>
<tr onclick='openModal("#6cc417")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#6cc417"><font color="#6cc417">-</font><td><a href="#" name="4">(145-156)<td><a href="#" name="4">(152-163)</a><td align="center"><font color="#e10000">15</font>
<tr onclick='openModal("#151b8d")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#151b8d"><font color="#151b8d">-</font><td><a href="#" name="5">(89-101)<td><a href="#" name="5">(94-106)</a><td align="center"><font color="#e10000">15</font>
<tr onclick='openModal("#8c8774")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#8c8774"><font color="#8c8774">-</font><td><a href="#" name="6">(71-83)<td><a href="#" name="6">(76-88)</a><td align="center"><font color="#e10000">15</font>
<tr onclick='openModal("#38a4a5")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#38a4a5"><font color="#38a4a5">-</font><td><a href="#" name="7">(53-65)<td><a href="#" name="7">(58-70)</a><td align="center"><font color="#e10000">15</font>
<tr onclick='openModal("#c58917")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#c58917"><font color="#c58917">-</font><td><a href="#" name="8">(421-436)<td><a href="#" name="8">(443-459)</a><td align="center"><font color="#d20000">14</font>
<tr onclick='openModal("#83a33a")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#83a33a"><font color="#83a33a">-</font><td><a href="#" name="9">(216-233)<td><a href="#" name="9">(377-394)</a><td align="center"><font color="#d20000">14</font>
<tr onclick='openModal("#ad5910")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#ad5910"><font color="#ad5910">-</font><td><a href="#" name="10">(114-129)<td><a href="#" name="10">(309-326)</a><td align="center"><font color="#d20000">14</font>
<tr onclick='openModal("#b041ff")' onmouseleave='this.style.backgroundColor = "#D0D0D0"' onmouseover='this.style.backgroundColor = "yellow"' style="cursor:pointer"><td bgcolor="#b041ff"><font color="#b041ff">-</font><td><a href="#" name="11">(21-37)<td><a href="#" name="11">(226-244)</a><td align="center"><font color="#d20000">14</font>
</td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></td></td></a></td></td></tr></th></th></th></th></tr></table>
</div>
</div>
<hr/>
<div style="display: flex;">
<div style="flex-grow: 1;">
<h3>
<center>
<span>pieces_ex_legmoves.c</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <a name="11"></a>
2 #include "pieces_ex_legmoves.h"
3 <font color="#b041ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>int             exist_rook_legmov(int order, piece * friends, piece * enem)
4 {
5     int             i;
6     BITMASK         bm_pos,
7                     bm_work,
8                     focc,
9                     eocc;       
10     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
11         eocc = eocc | enem[i].bm_pos;
12         focc = focc | friends[i].bm_pos;
13     }
14     bm_pos = friends[order].bm_pos;
15     focc = focc &amp; (bm_pos ^ RET_ERR);</b></font>
16     if ((bm_pos &amp; LEFT) == 0) {         bm_work = bm_pos;
17         while (1) {
18             bm_work = bm_work &gt;&gt; 1;
19             if ((bm_work &amp; focc) != 0)
20                 break;
21             if ((bm_work &amp; eocc) != 0) {
22                 if (is_legal_mov(order, friends, enem, bm_work))
23                     return 1;
24                 break;
25 <a name="7"></a>            }
26             if (is_legal_mov(order, friends, enem, bm_work))
27                 return 1;
28 <font color="#38a4a5"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>            if ((bm_work &amp; LEFT) != 0)
29                 break;
30         }
31     }
32     if ((bm_pos &amp; RIGHT) == 0) {        bm_work = bm_pos;
33         while (1) {
34             bm_work = bm_work &lt;&lt; 1;
35             if ((bm_work &amp; focc) != 0)
36                 break;
37             if ((bm_work &amp; eocc) != 0) {
38                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
39                     return 1;
40                 break;
41 <a name="6"></a>            }
42             if (is_legal_mov(order, friends, enem, bm_work))
43                 return 1;
44 <font color="#8c8774"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>            if ((bm_work &amp; RIGHT) != 0)
45                 break;
46         }
47     }
48     if ((bm_pos &amp; BOTTOM) == 0) {               bm_work = bm_pos;
49         while (1) {
50             bm_work = bm_work &gt;&gt; 8;
51             if ((bm_work &amp; focc) != 0)
52                 break;
53             if ((bm_work &amp; eocc) != 0) {
54                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
55                     return 1;
56                 break;
57 <a name="5"></a>            }
58             if (is_legal_mov(order, friends, enem, bm_work))
59                 return 1;
60 <font color="#151b8d"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>            if ((bm_work &amp; BOTTOM) != 0)
61                 break;
62         }
63     }
64     if ((bm_pos &amp; TOP) == 0) {          bm_work = bm_pos;
65         while (1) {
66             bm_work = bm_work &lt;&lt; 8;
67             if ((bm_work &amp; focc) != 0)
68                 break;
69             if ((bm_work &amp; eocc) != 0) {
70                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
71                     return 1;
72                 break;
73             }
74             if (is_legal_mov(order, friends, enem, bm_work))
75                 return 1;
76             if ((bm_work &amp; TOP) != 0)
77                 break;
78         }
79     }
80 <a name="10"></a>    return 0;
81 }
82 <font color="#ad5910"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>int             exist_bishop_legmov(int order, piece * friends, piece * enem)
83 {
84     int             i;
85     BITMASK         bm_pos,
86                     bm_work,
87                     focc,
88                     eocc;
89     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
90         eocc = eocc | enem[i].bm_pos;
91         focc = focc | friends[i].bm_pos;
92     }
93     bm_pos = friends[order].bm_pos;
94     focc = focc &amp; (bm_pos ^ RET_ERR);</b></font>
95     if ((bm_pos &amp; TOPLEFT) == 0) {
96         bm_work = bm_pos;
97         while (1) {
98             bm_work = bm_work &lt;&lt; 7;                 if ((bm_work &amp; focc) != 0)
99                 break;
100             if ((bm_work &amp; eocc) != 0) {
101                 if (is_legal_mov(order, friends, enem, bm_work))
102                     return 1;
103                 else
104                     break;
105 <a name="4"></a>            }
106             if (is_legal_mov(order, friends, enem, bm_work))
107                 return 1;
108 <font color="#6cc417"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>            if ((bm_work &amp; TOPLEFT) != 0)                       break;
109         }
110     }
111     if ((bm_pos &amp; TOPRIGHT) == 0) {
112         bm_work = bm_pos;
113         while (1) {
114             bm_work = bm_work &lt;&lt; 9;                 if ((bm_work &amp; focc) != 0)
115                 break;
116             if ((bm_work &amp; eocc) != 0) {
117                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
118                     return 1;
119                 else
120                     break;
121 <a name="3"></a>            }
122             if (is_legal_mov(order, friends, enem, bm_work))
123                 return 1;
124 <font color="#53858b"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>            if ((bm_work &amp; TOPRIGHT) != 0)                      break;
125         }
126     }
127     if ((bm_pos &amp; BOTTOMRIGHT) == 0) {
128         bm_work = bm_pos;
129         while (1) {
130             bm_work = bm_work &gt;&gt; 7;                 if ((bm_work &amp; focc) != 0)
131                 break;
132             if ((bm_work &amp; eocc) != 0) {
133                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
134                     return 1;
135                 else
136                     break;
137 <a name="2"></a>            }
138             if (is_legal_mov(order, friends, enem, bm_work))
139                 return 1;
140 <font color="#980517"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>            if ((bm_work &amp; BOTTOMRIGHT) != 0)                   break;
141         }
142     }
143     if ((bm_pos &amp; BOTTOMLEFT) == 0) {
144         bm_work = bm_pos;
145         while (1) {
146             bm_work = bm_work &gt;&gt; 9;                 if ((bm_work &amp; focc) != 0)
147                 break;
148             if ((bm_work &amp; eocc) != 0) {
149                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
150                     return 1;
151                 else
152                     break;
153             }
154             if (is_legal_mov(order, friends, enem, bm_work))
155                 return 1;
156             if ((bm_work &amp; BOTTOMLEFT) != 0)                    break;
157         }
158     }
159     return 0;
160 }
161 int             exist_queen_legmov(int order, piece * friends, piece * enem)
162 {
163     if (exist_rook_legmov(order, friends, enem))
164         return 1;
165     if (exist_bishop_legmov(order, friends, enem))
166         return 1;
167 <a name="9"></a>    return 0;
168 }
169 <font color="#83a33a"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>int             exist_knight_legmov(int order, piece * friends, piece * enem)
170 {
171     int             row,
172                     col,
173                     i;
174     BITMASK         bm_pos,
175                     bm_work,
176                     focc,
177                     eocc;
178     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
179         eocc = eocc | enem[i].bm_pos;
180         focc = focc | friends[i].bm_pos;
181     }
182     bm_pos = friends[order].bm_pos;
183     focc = focc &amp; (bm_pos ^ RET_ERR);</b></font>
184     conv_bm_cases(bm_pos, &amp;row, &amp;col);
185     if (((row + 2) &lt;= 7) &amp;&amp; ((col + 1) &lt;= 7)) {
186         bm_work = bm_pos &lt;&lt; 17;
187         if ((bm_work &amp; focc) == 0) {
188             if (is_legal_mov(order, friends, enem, bm_work))
189                 return 1;
190         }
191     }
192     if (((row + 1) &lt;= 7) &amp;&amp; ((col + 2) &lt;= 7)) {
193         bm_work = bm_pos &lt;&lt; 10;
194         if ((bm_work &amp; focc) == 0) {
195             if (is_legal_mov(order, friends, enem, bm_work))
196                 return 1;
197         }
198     }
199     if (((row - 1) &gt;= 0) &amp;&amp; ((col + 2) &lt;= 7)) {
200         bm_work = bm_pos &gt;&gt; 6;
201         if ((bm_work &amp; focc) == 0) {
202             if (is_legal_mov(order, friends, enem, bm_work))
203                 return 1;
204         }
205     }
206     if (((row - 2) &gt;= 0) &amp;&amp; ((col + 1) &lt;= 7)) {
207         bm_work = bm_pos &gt;&gt; 15;
208         if ((bm_work &amp; focc) == 0) {
209             if (is_legal_mov(order, friends, enem, bm_work))
210                 return 1;
211         }
212     }
213     if (((row - 2) &gt;= 0) &amp;&amp; ((col - 1) &gt;= 0)) {
214         bm_work = bm_pos &gt;&gt; 17;
215         if ((bm_work &amp; focc) == 0) {
216             if (is_legal_mov(order, friends, enem, bm_work))
217                 return 1;
218         }
219     }
220     if (((row - 1) &gt;= 0) &amp;&amp; ((col - 2) &gt;= 0)) {
221         bm_work = bm_pos &gt;&gt; 10;
222         if ((bm_work &amp; focc) == 0) {
223             if (is_legal_mov(order, friends, enem, bm_work))
224                 return 1;
225         }
226     }
227     if (((row + 1) &lt;= 7) &amp;&amp; ((col - 2) &gt;= 0)) {
228         bm_work = bm_pos &lt;&lt; 6;
229         if ((bm_work &amp; focc) == 0) {
230             if (is_legal_mov(order, friends, enem, bm_work))
231                 return 1;
232         }
233     }
234     if (((row + 2) &lt;= 7) &amp;&amp; ((col - 1) &gt;= 0)) {
235         bm_work = bm_pos &lt;&lt; 15;
236         if ((bm_work &amp; focc) == 0) {
237             if (is_legal_mov(order, friends, enem, bm_work))
238                 return 1;
239         }
240     }
241 <a name="1"></a>    return 0;
242 }
243 <font color="#f63526"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>int             exist_white_pawn_legmov(int order, piece * w, piece * b)
244 {
245     int             col,
246                     i;
247     BITMASK         bm_pos,
248                     bm_work,
249                     focc,
250                     eocc;
251     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
252         eocc = eocc | b[i].bm_pos;
253         focc = focc | w[i].bm_pos;
254     }
255     bm_pos = w[order].bm_pos;
256     focc = focc &amp; (bm_pos ^ RET_ERR);
257     bm_work = bm_pos &lt;&lt; 8;
258     if (((bm_work &amp; focc) == 0) &amp;&amp; ((bm_work &amp; eocc) == 0)) {           if (is_pawn_legal_mov(order, w, b, bm_work))
259             return 1;
260         if ((bm_pos &amp; ROW2) != 0) {                 bm_work = bm_pos &lt;&lt; 16;
261             if (((bm_work &amp; focc) == 0) &amp;&amp; ((bm_work &amp; eocc) == 0))
262                 if (is_pawn_legal_mov(order, w, b, bm_work))
263                     return 1;
264         }
265     }
266     if ((bm_pos &amp; COL1) == 0) {         bm_work = bm_pos &lt;&lt; 7;
267         if ((bm_work &amp; eocc) != 0)
268             if (is_pawn_legal_mov(order, w, b, bm_work))
269                 return 1;
270     }
271     if ((bm_pos &amp; COL8) == 0) {         bm_work = bm_pos &lt;&lt; 9;
272         if ((bm_work &amp; eocc) != 0)
273             if (is_pawn_legal_mov(order, w, b, bm_work))
274                 return 1;
275     }
276     if ((bm_pos &amp; ROW5) != 0) {
277         get_column_from_bm(bm_pos, &amp;col);
278         if (col != 7) {
279             if (b[8 + col + 1].last_double_move == 1) {
280                 bm_work = bm_pos &lt;&lt; 9;
281                 if (is_pawn_legal_mov(order, w, b, bm_work))
282                     return 1;
283             }
284         }
285         if (col != 0) {
286             if (b[8 + col - 1].last_double_move == 1) {
287                 bm_work = bm_pos &lt;&lt; 7;
288                 if (is_pawn_legal_mov(order, w, b, bm_work))
289                     return 1;
290             }
291         }
292     }
293     return 0;
294 <a name="0"></a>}
295 <font color="#0000ff"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>int             exist_black_pawn_legmov(int order, piece * w, piece * b)
296 {
297     int             col,
298                     i;
299     BITMASK         bm_pos,
300                     bm_work,
301                     focc,
302                     eocc;
303     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
304         eocc = eocc | w[i].bm_pos;
305         focc = focc | b[i].bm_pos;
306     }
307     bm_pos = b[order].bm_pos;
308     focc = focc &amp; (bm_pos ^ RET_ERR);
309     bm_work = bm_pos &gt;&gt; 8;
310     if (((bm_work &amp; focc) == 0) &amp;&amp; ((bm_work &amp; eocc) == 0)) {           if (is_pawn_legal_mov(order, b, w, bm_work))
311             return 1;
312         if ((bm_pos &amp; ROW7) != 0) {                 bm_work = bm_pos &gt;&gt; 16;
313             if (((bm_work &amp; focc) == 0) &amp;&amp; ((bm_work &amp; eocc) == 0))
314                 if (is_pawn_legal_mov(order, b, w, bm_work))
315                     return 1;
316         }
317     }
318     if ((bm_pos &amp; COL1) == 0) {         bm_work = bm_pos &gt;&gt; 9;
319         if ((bm_work &amp; eocc) != 0)
320             if (is_pawn_legal_mov(order, b, w, bm_work))
321                 return 1;
322     }
323     if ((bm_pos &amp; COL8) == 0) {         bm_work = bm_pos &gt;&gt; 7;
324         if ((bm_work &amp; eocc) != 0)
325             if (is_pawn_legal_mov(order, b, w, bm_work))
326                 return 1;
327     }
328     if ((bm_pos &amp; ROW4) != 0) {
329         get_column_from_bm(bm_pos, &amp;col);
330         if (col != 7) {
331             if (w[8 + col + 1].last_double_move == 1) {
332                 bm_work = bm_pos &gt;&gt; 7;
333                 if (is_pawn_legal_mov(order, b, w, bm_work))
334                     return 1;
335             }
336         }
337         if (col != 0) {
338             if (w[8 + col - 1].last_double_move == 1) {
339                 bm_work = bm_pos &gt;&gt; 9;
340                 if (is_pawn_legal_mov(order, b, w, bm_work))
341                     return 1;
342             }
343         }
344     }
345     return 0;
346 <a name="8"></a>}
347 <font color="#c58917"><a href="#"><img align="right" alt="other" border="0" src="forward.gif"/></a><b>int             exist_king_legmov(int order, piece * friends, piece * enems)
348 {
349     int             i;
350     BITMASK         bm_pos,
351                     bm_work,
352                     focc,
353                     eocc;
354     focc = eocc = 0;
355     for (i = 0; i &lt;= 15; i++) {
356         eocc = eocc | enems[i].bm_pos;
357         focc = focc | friends[i].bm_pos;
358     }
359     bm_pos = friends[order].bm_pos;
360     focc = focc &amp; (bm_pos ^ RET_ERR);</b></font>
361     if ((bm_pos &amp; ROW1) == 0) {
362         bm_work = bm_pos &gt;&gt; 8;
363         if ((bm_work &amp; focc) == 0) {                if (is_legal_mov(order, friends, enems, bm_work))
364                 return 1;
365         }
366         if ((bm_pos &amp; COL1) == 0) {
367             bm_work = bm_pos &gt;&gt; 9;
368             if ((bm_work &amp; focc) == 0) {
369                 if (is_legal_mov(order, friends, enems, bm_work))
370                     return 1;
371             }
372         }
373     }
374     if ((bm_pos &amp; COL1) == 0) {
375         bm_work = bm_pos &gt;&gt; 1;
376         if ((bm_work &amp; focc) == 0) {
377             if (is_legal_mov(order, friends, enems, bm_work))
378                 return 1;
379         }
380         if ((bm_pos &amp; ROW8) == 0) {
381             bm_work = bm_pos &lt;&lt; 7;
382             if ((bm_work &amp; focc) == 0) {
383                 if (is_legal_mov(order, friends, enems, bm_work))
384                     return 1;
385             }
386         }
387     }
388     if ((bm_pos &amp; ROW8) == 0) {
389         bm_work = bm_pos &lt;&lt; 8;
390         if ((bm_work &amp; focc) == 0) {
391             if (is_legal_mov(order, friends, enems, bm_work))
392                 return 1;
393         }
394         if ((bm_pos &amp; COL8) == 0) {
395             bm_work = bm_pos &lt;&lt; 9;
396             if ((bm_work &amp; focc) == 0) {
397                 if (is_legal_mov(order, friends, enems, bm_work))
398                     return 1;
399             }
400         }
401     }
402     if ((bm_pos &amp; COL8) == 0) {
403         bm_work = bm_pos &lt;&lt; 1;
404         if ((bm_work &amp; focc) == 0) {
405             if (is_legal_mov(order, friends, enems, bm_work))
406                 return 1;
407         }
408         if ((bm_pos &amp; ROW1) == 0) {
409             bm_work = bm_pos &gt;&gt; 7;
410             if ((bm_work &amp; focc) == 0) {
411                 if (is_legal_mov(order, friends, enems, bm_work))
412                     return 1;
413             }
414         }
415     }
416     return 0;
417 }
</pre>
</div>
<div style="flex-grow: 1;">
<h3>
<center>
<span>pieces_legmoves.c</span>
<span> - </span>
<span></span>
</center>
</h3>
<hr/>
<pre>
1 <a name="1"></a>#include "pieces_legmoves.h"
2 BITMASK
3 <font color="#f63526"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>rook_legmovs(int order, piece * friends, piece * enem)
4 {
5     int             i;
6     BITMASK         bm_pos,
7                     bm_work,
8                     focc,
9                     eocc,
10                     bm_result;
11     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
12         eocc = eocc | enem[i].bm_pos;           focc = focc | friends[i].bm_pos;
13     }
14     bm_pos = friends[order].bm_pos;
15     focc = focc &amp; (bm_pos ^ RET_ERR);
16     bm_result = 0;
17     if ((bm_pos &amp; LEFT) == 0) {         bm_work = bm_pos;
18         while (1) {
19             bm_work = bm_work &gt;&gt; 1;
20             if ((bm_work &amp; focc) != 0)
21                 break;
22             if ((bm_work &amp; eocc) != 0) {
23                 if (is_legal_mov(order, friends, enem, bm_work))
24                     bm_result = bm_result | bm_work;
25                 break;
26             }
27             if (is_legal_mov(order, friends, enem, bm_work))
28 <a name="7"></a>                bm_result = bm_result | bm_work;
29 <font color="#38a4a5"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>            if ((bm_work &amp; LEFT) != 0)
30                 break;
31         }
32     }
33     if ((bm_pos &amp; RIGHT) == 0) {        bm_work = bm_pos;
34         while (1) {
35             bm_work = bm_work &lt;&lt; 1;
36             if ((bm_work &amp; focc) != 0)
37                 break;
38             if ((bm_work &amp; eocc) != 0) {
39                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
40                     bm_result = bm_result | bm_work;
41                 break;
42 <a name="6"></a>            }
43             if (is_legal_mov(order, friends, enem, bm_work))
44                 bm_result = bm_result | bm_work;
45 <font color="#8c8774"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>            if ((bm_work &amp; RIGHT) != 0)
46                 break;
47         }
48     }
49     if ((bm_pos &amp; BOTTOM) == 0) {               bm_work = bm_pos;
50         while (1) {
51             bm_work = bm_work &gt;&gt; 8;
52             if ((bm_work &amp; focc) != 0)
53                 break;
54             if ((bm_work &amp; eocc) != 0) {
55                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
56                     bm_result = bm_result | bm_work;
57                 break;
58 <a name="5"></a>            }
59             if (is_legal_mov(order, friends, enem, bm_work))
60                 bm_result = bm_result | bm_work;
61 <font color="#151b8d"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>            if ((bm_work &amp; BOTTOM) != 0)
62                 break;
63         }
64     }
65     if ((bm_pos &amp; TOP) == 0) {          bm_work = bm_pos;
66         while (1) {
67             bm_work = bm_work &lt;&lt; 8;
68             if ((bm_work &amp; focc) != 0)
69                 break;
70             if ((bm_work &amp; eocc) != 0) {
71                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
72                     bm_result = bm_result | bm_work;
73                 break;
74             }
75             if (is_legal_mov(order, friends, enem, bm_work))
76                 bm_result = bm_result | bm_work;
77             if ((bm_work &amp; TOP) != 0)
78                 break;
79         }
80     }
81     return bm_result;
82 <a name="0"></a>}
83 BITMASK
84 <font color="#0000ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>bishop_legmovs(int order, piece * friends, piece * enem)
85 {
86     int             i;
87     BITMASK         bm_pos,
88                     bm_work,
89                     focc,
90                     eocc,
91                     bm_result;
92     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
93         eocc = eocc | enem[i].bm_pos;
94         focc = focc | friends[i].bm_pos;
95     }
96     bm_pos = friends[order].bm_pos;
97     focc = focc &amp; (bm_pos ^ RET_ERR);
98     bm_result = 0;
99     if ((bm_pos &amp; TOPLEFT) == 0) {</b></font>
100         bm_work = bm_pos;
101         while (1) {
102             bm_work = bm_work &lt;&lt; 7;                 if ((bm_work &amp; focc) != 0)
103                 break;
104             if ((bm_work &amp; eocc) != 0) {
105                 if (is_legal_mov(order, friends, enem, bm_work))
106                     bm_result = bm_result | bm_work;
107                 break;
108 <a name="4"></a>            }
109             if (is_legal_mov(order, friends, enem, bm_work))
110                 bm_result = bm_result | bm_work;
111 <font color="#6cc417"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>            if ((bm_work &amp; TOPLEFT) != 0)                       break;
112         }
113     }
114     if ((bm_pos &amp; TOPRIGHT) == 0) {
115         bm_work = bm_pos;
116         while (1) {
117             bm_work = bm_work &lt;&lt; 9;                 if ((bm_work &amp; focc) != 0)
118                 break;
119             if ((bm_work &amp; eocc) != 0) {
120                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
121                     bm_result = bm_result | bm_work;
122                 break;
123 <a name="3"></a>            }
124             if (is_legal_mov(order, friends, enem, bm_work))
125                 bm_result = bm_result | bm_work;
126 <font color="#53858b"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>            if ((bm_work &amp; TOPRIGHT) != 0)                      break;
127         }
128     }
129     if ((bm_pos &amp; BOTTOMRIGHT) == 0) {
130         bm_work = bm_pos;
131         while (1) {
132             bm_work = bm_work &gt;&gt; 7;                 if ((bm_work &amp; focc) != 0)
133                 break;
134             if ((bm_work &amp; eocc) != 0) {
135                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
136                     bm_result = bm_result | bm_work;
137                 break;
138 <a name="2"></a>            }
139             if (is_legal_mov(order, friends, enem, bm_work))
140                 bm_result = bm_result | bm_work;
141 <font color="#980517"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>            if ((bm_work &amp; BOTTOMRIGHT) != 0)                   break;
142         }
143     }
144     if ((bm_pos &amp; BOTTOMLEFT) == 0) {
145         bm_work = bm_pos;
146         while (1) {
147             bm_work = bm_work &gt;&gt; 9;                 if ((bm_work &amp; focc) != 0)
148                 break;
149             if ((bm_work &amp; eocc) != 0) {
150                 if (is_legal_mov(order, friends, enem, bm_work))</b></font>
151                     bm_result = bm_result | bm_work;
152                 break;
153             }
154             if (is_legal_mov(order, friends, enem, bm_work))
155                 bm_result = bm_result | bm_work;
156             if ((bm_work &amp; BOTTOMLEFT) != 0)                    break;
157         }
158     }
159     return bm_result;
160 }
161 BITMASK
162 queen_legmovs(int order, piece * friends, piece * enem)
163 {
164     BITMASK         bm_result,
165                     bm_work;
166     bm_work = rook_legmovs(order, friends, enem);
167     bm_result = bm_work;
168     bm_work = bishop_legmovs(order, friends, enem);
169     bm_result = bm_result | bm_work;
170     return bm_result;
171 <a name="11"></a>}
172 BITMASK
173 <font color="#b041ff"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>knight_legmovs(int order, piece * friends, piece * enem)
174 {
175     int             row,
176                     col,
177                     i;
178     BITMASK         bm_pos,
179                     bm_work,
180                     focc,
181                     eocc,
182                     bm_result;
183     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
184         eocc = eocc | enem[i].bm_pos;
185         focc = focc | friends[i].bm_pos;
186     }
187     bm_pos = friends[order].bm_pos;
188     focc = focc &amp; (bm_pos ^ RET_ERR);</b></font>
189     conv_bm_cases(bm_pos, &amp;row, &amp;col);
190     bm_result = 0;
191     if (((row + 2) &lt;= 7) &amp;&amp; ((col + 1) &lt;= 7)) {
192         bm_work = bm_pos &lt;&lt; 17;
193         if ((bm_work &amp; focc) == 0) {
194             if (is_legal_mov(order, friends, enem, bm_work))
195                 bm_result = bm_result | bm_work;
196         }
197     }
198     if (((row + 1) &lt;= 7) &amp;&amp; ((col + 2) &lt;= 7)) {
199         bm_work = bm_pos &lt;&lt; 10;
200         if ((bm_work &amp; focc) == 0) {
201             if (is_legal_mov(order, friends, enem, bm_work))
202                 bm_result = bm_result | bm_work;
203         }
204     }
205     if (((row - 1) &gt;= 0) &amp;&amp; ((col + 2) &lt;= 7)) {
206         bm_work = bm_pos &gt;&gt; 6;
207         if ((bm_work &amp; focc) == 0) {
208             if (is_legal_mov(order, friends, enem, bm_work))
209                 bm_result = bm_result | bm_work;
210         }
211     }
212     if (((row - 2) &gt;= 0) &amp;&amp; ((col + 1) &lt;= 7)) {
213         bm_work = bm_pos &gt;&gt; 15;
214         if ((bm_work &amp; focc) == 0) {
215             if (is_legal_mov(order, friends, enem, bm_work))
216                 bm_result = bm_result | bm_work;
217         }
218     }
219     if (((row - 2) &gt;= 0) &amp;&amp; ((col - 1) &gt;= 0)) {
220         bm_work = bm_pos &gt;&gt; 17;
221         if ((bm_work &amp; focc) == 0) {
222             if (is_legal_mov(order, friends, enem, bm_work))
223                 bm_result = bm_result | bm_work;
224         }
225     }
226     if (((row - 1) &gt;= 0) &amp;&amp; ((col - 2) &gt;= 0)) {
227         bm_work = bm_pos &gt;&gt; 10;
228         if ((bm_work &amp; focc) == 0) {
229             if (is_legal_mov(order, friends, enem, bm_work))
230                 bm_result = bm_result | bm_work;
231         }
232     }
233     if (((row + 1) &lt;= 7) &amp;&amp; ((col - 2) &gt;= 0)) {
234         bm_work = bm_pos &lt;&lt; 6;
235         if ((bm_work &amp; focc) == 0) {
236             if (is_legal_mov(order, friends, enem, bm_work))
237                 bm_result = bm_result | bm_work;
238         }
239     }
240     if (((row + 2) &lt;= 7) &amp;&amp; ((col - 1) &gt;= 0)) {
241         bm_work = bm_pos &lt;&lt; 15;
242         if ((bm_work &amp; focc) == 0) {
243             if (is_legal_mov(order, friends, enem, bm_work))
244                 bm_result = bm_result | bm_work;
245         }
246     }
247     return bm_result;
248 <a name="10"></a>}
249 BITMASK
250 <font color="#ad5910"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>white_pawn_legmovs(int order, piece * w, piece * b)
251 {
252     int             col,
253                     i;
254     BITMASK         bm_pos,
255                     bm_work,
256                     focc,
257                     eocc,
258                     bm_result;
259     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
260         eocc = eocc | b[i].bm_pos;
261         focc = focc | w[i].bm_pos;
262     }
263     bm_pos = w[order].bm_pos;
264     focc = focc &amp; (bm_pos ^ RET_ERR);</b></font>
265     bm_result = 0;
266     bm_work = bm_pos &lt;&lt; 8;
267     if (((bm_work &amp; focc) == 0) &amp;&amp; ((bm_work &amp; eocc) == 0)) {           if (is_pawn_legal_mov(order, w, b, bm_work))
268             bm_result = bm_result | bm_work;
269         if ((bm_pos &amp; ROW2) != 0) {                 bm_work = bm_pos &lt;&lt; 16;
270             if (((bm_work &amp; focc) == 0) &amp;&amp; ((bm_work &amp; eocc) == 0))
271                 if (is_pawn_legal_mov(order, w, b, bm_work))
272                     bm_result = bm_result | bm_work;
273         }
274     }
275     if ((bm_pos &amp; COL1) == 0) {         bm_work = bm_pos &lt;&lt; 7;
276         if ((bm_work &amp; eocc) != 0)
277             if (is_pawn_legal_mov(order, w, b, bm_work))
278                 bm_result = bm_result | bm_work;
279     }
280     if ((bm_pos &amp; COL8) == 0) {         bm_work = bm_pos &lt;&lt; 9;
281         if ((bm_work &amp; eocc) != 0)
282             if (is_pawn_legal_mov(order, w, b, bm_work))
283                 bm_result = bm_result | bm_work;
284     }
285     if ((bm_pos &amp; ROW5) != 0) {
286         get_column_from_bm(bm_pos, &amp;col);
287         if (col != 7) {
288             if (b[8 + col + 1].last_double_move == 1) {
289                 bm_work = bm_pos &lt;&lt; 9;
290                 if (is_pawn_legal_mov(order, w, b, bm_work))
291                     bm_result = bm_result | bm_work;
292             }
293         }
294         if (col != 0) {
295             if (b[8 + col - 1].last_double_move == 1) {
296                 bm_work = bm_pos &lt;&lt; 7;
297                 if (is_pawn_legal_mov(order, w, b, bm_work))
298                     bm_result = bm_result | bm_work;
299             }
300         }
301     }
302     return bm_result;
303 }
304 <a name="9"></a>
305 BITMASK
306 <font color="#83a33a"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>black_pawn_legmovs(int order, piece * w, piece * b)
307 {
308     int             col,
309                     i;
310     BITMASK         bm_pos,
311                     bm_work,
312                     focc,
313                     eocc,
314                     bm_result;
315     focc = eocc = 0;                for (i = 0; i &lt;= 15; i++) {
316         eocc = eocc | w[i].bm_pos;
317         focc = focc | b[i].bm_pos;
318     }
319     bm_pos = b[order].bm_pos;
320     focc = focc &amp; (bm_pos ^ RET_ERR);</b></font>
321     bm_result = 0;
322     bm_work = bm_pos &gt;&gt; 8;
323     if (((bm_work &amp; focc) == 0) &amp;&amp; ((bm_work &amp; eocc) == 0)) {           if (is_pawn_legal_mov(order, b, w, bm_work))
324             bm_result = bm_result | bm_work;
325         if ((bm_pos &amp; ROW7) != 0) {                 bm_work = bm_pos &gt;&gt; 16;
326             if (((bm_work &amp; focc) == 0) &amp;&amp; ((bm_work &amp; eocc) == 0))
327                 if (is_pawn_legal_mov(order, b, w, bm_work))
328                     bm_result = bm_result | bm_work;
329         }
330     }
331     if ((bm_pos &amp; COL1) == 0) {         bm_work = bm_pos &gt;&gt; 9;
332         if ((bm_work &amp; eocc) != 0)
333             if (is_pawn_legal_mov(order, b, w, bm_work))
334                 bm_result = bm_result | bm_work;
335     }
336     if ((bm_pos &amp; COL8) == 0) {         bm_work = bm_pos &gt;&gt; 7;
337         if ((bm_work &amp; eocc) != 0)
338             if (is_pawn_legal_mov(order, b, w, bm_work))
339                 bm_result = bm_result | bm_work;
340     }
341     if ((bm_pos &amp; ROW4) != 0) {
342         get_column_from_bm(bm_pos, &amp;col);
343         if (col != 7) {
344             if (w[8 + col + 1].last_double_move == 1) {
345                 bm_work = bm_pos &gt;&gt; 7;
346                 if (is_pawn_legal_mov(order, b, w, bm_work))
347                     bm_result = bm_result | bm_work;
348             }
349         }
350         if (col != 0) {
351             if (w[8 + col - 1].last_double_move == 1) {
352                 bm_work = bm_pos &gt;&gt; 9;
353                 if (is_pawn_legal_mov(order, b, w, bm_work))
354                     bm_result = bm_result | bm_work;
355             }
356         }
357     }
358     return bm_result;
359 }
360 <a name="8"></a>
361 BITMASK
362 <font color="#c58917"><div style="position:absolute;left:0"><a href="#"><img align="left" alt="other" border="0" src="back.gif"/></a></div><b>king_legmovs(int order, piece * friends, piece * enems)
363 {
364     int             i;
365     BITMASK         bm_pos,
366                     bm_work,
367                     focc,
368                     eocc,
369                     bm_result;
370     focc = eocc = 0;
371     for (i = 0; i &lt;= 15; i++) {
372         eocc = eocc | enems[i].bm_pos;
373         focc = focc | friends[i].bm_pos;
374     }
375     bm_pos = friends[order].bm_pos;
376     focc = focc &amp; (bm_pos ^ RET_ERR);</b></font>
377     bm_result = 0;
378     if ((bm_pos &amp; ROW1) == 0) {
379         bm_work = bm_pos &gt;&gt; 8;
380         if ((bm_work &amp; focc) == 0) {                if (is_legal_mov(order, friends, enems, bm_work))
381                 bm_result = bm_result | bm_work;
382         }
383         if ((bm_pos &amp; COL1) == 0) {
384             bm_work = bm_pos &gt;&gt; 9;
385             if ((bm_work &amp; focc) == 0) {
386                 if (is_legal_mov(order, friends, enems, bm_work))
387                     bm_result = bm_result | bm_work;
388             }
389         }
390     }
391     if ((bm_pos &amp; COL1) == 0) {
392         bm_work = bm_pos &gt;&gt; 1;
393         if ((bm_work &amp; focc) == 0) {
394             if (is_legal_mov(order, friends, enems, bm_work))
395                 bm_result = bm_result | bm_work;
396         }
397         if ((bm_pos &amp; ROW8) == 0) {
398             bm_work = bm_pos &lt;&lt; 7;
399             if ((bm_work &amp; focc) == 0) {
400                 if (is_legal_mov(order, friends, enems, bm_work))
401                     bm_result = bm_result | bm_work;
402             }
403         }
404     }
405     if ((bm_pos &amp; ROW8) == 0) {
406         bm_work = bm_pos &lt;&lt; 8;
407         if ((bm_work &amp; focc) == 0) {
408             if (is_legal_mov(order, friends, enems, bm_work))
409                 bm_result = bm_result | bm_work;
410         }
411         if ((bm_pos &amp; COL8) == 0) {
412             bm_work = bm_pos &lt;&lt; 9;
413             if ((bm_work &amp; focc) == 0) {
414                 if (is_legal_mov(order, friends, enems, bm_work))
415                     bm_result = bm_result | bm_work;
416             }
417         }
418     }
419     if ((bm_pos &amp; COL8) == 0) {
420         bm_work = bm_pos &lt;&lt; 1;
421         if ((bm_work &amp; focc) == 0) {
422             if (is_legal_mov(order, friends, enems, bm_work))
423                 bm_result = bm_result | bm_work;
424         }
425         if ((bm_pos &amp; ROW1) == 0) {
426             bm_work = bm_pos &gt;&gt; 7;
427             if ((bm_work &amp; focc) == 0) {
428                 if (is_legal_mov(order, friends, enems, bm_work))
429                     bm_result = bm_result | bm_work;
430             }
431         }
432     }
433     if (friends[order].deja_moved == 1)
434         return bm_result;
435     do {
436         bm_work = bm_pos &lt;&lt; 1;
437         if ((bm_work &amp; bm_result) == 0)             continue;
438         if (friends[order + 3].deja_moved == 1)             continue;
439         if (friends[order + 3].bm_pos == 0)
440             continue;
441         bm_work = bm_pos &lt;&lt; 2;
442         if ((bm_work &amp; (focc | eocc)) != 0)
443             continue;
444         if (friends[order].under_check == 1)
445             return bm_result;
446         if (is_legal_mov(order, friends, enems, bm_work))
447             bm_result = bm_result | bm_work;
448     }
449     while (0);
450     do {
451         bm_work = bm_pos &gt;&gt; 1;
452         if ((bm_work &amp; bm_result) == 0)             continue;
453         if (friends[order - 4].deja_moved == 1)             continue;
454         if (friends[order - 4].bm_pos == 0)
455             continue;
456         bm_work = bm_pos &gt;&gt; 3;
457         if ((bm_work &amp; (focc | eocc)) != 0)
458             continue;
459         bm_work = bm_pos &gt;&gt; 2;
460         if ((bm_work &amp; (focc | eocc)) != 0)
461             continue;
462         if (friends[order].under_check == 1)
463             return bm_result;
464         if (is_legal_mov(order, friends, enems, bm_work))
465             bm_result = bm_result | bm_work;
466     }
467     while (0);
468     return bm_result;
469 }
</pre>
</div>
</div>
<div class="modal" id="myModal" style="display:none;"><div class="modal-content"><span class="close">x</span><p></p><div class="row"><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 1</div><div class="column" style="font-weight: bold;text-decoration: underline">Fragment from File 2</div></div><div class="row"><div class="column" id="column1">Column 1</div><div class="column" id="column2">Column 2</div></div></div></div><script>var modal=document.getElementById("myModal"),span=document.getElementsByClassName("close")[0];span.onclick=function(){modal.style.display="none"};window.onclick=function(a){a.target==modal&&(modal.style.display="none")};function openModal(a){console.log("the color is "+a);let b=getCodes(a);console.log(b);var c=document.getElementById("column1");c.innerText=b[0];var d=document.getElementById("column2");d.innerText=b[1];c.style.color=a;c.style.fontWeight="bold";d.style.fontWeight="bold";d.style.color=a;var e=document.getElementById("myModal");e.style.display="block"}function getCodes(a){for(var b=document.getElementsByTagName("font"),c=[],d=0;d<b.length;d++)b[d].attributes.color.nodeValue===a&&"-"!==b[d].innerText&&c.push(b[d].innerText);return c}</script><script>const params=window.location.search;const urlParams=new URLSearchParams(params);const searchText=urlParams.get('lines');let lines=searchText.split(',');for(let line of lines){const elements=document.getElementsByTagName('td');for(let i=0;i<elements.length;i++){if(elements[i].innerText.includes(line)){elements[i].style.background='green';break;}}}</script></body>
</html>
