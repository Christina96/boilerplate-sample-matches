
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 12, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-AggregateDefinitionTests.cs</h3>
            <pre><code>1  using System.Linq.Expressions;
2  using System;
3  using System.Collections.Generic;
4  using System.Globalization;
5  using System.Linq;
6  using FluentAssertions;
7  using NUnit.Framework;
8  namespace MudBlazor.UnitTests.Components
9  {
10  #nullable enable
11      [TestFixture]
12      public class AggregateDefinitionTests
13      {
14          public record AccountingModel(long Id, int Position, decimal Salary);
15          public record AccountingNullableModel(long? Id, int? Position, decimal? Salary);
16          private readonly List<AccountingModel> _accountingModels = new()
17          {
18              new AccountingModel(47219479, 1, 50_000.00M),
19              new AccountingModel(45376824, 3, 75_000.00M),
20              new AccountingModel(72746864, 8, 102_000.00M),
21              new AccountingModel(9434843, 20, 132_000.00M),
22              new AccountingModel(44279196, 23, 245_100.00M),
23              new AccountingModel(18223533, 28, 500_000.00M),
24              new AccountingModel(67898330, 30, 1_000_000.00M),
25          };
26          private readonly List<AccountingNullableModel> _accountingNullableModels = new()
27          {
28              new AccountingNullableModel(null, null, null),
29              new AccountingNullableModel(47219479, 1, 50_000.00M),
30              new AccountingNullableModel(45376824, 3, 75_000.00M),
31              new AccountingNullableModel(72746864, 8, 102_000.00M),
32              new AccountingNullableModel(9434843, 20, 132_000.00M),
33              new AccountingNullableModel(44279196, 23, 245_100.00M),
34              new AccountingNullableModel(18223533, 28, 500_000.00M),
35              new AccountingNullableModel(67898330, 30, 1_00_000.00M),
36          };
37          [Test]
38          public void AggregateDefinition_Cache_Returns_SameObject_Test()
39          {
40              Expression<Func<AccountingModel, decimal?>> propertyExpression1 = model => model.Salary;
41              Expression<Func<AccountingModel, decimal?>> propertyExpression2 = model => model.Salary;
42              var cache = new AggregateDefinition<AccountingModel>.AggregateDefinitionExpressionCache();
43              var expression1 = cache.CachedCompile(propertyExpression1);
44              var expression2 = cache.CachedCompile(propertyExpression2);
45              propertyExpression1.Equals(propertyExpression2).Should().BeFalse();
46              expression1.Equals(expression2).Should().BeTrue();
47          }
48          [Test]
49          public void AggregateDefinition_Cache_Returns_DifferentObject_Test()
50          {
51              Expression<Func<AccountingModel, decimal?>> propertyExpression1 = model => model.Salary;
52              Expression<Func<AccountingModel, decimal?>> propertyExpression2 = model => model.Id;
53              var cache = new AggregateDefinition<AccountingModel>.AggregateDefinitionExpressionCache();
54              var expression1 = cache.CachedCompile(propertyExpression1);
55              var expression2 = cache.CachedCompile(propertyExpression2);
56              propertyExpression1.Equals(propertyExpression2).Should().BeFalse();
57              expression1.Equals(expression2).Should().BeFalse();
58          }
59          [Test]
60          public void AggregateDefinition_Decimal_NullList_Test()
61          {
62              Expression<Func<AccountingModel, decimal>> propertyExpression = model => model.Salary;
63              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>();
64              var value = aggregateDefinitionAverage.GetValue(propertyExpression, null);
65              value.Should().Be("0");
66          }
67          [Test]
68          public void AggregateDefinition_Decimal_EmptyList_Test()
69          {
70              Expression<Func<AccountingModel, decimal>> propertyExpression = model => model.Salary;
71              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>();
72              var value = aggregateDefinitionAverage.GetValue(propertyExpression, Array.Empty<AccountingModel>());
73              value.Should().Be("0");
74          }
75          [Test]
76          public void AggregateDefinition_Decimal_NullExpression_Test()
77          {
78              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>();
79              var value = aggregateDefinitionAverage.GetValue(null, _accountingModels);
80              value.Should().Be("0");
81          }
82          [Test]
83          public void AggregateDefinition_Decimal_Test()
84          {
85              Expression<Func<AccountingModel, decimal>> propertyExpression = model => model.Salary;
<span onclick='openModal()' class='match'>86              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleAvg();
87              var aggregateDefinitionMin = AggregateDefinition<AccountingModel>.SimpleMin();
</span>88              var aggregateDefinitionMax = AggregateDefinition<AccountingModel>.SimpleMax();
89              var aggregateDefinitionCount = AggregateDefinition<AccountingModel>.SimpleCount();
90              var aggregateDefinitionSum = AggregateDefinition<AccountingModel>.SimpleSum();
91              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingModels);
92              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingModels);
93              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingModels);
94              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingModels);
95              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingModels);
96              var expectedAverage = _accountingModels.Select(x => x.Salary).Average();
97              var expectedMin = _accountingModels.Select(x => x.Salary).Min();
98              var expectedMax = _accountingModels.Select(x => x.Salary).Max();
99              var expectedCount = _accountingModels.Select(x => x.Salary).Count();
100              var expectedSum = _accountingModels.Select(x => x.Salary).Sum();
101              valueAverage.Should().Be($"Average {expectedAverage}");
102              valueMin.Should().Be($"Min {expectedMin}");
103              valueMax.Should().Be($"Max {expectedMax}");
104              valueCount.Should().Be($"Total {expectedCount}");
105              valueSum.Should().Be($"Sum {expectedSum}");
106          }
107          [Test]
108          public void AggregateDefinition_NullableDecimal_Test()
109          {
110              Expression<Func<AccountingNullableModel, decimal?>> propertyExpression = model => model.Salary;
111              var aggregateDefinitionAverage = AggregateDefinition<AccountingNullableModel>.SimpleAvg();
112              var aggregateDefinitionMin = AggregateDefinition<AccountingNullableModel>.SimpleMin();
113              var aggregateDefinitionMax = AggregateDefinition<AccountingNullableModel>.SimpleMax();
114              var aggregateDefinitionCount = AggregateDefinition<AccountingNullableModel>.SimpleCount();
115              var aggregateDefinitionSum = AggregateDefinition<AccountingNullableModel>.SimpleSum();
116              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingNullableModels);
117              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingNullableModels);
118              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingNullableModels);
119              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingNullableModels);
120              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingNullableModels);
121              var expectedAverage = _accountingNullableModels.Select(x => x.Salary).Average();
122              var expectedMin = _accountingNullableModels.Select(x => x.Salary).Min();
123              var expectedMax = _accountingNullableModels.Select(x => x.Salary).Max();
124              var expectedCount = _accountingNullableModels.Select(x => x.Salary).Count();
125              var expectedSum = _accountingNullableModels.Select(x => x.Salary).Sum();
126              valueAverage.Should().Be($"Average {expectedAverage}");
127              valueMin.Should().Be($"Min {expectedMin}");
128              valueMax.Should().Be($"Max {expectedMax}");
129              valueCount.Should().Be($"Total {expectedCount}");
130              valueSum.Should().Be($"Sum {expectedSum}");
131          }
132          [Test]
133          public void AggregateDefinition_Integer_Test()
134          {
135              Expression<Func<AccountingModel, int>> propertyExpression = model => model.Position;
136              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleAvg();
137              var aggregateDefinitionMin = AggregateDefinition<AccountingModel>.SimpleMin();
138              var aggregateDefinitionMax = AggregateDefinition<AccountingModel>.SimpleMax();
139              var aggregateDefinitionCount = AggregateDefinition<AccountingModel>.SimpleCount();
140              var aggregateDefinitionSum = AggregateDefinition<AccountingModel>.SimpleSum();
141              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingModels);
142              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingModels);
143              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingModels);
144              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingModels);
145              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingModels);
146              var expectedAverage = _accountingModels.Select(x => (decimal)x.Position).Average();
147              var expectedMin = _accountingModels.Select(x => x.Position).Min();
148              var expectedMax = _accountingModels.Select(x => x.Position).Max();
149              var expectedCount = _accountingModels.Select(x => x.Position).Count();
150              var expectedSum = _accountingModels.Select(x => x.Position).Sum();
151              valueAverage.Should().Be($"Average {expectedAverage}");
152              valueMin.Should().Be($"Min {expectedMin}");
153              valueMax.Should().Be($"Max {expectedMax}");
154              valueCount.Should().Be($"Total {expectedCount}");
155              valueSum.Should().Be($"Sum {expectedSum}");
156          }
157          [Test]
158          public void AggregateDefinition_NullableInteger_Test()
159          {
160              Expression<Func<AccountingNullableModel, int?>> propertyExpression = model => model.Position;
161              var aggregateDefinitionAverage = AggregateDefinition<AccountingNullableModel>.SimpleAvg();
162              var aggregateDefinitionMin = AggregateDefinition<AccountingNullableModel>.SimpleMin();
163              var aggregateDefinitionMax = AggregateDefinition<AccountingNullableModel>.SimpleMax();
164              var aggregateDefinitionCount = AggregateDefinition<AccountingNullableModel>.SimpleCount();
165              var aggregateDefinitionSum = AggregateDefinition<AccountingNullableModel>.SimpleSum();
166              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingNullableModels);
167              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingNullableModels);
168              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingNullableModels);
169              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingNullableModels);
170              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingNullableModels);
171              var expectedAverage = _accountingNullableModels.Select(x => (decimal?)x.Position).Average();
172              var expectedMin = _accountingNullableModels.Select(x => x.Position).Min();
173              var expectedMax = _accountingNullableModels.Select(x => x.Position).Max();
174              var expectedCount = _accountingNullableModels.Select(x => x.Position).Count();
175              var expectedSum = _accountingNullableModels.Select(x => x.Position).Sum();
176              valueAverage.Should().Be($"Average {expectedAverage}");
177              valueMin.Should().Be($"Min {expectedMin}");
178              valueMax.Should().Be($"Max {expectedMax}");
179              valueCount.Should().Be($"Total {expectedCount}");
180              valueSum.Should().Be($"Sum {expectedSum}");
181          }
182          [Test]
183          public void AggregateDefinition_Long_Test()
184          {
185              Expression<Func<AccountingModel, long>> propertyExpression = model => model.Id;
186              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleAvg();
187              var aggregateDefinitionMin = AggregateDefinition<AccountingModel>.SimpleMin();
188              var aggregateDefinitionMax = AggregateDefinition<AccountingModel>.SimpleMax();
189              var aggregateDefinitionCount = AggregateDefinition<AccountingModel>.SimpleCount();
190              var aggregateDefinitionSum = AggregateDefinition<AccountingModel>.SimpleSum();
191              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingModels);
192              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingModels);
193              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingModels);
194              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingModels);
195              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingModels);
196              var expectedAverage = _accountingModels.Select(x => (decimal)x.Id).Average();
197              var expectedMin = _accountingModels.Select(x => x.Id).Min();
198              var expectedMax = _accountingModels.Select(x => x.Id).Max();
199              var expectedCount = _accountingModels.Select(x => x.Id).Count();
200              var expectedSum = _accountingModels.Select(x => x.Id).Sum();
201              valueAverage.Should().Be($"Average {expectedAverage}");
202              valueMin.Should().Be($"Min {expectedMin}");
203              valueMax.Should().Be($"Max {expectedMax}");
204              valueCount.Should().Be($"Total {expectedCount}");
205              valueSum.Should().Be($"Sum {expectedSum}");
206          }
207          [Test]
208          public void AggregateDefinition_NullableLong_Test()
209          {
210              Expression<Func<AccountingNullableModel, long?>> propertyExpression = model => model.Id;
211              var aggregateDefinitionAverage = AggregateDefinition<AccountingNullableModel>.SimpleAvg();
212              var aggregateDefinitionMin = AggregateDefinition<AccountingNullableModel>.SimpleMin();
213              var aggregateDefinitionMax = AggregateDefinition<AccountingNullableModel>.SimpleMax();
214              var aggregateDefinitionCount = AggregateDefinition<AccountingNullableModel>.SimpleCount();
215              var aggregateDefinitionSum = AggregateDefinition<AccountingNullableModel>.SimpleSum();
216              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingNullableModels);
217              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingNullableModels);
218              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingNullableModels);
219              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingNullableModels);
220              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingNullableModels);
221              var expectedAverage = _accountingNullableModels.Select(x => (decimal?)x.Id).Average();
222              var expectedMin = _accountingNullableModels.Select(x => x.Id).Min();
223              var expectedMax = _accountingNullableModels.Select(x => x.Id).Max();
224              var expectedCount = _accountingNullableModels.Select(x => x.Id).Count();
225              var expectedSum = _accountingNullableModels.Select(x => x.Id).Sum();
226              valueAverage.Should().Be($"Average {expectedAverage}");
227              valueMin.Should().Be($"Min {expectedMin}");
228              valueMax.Should().Be($"Max {expectedMax}");
229              valueCount.Should().Be($"Total {expectedCount}");
230              valueSum.Should().Be($"Sum {expectedSum}");
231          }
232          [Test]
233          public void AggregateDefinition_Custom_Test()
234          {
235              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>
236              {
237                  Type = AggregateType.Custom,
238                  CustomAggregate = model =>
239                  {
240                      var accountingModels = model as AccountingModel[] ?? model.ToArray();
241                      var highestSalary = accountingModels.Max(z => z.Salary);
242                      var countOver100Grand = accountingModels.Count(z => z.Salary > 100_000);
243                      return $"Highest: {highestSalary.ToString(NumberFormatInfo.InvariantInfo)} | {countOver100Grand.ToString(NumberFormatInfo.InvariantInfo)} Over {100000.ToString(NumberFormatInfo.InvariantInfo)}";
244                  }
245              };
246              var value = aggregateDefinitionAverage.GetValue(null, _accountingModels);
247              value.Should().Be("Highest: 1000000.00 | 5 Over 100000");
248          }
249          [Test]
250          public void AggregateDefinition_InvalidType_Test()
251          {
252              Expression<Func<AccountingModel, decimal>> propertyExpression = model => model.Salary;
253              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>
254              {
255                  Type = (AggregateType)(-1)
256              };
257              var value = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingModels);
258              value.Should().Be("0");
259          }
260          [Test(Description = "This is to ensure that we do not return same cached compiled expression and get same results after passing different expression")]
261          public void AggregateDefinition_ReuseDefinition_With_Different_Expressions_Test()
262          {
263              Expression<Func<AccountingModel, long>> propertyExpressionId = model => model.Id;
264              Expression<Func<AccountingModel, decimal>> propertyExpressionSalary = model => model.Salary;
265              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleMin();
266              var expectedIdMin = _accountingModels.Select(x => x.Id).Min();
267              var expectedSalaryMin = _accountingModels.Select(x => x.Salary).Min();
268              var valueIdMin = aggregateDefinitionAverage.GetValue(propertyExpressionId, _accountingModels);
269              var valueSalaryMin = aggregateDefinitionAverage.GetValue(propertyExpressionSalary, _accountingModels);
270              valueIdMin.Should().Be($"Min {expectedIdMin}");
271              valueSalaryMin.Should().Be($"Min {expectedSalaryMin}");
272          }
273      }
274  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-AggregateDefinitionTests.cs</h3>
            <pre><code>1  using System.Linq.Expressions;
2  using System;
3  using System.Collections.Generic;
4  using System.Globalization;
5  using System.Linq;
6  using FluentAssertions;
7  using NUnit.Framework;
8  namespace MudBlazor.UnitTests.Components
9  {
10  #nullable enable
11      [TestFixture]
12      public class AggregateDefinitionTests
13      {
14          public record AccountingModel(long Id, int Position, decimal Salary);
15          public record AccountingNullableModel(long? Id, int? Position, decimal? Salary);
16          private readonly List<AccountingModel> _accountingModels = new()
17          {
18              new AccountingModel(47219479, 1, 50_000.00M),
19              new AccountingModel(45376824, 3, 75_000.00M),
20              new AccountingModel(72746864, 8, 102_000.00M),
21              new AccountingModel(9434843, 20, 132_000.00M),
22              new AccountingModel(44279196, 23, 245_100.00M),
23              new AccountingModel(18223533, 28, 500_000.00M),
24              new AccountingModel(67898330, 30, 1_000_000.00M),
25          };
26          private readonly List<AccountingNullableModel> _accountingNullableModels = new()
27          {
28              new AccountingNullableModel(null, null, null),
29              new AccountingNullableModel(47219479, 1, 50_000.00M),
30              new AccountingNullableModel(45376824, 3, 75_000.00M),
31              new AccountingNullableModel(72746864, 8, 102_000.00M),
32              new AccountingNullableModel(9434843, 20, 132_000.00M),
33              new AccountingNullableModel(44279196, 23, 245_100.00M),
34              new AccountingNullableModel(18223533, 28, 500_000.00M),
35              new AccountingNullableModel(67898330, 30, 1_00_000.00M),
36          };
37          [Test]
38          public void AggregateDefinition_Cache_Returns_SameObject_Test()
39          {
40              Expression<Func<AccountingModel, decimal?>> propertyExpression1 = model => model.Salary;
41              Expression<Func<AccountingModel, decimal?>> propertyExpression2 = model => model.Salary;
42              var cache = new AggregateDefinition<AccountingModel>.AggregateDefinitionExpressionCache();
43              var expression1 = cache.CachedCompile(propertyExpression1);
44              var expression2 = cache.CachedCompile(propertyExpression2);
45              propertyExpression1.Equals(propertyExpression2).Should().BeFalse();
46              expression1.Equals(expression2).Should().BeTrue();
47          }
48          [Test]
49          public void AggregateDefinition_Cache_Returns_DifferentObject_Test()
50          {
51              Expression<Func<AccountingModel, decimal?>> propertyExpression1 = model => model.Salary;
52              Expression<Func<AccountingModel, decimal?>> propertyExpression2 = model => model.Id;
53              var cache = new AggregateDefinition<AccountingModel>.AggregateDefinitionExpressionCache();
54              var expression1 = cache.CachedCompile(propertyExpression1);
55              var expression2 = cache.CachedCompile(propertyExpression2);
56              propertyExpression1.Equals(propertyExpression2).Should().BeFalse();
57              expression1.Equals(expression2).Should().BeFalse();
58          }
59          [Test]
60          public void AggregateDefinition_Decimal_NullList_Test()
61          {
62              Expression<Func<AccountingModel, decimal>> propertyExpression = model => model.Salary;
63              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>();
64              var value = aggregateDefinitionAverage.GetValue(propertyExpression, null);
65              value.Should().Be("0");
66          }
67          [Test]
68          public void AggregateDefinition_Decimal_EmptyList_Test()
69          {
70              Expression<Func<AccountingModel, decimal>> propertyExpression = model => model.Salary;
71              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>();
72              var value = aggregateDefinitionAverage.GetValue(propertyExpression, Array.Empty<AccountingModel>());
73              value.Should().Be("0");
74          }
75          [Test]
76          public void AggregateDefinition_Decimal_NullExpression_Test()
77          {
78              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>();
79              var value = aggregateDefinitionAverage.GetValue(null, _accountingModels);
80              value.Should().Be("0");
81          }
82          [Test]
83          public void AggregateDefinition_Decimal_Test()
84          {
85              Expression<Func<AccountingModel, decimal>> propertyExpression = model => model.Salary;
86              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleAvg();
87              var aggregateDefinitionMin = AggregateDefinition<AccountingModel>.SimpleMin();
88              var aggregateDefinitionMax = AggregateDefinition<AccountingModel>.SimpleMax();
89              var aggregateDefinitionCount = AggregateDefinition<AccountingModel>.SimpleCount();
90              var aggregateDefinitionSum = AggregateDefinition<AccountingModel>.SimpleSum();
91              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingModels);
92              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingModels);
93              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingModels);
94              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingModels);
95              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingModels);
96              var expectedAverage = _accountingModels.Select(x => x.Salary).Average();
97              var expectedMin = _accountingModels.Select(x => x.Salary).Min();
98              var expectedMax = _accountingModels.Select(x => x.Salary).Max();
99              var expectedCount = _accountingModels.Select(x => x.Salary).Count();
100              var expectedSum = _accountingModels.Select(x => x.Salary).Sum();
101              valueAverage.Should().Be($"Average {expectedAverage}");
102              valueMin.Should().Be($"Min {expectedMin}");
103              valueMax.Should().Be($"Max {expectedMax}");
104              valueCount.Should().Be($"Total {expectedCount}");
105              valueSum.Should().Be($"Sum {expectedSum}");
106          }
107          [Test]
108          public void AggregateDefinition_NullableDecimal_Test()
109          {
110              Expression<Func<AccountingNullableModel, decimal?>> propertyExpression = model => model.Salary;
111              var aggregateDefinitionAverage = AggregateDefinition<AccountingNullableModel>.SimpleAvg();
112              var aggregateDefinitionMin = AggregateDefinition<AccountingNullableModel>.SimpleMin();
113              var aggregateDefinitionMax = AggregateDefinition<AccountingNullableModel>.SimpleMax();
114              var aggregateDefinitionCount = AggregateDefinition<AccountingNullableModel>.SimpleCount();
115              var aggregateDefinitionSum = AggregateDefinition<AccountingNullableModel>.SimpleSum();
116              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingNullableModels);
117              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingNullableModels);
118              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingNullableModels);
119              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingNullableModels);
120              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingNullableModels);
121              var expectedAverage = _accountingNullableModels.Select(x => x.Salary).Average();
122              var expectedMin = _accountingNullableModels.Select(x => x.Salary).Min();
123              var expectedMax = _accountingNullableModels.Select(x => x.Salary).Max();
124              var expectedCount = _accountingNullableModels.Select(x => x.Salary).Count();
125              var expectedSum = _accountingNullableModels.Select(x => x.Salary).Sum();
126              valueAverage.Should().Be($"Average {expectedAverage}");
127              valueMin.Should().Be($"Min {expectedMin}");
128              valueMax.Should().Be($"Max {expectedMax}");
129              valueCount.Should().Be($"Total {expectedCount}");
130              valueSum.Should().Be($"Sum {expectedSum}");
131          }
132          [Test]
133          public void AggregateDefinition_Integer_Test()
134          {
135              Expression<Func<AccountingModel, int>> propertyExpression = model => model.Position;
<span onclick='openModal()' class='match'>136              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleAvg();
137              var aggregateDefinitionMin = AggregateDefinition<AccountingModel>.SimpleMin();
</span>138              var aggregateDefinitionMax = AggregateDefinition<AccountingModel>.SimpleMax();
139              var aggregateDefinitionCount = AggregateDefinition<AccountingModel>.SimpleCount();
140              var aggregateDefinitionSum = AggregateDefinition<AccountingModel>.SimpleSum();
141              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingModels);
142              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingModels);
143              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingModels);
144              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingModels);
145              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingModels);
146              var expectedAverage = _accountingModels.Select(x => (decimal)x.Position).Average();
147              var expectedMin = _accountingModels.Select(x => x.Position).Min();
148              var expectedMax = _accountingModels.Select(x => x.Position).Max();
149              var expectedCount = _accountingModels.Select(x => x.Position).Count();
150              var expectedSum = _accountingModels.Select(x => x.Position).Sum();
151              valueAverage.Should().Be($"Average {expectedAverage}");
152              valueMin.Should().Be($"Min {expectedMin}");
153              valueMax.Should().Be($"Max {expectedMax}");
154              valueCount.Should().Be($"Total {expectedCount}");
155              valueSum.Should().Be($"Sum {expectedSum}");
156          }
157          [Test]
158          public void AggregateDefinition_NullableInteger_Test()
159          {
160              Expression<Func<AccountingNullableModel, int?>> propertyExpression = model => model.Position;
161              var aggregateDefinitionAverage = AggregateDefinition<AccountingNullableModel>.SimpleAvg();
162              var aggregateDefinitionMin = AggregateDefinition<AccountingNullableModel>.SimpleMin();
163              var aggregateDefinitionMax = AggregateDefinition<AccountingNullableModel>.SimpleMax();
164              var aggregateDefinitionCount = AggregateDefinition<AccountingNullableModel>.SimpleCount();
165              var aggregateDefinitionSum = AggregateDefinition<AccountingNullableModel>.SimpleSum();
166              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingNullableModels);
167              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingNullableModels);
168              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingNullableModels);
169              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingNullableModels);
170              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingNullableModels);
171              var expectedAverage = _accountingNullableModels.Select(x => (decimal?)x.Position).Average();
172              var expectedMin = _accountingNullableModels.Select(x => x.Position).Min();
173              var expectedMax = _accountingNullableModels.Select(x => x.Position).Max();
174              var expectedCount = _accountingNullableModels.Select(x => x.Position).Count();
175              var expectedSum = _accountingNullableModels.Select(x => x.Position).Sum();
176              valueAverage.Should().Be($"Average {expectedAverage}");
177              valueMin.Should().Be($"Min {expectedMin}");
178              valueMax.Should().Be($"Max {expectedMax}");
179              valueCount.Should().Be($"Total {expectedCount}");
180              valueSum.Should().Be($"Sum {expectedSum}");
181          }
182          [Test]
183          public void AggregateDefinition_Long_Test()
184          {
185              Expression<Func<AccountingModel, long>> propertyExpression = model => model.Id;
186              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleAvg();
187              var aggregateDefinitionMin = AggregateDefinition<AccountingModel>.SimpleMin();
188              var aggregateDefinitionMax = AggregateDefinition<AccountingModel>.SimpleMax();
189              var aggregateDefinitionCount = AggregateDefinition<AccountingModel>.SimpleCount();
190              var aggregateDefinitionSum = AggregateDefinition<AccountingModel>.SimpleSum();
191              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingModels);
192              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingModels);
193              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingModels);
194              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingModels);
195              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingModels);
196              var expectedAverage = _accountingModels.Select(x => (decimal)x.Id).Average();
197              var expectedMin = _accountingModels.Select(x => x.Id).Min();
198              var expectedMax = _accountingModels.Select(x => x.Id).Max();
199              var expectedCount = _accountingModels.Select(x => x.Id).Count();
200              var expectedSum = _accountingModels.Select(x => x.Id).Sum();
201              valueAverage.Should().Be($"Average {expectedAverage}");
202              valueMin.Should().Be($"Min {expectedMin}");
203              valueMax.Should().Be($"Max {expectedMax}");
204              valueCount.Should().Be($"Total {expectedCount}");
205              valueSum.Should().Be($"Sum {expectedSum}");
206          }
207          [Test]
208          public void AggregateDefinition_NullableLong_Test()
209          {
210              Expression<Func<AccountingNullableModel, long?>> propertyExpression = model => model.Id;
211              var aggregateDefinitionAverage = AggregateDefinition<AccountingNullableModel>.SimpleAvg();
212              var aggregateDefinitionMin = AggregateDefinition<AccountingNullableModel>.SimpleMin();
213              var aggregateDefinitionMax = AggregateDefinition<AccountingNullableModel>.SimpleMax();
214              var aggregateDefinitionCount = AggregateDefinition<AccountingNullableModel>.SimpleCount();
215              var aggregateDefinitionSum = AggregateDefinition<AccountingNullableModel>.SimpleSum();
216              var valueAverage = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingNullableModels);
217              var valueMin = aggregateDefinitionMin.GetValue(propertyExpression, _accountingNullableModels);
218              var valueMax = aggregateDefinitionMax.GetValue(propertyExpression, _accountingNullableModels);
219              var valueCount = aggregateDefinitionCount.GetValue(propertyExpression, _accountingNullableModels);
220              var valueSum = aggregateDefinitionSum.GetValue(propertyExpression, _accountingNullableModels);
221              var expectedAverage = _accountingNullableModels.Select(x => (decimal?)x.Id).Average();
222              var expectedMin = _accountingNullableModels.Select(x => x.Id).Min();
223              var expectedMax = _accountingNullableModels.Select(x => x.Id).Max();
224              var expectedCount = _accountingNullableModels.Select(x => x.Id).Count();
225              var expectedSum = _accountingNullableModels.Select(x => x.Id).Sum();
226              valueAverage.Should().Be($"Average {expectedAverage}");
227              valueMin.Should().Be($"Min {expectedMin}");
228              valueMax.Should().Be($"Max {expectedMax}");
229              valueCount.Should().Be($"Total {expectedCount}");
230              valueSum.Should().Be($"Sum {expectedSum}");
231          }
232          [Test]
233          public void AggregateDefinition_Custom_Test()
234          {
235              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>
236              {
237                  Type = AggregateType.Custom,
238                  CustomAggregate = model =>
239                  {
240                      var accountingModels = model as AccountingModel[] ?? model.ToArray();
241                      var highestSalary = accountingModels.Max(z => z.Salary);
242                      var countOver100Grand = accountingModels.Count(z => z.Salary > 100_000);
243                      return $"Highest: {highestSalary.ToString(NumberFormatInfo.InvariantInfo)} | {countOver100Grand.ToString(NumberFormatInfo.InvariantInfo)} Over {100000.ToString(NumberFormatInfo.InvariantInfo)}";
244                  }
245              };
246              var value = aggregateDefinitionAverage.GetValue(null, _accountingModels);
247              value.Should().Be("Highest: 1000000.00 | 5 Over 100000");
248          }
249          [Test]
250          public void AggregateDefinition_InvalidType_Test()
251          {
252              Expression<Func<AccountingModel, decimal>> propertyExpression = model => model.Salary;
253              var aggregateDefinitionAverage = new AggregateDefinition<AccountingModel>
254              {
255                  Type = (AggregateType)(-1)
256              };
257              var value = aggregateDefinitionAverage.GetValue(propertyExpression, _accountingModels);
258              value.Should().Be("0");
259          }
260          [Test(Description = "This is to ensure that we do not return same cached compiled expression and get same results after passing different expression")]
261          public void AggregateDefinition_ReuseDefinition_With_Different_Expressions_Test()
262          {
263              Expression<Func<AccountingModel, long>> propertyExpressionId = model => model.Id;
264              Expression<Func<AccountingModel, decimal>> propertyExpressionSalary = model => model.Salary;
265              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleMin();
266              var expectedIdMin = _accountingModels.Select(x => x.Id).Min();
267              var expectedSalaryMin = _accountingModels.Select(x => x.Salary).Min();
268              var valueIdMin = aggregateDefinitionAverage.GetValue(propertyExpressionId, _accountingModels);
269              var valueSalaryMin = aggregateDefinitionAverage.GetValue(propertyExpressionSalary, _accountingModels);
270              valueIdMin.Should().Be($"Min {expectedIdMin}");
271              valueSalaryMin.Should().Be($"Min {expectedSalaryMin}");
272          }
273      }
274  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-AggregateDefinitionTests.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-AggregateDefinitionTests.cs</div>
                </div>
                <div class="column column_space"><pre><code>86              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleAvg();
87              var aggregateDefinitionMin = AggregateDefinition<AccountingModel>.SimpleMin();
</pre></code></div>
                <div class="column column_space"><pre><code>136              var aggregateDefinitionAverage = AggregateDefinition<AccountingModel>.SimpleAvg();
137              var aggregateDefinitionMin = AggregateDefinition<AccountingModel>.SimpleMin();
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    