
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 16.323417238749048%, Tokens: 11, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>Simple.Data-MDEwOlJlcG9zaXRvcnk4MTg3Njg=-flat-WithTest.cs</h3>
            <pre><code>1  namespace Simple.Data.IntegrationTest.Query
2  {
3      using Mocking.Ado;
4      using NUnit.Framework;
5      [TestFixture]
6      public class WithTest : DatabaseIntegrationContext
7      {
8          protected override void SetSchema(MockSchemaProvider schemaProvider)
9          {
10              schemaProvider.SetTables(new[] { "dbo", "Employee", "BASE TABLE" },
11                                       new[] { "dbo", "Department", "BASE TABLE" },
12                                       new[] { "dbo", "Activity", "BASE TABLE" },
13                                       new[] { "dbo", "Customer", "BASE TABLE" },
14                                       new[] { "dbo", "Order", "BASE TABLE" },
15                                       new[] { "dbo", "Item", "BASE TABLE" },
16                                       new[] { "dbo", "Note", "BASE TABLE" },
17                                       new[] { "dbo", "Activity_Join", "BASE TABLE" },
18                                       new[] { "dbo", "Location", "BASE_TABLE" });
19              schemaProvider.SetColumns(new[] { "dbo", "Employee", "Id" },
20                                        new[] { "dbo", "Employee", "Name" },
21                                        new[] { "dbo", "Employee", "ManagerId" },
22                                        new[] { "dbo", "Employee", "DepartmentId" },
23                                        new[] { "dbo", "Department", "Id" },
24                                        new[] { "dbo", "Department", "Name" },
25                                        new[] { "dbo", "Customer", "Id" },
26                                        new[] { "dbo", "Customer", "Name" },
27                                        new[] { "dbo", "Order", "Id" },
28                                        new[] { "dbo", "Order", "CustomerId" },
29                                        new[] { "dbo", "Order", "Description" },
30                                        new[] { "dbo", "Item", "Id" },
31                                        new[] { "dbo", "Item", "OrderId" },
32                                        new[] { "dbo", "Item", "Description" },
33                                        new[] { "dbo", "Note", "Id" },
34                                        new[] { "dbo", "Note", "CustomerId" },
35                                        new[] { "dbo", "Note", "Text" },
36                                        new[] { "dbo", "Activity", "ID" },
37                                        new[] { "dbo", "Activity", "Description" },
38                                        new[] { "dbo", "Activity_Join", "ID_Activity" },
39                                        new[] { "dbo", "Activity_Join", "ID_Location" },
40                                        new[] { "dbo", "Location", "ID" },
41                                        new[] { "dbo", "Location", "Address" }
42                                        );
43              schemaProvider.SetPrimaryKeys(new object[] {"dbo", "Employee", "Id", 0},
44                                            new object[] {"dbo", "Department", "Id", 0},
45                                            new object[] {"dbo", "Customer", "Id", 0},
46                                            new object[] {"dbo", "Order", "Id", 0},
47                                            new object[] {"dbo", "Item", "Id", 0},
48                                            new object[] {"dbo", "Note", "Id", 0}
49                                            );
50              schemaProvider.SetForeignKeys(
51                  new object[] { "FK_Employee_Department", "dbo", "Employee", "DepartmentId", "dbo", "Department", "Id", 0 },
52                  new object[] { "FK_Activity_Join_Activity", "dbo", "Activity_Join", "ID_Activity", "dbo", "Activity", "ID", 0 },
53                  new object[] { "FK_Activity_Join_Location", "dbo", "Activity_Join", "ID_Location", "dbo", "Location", "ID", 0 },
54                  new object[] { "FK_Order_Customer", "dbo", "Order", "CustomerId", "dbo", "Customer", "Id", 0 },
55                  new object[] { "FK_Item_Order", "dbo", "Item", "OrderId", "dbo", "Order", "Id", 0 },
56                  new object[] { "FK_Note_Customer", "dbo", "Note", "CustomerId", "dbo", "Customer", "Id", 0 }
57                  );
58          }
59          [Test]
60          public void SingleWithClauseUsingMagicMethodShouldUseWith1Join()
61          {
62              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name],"+
63                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid],"+
64                  "[dbo].[department].[id] as [__with1__department__id],[dbo].[department].[name] as [__with1__department__name]"+
65                  " from [dbo].[employee] left join [dbo].[department] on ([dbo].[department].[id] = [dbo].[employee].[departmentid])";
66              var q = _db.Employees.All().WithDepartment();
67              EatException(() => q.ToList());
68              GeneratedSqlIs(expectedSql);
69          }
70          [Test]
71          public void SingleWithClauseUsingMagicMethodShouldUseWithNJoin()
72          {
73              const string expectedSql = "select " +
74                  "[dbo].[department].[id],[dbo].[department].[name],"+
75                  "[dbo].[employee].[id] as [__withn__employees__id],[dbo].[employee].[name] as [__withn__employees__name],"+
76                  "[dbo].[employee].[managerid] as [__withn__employees__managerid],[dbo].[employee].[departmentid] as [__withn__employees__departmentid]"+
77                  " from [dbo].[department] left join [dbo].[employee] on ([dbo].[department].[id] = [dbo].[employee].[departmentid])";
78              var q = _db.Departments.All().WithEmployees();
79              EatException(() => q.ToList());
80              GeneratedSqlIs(expectedSql);
81          }
82          [Test]
83          public void SingleWithClauseUsingReferenceShouldUseJoin()
84          {
85              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
86                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
87                  "[dbo].[department].[id] as [__with1__department__id],[dbo].[department].[name] as [__with1__department__name]" +
88                  " from [dbo].[employee] left join [dbo].[department] on ([dbo].[department].[id] = [dbo].[employee].[departmentid])";
89              var q = _db.Employees.All().With(_db.Employees.Department);
90              EatException(() => q.ToList());
91              GeneratedSqlIs(expectedSql);
92          }
93          [Test]
94          public void SingleWithOneClauseUsingReferenceShouldUseJoinAndForceOne()
95          {
96              const string expectedSql = "select " +
97                  "[dbo].[department].[id],[dbo].[department].[name]," +
98                  "[dbo].[employee].[id] as [__with1__employee__id],[dbo].[employee].[name] as [__with1__employee__name]," +
99                  "[dbo].[employee].[managerid] as [__with1__employee__managerid],[dbo].[employee].[departmentid] as [__with1__employee__departmentid]" +
100                  " from [dbo].[department] left join [dbo].[employee] on ([dbo].[department].[id] = [dbo].[employee].[departmentid])";
101              var q = _db.Departments.All().WithOne(_db.Departments.Employee);
102              EatException(() => q.ToList());
103              GeneratedSqlIs(expectedSql);
104          }
105          [Test]
106          public void SingleWithClauseUsingReferenceWithAliasShouldApplyAliasToSql()
107          {
108              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
109                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
110                  "[foo].[id] as [__with1__foo__id],[foo].[name] as [__with1__foo__name]" +
111                  " from [dbo].[employee] left join [dbo].[department] [foo] on ([foo].[id] = [dbo].[employee].[departmentid])";
112              var q = _db.Employees.All().With(_db.Employees.Department.As("Foo"));
113              EatException(() => q.ToList());
114              GeneratedSqlIs(expectedSql);
115          }
116          [Test]
117          public void SingleWithClauseUsingTwoStepReference()
118          {
119              const string expectedSql = "select "+
120                  "[dbo].[activity].[id],"+
121                  "[dbo].[activity].[description],"+
122                  "[dbo].[location].[id] as [__withn__location__id]," +
123                  "[dbo].[location].[address] as [__withn__location__address]" +
124                  " from [dbo].[activity] "+
125                  "left join [dbo].[activity_join] on ([dbo].[activity].[id] = [dbo].[activity_join].[id_activity]) "+
126                  "left join [dbo].[location] on ([dbo].[location].[id] = [dbo].[activity_join].[id_location])";
127              var q = _db.Activity.All().With(_db.Activity.ActivityJoin.Location);
128              EatException(() => q.ToList());
129              GeneratedSqlIs(expectedSql);
130          }
131          [Test]
132          public void SingleWithClauseUsingExplicitJoinShouldApplyAliasToSql()
133          {
134              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
135                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
136                  "[manager].[id] as [__withn__manager__id],[manager].[name] as [__withn__manager__name]," +
137                  "[manager].[managerid] as [__withn__manager__managerid],[manager].[departmentid] as [__withn__manager__departmentid]" +
138                  " from [dbo].[employee] left join [dbo].[employee] [manager] on ([manager].[id] = [dbo].[employee].[managerid])";
139              dynamic manager;
<span onclick='openModal()' class='match'>140              var q = _db.Employees.All()
141                  .OuterJoin(_db.Employees.As("Manager"), out manager).On(Id: _db.Employees.ManagerId)
142                  .With(manager);
143              EatException(() => q.ToList());
144              GeneratedSqlIs(expectedSql);
145          }
146          [Test]
147          public void SingleWithOneClauseUsingExplicitJoinShouldApplyAliasToSql()
148          {
149              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
150                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
151                  "[manager].[id] as [__with1__manager__id],[manager].[name] as [__with1__manager__name]," +
152                  "[manager].[managerid] as [__with1__manager__managerid],[manager].[departmentid] as [__with1__manager__departmentid]" +
153                  " from [dbo].[employee] left join [dbo].[employee] [manager] on ([manager].[id] = [dbo].[employee].[managerid])";
154              dynamic manager;
</span>155              var q = _db.Employees.All()
156                  .OuterJoin(_db.Employees.As("Manager"), out manager).On(Id: _db.Employees.ManagerId)
157                  .WithOne(manager);
158              EatException(() => q.ToList());
159              GeneratedSqlIs(expectedSql);
160          }
161          [Test]
162          public void MultipleWithClauseJustDoesEverythingYouWouldHope()
163          {
164              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
165                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
166                  "[manager].[id] as [__withn__manager__id],[manager].[name] as [__withn__manager__name]," +
167                  "[manager].[managerid] as [__withn__manager__managerid],[manager].[departmentid] as [__withn__manager__departmentid]," +
168                  "[dbo].[department].[id] as [__with1__department__id],[dbo].[department].[name] as [__with1__department__name]" +
169                  " from [dbo].[employee] left join [dbo].[employee] [manager] on ([manager].[id] = [dbo].[employee].[managerid])" +
170                  " left join [dbo].[department] on ([dbo].[department].[id] = [dbo].[employee].[departmentid])";
171              dynamic manager;
172              var q = _db.Employees.All()
173                  .OuterJoin(_db.Employees.As("Manager"), out manager).On(Id: _db.Employees.ManagerId)
174                  .With(manager)
175                  .WithDepartment();
176              EatException(() => q.ToList());
177              GeneratedSqlIs(expectedSql);
178          }
179          [Test]
180          public void CustomerWithOrdersAndNotes()
181          {
182              const string expectedSql = "select [dbo].[customer].[id],[dbo].[customer].[name]," +
183                                         "[dbo].[order].[id] as [__withn__orders__id],[dbo].[order].[customerid] as [__withn__orders__customerid],[dbo].[order].[description] as [__withn__orders__description]," +
184                                         "[dbo].[note].[id] as [__withn__notes__id],[dbo].[note].[customerid] as [__withn__notes__customerid],[dbo].[note].[text] as [__withn__notes__text]" +
185                                         " from [dbo].[customer]" +
186                                         " left join [dbo].[order] on ([dbo].[customer].[id] = [dbo].[order].[customerid])" +
187                                         " left join [dbo].[note] on ([dbo].[customer].[id] = [dbo].[note].[customerid])";
188              var q = _db.Customers.All().WithOrders().WithNotes();
189              EatException(() => q.ToList());
190              GeneratedSqlIs(expectedSql);
191          }
192          [Test]
193          public void CustomerWithOrdersWithItems()
194          {
195              const string expectedSql = "select [dbo].[Customer].[Id],[dbo].[Customer].[Name]," +
196                  "[dbo].[Order].[Id] AS [__withn__Orders__Id],[dbo].[Order].[CustomerId] AS [__withn__Orders__CustomerId]," +
197                  "[dbo].[Order].[Description] AS [__withn__Orders__Description],[dbo].[Item].[Id] AS [__withn__Items__Id]," +
198                  "[dbo].[Item].[OrderId] AS [__withn__Items__OrderId],[dbo].[Item].[Description] AS [__withn__Items__Description]" +
199                  " from [dbo].[Customer] LEFT JOIN [dbo].[Order] ON ([dbo].[Customer].[Id] = [dbo].[Order].[CustomerId])" +
200                  " LEFT JOIN [dbo].[Item] ON ([dbo].[Order].[Id] = [dbo].[Item].[OrderId])";
201              var q = _db.Customers.All().With(_db.Customers.Orders).With(_db.Customers.Orders.Items);
202              EatException(() => q.ToList());
203              GeneratedSqlIs(expectedSql);
204          }
205          [Test]
206          public void CriteriaReferencesShouldNotBeDuplicatedInSql()
207          {
208              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
209                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
210                  "[dbo].[department].[id] as [__with1__department__id],[dbo].[department].[name] as [__with1__department__name]" +
211                  " from [dbo].[employee] join [dbo].[department] on ([dbo].[department].[id] = [dbo].[employee].[departmentid])" +
212                  " where [dbo].[department].[name] = @p1";
213              var q = _db.Employees.FindAll(_db.Employees.Department.Name == "Dev").WithDepartment();
214              EatException(() => q.ToList());
215              GeneratedSqlIs(expectedSql);
216          }
217          [Test]
218          public void CriteriaReferencesShouldUseWithAliasOutValue()
219          {
220              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
221                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
222                  "[foo].[id] as [__with1__foo__id],[foo].[name] as [__with1__foo__name]" +
223                  " from [dbo].[employee] join [dbo].[department] [foo] on ([foo].[id] = [dbo].[employee].[departmentid])" +
224                  " where ([dbo].[employee].[name] like @p1" +
225                  " and [foo].[name] = @p2)";
226              dynamic foo;
227              var q = _db.Employees.Query()
228                  .Where(_db.Employees.Name.Like("A%"))
229                  .WithOne(_db.Employees.Department.As("Foo"), out foo)
230                  .Where(foo.Name == "Admin");
231              EatException(() => q.ToList());
232              GeneratedSqlIs(expectedSql);
233          }
234          [Test]
235          public void CriteriaReferencesShouldUseSeparateJoinFromWithAlias()
236          {
237              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
238                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
239                  "[foo].[id] as [__with1__foo__id],[foo].[name] as [__with1__foo__name]" +
240                  " from [dbo].[employee]" +
241                  " join [dbo].[department] on ([dbo].[department].[id] = [dbo].[employee].[departmentid])" +
242                  " left join [dbo].[department] [foo] on ([foo].[id] = [dbo].[employee].[departmentid])" +
243                  " where ([dbo].[employee].[name] like @p1" +
244                  " and [dbo].[department].[name] = @p2)";
245              var q = _db.Employees.Query()
246                  .Where(_db.Employees.Name.Like("A%"))
247                  .WithOne(_db.Employees.Department.As("Foo"))
248                  .Where(_db.Employees.Department.Name == "Admin");
249              EatException(() => q.ToList());
250              GeneratedSqlIs(expectedSql);
251          }
252      }
253  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-DialogTests.cs</h3>
            <pre><code>1  #pragma warning disable CS1998 
2  using System;
3  using System.Linq;
4  using System.Runtime.CompilerServices;
5  using System.Threading;
6  using System.Threading.Tasks;
7  using Bunit;
8  using FluentAssertions;
9  using Microsoft.AspNetCore.Components.Web;
10  using Microsoft.Extensions.DependencyInjection;
11  using MudBlazor.UnitTests.TestComponents;
12  using MudBlazor.UnitTests.TestComponents.Dialog;
13  using NUnit.Framework;
14  namespace MudBlazor.UnitTests.Components
15  {
16      [TestFixture]
17      public class DialogTests : BunitTest
18      {
19          [Test]
20          public async Task LifecycleTest()
21          {
22              var comp = Context.RenderComponent<MudDialogProvider>();
23              var service = Context.Services.GetService<IDialogService>() as DialogService;
24              service.Should().NotBe(null);
25              IDialogReference dialogReference = null;
26              await comp.InvokeAsync(async () =>
27              {
28                  dialogReference = service?.Show<DialogRender>();
29                  var result1 = await dialogReference.Result;
30                  dialogReference = service?.Show<DialogRender>();
31                  var result2 = await dialogReference.Result;
32              });
33              DialogRender.OnInitializedCount.Should().Be(2);
34              DialogRender.OnInitializedCount = 0;
35          }
36          [Test]
37          public async Task SimpleTest()
38          {
39              var comp = Context.RenderComponent<MudDialogProvider>();
40              comp.Markup.Trim().Should().BeEmpty();
41              var service = Context.Services.GetService<IDialogService>() as DialogService;
42              service.Should().NotBe(null);
43              IDialogReference dialogReference = null;
44              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
45              dialogReference.Should().NotBe(null);
46              comp.Find("div.mud-dialog-container").Should().NotBe(null);
47              comp.Find("p.mud-typography").TrimmedText().Should().Be("Wabalabadubdub!");
48              comp.Find("div.mud-overlay").Click();
49              comp.Markup.Trim().Should().BeEmpty();
50              var result = await dialogReference.Result;
51              result.Canceled.Should().BeTrue();
52              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
53              comp.FindAll("button")[0].Click();
54              result = await dialogReference.Result;
55              result.Canceled.Should().BeTrue();
56              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
57              comp.FindAll("button")[1].Click();
58              result = await dialogReference.Result;
59              result.Canceled.Should().BeFalse();
60              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
61              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
62              var cont = comp.FindAll("div.mud-dialog-container");
63              cont.Count.Should().Be(2);
64              await comp.InvokeAsync(() => comp.Instance.DismissAll());
65              cont = comp.FindAll("div.mud-dialog-container");
66              cont.Count.Should().Be(0);
67          }
68          [Test]
69          [Obsolete]
70          public async Task ObsoleteEquivalenceTest()
71          {
72              var value = "Test";
73              var result = new DialogResult(value, value.GetType(), false);
74              result.Canceled.Should().BeFalse();
75              result.Cancelled.Should().Be(result.Canceled);
76              result = new DialogResult(value, value.GetType(), true);
77              result.Canceled.Should().BeTrue();
78              result.Cancelled.Should().Be(result.Canceled);
79          }
80          [Test]
81          public async Task InlineDialogTest()
82          {
83              var comp = Context.RenderComponent<MudDialogProvider>();
84              comp.Markup.Trim().Should().BeEmpty();
85              var service = Context.Services.GetService<IDialogService>() as DialogService;
86              service.Should().NotBe(null);
87              var comp1 = Context.RenderComponent<TestInlineDialog>();
88              comp1.FindComponents<MudButton>().Count.Should().Be(1);
89              comp1.Find("button").Click();
90              comp1.WaitForAssertion(() =>
91                  comp.Find("div.mud-dialog-container").Should().NotBe(null)
92              );
93              comp.Find("p.mud-typography").TrimmedText().Should().Be("Wabalabadubdub!");
94              comp.Find("div.mud-dialog").GetAttribute("class").Should().Contain("mud-dialog-width-full");
95              comp.Find("button").Click();
96              comp.Markup.Trim().Should().BeEmpty();
97          }
98          [Test]
99          public async Task NestedInlineDialogTest()
100          {
101              var provider = Context.RenderComponent<MudDialogProvider>();
102              provider.Markup.Trim().Should().BeEmpty();
103              var service = Context.Services.GetService<IDialogService>() as DialogService;
104              service.Should().NotBe(null);
105              var comp = Context.RenderComponent<TestNestedInlineDialog>();
106              comp.FindComponents<MudButton>().Count.Should().Be(1);
107              comp.Find("button").Click();
108              comp.WaitForAssertion(() =>
109                  provider.Find("div.mud-dialog-container").Should().NotBe(null)
110              );
111              provider.Find("p.mud-typography").TrimmedText().Should().Be("Scorpiany!");
112              provider.FindComponents<MudText>().Count.Should().Be(2); 
113              provider.Find("button").Click(); 
114              comp.WaitForAssertion(() =>
115                  provider.Find(".nested").Should().NotBe(null)
116              );
117              provider.FindAll("p.mud-typography")[1].TrimmedText().Should().Be("Nested dialog!");
118              provider.FindComponents<MudText>().Count.Should().Be(4); 
119          }
120          [Test]
121          public async Task InlineDialog_Should_UpdateIsVisibleOnClose()
122          {
123              await ImproveChanceOfSuccess(async () =>
124              {
125                  var comp = Context.RenderComponent<MudDialogProvider>();
126                  comp.Markup.Trim().Should().BeEmpty();
127                  var service = Context.Services.GetService<IDialogService>() as DialogService;
128                  service.Should().NotBe(null);
129                  var comp1 = Context.RenderComponent<InlineDialogIsVisibleStateTest>();
130                  comp1.Find("button").Click();
131                  comp.WaitForAssertion(() => comp.Find("div.mud-dialog-container").Should().NotBe(null));
132                  comp.Find("div.mud-overlay").Click();
133                  comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
134                  comp1.Find("button").Click();
135                  comp.WaitForAssertion(() => comp.Find("div.mud-dialog-container").Should().NotBe(null),
136                      TimeSpan.FromSeconds(5));
137                  comp.WaitForAssertion(() => comp.Find("div.mud-overlay").Should().NotBeNull());
138                  comp.Find("div.mud-overlay").Click();
139                  comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
140              });
141          }
142          [Test]
143          public async Task InlineDialogShouldHonorClassAndStyle()
144          {
145              var comp = Context.RenderComponent<MudDialogProvider>();
146              comp.Markup.Trim().Should().BeEmpty();
147              var service = Context.Services.GetService<IDialogService>() as DialogService;
148              service.Should().NotBe(null);
149              IDialogReference dialogReference = null;
150              await comp.InvokeAsync(() => dialogReference = service?.Show<TestInlineDialog>());
151              comp.WaitForAssertion(() => dialogReference.Should().NotBe(null));
152              comp.Find("button").Click();
153              comp.WaitForAssertion(() => comp.Find("div.mud-dialog").ClassList.Should().Contain("test-class"));
154              comp.Find("div.mud-dialog").Attributes["style"].Value.Should().Be("color: red;");
155              comp.Find("div.mud-dialog-content").Attributes["style"].Value.Should().Be("color: blue;");
156              comp.Find("div.mud-dialog-content").ClassList.Should().NotContain("test-class");
157              comp.Find("div.mud-dialog-content").ClassList.Should().Contain("content-class");
158              var dialogInstance = comp.FindComponent<MudDialog>().Instance;
159              dialogInstance.Tag.Should().Be("test-tag");
160          }
161          [Test]
162          public async Task InlineDialogShouldNotCloseAfterStateHasChanged()
163          {
164              var comp = Context.RenderComponent<MudDialogProvider>();
165              comp.Markup.Trim().Should().BeEmpty();
166              var service = Context.Services.GetService<IDialogService>() as DialogService;
167              service.Should().NotBe(null);
168              var comp1 = Context.RenderComponent<TestInlineDialog>();
169              comp1.Find("button").Click();
170              comp.Find("span.mud-rating-item").FirstElementChild.Click();
171              comp.WaitForAssertion(() => comp.Find("div.mud-dialog-container").Should().NotBe(null), TimeSpan.FromSeconds(5));
172          }
173          [Test]
174          public async Task DialogShouldUpdateTitleContent()
175          {
176              var comp = Context.RenderComponent<MudDialogProvider>();
177              comp.Markup.Trim().Should().BeEmpty();
178              var service = Context.Services.GetService<IDialogService>() as DialogService;
179              service.Should().NotBe(null);
180              IDialogReference dialogReference = null;
181              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogThatUpdatesItsTitle>());
182              dialogReference.Should().NotBe(null);
183              comp.Find("div.mud-dialog-content").TrimmedText().Should().Be("Body:");
184              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title:");
185              comp.FindAll("button")[1].Click();
186              comp.Find("div.mud-dialog-content").TrimmedText().Should().Be("Body: Test123");
187              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title: Test123");
188          }
189          [Test]
190          public async Task DialogShouldNotOverwriteParameters()
191          {
192              var comp = Context.RenderComponent<MudDialogProvider>();
193              comp.Markup.Trim().Should().BeEmpty();
194              var service = Context.Services.GetService<IDialogService>() as DialogService;
195              service.Should().NotBe(null);
196              IDialogReference dialogReference = null;
197              var parameters = new DialogParameters();
198              parameters.Add("TestValue", "test");
199              parameters.Add("Color_Test", Color.Error); 
200              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogWithParameters>(string.Empty, parameters));
201              dialogReference.Should().NotBe(null);
202              var textField = comp.FindComponent<MudInput<string>>().Instance;
203              textField.Text.Should().Be("test");
204              comp.Find("input").Change("new_test");
205              comp.Find("input").Blur();
206              textField.Text.Should().Be("new_test");
<span onclick='openModal()' class='match'>207              comp.FindAll("button")[0].Click();
208              ((DialogWithParameters)dialogReference.Dialog).TestValue.Should().Be("new_test");
209              ((DialogWithParameters)dialogReference.Dialog).ParamtersSetCounter.Should().Be(1);
210              textField.Text.Should().Be("new_test");
211          }
212          [Test]
213          public async Task DialogShouldHonorClassAndStyle()
214          {
215              var comp = Context.RenderComponent<MudDialogProvider>();
</span>216              comp.Markup.Trim().Should().BeEmpty();
217              var service = Context.Services.GetService<IDialogService>() as DialogService;
218              service.Should().NotBe(null);
219              IDialogReference dialogReference = null;
220              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
221              dialogReference.Should().NotBe(null);
222              comp.Find("div.mud-dialog").ClassList.Should().Contain("test-class");
223              comp.Find("div.mud-dialog").Attributes["style"].Value.Should().Be("color: red;");
224              comp.Find("div.mud-dialog-content").Attributes["style"].Value.Should().Be("color: blue;");
225              comp.Find("div.mud-dialog-content").ClassList.Should().NotContain("test-class");
226              comp.Find("div.mud-dialog-content").ClassList.Should().Contain("content-class");
227          }
228          [Test]
229          public async Task PassingEventCallbackToDialogViaParameters()
230          {
231              var comp = Context.RenderComponent<MudDialogProvider>();
232              comp.Markup.Trim().Should().BeEmpty();
233              var service = Context.Services.GetService<IDialogService>() as DialogService;
234              service.Should().NotBe(null);
235              var testComp = Context.RenderComponent<DialogWithEventCallbackTest>();
236              testComp.Find("button").Click();
237              var tf = comp.FindComponent<MudTextField<string>>();
238              tf.Find("input").Input("User input ...");
239              testComp.WaitForAssertion(() =>
240                  testComp.Find("p").TextContent.Trim().Should().Be("Search Text:  User input ...")
241              );
242          }
243          [Test]
244          public async Task CustomDialogService()
245          {
246              Context.Services.Remove(Context.Services.FirstOrDefault(descriptor => descriptor.ServiceType == typeof(IDialogService)));
247              Context.Services.AddScoped<IDialogService>(sp => new CustomDialogService());
248              var comp = Context.RenderComponent<MudDialogProvider>();
249              comp.Markup.Trim().Should().BeEmpty();
250              var service = Context.Services.GetService<IDialogService>();
251              service.Should().NotBe(null);
252              service.Should().BeAssignableTo(typeof(CustomDialogService));
253              IDialogReference dialogReference = null;
254              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogThatUpdatesItsTitle>());
255              dialogReference.Should().NotBe(null);
256              dialogReference.Should().BeAssignableTo(typeof(CustomDialogReference));
257              var customDialogReference = (CustomDialogReference)dialogReference;
258              customDialogReference.AllowDismiss.Should().BeFalse();
259              comp.Find("div.mud-overlay").Click();
260              comp.WaitForAssertion(() => comp.Markup.Trim().Should().NotBeEmpty(), TimeSpan.FromSeconds(5));
261              customDialogReference.AllowDismiss = true;
262              comp.Find("div.mud-overlay").Click();
263              comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
264          }
265          [Test]
266          public async Task DialogShouldReturnTheReturnValue()
267          {
268              var comp = Context.RenderComponent<MudDialogProvider>();
269              comp.Markup.Trim().Should().BeEmpty();
270              var service = Context.Services.GetService<IDialogService>() as DialogService;
271              service.Should().NotBe(null);
272              IDialogReference dialogReference = null;
273              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogWithReturnValue>());
274              dialogReference.Should().NotBe(null);
275              comp.FindAll("button")[0].Click();
276              var rv = await dialogReference.GetReturnValueAsync<string>();
277              rv.Should().BeNull();
278              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogWithReturnValue>());
279              comp.FindAll("button")[1].Click();
280              rv = await dialogReference.GetReturnValueAsync<string>();
281              rv.Should().Be("Closed via OK");
282          }
283          [Test]
284          public async Task DialogKeyboardNavigation()
285          {
286              var comp = Context.RenderComponent<MudDialogProvider>();
287              comp.Markup.Trim().Should().BeEmpty();
288              var service = Context.Services.GetService<IDialogService>() as DialogService;
289              service.Should().NotBe(null);
290              IDialogReference dialogReference = null;
291              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>(string.Empty, new DialogOptions() { CloseOnEscapeKey = true }));
292              dialogReference.Should().NotBe(null);
293              var dialog1 = (DialogOkCancel)dialogReference.Dialog;
294              comp.Markup.Trim().Should().NotBeEmpty();
295              await comp.InvokeAsync(() => dialog1.MudDialog.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
296              comp.Markup.Trim().Should().BeEmpty();
297              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>(string.Empty, new DialogOptions() { CloseOnEscapeKey = false }));
298              dialogReference.Should().NotBe(null);
299              var dialog2 = (DialogOkCancel)dialogReference.Dialog;
300              comp.Markup.Trim().Should().NotBeEmpty();
301              await comp.InvokeAsync(() => dialog2.MudDialog.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
302              comp.Markup.Trim().Should().NotBeEmpty();
303          }
304          [Test]
305          public async Task DialogHandlesOnBackdropClickEvent()
306          {
307              var comp = Context.RenderComponent<MudDialogProvider>();
308              comp.Markup.Trim().Should().BeEmpty();
309              var service = Context.Services.GetService<IDialogService>() as DialogService;
310              service.Should().NotBe(null);
311              IDialogReference dialogReference = null;
312              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogWithOnBackdropClickEvent>());
313              dialogReference.Should().NotBe(null);
314              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title:");
315              comp.Find("div.mud-overlay").Click();
316              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title: Backdrop clicked");
317          }
318          [Test]
319          public async Task InlineDialogBug4871Test()
320          {
321              var comp = Context.RenderComponent<MudDialogProvider>();
322              comp.Markup.Trim().Should().BeEmpty();
323              var service = Context.Services.GetService<IDialogService>() as DialogService;
324              service.Should().NotBe(null);
325              var comp1 = Context.RenderComponent<TestInlineDialog>();
326              comp1.FindComponents<MudButton>().Count.Should().Be(1);
327              comp1.Find("button").Click();
328              comp1.WaitForAssertion(() =>
329                  comp.Find("div.mud-dialog-container").Should().NotBe(null)
330              );
331              comp.Find("p.mud-typography").TrimmedText().Should().Be("Wabalabadubdub!");
332              comp.Find("div.mud-dialog").GetAttribute("class").Should().Contain("mud-dialog-width-full");
333              comp.FindAll("button").Last().Click();
334              comp.WaitForAssertion(() => comp.FindComponent<MudMessageBox>());
335              var messageBox = comp.FindComponent<MudMessageBox>();
336              messageBox.Should().NotBeNull();
337              messageBox.Instance.YesText.Should().Be("BUG4871");
338          }
339          [Test]
340          public async Task DialogToggleFullscreenOptions()
341          {
342              var comp = Context.RenderComponent<MudDialogProvider>();
343              comp.Markup.Trim().Should().BeEmpty();
344              var service = Context.Services.GetService<IDialogService>() as DialogService;
345              service.Should().NotBe(null);
346              IDialogReference dialogReference = null;
347              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogToggleFullscreen>());
348              dialogReference.Should().NotBe(null);
349              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-width-sm");
350              comp.Find("button").Click();
351              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-fullscreen");
352              comp.Find("button").Click();
353              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-width-sm");
354          }
355          [Test]
356          public async Task AsyncLifecycleTest()
357          {
358              var comp = Context.RenderComponent<MudDialogProvider>();
359              var service = Context.Services.GetService<IDialogService>() as DialogService;
360              service.Should().NotBe(null);
361              await comp.InvokeAsync(async () =>
362              {
363                  var dialogReference = await service!.ShowAsync<DialogRender>();
364                  await dialogReference.Result;
365                  dialogReference = await service.ShowAsync<DialogRender>();
366                  await dialogReference.Result;
367              });
368              DialogRender.OnInitializedCount.Should().Be(2);
369              DialogRender.OnInitializedCount = 0;
370          }
371          [Test]
372          public async Task AsyncSimpleTest()
373          {
374              var comp = Context.RenderComponent<MudDialogProvider>();
375              comp.Markup.Trim().Should().BeEmpty();
376              var service = Context.Services.GetService<IDialogService>() as DialogService;
377              service.Should().NotBe(null);
378              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
379              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
380              var dialogReference = await dialogReferenceLazy.Value;
381              dialogReference.Should().NotBe(null);
382              comp.Find("div.mud-dialog-container").Should().NotBe(null);
383              comp.Find("p.mud-typography").TrimmedText().Should().Be("Wabalabadubdub!");
384              comp.Find("div.mud-overlay").Click();
385              comp.Markup.Trim().Should().BeEmpty();
386              var result = await dialogReference.Result;
387              result.Canceled.Should().BeTrue();
388              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
389              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
390              dialogReference = await dialogReferenceLazy.Value;
391              comp.FindAll("button")[0].Click();
392              result = await dialogReference.Result;
393              result.Canceled.Should().BeTrue();
394              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
395              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
396              dialogReference = await dialogReferenceLazy.Value;
397              comp.FindAll("button")[1].Click();
398              result = result = await dialogReference.Result;
399              result.Canceled.Should().BeFalse();
400              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
401              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
402              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
403              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
404              var cont = comp.FindAll("div.mud-dialog-container");
405              cont.Count.Should().Be(2);
406              await comp.InvokeAsync(() => comp.Instance.DismissAll());
407              cont = comp.FindAll("div.mud-dialog-container");
408              cont.Count.Should().Be(0);
409          }
410          [Test]
411          public async Task InlineAsyncDialogShouldHonorClassAndStyle()
412          {
413              var comp = Context.RenderComponent<MudDialogProvider>();
414              comp.Markup.Trim().Should().BeEmpty();
415              var service = Context.Services.GetService<IDialogService>() as DialogService;
416              service.Should().NotBe(null);
417              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<TestInlineDialog>());
418              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
419              var dialogReference = await dialogReferenceLazy.Value;
420              comp.WaitForAssertion(() => dialogReference.Should().NotBe(null));
421              comp.Find("button").Click();
422              comp.WaitForAssertion(() => comp.Find("div.mud-dialog").ClassList.Should().Contain("test-class"));
423              comp.Find("div.mud-dialog").Attributes["style"].Value.Should().Be("color: red;");
424              comp.Find("div.mud-dialog-content").Attributes["style"].Value.Should().Be("color: blue;");
425              comp.Find("div.mud-dialog-content").ClassList.Should().NotContain("test-class");
426              comp.Find("div.mud-dialog-content").ClassList.Should().Contain("content-class");
427              var dialogInstance = comp.FindComponent<MudDialog>().Instance;
428              dialogInstance.Tag.Should().Be("test-tag");
429          }
430          [Test]
431          public async Task AsyncDialogShouldUpdateTitleContent()
432          {
433              var comp = Context.RenderComponent<MudDialogProvider>();
434              comp.Markup.Trim().Should().BeEmpty();
435              var service = Context.Services.GetService<IDialogService>() as DialogService;
436              service.Should().NotBe(null);
437              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogThatUpdatesItsTitle>());
438              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
439              var dialogReference = await dialogReferenceLazy.Value;
440              dialogReference.Should().NotBe(null);
441              comp.Find("div.mud-dialog-content").TrimmedText().Should().Be("Body:");
442              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title:");
443              comp.FindAll("button")[1].Click();
444              comp.Find("div.mud-dialog-content").TrimmedText().Should().Be("Body: Test123");
445              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title: Test123");
446          }
447          [Test]
448          public async Task AsyncDialogShouldNotOverwriteParameters()
449          {
450              var comp = Context.RenderComponent<MudDialogProvider>();
451              comp.Markup.Trim().Should().BeEmpty();
452              var service = Context.Services.GetService<IDialogService>() as DialogService;
453              service.Should().NotBe(null);
454              var parameters = new DialogParameters();
455              parameters.Add("TestValue", "test");
456              parameters.Add("Color_Test", Color.Error); 
457              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogWithParameters>(string.Empty, parameters));
458              await comp.InvokeAsync(()=> dialogReferenceLazy.Value);
459              var dialogReference = await dialogReferenceLazy.Value;
460              dialogReference.Should().NotBe(null);
461              var textField = comp.FindComponent<MudInput<string>>().Instance;
462              textField.Text.Should().Be("test");
463              comp.Find("input").Change("new_test");
464              comp.Find("input").Blur();
465              textField.Text.Should().Be("new_test");
466              comp.FindAll("button")[0].Click();
467              ((DialogWithParameters)dialogReference.Dialog).TestValue.Should().Be("new_test");
468              ((DialogWithParameters)dialogReference.Dialog).ParamtersSetCounter.Should().Be(1);
469              textField.Text.Should().Be("new_test");
470          }
471          [Test]
472          public async Task AsyncDialogShouldHonorClassAndStyle()
473          {
474              var comp = Context.RenderComponent<MudDialogProvider>();
475              comp.Markup.Trim().Should().BeEmpty();
476              var service = Context.Services.GetService<IDialogService>() as DialogService;
477              service.Should().NotBe(null);
478              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
479              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
480              var dialogReference = await dialogReferenceLazy.Value;
481              dialogReference.Should().NotBe(null);
482              comp.Find("div.mud-dialog").ClassList.Should().Contain("test-class");
483              comp.Find("div.mud-dialog").Attributes["style"].Value.Should().Be("color: red;");
484              comp.Find("div.mud-dialog-content").Attributes["style"].Value.Should().Be("color: blue;");
485              comp.Find("div.mud-dialog-content").ClassList.Should().NotContain("test-class");
486              comp.Find("div.mud-dialog-content").ClassList.Should().Contain("content-class");
487          }
488          [Test]
489          public async Task AsyncCustomDialogService()
490          {
491              Context.Services.Remove(Context.Services.FirstOrDefault(descriptor => descriptor.ServiceType == typeof(IDialogService)));
492              Context.Services.AddScoped<IDialogService>(sp => new CustomDialogService());
493              var comp = Context.RenderComponent<MudDialogProvider>();
494              comp.Markup.Trim().Should().BeEmpty();
495              var service = Context.Services.GetService<IDialogService>();
496              service.Should().NotBe(null);
497              service.Should().BeAssignableTo(typeof(CustomDialogService));
498              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogThatUpdatesItsTitle>());
499              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
500              var dialogReference = await dialogReferenceLazy.Value;
501              dialogReference.Should().NotBe(null);
502              dialogReference.Should().BeAssignableTo(typeof(CustomDialogReference));
503              var customDialogReference = (CustomDialogReference)dialogReference;
504              customDialogReference.AllowDismiss.Should().BeFalse();
505              comp.Find("div.mud-overlay").Click();
506              comp.WaitForAssertion(() => comp.Markup.Trim().Should().NotBeEmpty(), TimeSpan.FromSeconds(5));
507              customDialogReference.AllowDismiss = true;
508              comp.Find("div.mud-overlay").Click();
509              comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
510          }
511          [Test]
512          public async Task AsyncDialogShouldReturnTheReturnValue()
513          {
514              var comp = Context.RenderComponent<MudDialogProvider>();
515              comp.Markup.Trim().Should().BeEmpty();
516              var service = Context.Services.GetService<IDialogService>() as DialogService;
517              service.Should().NotBe(null);
518              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogWithReturnValue>());
519              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
520              var dialogReference = await dialogReferenceLazy.Value;
521              dialogReference.Should().NotBe(null);
522              comp.FindAll("button")[0].Click();
523              var rv = await dialogReference.GetReturnValueAsync<string>();
524              rv.Should().BeNull();
525              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogWithReturnValue>());
526              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
527              comp.FindAll("button")[1].Click();
528              dialogReference = await dialogReferenceLazy.Value;
529              rv = await dialogReference.GetReturnValueAsync<string>();
530              rv.Should().Be("Closed via OK");
531          }
532          [Test]
533          public async Task AsyncDialogKeyboardNavigation()
534          {
535              var comp = Context.RenderComponent<MudDialogProvider>();
536              comp.Markup.Trim().Should().BeEmpty();
537              var service = Context.Services.GetService<IDialogService>() as DialogService;
538              service.Should().NotBe(null);
539              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>(string.Empty, new DialogOptions() { CloseOnEscapeKey = true }));
540              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
541              dialogReferenceLazy.Value.Should().NotBe(null);
542              var dialogReference = await dialogReferenceLazy.Value;
543              var dialog1 = (DialogOkCancel)dialogReference.Dialog;
544              comp.Markup.Trim().Should().NotBeEmpty();
545              await comp.InvokeAsync(() => dialog1.MudDialog.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
546              comp.Markup.Trim().Should().BeEmpty();
547              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>(string.Empty, new DialogOptions() { CloseOnEscapeKey = false }));
548              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
549              dialogReference = await dialogReferenceLazy.Value;
550              dialogReference.Should().NotBe(null);
551              var dialog2 = (DialogOkCancel)dialogReference.Dialog;
552              comp.Markup.Trim().Should().NotBeEmpty();
553              await comp.InvokeAsync(() => dialog2.MudDialog.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
554              comp.Markup.Trim().Should().NotBeEmpty();
555          }
556          [Test]
557          public async Task AsyncDialogHandlesOnBackdropClickEvent()
558          {
559              var comp = Context.RenderComponent<MudDialogProvider>();
560              comp.Markup.Trim().Should().BeEmpty();
561              var service = Context.Services.GetService<IDialogService>() as DialogService;
562              service.Should().NotBe(null);
563              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogWithOnBackdropClickEvent>());
564              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
565              var dialogReference = await dialogReferenceLazy.Value;
566              dialogReference.Should().NotBe(null);
567              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title:");
568              comp.Find("div.mud-overlay").Click();
569              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title: Backdrop clicked");
570          }
571          [Test]
572          public async Task AsyncDialogToggleFullscreenOptions()
573          {
574              var comp = Context.RenderComponent<MudDialogProvider>();
575              comp.Markup.Trim().Should().BeEmpty();
576              var service = Context.Services.GetService<IDialogService>() as DialogService;
577              service.Should().NotBe(null);
578              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogToggleFullscreen>());
579              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
580              var dialogReference = await dialogReferenceLazy.Value;
581              dialogReference.Should().NotBe(null);
582              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-width-sm");
583              comp.Find("button").Click();
584              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-fullscreen");
585              comp.Find("button").Click();
586              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-width-sm");
587          }
588          [Test]
589          public async Task ShowAsyncRenderCompleteTest()
590          {
591              var comp = Context.RenderComponent<MudDialogProvider>();
592              var service = Context.Services.GetService<IDialogService>();
593              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
594              await comp.InvokeAsync(async () => await dialogReferenceLazy.Value);
595              var dialogReference = await dialogReferenceLazy.Value;
596              var result = await dialogReference.RenderCompleteTaskCompletionSource.Task;
597              result.Should().Be(true);
598          }
599          [Test]
600          public void MockIDialogReferenceShouldWork()
601          {
602              Func<IDialogReference> createMock = Moq.Mock.Of<IDialogReference>;
603              createMock.Should().NotThrow();
604          }
605      }
606      internal class CustomDialogService : DialogService
607      {
608          public override IDialogReference CreateReference() => new CustomDialogReference(Guid.NewGuid(), this);
609      }
610      internal class CustomDialogReference : DialogReference
611      {
612          public bool AllowDismiss { get; set; }
613          public CustomDialogReference(Guid dialogInstanceId, IDialogService dialogService) : base(dialogInstanceId, dialogService) { }
614          public override bool Dismiss(DialogResult result)
615          {
616              return AllowDismiss;
617          }
618      }
619  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Simple.Data-MDEwOlJlcG9zaXRvcnk4MTg3Njg=-flat-WithTest.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-DialogTests.cs</div>
                </div>
                <div class="column column_space"><pre><code>140              var q = _db.Employees.All()
141                  .OuterJoin(_db.Employees.As("Manager"), out manager).On(Id: _db.Employees.ManagerId)
142                  .With(manager);
143              EatException(() => q.ToList());
144              GeneratedSqlIs(expectedSql);
145          }
146          [Test]
147          public void SingleWithOneClauseUsingExplicitJoinShouldApplyAliasToSql()
148          {
149              const string expectedSql = "select [dbo].[employee].[id],[dbo].[employee].[name]," +
150                  "[dbo].[employee].[managerid],[dbo].[employee].[departmentid]," +
151                  "[manager].[id] as [__with1__manager__id],[manager].[name] as [__with1__manager__name]," +
152                  "[manager].[managerid] as [__with1__manager__managerid],[manager].[departmentid] as [__with1__manager__departmentid]" +
153                  " from [dbo].[employee] left join [dbo].[employee] [manager] on ([manager].[id] = [dbo].[employee].[managerid])";
154              dynamic manager;
</pre></code></div>
                <div class="column column_space"><pre><code>207              comp.FindAll("button")[0].Click();
208              ((DialogWithParameters)dialogReference.Dialog).TestValue.Should().Be("new_test");
209              ((DialogWithParameters)dialogReference.Dialog).ParamtersSetCounter.Should().Be(1);
210              textField.Text.Should().Be("new_test");
211          }
212          [Test]
213          public async Task DialogShouldHonorClassAndStyle()
214          {
215              var comp = Context.RenderComponent<MudDialogProvider>();
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    