
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 19.15820029027576%, Tokens: 10, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>Simple.Data-MDEwOlJlcG9zaXRvcnk4MTg3Njg=-flat-BulkInsertTest_40.cs</h3>
            <pre><code>1  namespace Simple.Data.IntegrationTest
2  {
3      using System;
4      using System.Dynamic;
5      using Mocking.Ado;
6      using NUnit.Framework;
7      [TestFixture]
8      public class BulkInsertTest : DatabaseIntegrationContext
9      {
10          protected override void SetSchema(MockSchemaProvider schemaProvider)
11          {
12              schemaProvider.SetTables(new[] { "dbo", "Users", "BASE TABLE" },
13                                       new[] { "dbo", "NoIdentityColumnUsers", "BASE TABLE" },
14                                       new[] { "foo", "Users", "BASE TABLE" });
15              schemaProvider.SetColumns(new object[] { "dbo", "Users", "Id", true },
16                                        new[] { "dbo", "Users", "Name" },
17                                        new[] { "dbo", "Users", "Password" },
18                                        new[] { "dbo", "Users", "Age" },
19                                        new object[] { "foo", "Users", "Id", true },
20                                        new[] { "foo", "Users", "Name" },
21                                        new[] { "foo", "Users", "Password" },
22                                        new[] { "foo", "Users", "Age" },
23                                        new[] { "dbo", "NoIdentityColumnUsers", "Id" },
24                                        new[] { "dbo", "NoIdentityColumnUsers", "Name" },
25                                        new[] { "dbo", "NoIdentityColumnUsers", "Password" },
26                                        new[] { "dbo", "NoIdentityColumnUsers", "Age" });
27              schemaProvider.SetPrimaryKeys(new object[] { "dbo", "Users", "Id", 0 });
28          }
29          [Test]
30          public void TestBulkInsertWithStaticTypeObjectAndIdentityColumn()
31          {
32              var users = new[] { new User { Name = "Steve", Age = 50 },  new User { Name = "Phil", Age = 42 }};
33              _db.Users.Insert(users);
34              GeneratedSqlIs("insert into [dbo].[Users] ([Name],[Password],[Age]) values (@p0,@p1,@p2)");
35              Parameter(0).Is("Phil");
36              Parameter(1).Is(DBNull.Value);
37              Parameter(2).Is(42);
38          }
39          [Test]
40          public void TestBulkInsertWithStaticTypeObjectAndIdentityColumnOnSchemaQualifiedTable()
41          {
42              var users = new[] { new User { Name = "Steve", Age = 50 },  new User { Name = "Phil", Age = 42 }};
43              _db.foo.Users.Insert(users);
44              GeneratedSqlIs("insert into [foo].[Users] ([Name],[Password],[Age]) values (@p0,@p1,@p2)");
45              Parameter(0).Is("Phil");
46              Parameter(1).Is(DBNull.Value);
47              Parameter(2).Is(42);
48          }
49          [Test]
50          public void TestBulkInsertWithStaticTypeObjectAndIdentityColumnAndIdentityFunctionThatExpectsAValueSelects()
51          {
52              _MockConnectionProvider.SetIdentityFunction("@@IDENTITY");
53              var users = new[] { new User { Name = "Steve", Age = 50 },  new User { Name = "Phil", Age = 42 }};
54              var inserted = _db.Users.Insert(users);
55              GeneratedSqlIs("insert into [dbo].[Users] ([Name],[Password],[Age]) values (@p0,@p1,@p2); select * from [dbo].[users] where [id] = @@identity");
56              Parameter(0).Is("Phil");
57              Parameter(1).Is(DBNull.Value);
58              Parameter(2).Is(42);
59              _MockConnectionProvider.SetIdentityFunction(null);
60          }
61          [Test]
62          public void TestBulkInsertWithStaticTypeObjectAndIdentityColumnAndIdentityFunctionThatDoesNotExpectAValueDoesNotSelect()
63          {
64              _MockConnectionProvider.SetIdentityFunction("@@IDENTITY");
65              var users = new[] { new User { Name = "Steve", Age = 50 },  new User { Name = "Phil", Age = 42 }};
66              _db.Users.Insert(users);
67              GeneratedSqlIs("insert into [dbo].[Users] ([Name],[Password],[Age]) values (@p0,@p1,@p2)");
68              Parameter(0).Is("Phil");
69              Parameter(1).Is(DBNull.Value);
70              Parameter(2).Is(42);
71              _MockConnectionProvider.SetIdentityFunction(null);
72          }
73          [Test]
74          public void TestBulkInsertWithDynamicObjectAndIdentityColumn()
75          {
76              dynamic steve = new ExpandoObject();
77              steve.Name = "Steve";
78              steve.Age = 50;
79              dynamic phil = new ExpandoObject();
80              phil.Name = "Phil";
81              phil.Age = 42;
82              _db.Users.Insert(new[] {steve,phil});
83              GeneratedSqlIs("insert into [dbo].[Users] ([Name],[Password],[Age]) values (@p0,@p1,@p2)");
84              Parameter(0).Is("Phil");
85              Parameter(1).Is(DBNull.Value);
86              Parameter(2).Is(42);
87          }
88          [Test]
89          public void TestBulkInsertWithStaticTypeObjectAndNoIdentityColumn()
90          {
91              var users = new[] { new User { Id = 1, Name = "Steve", Age = 50 }, new User { Id = 2, Name = "Phil", Age = 42 } };
92              _db.NoIdentityColumnUsers.Insert(users);
93              GeneratedSqlIs("insert into [dbo].[NoIdentityColumnUsers] ([Id],[Name],[Password],[Age]) values (@p0,@p1,@p2,@p3)");
94              Parameter(0).Is(2);
95              Parameter(1).Is("Phil");
96              Parameter(2).Is(DBNull.Value);
97              Parameter(3).Is(42);
98          }
99          [Test]
100          public void TestBulkInsertWithDynamicObjectAndNoIdentityColumn()
101          {
102              dynamic steve = new ExpandoObject();
103              steve.Id = 1;
104              steve.Name = "Steve";
105              steve.Age = 50;
106              dynamic phil = new ExpandoObject();
107              phil.Id = 2;
108              phil.Name = "Phil";
109              phil.Age = 42;
110              _db.NoIdentityColumnUsers.Insert(new[] { steve, phil });
111              GeneratedSqlIs("insert into [dbo].[NoIdentityColumnUsers] ([Id],[Name],[Password],[Age]) values (@p0,@p1,@p2,@p3)");
112              Parameter(0).Is(2);
<span onclick='openModal()' class='match'>113              Parameter(1).Is("Phil");
114              Parameter(2).Is(DBNull.Value);
115              Parameter(3).Is(42);
116          }
117          [Test]
118          public void TestThatInsertUsesDBNull()
119          {
120              dynamic person = new ExpandoObject();
</span>121              person.Name = null;
122              _db.Users.Insert(person);
123              Parameter(0).Is(DBNull.Value);
124          }
125      }
126  }
</code></pre>
        </div>
        <div class="column">
            <h3>Simple.Data-MDEwOlJlcG9zaXRvcnk4MTg3Njg=-flat-QueryTest.cs</h3>
            <pre><code>1  using System;
2  using System.Collections.Generic;
3  using System.Diagnostics;
4  using System.Linq;
5  using NUnit.Framework;
6  namespace Simple.Data.SqlTest
7  {
8      using System.Collections;
9      [TestFixture]
10      public class QueryTest
11      {
12          [TestFixtureSetUp]
13          public void Setup()
14          {
15              DatabaseHelper.Reset();
16          }
17          [Test]
18          public void CountWithNoCriteriaShouldSelectThree()
19          {
20              var db = DatabaseHelper.Open();
21              var count = db.Users.GetCount();
22              Assert.AreEqual(3, count);
23          }
24          [Test]
25          public void CountWithCriteriaShouldSelectTwo()
26          {
27              var db = DatabaseHelper.Open();
28              int count = db.Users.GetCount(db.Users.Age > 30);
29              Assert.AreEqual(2, count);
30          }
31          [Test]
32          public void CountByShouldSelectOne()
33          {
34              var db = DatabaseHelper.Open();
35              Assert.AreEqual(1, db.Users.GetCountByName("Bob"));
36          }
37         [Test]
38          public void ExistsWithNoCriteriaShouldReturnTrue()
39          {
40              var db = DatabaseHelper.Open();
41              Assert.AreEqual(true, db.Users.Exists());
42          }
43          [Test]
44          public void ExistsWithValidCriteriaShouldReturnTrue()
45          {
46              var db = DatabaseHelper.Open();
47              Assert.AreEqual(true, db.Users.Exists(db.Users.Age > 30));
48          }
49          [Test]
50          public void ExistsWithInvalidCriteriaShouldReturnFalse()
51          {
52              var db = DatabaseHelper.Open();
53              Assert.AreEqual(false, db.Users.Exists(db.Users.Age == -1));
54          }
55          [Test]
56          public void ExistsByValidValueShouldReturnTrue()
57          {
58              var db = DatabaseHelper.Open();
59              Assert.AreEqual(true, db.Users.ExistsByName("Bob"));
60          }
61          [Test]
62          public void ExistsByInvalidValueShouldReturnFalse()
63          {
64              var db = DatabaseHelper.Open();
65              Assert.AreEqual(false, db.Users.ExistsByName("Peter Kay"));
66          }
67          [Test]
68          public void ColumnAliasShouldChangeDynamicPropertyName()
69          {
70              var db = DatabaseHelper.Open();
71              var actual = db.Users.QueryById(1).Select(db.Users.Name.As("Alias")).First();
72              Assert.AreEqual("Bob", actual.Alias);
73          }
74          [Test]
75          public void MissingColumnShouldHaveColumnNotFoundMessage()
76          {
77              var db = DatabaseHelper.Open();
78              var actual = db.Users.QueryById(1).Select(db.Users.Name).First();
79              Assert.Throws<UnresolvableObjectException>(() => Console.WriteLine(actual.Bobbins), "Column not found.");
80          }
81          [Test]
82          public void ShouldSelectFromOneToTen()
83          {
84              var db = DatabaseHelper.Open();
85              var query = db.PagingTest.QueryById(1.to(100)).Take(10);
86              int index = 1;
87              foreach (var row in query)
88              {
89                  Assert.AreEqual(index, row.Id);
90                  index++;
91              }
92          }
93          [Test]
94          public void ShouldSelectFromElevenToTwenty()
95          {
96              var db = DatabaseHelper.Open();
97              var query = db.PagingTest.QueryById(1.to(100)).Skip(10).Take(10);
98              int index = 11;
99              foreach (var row in query)
100              {
101                  Assert.AreEqual(index, row.Id);
102                  index++;
103              }
104          }
105          [Test]
106          public void ShouldSelectFromOneHundredToNinetyOne()
107          {
108              var db = DatabaseHelper.Open();
109              var query = db.PagingTest.QueryById(1.to(100)).OrderByDescending(db.PagingTest.Id).Skip(0).Take(10);
110              int index = 100;
111              foreach (var row in query)
112              {
113                  Assert.AreEqual(index, row.Id);
114                  index--;
115              }
116          }
117          [Test]
118          public void WithTotalCountShouldGiveCount()
119          {
120              Promise<int> count;
121              var db = DatabaseHelper.Open();
122              var list = db.PagingTest.QueryById(1.to(50))
123                  .Take(10)
124                  .WithTotalCount(out count)
125                  .ToList();
126              Assert.AreEqual(10, list.Count);
127              Assert.IsTrue(count.HasValue);
128              Assert.AreEqual(50, count);
129          }
130          [Test]
131          public void WithTotalCountWithExplicitSelectShouldGiveCount()
132          {
133              Promise<int> count;
134              var db = DatabaseHelper.Open();
135              List<dynamic> list = db.PagingTest.QueryById(1.to(50))
136                  .Select(db.PagingTest.Id)
137                  .WithTotalCount(out count)
138                  .Take(10)
139                  .ToList();
140              Assert.IsTrue(count.HasValue);
141              Assert.AreEqual(50, count);
142              Assert.AreEqual(10, list.Count);
143              foreach (var dictionary in list.Cast<IDictionary<string,object>>())
144              {
145                  Assert.AreEqual(1, dictionary.Count);
146              }
147          }
148          [Test]
149          public void WithTotalCountWithExplicitSelectAndOrderByShouldGiveCount()
150          {
151              Promise<int> count;
152              var db = DatabaseHelper.Open();
153              List<dynamic> list = db.PagingTest.QueryById(1.to(50))
154                  .Select(db.PagingTest.Id)
155                  .OrderByDescending(db.PagingTest.Id)
156                  .WithTotalCount(out count)
157                  .Take(10)
158                  .ToList();
159              Assert.IsTrue(count.HasValue);
160              Assert.AreEqual(50, count);
161              Assert.AreEqual(10, list.Count);
162              foreach (var dictionary in list.Cast<IDictionary<string, object>>())
163              {
164                  Assert.AreEqual(1, dictionary.Count);
165              }
166          }
167          [Test]
168          public void WithTotalCountShouldGiveCount_ObsoleteFutureVersion()
169          {
170              Future<int> count;
171              var db = DatabaseHelper.Open();
172              var list = db.PagingTest.QueryById(1.to(50))
173                  .WithTotalCount(out count)
174                  .Take(10)
175                  .ToList();
176              Assert.AreEqual(10, list.Count);
177              Assert.IsTrue(count.HasValue);
178              Assert.AreEqual(50, count);
179          }
180          [Test]
181          public void ShouldDirectlyQueryDetailTable()
182          {
183              var db = DatabaseHelper.Open();
184              var order = db.Customers.QueryByNameAndAddress("Test", "100 Road").Orders.FirstOrDefault();
185              Assert.IsNotNull(order);
186              Assert.AreEqual(1, order.OrderId);
187          }
188          [Test]
189          public void ShouldReturnNullWhenNoRowFound()
190          {
191              var db = DatabaseHelper.Open();
192              string name = db.Customers
193                          .Query()
194                          .Select(db.Customers.Name)
195                          .Where(db.Customers.CustomerId == 0) 
196                          .OrderByName()
197                          .Take(1) 
198                          .ToScalarOrDefault<string>();
199              Assert.IsNull(name);
200          }
201          [Test]
202          public void ToScalarListShouldReturnStringList()
203          {
204              var db = DatabaseHelper.Open();
205              List<string> name = db.Customers
<span onclick='openModal()' class='match'>206                          .Query()
207                          .Select(db.Customers.Name)
208                          .OrderByName()
209                          .ToScalarList<string>();
210              Assert.IsNotNull(name);
211              Assert.AreNotEqual(0, name.Count);
212          }
213          [Test]
214          public void ToScalarArrayShouldReturnStringArray()
215          {
216              var db = DatabaseHelper.Open();
</span>217              string[] name = db.Customers
218                          .Query()
219                          .Select(db.Customers.Name)
220                          .OrderByName()
221                          .ToScalarArray<string>();
222              Assert.IsNotNull(name);
223              Assert.AreNotEqual(0, name.Length);
224          }
225          [Test]
226          public void HavingWithMinDateShouldReturnCorrectRow()
227          {
228              var db = DatabaseHelper.Open();
229              var row =
230                  db.GroupTestMaster.Query().Having(db.GroupTestMaster.GroupTestDetail.Date.Min() >=
231                                                    new DateTime(2000, 1, 1))
232                                                    .FirstOrDefault();
233              Assert.IsNotNull(row);
234              Assert.AreEqual("Two", row.Name);
235          }
236          [Test]
237          public void HavingWithMaxDateShouldReturnCorrectRow()
238          {
239              var db = DatabaseHelper.Open();
240              var row =
241                  db.GroupTestMaster.Query().Having(db.GroupTestMaster.GroupTestDetail.Date.Max() <
242                                                    new DateTime(2009, 1, 1))
243                                                    .FirstOrDefault();
244              Assert.IsNotNull(row);
245              Assert.AreEqual("One", row.Name);
246          }
247          [Test]
248          public void HavingWithCountShouldReturnCorrectRow()
249          {
250              var db = DatabaseHelper.Open();
251              var row = db.GroupTestMaster.Query()
252                  .Having(db.GroupTestMaster.GroupTestDetail.Id.Count() == 2)
253                  .FirstOrDefault();
254              Assert.IsNotNull(row);
255              Assert.AreEqual("Two", row.Name);
256          }
257          [Test]
258          public void HavingWithAverageShouldReturnCorrectRow()
259          {
260              var db = DatabaseHelper.Open();
261              var row = db.GroupTestMaster.Query()
262                  .Having(db.GroupTestMaster.GroupTestDetail.Number.Average() == 2)
263                  .FirstOrDefault();
264              Assert.IsNotNull(row);
265              Assert.AreEqual("One", row.Name);
266          }
267          [Test]
268          public void ToScalarOrDefault()
269          {
270              var db = DatabaseHelper.Open();
271              int max = db.Users.FindAllByName("ZXCVBNM").Select(db.Users.Age.Max()).ToScalarOrDefault<int>();
272              Assert.AreEqual(0, max);
273          }
274          [Test]
275          public void WithClauseShouldPreselectDetailTableAsCollection()
276          {
277              var db = DatabaseHelper.Open();
278              var result = db.Customers.FindAllByCustomerId(1).WithOrders().FirstOrDefault() as IDictionary<string, object>;
279              Assert.IsNotNull(result);
280              Assert.Contains("Orders", (ICollection)result.Keys);
281              var orders = result["Orders"] as IList<IDictionary<string, object>>;
282              Assert.IsNotNull(orders);
283              Assert.AreEqual(1, orders.Count);
284          }
285          [Test]
286          public void WithClauseShouldPreselectDetailTablesAsCollections()
287          {
288              var db = DatabaseHelper.Open();
289              var result = db.Customers.FindAllByCustomerId(1).WithOrders().WithNotes().FirstOrDefault() as IDictionary<string, object>;
290              Assert.IsNotNull(result);
291              Assert.Contains("Orders", (ICollection)result.Keys);
292              var orders = result["Orders"] as IList<IDictionary<string, object>>;
293              Assert.IsNotNull(orders);
294              Assert.AreEqual(1, orders.Count);
295              Assert.Contains("Notes", (ICollection)result.Keys);
296              var notes = result["Notes"] as IList<IDictionary<string, object>>;
297              Assert.IsNotNull(notes);
298              Assert.AreEqual(2, notes.Count);
299          }
300          [Test]
301          public void FindAllWithClauseWithJoinCriteriaShouldPreselectDetailTableAsCollection()
302          {
303              var db = DatabaseHelper.Open();
304              var result = db.Customers.FindAllByCustomerId(1).With(db.Customers.Orders.OrderItems).FirstOrDefault() as IDictionary<string, object>;
305              Assert.IsNotNull(result);
306              Assert.Contains("OrderItems", (ICollection)result.Keys);
307              var orderItems = result["OrderItems"] as IList<IDictionary<string, object>>;
308              Assert.IsNotNull(orderItems);
309              Assert.AreEqual(1, orderItems.Count);
310          }
311          [Test, Ignore]
312          public void FindAllWithClauseWithNestedDetailTable()
313          {
314              var db = DatabaseHelper.Open();
315              var result = db.Customers.FindAllByCustomerId(1).With(db.Customers.Orders).With(db.Customers.Orders.OrderItems).FirstOrDefault() as IDictionary<string, object>;
316              Assert.IsNotNull(result);
317              Assert.Contains("Orders", result.Keys.ToArray());
318              var orders = result["Orders"] as IList<IDictionary<string, object>>;
319              Assert.IsNotNull(orders);
320              Assert.AreEqual(1, orders.Count);
321              var order = orders[0];
322              Assert.Contains("OrderItems", order.Keys.ToArray());
323          }
324          [Test]
325          public void GetWithClauseWithJoinCriteriaShouldPreselectDetailTableAsCollection()
326          {
327              var db = DatabaseHelper.Open();
328              var result = db.Customers.With(db.Customers.Orders.OrderItems).Get(1) as IDictionary<string, object>;
329              Assert.IsNotNull(result);
330              Assert.Contains("OrderItems", (ICollection)result.Keys);
331              var orderItems = result["OrderItems"] as IList<IDictionary<string, object>>;
332              Assert.IsNotNull(orderItems);
333              Assert.AreEqual(1, orderItems.Count);
334          }
335          [Test]
336          public void WithClauseWithTwoStepShouldPreselectManyToManyTableAsCollection()
337          {
338              var db = DatabaseHelper.Open();
339              var result = db.Customers.FindAll(db.Customers.Order.OrderId == 1).WithOrders().FirstOrDefault() as IDictionary<string, object>;
340              Assert.IsNotNull(result);
341              Assert.Contains("Orders", (ICollection)result.Keys);
342              var orders = result["Orders"] as IList<IDictionary<string, object>>;
343              Assert.IsNotNull(orders);
344              Assert.AreEqual(1, orders.Count);
345          }
346          [Test]
347          public void WithClauseShouldPreselectMasterTableAsDictionary()
348          {
349              var db = DatabaseHelper.Open();
350              var result = db.Orders.FindAllByOrderId(1).WithCustomer().FirstOrDefault() as IDictionary<string,object>;
351              Assert.IsNotNull(result);
352              Assert.Contains("Customer", (ICollection)result.Keys);
353              var customer = result["Customer"] as IDictionary<string, object>;
354              Assert.IsNotNull(customer);
355          }
356          [Test]
357          public void WithClauseShouldCastToStaticTypeWithComplexProperty()
358          {
359              var db = DatabaseHelper.Open();
360              Order actual = db.Orders.FindAllByOrderId(1).WithCustomer().FirstOrDefault();
361              Assert.IsNotNull(actual);
362              Assert.IsNotNull(actual.Customer);
363              Assert.AreEqual("Test", actual.Customer.Name);
364              Assert.AreEqual("100 Road", actual.Customer.Address);
365          }
366          [Test]
367          public void WithClauseShouldCastToStaticTypeWithCollection()
368          {
369              var db = DatabaseHelper.Open();
370              Customer actual = db.Customers.FindAllByCustomerId(1).WithOrders().FirstOrDefault();
371              Assert.IsNotNull(actual);
372              Assert.AreEqual(1, actual.Orders.Single().OrderId);
373              Assert.AreEqual(new DateTime(2010,10,10), actual.Orders.Single().OrderDate);
374          }
375          [Test]
376          public void WithClauseShouldCastToStaticTypeWithEmptyCollection()
377          {
378              var db = DatabaseHelper.Open();
379              var newCustomer = db.Customers.Insert(Name: "No Orders");
380              Customer actual = db.Customers.FindAllByCustomerId(newCustomer.CustomerId).WithOrders().FirstOrDefault();
381              Assert.IsNotNull(actual);
382              Assert.IsNotNull(actual.Orders);
383              Assert.AreEqual(0, actual.Orders.Count);
384          }
385          [Test]
386          public void WithClauseContainingAliasShouldReturnResults()
387          {
388              var db = DatabaseHelper.Open();
389              var actual = db.Customers
390                             .With(db.Customers.Orders.As("Orders_1"))
391                             .With(db.Customers.Orders.As("Orders_2"))
392                             .FirstOrDefault();
393              Assert.IsNotNull(actual);
394              Assert.AreEqual(1, actual.Orders_1.Single().OrderId);
395              Assert.AreEqual(1, actual.Orders_2.Single().OrderId);
396              Assert.AreEqual(new DateTime(2010, 10, 10), actual.Orders_1.Single().OrderDate);
397              Assert.AreEqual(new DateTime(2010, 10, 10), actual.Orders_2.Single().OrderDate);
398          }
399          [Test]
400          public void SelfJoinShouldNotThrowException()
401          {
402              var db = DatabaseHelper.Open();
403              var q = db.Employees.Query().LeftJoin(db.Employees.As("Manager"), Id: db.Employees.ManagerId);
404              q = q.Select(db.Employees.Name, q.Manager.Name.As("Manager"));
405              List<dynamic> employees = q.ToList();
406              Assert.AreEqual(3, employees.Count); 
407              var kingsSubordinates = employees.Where(e => e.Manager == "Alice").ToList();
408              Assert.AreEqual(1, kingsSubordinates.Count);
409          }
410          [Test]
411          public void OrderByOnJoinedColumnShouldUseJoinedColumn()
412          {
413              SimpleDataTraceSources.TraceSource.Switch.Level = SourceLevels.All;
414              var traceListener = new TestTraceListener();
415              SimpleDataTraceSources.TraceSource.Listeners.Add(traceListener);
416              Trace.Listeners.Add(traceListener);
417              var db = DatabaseHelper.Open();
418              var q = db.Employees.Query().LeftJoin(db.Employees.As("Manager"), Id: db.Employees.ManagerId);
419              q = q.Select(db.Employees.Name, q.Manager.Name.As("Manager"));
420              List<dynamic> employees = q.OrderBy(q.Manager.Name).ToList();
421              SimpleDataTraceSources.TraceSource.Listeners.Remove(traceListener);
422              Assert.Greater(traceListener.Output.IndexOf("order by [manager].[name]", StringComparison.OrdinalIgnoreCase), 0);
423          }
424          [Test]
425          public void CanFetchMoreThanOneHundredRows()
426          {
427              var db = DatabaseHelper.Open();
428              db.Customers.Insert(Enumerable.Range(0, 200).Select(n => new Customer {Name = "Customer " + n}));
429              List<dynamic> customers = db.Customers.All().ToList();
430              Assert.GreaterOrEqual(customers.Count, 200);
431          }
432          [Test]
433          public void QueryWithForUpdateFalseShouldReturnCorrectResult()
434          {
435              var db = DatabaseHelper.Open();
436              var actual = db.Users.QueryById(1).Select(db.Users.Name).ForUpdate(false).First();
437              Assert.AreEqual("Bob", actual.Name);
438          }
439          [Test]
440          public void QueryWithForUpdateTrueShouldReturnCorrectResult()
441          {
442              var db = DatabaseHelper.Open();
443              var actual = db.Users.QueryById(1).Select(db.Users.Name).ForUpdate(true).First();
444              Assert.AreEqual("Bob", actual.Name);
445          }
446      }
447  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Simple.Data-MDEwOlJlcG9zaXRvcnk4MTg3Njg=-flat-BulkInsertTest_40.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Simple.Data-MDEwOlJlcG9zaXRvcnk4MTg3Njg=-flat-QueryTest.cs</div>
                </div>
                <div class="column column_space"><pre><code>113              Parameter(1).Is("Phil");
114              Parameter(2).Is(DBNull.Value);
115              Parameter(3).Is(42);
116          }
117          [Test]
118          public void TestThatInsertUsesDBNull()
119          {
120              dynamic person = new ExpandoObject();
</pre></code></div>
                <div class="column column_space"><pre><code>206                          .Query()
207                          .Select(db.Customers.Name)
208                          .OrderByName()
209                          .ToScalarList<string>();
210              Assert.IsNotNull(name);
211              Assert.AreNotEqual(0, name.Count);
212          }
213          [Test]
214          public void ToScalarArrayShouldReturnStringArray()
215          {
216              var db = DatabaseHelper.Open();
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    