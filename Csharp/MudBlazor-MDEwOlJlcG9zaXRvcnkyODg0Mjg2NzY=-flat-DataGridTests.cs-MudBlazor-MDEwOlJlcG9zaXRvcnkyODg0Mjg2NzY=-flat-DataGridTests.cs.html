
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 18, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-DataGridTests.cs</h3>
            <pre><code>1  #pragma warning disable CS1998 
2  #pragma warning disable BL0005 
3  using System;
4  using System.Collections.Generic;
5  using System.Linq;
6  using System.Linq.Expressions;
7  using System.Threading.Tasks;
8  using AngleSharp.Dom;
9  using Bunit;
10  using FluentAssertions;
11  using Microsoft.AspNetCore.Components;
12  using Microsoft.AspNetCore.Components.Web;
13  using Microsoft.JSInterop;
14  using MudBlazor.Interfaces;
15  using MudBlazor.UnitTests.TestComponents;
16  using NUnit.Framework;
17  using static MudBlazor.Docs.Examples.TableRelationalExample;
18  namespace MudBlazor.UnitTests.Components
19  {
20      public record TestModel1(string Name, int? Age);
21      public record TestModel2(string Name, int? Age, DateTime? Date);
22      public record TestModel3(string Name, int? Age, Severity? Status);
23      public record TestModel4(string Name, int? Age, bool? Hired);
24      [TestFixture]
25      public class DataGridTests : BunitTest
26      {
27          [Test]
28          public async Task DataGridSortableTest()
29          {
30              var comp = Context.RenderComponent<DataGridSortableTest>();
31              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSortableTest.Item>>();
32              var rows = dataGrid.FindAll("tr");
33              rows.Count.Should().Be(9, because: "1 header row + 7 data rows + 1 footer row");
34              var cells = dataGrid.FindAll("td");
35              cells.Count.Should().Be(21, because: "We have 7 data rows with three columns");
36              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
37              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
38              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
39              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
40              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
41              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
42              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
43              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => { return x.Name; }));
44              cells = dataGrid.FindAll("td");
45              cells[0].TextContent.Should().Be("A"); cells[1].TextContent.Should().Be("73"); cells[2].TextContent.Should().Be("7");
46              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("11"); cells[5].TextContent.Should().Be("4444");
47              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("99"); cells[8].TextContent.Should().Be("66");
48              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
49              cells[12].TextContent.Should().Be("C"); cells[13].TextContent.Should().Be("33"); cells[14].TextContent.Should().Be("33333");
50              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
51              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
52              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Descending, x => { return x.Name; }));
53              cells = dataGrid.FindAll("td");
54              cells[0].TextContent.Should().Be("C"); cells[1].TextContent.Should().Be("33"); cells[2].TextContent.Should().Be("33333");
55              cells[3].TextContent.Should().Be("C"); cells[4].TextContent.Should().Be("44"); cells[5].TextContent.Should().Be("1111111");
56              cells[6].TextContent.Should().Be("C"); cells[7].TextContent.Should().Be("55"); cells[8].TextContent.Should().Be("222222");
57              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
58              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("73"); cells[14].TextContent.Should().Be("7");
59              cells[15].TextContent.Should().Be("A"); cells[16].TextContent.Should().Be("11"); cells[17].TextContent.Should().Be("4444");
60              cells[18].TextContent.Should().Be("A"); cells[19].TextContent.Should().Be("99"); cells[20].TextContent.Should().Be("66");
61              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync("Name"));
62              cells = dataGrid.FindAll("td");
63              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
64              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
65              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
66              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
67              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
68              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
69              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
70              var column = dataGrid.FindComponent<Column<DataGridSortableTest.Item>>();
71              await comp.InvokeAsync(() => column.Instance.SortBy = x => { return x.Name; });
72              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
73              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
74              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
75              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
76              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
77              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
78              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
79              dataGrid.Find(".column-options button").Click();
80              cells = dataGrid.FindAll("td");
81              cells[0].TextContent.Should().Be("A"); cells[1].TextContent.Should().Be("73"); cells[2].TextContent.Should().Be("7");
82              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("11"); cells[5].TextContent.Should().Be("4444");
83              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("99"); cells[8].TextContent.Should().Be("66");
84              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
85              cells[12].TextContent.Should().Be("C"); cells[13].TextContent.Should().Be("33"); cells[14].TextContent.Should().Be("33333");
86              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
87              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
88              var headerCell = dataGrid.FindComponent<HeaderCell<DataGridSortableTest.Item>>();
89              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new Microsoft.AspNetCore.Components.Web.MouseEventArgs()));
90              await comp.InvokeAsync(() => headerCell.Instance.RemoveSortAsync());
91              await comp.InvokeAsync(() => headerCell.Instance.AddFilterAsync());
92              await comp.InvokeAsync(() => headerCell.Instance.OpenFilters());
93              await comp.InvokeAsync(() => dataGrid.Instance.SortMode = SortMode.None);
94              dataGrid.Render();
95              dataGrid.Instance.DropContainerHasChanged();
96              dataGrid.FindAll(".column-header .sortable-column-header").Should().BeEmpty();
97          }
98          [Test]
99          public async Task DataGridSortableTemplateColumnTest()
100          {
101              var comp = Context.RenderComponent<DataGridSortableTemplateColumnTest>();
102              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSortableTemplateColumnTest.Item>>();
103              var rows = dataGrid.FindAll("tr");
104              rows.Count.Should().Be(9, because: "1 header row + 7 data rows + 1 footer row");
105              var cells = dataGrid.FindAll("td");
106              cells.Count.Should().Be(7, because: "We have 7 data rows with one column");
107              cells[0].TextContent.Should().Be("B");
108              cells[1].TextContent.Should().Be("A");
109              cells[2].TextContent.Should().Be("A");
110              cells[3].TextContent.Should().Be("C");
111              cells[4].TextContent.Should().Be("A");
112              cells[5].TextContent.Should().Be("C");
113              cells[6].TextContent.Should().Be("C");
114              var templatePropertyName = dataGrid.Instance.RenderedColumns.FirstOrDefault().PropertyName;
115              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync(templatePropertyName, SortDirection.Ascending, x => { return x.Name; }));
116              cells = dataGrid.FindAll("td");
117              cells[0].TextContent.Should().Be("A");
118              cells[1].TextContent.Should().Be("A");
119              cells[2].TextContent.Should().Be("A");
120              cells[3].TextContent.Should().Be("B");
121              cells[4].TextContent.Should().Be("C");
122              cells[5].TextContent.Should().Be("C");
123              cells[6].TextContent.Should().Be("C");
124              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync(templatePropertyName, SortDirection.Descending, x => { return x.Name; }));
125              cells = dataGrid.FindAll("td");
126              cells[0].TextContent.Should().Be("C");
127              cells[1].TextContent.Should().Be("C");
128              cells[2].TextContent.Should().Be("C");
129              cells[3].TextContent.Should().Be("B");
130              cells[4].TextContent.Should().Be("A");
131              cells[5].TextContent.Should().Be("A");
132              cells[6].TextContent.Should().Be("A");
133              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync(templatePropertyName));
134              cells = dataGrid.FindAll("td");
135              cells[0].TextContent.Should().Be("B");
136              cells[1].TextContent.Should().Be("A");
137              cells[2].TextContent.Should().Be("A");
138              cells[3].TextContent.Should().Be("C");
139              cells[4].TextContent.Should().Be("A");
140              cells[5].TextContent.Should().Be("C");
141              cells[6].TextContent.Should().Be("C");
142              dataGrid.Find(".column-options button").Click();
143              cells = dataGrid.FindAll("td");
144              cells[0].TextContent.Should().Be("A");
145              cells[1].TextContent.Should().Be("A");
146              cells[2].TextContent.Should().Be("A");
147              cells[3].TextContent.Should().Be("B");
148              cells[4].TextContent.Should().Be("C");
149              cells[5].TextContent.Should().Be("C");
150              cells[6].TextContent.Should().Be("C");
151          }
152          [Test]
153          public async Task DataGridFilterableTest()
154          {
155              var comp = Context.RenderComponent<DataGridFilterableTest>();
156              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFilterableTest.Item>>();
157              dataGrid.FindAll("tr").Count.Should().Be(6); 
158              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("B");
159              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("A");
160              dataGrid.FindAll("td")[2].TextContent.Trim().Should().Be("C");
161              dataGrid.FindAll("td")[3].TextContent.Trim().Should().Be("C");
162              await comp.InvokeAsync(() =>
163              {
164                  return dataGrid.Instance.AddFilterAsync(new FilterDefinition<DataGridFilterableTest.Item>
165                  {
166                      Column = dataGrid.Instance.RenderedColumns.First(),
167                      Operator = FilterOperator.String.Equal,
168                      Value = "C"
169                  });
170              });
171              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("C");
172              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("C");
173              dataGrid.Instance.Filterable = false;
174          }
175          [Test]
176          public async Task DataGridFilterableServerDataTest()
177          {
178              var comp = Context.RenderComponent<DataGridFilterableServerDataTest>();
179              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFilterableServerDataTest.Item>>();
180              dataGrid.FindAll("tr").Count.Should().Be(6); 
181              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("B");
182              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("A");
183              dataGrid.FindAll("td")[2].TextContent.Trim().Should().Be("C");
184              dataGrid.FindAll("td")[3].TextContent.Trim().Should().Be("C");
185              await comp.InvokeAsync(() =>
186              {
187                  return dataGrid.Instance.AddFilterAsync(new FilterDefinition<DataGridFilterableServerDataTest.Item>
188                  {
189                      Column = dataGrid.Instance.RenderedColumns.FirstOrDefault(),
190                      Operator = FilterOperator.String.Equal,
191                      Value = "C"
192                  });
193              });
194              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("C");
195              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("C");
196              dataGrid.Instance.Filterable = false;
197          }
198          [Test]
199          public async Task DataGridMultiSelectionTest()
200          {
201              var comp = Context.RenderComponent<DataGridMultiSelectionTest>();
202              var dataGrid = comp.FindComponent<MudDataGrid<DataGridMultiSelectionTest.Item>>();
203              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
204              dataGrid.FindAll("input")[0].Change(true);
205              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
206              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectedItemAsync(false, dataGrid.Instance.SelectedItems.First()));
207              dataGrid.Instance.SelectedItems.Count.Should().Be(2);
208              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectedItemAsync(dataGrid.Instance.Items.First()));
209              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
210              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectAllAsync(false));
211              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
212              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectAllAsync(true));
213              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
214              dataGrid.Find("tfoot input").Change(false);
215              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
216          }
217          [Test]
218          public async Task DataGridServerMultiSelectionTest()
219          {
220              var comp = Context.RenderComponent<DataGridServerMultiSelectionTest>();
221              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerMultiSelectionTest.Item>>();
222              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
223              dataGrid.FindAll("input")[0].Change(true);
224              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
225              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectedItemAsync(false, dataGrid.Instance.SelectedItems.First()));
226              dataGrid.Instance.SelectedItems.Count.Should().Be(2);
227              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectedItemAsync(dataGrid.Instance.ServerItems.First()));
228              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
229              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectAllAsync(false));
230              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
231              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectAllAsync(true));
232              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
233              dataGrid.Find("tfoot input").Change(false);
234              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
235          }
236          [Test]
237          public async Task DataGridPaginationTest()
238          {
239              var comp = Context.RenderComponent<DataGridPaginationTest>();
240              var dataGrid = comp.FindComponent<MudDataGrid<DataGridPaginationTest.Item>>();
241              dataGrid.FindAll(".mud-table-pagination-caption")[^1].TextContent.Trim().Should().Be("1-10 of 20");
242              dataGrid.Find(".mud-table-body td").TextContent.Trim().Should().Be("0");
243              dataGrid.FindAll(".mud-table-pagination-actions button")[2].Click();
244              dataGrid.Find(".mud-table-body td").TextContent.Trim().Should().Be("10");
245              dataGrid.Instance.RowsPerPage.Should().Be(10);
246              await comp.InvokeAsync(async () => await dataGrid.Instance.SetRowsPerPageAsync(4));
247              dataGrid.Instance.RowsPerPage.Should().Be(4);
248              await comp.InvokeAsync(() => dataGrid.Instance.NavigateTo(Page.Last));
249              dataGrid.Instance.CurrentPage.Should().Be(4);
250              await comp.InvokeAsync(() => dataGrid.Instance.NavigateTo(Page.Previous));
251              dataGrid.Instance.CurrentPage.Should().Be(3);
252              await comp.InvokeAsync(() => dataGrid.Instance.NavigateTo(Page.First));
253              dataGrid.Instance.CurrentPage.Should().Be(0);
254          }
255          [Test]
256          public async Task DataGridInlineEditTest()
257          {
258              var comp = Context.RenderComponent<DataGridCellEditTest>();
259              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellEditTest.Model>>();
260              dataGrid.FindAll("td input")[0].GetAttribute("value").Trim().Should().Be("John");
261              dataGrid.FindAll("td input")[1].GetAttribute("value").Trim().Should().Be("45");
262              dataGrid.FindAll("td input")[2].GetAttribute("value").Trim().Should().Be("Johanna");
263              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("23");
264              dataGrid.FindAll("td input")[4].GetAttribute("value").Trim().Should().Be("Steve");
265              dataGrid.FindAll("td input")[5].GetAttribute("value").Trim().Should().Be("32");
266              dataGrid.FindAll(".mud-table-body tr td input")[0].Change("Jonathan");
267              dataGrid.FindAll(".mud-table-body tr td input")[1].Change(52d);
268              dataGrid.FindAll(".mud-table-body tr td input")[0].GetAttribute("value").Trim().Should().Be("Jonathan");
269              dataGrid.FindAll(".mud-table-body tr td input")[1].GetAttribute("value").Trim().Should().Be("52");
270              var name = dataGrid.Instance.Items.First().Name;
271              var age = dataGrid.Instance.Items.First().Age;
272              name.Should().Be("Jonathan");
273              age.Should().Be(52);
274          }
275          [Test]
276          public async Task DataGridInlineEditWithNullableTest()
277          {
278              var comp = Context.RenderComponent<DataGridCellEditWithNullableTest>();
279              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellEditWithNullableTest.Model>>();
280              dataGrid.FindAll("td input")[0].GetAttribute("value").Trim().Should().Be("John");
281              dataGrid.FindAll("td input")[1].GetAttribute("value").Trim().Should().Be("45");
282              dataGrid.FindAll("td input")[2].GetAttribute("value").Trim().Should().Be("Johanna");
283              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("23");
284              dataGrid.FindAll("td input")[4].GetAttribute("value").Trim().Should().Be("Steve");
285              Assert.IsNull(dataGrid.FindAll("td input")[5].GetAttribute("value"));
286              dataGrid.FindAll(".mud-table-body tr td input")[0].Change("Jonathan");
287              dataGrid.FindAll(".mud-table-body tr td input")[1].Change(52);
288              dataGrid.FindAll(".mud-table-body tr td input")[0].GetAttribute("value").Trim().Should().Be("Jonathan");
289              dataGrid.FindAll(".mud-table-body tr td input")[1].GetAttribute("value").Trim().Should().Be("52");
290              var name = dataGrid.Instance.Items.First().Name;
291              var age = dataGrid.Instance.Items.First().Age;
292              name.Should().Be("Jonathan");
293              age.Should().Be(52);
294          }
295          [Test]
296          public async Task DataGridInlineEditWithTemplateTest()
297          {
298              var comp = Context.RenderComponent<DataGridCellEditWithTemplateTest>();
299              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellEditWithTemplateTest.Model>>();
300              dataGrid.FindAll("td input")[0].GetAttribute("value").Trim().Should().Be("John");
301              dataGrid.FindAll("td input")[1].GetAttribute("value").Trim().Should().Be("45");
302              dataGrid.FindAll("td input")[2].HasAttribute("checked").Should().Be(false);
303              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("Johanna");
304              dataGrid.FindAll("td input")[4].GetAttribute("value").Trim().Should().Be("23");
305              dataGrid.FindAll("td input")[5].HasAttribute("checked").Should().Be(true);
306              dataGrid.FindAll("td input")[6].GetAttribute("value").Trim().Should().Be("Steve");
307              dataGrid.FindAll("td input")[7].GetAttribute("value").Trim().Should().Be("32");
308              dataGrid.FindAll("td input")[8].HasAttribute("value").Should().Be(false);
309              dataGrid.FindAll("td input")[0].Change("Jonathan");
310              dataGrid.FindAll("td input")[1].Change(52d);
311              dataGrid.FindAll("td input")[2].Change(true);
312              dataGrid.FindAll("td input")[0].GetAttribute("value").Trim().Should().Be("Jonathan");
313              dataGrid.FindAll("td input")[1].GetAttribute("value").Trim().Should().Be("52");
314              dataGrid.FindAll("td input")[2].HasAttribute("checked").Should().Be(true);
315              var name = dataGrid.Instance.Items.First().Name;
316              var age = dataGrid.Instance.Items.First().Age;
317              var hired = dataGrid.Instance.Items.First().Hired;
318              name.Should().Be("Jonathan");
319              age.Should().Be(52);
320              hired.Should().Be(true);
321          }
322          [Test]
323          public async Task DataGridDialogEditTest()
324          {
325              var comp = Context.RenderComponent<DataGridFormEditTest>();
326              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFormEditTest.Model>>();
327              dataGrid.FindAll("td")[0].Html().Trim().Should().Be("John");
328              dataGrid.FindAll("td")[1].Html().Trim().Should().Be("45");
329              dataGrid.FindAll("td")[2].Html().Trim().Should().Be("snakex64");
330              dataGrid.FindAll("td")[3].Html().Trim().Should().Be("Johanna");
331              dataGrid.FindAll("td")[4].Html().Trim().Should().Be("23");
332              dataGrid.FindAll("td")[5].Html().Trim().Should().Be("snakex64");
333              dataGrid.FindAll("td")[6].Html().Trim().Should().Be("Steve");
334              dataGrid.FindAll("td")[7].Html().Trim().Should().Be("32");
335              dataGrid.FindAll("td")[8].Html().Trim().Should().Be("snakex64");
336              dataGrid.FindAll("tbody tr")[1].Click();
337              comp.FindAll("div input")[0].Change("Galadriel");
338              comp.FindAll("div input")[1].Change(1);
339              comp.Find(".mud-dialog-actions .mud-button-filled-primary").Click();
340              dataGrid.FindAll("td")[0].Html().Trim().Should().Be("John");
341              dataGrid.FindAll("td")[1].Html().Trim().Should().Be("45");
342              dataGrid.FindAll("td")[2].Html().Trim().Should().Be("snakex64");
343              dataGrid.FindAll("td")[3].Html().Trim().Should().Be("Galadriel");
344              dataGrid.FindAll("td")[4].Html().Trim().Should().Be("1");
345              dataGrid.FindAll("td")[5].Html().Trim().Should().Be("snakex64");
346              dataGrid.FindAll("td")[6].Html().Trim().Should().Be("Steve");
347              dataGrid.FindAll("td")[7].Html().Trim().Should().Be("32");
348              dataGrid.FindAll("td")[8].Html().Trim().Should().Be("snakex64");
349          }
350          [Test]
351          public async Task DataGridFormFieldChangedTest()
352          {
353              var comp = Context.RenderComponent<DataGridFormFieldChangedTest>();
354              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFormFieldChangedTest.Item>>();
355              dataGrid.FindAll("tbody tr")[0].Click();
356              comp.Find("div input").Change("J K Simmons");
357              comp.Instance.FormFieldChangedEventArgs.NewValue.Should().Be("J K Simmons");
358              var textfield = comp.FindComponent<MudTextField<string>>();
359              Assert.AreSame(comp.Instance.FormFieldChangedEventArgs.Field, textfield.Instance);
360          }
361          [Test]
362          public async Task DataGridVisualStylingTest()
363          {
364              var comp = Context.RenderComponent<DataGridVisualStylingTest>();
365              var dataGrid = comp.FindComponent<MudDataGrid<DataGridVisualStylingTest.Item>>();
366              dataGrid.FindAll("td")[1].GetAttribute("style").Should().Contain("background-color:#E5BDE5");
367              dataGrid.FindAll("td")[2].GetAttribute("style").Should().Contain("font-weight:bold");
368          }
369          [Test]
370          [Obsolete]
371          public async Task DataGridEventCallbacksTest()
372          {
373              var comp = Context.RenderComponent<DataGridEventCallbacksTest>();
374              var dataGrid = comp.FindComponent<MudDataGrid<DataGridEventCallbacksTest.Item>>();
375              dataGrid.Instance.RowClick.HasDelegate.Should().Be(true);
376              dataGrid.Instance.SelectedItemChanged.HasDelegate.Should().Be(true);
377              dataGrid.Instance.CommittedItemChanges.HasDelegate.Should().Be(true);
378              dataGrid.Instance.StartedEditingItem.HasDelegate.Should().Be(true);
379              dataGrid.Instance.CancelledEditingItem.HasDelegate.Should().Be(true);
380              dataGrid.Instance.CancelledEditingItem.Should().Be(dataGrid.Instance.CancelledEditingItem);
381              var cancelCallback = dataGrid.Instance.CancelledEditingItem;
382              dataGrid.SetCallback(dg => dg.CancelledEditingItem, x => { return; });
383              dataGrid.Instance.CancelledEditingItem.Should().NotBe(cancelCallback);
384              dataGrid.Instance.CancelledEditingItem = cancelCallback;
385              dataGrid.Instance.CancelledEditingItem.Should().Be(cancelCallback);
386              var parameters = new List<ComponentParameter>();
387              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.MultiSelection), true));
388              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.ReadOnly), false));
389              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.EditMode), DataGridEditMode.Cell));
390              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.EditTrigger), DataGridEditTrigger.OnRowClick));
391              dataGrid.SetParametersAndRender(parameters.ToArray());
392              comp.Instance.RowClicked.Should().Be(false);
393              comp.Instance.SelectedItemChanged.Should().Be(false);
394              comp.Instance.CommittedItemChanges.Should().Be(false);
395              comp.Instance.StartedEditingItem.Should().Be(false);
396              comp.Instance.CanceledEditingItem.Should().Be(false);
397              dataGrid.FindAll(".mud-table-body tr")[0].Click();
398              dataGrid.FindAll(".mud-table-body tr td input")[0].Change("A test");
399              comp.Instance.RowClicked.Should().Be(true);
400              comp.Instance.SelectedItemChanged.Should().Be(true);
401              comp.Instance.CommittedItemChanges.Should().Be(true);
402              comp.Instance.CanceledEditingItem.Should().Be(false);
403              await dataGrid.InvokeAsync(dataGrid.Instance.CancelEditingItemAsync);
404              comp.Instance.CanceledEditingItem.Should().Be(true);
405          }
406          [Test]
407          public async Task DataGridServerSideSortableTest()
408          {
409              TestComponents.DataGridServerSideSortableTest.DisableServerTimeoutForTests = true;
410              var comp = Context.RenderComponent<DataGridServerSideSortableTest>();
411              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerSideSortableTest.Item>>();
412              var cells = dataGrid.FindAll("td");
413              cells.Count.Should().Be(21, because: "We have 7 data rows with three columns");
414              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
415              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
416              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
417              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
418              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
419              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
420              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
421              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => { return x.Name; }));
422              cells = dataGrid.FindAll("td");
423              cells[0].TextContent.Should().Be("A"); cells[1].TextContent.Should().Be("73"); cells[2].TextContent.Should().Be("7");
424              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("11"); cells[5].TextContent.Should().Be("4444");
425              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("99"); cells[8].TextContent.Should().Be("66");
426              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
427              cells[12].TextContent.Should().Be("C"); cells[13].TextContent.Should().Be("33"); cells[14].TextContent.Should().Be("33333");
428              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
429              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
430              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Descending, x => { return x.Name; }));
431              cells = dataGrid.FindAll("td");
432              cells[0].TextContent.Should().Be("C"); cells[1].TextContent.Should().Be("33"); cells[2].TextContent.Should().Be("33333");
433              cells[3].TextContent.Should().Be("C"); cells[4].TextContent.Should().Be("44"); cells[5].TextContent.Should().Be("1111111");
434              cells[6].TextContent.Should().Be("C"); cells[7].TextContent.Should().Be("55"); cells[8].TextContent.Should().Be("222222");
435              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
436              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("73"); cells[14].TextContent.Should().Be("7");
437              cells[15].TextContent.Should().Be("A"); cells[16].TextContent.Should().Be("11"); cells[17].TextContent.Should().Be("4444");
438              cells[18].TextContent.Should().Be("A"); cells[19].TextContent.Should().Be("99"); cells[20].TextContent.Should().Be("66");
439              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync("Name"));
440              cells = dataGrid.FindAll("td");
441              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
442              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
443              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
444              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
445              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
446              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
447              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
448              await comp.InvokeAsync(() => dataGrid.Instance.SortMode = SortMode.None);
449              dataGrid.Render();
450              dataGrid.Instance.DropContainerHasChanged();
451              dataGrid.FindAll(".column-header .sortable-column-header").Should().BeEmpty();
452          }
453          [Test]
454          public async Task FilterDefinitionStringTest()
455          {
456              var comp = Context.RenderComponent<DataGridFiltersTest>();
457              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
458              var nameColumn = dataGrid.Instance.GetColumnByPropertyName("Name");
459              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>();
460              Func<DataGridFiltersTest.Model, bool> func = null;
461              #region FilterOperator.String.Contains
462              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
463              {
464                  Column = nameColumn,
465                  Operator = FilterOperator.String.Contains,
466                  Value = "Joe",
467                  DataGrid = dataGrid.Instance
468              };
469              func = filterDefinition.GenerateFilterFunction();
470              Assert.IsFalse(func.Invoke(new("Does not contain", 45, null, null, null)));
471              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
472              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
473              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
474              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
475              {
476                  Column = nameColumn,
477                  Operator = FilterOperator.String.Contains,
478                  Value = "Joe",
479                  DataGrid = dataGrid.Instance
480              };
481              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
482              func = filterDefinition.GenerateFilterFunction();
483              Assert.IsFalse(func.Invoke(new("Does not contain", 45, null, null, null)));
484              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
485              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
486              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
487              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
488              {
489                  Column = nameColumn,
490                  Operator = FilterOperator.String.Contains,
491                  Value = null,
492                  DataGrid = dataGrid.Instance
493              };
494              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
495              func = filterDefinition.GenerateFilterFunction();
496              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
497              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
498              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
499              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
500              {
501                  Column = nameColumn,
502                  Operator = FilterOperator.String.Contains,
503                  Value = null,
504                  DataGrid = dataGrid.Instance
505              };
506              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
507              func = filterDefinition.GenerateFilterFunction();
508              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
509              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
510              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
511              #endregion
512              #region FilterOperator.String.NotContains
513              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
514              {
515                  Column = nameColumn,
516                  Operator = FilterOperator.String.NotContains,
517                  Value = "Joe",
518                  DataGrid = dataGrid.Instance
519              };
520              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
521              func = filterDefinition.GenerateFilterFunction();
522              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
523              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
524              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
525              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
526              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
527              {
528                  Column = nameColumn,
529                  Operator = FilterOperator.String.NotContains,
530                  Value = "Joe",
531                  DataGrid = dataGrid.Instance
532              };
533              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
534              func = filterDefinition.GenerateFilterFunction();
535              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
536              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
537              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
538              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
539              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
540              {
541                  Column = nameColumn,
542                  Operator = FilterOperator.String.NotContains,
543                  Value = null,
544                  DataGrid = dataGrid.Instance
545              };
546              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
547              func = filterDefinition.GenerateFilterFunction();
548              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
549              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
550              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
551              #endregion
552              #region FilterOperator.String.Equal
553              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
554              {
555                  Column = nameColumn,
556                  Operator = FilterOperator.String.Equal,
557                  Value = "Joe",
558                  DataGrid = dataGrid.Instance
559              };
560              func = filterDefinition.GenerateFilterFunction();
561              Assert.IsFalse(func.Invoke(new("Not Joe", 45, null, null, null)));
562              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
563              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
564              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
565              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
566              {
567                  Column = nameColumn,
568                  Operator = FilterOperator.String.Equal,
569                  Value = "Joe",
570                  DataGrid = dataGrid.Instance
571              };
572              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
573              func = filterDefinition.GenerateFilterFunction();
574              Assert.IsFalse(func.Invoke(new("Not Joe", 45, null, null, null)));
575              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
576              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
577              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
578              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
579              {
580                  Column = nameColumn,
581                  Operator = FilterOperator.String.Equal,
582                  Value = null,
583                  DataGrid = dataGrid.Instance
584              };
585              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
586              func = filterDefinition.GenerateFilterFunction();
587              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
588              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
589              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
590              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
591              {
592                  Column = nameColumn,
593                  Operator = FilterOperator.String.Equal,
594                  Value = null,
595                  DataGrid = dataGrid.Instance
596              };
597              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
598              func = filterDefinition.GenerateFilterFunction();
599              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
600              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
601              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
602              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
603              #endregion
604              #region FilterOperator.String.NotEqual
605              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
606              {
607                  Column = nameColumn,
608                  Operator = FilterOperator.String.NotEqual,
609                  Value = "Joe",
610                  DataGrid = dataGrid.Instance
611              };
612              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
613              func = filterDefinition.GenerateFilterFunction();
614              Assert.IsTrue(func.Invoke(new("Not Joe", 45, null, null, null)));
615              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
616              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
617              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
618              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
619              {
620                  Column = nameColumn,
621                  Operator = FilterOperator.String.NotEqual,
622                  Value = "Joe",
623                  DataGrid = dataGrid.Instance
624              };
625              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
626              func = filterDefinition.GenerateFilterFunction();
627              Assert.IsTrue(func.Invoke(new("Not Joe", 45, null, null, null)));
628              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
629              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
630              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
631              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
632              {
633                  Column = nameColumn,
634                  Operator = FilterOperator.String.NotEqual,
635                  Value = null,
636                  DataGrid = dataGrid.Instance
637              };
638              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
639              func = filterDefinition.GenerateFilterFunction();
640              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
641              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
642              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
643              #endregion
644              #region FilterOperator.String.StartsWith
645              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
646              {
647                  Column = nameColumn,
648                  Operator = FilterOperator.String.StartsWith,
649                  Value = "Joe",
650                  DataGrid = dataGrid.Instance
651              };
652              func = filterDefinition.GenerateFilterFunction();
653              Assert.IsFalse(func.Invoke(new("Not Joe", 45, null, null, null)));
654              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
655              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
656              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
657              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
658              {
659                  Column = nameColumn,
660                  Operator = FilterOperator.String.StartsWith,
661                  Value = "Joe",
662                  DataGrid = dataGrid.Instance
663              };
664              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
665              func = filterDefinition.GenerateFilterFunction();
666              Assert.IsFalse(func.Invoke(new("Not Joe", 45, null, null, null)));
667              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
668              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
669              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
670              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
671              {
672                  Column = nameColumn,
673                  Operator = FilterOperator.String.StartsWith,
674                  Value = null,
675                  DataGrid = dataGrid.Instance
676              };
677              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
678              func = filterDefinition.GenerateFilterFunction();
679              Assert.IsTrue(func.Invoke(new("Not Joe", 45, null, null, null)));
680              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
681              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
682              #endregion
683              #region FilterOperator.String.EndsWith
684              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
685              {
686                  Column = nameColumn,
687                  Operator = FilterOperator.String.EndsWith,
688                  Value = "Joe",
689                  DataGrid = dataGrid.Instance
690              };
691              func = filterDefinition.GenerateFilterFunction();
692              Assert.IsFalse(func.Invoke(new("Joe Not", 45, null, null, null)));
693              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
694              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
695              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
696              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
697              {
698                  Column = nameColumn,
699                  Operator = FilterOperator.String.EndsWith,
700                  Value = "Joe",
701                  DataGrid = dataGrid.Instance
702              };
703              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
704              func = filterDefinition.GenerateFilterFunction();
705              Assert.IsFalse(func.Invoke(new("Joe Not", 45, null, null, null)));
706              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
707              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
708              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
709              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
710              {
711                  Column = nameColumn,
712                  Operator = FilterOperator.String.EndsWith,
713                  Value = null,
714                  DataGrid = dataGrid.Instance
715              };
716              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
717              func = filterDefinition.GenerateFilterFunction();
718              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
719              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
720              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
721              #endregion
722              #region FilterOperator.String.Empty
723              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
724              {
725                  Column = nameColumn,
726                  Operator = FilterOperator.String.Empty,
727                  Value = null,
728                  DataGrid = dataGrid.Instance
729              };
730              func = filterDefinition.GenerateFilterFunction();
731              Assert.IsFalse(func.Invoke(new("Joe Not", 45, null, null, null)));
732              Assert.IsTrue(func.Invoke(new("", 45, null, null, null)));
733              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
734              Assert.IsTrue(func.Invoke(new(String.Empty, 45, null, null, null)));
735              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
736              {
737                  Column = nameColumn,
738                  Operator = FilterOperator.String.NotEmpty,
739                  Value = null,
740                  DataGrid = dataGrid.Instance
741              };
742              func = filterDefinition.GenerateFilterFunction();
743              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
744              Assert.IsFalse(func.Invoke(new("", 45, null, null, null)));
745              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
746              Assert.IsFalse(func.Invoke(new(String.Empty, 45, null, null, null)));
747              #endregion
748              #region FilterOperator.String.NotEmpty
749              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
750              {
751                  Column = nameColumn,
752                  Operator = FilterOperator.String.NotEmpty,
753                  Value = null,
754                  DataGrid = dataGrid.Instance
755              };
756              func = filterDefinition.GenerateFilterFunction();
757              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
758              Assert.IsFalse(func.Invoke(new("", 45, null, null, null)));
759              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
760              Assert.IsFalse(func.Invoke(new(String.Empty, 45, null, null, null)));
761              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
762              {
763                  Column = nameColumn,
764                  Operator = FilterOperator.String.NotEmpty,
765                  Value = null,
766                  DataGrid = dataGrid.Instance
767              };
768              func = filterDefinition.GenerateFilterFunction();
769              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
770              Assert.IsFalse(func.Invoke(new("", 45, null, null, null)));
771              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
772              Assert.IsFalse(func.Invoke(new(String.Empty, 45, null, null, null)));
773              #endregion
774              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
775              {
776                  Column = nameColumn,
777                  Operator = null,
778                  Value = "Joe",
779                  DataGrid = dataGrid.Instance
780              };
781              func = filterDefinition.GenerateFilterFunction();
782              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
783              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
784              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
785          }
786          [Test]
787          public async Task FilterDefinitionBoolTest()
788          {
789              var comp = Context.RenderComponent<DataGridFiltersTest>();
790              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
791              var hiredColumn = dataGrid.Instance.GetColumnByPropertyName("Hired");
792              #region FilterOperator.Boolean.Is
793              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
794              {
795                  Column = hiredColumn,
796                  Operator = FilterOperator.Boolean.Is,
797                  Value = true
798              };
799              var func = filterDefinition.GenerateFilterFunction();
800              Assert.IsFalse(func.Invoke(new("Sam", 45, null, false, null)));
801              Assert.IsTrue(func.Invoke(new("Joe", 45, null, true, null)));
802              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
803              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
804              {
805                  Column = hiredColumn,
806                  Operator = FilterOperator.Boolean.Is,
807                  Value = null
808              };
809              func = filterDefinition.GenerateFilterFunction();
810              Assert.IsTrue(func.Invoke(new("Sam", 45, null, false, null)));
811              Assert.IsTrue(func.Invoke(new("Joe", 45, null, true, null)));
812              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
813              #endregion
814              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
815              {
816                  Column = hiredColumn,
817                  Operator = null,
818                  Value = true
819              };
820              func = filterDefinition.GenerateFilterFunction();
821              Assert.IsTrue(func.Invoke(new("Sam", 45, null, false, null)));
822              Assert.IsTrue(func.Invoke(new("Joe", 45, null, true, null)));
823              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
824          }
825          [Test]
826          public async Task FilterDefinitionEnumTest()
827          {
828              var comp = Context.RenderComponent<DataGridFiltersTest>();
829              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
830              var statusColumn = dataGrid.Instance.GetColumnByPropertyName("Status");
831              #region FilterOperator.Enum.Is
832              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
833              {
834                  Column = statusColumn,
835                  Operator = FilterOperator.Enum.Is,
836                  Value = Severity.Normal
837              };
838              var func = filterDefinition.GenerateFilterFunction();
839              Assert.IsFalse(func.Invoke(new("Sam", 456, Severity.Info, null, null)));
840              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Normal, null, null)));
841              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
842              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
843              {
844                  Column = statusColumn,
845                  Operator = FilterOperator.Enum.Is,
846                  Value = null
847              };
848              func = filterDefinition.GenerateFilterFunction();
849              Assert.IsTrue(func.Invoke(new("Sam", 456, Severity.Info, null, null)));
850              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Normal, null, null)));
851              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
852              #endregion
853              #region FilterOperator.Enum.IsNot
854              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
855              {
856                  Column = statusColumn,
857                  Operator = FilterOperator.Enum.IsNot,
858                  Value = Severity.Normal
859              };
860              func = filterDefinition.GenerateFilterFunction();
861              Assert.IsFalse(func.Invoke(new("Sam", 456, Severity.Normal, null, null)));
862              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Info, null, null)));
863              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
864              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
865              {
866                  Column = statusColumn,
867                  Operator = FilterOperator.Enum.IsNot,
868                  Value = null
869              };
870              func = filterDefinition.GenerateFilterFunction();
871              Assert.IsTrue(func.Invoke(new("Sam", 456, Severity.Normal, null, null)));
872              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Info, null, null)));
873              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
874              #endregion
875              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
876              {
877                  Column = statusColumn,
878                  Operator = null,
879                  Value = Severity.Normal
880              };
881              func = filterDefinition.GenerateFilterFunction();
882              Assert.IsTrue(func.Invoke(new("Sam", 456, Severity.Normal, null, null)));
883              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Info, null, null)));
884              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
885          }
886          [Test]
887          public async Task FilterDefinitionDateTimeTest()
888          {
889              var comp = Context.RenderComponent<DataGridFiltersTest>();
890              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
891              var dateColumn = dataGrid.Instance.GetColumnByPropertyName("HiredOn");
892              var utcnow = DateTime.UtcNow;
893              #region FilterOperator.DateTime.Is
894              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
895              {
896                  Column = dateColumn,
897                  Operator = FilterOperator.DateTime.Is,
898                  Value = utcnow
899              };
900              var func = filterDefinition.GenerateFilterFunction();
901              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
902              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
903              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
904              {
905                  Column = dateColumn,
906                  Operator = FilterOperator.DateTime.Is,
907                  Value = null
908              };
909              func = filterDefinition.GenerateFilterFunction();
910              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
911              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
912              #endregion
913              #region FilterOperator.DateTime.IsNot
914              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
915              {
916                  Column = dateColumn,
917                  Operator = FilterOperator.DateTime.IsNot,
918                  Value = utcnow
919              };
920              func = filterDefinition.GenerateFilterFunction();
921              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
922              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
923              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
924              {
925                  Column = dateColumn,
926                  Operator = FilterOperator.DateTime.IsNot,
927                  Value = null
928              };
929              func = filterDefinition.GenerateFilterFunction();
930              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
931              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
932              #endregion
933              #region FilterOperator.DateTime.After
934              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
935              {
936                  Column = dateColumn,
937                  Operator = FilterOperator.DateTime.After,
938                  Value = utcnow
939              };
940              func = filterDefinition.GenerateFilterFunction();
941              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
942              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
943              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
944              {
945                  Column = dateColumn,
946                  Operator = FilterOperator.DateTime.After,
947                  Value = null
948              };
949              func = filterDefinition.GenerateFilterFunction();
950              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
951              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
952              #endregion
953              #region FilterOperator.DateTime.OnOrAfter
954              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
955              {
956                  Column = dateColumn,
957                  Operator = FilterOperator.DateTime.OnOrAfter,
958                  Value = utcnow
959              };
960              func = filterDefinition.GenerateFilterFunction();
961              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
962              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
963              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
964              {
965                  Column = dateColumn,
966                  Operator = FilterOperator.DateTime.OnOrAfter,
967                  Value = null
968              };
969              func = filterDefinition.GenerateFilterFunction();
970              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
971              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
972              #endregion
973              #region FilterOperator.DateTime.Before
974              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
975              {
976                  Column = dateColumn,
977                  Operator = FilterOperator.DateTime.Before,
978                  Value = utcnow
979              };
980              func = filterDefinition.GenerateFilterFunction();
981              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
982              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
983              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
984              {
985                  Column = dateColumn,
986                  Operator = FilterOperator.DateTime.Before,
987                  Value = null
988              };
989              func = filterDefinition.GenerateFilterFunction();
990              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
991              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
992              #endregion
993              #region FilterOperator.DateTime.OnOrBefore
994              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
995              {
996                  Column = dateColumn,
997                  Operator = FilterOperator.DateTime.OnOrBefore,
998                  Value = utcnow
999              };
1000              func = filterDefinition.GenerateFilterFunction();
1001              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1002              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
1003              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1004              {
1005                  Column = dateColumn,
1006                  Operator = FilterOperator.DateTime.OnOrBefore,
1007                  Value = null
1008              };
1009              func = filterDefinition.GenerateFilterFunction();
1010              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1011              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1012              #endregion
1013              #region FilterOperator.DateTime.Empty
1014              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1015              {
1016                  Column = dateColumn,
1017                  Operator = FilterOperator.DateTime.Empty,
1018                  Value = utcnow
1019              };
1020              func = filterDefinition.GenerateFilterFunction();
1021              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
1022              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1023              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1024              {
1025                  Column = dateColumn,
1026                  Operator = FilterOperator.DateTime.Empty,
1027                  Value = null
1028              };
1029              func = filterDefinition.GenerateFilterFunction();
1030              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
1031              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1032              #endregion
1033              #region FilterOperator.DateTime.NotEmpty
1034              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1035              {
1036                  Column = dateColumn,
1037                  Operator = FilterOperator.DateTime.NotEmpty,
1038                  Value = utcnow
1039              };
1040              func = filterDefinition.GenerateFilterFunction();
1041              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1042              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
1043              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1044              {
1045                  Column = dateColumn,
1046                  Operator = FilterOperator.DateTime.NotEmpty,
1047                  Value = null
1048              };
1049              func = filterDefinition.GenerateFilterFunction();
1050              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1051              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
1052              #endregion
1053              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1054              {
1055                  Column = dateColumn,
1056                  Operator = null,
1057                  Value = utcnow
1058              };
1059              func = filterDefinition.GenerateFilterFunction();
1060              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1061              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1062          }
1063          [Test]
1064          public async Task FilterDefinitionNumberTest()
1065          {
1066              var comp = Context.RenderComponent<DataGridFiltersTest>();
1067              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
1068              var ageColumn = dataGrid.Instance.GetColumnByPropertyName("Age");
1069              #region FilterOperator.Number.Equal
1070              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1071              {
1072                  Column = ageColumn,
1073                  Operator = FilterOperator.Number.Equal,
1074                  Value = 45
1075              };
1076              var func = filterDefinition.GenerateFilterFunction();
1077              Assert.IsFalse(func.Invoke(new("Sam", 456, null, null, null)));
1078              Assert.IsFalse(func.Invoke(new("Sam", null, null, null, null)));
1079              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1080              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1081              {
1082                  Column = ageColumn,
1083                  Operator = FilterOperator.Number.Equal,
1084                  Value = null
1085              };
1086              var func2 = filterDefinition.GenerateFilterFunction();
1087              Assert.IsTrue(func2.Invoke(new("Sam", 456, null, null, null)));
1088              Assert.IsTrue(func2.Invoke(new("Sam", null, null, null, null)));
1089              Assert.IsTrue(func2.Invoke(new("Joe", 45, null, null, null)));
1090              #endregion
1091              #region FilterOperator.Number.NotEqual
1092              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1093              {
1094                  Column = ageColumn,
1095                  Operator = FilterOperator.Number.NotEqual,
1096                  Value = 45
1097              };
1098              var func3 = filterDefinition.GenerateFilterFunction();
1099              Assert.IsTrue(func3.Invoke(new("Sam", 456, null, null, null)));
1100              Assert.IsTrue(func3.Invoke(new("Sam", null, null, null, null)));
1101              Assert.IsFalse(func3.Invoke(new("Joe", 45, null, null, null)));
1102              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1103              {
1104                  Column = ageColumn,
1105                  Operator = FilterOperator.Number.NotEqual,
1106                  Value = null
1107              };
1108              var func4 = filterDefinition.GenerateFilterFunction();
1109              Assert.IsTrue(func4.Invoke(new("Sam", 456, null, null, null)));
1110              Assert.IsTrue(func4.Invoke(new("Sam", null, null, null, null)));
1111              Assert.IsTrue(func4.Invoke(new("Joe", 45, null, null, null)));
1112              #endregion
1113              #region FilterOperator.Number.GreaterThan
1114              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1115              {
1116                  Column = ageColumn,
1117                  Operator = FilterOperator.Number.GreaterThan,
1118                  Value = 45
1119              };
1120              var func5 = filterDefinition.GenerateFilterFunction();
1121              Assert.IsTrue(func5.Invoke(new("Sam", 456, null, null, null)));
1122              Assert.IsFalse(func5.Invoke(new("Joe", 45, null, null, null)));
1123              Assert.IsFalse(func5.Invoke(new("Joe", null, null, null, null)));
1124              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1125              {
1126                  Column = ageColumn,
1127                  Operator = FilterOperator.Number.GreaterThan,
1128                  Value = null
1129              };
1130              var func6 = filterDefinition.GenerateFilterFunction();
1131              Assert.IsTrue(func6.Invoke(new("Sam", 456, null, null, null)));
1132              Assert.IsTrue(func6.Invoke(new("Joe", 45, null, null, null)));
1133              Assert.IsTrue(func6.Invoke(new("Joe", null, null, null, null)));
1134              #endregion
1135              #region FilterOperator.Number.LessThan
1136              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1137              {
1138                  Column = ageColumn,
1139                  Operator = FilterOperator.Number.LessThan,
1140                  Value = 45
1141              };
1142              var func7 = filterDefinition.GenerateFilterFunction();
1143              Assert.IsTrue(func7.Invoke(new("Sam", 4, null, null, null)));
1144              Assert.IsFalse(func7.Invoke(new("Joe", 45, null, null, null)));
1145              Assert.IsFalse(func7.Invoke(new("Joe", null, null, null, null)));
1146              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1147              {
1148                  Column = ageColumn,
1149                  Operator = FilterOperator.Number.LessThan,
1150                  Value = null
1151              };
1152              var func8 = filterDefinition.GenerateFilterFunction();
1153              Assert.IsTrue(func8.Invoke(new("Sam", 4, null, null, null)));
1154              Assert.IsTrue(func8.Invoke(new("Joe", 45, null, null, null)));
1155              Assert.IsTrue(func8.Invoke(new("Joe", null, null, null, null)));
1156              #endregion
1157              #region FilterOperator.Number.GreaterThanOrEqual
1158              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1159              {
1160                  Column = ageColumn,
1161                  Operator = FilterOperator.Number.GreaterThanOrEqual,
1162                  Value = 45
1163              };
1164              var func9 = filterDefinition.GenerateFilterFunction();
1165              Assert.IsFalse(func9.Invoke(new("Sam", 4, null, null, null)));
1166              Assert.IsFalse(func9.Invoke(new("Sam", null, null, null, null)));
1167              Assert.IsTrue(func9.Invoke(new("Joe", 45, null, null, null)));
1168              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1169              {
1170                  Column = ageColumn,
1171                  Operator = FilterOperator.Number.GreaterThanOrEqual,
1172                  Value = null
1173              };
1174              var func10 = filterDefinition.GenerateFilterFunction();
1175              Assert.IsTrue(func10.Invoke(new("Sam", 4, null, null, null)));
1176              Assert.IsTrue(func10.Invoke(new("Sam", null, null, null, null)));
1177              Assert.IsTrue(func10.Invoke(new("Joe", 45, null, null, null)));
1178              #endregion
1179              #region FilterOperator.Number.LessThanOrEqual
1180              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1181              {
1182                  Column = ageColumn,
1183                  Operator = FilterOperator.Number.LessThanOrEqual,
1184                  Value = 45
1185              };
1186              var func11 = filterDefinition.GenerateFilterFunction();
1187              Assert.IsFalse(func11.Invoke(new("Sam", 46, null, null, null)));
1188              Assert.IsFalse(func11.Invoke(new("Sam", null, null, null, null)));
1189              Assert.IsTrue(func11.Invoke(new("Joe", 45, null, null, null)));
1190              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1191              {
1192                  Column = ageColumn,
1193                  Operator = FilterOperator.Number.LessThanOrEqual,
1194                  Value = null
1195              };
1196              var func12 = filterDefinition.GenerateFilterFunction();
1197              Assert.IsTrue(func12.Invoke(new("Sam", 46, null, null, null)));
1198              Assert.IsTrue(func12.Invoke(new("Sam", null, null, null, null)));
1199              Assert.IsTrue(func12.Invoke(new("Joe", 45, null, null, null)));
1200              #endregion
1201              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1202              {
1203                  Column = ageColumn,
1204                  Operator = null,
1205                  Value = 45
1206              };
1207              var func13 = filterDefinition.GenerateFilterFunction();
1208              Assert.IsTrue(func13.Invoke(new("Sam", 456, null, null, null)));
1209              Assert.IsTrue(func13.Invoke(new("Sam", null, null, null, null)));
1210              Assert.IsTrue(func13.Invoke(new("Joe", 45, null, null, null)));
1211          }
1212          [Test]
1213          public async Task FilterDefinitionReplaceWithCustom()
1214          {
1215              var comp = Context.RenderComponent<DataGridFiltersTest>();
1216              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
1217              dataGrid.Instance.SetDefaultFilterDefinition<CustomFilterDefinitionMock<DataGridFiltersTest.Model>>();
1218              await comp.InvokeAsync(() => dataGrid.Instance.OpenFilters());
1219              await comp.InvokeAsync(() => dataGrid.Instance.AddFilter());
1220              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(1);
1221              var filterDefinitionInstance = dataGrid.Instance.FilterDefinitions.FirstOrDefault();
1222              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1223              filterDefinitionInstance.Should().NotBeNull();
1224              filterDefinitionInstance.Should().BeOfType<CustomFilterDefinitionMock<DataGridFiltersTest.Model>>();
1225          }
1226          [Test]
1227          public async Task DataGridFiltersTest()
1228          {
1229              var comp = Context.RenderComponent<DataGridFiltersTest>();
1230              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
1231              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1232              {
1233                  Column = dataGrid.Instance.GetColumnByPropertyName("Name"),
1234                  Operator = "contains",
1235                  Value = "John"
1236              };
1237              var filterDefinition2 = new FilterDefinition<DataGridFiltersTest.Model>
1238              {
1239                  Column = dataGrid.Instance.GetColumnByPropertyName("Age"),
1240                  Operator = ">",
1241                  Value = 30
1242              };
1243              var filterDefinition3 = new FilterDefinition<DataGridFiltersTest.Model>
1244              {
1245                  Column = dataGrid.Instance.GetColumnByPropertyName("Status"),
1246                  Operator = "is",
1247                  Value = Severity.Normal
1248              };
1249              var filterDefinition4 = new FilterDefinition<DataGridFiltersTest.Model>
1250              {
1251                  Column = dataGrid.Instance.GetColumnByPropertyName("Hired"),
1252                  Operator = "is",
1253                  Value = true
1254              };
1255              var filterDefinition5 = new FilterDefinition<DataGridFiltersTest.Model>
1256              {
1257                  Column = dataGrid.Instance.GetColumnByPropertyName("HiredOn"),
1258                  Operator = "is",
1259                  Value = DateTime.UtcNow.Date
1260              };
1261              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition));
1262              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition2));
1263              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition3));
1264              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition4));
1265              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition5));
1266              await comp.InvokeAsync(() => dataGrid.Instance.OpenFilters());
1267              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(5);
1268              dataGrid.FindAll(".filters-panel > button")[0].Click();
1269              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(6);
1270              await comp.InvokeAsync(() => dataGrid.Instance.AddFilter());
1271              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(7);
1272              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(new FilterDefinition<DataGridFiltersTest.Model>
1273              {
1274                  Column = dataGrid.Instance.RenderedColumns.FirstOrDefault(x => x.PropertyName == "Status")
1275              }));
1276              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(8);
1277              await comp.InvokeAsync(() => dataGrid.Instance.ToggleFiltersMenu());
1278              dataGrid.FindAll(".filters-panel").Count.Should().Be(0);
1279              var internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition, null);
1280              filterDefinition.Column.dataType.Should().Be(typeof(string));
1281              await comp.InvokeAsync(() => internalFilter.StringValueChanged("J"));
1282              filterDefinition.Value.Should().Be("J");
1283              internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition2, null);
1284              filterDefinition2.Column.dataType.Should().Be(typeof(int?));
1285              await comp.InvokeAsync(() => internalFilter.NumberValueChanged(35));
1286              filterDefinition2.Value.Should().Be(35);
1287              internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition3, null);
1288              filterDefinition3.Column.dataType.Should().Be(typeof(Severity?));
1289              await comp.InvokeAsync(() => internalFilter.NumberValueChanged(35));
1290              filterDefinition3.Value.Should().Be(35);
1291              filterDefinition3.FieldType.IsEnum.Should().Be(true);
1292              internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition4, null);
1293              filterDefinition4.Column.dataType.Should().Be(typeof(bool?));
1294              await comp.InvokeAsync(() => internalFilter.BoolValueChanged(false));
1295              filterDefinition4.Value.Should().Be(false);
1296              var date = DateTime.UtcNow;
1297              internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition5, null);
1298              filterDefinition5.Column.dataType.Should().Be(typeof(DateTime?));
1299              await comp.InvokeAsync(() => internalFilter.DateValueChanged(date));
1300              filterDefinition5.Value.Should().Be(date.Date);
1301              await comp.InvokeAsync(() => internalFilter.TimeValueChanged(date.TimeOfDay));
1302              filterDefinition5.Value.Should().Be(date);
1303          }
1304          [Test]
1305          public async Task DataGridIDictionaryFiltersTest()
1306          {
1307              var comp = Context.RenderComponent<DataGridIDictionaryFiltersTest>();
1308              var dataGrid = comp.FindComponent<MudDataGrid<IDictionary<string, object>>>();
1309              var filterDefinition = new FilterDefinition<IDictionary<string, object>>
1310              {
1311                  Id = Guid.NewGuid(),
1312                  Operator = "contains",
1313                  Value = "John"
1314              };
1315              var filterDefinition2 = new FilterDefinition<IDictionary<string, object>>
1316              {
1317                  Id = Guid.NewGuid(),
1318                  Operator = ">",
1319                  Value = 30
1320              };
1321              var filterDefinition3 = new FilterDefinition<IDictionary<string, object>>
1322              {
1323                  Id = Guid.NewGuid(),
1324                  Operator = "is",
1325                  Value = Severity.Normal
1326              };
1327              await comp.InvokeAsync(() => dataGrid.Instance.FilterDefinitions.Add(filterDefinition));
1328              await comp.InvokeAsync(() => dataGrid.Instance.FilterDefinitions.Add(filterDefinition2));
1329              await comp.InvokeAsync(() => dataGrid.Instance.FilterDefinitions.Add(filterDefinition3));
1330              await comp.InvokeAsync(() => dataGrid.Instance.OpenFilters());
1331              var filters = dataGrid.Instance.FilterDefinitions;
1332              Assert.AreEqual(filterDefinition.Id, filters[0].Id);
1333              Assert.AreEqual(filterDefinition.Operator, filters[0].Operator);
1334              Assert.AreEqual(filterDefinition.Value, filters[0].Value);
1335              filters[0].Value = "Not Joe";
1336              Assert.AreEqual(filterDefinition.Value, "Not Joe");
1337              Assert.AreEqual(filterDefinition2.Id, filters[1].Id);
1338              Assert.AreEqual(filterDefinition2.Operator, filters[1].Operator);
1339              Assert.AreEqual(filterDefinition2.Value, filters[1].Value);
1340              filters[1].Value = 45;
1341              Assert.AreEqual(filterDefinition2.Value, 45);
1342              Assert.AreEqual(filterDefinition3.Id, filters[2].Id);
1343              Assert.AreEqual(filterDefinition3.Operator, filters[2].Operator);
1344              Assert.AreEqual(filterDefinition3.Value, filters[2].Value);
1345              filters[2].Value = Severity.Error;
1346              Assert.AreEqual(filterDefinition3.Value, Severity.Error);
1347          }
1348          [Test]
1349          public async Task DataGridColGroupTest()
1350          {
1351              var comp = Context.RenderComponent<DataGridColGroupTest>();
1352              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColGroupTest.Model>>();
1353              dataGrid.FindAll("col").Count.Should().Be(3);
1354          }
1355          [Test]
1356          public async Task DataGridHeaderTemplateTest()
1357          {
1358              var comp = Context.RenderComponent<DataGridHeaderTemplateTest>();
1359              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHeaderTemplateTest.Model>>();
1360              dataGrid.Find("thead th").TextContent.Trim().Should().Be("test");
1361              dataGrid.Find("span.column-header").FirstChild.NodeName.Should().Be("svg");
1362              dataGrid.Find("span.column-header span").TextContent.Should().Be("Name");
1363          }
1364          [Test]
1365          public async Task DataGridRowDetailOpenTest()
1366          {
1367              var comp = Context.RenderComponent<DataGridHierarchyColumnTest>();
1368              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHierarchyColumnTest.Model>>();
1369              await comp.InvokeAsync(() => dataGrid.Instance
1370              .ToggleHierarchyVisibilityAsync(dataGrid.Instance.Items.First()));
1371              dataGrid.FindAll("td")[5].TextContent.Trim().Should().StartWith("uid = Sam|56|Normal|");
1372          }
1373          [Test]
1374          public async Task DataGridRowDetailClosedTest()
1375          {
1376              var comp = Context.RenderComponent<DataGridHierarchyColumnTest>();
1377              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHierarchyColumnTest.Model>>();
1378              dataGrid.FindAll("td").SingleOrDefault(x => x.TextContent.Trim().StartsWith("uid = Sam|56|Normal|")).Should().BeNull();
1379          }
1380          [Test]
1381          public async Task DataGridRowDetailButtonDisabledTest()
1382          {
1383              var comp = Context.RenderComponent<DataGridHierarchyColumnTest>();
1384              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHierarchyColumnTest.Model>>();
1385              dataGrid.FindAll("button")[10].OuterHtml.Contains("disabled")
1386                  .Should().BeTrue();
1387          }
1388          [Test]
1389          public async Task DataGridRowDetailButtonDisabledClickTest()
1390          {
1391              var comp = Context.RenderComponent<DataGridHierarchyColumnTest>();
1392              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHierarchyColumnTest.Model>>();
1393              await comp.InvokeAsync(() =>
1394              {
1395                  var buttons = dataGrid.FindAll("button.mud-button-root.mud-icon-button.mud-ripple.mud-ripple-icon");
1396                  buttons[10].Click();
1397                  dataGrid.FindAll("td")
1398                  .SingleOrDefault(x => x.TextContent.Trim().StartsWith("uid = Alicia|54|Info|")).Should().BeNull();
1399              });
1400          }
1401          [Test]
1402          public async Task DataGridChildRowContentTest()
1403          {
1404              var comp = Context.RenderComponent<DataGridChildRowContentTest>();
1405              var dataGrid = comp.FindComponent<MudDataGrid<DataGridChildRowContentTest.Model>>();
1406              dataGrid.FindAll("td").SingleOrDefault(x => x.TextContent.Trim().StartsWith("uid = Sam|56|Normal|")).Should().NotBeNull();
1407          }
1408          [Test]
1409          public async Task DataGridLoadingTest()
1410          {
1411              var comp = Context.RenderComponent<DataGridLoadingTest>();
1412              var dataGrid = comp.FindComponent<MudDataGrid<DataGridLoadingTest.Model>>();
1413              dataGrid.Find("th.mud-table-empty-row div").TextContent.Trim().Should().Be("Data loading, please wait...");
1414          }
1415          [Test]
1416          public async Task DataGridNoRecordsContentTest()
1417          {
1418              var comp = Context.RenderComponent<DataGridNoRecordsContentTest>();
1419              var dataGrid = comp.FindComponent<MudDataGrid<DataGridNoRecordsContentTest.Model>>();
1420              dataGrid.Find("th.mud-table-empty-row div").TextContent.Trim().Should().Be("There are no records to view.");
1421          }
1422          [Test]
1423          public async Task DataGridFooterTemplateTest()
1424          {
1425              var comp = Context.RenderComponent<DataGridFooterTemplateTest>();
1426              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFooterTemplateTest.Model>>();
1427              dataGrid.FindAll("tfoot td").First().TextContent.Trim().Should().Be("Names: Sam, Alicia, Ira, John");
1428              dataGrid.FindAll("tfoot td").Last().TextContent.Trim().Should().Be($"Highest: {132000:C0} | 2 Over {100000:C0}");
1429          }
1430          [Test]
1431          public async Task DataGridServerDataQuickFilterTest()
1432          {
1433              var comp = Context.RenderComponent<DataGridServerDataQuickFilterTest>();
1434              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerDataQuickFilterTest.Item>>();
1435              dataGrid.FindAll("tr").Count.Should().Be(3);
1436          }
1437          [Test]
1438          public async Task DataGridServerPaginationTest()
1439          {
1440              var comp = Context.RenderComponent<DataGridServerPaginationTest>();
1441              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerPaginationTest.Model>>();
1442              dataGrid.Find(".mud-table-body td").TextContent.Trim().Should().Be("Name 0");
1443              dataGrid.FindAll(".mud-table-pagination-actions button")[2].Click();
1444              dataGrid.Find(".mud-table-body td").TextContent.Trim().Should().Be("Name 10");
1445              await comp.InvokeAsync(async () => await dataGrid.Instance.ReloadServerData());
1446          }
1447          [Test]
1448          public async Task DataGridCellTemplateTest()
1449          {
1450              var comp = Context.RenderComponent<DataGridCellTemplateTest>();
1451              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellTemplateTest.Model>>();
1452              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("John");
1453              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("45");
1454          }
1455          [Test]
1456          public async Task DataGridColumnChooserTest()
1457          {
1458              var comp = Context.RenderComponent<DataGridColumnChooserTest>();
1459              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColumnChooserTest.Model>>();
1460              var popoverProvider = comp.FindComponent<MudPopoverProvider>();
1461              var popover = dataGrid.FindComponent<MudPopover>();
1462              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1463              await comp.InvokeAsync(() =>
1464              {
1465                  var columnHamburger = dataGrid.FindAll("button.mud-button-root.mud-icon-button.mud-ripple.mud-ripple-icon.mud-icon-button-size-small");
1466                  columnHamburger[2].Click();
1467                  var listItems = popoverProvider.FindComponents<MudListItem>();
1468                  listItems.Count.Should().Be(2);
1469                  var clickablePopover = listItems[1].Find(".mud-list-item");
1470                  clickablePopover.Click();
1471                  ((IMudStateHasChanged)dataGrid.Instance).StateHasChanged();
1472              });
1473              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(1);
1474              await comp.InvokeAsync(() =>
1475              {
1476                  var columnsButton = dataGrid.Find("button.mud-button-root.mud-icon-button.mud-ripple.mud-ripple-icon.mud-icon-button-size-small");
1477                  columnsButton.Click();
1478                  popover.Instance.Open.Should().BeTrue("Should be open once clicked");
1479                  var listItems = popoverProvider.FindComponents<MudListItem>();
1480                  listItems.Count.Should().Be(1);
1481                  var clickablePopover = listItems[0].Find(".mud-list-item");
1482                  clickablePopover.Click();
1483                  var switches = dataGrid.FindComponents<MudSwitch<bool>>();
1484                  switches.Count.Should().Be(2);
1485                  var buttons = dataGrid.FindComponents<MudButton>();
1486                  buttons[1].Find("button").Click();
1487                  dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1488                  ((IMudStateHasChanged)dataGrid.Instance).StateHasChanged();
1489              });
1490              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1491              await comp.InvokeAsync(() => dataGrid.Instance.ShowColumnsPanel());
1492              dataGrid.FindAll(".mud-paper.columns-panel").Count.Should().Be(1);
1493              await comp.InvokeAsync(() => dataGrid.Instance.HideColumnsPanel());
1494              dataGrid.FindAll(".mud-paper.columns-panel").Count.Should().Be(0);
1495              await comp.InvokeAsync(() => dataGrid.Instance.HideAllColumnsAsync());
1496              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(0);
1497              await comp.InvokeAsync(() => dataGrid.Instance.ShowAllColumnsAsync());
1498              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1499          }
1500          [Test]
1501          public async Task DataGridColumnHiddenTest()
1502          {
1503              var comp = Context.RenderComponent<DataGridColumnHiddenTest>();
1504              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColumnHiddenTest.Model>>();
1505              var popoverProvider = comp.FindComponent<MudPopoverProvider>();
1506              var popover = dataGrid.FindComponent<MudPopover>();
1507              popover.Instance.Open.Should().BeFalse("Should start as closed");
1508              var columnsButton = dataGrid.Find("button.mud-button-root.mud-icon-button.mud-ripple.mud-ripple-icon.mud-icon-button-size-small");
1509              columnsButton.Click();
1510              popover.Instance.Open.Should().BeTrue("Should be open once clicked");
1511              var listItems = popoverProvider.FindComponents<MudListItem>();
1512              listItems.Count.Should().Be(1);
1513              var clickablePopover = listItems[0].Find(".mud-list-item");
1514              clickablePopover.Click();
1515              var switches = dataGrid.FindComponents<MudSwitch<bool>>();
1516              switches.Count.Should().Be(2);
1517              switches[0].Instance.Checked.Should().BeFalse();
1518              switches[1].Instance.Checked.Should().BeTrue();
1519              var buttons = dataGrid.FindComponents<MudButton>();
1520              buttons[0].Find("button").Click();
1521              switches[0].Instance.Checked.Should().BeTrue();
1522              switches[1].Instance.Checked.Should().BeTrue();
1523              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(0);
1524              buttons[1].Find("button").Click();
1525              switches[0].Instance.Checked.Should().BeFalse();
1526              switches[1].Instance.Checked.Should().BeFalse();
1527              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1528          }
1529          [Test]
1530          public async Task DataGridShowMenuIconTest()
1531          {
1532              var comp = Context.RenderComponent<DataGridShowMenuIconTest>();
1533              var dataGrid = comp.FindComponent<MudDataGrid<DataGridShowMenuIconTest.Item>>();
1534              dataGrid.FindAll(".mud-table-toolbar .mud-menu").Should().BeEmpty();
1535              var parameters = new List<ComponentParameter>();
1536              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.ShowMenuIcon), true));
1537              dataGrid.SetParametersAndRender(parameters.ToArray());
1538              dataGrid.FindAll(".mud-table-toolbar .mud-menu").Should().NotBeEmpty();
1539          }
1540          [Test]
1541          public async Task DataGridColumnPopupFilteringTest()
1542          {
1543              var comp = Context.RenderComponent<DataGridColumnPopupFilteringTest>();
1544              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColumnPopupFilteringTest.Model>>();
1545              dataGrid.FindAll("tbody tr").Count.Should().Be(4);
1546              comp.Find(".filter-button").Click();
1547              var input = comp.FindComponent<MudTextField<string>>();
1548              var parameters = new List<ComponentParameter>();
1549              parameters.Add(ComponentParameter.CreateParameter(nameof(input.Instance.Value), "test"));
1550              input.SetParametersAndRender(parameters.ToArray());
1551              comp.Find(".apply-filter-button").Click();
1552              await comp.InvokeAsync(() =>
1553              {
1554                  return dataGrid.Instance.AddFilterAsync(new FilterDefinition<DataGridColumnPopupFilteringTest.Model>
1555                  {
1556                      Column = dataGrid.Instance.RenderedColumns.First(),
1557                      Operator = FilterOperator.String.Contains,
1558                      Value = "test"
1559                  });
1560              });
1561              dataGrid.Render();
1562              dataGrid.FindAll("tbody tr").Count.Should().Be(0);
1563          }
1564          [Test]
1565          public async Task DataGridFilterableFalseTest()
1566          {
1567              var comp = Context.RenderComponent<DataGridFilterableFalseTest>();
1568              comp.Find(".filter-button").Click();
1569              comp.FindAll(".filters-panel").Count.Should().Be(1);
1570              comp.FindAll("div.mud-input-control")[0].Click();
1571              comp.FindAll("div.mud-list-item").Count.Should().Be(3);
1572          }
1573          [Test]
1574          public async Task DataGridColumnPopupCustomFilteringTest()
1575          {
1576              var comp = Context.RenderComponent<DataGridColumnPopupCustomFilteringTest>();
1577              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColumnPopupCustomFilteringTest.Model>>();
1578              dataGrid.FindAll("tbody tr").Count.Should().Be(4);
1579              comp.Instance.FilterHired = true;
1580              await comp.InvokeAsync(async () =>
1581              {
1582                  var filterContext = dataGrid.Instance.RenderedColumns[3].FilterContext;
1583                  await comp.Instance.ApplyFilterAsync(filterContext);
1584              });
1585              dataGrid.FindAll("tbody tr").Count.Should().Be(1);
1586          }
1587          [Test]
1588          public async Task DataGridCustomFilteringTest()
1589          {
1590              var comp = Context.RenderComponent<DataGridCustomFilteringTest>();
1591              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCustomFilteringTest.Model>>();
1592              dataGrid.FindAll("tbody tr").Count.Should().Be(4);
1593              await comp.InvokeAsync(() =>
1594              {
1595                  comp.Instance.FilterHiredToggled(true, dataGrid.Instance);
1596              });
1597              dataGrid.Render();
1598              dataGrid.FindAll("tbody tr").Count.Should().Be(1);
1599          }
1600          [Test]
1601          public async Task DataGridShowFilterIconTest()
1602          {
1603              var comp = Context.RenderComponent<DataGridCustomFilteringTest>();
1604              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCustomFilteringTest.Model>>();
1605              var parameters = new List<ComponentParameter>();
1606              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.Filterable), false));
1607              dataGrid.SetParametersAndRender(parameters.ToArray());
1608              dataGrid.Instance.DropContainerHasChanged();
1609              dataGrid.FindAll(".filter-button").Should().BeEmpty();
1610              parameters.Clear();
1611              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.Filterable), true));
1612              dataGrid.SetParametersAndRender(parameters.ToArray());
1613              dataGrid.Instance.DropContainerHasChanged();
1614              dataGrid.FindAll(".filter-button").Should().NotBeEmpty();
1615              parameters.Clear();
1616              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.ShowFilterIcons), false));
1617              dataGrid.SetParametersAndRender(parameters.ToArray());
1618              dataGrid.Instance.DropContainerHasChanged();
1619              dataGrid.FindAll(".filter-button").Should().BeEmpty();
1620          }
1621          [Test]
1622          public async Task DataGridServerDataColumnFilterMenuTest()
1623          {
1624              var comp = Context.RenderComponent<DataGridServerDataColumnFilterMenuTest>();
1625              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerDataColumnFilterMenuTest.Model>>();
1626              var callCountText = comp.FindComponent<MudText>();
1627              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(4);
1628              callCountText.Markup.Should().Contain("Server call count: 1");
1629              comp.Find(".filter-button").Click();
1630              var input = comp.FindComponent<MudTextField<string>>();
1631              await comp.InvokeAsync(async () => await input.Instance.ValueChanged.InvokeAsync("Sam"));
1632              comp.Find(".apply-filter-button").Click();
1633              callCountText.Markup.Should().Contain("Server call count: 2");
1634              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(1);
1635              comp.Find(".filter-button").Click();
1636              comp.Find(".clear-filter-button").Click();
1637              callCountText.Markup.Should().Contain("Server call count: 3");
1638              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(4);
1639          }
1640          [Test]
1641          public async Task DataGridServerDataColumnFilterRowTest()
1642          {
1643              var comp = Context.RenderComponent<DataGridServerDataColumnFilterRowTest>();
1644              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerDataColumnFilterRowTest.Model>>();
1645              var callCountText = comp.FindComponent<MudText>();
1646              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(4);
1647              callCountText.Markup.Should().Contain("Server call count: 1");
1648              var input = comp.FindComponent<MudTextField<string>>();
1649              await comp.InvokeAsync(async () => await input.Instance.ValueChanged.InvokeAsync("Sam"));
1650              callCountText.Markup.Should().Contain("Server call count: 2");
1651              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(1);
1652              comp.Find("th > div > button.mud-button-root").Click(); 
1653              callCountText.Markup.Should().Contain("Server call count: 3");
1654              dataGrid.Render();
1655              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(4);
1656          }
1657          [Test]
1658          public async Task DataGridStickyColumnsTest()
1659          {
1660              var comp = Context.RenderComponent<DataGridStickyColumnsTest>();
1661              var dataGrid = comp.FindComponent<MudDataGrid<DataGridStickyColumnsTest.Model>>();
1662              dataGrid.Find("th").ClassList.Should().Contain("sticky-left");
1663              dataGrid.FindAll("th").Last().ClassList.Should().Contain("sticky-right");
1664          }
1665          [Test]
1666          public async Task DataGridStickyColumnsResizerTest()
1667          {
1668              var comp = Context.RenderComponent<DataGridStickyColumnsResizerTest>();
1669              var dataGrid = comp.FindComponent<MudDataGrid<DataGridStickyColumnsResizerTest.Model>>();
1670              var header = dataGrid.Find(".mud-table-toolbar");
1671              header.GetAttribute("style").Should().Contain("position:sticky");
1672              header.GetAttribute("style").Should().Contain("left:0px");
1673              var footer = dataGrid.Find(".mud-table-pagination");
1674              footer.GetAttribute("style").Should().Contain("position:sticky");
1675              footer.GetAttribute("style").Should().Contain("left:0px");
1676              var body = dataGrid.Find(".mud-table-container");
1677              body.GetAttribute("style").Should().Contain("width:max-content");
1678              body.GetAttribute("style").Should().Contain("overflow:clip");
1679              dataGrid.Find("th").ClassList.Should().Contain("sticky-left");
1680              dataGrid.FindAll("th").Last().ClassList.Should().Contain("sticky-right");
1681          }
1682          [Test]
1683          public async Task DataGridCellContextTest()
1684          {
1685              var comp = Context.RenderComponent<DataGridCellContextTest>();
1686              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellContextTest.Model>>();
1687              var item = dataGrid.Instance.Items.FirstOrDefault();
1688              var column = dataGrid.Instance.RenderedColumns.First();
1689              var cell = new Cell<DataGridCellContextTest.Model>(dataGrid.Instance, column, item);
1690              cell._cellContext.IsSelected.Should().Be(false);
1691              await cell._cellContext.Actions.SetSelectedItemAsync(true);
1692              cell._cellContext.IsSelected.Should().Be(true);
1693              await cell._cellContext.Actions.ToggleHierarchyVisibilityForItemAsync();
1694              cell._cellContext.OpenHierarchies.Should().Contain(item);
1695              await cell._cellContext.Actions.ToggleHierarchyVisibilityForItemAsync();
1696              cell._cellContext.OpenHierarchies.Should().NotContain(item);
1697          }
1698          [Test]
1699          public async Task DataGridAggregationTest()
1700          {
1701              var comp = Context.RenderComponent<DataGridAggregationTest>();
1702              var dataGrid = comp.FindComponent<MudDataGrid<DataGridAggregationTest.Model>>();
1703              dataGrid.FindAll("td.footer-cell")[1].TrimmedText().Should().Be("Average age is 56");
1704              dataGrid.FindAll("tfoot td.footer-cell")[1].TrimmedText().Should().Be("Average age is 43");
1705          }
1706          [Test]
1707          public async Task DataGridSequenceContainsNoElementsTest()
1708          {
1709              var comp = Context.RenderComponent<DataGridSequenceContainsNoElementsTest>();
1710              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSequenceContainsNoElementsTest.Model>>();
1711          }
1712          [Test]
1713          public async Task DataGridObservabilityTest()
1714          {
1715              var comp = Context.RenderComponent<DataGridObservabilityTest>();
1716              var dataGrid = comp.FindComponent<MudDataGrid<DataGridObservabilityTest.Model>>();
1717              var addButton = comp.Find(".add-item-btn");
1718              var removeButton = comp.Find(".remove-item-btn");
1719              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(8);
1720              addButton.Click();
1721              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(9);
1722              removeButton.Click();
1723              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(8);
1724          }
1725          public async Task TableFilterGuid()
1726          {
1727              var comp = Context.RenderComponent<DataGridFilterGuid<Guid>>();
1728              var grid = comp.Instance.MudGridRef;
1729              grid.Items.Count().Should().Be(2);
1730              grid.FilteredItems.Count().Should().Be(2);
1731              var guidColumn = grid.RenderedColumns.FirstOrDefault(x => x.PropertyName == "Id");
1732              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Guid>.WeatherForecast>()
1733              {
1734                  Column = guidColumn,
1735                  Operator = "equals",
1736                  Value = "invalid guid",
1737              });
1738              grid.FilteredItems.Count().Should().Be(0);
1739              grid.FilterDefinitions.Clear();
1740              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Guid>.WeatherForecast>()
1741              {
1742                  Column = guidColumn,
1743                  Operator = "equals",
1744                  Value = comp.Instance.Guid1,
1745              });
1746              grid.FilteredItems.Count().Should().Be(1);
1747              grid.FilteredItems.FirstOrDefault()?.Id.Should().Be(comp.Instance.Guid1);
1748              grid.FilterDefinitions.Clear();
1749              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Guid>.WeatherForecast>()
1750              {
1751                  Column = guidColumn,
1752                  Operator = "not equals",
1753                  Value = comp.Instance.Guid1,
1754              });
1755              grid.FilteredItems.Count().Should().Be(1);
1756              grid.FilteredItems.FirstOrDefault()?.Id.Should().Be(comp.Instance.Guid2);
1757          }
1758          [Test]
1759          public async Task TableFilterNullableGuid()
1760          {
1761              var comp = Context.RenderComponent<DataGridFilterGuid<Nullable<Guid>>>();
1762              var grid = comp.Instance.MudGridRef;
1763              grid.Items.Count().Should().Be(2);
1764              grid.FilteredItems.Count().Should().Be(2);
1765              var guidColumn = grid.RenderedColumns.FirstOrDefault(x => x.PropertyName == "Id");
1766              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Nullable<Guid>>.WeatherForecast>()
1767              {
1768                  Column = guidColumn,
1769                  Operator = "equals",
1770                  Value = Guid.Empty
1771              });
1772              comp.Render();
1773              grid.FilteredItems.Count().Should().Be(0);
1774              grid.FilterDefinitions.Clear();
1775              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Nullable<Guid>>.WeatherForecast>()
1776              {
1777                  Column = guidColumn,
1778                  Operator = "equals",
1779                  Value = comp.Instance.Guid1,
1780              });
1781              comp.Render();
1782              grid.FilteredItems.Count().Should().Be(1);
1783              grid.FilteredItems.FirstOrDefault()?.Id.Should().Be(comp.Instance.Guid1);
1784              grid.FilterDefinitions.Clear();
1785              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Nullable<Guid>>.WeatherForecast>()
1786              {
1787                  Column = guidColumn,
1788                  Operator = "not equals",
1789                  Value = comp.Instance.Guid1,
1790              });
1791              comp.Render();
1792              grid.FilteredItems.Count().Should().Be(1);
1793              grid.FilteredItems.FirstOrDefault()?.Id.Should().Be(comp.Instance.Guid2);
1794          }
1795          [Test]
1796          public void DataGridCultureColumnSimpleTest()
1797          {
1798              var comp = Context.RenderComponent<DataGridCultureSimpleTest>();
1799              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCultureSimpleTest.Model>>();
1800              dataGrid.FindAll("td")[2].TextContent.Trim().Should().Be("3.5");
1801              dataGrid.FindAll("td")[3].TextContent.Trim().Should().Be("5,2");
1802          }
1803          [Test]
1804          public void DataGridCultureColumnEditableTest()
1805          {
1806              var comp = Context.RenderComponent<DataGridCultureEditableTest>();
1807              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCultureEditableTest.Model>>();
1808              dataGrid.FindAll("td input")[2].GetAttribute("value").Trim().Should().Be("3.5");
1809              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("5,2");
1810          }
1811          [Test]
1812          public async Task DataGridCultureColumnFilterTest()
1813          {
1814              var comp = Context.RenderComponent<DataGridCultureSimpleTest>();
1815              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCultureSimpleTest.Model>>();
1816              var amountHeader = dataGrid.FindAll("th .mud-menu button")[2];
1817              amountHeader.Click();
1818              var filterAmount = comp.FindAll(".mud-list-item-clickable")[1];
1819              filterAmount.Click();
1820              var filterField = comp.Find(".filters-panel .filter-field .mud-select-input");
1821              filterField.TextContent.Trim().Should().Be("Amount");
1822              var filterInput = comp.FindAll(".filters-panel input")[2];
1823              filterInput.Input(new ChangeEventArgs() { Value = "2,2" });
1824              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1825              dataGrid.Instance.FilterDefinitions[0].Value.Should().Be(22.0);
1826              dataGrid.Instance.FilterDefinitions.Clear();
1827              dataGrid.Render();
1828              var totalHeader = dataGrid.FindAll("th .mud-menu button")[3];
1829              totalHeader.Click();
1830              var filterTotal = comp.FindAll(".mud-list-item-clickable")[1];
1831              filterTotal.Click();
1832              var filterTotalField = comp.Find(".filters-panel .filter-field .mud-select-input");
1833              filterTotalField.TextContent.Trim().Should().Be("Total");
1834              var filterTotalInput = comp.FindAll(".filters-panel input")[2];
1835              filterTotalInput.Input(new ChangeEventArgs() { Value = "2,2" });
1836              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1837              dataGrid.Instance.FilterDefinitions[0].Value.Should().Be(2.2);
1838          }
1839          [Test]
1840          public async Task DataGridCultureColumnFilterHeaderTest()
1841          {
1842              var comp = Context.RenderComponent<DataGridCultureEditableTest>();
1843              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCultureEditableTest.Model>>();
1844              var filterAmount = dataGrid.FindAll("th.filter-header-cell input")[2];
1845              filterAmount.Input(new ChangeEventArgs() { Value = "2,2" });
1846              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1847              dataGrid.Instance.FilterDefinitions[0].Value.Should().Be(22.0);
1848              dataGrid.Instance.FilterDefinitions.Clear();
1849              dataGrid.Render();
1850              var filterTotal = dataGrid.FindAll("th.filter-header-cell input")[3];
1851              filterTotal.Input(new ChangeEventArgs() { Value = "2,2" });
1852              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1853              dataGrid.Instance.FilterDefinitions[0].Value.Should().Be(2.2);
1854          }
1855          [Test]
1856          public async Task DataGridCultureColumnOverridesTest()
1857          {
1858              var comp = Context.RenderComponent<DataGridCulturesTest>();
1859              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCulturesTest.Model>>();
1860              dataGrid.FindAll("td input")[2].GetAttribute("value").Trim().Should().Be("3.5");
1861              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("5,2");
1862              dataGrid.FindAll("td input")[4].GetAttribute("value").Trim().Should().Be("2#1");
1863          }
1864          [Test]
1865          public async Task DataGridSortIndicatorTest()
1866          {
1867              var comp = Context.RenderComponent<DataGridSortableTest>();
1868              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSortableTest.Item>>();
1869              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Ascending, x => x.Value));
1870              dataGrid.Instance.DropContainerHasChanged();
1871              dataGrid.FindAll("th .sortable-column-header")[1].TextContent.Trim().Should().Be("Value");
1872              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1873              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(true);
1874              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1875              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Ascending);
1876              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Descending, x => x.Value));
1877              dataGrid.Instance.DropContainerHasChanged();
1878              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1879              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Descending);
1880              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1881              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-desc").Should().Be(true);
1882              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => x.Value));
1883              dataGrid.Instance.DropContainerHasChanged();
1884              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.Ascending);
1885              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.None);
1886              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(true);
1887              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(false);
1888          }
1889          [Test]
1890          public async Task DataGridCustomSortTest()
1891          {
1892              var comp = Context.RenderComponent<DataGridCustomSortableTest>();
1893              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCustomSortableTest.Item>>();
1894              dataGrid.Instance.SortMode = SortMode.Single;
1895              dataGrid.Instance.SortMode.Should().Be(SortMode.Single);
1896              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Ascending, x => x.Value, new MudBlazor.Utilities.NaturalComparer()));
1897              dataGrid.Instance.DropContainerHasChanged();
1898              dataGrid.FindAll("th .sortable-column-header")[1].TextContent.Trim().Should().Be("Value");
1899              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1900              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(true);
1901              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1902              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Ascending);
1903              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Descending, x => x.Value, new MudBlazor.Utilities.NaturalComparer()));
1904              dataGrid.Instance.DropContainerHasChanged();
1905              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1906              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Descending);
1907              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1908              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-desc").Should().Be(true);
1909              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Ascending, x => x.Value));
1910              dataGrid.Instance.DropContainerHasChanged();
1911              dataGrid.FindAll("th .sortable-column-header")[1].TextContent.Trim().Should().Be("Value");
1912              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1913              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(true);
1914              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1915              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Ascending);
1916              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => x.Name, new MudBlazor.Utilities.NaturalComparer()));
1917              dataGrid.Instance.DropContainerHasChanged();
1918              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.Ascending);
1919              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.None);
1920              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(true);
1921              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(false);
1922              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Descending, x => x.Name, new MudBlazor.Utilities.NaturalComparer()));
1923              dataGrid.Instance.DropContainerHasChanged();
1924              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.Descending);
1925              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.None);
1926              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-desc").Should().Be(true);
1927              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(false);
1928              dataGrid.Instance.SortMode = SortMode.Multiple;
1929              dataGrid.Instance.SortMode.Should().Be(SortMode.Multiple);
1930              var column = dataGrid.FindComponent<Column<DataGridCustomSortableTest.Item>>();
1931              await comp.InvokeAsync(() => column.Instance.Comparer = new MudBlazor.Utilities.NaturalComparer());
1932              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync("Name"));
1933              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1934              dataGrid.Find(".column-options button").Click();
1935              var cells = dataGrid.FindAll("td");
1936              cells[0].TextContent.Should().Be("0");
1937              cells[3].TextContent.Should().Be("1");
1938              cells[6].TextContent.Should().Be("1_2");
1939              cells[9].TextContent.Should().Be("1_10");
1940              cells[12].TextContent.Should().Be("1_11");
1941              cells[15].TextContent.Should().Be("2");
1942              cells[18].TextContent.Should().Be("10");
1943              var headerCell = dataGrid.FindComponents<HeaderCell<DataGridCustomSortableTest.Item>>()[1];
1944              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new MouseEventArgs() { CtrlKey = true, Button = 0 }));
1945              headerCell.Instance.SortDirection.Should().Be(SortDirection.Ascending);
1946              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new MouseEventArgs() { CtrlKey = true, Button = 0 }));
1947              headerCell.Instance.SortDirection.Should().Be(SortDirection.Descending);
1948              headerCell = dataGrid.FindComponents<HeaderCell<DataGridCustomSortableTest.Item>>()[0];
1949              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new MouseEventArgs() { AltKey = true, Button = 0 }));
1950              headerCell.Instance.SortDirection.Should().Be(SortDirection.None);
1951          }
1952          [Test]
1953          public async Task DataGridGroupExpandedTest()
1954          {
1955              var comp = Context.RenderComponent<DataGridGroupExpandedTest>();
1956              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupExpandedTest.Fruit>>();
1957              comp.FindAll("tbody .mud-table-row").Count.Should().Be(7);
1958              comp.Instance.CollapseAllGroups();
1959              dataGrid.Render();
1960              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
1961              await comp.InvokeAsync(() =>
1962                  comp.Instance.AddFruit());
1963              dataGrid.Render();
1964              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
1965          }
1966          [Test]
1967          public async Task DataGridGroupExpandedAsyncTest()
1968          {
1969              var comp = Context.RenderComponent<DataGridGroupExpandedAsyncTest>();
1970              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupExpandedAsyncTest.Fruit>>();
1971              comp.WaitForAssertion(() => comp.FindAll("tbody .mud-table-row").Count.Should().Be(7));
1972              comp.Instance.CollapseAllGroups();
1973              dataGrid.Render();
1974              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
1975              await comp.InvokeAsync(() =>
1976                  comp.Instance.AddFruit());
1977              dataGrid.Render();
1978              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
1979          }
1980          [Test]
1981          public async Task DataGridGroupExpandedServerDataTest()
1982          {
1983              var comp = Context.RenderComponent<DataGridGroupExpandedServerDataTest>();
1984              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupExpandedServerDataTest.Fruit>>();
1985              comp.WaitForAssertion(() => comp.FindAll("tbody .mud-table-row").Count.Should().Be(7));
1986              comp.Instance.CollapseAllGroups();
1987              dataGrid.Render();
1988              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
1989              await comp.InvokeAsync(() =>
1990                  comp.Instance.AddFruit());
1991              dataGrid.Render();
1992              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
1993          }
1994          [Test]
1995          public async Task DataGridGroupCollapseAllTest()
1996          {
1997              var comp = Context.RenderComponent<DataGridGroupCollapseAllTest>();
1998              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupCollapseAllTest.TestObject>>();
1999              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
2000              comp.Instance.ExpandAllGroups();
2001              comp.Render();
2002              comp.FindAll("tbody .mud-table-row").Count.Should().Be(15);
2003              comp.Instance.CollapseAllGroups();
2004              comp.Render();
2005              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
2006              comp.Instance.RefreshList();
2007              comp.Render();
2008              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
2009          }
2010          [Test]
2011          public async Task DataGridGroupExpandAllCollapseAllTest()
2012          {
2013              var comp = Context.RenderComponent<DataGridGroupExpandAllCollapseAllTest>();
2014              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupExpandAllCollapseAllTest.Element>>();
2015              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
2016              comp.Instance.ExpandAllGroups();
2017              comp.Render();
2018              comp.FindAll("tbody .mud-table-row").Count.Should().Be(14);
2019              comp.Instance.NavigateToPage(1);
2020              comp.Render();
2021              comp.FindAll("tbody .mud-table-row").Count.Should().Be(18);
2022              comp.Instance.CollapseAllGroups();
2023              comp.Instance.NavigateToPage(0);
2024              comp.Render();
2025              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
2026              comp.Instance.RefreshList();
2027              comp.Render();
2028              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
2029          }
2030          [Test]
2031          public async Task DataGridPropertyColumnFormatTest()
2032          {
2033              var comp = Context.RenderComponent<DataGridFormatTest>();
2034              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFormatTest.Employee>>();
2035              comp.FindAll("tbody.mud-table-body td")[3].TextContent.Should().Be("$87,000.00");
2036              var column = (PropertyColumn<DataGridFormatTest.Employee, int>)dataGrid.Instance.GetColumnByPropertyName("Salary");
2037              await comp.InvokeAsync(() => column.Format = "C0");
2038              comp.Find(".mud-switch-input").Change(new ChangeEventArgs { Value = true });
2039              comp.FindAll("tbody.mud-table-body td")[3].TextContent.Should().Be("$87,000");
2040          }
2041          [Test]
2042          public async Task DataGridFilteredItemsCacheTest()
2043          {
2044              var comp = Context.RenderComponent<DataGridSortableTest>();
2045              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSortableTest.Item>>();
2046              var initialFilterCount = dataGrid.Instance.FilteringRunCount;
2047              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => { return x.Name; }));
2048              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 1);
2049              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Descending, x => { return x.Name; }));
2050              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 2);
2051              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync("Name"));
2052              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 3);
2053              var column = dataGrid.FindComponent<Column<DataGridSortableTest.Item>>();
2054              await comp.InvokeAsync(() => column.Instance.SortBy = x => { return x.Name; });
2055              dataGrid.Render();
2056              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 4);
2057              dataGrid.Find(".column-options button").Click();
2058              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 5);
2059              var headerCell = dataGrid.FindComponent<HeaderCell<DataGridSortableTest.Item>>();
2060              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new Microsoft.AspNetCore.Components.Web.MouseEventArgs()));
2061              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 6);
2062              await comp.InvokeAsync(() => headerCell.Instance.RemoveSortAsync());
2063              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 7);
2064              await comp.InvokeAsync(() => headerCell.Instance.AddFilterAsync());
2065              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 8);
2066              await comp.InvokeAsync(() => headerCell.Instance.OpenFilters());
2067              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 9);
2068              await comp.InvokeAsync(() => dataGrid.Instance.SortMode = SortMode.None);
2069              dataGrid.Render();
2070              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 10);
2071              dataGrid.Instance.DropContainerHasChanged();
2072              dataGrid.FindAll(".column-header .sortable-column-header").Should().BeEmpty();
2073          }
2074          [Test]
2075          public async Task DataGridDragAndDropTest()
2076          {
2077              var comp = Context.RenderComponent<DataGridDragAndDropTest>();
2078              var dataGrid = comp.FindComponent<MudDataGrid<DataGridDragAndDropTest.Model>>();
2079              dataGrid.Instance.DropContainerHasChanged();
2080              var headerValues = dataGrid.FindAll(".sortable-column-header");
2081              headerValues.Count.Should().Be(5, because: "5 columns in DataGridFiltersTest");
2082              headerValues[0].InnerHtml.Should().Be("Name");
2083              headerValues[1].InnerHtml.Should().Be("Age");
2084              headerValues[2].InnerHtml.Should().Be("Status");
2085              headerValues[3].InnerHtml.Should().Be("Hired");
2086              headerValues[4].InnerHtml.Should().Be("HiredOn");
2087              var container = dataGrid.Find(".mud-drop-container");
2088              container.Children.Should().HaveCount(1);
2089              var zone = dataGrid.FindAll(".mud-drop-zone");
2090              zone.Count.Should().Be(5, because: "5 columns in DataGridFiltersTest");
<span onclick='openModal()' class='match'>2091              var firstDropZone = zone[1];
2092              var firstDropItem = firstDropZone.Children[0];
2093              var secondDropZone = zone[2];
</span>2094              var secondDropItem = secondDropZone.Children[0];
2095              await firstDropItem.DragStartAsync(new DragEventArgs());
2096              await secondDropItem.DropAsync(new DragEventArgs());
2097              var newHeaderValues = dataGrid.FindAll(".sortable-column-header");
2098              newHeaderValues.Count.Should().Be(5, because: "5 columns in DataGridFiltersTest");
2099              newHeaderValues[0].InnerHtml.Should().Be("Name");
2100              newHeaderValues[1].InnerHtml.Should().Be("Status");
2101              newHeaderValues[2].InnerHtml.Should().Be("Age");
2102              newHeaderValues[3].InnerHtml.Should().Be("Hired");
2103              newHeaderValues[4].InnerHtml.Should().Be("HiredOn");
2104          }
2105      }
2106  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-DataGridTests.cs</h3>
            <pre><code>1  #pragma warning disable CS1998 
2  #pragma warning disable BL0005 
3  using System;
4  using System.Collections.Generic;
5  using System.Linq;
6  using System.Linq.Expressions;
7  using System.Threading.Tasks;
8  using AngleSharp.Dom;
9  using Bunit;
10  using FluentAssertions;
11  using Microsoft.AspNetCore.Components;
12  using Microsoft.AspNetCore.Components.Web;
13  using Microsoft.JSInterop;
14  using MudBlazor.Interfaces;
15  using MudBlazor.UnitTests.TestComponents;
16  using NUnit.Framework;
17  using static MudBlazor.Docs.Examples.TableRelationalExample;
18  namespace MudBlazor.UnitTests.Components
19  {
20      public record TestModel1(string Name, int? Age);
21      public record TestModel2(string Name, int? Age, DateTime? Date);
22      public record TestModel3(string Name, int? Age, Severity? Status);
23      public record TestModel4(string Name, int? Age, bool? Hired);
24      [TestFixture]
25      public class DataGridTests : BunitTest
26      {
27          [Test]
28          public async Task DataGridSortableTest()
29          {
30              var comp = Context.RenderComponent<DataGridSortableTest>();
31              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSortableTest.Item>>();
32              var rows = dataGrid.FindAll("tr");
33              rows.Count.Should().Be(9, because: "1 header row + 7 data rows + 1 footer row");
34              var cells = dataGrid.FindAll("td");
35              cells.Count.Should().Be(21, because: "We have 7 data rows with three columns");
36              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
37              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
38              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
39              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
40              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
41              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
42              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
43              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => { return x.Name; }));
44              cells = dataGrid.FindAll("td");
45              cells[0].TextContent.Should().Be("A"); cells[1].TextContent.Should().Be("73"); cells[2].TextContent.Should().Be("7");
46              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("11"); cells[5].TextContent.Should().Be("4444");
47              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("99"); cells[8].TextContent.Should().Be("66");
48              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
49              cells[12].TextContent.Should().Be("C"); cells[13].TextContent.Should().Be("33"); cells[14].TextContent.Should().Be("33333");
50              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
51              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
52              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Descending, x => { return x.Name; }));
53              cells = dataGrid.FindAll("td");
54              cells[0].TextContent.Should().Be("C"); cells[1].TextContent.Should().Be("33"); cells[2].TextContent.Should().Be("33333");
55              cells[3].TextContent.Should().Be("C"); cells[4].TextContent.Should().Be("44"); cells[5].TextContent.Should().Be("1111111");
56              cells[6].TextContent.Should().Be("C"); cells[7].TextContent.Should().Be("55"); cells[8].TextContent.Should().Be("222222");
57              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
58              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("73"); cells[14].TextContent.Should().Be("7");
59              cells[15].TextContent.Should().Be("A"); cells[16].TextContent.Should().Be("11"); cells[17].TextContent.Should().Be("4444");
60              cells[18].TextContent.Should().Be("A"); cells[19].TextContent.Should().Be("99"); cells[20].TextContent.Should().Be("66");
61              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync("Name"));
62              cells = dataGrid.FindAll("td");
63              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
64              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
65              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
66              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
67              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
68              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
69              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
70              var column = dataGrid.FindComponent<Column<DataGridSortableTest.Item>>();
71              await comp.InvokeAsync(() => column.Instance.SortBy = x => { return x.Name; });
72              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
73              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
74              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
75              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
76              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
77              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
78              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
79              dataGrid.Find(".column-options button").Click();
80              cells = dataGrid.FindAll("td");
81              cells[0].TextContent.Should().Be("A"); cells[1].TextContent.Should().Be("73"); cells[2].TextContent.Should().Be("7");
82              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("11"); cells[5].TextContent.Should().Be("4444");
83              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("99"); cells[8].TextContent.Should().Be("66");
84              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
85              cells[12].TextContent.Should().Be("C"); cells[13].TextContent.Should().Be("33"); cells[14].TextContent.Should().Be("33333");
86              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
87              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
88              var headerCell = dataGrid.FindComponent<HeaderCell<DataGridSortableTest.Item>>();
89              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new Microsoft.AspNetCore.Components.Web.MouseEventArgs()));
90              await comp.InvokeAsync(() => headerCell.Instance.RemoveSortAsync());
91              await comp.InvokeAsync(() => headerCell.Instance.AddFilterAsync());
92              await comp.InvokeAsync(() => headerCell.Instance.OpenFilters());
93              await comp.InvokeAsync(() => dataGrid.Instance.SortMode = SortMode.None);
94              dataGrid.Render();
95              dataGrid.Instance.DropContainerHasChanged();
96              dataGrid.FindAll(".column-header .sortable-column-header").Should().BeEmpty();
97          }
98          [Test]
99          public async Task DataGridSortableTemplateColumnTest()
100          {
101              var comp = Context.RenderComponent<DataGridSortableTemplateColumnTest>();
102              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSortableTemplateColumnTest.Item>>();
103              var rows = dataGrid.FindAll("tr");
104              rows.Count.Should().Be(9, because: "1 header row + 7 data rows + 1 footer row");
105              var cells = dataGrid.FindAll("td");
106              cells.Count.Should().Be(7, because: "We have 7 data rows with one column");
107              cells[0].TextContent.Should().Be("B");
108              cells[1].TextContent.Should().Be("A");
109              cells[2].TextContent.Should().Be("A");
110              cells[3].TextContent.Should().Be("C");
111              cells[4].TextContent.Should().Be("A");
112              cells[5].TextContent.Should().Be("C");
113              cells[6].TextContent.Should().Be("C");
114              var templatePropertyName = dataGrid.Instance.RenderedColumns.FirstOrDefault().PropertyName;
115              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync(templatePropertyName, SortDirection.Ascending, x => { return x.Name; }));
116              cells = dataGrid.FindAll("td");
117              cells[0].TextContent.Should().Be("A");
118              cells[1].TextContent.Should().Be("A");
119              cells[2].TextContent.Should().Be("A");
120              cells[3].TextContent.Should().Be("B");
121              cells[4].TextContent.Should().Be("C");
122              cells[5].TextContent.Should().Be("C");
123              cells[6].TextContent.Should().Be("C");
124              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync(templatePropertyName, SortDirection.Descending, x => { return x.Name; }));
125              cells = dataGrid.FindAll("td");
126              cells[0].TextContent.Should().Be("C");
127              cells[1].TextContent.Should().Be("C");
128              cells[2].TextContent.Should().Be("C");
129              cells[3].TextContent.Should().Be("B");
130              cells[4].TextContent.Should().Be("A");
131              cells[5].TextContent.Should().Be("A");
132              cells[6].TextContent.Should().Be("A");
133              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync(templatePropertyName));
134              cells = dataGrid.FindAll("td");
135              cells[0].TextContent.Should().Be("B");
136              cells[1].TextContent.Should().Be("A");
137              cells[2].TextContent.Should().Be("A");
138              cells[3].TextContent.Should().Be("C");
139              cells[4].TextContent.Should().Be("A");
140              cells[5].TextContent.Should().Be("C");
141              cells[6].TextContent.Should().Be("C");
142              dataGrid.Find(".column-options button").Click();
143              cells = dataGrid.FindAll("td");
144              cells[0].TextContent.Should().Be("A");
145              cells[1].TextContent.Should().Be("A");
146              cells[2].TextContent.Should().Be("A");
147              cells[3].TextContent.Should().Be("B");
148              cells[4].TextContent.Should().Be("C");
149              cells[5].TextContent.Should().Be("C");
150              cells[6].TextContent.Should().Be("C");
151          }
152          [Test]
153          public async Task DataGridFilterableTest()
154          {
155              var comp = Context.RenderComponent<DataGridFilterableTest>();
156              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFilterableTest.Item>>();
157              dataGrid.FindAll("tr").Count.Should().Be(6); 
158              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("B");
159              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("A");
160              dataGrid.FindAll("td")[2].TextContent.Trim().Should().Be("C");
161              dataGrid.FindAll("td")[3].TextContent.Trim().Should().Be("C");
162              await comp.InvokeAsync(() =>
163              {
164                  return dataGrid.Instance.AddFilterAsync(new FilterDefinition<DataGridFilterableTest.Item>
165                  {
166                      Column = dataGrid.Instance.RenderedColumns.First(),
167                      Operator = FilterOperator.String.Equal,
168                      Value = "C"
169                  });
170              });
171              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("C");
172              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("C");
173              dataGrid.Instance.Filterable = false;
174          }
175          [Test]
176          public async Task DataGridFilterableServerDataTest()
177          {
178              var comp = Context.RenderComponent<DataGridFilterableServerDataTest>();
179              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFilterableServerDataTest.Item>>();
180              dataGrid.FindAll("tr").Count.Should().Be(6); 
181              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("B");
182              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("A");
183              dataGrid.FindAll("td")[2].TextContent.Trim().Should().Be("C");
184              dataGrid.FindAll("td")[3].TextContent.Trim().Should().Be("C");
185              await comp.InvokeAsync(() =>
186              {
187                  return dataGrid.Instance.AddFilterAsync(new FilterDefinition<DataGridFilterableServerDataTest.Item>
188                  {
189                      Column = dataGrid.Instance.RenderedColumns.FirstOrDefault(),
190                      Operator = FilterOperator.String.Equal,
191                      Value = "C"
192                  });
193              });
194              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("C");
195              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("C");
196              dataGrid.Instance.Filterable = false;
197          }
198          [Test]
199          public async Task DataGridMultiSelectionTest()
200          {
201              var comp = Context.RenderComponent<DataGridMultiSelectionTest>();
202              var dataGrid = comp.FindComponent<MudDataGrid<DataGridMultiSelectionTest.Item>>();
203              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
204              dataGrid.FindAll("input")[0].Change(true);
205              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
206              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectedItemAsync(false, dataGrid.Instance.SelectedItems.First()));
207              dataGrid.Instance.SelectedItems.Count.Should().Be(2);
208              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectedItemAsync(dataGrid.Instance.Items.First()));
209              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
210              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectAllAsync(false));
211              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
212              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectAllAsync(true));
213              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
214              dataGrid.Find("tfoot input").Change(false);
215              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
216          }
217          [Test]
218          public async Task DataGridServerMultiSelectionTest()
219          {
220              var comp = Context.RenderComponent<DataGridServerMultiSelectionTest>();
221              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerMultiSelectionTest.Item>>();
222              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
223              dataGrid.FindAll("input")[0].Change(true);
224              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
225              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectedItemAsync(false, dataGrid.Instance.SelectedItems.First()));
226              dataGrid.Instance.SelectedItems.Count.Should().Be(2);
227              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectedItemAsync(dataGrid.Instance.ServerItems.First()));
228              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
229              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectAllAsync(false));
230              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
231              await comp.InvokeAsync(async () => await dataGrid.Instance.SetSelectAllAsync(true));
232              dataGrid.Instance.SelectedItems.Count.Should().Be(3);
233              dataGrid.Find("tfoot input").Change(false);
234              dataGrid.Instance.SelectedItems.Count.Should().Be(0);
235          }
236          [Test]
237          public async Task DataGridPaginationTest()
238          {
239              var comp = Context.RenderComponent<DataGridPaginationTest>();
240              var dataGrid = comp.FindComponent<MudDataGrid<DataGridPaginationTest.Item>>();
241              dataGrid.FindAll(".mud-table-pagination-caption")[^1].TextContent.Trim().Should().Be("1-10 of 20");
242              dataGrid.Find(".mud-table-body td").TextContent.Trim().Should().Be("0");
243              dataGrid.FindAll(".mud-table-pagination-actions button")[2].Click();
244              dataGrid.Find(".mud-table-body td").TextContent.Trim().Should().Be("10");
245              dataGrid.Instance.RowsPerPage.Should().Be(10);
246              await comp.InvokeAsync(async () => await dataGrid.Instance.SetRowsPerPageAsync(4));
247              dataGrid.Instance.RowsPerPage.Should().Be(4);
248              await comp.InvokeAsync(() => dataGrid.Instance.NavigateTo(Page.Last));
249              dataGrid.Instance.CurrentPage.Should().Be(4);
250              await comp.InvokeAsync(() => dataGrid.Instance.NavigateTo(Page.Previous));
251              dataGrid.Instance.CurrentPage.Should().Be(3);
252              await comp.InvokeAsync(() => dataGrid.Instance.NavigateTo(Page.First));
253              dataGrid.Instance.CurrentPage.Should().Be(0);
254          }
255          [Test]
256          public async Task DataGridInlineEditTest()
257          {
258              var comp = Context.RenderComponent<DataGridCellEditTest>();
259              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellEditTest.Model>>();
260              dataGrid.FindAll("td input")[0].GetAttribute("value").Trim().Should().Be("John");
261              dataGrid.FindAll("td input")[1].GetAttribute("value").Trim().Should().Be("45");
262              dataGrid.FindAll("td input")[2].GetAttribute("value").Trim().Should().Be("Johanna");
263              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("23");
264              dataGrid.FindAll("td input")[4].GetAttribute("value").Trim().Should().Be("Steve");
265              dataGrid.FindAll("td input")[5].GetAttribute("value").Trim().Should().Be("32");
266              dataGrid.FindAll(".mud-table-body tr td input")[0].Change("Jonathan");
267              dataGrid.FindAll(".mud-table-body tr td input")[1].Change(52d);
268              dataGrid.FindAll(".mud-table-body tr td input")[0].GetAttribute("value").Trim().Should().Be("Jonathan");
269              dataGrid.FindAll(".mud-table-body tr td input")[1].GetAttribute("value").Trim().Should().Be("52");
270              var name = dataGrid.Instance.Items.First().Name;
271              var age = dataGrid.Instance.Items.First().Age;
272              name.Should().Be("Jonathan");
273              age.Should().Be(52);
274          }
275          [Test]
276          public async Task DataGridInlineEditWithNullableTest()
277          {
278              var comp = Context.RenderComponent<DataGridCellEditWithNullableTest>();
279              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellEditWithNullableTest.Model>>();
280              dataGrid.FindAll("td input")[0].GetAttribute("value").Trim().Should().Be("John");
281              dataGrid.FindAll("td input")[1].GetAttribute("value").Trim().Should().Be("45");
282              dataGrid.FindAll("td input")[2].GetAttribute("value").Trim().Should().Be("Johanna");
283              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("23");
284              dataGrid.FindAll("td input")[4].GetAttribute("value").Trim().Should().Be("Steve");
285              Assert.IsNull(dataGrid.FindAll("td input")[5].GetAttribute("value"));
286              dataGrid.FindAll(".mud-table-body tr td input")[0].Change("Jonathan");
287              dataGrid.FindAll(".mud-table-body tr td input")[1].Change(52);
288              dataGrid.FindAll(".mud-table-body tr td input")[0].GetAttribute("value").Trim().Should().Be("Jonathan");
289              dataGrid.FindAll(".mud-table-body tr td input")[1].GetAttribute("value").Trim().Should().Be("52");
290              var name = dataGrid.Instance.Items.First().Name;
291              var age = dataGrid.Instance.Items.First().Age;
292              name.Should().Be("Jonathan");
293              age.Should().Be(52);
294          }
295          [Test]
296          public async Task DataGridInlineEditWithTemplateTest()
297          {
298              var comp = Context.RenderComponent<DataGridCellEditWithTemplateTest>();
299              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellEditWithTemplateTest.Model>>();
300              dataGrid.FindAll("td input")[0].GetAttribute("value").Trim().Should().Be("John");
301              dataGrid.FindAll("td input")[1].GetAttribute("value").Trim().Should().Be("45");
302              dataGrid.FindAll("td input")[2].HasAttribute("checked").Should().Be(false);
303              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("Johanna");
304              dataGrid.FindAll("td input")[4].GetAttribute("value").Trim().Should().Be("23");
305              dataGrid.FindAll("td input")[5].HasAttribute("checked").Should().Be(true);
306              dataGrid.FindAll("td input")[6].GetAttribute("value").Trim().Should().Be("Steve");
307              dataGrid.FindAll("td input")[7].GetAttribute("value").Trim().Should().Be("32");
308              dataGrid.FindAll("td input")[8].HasAttribute("value").Should().Be(false);
309              dataGrid.FindAll("td input")[0].Change("Jonathan");
310              dataGrid.FindAll("td input")[1].Change(52d);
311              dataGrid.FindAll("td input")[2].Change(true);
312              dataGrid.FindAll("td input")[0].GetAttribute("value").Trim().Should().Be("Jonathan");
313              dataGrid.FindAll("td input")[1].GetAttribute("value").Trim().Should().Be("52");
314              dataGrid.FindAll("td input")[2].HasAttribute("checked").Should().Be(true);
315              var name = dataGrid.Instance.Items.First().Name;
316              var age = dataGrid.Instance.Items.First().Age;
317              var hired = dataGrid.Instance.Items.First().Hired;
318              name.Should().Be("Jonathan");
319              age.Should().Be(52);
320              hired.Should().Be(true);
321          }
322          [Test]
323          public async Task DataGridDialogEditTest()
324          {
325              var comp = Context.RenderComponent<DataGridFormEditTest>();
326              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFormEditTest.Model>>();
327              dataGrid.FindAll("td")[0].Html().Trim().Should().Be("John");
328              dataGrid.FindAll("td")[1].Html().Trim().Should().Be("45");
329              dataGrid.FindAll("td")[2].Html().Trim().Should().Be("snakex64");
330              dataGrid.FindAll("td")[3].Html().Trim().Should().Be("Johanna");
331              dataGrid.FindAll("td")[4].Html().Trim().Should().Be("23");
332              dataGrid.FindAll("td")[5].Html().Trim().Should().Be("snakex64");
333              dataGrid.FindAll("td")[6].Html().Trim().Should().Be("Steve");
334              dataGrid.FindAll("td")[7].Html().Trim().Should().Be("32");
335              dataGrid.FindAll("td")[8].Html().Trim().Should().Be("snakex64");
336              dataGrid.FindAll("tbody tr")[1].Click();
337              comp.FindAll("div input")[0].Change("Galadriel");
338              comp.FindAll("div input")[1].Change(1);
339              comp.Find(".mud-dialog-actions .mud-button-filled-primary").Click();
340              dataGrid.FindAll("td")[0].Html().Trim().Should().Be("John");
341              dataGrid.FindAll("td")[1].Html().Trim().Should().Be("45");
342              dataGrid.FindAll("td")[2].Html().Trim().Should().Be("snakex64");
343              dataGrid.FindAll("td")[3].Html().Trim().Should().Be("Galadriel");
344              dataGrid.FindAll("td")[4].Html().Trim().Should().Be("1");
345              dataGrid.FindAll("td")[5].Html().Trim().Should().Be("snakex64");
346              dataGrid.FindAll("td")[6].Html().Trim().Should().Be("Steve");
347              dataGrid.FindAll("td")[7].Html().Trim().Should().Be("32");
348              dataGrid.FindAll("td")[8].Html().Trim().Should().Be("snakex64");
349          }
350          [Test]
351          public async Task DataGridFormFieldChangedTest()
352          {
353              var comp = Context.RenderComponent<DataGridFormFieldChangedTest>();
354              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFormFieldChangedTest.Item>>();
355              dataGrid.FindAll("tbody tr")[0].Click();
356              comp.Find("div input").Change("J K Simmons");
357              comp.Instance.FormFieldChangedEventArgs.NewValue.Should().Be("J K Simmons");
358              var textfield = comp.FindComponent<MudTextField<string>>();
359              Assert.AreSame(comp.Instance.FormFieldChangedEventArgs.Field, textfield.Instance);
360          }
361          [Test]
362          public async Task DataGridVisualStylingTest()
363          {
364              var comp = Context.RenderComponent<DataGridVisualStylingTest>();
365              var dataGrid = comp.FindComponent<MudDataGrid<DataGridVisualStylingTest.Item>>();
366              dataGrid.FindAll("td")[1].GetAttribute("style").Should().Contain("background-color:#E5BDE5");
367              dataGrid.FindAll("td")[2].GetAttribute("style").Should().Contain("font-weight:bold");
368          }
369          [Test]
370          [Obsolete]
371          public async Task DataGridEventCallbacksTest()
372          {
373              var comp = Context.RenderComponent<DataGridEventCallbacksTest>();
374              var dataGrid = comp.FindComponent<MudDataGrid<DataGridEventCallbacksTest.Item>>();
375              dataGrid.Instance.RowClick.HasDelegate.Should().Be(true);
376              dataGrid.Instance.SelectedItemChanged.HasDelegate.Should().Be(true);
377              dataGrid.Instance.CommittedItemChanges.HasDelegate.Should().Be(true);
378              dataGrid.Instance.StartedEditingItem.HasDelegate.Should().Be(true);
379              dataGrid.Instance.CancelledEditingItem.HasDelegate.Should().Be(true);
380              dataGrid.Instance.CancelledEditingItem.Should().Be(dataGrid.Instance.CancelledEditingItem);
381              var cancelCallback = dataGrid.Instance.CancelledEditingItem;
382              dataGrid.SetCallback(dg => dg.CancelledEditingItem, x => { return; });
383              dataGrid.Instance.CancelledEditingItem.Should().NotBe(cancelCallback);
384              dataGrid.Instance.CancelledEditingItem = cancelCallback;
385              dataGrid.Instance.CancelledEditingItem.Should().Be(cancelCallback);
386              var parameters = new List<ComponentParameter>();
387              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.MultiSelection), true));
388              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.ReadOnly), false));
389              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.EditMode), DataGridEditMode.Cell));
390              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.EditTrigger), DataGridEditTrigger.OnRowClick));
391              dataGrid.SetParametersAndRender(parameters.ToArray());
392              comp.Instance.RowClicked.Should().Be(false);
393              comp.Instance.SelectedItemChanged.Should().Be(false);
394              comp.Instance.CommittedItemChanges.Should().Be(false);
395              comp.Instance.StartedEditingItem.Should().Be(false);
396              comp.Instance.CanceledEditingItem.Should().Be(false);
397              dataGrid.FindAll(".mud-table-body tr")[0].Click();
398              dataGrid.FindAll(".mud-table-body tr td input")[0].Change("A test");
399              comp.Instance.RowClicked.Should().Be(true);
400              comp.Instance.SelectedItemChanged.Should().Be(true);
401              comp.Instance.CommittedItemChanges.Should().Be(true);
402              comp.Instance.CanceledEditingItem.Should().Be(false);
403              await dataGrid.InvokeAsync(dataGrid.Instance.CancelEditingItemAsync);
404              comp.Instance.CanceledEditingItem.Should().Be(true);
405          }
406          [Test]
407          public async Task DataGridServerSideSortableTest()
408          {
409              TestComponents.DataGridServerSideSortableTest.DisableServerTimeoutForTests = true;
410              var comp = Context.RenderComponent<DataGridServerSideSortableTest>();
411              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerSideSortableTest.Item>>();
412              var cells = dataGrid.FindAll("td");
413              cells.Count.Should().Be(21, because: "We have 7 data rows with three columns");
414              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
415              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
416              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
417              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
418              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
419              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
420              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
421              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => { return x.Name; }));
422              cells = dataGrid.FindAll("td");
423              cells[0].TextContent.Should().Be("A"); cells[1].TextContent.Should().Be("73"); cells[2].TextContent.Should().Be("7");
424              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("11"); cells[5].TextContent.Should().Be("4444");
425              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("99"); cells[8].TextContent.Should().Be("66");
426              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
427              cells[12].TextContent.Should().Be("C"); cells[13].TextContent.Should().Be("33"); cells[14].TextContent.Should().Be("33333");
428              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
429              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
430              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Descending, x => { return x.Name; }));
431              cells = dataGrid.FindAll("td");
432              cells[0].TextContent.Should().Be("C"); cells[1].TextContent.Should().Be("33"); cells[2].TextContent.Should().Be("33333");
433              cells[3].TextContent.Should().Be("C"); cells[4].TextContent.Should().Be("44"); cells[5].TextContent.Should().Be("1111111");
434              cells[6].TextContent.Should().Be("C"); cells[7].TextContent.Should().Be("55"); cells[8].TextContent.Should().Be("222222");
435              cells[9].TextContent.Should().Be("B"); cells[10].TextContent.Should().Be("42"); cells[11].TextContent.Should().Be("555");
436              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("73"); cells[14].TextContent.Should().Be("7");
437              cells[15].TextContent.Should().Be("A"); cells[16].TextContent.Should().Be("11"); cells[17].TextContent.Should().Be("4444");
438              cells[18].TextContent.Should().Be("A"); cells[19].TextContent.Should().Be("99"); cells[20].TextContent.Should().Be("66");
439              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync("Name"));
440              cells = dataGrid.FindAll("td");
441              cells[0].TextContent.Should().Be("B"); cells[1].TextContent.Should().Be("42"); cells[2].TextContent.Should().Be("555");
442              cells[3].TextContent.Should().Be("A"); cells[4].TextContent.Should().Be("73"); cells[5].TextContent.Should().Be("7");
443              cells[6].TextContent.Should().Be("A"); cells[7].TextContent.Should().Be("11"); cells[8].TextContent.Should().Be("4444");
444              cells[9].TextContent.Should().Be("C"); cells[10].TextContent.Should().Be("33"); cells[11].TextContent.Should().Be("33333");
445              cells[12].TextContent.Should().Be("A"); cells[13].TextContent.Should().Be("99"); cells[14].TextContent.Should().Be("66");
446              cells[15].TextContent.Should().Be("C"); cells[16].TextContent.Should().Be("44"); cells[17].TextContent.Should().Be("1111111");
447              cells[18].TextContent.Should().Be("C"); cells[19].TextContent.Should().Be("55"); cells[20].TextContent.Should().Be("222222");
448              await comp.InvokeAsync(() => dataGrid.Instance.SortMode = SortMode.None);
449              dataGrid.Render();
450              dataGrid.Instance.DropContainerHasChanged();
451              dataGrid.FindAll(".column-header .sortable-column-header").Should().BeEmpty();
452          }
453          [Test]
454          public async Task FilterDefinitionStringTest()
455          {
456              var comp = Context.RenderComponent<DataGridFiltersTest>();
457              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
458              var nameColumn = dataGrid.Instance.GetColumnByPropertyName("Name");
459              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>();
460              Func<DataGridFiltersTest.Model, bool> func = null;
461              #region FilterOperator.String.Contains
462              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
463              {
464                  Column = nameColumn,
465                  Operator = FilterOperator.String.Contains,
466                  Value = "Joe",
467                  DataGrid = dataGrid.Instance
468              };
469              func = filterDefinition.GenerateFilterFunction();
470              Assert.IsFalse(func.Invoke(new("Does not contain", 45, null, null, null)));
471              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
472              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
473              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
474              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
475              {
476                  Column = nameColumn,
477                  Operator = FilterOperator.String.Contains,
478                  Value = "Joe",
479                  DataGrid = dataGrid.Instance
480              };
481              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
482              func = filterDefinition.GenerateFilterFunction();
483              Assert.IsFalse(func.Invoke(new("Does not contain", 45, null, null, null)));
484              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
485              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
486              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
487              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
488              {
489                  Column = nameColumn,
490                  Operator = FilterOperator.String.Contains,
491                  Value = null,
492                  DataGrid = dataGrid.Instance
493              };
494              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
495              func = filterDefinition.GenerateFilterFunction();
496              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
497              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
498              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
499              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
500              {
501                  Column = nameColumn,
502                  Operator = FilterOperator.String.Contains,
503                  Value = null,
504                  DataGrid = dataGrid.Instance
505              };
506              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
507              func = filterDefinition.GenerateFilterFunction();
508              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
509              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
510              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
511              #endregion
512              #region FilterOperator.String.NotContains
513              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
514              {
515                  Column = nameColumn,
516                  Operator = FilterOperator.String.NotContains,
517                  Value = "Joe",
518                  DataGrid = dataGrid.Instance
519              };
520              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
521              func = filterDefinition.GenerateFilterFunction();
522              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
523              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
524              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
525              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
526              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
527              {
528                  Column = nameColumn,
529                  Operator = FilterOperator.String.NotContains,
530                  Value = "Joe",
531                  DataGrid = dataGrid.Instance
532              };
533              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
534              func = filterDefinition.GenerateFilterFunction();
535              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
536              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
537              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
538              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
539              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
540              {
541                  Column = nameColumn,
542                  Operator = FilterOperator.String.NotContains,
543                  Value = null,
544                  DataGrid = dataGrid.Instance
545              };
546              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
547              func = filterDefinition.GenerateFilterFunction();
548              Assert.IsTrue(func.Invoke(new("Does not contain", 45, null, null, null)));
549              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
550              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
551              #endregion
552              #region FilterOperator.String.Equal
553              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
554              {
555                  Column = nameColumn,
556                  Operator = FilterOperator.String.Equal,
557                  Value = "Joe",
558                  DataGrid = dataGrid.Instance
559              };
560              func = filterDefinition.GenerateFilterFunction();
561              Assert.IsFalse(func.Invoke(new("Not Joe", 45, null, null, null)));
562              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
563              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
564              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
565              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
566              {
567                  Column = nameColumn,
568                  Operator = FilterOperator.String.Equal,
569                  Value = "Joe",
570                  DataGrid = dataGrid.Instance
571              };
572              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
573              func = filterDefinition.GenerateFilterFunction();
574              Assert.IsFalse(func.Invoke(new("Not Joe", 45, null, null, null)));
575              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
576              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
577              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
578              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
579              {
580                  Column = nameColumn,
581                  Operator = FilterOperator.String.Equal,
582                  Value = null,
583                  DataGrid = dataGrid.Instance
584              };
585              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
586              func = filterDefinition.GenerateFilterFunction();
587              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
588              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
589              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
590              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
591              {
592                  Column = nameColumn,
593                  Operator = FilterOperator.String.Equal,
594                  Value = null,
595                  DataGrid = dataGrid.Instance
596              };
597              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
598              func = filterDefinition.GenerateFilterFunction();
599              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
600              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
601              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
602              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
603              #endregion
604              #region FilterOperator.String.NotEqual
605              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
606              {
607                  Column = nameColumn,
608                  Operator = FilterOperator.String.NotEqual,
609                  Value = "Joe",
610                  DataGrid = dataGrid.Instance
611              };
612              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
613              func = filterDefinition.GenerateFilterFunction();
614              Assert.IsTrue(func.Invoke(new("Not Joe", 45, null, null, null)));
615              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
616              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
617              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
618              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
619              {
620                  Column = nameColumn,
621                  Operator = FilterOperator.String.NotEqual,
622                  Value = "Joe",
623                  DataGrid = dataGrid.Instance
624              };
625              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
626              func = filterDefinition.GenerateFilterFunction();
627              Assert.IsTrue(func.Invoke(new("Not Joe", 45, null, null, null)));
628              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
629              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
630              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
631              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
632              {
633                  Column = nameColumn,
634                  Operator = FilterOperator.String.NotEqual,
635                  Value = null,
636                  DataGrid = dataGrid.Instance
637              };
638              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
639              func = filterDefinition.GenerateFilterFunction();
640              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
641              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
642              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
643              #endregion
644              #region FilterOperator.String.StartsWith
645              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
646              {
647                  Column = nameColumn,
648                  Operator = FilterOperator.String.StartsWith,
649                  Value = "Joe",
650                  DataGrid = dataGrid.Instance
651              };
652              func = filterDefinition.GenerateFilterFunction();
653              Assert.IsFalse(func.Invoke(new("Not Joe", 45, null, null, null)));
654              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
655              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
656              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
657              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
658              {
659                  Column = nameColumn,
660                  Operator = FilterOperator.String.StartsWith,
661                  Value = "Joe",
662                  DataGrid = dataGrid.Instance
663              };
664              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
665              func = filterDefinition.GenerateFilterFunction();
666              Assert.IsFalse(func.Invoke(new("Not Joe", 45, null, null, null)));
667              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
668              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
669              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
670              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
671              {
672                  Column = nameColumn,
673                  Operator = FilterOperator.String.StartsWith,
674                  Value = null,
675                  DataGrid = dataGrid.Instance
676              };
677              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
678              func = filterDefinition.GenerateFilterFunction();
679              Assert.IsTrue(func.Invoke(new("Not Joe", 45, null, null, null)));
680              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
681              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
682              #endregion
683              #region FilterOperator.String.EndsWith
684              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
685              {
686                  Column = nameColumn,
687                  Operator = FilterOperator.String.EndsWith,
688                  Value = "Joe",
689                  DataGrid = dataGrid.Instance
690              };
691              func = filterDefinition.GenerateFilterFunction();
692              Assert.IsFalse(func.Invoke(new("Joe Not", 45, null, null, null)));
693              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
694              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
695              Assert.IsFalse(func.Invoke(new("joe", 45, null, null, null)));
696              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
697              {
698                  Column = nameColumn,
699                  Operator = FilterOperator.String.EndsWith,
700                  Value = "Joe",
701                  DataGrid = dataGrid.Instance
702              };
703              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.CaseInsensitive;
704              func = filterDefinition.GenerateFilterFunction();
705              Assert.IsFalse(func.Invoke(new("Joe Not", 45, null, null, null)));
706              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
707              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
708              Assert.IsTrue(func.Invoke(new("joe", 45, null, null, null)));
709              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
710              {
711                  Column = nameColumn,
712                  Operator = FilterOperator.String.EndsWith,
713                  Value = null,
714                  DataGrid = dataGrid.Instance
715              };
716              filterDefinition.DataGrid.FilterCaseSensitivity = DataGridFilterCaseSensitivity.Default;
717              func = filterDefinition.GenerateFilterFunction();
718              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
719              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
720              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
721              #endregion
722              #region FilterOperator.String.Empty
723              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
724              {
725                  Column = nameColumn,
726                  Operator = FilterOperator.String.Empty,
727                  Value = null,
728                  DataGrid = dataGrid.Instance
729              };
730              func = filterDefinition.GenerateFilterFunction();
731              Assert.IsFalse(func.Invoke(new("Joe Not", 45, null, null, null)));
732              Assert.IsTrue(func.Invoke(new("", 45, null, null, null)));
733              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
734              Assert.IsTrue(func.Invoke(new(String.Empty, 45, null, null, null)));
735              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
736              {
737                  Column = nameColumn,
738                  Operator = FilterOperator.String.NotEmpty,
739                  Value = null,
740                  DataGrid = dataGrid.Instance
741              };
742              func = filterDefinition.GenerateFilterFunction();
743              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
744              Assert.IsFalse(func.Invoke(new("", 45, null, null, null)));
745              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
746              Assert.IsFalse(func.Invoke(new(String.Empty, 45, null, null, null)));
747              #endregion
748              #region FilterOperator.String.NotEmpty
749              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
750              {
751                  Column = nameColumn,
752                  Operator = FilterOperator.String.NotEmpty,
753                  Value = null,
754                  DataGrid = dataGrid.Instance
755              };
756              func = filterDefinition.GenerateFilterFunction();
757              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
758              Assert.IsFalse(func.Invoke(new("", 45, null, null, null)));
759              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
760              Assert.IsFalse(func.Invoke(new(String.Empty, 45, null, null, null)));
761              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
762              {
763                  Column = nameColumn,
764                  Operator = FilterOperator.String.NotEmpty,
765                  Value = null,
766                  DataGrid = dataGrid.Instance
767              };
768              func = filterDefinition.GenerateFilterFunction();
769              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
770              Assert.IsFalse(func.Invoke(new("", 45, null, null, null)));
771              Assert.IsFalse(func.Invoke(new(null, 45, null, null, null)));
772              Assert.IsFalse(func.Invoke(new(String.Empty, 45, null, null, null)));
773              #endregion
774              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
775              {
776                  Column = nameColumn,
777                  Operator = null,
778                  Value = "Joe",
779                  DataGrid = dataGrid.Instance
780              };
781              func = filterDefinition.GenerateFilterFunction();
782              Assert.IsTrue(func.Invoke(new("Joe Not", 45, null, null, null)));
783              Assert.IsTrue(func.Invoke(new(null, 45, null, null, null)));
784              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
785          }
786          [Test]
787          public async Task FilterDefinitionBoolTest()
788          {
789              var comp = Context.RenderComponent<DataGridFiltersTest>();
790              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
791              var hiredColumn = dataGrid.Instance.GetColumnByPropertyName("Hired");
792              #region FilterOperator.Boolean.Is
793              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
794              {
795                  Column = hiredColumn,
796                  Operator = FilterOperator.Boolean.Is,
797                  Value = true
798              };
799              var func = filterDefinition.GenerateFilterFunction();
800              Assert.IsFalse(func.Invoke(new("Sam", 45, null, false, null)));
801              Assert.IsTrue(func.Invoke(new("Joe", 45, null, true, null)));
802              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
803              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
804              {
805                  Column = hiredColumn,
806                  Operator = FilterOperator.Boolean.Is,
807                  Value = null
808              };
809              func = filterDefinition.GenerateFilterFunction();
810              Assert.IsTrue(func.Invoke(new("Sam", 45, null, false, null)));
811              Assert.IsTrue(func.Invoke(new("Joe", 45, null, true, null)));
812              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
813              #endregion
814              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
815              {
816                  Column = hiredColumn,
817                  Operator = null,
818                  Value = true
819              };
820              func = filterDefinition.GenerateFilterFunction();
821              Assert.IsTrue(func.Invoke(new("Sam", 45, null, false, null)));
822              Assert.IsTrue(func.Invoke(new("Joe", 45, null, true, null)));
823              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
824          }
825          [Test]
826          public async Task FilterDefinitionEnumTest()
827          {
828              var comp = Context.RenderComponent<DataGridFiltersTest>();
829              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
830              var statusColumn = dataGrid.Instance.GetColumnByPropertyName("Status");
831              #region FilterOperator.Enum.Is
832              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
833              {
834                  Column = statusColumn,
835                  Operator = FilterOperator.Enum.Is,
836                  Value = Severity.Normal
837              };
838              var func = filterDefinition.GenerateFilterFunction();
839              Assert.IsFalse(func.Invoke(new("Sam", 456, Severity.Info, null, null)));
840              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Normal, null, null)));
841              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
842              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
843              {
844                  Column = statusColumn,
845                  Operator = FilterOperator.Enum.Is,
846                  Value = null
847              };
848              func = filterDefinition.GenerateFilterFunction();
849              Assert.IsTrue(func.Invoke(new("Sam", 456, Severity.Info, null, null)));
850              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Normal, null, null)));
851              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
852              #endregion
853              #region FilterOperator.Enum.IsNot
854              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
855              {
856                  Column = statusColumn,
857                  Operator = FilterOperator.Enum.IsNot,
858                  Value = Severity.Normal
859              };
860              func = filterDefinition.GenerateFilterFunction();
861              Assert.IsFalse(func.Invoke(new("Sam", 456, Severity.Normal, null, null)));
862              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Info, null, null)));
863              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
864              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
865              {
866                  Column = statusColumn,
867                  Operator = FilterOperator.Enum.IsNot,
868                  Value = null
869              };
870              func = filterDefinition.GenerateFilterFunction();
871              Assert.IsTrue(func.Invoke(new("Sam", 456, Severity.Normal, null, null)));
872              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Info, null, null)));
873              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
874              #endregion
875              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
876              {
877                  Column = statusColumn,
878                  Operator = null,
879                  Value = Severity.Normal
880              };
881              func = filterDefinition.GenerateFilterFunction();
882              Assert.IsTrue(func.Invoke(new("Sam", 456, Severity.Normal, null, null)));
883              Assert.IsTrue(func.Invoke(new("Joe", 45, Severity.Info, null, null)));
884              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
885          }
886          [Test]
887          public async Task FilterDefinitionDateTimeTest()
888          {
889              var comp = Context.RenderComponent<DataGridFiltersTest>();
890              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
891              var dateColumn = dataGrid.Instance.GetColumnByPropertyName("HiredOn");
892              var utcnow = DateTime.UtcNow;
893              #region FilterOperator.DateTime.Is
894              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
895              {
896                  Column = dateColumn,
897                  Operator = FilterOperator.DateTime.Is,
898                  Value = utcnow
899              };
900              var func = filterDefinition.GenerateFilterFunction();
901              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
902              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
903              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
904              {
905                  Column = dateColumn,
906                  Operator = FilterOperator.DateTime.Is,
907                  Value = null
908              };
909              func = filterDefinition.GenerateFilterFunction();
910              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
911              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
912              #endregion
913              #region FilterOperator.DateTime.IsNot
914              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
915              {
916                  Column = dateColumn,
917                  Operator = FilterOperator.DateTime.IsNot,
918                  Value = utcnow
919              };
920              func = filterDefinition.GenerateFilterFunction();
921              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
922              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
923              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
924              {
925                  Column = dateColumn,
926                  Operator = FilterOperator.DateTime.IsNot,
927                  Value = null
928              };
929              func = filterDefinition.GenerateFilterFunction();
930              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
931              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
932              #endregion
933              #region FilterOperator.DateTime.After
934              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
935              {
936                  Column = dateColumn,
937                  Operator = FilterOperator.DateTime.After,
938                  Value = utcnow
939              };
940              func = filterDefinition.GenerateFilterFunction();
941              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
942              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
943              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
944              {
945                  Column = dateColumn,
946                  Operator = FilterOperator.DateTime.After,
947                  Value = null
948              };
949              func = filterDefinition.GenerateFilterFunction();
950              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
951              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
952              #endregion
953              #region FilterOperator.DateTime.OnOrAfter
954              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
955              {
956                  Column = dateColumn,
957                  Operator = FilterOperator.DateTime.OnOrAfter,
958                  Value = utcnow
959              };
960              func = filterDefinition.GenerateFilterFunction();
961              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
962              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
963              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
964              {
965                  Column = dateColumn,
966                  Operator = FilterOperator.DateTime.OnOrAfter,
967                  Value = null
968              };
969              func = filterDefinition.GenerateFilterFunction();
970              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
971              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
972              #endregion
973              #region FilterOperator.DateTime.Before
974              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
975              {
976                  Column = dateColumn,
977                  Operator = FilterOperator.DateTime.Before,
978                  Value = utcnow
979              };
980              func = filterDefinition.GenerateFilterFunction();
981              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
982              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
983              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
984              {
985                  Column = dateColumn,
986                  Operator = FilterOperator.DateTime.Before,
987                  Value = null
988              };
989              func = filterDefinition.GenerateFilterFunction();
990              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
991              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
992              #endregion
993              #region FilterOperator.DateTime.OnOrBefore
994              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
995              {
996                  Column = dateColumn,
997                  Operator = FilterOperator.DateTime.OnOrBefore,
998                  Value = utcnow
999              };
1000              func = filterDefinition.GenerateFilterFunction();
1001              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1002              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
1003              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1004              {
1005                  Column = dateColumn,
1006                  Operator = FilterOperator.DateTime.OnOrBefore,
1007                  Value = null
1008              };
1009              func = filterDefinition.GenerateFilterFunction();
1010              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1011              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1012              #endregion
1013              #region FilterOperator.DateTime.Empty
1014              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1015              {
1016                  Column = dateColumn,
1017                  Operator = FilterOperator.DateTime.Empty,
1018                  Value = utcnow
1019              };
1020              func = filterDefinition.GenerateFilterFunction();
1021              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
1022              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1023              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1024              {
1025                  Column = dateColumn,
1026                  Operator = FilterOperator.DateTime.Empty,
1027                  Value = null
1028              };
1029              func = filterDefinition.GenerateFilterFunction();
1030              Assert.IsFalse(func.Invoke(new("Sam", 45, null, null, utcnow)));
1031              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1032              #endregion
1033              #region FilterOperator.DateTime.NotEmpty
1034              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1035              {
1036                  Column = dateColumn,
1037                  Operator = FilterOperator.DateTime.NotEmpty,
1038                  Value = utcnow
1039              };
1040              func = filterDefinition.GenerateFilterFunction();
1041              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1042              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
1043              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1044              {
1045                  Column = dateColumn,
1046                  Operator = FilterOperator.DateTime.NotEmpty,
1047                  Value = null
1048              };
1049              func = filterDefinition.GenerateFilterFunction();
1050              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1051              Assert.IsFalse(func.Invoke(new("Joe", 45, null, null, null)));
1052              #endregion
1053              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1054              {
1055                  Column = dateColumn,
1056                  Operator = null,
1057                  Value = utcnow
1058              };
1059              func = filterDefinition.GenerateFilterFunction();
1060              Assert.IsTrue(func.Invoke(new("Sam", 45, null, null, utcnow)));
1061              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1062          }
1063          [Test]
1064          public async Task FilterDefinitionNumberTest()
1065          {
1066              var comp = Context.RenderComponent<DataGridFiltersTest>();
1067              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
1068              var ageColumn = dataGrid.Instance.GetColumnByPropertyName("Age");
1069              #region FilterOperator.Number.Equal
1070              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1071              {
1072                  Column = ageColumn,
1073                  Operator = FilterOperator.Number.Equal,
1074                  Value = 45
1075              };
1076              var func = filterDefinition.GenerateFilterFunction();
1077              Assert.IsFalse(func.Invoke(new("Sam", 456, null, null, null)));
1078              Assert.IsFalse(func.Invoke(new("Sam", null, null, null, null)));
1079              Assert.IsTrue(func.Invoke(new("Joe", 45, null, null, null)));
1080              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1081              {
1082                  Column = ageColumn,
1083                  Operator = FilterOperator.Number.Equal,
1084                  Value = null
1085              };
1086              var func2 = filterDefinition.GenerateFilterFunction();
1087              Assert.IsTrue(func2.Invoke(new("Sam", 456, null, null, null)));
1088              Assert.IsTrue(func2.Invoke(new("Sam", null, null, null, null)));
1089              Assert.IsTrue(func2.Invoke(new("Joe", 45, null, null, null)));
1090              #endregion
1091              #region FilterOperator.Number.NotEqual
1092              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1093              {
1094                  Column = ageColumn,
1095                  Operator = FilterOperator.Number.NotEqual,
1096                  Value = 45
1097              };
1098              var func3 = filterDefinition.GenerateFilterFunction();
1099              Assert.IsTrue(func3.Invoke(new("Sam", 456, null, null, null)));
1100              Assert.IsTrue(func3.Invoke(new("Sam", null, null, null, null)));
1101              Assert.IsFalse(func3.Invoke(new("Joe", 45, null, null, null)));
1102              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1103              {
1104                  Column = ageColumn,
1105                  Operator = FilterOperator.Number.NotEqual,
1106                  Value = null
1107              };
1108              var func4 = filterDefinition.GenerateFilterFunction();
1109              Assert.IsTrue(func4.Invoke(new("Sam", 456, null, null, null)));
1110              Assert.IsTrue(func4.Invoke(new("Sam", null, null, null, null)));
1111              Assert.IsTrue(func4.Invoke(new("Joe", 45, null, null, null)));
1112              #endregion
1113              #region FilterOperator.Number.GreaterThan
1114              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1115              {
1116                  Column = ageColumn,
1117                  Operator = FilterOperator.Number.GreaterThan,
1118                  Value = 45
1119              };
1120              var func5 = filterDefinition.GenerateFilterFunction();
1121              Assert.IsTrue(func5.Invoke(new("Sam", 456, null, null, null)));
1122              Assert.IsFalse(func5.Invoke(new("Joe", 45, null, null, null)));
1123              Assert.IsFalse(func5.Invoke(new("Joe", null, null, null, null)));
1124              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1125              {
1126                  Column = ageColumn,
1127                  Operator = FilterOperator.Number.GreaterThan,
1128                  Value = null
1129              };
1130              var func6 = filterDefinition.GenerateFilterFunction();
1131              Assert.IsTrue(func6.Invoke(new("Sam", 456, null, null, null)));
1132              Assert.IsTrue(func6.Invoke(new("Joe", 45, null, null, null)));
1133              Assert.IsTrue(func6.Invoke(new("Joe", null, null, null, null)));
1134              #endregion
1135              #region FilterOperator.Number.LessThan
1136              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1137              {
1138                  Column = ageColumn,
1139                  Operator = FilterOperator.Number.LessThan,
1140                  Value = 45
1141              };
1142              var func7 = filterDefinition.GenerateFilterFunction();
1143              Assert.IsTrue(func7.Invoke(new("Sam", 4, null, null, null)));
1144              Assert.IsFalse(func7.Invoke(new("Joe", 45, null, null, null)));
1145              Assert.IsFalse(func7.Invoke(new("Joe", null, null, null, null)));
1146              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1147              {
1148                  Column = ageColumn,
1149                  Operator = FilterOperator.Number.LessThan,
1150                  Value = null
1151              };
1152              var func8 = filterDefinition.GenerateFilterFunction();
1153              Assert.IsTrue(func8.Invoke(new("Sam", 4, null, null, null)));
1154              Assert.IsTrue(func8.Invoke(new("Joe", 45, null, null, null)));
1155              Assert.IsTrue(func8.Invoke(new("Joe", null, null, null, null)));
1156              #endregion
1157              #region FilterOperator.Number.GreaterThanOrEqual
1158              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1159              {
1160                  Column = ageColumn,
1161                  Operator = FilterOperator.Number.GreaterThanOrEqual,
1162                  Value = 45
1163              };
1164              var func9 = filterDefinition.GenerateFilterFunction();
1165              Assert.IsFalse(func9.Invoke(new("Sam", 4, null, null, null)));
1166              Assert.IsFalse(func9.Invoke(new("Sam", null, null, null, null)));
1167              Assert.IsTrue(func9.Invoke(new("Joe", 45, null, null, null)));
1168              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1169              {
1170                  Column = ageColumn,
1171                  Operator = FilterOperator.Number.GreaterThanOrEqual,
1172                  Value = null
1173              };
1174              var func10 = filterDefinition.GenerateFilterFunction();
1175              Assert.IsTrue(func10.Invoke(new("Sam", 4, null, null, null)));
1176              Assert.IsTrue(func10.Invoke(new("Sam", null, null, null, null)));
1177              Assert.IsTrue(func10.Invoke(new("Joe", 45, null, null, null)));
1178              #endregion
1179              #region FilterOperator.Number.LessThanOrEqual
1180              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1181              {
1182                  Column = ageColumn,
1183                  Operator = FilterOperator.Number.LessThanOrEqual,
1184                  Value = 45
1185              };
1186              var func11 = filterDefinition.GenerateFilterFunction();
1187              Assert.IsFalse(func11.Invoke(new("Sam", 46, null, null, null)));
1188              Assert.IsFalse(func11.Invoke(new("Sam", null, null, null, null)));
1189              Assert.IsTrue(func11.Invoke(new("Joe", 45, null, null, null)));
1190              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1191              {
1192                  Column = ageColumn,
1193                  Operator = FilterOperator.Number.LessThanOrEqual,
1194                  Value = null
1195              };
1196              var func12 = filterDefinition.GenerateFilterFunction();
1197              Assert.IsTrue(func12.Invoke(new("Sam", 46, null, null, null)));
1198              Assert.IsTrue(func12.Invoke(new("Sam", null, null, null, null)));
1199              Assert.IsTrue(func12.Invoke(new("Joe", 45, null, null, null)));
1200              #endregion
1201              filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1202              {
1203                  Column = ageColumn,
1204                  Operator = null,
1205                  Value = 45
1206              };
1207              var func13 = filterDefinition.GenerateFilterFunction();
1208              Assert.IsTrue(func13.Invoke(new("Sam", 456, null, null, null)));
1209              Assert.IsTrue(func13.Invoke(new("Sam", null, null, null, null)));
1210              Assert.IsTrue(func13.Invoke(new("Joe", 45, null, null, null)));
1211          }
1212          [Test]
1213          public async Task FilterDefinitionReplaceWithCustom()
1214          {
1215              var comp = Context.RenderComponent<DataGridFiltersTest>();
1216              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
1217              dataGrid.Instance.SetDefaultFilterDefinition<CustomFilterDefinitionMock<DataGridFiltersTest.Model>>();
1218              await comp.InvokeAsync(() => dataGrid.Instance.OpenFilters());
1219              await comp.InvokeAsync(() => dataGrid.Instance.AddFilter());
1220              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(1);
1221              var filterDefinitionInstance = dataGrid.Instance.FilterDefinitions.FirstOrDefault();
1222              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1223              filterDefinitionInstance.Should().NotBeNull();
1224              filterDefinitionInstance.Should().BeOfType<CustomFilterDefinitionMock<DataGridFiltersTest.Model>>();
1225          }
1226          [Test]
1227          public async Task DataGridFiltersTest()
1228          {
1229              var comp = Context.RenderComponent<DataGridFiltersTest>();
1230              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFiltersTest.Model>>();
1231              var filterDefinition = new FilterDefinition<DataGridFiltersTest.Model>
1232              {
1233                  Column = dataGrid.Instance.GetColumnByPropertyName("Name"),
1234                  Operator = "contains",
1235                  Value = "John"
1236              };
1237              var filterDefinition2 = new FilterDefinition<DataGridFiltersTest.Model>
1238              {
1239                  Column = dataGrid.Instance.GetColumnByPropertyName("Age"),
1240                  Operator = ">",
1241                  Value = 30
1242              };
1243              var filterDefinition3 = new FilterDefinition<DataGridFiltersTest.Model>
1244              {
1245                  Column = dataGrid.Instance.GetColumnByPropertyName("Status"),
1246                  Operator = "is",
1247                  Value = Severity.Normal
1248              };
1249              var filterDefinition4 = new FilterDefinition<DataGridFiltersTest.Model>
1250              {
1251                  Column = dataGrid.Instance.GetColumnByPropertyName("Hired"),
1252                  Operator = "is",
1253                  Value = true
1254              };
1255              var filterDefinition5 = new FilterDefinition<DataGridFiltersTest.Model>
1256              {
1257                  Column = dataGrid.Instance.GetColumnByPropertyName("HiredOn"),
1258                  Operator = "is",
1259                  Value = DateTime.UtcNow.Date
1260              };
1261              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition));
1262              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition2));
1263              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition3));
1264              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition4));
1265              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(filterDefinition5));
1266              await comp.InvokeAsync(() => dataGrid.Instance.OpenFilters());
1267              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(5);
1268              dataGrid.FindAll(".filters-panel > button")[0].Click();
1269              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(6);
1270              await comp.InvokeAsync(() => dataGrid.Instance.AddFilter());
1271              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(7);
1272              await comp.InvokeAsync(() => dataGrid.Instance.AddFilterAsync(new FilterDefinition<DataGridFiltersTest.Model>
1273              {
1274                  Column = dataGrid.Instance.RenderedColumns.FirstOrDefault(x => x.PropertyName == "Status")
1275              }));
1276              dataGrid.FindAll(".filters-panel .mud-grid-item.d-flex").Count.Should().Be(8);
1277              await comp.InvokeAsync(() => dataGrid.Instance.ToggleFiltersMenu());
1278              dataGrid.FindAll(".filters-panel").Count.Should().Be(0);
1279              var internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition, null);
1280              filterDefinition.Column.dataType.Should().Be(typeof(string));
1281              await comp.InvokeAsync(() => internalFilter.StringValueChanged("J"));
1282              filterDefinition.Value.Should().Be("J");
1283              internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition2, null);
1284              filterDefinition2.Column.dataType.Should().Be(typeof(int?));
1285              await comp.InvokeAsync(() => internalFilter.NumberValueChanged(35));
1286              filterDefinition2.Value.Should().Be(35);
1287              internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition3, null);
1288              filterDefinition3.Column.dataType.Should().Be(typeof(Severity?));
1289              await comp.InvokeAsync(() => internalFilter.NumberValueChanged(35));
1290              filterDefinition3.Value.Should().Be(35);
1291              filterDefinition3.FieldType.IsEnum.Should().Be(true);
1292              internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition4, null);
1293              filterDefinition4.Column.dataType.Should().Be(typeof(bool?));
1294              await comp.InvokeAsync(() => internalFilter.BoolValueChanged(false));
1295              filterDefinition4.Value.Should().Be(false);
1296              var date = DateTime.UtcNow;
1297              internalFilter = new Filter<DataGridFiltersTest.Model>(dataGrid.Instance, filterDefinition5, null);
1298              filterDefinition5.Column.dataType.Should().Be(typeof(DateTime?));
1299              await comp.InvokeAsync(() => internalFilter.DateValueChanged(date));
1300              filterDefinition5.Value.Should().Be(date.Date);
1301              await comp.InvokeAsync(() => internalFilter.TimeValueChanged(date.TimeOfDay));
1302              filterDefinition5.Value.Should().Be(date);
1303          }
1304          [Test]
1305          public async Task DataGridIDictionaryFiltersTest()
1306          {
1307              var comp = Context.RenderComponent<DataGridIDictionaryFiltersTest>();
1308              var dataGrid = comp.FindComponent<MudDataGrid<IDictionary<string, object>>>();
1309              var filterDefinition = new FilterDefinition<IDictionary<string, object>>
1310              {
1311                  Id = Guid.NewGuid(),
1312                  Operator = "contains",
1313                  Value = "John"
1314              };
1315              var filterDefinition2 = new FilterDefinition<IDictionary<string, object>>
1316              {
1317                  Id = Guid.NewGuid(),
1318                  Operator = ">",
1319                  Value = 30
1320              };
1321              var filterDefinition3 = new FilterDefinition<IDictionary<string, object>>
1322              {
1323                  Id = Guid.NewGuid(),
1324                  Operator = "is",
1325                  Value = Severity.Normal
1326              };
1327              await comp.InvokeAsync(() => dataGrid.Instance.FilterDefinitions.Add(filterDefinition));
1328              await comp.InvokeAsync(() => dataGrid.Instance.FilterDefinitions.Add(filterDefinition2));
1329              await comp.InvokeAsync(() => dataGrid.Instance.FilterDefinitions.Add(filterDefinition3));
1330              await comp.InvokeAsync(() => dataGrid.Instance.OpenFilters());
1331              var filters = dataGrid.Instance.FilterDefinitions;
1332              Assert.AreEqual(filterDefinition.Id, filters[0].Id);
1333              Assert.AreEqual(filterDefinition.Operator, filters[0].Operator);
1334              Assert.AreEqual(filterDefinition.Value, filters[0].Value);
1335              filters[0].Value = "Not Joe";
1336              Assert.AreEqual(filterDefinition.Value, "Not Joe");
1337              Assert.AreEqual(filterDefinition2.Id, filters[1].Id);
1338              Assert.AreEqual(filterDefinition2.Operator, filters[1].Operator);
1339              Assert.AreEqual(filterDefinition2.Value, filters[1].Value);
1340              filters[1].Value = 45;
1341              Assert.AreEqual(filterDefinition2.Value, 45);
1342              Assert.AreEqual(filterDefinition3.Id, filters[2].Id);
1343              Assert.AreEqual(filterDefinition3.Operator, filters[2].Operator);
1344              Assert.AreEqual(filterDefinition3.Value, filters[2].Value);
1345              filters[2].Value = Severity.Error;
1346              Assert.AreEqual(filterDefinition3.Value, Severity.Error);
1347          }
1348          [Test]
1349          public async Task DataGridColGroupTest()
1350          {
1351              var comp = Context.RenderComponent<DataGridColGroupTest>();
1352              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColGroupTest.Model>>();
1353              dataGrid.FindAll("col").Count.Should().Be(3);
1354          }
1355          [Test]
1356          public async Task DataGridHeaderTemplateTest()
1357          {
1358              var comp = Context.RenderComponent<DataGridHeaderTemplateTest>();
1359              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHeaderTemplateTest.Model>>();
1360              dataGrid.Find("thead th").TextContent.Trim().Should().Be("test");
1361              dataGrid.Find("span.column-header").FirstChild.NodeName.Should().Be("svg");
1362              dataGrid.Find("span.column-header span").TextContent.Should().Be("Name");
1363          }
1364          [Test]
1365          public async Task DataGridRowDetailOpenTest()
1366          {
1367              var comp = Context.RenderComponent<DataGridHierarchyColumnTest>();
1368              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHierarchyColumnTest.Model>>();
1369              await comp.InvokeAsync(() => dataGrid.Instance
1370              .ToggleHierarchyVisibilityAsync(dataGrid.Instance.Items.First()));
1371              dataGrid.FindAll("td")[5].TextContent.Trim().Should().StartWith("uid = Sam|56|Normal|");
1372          }
1373          [Test]
1374          public async Task DataGridRowDetailClosedTest()
1375          {
1376              var comp = Context.RenderComponent<DataGridHierarchyColumnTest>();
1377              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHierarchyColumnTest.Model>>();
1378              dataGrid.FindAll("td").SingleOrDefault(x => x.TextContent.Trim().StartsWith("uid = Sam|56|Normal|")).Should().BeNull();
1379          }
1380          [Test]
1381          public async Task DataGridRowDetailButtonDisabledTest()
1382          {
1383              var comp = Context.RenderComponent<DataGridHierarchyColumnTest>();
1384              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHierarchyColumnTest.Model>>();
1385              dataGrid.FindAll("button")[10].OuterHtml.Contains("disabled")
1386                  .Should().BeTrue();
1387          }
1388          [Test]
1389          public async Task DataGridRowDetailButtonDisabledClickTest()
1390          {
1391              var comp = Context.RenderComponent<DataGridHierarchyColumnTest>();
1392              var dataGrid = comp.FindComponent<MudDataGrid<DataGridHierarchyColumnTest.Model>>();
1393              await comp.InvokeAsync(() =>
1394              {
1395                  var buttons = dataGrid.FindAll("button.mud-button-root.mud-icon-button.mud-ripple.mud-ripple-icon");
1396                  buttons[10].Click();
1397                  dataGrid.FindAll("td")
1398                  .SingleOrDefault(x => x.TextContent.Trim().StartsWith("uid = Alicia|54|Info|")).Should().BeNull();
1399              });
1400          }
1401          [Test]
1402          public async Task DataGridChildRowContentTest()
1403          {
1404              var comp = Context.RenderComponent<DataGridChildRowContentTest>();
1405              var dataGrid = comp.FindComponent<MudDataGrid<DataGridChildRowContentTest.Model>>();
1406              dataGrid.FindAll("td").SingleOrDefault(x => x.TextContent.Trim().StartsWith("uid = Sam|56|Normal|")).Should().NotBeNull();
1407          }
1408          [Test]
1409          public async Task DataGridLoadingTest()
1410          {
1411              var comp = Context.RenderComponent<DataGridLoadingTest>();
1412              var dataGrid = comp.FindComponent<MudDataGrid<DataGridLoadingTest.Model>>();
1413              dataGrid.Find("th.mud-table-empty-row div").TextContent.Trim().Should().Be("Data loading, please wait...");
1414          }
1415          [Test]
1416          public async Task DataGridNoRecordsContentTest()
1417          {
1418              var comp = Context.RenderComponent<DataGridNoRecordsContentTest>();
1419              var dataGrid = comp.FindComponent<MudDataGrid<DataGridNoRecordsContentTest.Model>>();
1420              dataGrid.Find("th.mud-table-empty-row div").TextContent.Trim().Should().Be("There are no records to view.");
1421          }
1422          [Test]
1423          public async Task DataGridFooterTemplateTest()
1424          {
1425              var comp = Context.RenderComponent<DataGridFooterTemplateTest>();
1426              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFooterTemplateTest.Model>>();
1427              dataGrid.FindAll("tfoot td").First().TextContent.Trim().Should().Be("Names: Sam, Alicia, Ira, John");
1428              dataGrid.FindAll("tfoot td").Last().TextContent.Trim().Should().Be($"Highest: {132000:C0} | 2 Over {100000:C0}");
1429          }
1430          [Test]
1431          public async Task DataGridServerDataQuickFilterTest()
1432          {
1433              var comp = Context.RenderComponent<DataGridServerDataQuickFilterTest>();
1434              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerDataQuickFilterTest.Item>>();
1435              dataGrid.FindAll("tr").Count.Should().Be(3);
1436          }
1437          [Test]
1438          public async Task DataGridServerPaginationTest()
1439          {
1440              var comp = Context.RenderComponent<DataGridServerPaginationTest>();
1441              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerPaginationTest.Model>>();
1442              dataGrid.Find(".mud-table-body td").TextContent.Trim().Should().Be("Name 0");
1443              dataGrid.FindAll(".mud-table-pagination-actions button")[2].Click();
1444              dataGrid.Find(".mud-table-body td").TextContent.Trim().Should().Be("Name 10");
1445              await comp.InvokeAsync(async () => await dataGrid.Instance.ReloadServerData());
1446          }
1447          [Test]
1448          public async Task DataGridCellTemplateTest()
1449          {
1450              var comp = Context.RenderComponent<DataGridCellTemplateTest>();
1451              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellTemplateTest.Model>>();
1452              dataGrid.FindAll("td")[0].TextContent.Trim().Should().Be("John");
1453              dataGrid.FindAll("td")[1].TextContent.Trim().Should().Be("45");
1454          }
1455          [Test]
1456          public async Task DataGridColumnChooserTest()
1457          {
1458              var comp = Context.RenderComponent<DataGridColumnChooserTest>();
1459              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColumnChooserTest.Model>>();
1460              var popoverProvider = comp.FindComponent<MudPopoverProvider>();
1461              var popover = dataGrid.FindComponent<MudPopover>();
1462              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1463              await comp.InvokeAsync(() =>
1464              {
1465                  var columnHamburger = dataGrid.FindAll("button.mud-button-root.mud-icon-button.mud-ripple.mud-ripple-icon.mud-icon-button-size-small");
1466                  columnHamburger[2].Click();
1467                  var listItems = popoverProvider.FindComponents<MudListItem>();
1468                  listItems.Count.Should().Be(2);
1469                  var clickablePopover = listItems[1].Find(".mud-list-item");
1470                  clickablePopover.Click();
1471                  ((IMudStateHasChanged)dataGrid.Instance).StateHasChanged();
1472              });
1473              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(1);
1474              await comp.InvokeAsync(() =>
1475              {
1476                  var columnsButton = dataGrid.Find("button.mud-button-root.mud-icon-button.mud-ripple.mud-ripple-icon.mud-icon-button-size-small");
1477                  columnsButton.Click();
1478                  popover.Instance.Open.Should().BeTrue("Should be open once clicked");
1479                  var listItems = popoverProvider.FindComponents<MudListItem>();
1480                  listItems.Count.Should().Be(1);
1481                  var clickablePopover = listItems[0].Find(".mud-list-item");
1482                  clickablePopover.Click();
1483                  var switches = dataGrid.FindComponents<MudSwitch<bool>>();
1484                  switches.Count.Should().Be(2);
1485                  var buttons = dataGrid.FindComponents<MudButton>();
1486                  buttons[1].Find("button").Click();
1487                  dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1488                  ((IMudStateHasChanged)dataGrid.Instance).StateHasChanged();
1489              });
1490              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1491              await comp.InvokeAsync(() => dataGrid.Instance.ShowColumnsPanel());
1492              dataGrid.FindAll(".mud-paper.columns-panel").Count.Should().Be(1);
1493              await comp.InvokeAsync(() => dataGrid.Instance.HideColumnsPanel());
1494              dataGrid.FindAll(".mud-paper.columns-panel").Count.Should().Be(0);
1495              await comp.InvokeAsync(() => dataGrid.Instance.HideAllColumnsAsync());
1496              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(0);
1497              await comp.InvokeAsync(() => dataGrid.Instance.ShowAllColumnsAsync());
1498              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1499          }
1500          [Test]
1501          public async Task DataGridColumnHiddenTest()
1502          {
1503              var comp = Context.RenderComponent<DataGridColumnHiddenTest>();
1504              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColumnHiddenTest.Model>>();
1505              var popoverProvider = comp.FindComponent<MudPopoverProvider>();
1506              var popover = dataGrid.FindComponent<MudPopover>();
1507              popover.Instance.Open.Should().BeFalse("Should start as closed");
1508              var columnsButton = dataGrid.Find("button.mud-button-root.mud-icon-button.mud-ripple.mud-ripple-icon.mud-icon-button-size-small");
1509              columnsButton.Click();
1510              popover.Instance.Open.Should().BeTrue("Should be open once clicked");
1511              var listItems = popoverProvider.FindComponents<MudListItem>();
1512              listItems.Count.Should().Be(1);
1513              var clickablePopover = listItems[0].Find(".mud-list-item");
1514              clickablePopover.Click();
1515              var switches = dataGrid.FindComponents<MudSwitch<bool>>();
1516              switches.Count.Should().Be(2);
1517              switches[0].Instance.Checked.Should().BeFalse();
1518              switches[1].Instance.Checked.Should().BeTrue();
1519              var buttons = dataGrid.FindComponents<MudButton>();
1520              buttons[0].Find("button").Click();
1521              switches[0].Instance.Checked.Should().BeTrue();
1522              switches[1].Instance.Checked.Should().BeTrue();
1523              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(0);
1524              buttons[1].Find("button").Click();
1525              switches[0].Instance.Checked.Should().BeFalse();
1526              switches[1].Instance.Checked.Should().BeFalse();
1527              dataGrid.FindAll(".mud-table-head th").Count.Should().Be(2);
1528          }
1529          [Test]
1530          public async Task DataGridShowMenuIconTest()
1531          {
1532              var comp = Context.RenderComponent<DataGridShowMenuIconTest>();
1533              var dataGrid = comp.FindComponent<MudDataGrid<DataGridShowMenuIconTest.Item>>();
1534              dataGrid.FindAll(".mud-table-toolbar .mud-menu").Should().BeEmpty();
1535              var parameters = new List<ComponentParameter>();
1536              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.ShowMenuIcon), true));
1537              dataGrid.SetParametersAndRender(parameters.ToArray());
1538              dataGrid.FindAll(".mud-table-toolbar .mud-menu").Should().NotBeEmpty();
1539          }
1540          [Test]
1541          public async Task DataGridColumnPopupFilteringTest()
1542          {
1543              var comp = Context.RenderComponent<DataGridColumnPopupFilteringTest>();
1544              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColumnPopupFilteringTest.Model>>();
1545              dataGrid.FindAll("tbody tr").Count.Should().Be(4);
1546              comp.Find(".filter-button").Click();
1547              var input = comp.FindComponent<MudTextField<string>>();
1548              var parameters = new List<ComponentParameter>();
1549              parameters.Add(ComponentParameter.CreateParameter(nameof(input.Instance.Value), "test"));
1550              input.SetParametersAndRender(parameters.ToArray());
1551              comp.Find(".apply-filter-button").Click();
1552              await comp.InvokeAsync(() =>
1553              {
1554                  return dataGrid.Instance.AddFilterAsync(new FilterDefinition<DataGridColumnPopupFilteringTest.Model>
1555                  {
1556                      Column = dataGrid.Instance.RenderedColumns.First(),
1557                      Operator = FilterOperator.String.Contains,
1558                      Value = "test"
1559                  });
1560              });
1561              dataGrid.Render();
1562              dataGrid.FindAll("tbody tr").Count.Should().Be(0);
1563          }
1564          [Test]
1565          public async Task DataGridFilterableFalseTest()
1566          {
1567              var comp = Context.RenderComponent<DataGridFilterableFalseTest>();
1568              comp.Find(".filter-button").Click();
1569              comp.FindAll(".filters-panel").Count.Should().Be(1);
1570              comp.FindAll("div.mud-input-control")[0].Click();
1571              comp.FindAll("div.mud-list-item").Count.Should().Be(3);
1572          }
1573          [Test]
1574          public async Task DataGridColumnPopupCustomFilteringTest()
1575          {
1576              var comp = Context.RenderComponent<DataGridColumnPopupCustomFilteringTest>();
1577              var dataGrid = comp.FindComponent<MudDataGrid<DataGridColumnPopupCustomFilteringTest.Model>>();
1578              dataGrid.FindAll("tbody tr").Count.Should().Be(4);
1579              comp.Instance.FilterHired = true;
1580              await comp.InvokeAsync(async () =>
1581              {
1582                  var filterContext = dataGrid.Instance.RenderedColumns[3].FilterContext;
1583                  await comp.Instance.ApplyFilterAsync(filterContext);
1584              });
1585              dataGrid.FindAll("tbody tr").Count.Should().Be(1);
1586          }
1587          [Test]
1588          public async Task DataGridCustomFilteringTest()
1589          {
1590              var comp = Context.RenderComponent<DataGridCustomFilteringTest>();
1591              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCustomFilteringTest.Model>>();
1592              dataGrid.FindAll("tbody tr").Count.Should().Be(4);
1593              await comp.InvokeAsync(() =>
1594              {
1595                  comp.Instance.FilterHiredToggled(true, dataGrid.Instance);
1596              });
1597              dataGrid.Render();
1598              dataGrid.FindAll("tbody tr").Count.Should().Be(1);
1599          }
1600          [Test]
1601          public async Task DataGridShowFilterIconTest()
1602          {
1603              var comp = Context.RenderComponent<DataGridCustomFilteringTest>();
1604              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCustomFilteringTest.Model>>();
1605              var parameters = new List<ComponentParameter>();
1606              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.Filterable), false));
1607              dataGrid.SetParametersAndRender(parameters.ToArray());
1608              dataGrid.Instance.DropContainerHasChanged();
1609              dataGrid.FindAll(".filter-button").Should().BeEmpty();
1610              parameters.Clear();
1611              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.Filterable), true));
1612              dataGrid.SetParametersAndRender(parameters.ToArray());
1613              dataGrid.Instance.DropContainerHasChanged();
1614              dataGrid.FindAll(".filter-button").Should().NotBeEmpty();
1615              parameters.Clear();
1616              parameters.Add(ComponentParameter.CreateParameter(nameof(dataGrid.Instance.ShowFilterIcons), false));
1617              dataGrid.SetParametersAndRender(parameters.ToArray());
1618              dataGrid.Instance.DropContainerHasChanged();
1619              dataGrid.FindAll(".filter-button").Should().BeEmpty();
1620          }
1621          [Test]
1622          public async Task DataGridServerDataColumnFilterMenuTest()
1623          {
1624              var comp = Context.RenderComponent<DataGridServerDataColumnFilterMenuTest>();
1625              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerDataColumnFilterMenuTest.Model>>();
1626              var callCountText = comp.FindComponent<MudText>();
1627              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(4);
1628              callCountText.Markup.Should().Contain("Server call count: 1");
1629              comp.Find(".filter-button").Click();
1630              var input = comp.FindComponent<MudTextField<string>>();
1631              await comp.InvokeAsync(async () => await input.Instance.ValueChanged.InvokeAsync("Sam"));
1632              comp.Find(".apply-filter-button").Click();
1633              callCountText.Markup.Should().Contain("Server call count: 2");
1634              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(1);
1635              comp.Find(".filter-button").Click();
1636              comp.Find(".clear-filter-button").Click();
1637              callCountText.Markup.Should().Contain("Server call count: 3");
1638              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(4);
1639          }
1640          [Test]
1641          public async Task DataGridServerDataColumnFilterRowTest()
1642          {
1643              var comp = Context.RenderComponent<DataGridServerDataColumnFilterRowTest>();
1644              var dataGrid = comp.FindComponent<MudDataGrid<DataGridServerDataColumnFilterRowTest.Model>>();
1645              var callCountText = comp.FindComponent<MudText>();
1646              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(4);
1647              callCountText.Markup.Should().Contain("Server call count: 1");
1648              var input = comp.FindComponent<MudTextField<string>>();
1649              await comp.InvokeAsync(async () => await input.Instance.ValueChanged.InvokeAsync("Sam"));
1650              callCountText.Markup.Should().Contain("Server call count: 2");
1651              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(1);
1652              comp.Find("th > div > button.mud-button-root").Click(); 
1653              callCountText.Markup.Should().Contain("Server call count: 3");
1654              dataGrid.Render();
1655              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(4);
1656          }
1657          [Test]
1658          public async Task DataGridStickyColumnsTest()
1659          {
1660              var comp = Context.RenderComponent<DataGridStickyColumnsTest>();
1661              var dataGrid = comp.FindComponent<MudDataGrid<DataGridStickyColumnsTest.Model>>();
1662              dataGrid.Find("th").ClassList.Should().Contain("sticky-left");
1663              dataGrid.FindAll("th").Last().ClassList.Should().Contain("sticky-right");
1664          }
1665          [Test]
1666          public async Task DataGridStickyColumnsResizerTest()
1667          {
1668              var comp = Context.RenderComponent<DataGridStickyColumnsResizerTest>();
1669              var dataGrid = comp.FindComponent<MudDataGrid<DataGridStickyColumnsResizerTest.Model>>();
1670              var header = dataGrid.Find(".mud-table-toolbar");
1671              header.GetAttribute("style").Should().Contain("position:sticky");
1672              header.GetAttribute("style").Should().Contain("left:0px");
1673              var footer = dataGrid.Find(".mud-table-pagination");
1674              footer.GetAttribute("style").Should().Contain("position:sticky");
1675              footer.GetAttribute("style").Should().Contain("left:0px");
1676              var body = dataGrid.Find(".mud-table-container");
1677              body.GetAttribute("style").Should().Contain("width:max-content");
1678              body.GetAttribute("style").Should().Contain("overflow:clip");
1679              dataGrid.Find("th").ClassList.Should().Contain("sticky-left");
1680              dataGrid.FindAll("th").Last().ClassList.Should().Contain("sticky-right");
1681          }
1682          [Test]
1683          public async Task DataGridCellContextTest()
1684          {
1685              var comp = Context.RenderComponent<DataGridCellContextTest>();
1686              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCellContextTest.Model>>();
1687              var item = dataGrid.Instance.Items.FirstOrDefault();
1688              var column = dataGrid.Instance.RenderedColumns.First();
1689              var cell = new Cell<DataGridCellContextTest.Model>(dataGrid.Instance, column, item);
1690              cell._cellContext.IsSelected.Should().Be(false);
1691              await cell._cellContext.Actions.SetSelectedItemAsync(true);
1692              cell._cellContext.IsSelected.Should().Be(true);
1693              await cell._cellContext.Actions.ToggleHierarchyVisibilityForItemAsync();
1694              cell._cellContext.OpenHierarchies.Should().Contain(item);
1695              await cell._cellContext.Actions.ToggleHierarchyVisibilityForItemAsync();
1696              cell._cellContext.OpenHierarchies.Should().NotContain(item);
1697          }
1698          [Test]
1699          public async Task DataGridAggregationTest()
1700          {
1701              var comp = Context.RenderComponent<DataGridAggregationTest>();
1702              var dataGrid = comp.FindComponent<MudDataGrid<DataGridAggregationTest.Model>>();
1703              dataGrid.FindAll("td.footer-cell")[1].TrimmedText().Should().Be("Average age is 56");
1704              dataGrid.FindAll("tfoot td.footer-cell")[1].TrimmedText().Should().Be("Average age is 43");
1705          }
1706          [Test]
1707          public async Task DataGridSequenceContainsNoElementsTest()
1708          {
1709              var comp = Context.RenderComponent<DataGridSequenceContainsNoElementsTest>();
1710              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSequenceContainsNoElementsTest.Model>>();
1711          }
1712          [Test]
1713          public async Task DataGridObservabilityTest()
1714          {
1715              var comp = Context.RenderComponent<DataGridObservabilityTest>();
1716              var dataGrid = comp.FindComponent<MudDataGrid<DataGridObservabilityTest.Model>>();
1717              var addButton = comp.Find(".add-item-btn");
1718              var removeButton = comp.Find(".remove-item-btn");
1719              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(8);
1720              addButton.Click();
1721              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(9);
1722              removeButton.Click();
1723              dataGrid.FindAll(".mud-table-body .mud-table-row").Count.Should().Be(8);
1724          }
1725          public async Task TableFilterGuid()
1726          {
1727              var comp = Context.RenderComponent<DataGridFilterGuid<Guid>>();
1728              var grid = comp.Instance.MudGridRef;
1729              grid.Items.Count().Should().Be(2);
1730              grid.FilteredItems.Count().Should().Be(2);
1731              var guidColumn = grid.RenderedColumns.FirstOrDefault(x => x.PropertyName == "Id");
1732              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Guid>.WeatherForecast>()
1733              {
1734                  Column = guidColumn,
1735                  Operator = "equals",
1736                  Value = "invalid guid",
1737              });
1738              grid.FilteredItems.Count().Should().Be(0);
1739              grid.FilterDefinitions.Clear();
1740              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Guid>.WeatherForecast>()
1741              {
1742                  Column = guidColumn,
1743                  Operator = "equals",
1744                  Value = comp.Instance.Guid1,
1745              });
1746              grid.FilteredItems.Count().Should().Be(1);
1747              grid.FilteredItems.FirstOrDefault()?.Id.Should().Be(comp.Instance.Guid1);
1748              grid.FilterDefinitions.Clear();
1749              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Guid>.WeatherForecast>()
1750              {
1751                  Column = guidColumn,
1752                  Operator = "not equals",
1753                  Value = comp.Instance.Guid1,
1754              });
1755              grid.FilteredItems.Count().Should().Be(1);
1756              grid.FilteredItems.FirstOrDefault()?.Id.Should().Be(comp.Instance.Guid2);
1757          }
1758          [Test]
1759          public async Task TableFilterNullableGuid()
1760          {
1761              var comp = Context.RenderComponent<DataGridFilterGuid<Nullable<Guid>>>();
1762              var grid = comp.Instance.MudGridRef;
1763              grid.Items.Count().Should().Be(2);
1764              grid.FilteredItems.Count().Should().Be(2);
1765              var guidColumn = grid.RenderedColumns.FirstOrDefault(x => x.PropertyName == "Id");
1766              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Nullable<Guid>>.WeatherForecast>()
1767              {
1768                  Column = guidColumn,
1769                  Operator = "equals",
1770                  Value = Guid.Empty
1771              });
1772              comp.Render();
1773              grid.FilteredItems.Count().Should().Be(0);
1774              grid.FilterDefinitions.Clear();
1775              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Nullable<Guid>>.WeatherForecast>()
1776              {
1777                  Column = guidColumn,
1778                  Operator = "equals",
1779                  Value = comp.Instance.Guid1,
1780              });
1781              comp.Render();
1782              grid.FilteredItems.Count().Should().Be(1);
1783              grid.FilteredItems.FirstOrDefault()?.Id.Should().Be(comp.Instance.Guid1);
1784              grid.FilterDefinitions.Clear();
1785              grid.FilterDefinitions.Add(new FilterDefinition<DataGridFilterGuid<Nullable<Guid>>.WeatherForecast>()
1786              {
1787                  Column = guidColumn,
1788                  Operator = "not equals",
1789                  Value = comp.Instance.Guid1,
1790              });
1791              comp.Render();
1792              grid.FilteredItems.Count().Should().Be(1);
1793              grid.FilteredItems.FirstOrDefault()?.Id.Should().Be(comp.Instance.Guid2);
1794          }
1795          [Test]
1796          public void DataGridCultureColumnSimpleTest()
1797          {
1798              var comp = Context.RenderComponent<DataGridCultureSimpleTest>();
1799              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCultureSimpleTest.Model>>();
1800              dataGrid.FindAll("td")[2].TextContent.Trim().Should().Be("3.5");
1801              dataGrid.FindAll("td")[3].TextContent.Trim().Should().Be("5,2");
1802          }
1803          [Test]
1804          public void DataGridCultureColumnEditableTest()
1805          {
1806              var comp = Context.RenderComponent<DataGridCultureEditableTest>();
1807              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCultureEditableTest.Model>>();
1808              dataGrid.FindAll("td input")[2].GetAttribute("value").Trim().Should().Be("3.5");
1809              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("5,2");
1810          }
1811          [Test]
1812          public async Task DataGridCultureColumnFilterTest()
1813          {
1814              var comp = Context.RenderComponent<DataGridCultureSimpleTest>();
1815              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCultureSimpleTest.Model>>();
1816              var amountHeader = dataGrid.FindAll("th .mud-menu button")[2];
1817              amountHeader.Click();
1818              var filterAmount = comp.FindAll(".mud-list-item-clickable")[1];
1819              filterAmount.Click();
1820              var filterField = comp.Find(".filters-panel .filter-field .mud-select-input");
1821              filterField.TextContent.Trim().Should().Be("Amount");
1822              var filterInput = comp.FindAll(".filters-panel input")[2];
1823              filterInput.Input(new ChangeEventArgs() { Value = "2,2" });
1824              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1825              dataGrid.Instance.FilterDefinitions[0].Value.Should().Be(22.0);
1826              dataGrid.Instance.FilterDefinitions.Clear();
1827              dataGrid.Render();
1828              var totalHeader = dataGrid.FindAll("th .mud-menu button")[3];
1829              totalHeader.Click();
1830              var filterTotal = comp.FindAll(".mud-list-item-clickable")[1];
1831              filterTotal.Click();
1832              var filterTotalField = comp.Find(".filters-panel .filter-field .mud-select-input");
1833              filterTotalField.TextContent.Trim().Should().Be("Total");
1834              var filterTotalInput = comp.FindAll(".filters-panel input")[2];
1835              filterTotalInput.Input(new ChangeEventArgs() { Value = "2,2" });
1836              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1837              dataGrid.Instance.FilterDefinitions[0].Value.Should().Be(2.2);
1838          }
1839          [Test]
1840          public async Task DataGridCultureColumnFilterHeaderTest()
1841          {
1842              var comp = Context.RenderComponent<DataGridCultureEditableTest>();
1843              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCultureEditableTest.Model>>();
1844              var filterAmount = dataGrid.FindAll("th.filter-header-cell input")[2];
1845              filterAmount.Input(new ChangeEventArgs() { Value = "2,2" });
1846              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1847              dataGrid.Instance.FilterDefinitions[0].Value.Should().Be(22.0);
1848              dataGrid.Instance.FilterDefinitions.Clear();
1849              dataGrid.Render();
1850              var filterTotal = dataGrid.FindAll("th.filter-header-cell input")[3];
1851              filterTotal.Input(new ChangeEventArgs() { Value = "2,2" });
1852              dataGrid.Instance.FilterDefinitions.Count.Should().Be(1);
1853              dataGrid.Instance.FilterDefinitions[0].Value.Should().Be(2.2);
1854          }
1855          [Test]
1856          public async Task DataGridCultureColumnOverridesTest()
1857          {
1858              var comp = Context.RenderComponent<DataGridCulturesTest>();
1859              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCulturesTest.Model>>();
1860              dataGrid.FindAll("td input")[2].GetAttribute("value").Trim().Should().Be("3.5");
1861              dataGrid.FindAll("td input")[3].GetAttribute("value").Trim().Should().Be("5,2");
1862              dataGrid.FindAll("td input")[4].GetAttribute("value").Trim().Should().Be("2#1");
1863          }
1864          [Test]
1865          public async Task DataGridSortIndicatorTest()
1866          {
1867              var comp = Context.RenderComponent<DataGridSortableTest>();
1868              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSortableTest.Item>>();
1869              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Ascending, x => x.Value));
1870              dataGrid.Instance.DropContainerHasChanged();
1871              dataGrid.FindAll("th .sortable-column-header")[1].TextContent.Trim().Should().Be("Value");
1872              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1873              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(true);
1874              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1875              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Ascending);
1876              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Descending, x => x.Value));
1877              dataGrid.Instance.DropContainerHasChanged();
1878              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1879              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Descending);
1880              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1881              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-desc").Should().Be(true);
1882              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => x.Value));
1883              dataGrid.Instance.DropContainerHasChanged();
1884              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.Ascending);
1885              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.None);
1886              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(true);
1887              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(false);
1888          }
1889          [Test]
1890          public async Task DataGridCustomSortTest()
1891          {
1892              var comp = Context.RenderComponent<DataGridCustomSortableTest>();
1893              var dataGrid = comp.FindComponent<MudDataGrid<DataGridCustomSortableTest.Item>>();
1894              dataGrid.Instance.SortMode = SortMode.Single;
1895              dataGrid.Instance.SortMode.Should().Be(SortMode.Single);
1896              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Ascending, x => x.Value, new MudBlazor.Utilities.NaturalComparer()));
1897              dataGrid.Instance.DropContainerHasChanged();
1898              dataGrid.FindAll("th .sortable-column-header")[1].TextContent.Trim().Should().Be("Value");
1899              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1900              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(true);
1901              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1902              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Ascending);
1903              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Descending, x => x.Value, new MudBlazor.Utilities.NaturalComparer()));
1904              dataGrid.Instance.DropContainerHasChanged();
1905              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1906              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Descending);
1907              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1908              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-desc").Should().Be(true);
1909              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Value", SortDirection.Ascending, x => x.Value));
1910              dataGrid.Instance.DropContainerHasChanged();
1911              dataGrid.FindAll("th .sortable-column-header")[1].TextContent.Trim().Should().Be("Value");
1912              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(false);
1913              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(true);
1914              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1915              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.Ascending);
1916              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => x.Name, new MudBlazor.Utilities.NaturalComparer()));
1917              dataGrid.Instance.DropContainerHasChanged();
1918              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.Ascending);
1919              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.None);
1920              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-asc").Should().Be(true);
1921              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(false);
1922              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Descending, x => x.Name, new MudBlazor.Utilities.NaturalComparer()));
1923              dataGrid.Instance.DropContainerHasChanged();
1924              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.Descending);
1925              dataGrid.Instance.GetColumnSortDirection("Value").Should().Be(SortDirection.None);
1926              dataGrid.FindAll("th .sort-direction-icon")[0].ClassList.Contains("mud-direction-desc").Should().Be(true);
1927              dataGrid.FindAll("th .sort-direction-icon")[1].ClassList.Contains("mud-direction-asc").Should().Be(false);
1928              dataGrid.Instance.SortMode = SortMode.Multiple;
1929              dataGrid.Instance.SortMode.Should().Be(SortMode.Multiple);
1930              var column = dataGrid.FindComponent<Column<DataGridCustomSortableTest.Item>>();
1931              await comp.InvokeAsync(() => column.Instance.Comparer = new MudBlazor.Utilities.NaturalComparer());
1932              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync("Name"));
1933              dataGrid.Instance.GetColumnSortDirection("Name").Should().Be(SortDirection.None);
1934              dataGrid.Find(".column-options button").Click();
1935              var cells = dataGrid.FindAll("td");
1936              cells[0].TextContent.Should().Be("0");
1937              cells[3].TextContent.Should().Be("1");
1938              cells[6].TextContent.Should().Be("1_2");
1939              cells[9].TextContent.Should().Be("1_10");
1940              cells[12].TextContent.Should().Be("1_11");
1941              cells[15].TextContent.Should().Be("2");
1942              cells[18].TextContent.Should().Be("10");
1943              var headerCell = dataGrid.FindComponents<HeaderCell<DataGridCustomSortableTest.Item>>()[1];
1944              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new MouseEventArgs() { CtrlKey = true, Button = 0 }));
1945              headerCell.Instance.SortDirection.Should().Be(SortDirection.Ascending);
1946              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new MouseEventArgs() { CtrlKey = true, Button = 0 }));
1947              headerCell.Instance.SortDirection.Should().Be(SortDirection.Descending);
1948              headerCell = dataGrid.FindComponents<HeaderCell<DataGridCustomSortableTest.Item>>()[0];
1949              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new MouseEventArgs() { AltKey = true, Button = 0 }));
1950              headerCell.Instance.SortDirection.Should().Be(SortDirection.None);
1951          }
1952          [Test]
1953          public async Task DataGridGroupExpandedTest()
1954          {
1955              var comp = Context.RenderComponent<DataGridGroupExpandedTest>();
1956              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupExpandedTest.Fruit>>();
1957              comp.FindAll("tbody .mud-table-row").Count.Should().Be(7);
1958              comp.Instance.CollapseAllGroups();
1959              dataGrid.Render();
1960              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
1961              await comp.InvokeAsync(() =>
1962                  comp.Instance.AddFruit());
1963              dataGrid.Render();
1964              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
1965          }
1966          [Test]
1967          public async Task DataGridGroupExpandedAsyncTest()
1968          {
1969              var comp = Context.RenderComponent<DataGridGroupExpandedAsyncTest>();
1970              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupExpandedAsyncTest.Fruit>>();
1971              comp.WaitForAssertion(() => comp.FindAll("tbody .mud-table-row").Count.Should().Be(7));
1972              comp.Instance.CollapseAllGroups();
1973              dataGrid.Render();
1974              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
1975              await comp.InvokeAsync(() =>
1976                  comp.Instance.AddFruit());
1977              dataGrid.Render();
1978              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
1979          }
1980          [Test]
1981          public async Task DataGridGroupExpandedServerDataTest()
1982          {
1983              var comp = Context.RenderComponent<DataGridGroupExpandedServerDataTest>();
1984              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupExpandedServerDataTest.Fruit>>();
1985              comp.WaitForAssertion(() => comp.FindAll("tbody .mud-table-row").Count.Should().Be(7));
1986              comp.Instance.CollapseAllGroups();
1987              dataGrid.Render();
1988              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
1989              await comp.InvokeAsync(() =>
1990                  comp.Instance.AddFruit());
1991              dataGrid.Render();
1992              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
1993          }
1994          [Test]
1995          public async Task DataGridGroupCollapseAllTest()
1996          {
1997              var comp = Context.RenderComponent<DataGridGroupCollapseAllTest>();
1998              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupCollapseAllTest.TestObject>>();
1999              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
2000              comp.Instance.ExpandAllGroups();
2001              comp.Render();
2002              comp.FindAll("tbody .mud-table-row").Count.Should().Be(15);
2003              comp.Instance.CollapseAllGroups();
2004              comp.Render();
2005              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
2006              comp.Instance.RefreshList();
2007              comp.Render();
2008              comp.FindAll("tbody .mud-table-row").Count.Should().Be(3);
2009          }
2010          [Test]
2011          public async Task DataGridGroupExpandAllCollapseAllTest()
2012          {
2013              var comp = Context.RenderComponent<DataGridGroupExpandAllCollapseAllTest>();
2014              var dataGrid = comp.FindComponent<MudDataGrid<DataGridGroupExpandAllCollapseAllTest.Element>>();
2015              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
2016              comp.Instance.ExpandAllGroups();
2017              comp.Render();
2018              comp.FindAll("tbody .mud-table-row").Count.Should().Be(14);
2019              comp.Instance.NavigateToPage(1);
2020              comp.Render();
2021              comp.FindAll("tbody .mud-table-row").Count.Should().Be(18);
2022              comp.Instance.CollapseAllGroups();
2023              comp.Instance.NavigateToPage(0);
2024              comp.Render();
2025              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
2026              comp.Instance.RefreshList();
2027              comp.Render();
2028              comp.FindAll("tbody .mud-table-row").Count.Should().Be(2);
2029          }
2030          [Test]
2031          public async Task DataGridPropertyColumnFormatTest()
2032          {
2033              var comp = Context.RenderComponent<DataGridFormatTest>();
2034              var dataGrid = comp.FindComponent<MudDataGrid<DataGridFormatTest.Employee>>();
2035              comp.FindAll("tbody.mud-table-body td")[3].TextContent.Should().Be("$87,000.00");
2036              var column = (PropertyColumn<DataGridFormatTest.Employee, int>)dataGrid.Instance.GetColumnByPropertyName("Salary");
2037              await comp.InvokeAsync(() => column.Format = "C0");
2038              comp.Find(".mud-switch-input").Change(new ChangeEventArgs { Value = true });
2039              comp.FindAll("tbody.mud-table-body td")[3].TextContent.Should().Be("$87,000");
2040          }
2041          [Test]
2042          public async Task DataGridFilteredItemsCacheTest()
2043          {
2044              var comp = Context.RenderComponent<DataGridSortableTest>();
2045              var dataGrid = comp.FindComponent<MudDataGrid<DataGridSortableTest.Item>>();
2046              var initialFilterCount = dataGrid.Instance.FilteringRunCount;
2047              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Ascending, x => { return x.Name; }));
2048              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 1);
2049              await comp.InvokeAsync(() => dataGrid.Instance.SetSortAsync("Name", SortDirection.Descending, x => { return x.Name; }));
2050              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 2);
2051              await comp.InvokeAsync(() => dataGrid.Instance.RemoveSortAsync("Name"));
2052              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 3);
2053              var column = dataGrid.FindComponent<Column<DataGridSortableTest.Item>>();
2054              await comp.InvokeAsync(() => column.Instance.SortBy = x => { return x.Name; });
2055              dataGrid.Render();
2056              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 4);
2057              dataGrid.Find(".column-options button").Click();
2058              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 5);
2059              var headerCell = dataGrid.FindComponent<HeaderCell<DataGridSortableTest.Item>>();
2060              await comp.InvokeAsync(() => headerCell.Instance.SortChangedAsync(new Microsoft.AspNetCore.Components.Web.MouseEventArgs()));
2061              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 6);
2062              await comp.InvokeAsync(() => headerCell.Instance.RemoveSortAsync());
2063              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 7);
2064              await comp.InvokeAsync(() => headerCell.Instance.AddFilterAsync());
2065              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 8);
2066              await comp.InvokeAsync(() => headerCell.Instance.OpenFilters());
2067              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 9);
2068              await comp.InvokeAsync(() => dataGrid.Instance.SortMode = SortMode.None);
2069              dataGrid.Render();
2070              dataGrid.Instance.FilteringRunCount.Should().Be(initialFilterCount + 10);
2071              dataGrid.Instance.DropContainerHasChanged();
2072              dataGrid.FindAll(".column-header .sortable-column-header").Should().BeEmpty();
2073          }
2074          [Test]
2075          public async Task DataGridDragAndDropTest()
2076          {
2077              var comp = Context.RenderComponent<DataGridDragAndDropTest>();
2078              var dataGrid = comp.FindComponent<MudDataGrid<DataGridDragAndDropTest.Model>>();
2079              dataGrid.Instance.DropContainerHasChanged();
2080              var headerValues = dataGrid.FindAll(".sortable-column-header");
2081              headerValues.Count.Should().Be(5, because: "5 columns in DataGridFiltersTest");
2082              headerValues[0].InnerHtml.Should().Be("Name");
2083              headerValues[1].InnerHtml.Should().Be("Age");
2084              headerValues[2].InnerHtml.Should().Be("Status");
2085              headerValues[3].InnerHtml.Should().Be("Hired");
2086              headerValues[4].InnerHtml.Should().Be("HiredOn");
2087              var container = dataGrid.Find(".mud-drop-container");
2088              container.Children.Should().HaveCount(1);
2089              var zone = dataGrid.FindAll(".mud-drop-zone");
2090              zone.Count.Should().Be(5, because: "5 columns in DataGridFiltersTest");
2091              var firstDropZone = zone[1];
2092              var firstDropItem = firstDropZone.Children[0];
<span onclick='openModal()' class='match'>2093              var secondDropZone = zone[2];
2094              var secondDropItem = secondDropZone.Children[0];
2095              await firstDropItem.DragStartAsync(new DragEventArgs());
</span>2096              await secondDropItem.DropAsync(new DragEventArgs());
2097              var newHeaderValues = dataGrid.FindAll(".sortable-column-header");
2098              newHeaderValues.Count.Should().Be(5, because: "5 columns in DataGridFiltersTest");
2099              newHeaderValues[0].InnerHtml.Should().Be("Name");
2100              newHeaderValues[1].InnerHtml.Should().Be("Status");
2101              newHeaderValues[2].InnerHtml.Should().Be("Age");
2102              newHeaderValues[3].InnerHtml.Should().Be("Hired");
2103              newHeaderValues[4].InnerHtml.Should().Be("HiredOn");
2104          }
2105      }
2106  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-DataGridTests.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-DataGridTests.cs</div>
                </div>
                <div class="column column_space"><pre><code>2091              var firstDropZone = zone[1];
2092              var firstDropItem = firstDropZone.Children[0];
2093              var secondDropZone = zone[2];
</pre></code></div>
                <div class="column column_space"><pre><code>2093              var secondDropZone = zone[2];
2094              var secondDropItem = secondDropZone.Children[0];
2095              await firstDropItem.DragStartAsync(new DragEventArgs());
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    