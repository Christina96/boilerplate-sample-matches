
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 2.9629629629629632%, Tokens: 16</h2>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-MudBadge.razor.cs</h3>
            <pre><code>1  using System;
2  using System.Diagnostics.CodeAnalysis;
3  using System.Threading.Tasks;
4  using Microsoft.AspNetCore.Components;
5  using Microsoft.AspNetCore.Components.Web;
6  using MudBlazor.Utilities;
7  namespace MudBlazor
8  {
9  #nullable enable
10      public partial class MudBadge : MudComponentBase
11      {
12          protected string Classname =>
13          new CssBuilder("mud-badge-root")
14            .AddClass(Class)
15          .Build();
16          protected string WrapperClass =>
17          new CssBuilder("mud-badge-wrapper")
18              .AddClass($"mud-badge-{Origin.ToDescriptionString().Replace("-", " ")}")
19          .Build();
20          protected string BadgeClassName =>
<span onclick='openModal()' class='match'>21          new CssBuilder("mud-badge")
22              .AddClass("mud-badge-dot", Dot)
23              .AddClass("mud-badge-bordered", Bordered)
24              .AddClass("mud-badge-icon", !string.IsNullOrEmpty(Icon) && !Dot)
25              .AddClass($"mud-badge-{Origin.ToDescriptionString().Replace("-", " ")}")
26              .AddClass($"mud-elevation-{Elevation.ToString()}")
27              .AddClass("mud-theme-" + Color.ToDescriptionString(), Color != Color.Default)
28              .AddClass("mud-badge-default", Color == Color.Default)
29              .AddClass("mud-badge-overlap", Overlap)
30              .AddClass(BadgeClass)
31          .Build();
</span>32          [Parameter]
33          [Category(CategoryTypes.Badge.Appearance)]
34          public Origin Origin { get; set; } = Origin.TopRight;
35          [Parameter]
36          [Category(CategoryTypes.Badge.Appearance)]
37          public int Elevation { set; get; } = 0;
38          [Parameter]
39          [Category(CategoryTypes.Badge.Behavior)]
40          public bool Visible { get; set; } = true;
41          [Parameter]
42          [Category(CategoryTypes.Badge.Appearance)]
43          public Color Color { get; set; } = Color.Default;
44          [ExcludeFromCodeCoverage]
45          [Obsolete("Use Origin instead.", true)]
46          [Parameter] public bool Bottom { get; set; }
47          [ExcludeFromCodeCoverage]
48          [Obsolete("Use Origin instead.", true)]
49          [Parameter] public bool Left { get => Start; set { Start = value; } }
50          [ExcludeFromCodeCoverage]
51          [Obsolete("Use Origin instead.", true)]
52          [Parameter] public bool Start { get; set; }
53          [Parameter]
54          [Category(CategoryTypes.Badge.Behavior)]
55          public bool Dot { get; set; }
56          [Parameter]
57          [Category(CategoryTypes.Badge.Appearance)]
58          public bool Overlap { get; set; }
59          [Parameter]
60          [Category(CategoryTypes.Badge.Appearance)]
61          public bool Bordered { get; set; }
62          [Parameter]
63          [Category(CategoryTypes.Badge.Behavior)]
64          public string? Icon { get; set; }
65          [Parameter]
66          [Category(CategoryTypes.Badge.Behavior)]
67          public int Max { get; set; } = 99;
68          [Parameter]
69          [Category(CategoryTypes.Badge.Behavior)]
70          public object? Content { get; set; }
71          [Parameter]
72          [Category(CategoryTypes.Badge.Appearance)]
73          public string? BadgeClass { get; set; }
74          [Parameter]
75          [Category(CategoryTypes.Badge.Behavior)]
76          public RenderFragment? ChildContent { get; set; }
77          [Parameter] public EventCallback<MouseEventArgs> OnClick { get; set; }
78          private string? _content;
79          internal Task HandleBadgeClick(MouseEventArgs e)
80          {
81              if (OnClick.HasDelegate)
82                  return OnClick.InvokeAsync(e);
83              return Task.CompletedTask;
84          }
85          protected override void OnParametersSet()
86          {
87              if (Content is string stringContent)
88              {
89                  _content = stringContent;
90              }
91              else if (Content is int numberContent)
92              {
93                  if (numberContent > Max)
94                  {
95                      _content = Max + "+";
96                  }
97                  else
98                  {
99                      _content = numberContent.ToString();
100                  }
101              }
102              else
103              {
104                  _content = null;
105              }
106          }
107      }
108  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-TextFieldTests.cs</h3>
            <pre><code>1  #pragma warning disable CS1998 
2  #pragma warning disable BL0005 
3  using System;
4  using System.Collections.Generic;
5  using System.ComponentModel.DataAnnotations;
6  using System.Globalization;
7  using System.Linq;
8  using System.Linq.Expressions;
9  using System.Threading.Tasks;
10  using Bunit;
11  using FluentAssertions;
12  using FluentValidation;
13  using Microsoft.AspNetCore.Components;
14  using Microsoft.AspNetCore.Components.Web;
15  using MudBlazor.UnitTests.TestComponents;
16  using MudBlazor.UnitTests.TestComponents.Field;
17  using MudBlazor.UnitTests.TestComponents.Form;
18  using MudBlazor.UnitTests.TestComponents.TextField;
19  using MudBlazor.UnitTests.Utilities;
20  using NUnit.Framework;
21  using static Bunit.ComponentParameterFactory;
22  namespace MudBlazor.UnitTests.Components
23  {
24      [TestFixture]
25      public class TextFieldTests : BunitTest
26      {
27          [Test]
28          public void TestFieldLabelFor()
29          {
30              var comp = Context.RenderComponent<FormIsValidTest3>();
31              var label = comp.FindAll(".mud-input-label");
32              label[0].Attributes.GetNamedItem("for")?.Value.Should().Be("textFieldLabelTest");
33              label[1].Attributes.GetNamedItem("for")?.Value.Should().StartWith("mudinput-");
34          }
35          [Test]
36          public async Task TextFieldLabelFor()
37          {
38              var comp = Context.RenderComponent<FieldTest>();
39              var label = comp.FindAll(".mud-input-label");
40              label[0].Attributes.GetNamedItem("for")?.Value.Should().StartWith("mudinput-");
41              label[1].Attributes.GetNamedItem("for")?.Value.Should().StartWith("mudinput-");
42              label[2].Attributes.GetNamedItem("for")?.Value.Should().Be("fieldLabelTest");
43          }
44          [Test]
45          public async Task TextFieldTest1()
46          {
47              var comp = Context.RenderComponent<MudTextField<double>>();
48              var textfield = comp.Instance;
49              textfield.Value.Should().Be(0.0);
50              textfield.Text.Should().Be("0");
51              0.0.ToString("F1", CultureInfo.InvariantCulture).Should().Be("0.0");
52              await comp.InvokeAsync(() => textfield.Format = "F1");
53              await comp.InvokeAsync(() => textfield.Culture = CultureInfo.InvariantCulture);
54              textfield.Value.Should().Be(0.0);
55              textfield.Text.Should().Be("0.0");
56              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
57          }
58          [Test]
59          public void TextFieldTest2()
60          {
61              var comp = Context.RenderComponent<MudTextField<double?>>();
62              var textfield = comp.Instance;
63              textfield.Value.Should().Be(null);
64              textfield.Text.Should().BeNullOrEmpty();
65              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
66          }
67          [Test]
68          public async Task TextFieldWithNullableTypes()
69          {
70              var comp = Context.RenderComponent<MudTextField<int?>>(ComponentParameter.CreateParameter("Value", 17));
71              comp.SetParametersAndRender(ComponentParameter.CreateParameter("Value", null));
72              comp.Find("input").Blur();
73              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
74              comp.Find("input").Change("");
75              comp.Find("input").Blur();
76              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
77          }
78          [Test]
79          public async Task TextFieldConversionError()
80          {
81              var comp = Context.RenderComponent<MudTextField<int?>>();
82              comp.Find("input").Change("seventeen");
83              comp.Find("input").Blur();
84              comp.FindAll("div.mud-input-error").Count.Should().Be(2);
85              comp.Find("div.mud-input-error").TextContent.Trim().Should().Be("Not a valid number");
86          }
87          [Test]
88          public void WithNoDebounceIntervalValueShouldChangeImmediatelyTest()
89          {
90              var immediate = Parameter(nameof(MudTextField<string>.Immediate), true);
91              var comp = Context.RenderComponent<MudTextField<string>>(immediate);
92              var textField = comp.Instance;
93              var input = comp.Find("input");
94              input.Input(new ChangeEventArgs() { Value = "Some Value" });
95              textField.Value.Should().Be("Some Value");
96          }
97          [Test]
98          public async Task ShouldRespectDebounceIntervalPropertyInTextFieldTest()
99          {
100              var interval = Parameter(nameof(MudTextField<string>.DebounceInterval), 200d);
101              var comp = Context.RenderComponent<MudTextField<string>>(interval);
102              var textField = comp.Instance;
103              var input = comp.Find("input");
104              input.Input(new ChangeEventArgs() { Value = "Some Value" });
105              textField.Immediate.Should().BeTrue();
106              textField.Value.Should().BeNull();
107              await Task.Delay(100);
108              textField.Value.Should().BeNull();
109              await Task.Delay(150);
110              comp.WaitForAssertion(() => textField.Value.Should().Be("Some Value"));
111          }
112          [Test]
113          public void LabelShouldShrinkWhenPlaceholderIsSet()
114          {
115              using var ctx = new Bunit.TestContext();
116              var label = Parameter(nameof(MudTextField<string>.Label), "label");
117              var placeholder = Parameter(nameof(MudTextField<string>.Placeholder), "placeholder");
118              var comp = ctx.RenderComponent<MudTextField<string>>(label);
119              comp.Markup.Should().NotContain("shrink");
120              comp.SetParametersAndRender(placeholder);
121              comp.Markup.Should().Contain("shrink");
122          }
123          public class FluentValueValidator<T> : AbstractValidator<T>
124          {
125              public FluentValueValidator(Action<IRuleBuilderInitial<T, T>> rule)
126              {
127                  rule(RuleFor(x => x));
128              }
129              private IEnumerable<string> ValidateValue(T arg)
130              {
131                  var result = Validate(arg);
132                  if (result.IsValid)
133                      return Array.Empty<string>();
134                  return result.Errors.Select(e => e.ErrorMessage);
135              }
136              public Func<T, IEnumerable<string>> Validation => ValidateValue;
137          }
138          [Test]
139          public async Task TextFieldFluentValidationTest1()
140          {
141              var validator = new FluentValueValidator<string>(x => x.Cascade(CascadeMode.Stop)
142                  .NotEmpty()
143                  .Length(1, 100)
144                  .CreditCard());
145              var comp = Context.RenderComponent<MudTextField<string>>(Parameter(nameof(MudTextField<string>.Validation), validator.Validation));
146              var textfield = comp.Instance;
147              comp.Find("input").Change("4012 8888 8888 1881");
148              textfield.Error.Should().BeFalse(because: "The number is a valid VISA test credit card number");
149              textfield.ErrorText.Should().BeNullOrEmpty();
150              comp.Find("input").Change("0000 1111 2222 3333");
151              textfield.Error.Should().BeTrue(because: "The credit card number is fake");
152              textfield.ErrorText.Should().NotBeNullOrEmpty();
153          }
154          [Test, Timeout(1000)]
155          public async Task TextFieldUpdateLoopProtectionTest()
156          {
157              var comp = Context.RenderComponent<MudTextField<string>>();
158              var textfield = comp.Instance;
159              textfield.Converter.SetFunc = s => $"{s}x";
160              textfield.Converter.GetFunc = s => $"{s}y";
161              comp.SetParametersAndRender(ComponentParameter.CreateParameter("Value", "A"));
162              textfield.Value.Should().Be("A");
163              textfield.Text.Should().Be("Ax");
164              comp.Find("input").Change("B");
165              textfield.Value.Should().Be("By");
166              textfield.Text.Should().Be("B");
167          }
168          [Test]
169          public async Task TextField_Should_FireValueChangedOnTextParameterChange()
170          {
171              string changed_value = null;
172              var comp = Context.RenderComponent<MudTextField<string>>(EventCallback<string>("ValueChanged", x => changed_value = x));
173              comp.SetParametersAndRender(ComponentParameter.CreateParameter("Text", "A"));
174              changed_value.Should().Be("A");
175          }
176          [Test]
177          public async Task TextField_Should_FireTextChangedOnValueParameterChange()
178          {
179              string changed_text = null;
180              var comp = Context.RenderComponent<MudTextField<string>>(EventCallback<string>("TextChanged", x => changed_text = x));
181              comp.SetParametersAndRender(ComponentParameter.CreateParameter("Value", "A"));
182              changed_text.Should().Be("A");
183          }
184          [Test]
185          public async Task TextField_Should_FireTextAndValueChangedOnTextInput()
186          {
187              string changed_value = null;
188              string changed_text = null;
189              var comp = Context.RenderComponent<MudTextField<string>>(
190                  EventCallback<string>("ValueChanged", x => changed_value = x),
191                  EventCallback<string>("TextChanged", x => changed_text = x)
192              );
193              comp.Find("input").Change("B");
194              changed_value.Should().Be("B");
195              changed_text.Should().Be("B");
196          }
197          [Test]
198          public async Task TextField_ShouldNot_ShowRequiredErrorWhenThereIsAConversionError()
199          {
200              var comp = Context.RenderComponent<MudTextField<int?>>(ComponentParameter.CreateParameter("Required", true));
201              var textfield = comp.Instance;
202              comp.Find("input").Change("A");
203              comp.Find("input").Blur();
204              textfield.Text.Should().Be("A");
205              textfield.HasErrors.Should().Be(true);
206              textfield.ErrorText.Should().Be("Not a valid number");
207          }
208          [Test]
209          public async Task TextField_ShouldNot_ShowRequiredErrorWhenInitialTextIsEmpty()
210          {
211              var comp = Context.RenderComponent<TextFieldRequiredTest>();
212              var textfield = comp.FindComponent<MudTextField<string>>().Instance;
213              textfield.Touched.Should().BeFalse();
214              textfield.ErrorText.Should().BeNullOrEmpty();
215              textfield.HasErrors.Should().Be(false);
216          }
217          [Test]
218          public async Task DebouncedTextField_ShouldNot_ThrowException()
219          {
220              Context.RenderComponent<DebouncedTextFieldTest>();
221          }
222          [Test]
223          public async Task TextFieldMultiline_CheckRenderedText()
224          {
225              var text = "Hello world!";
226              var comp = Context.RenderComponent<MudTextField<string>>(
227                  Parameter(nameof(MudTextField<string>.Text), text),
228                  Parameter(nameof(MudTextField<string>.Lines), 2));
229              var textfield = comp.Instance;
230              comp.Find("textarea").InnerHtml.Should().Be(text);
231          }
232          [Test]
233          public async Task MultilineTextField_Should_UpdateTextOnInput()
234          {
235              var comp = Context.RenderComponent<MudTextField<string>>();
236              var textfield = comp.Instance;
237              comp.Find("input").Change("A");
238              comp.Find("input").Blur();
239              textfield.Text.Should().Be("A");
240              textfield.Value.Should().Be("A");
241              comp.SetParam(x => x.Lines, 2);
242              comp.Find("textarea").Change("B\nC");
243              comp.Find("textarea").Blur();
244              textfield.Text.Should().Be("B\nC");
245              textfield.Value.Should().Be("B\nC");
246          }
247          [Test]
248          public async Task MultiLineTextField_ShouldBe_TwoWayBindable()
249          {
250              var comp = Context.RenderComponent<MultilineTextfieldBindingTest>();
251              var tf1 = comp.FindComponents<MudTextField<string>>()[0].Instance;
252              var tf2 = comp.FindComponents<MudTextField<string>>()[1].Instance;
253              comp.Find("input").Input("Bossmang");
254              comp.Find("input").Blur(); 
255              tf1.Text.Should().Be("Bossmang");
256              tf2.Text.Should().Be("Bossmang");
257              comp.Find("textarea").TrimmedText().Should().Be("Bossmang");
258              comp.Find("textarea").Input("Beltalowda");
259              comp.Find("textarea").Blur(); 
260              tf1.Text.Should().Be("Beltalowda");
261              tf2.Text.Should().Be("Beltalowda");
262              comp.Find("textarea").TrimmedText().Should().Be("Beltalowda");
263              comp.Find("input").Input("Beratna");
264              comp.Find("input").Blur(); 
265              tf1.Text.Should().Be("Beratna");
266              tf2.Text.Should().Be("Beratna");
267              comp.Find("textarea").TrimmedText().Should().Be("Beratna");
268          }
269          [Test]
270          public async Task TextFieldClearableTest()
271          {
272              var comp = Context.RenderComponent<TextFieldClearableTest>();
273              var textField = comp.FindComponent<MudTextField<string>>();
274              comp.FindAll("button").Should().BeEmpty();
275              comp.Find("input").Change("text");
276              textField.Instance.Value.Should().Be("text");
277              comp.Find("button").Should().NotBeNull();
278              comp.Find("button").Click();
279              textField.Instance.Value.Should().BeNullOrEmpty();
280              comp.FindAll("button").Should().BeEmpty();
281              comp.Instance.ClearButtonClicked.Should().BeTrue();
282              comp.Find("input").Change("text");
283              textField.Instance.Value.Should().Be("text");
284              comp.Find("button").Should().NotBeNull();
285              comp.Find("input").Change(string.Empty);
286              comp.FindAll("button").Should().BeEmpty();
287          }
288          [Test]
289          public async Task TextField_ClearButton_TabIndex_Test()
290          {
291              var comp = Context.RenderComponent<MudTextField<string>>(
292                  Parameter(nameof(MudTextField<string>.Clearable), true),
293                  Parameter(nameof(MudTextField<string>.Text), "Test")
294              );
295              comp.Find("button").GetAttribute("tabindex").Should().Be("-1");
296          }
297          #region ValidationAttribute support
298          [Test]
299          public async Task TextField_Should_Validate_Data_Attribute_Fail()
300          {
301              var comp = Context.RenderComponent<TextFieldValidationDataAttrTest>();
302              var textfieldcomp = comp.FindComponent<MudTextField<string>>();
303              var textfield = textfieldcomp.Instance;
304              await comp.InvokeAsync(() => textfield.DebounceInterval = 0);
305              comp.Find("input").Change("Quux");
306              textfield.Value.Should().Be("Quux");
307              textfield.Text.Should().Be("Quux");
308              await comp.InvokeAsync(() => textfield.Validate());
309              textfield.ValidationErrors.Should().NotBeEmpty();
310              textfield.ValidationErrors.Should().HaveCount(1);
311              textfield.ValidationErrors[0].Should().Be("Should not be longer than 3");
312          }
313          [Test]
314          public async Task TextField_Should_Validate_Data_Attribute_Success()
315          {
316              var comp = Context.RenderComponent<TextFieldValidationDataAttrTest>();
317              var textfieldcomp = comp.FindComponent<MudTextField<string>>();
318              var textfield = textfieldcomp.Instance;
319              await comp.InvokeAsync(() => textfield.DebounceInterval = 0);
320              comp.Find("input").Change("Qux");
321              textfield.Value.Should().Be("Qux");
322              textfield.Text.Should().Be("Qux");
323              await comp.InvokeAsync(() => textfield.Validate());
324              textfield.ValidationErrors.Should().BeEmpty();
325          }
326          #region Custom ValidationAttribute
327          public class CustomFailingValidationAttribute : ValidationAttribute
328          {
329              protected override ValidationResult IsValid(object value,
330                  ValidationContext validationContext)
331              {
332                  return new ValidationResult(ErrorMessage);
333              }
334          }
335          class TestFailingModel
336          {
337              [CustomFailingValidation(ErrorMessage = "Foo")]
338              public virtual string Foo { get; set; }
339          }
340          [Test]
341          public async Task TextField_Should_HaveCorrectMessageWithCustomAttr_Failing()
342          {
343              var model = new TestFailingModel();
344              var comp = Context.RenderComponent<MudTextField<string>>(ComponentParameter.CreateParameter("For", (Expression<Func<string>>)(() => model.Foo)));
345              await comp.InvokeAsync(() => comp.Instance.Validate());
346              comp.Instance.Error.Should().BeTrue();
347              comp.Instance.ValidationErrors.Should().HaveCount(1);
348              comp.Instance.ValidationErrors[0].Should().Be("Foo");
349              comp.Instance.GetErrorText().Should().Be("Foo");
350          }
351          class TestFailingModel2 : TestFailingModel
352          {
353              [CustomFailingValidation(ErrorMessage = "Bar")]
354              public override string Foo { get; set; }
355          }
356          [Test]
357          public async Task TextField_Should_HaveCorrectMessageWithCustomAttr_Override_Failing()
358          {
359              TestFailingModel model = new TestFailingModel2();
360              var comp = Context.RenderComponent<MudTextField<string>>(
361                  ComponentParameter.CreateParameter("For", (Expression<Func<string>>)(() => (model as TestFailingModel2).Foo))
362              );
363              await comp.InvokeAsync(() => comp.Instance.Validate());
364              comp.Instance.Error.Should().BeTrue();
365              comp.Instance.ValidationErrors.Should().HaveCount(1);
366              comp.Instance.ValidationErrors[0].Should().Be("Bar");
367              comp.Instance.GetErrorText().Should().Be("Bar");
368          }
369          public class CustomThrowingValidationAttribute : ValidationAttribute
370          {
371              protected override ValidationResult IsValid(object value,
372                  ValidationContext validationContext)
373              {
374                  throw new Exception("This is a test exception");
375              }
376          }
377          class TestThrowingModel
378          {
379              [CustomThrowingValidation]
380              public string Foo { get; set; }
381          }
382          [Test]
383          public async Task TextField_Should_HaveCorrectMessageWithCustomAttr_Throwing()
384          {
385              var model = new TestThrowingModel();
386              var comp = Context.RenderComponent<MudTextField<string>>(ComponentParameter.CreateParameter("For", (Expression<Func<string>>)(() => model.Foo)));
387              await comp.InvokeAsync(() => comp.Instance.Validate());
388              comp.Instance.Error.Should().BeTrue();
389              comp.Instance.ValidationErrors.Should().HaveCount(1);
390              comp.Instance.ValidationErrors[0].Should().Be("An unhandled exception occurred: This is a test exception");
391              comp.Instance.GetErrorText().Should().Be("An unhandled exception occurred: This is a test exception");
392          }
393          #endregion
394          #endregion
395          [Test]
396          public async Task TextField_ClearTest1()
397          {
398              var comp = Context.RenderComponent<MudTextField<int>>();
399              comp.SetParam("Text", "17");
400              var textfield = comp.Instance;
401              textfield.Value.Should().Be(17);
402              textfield.Text.Should().Be("17");
403              await comp.InvokeAsync(async () => await textfield.Clear());
404              textfield.Value.Should().Be(0);
405              textfield.Text.Should().Be(null);
406          }
407          [Test]
408          public async Task TextField_ClearTest2()
409          {
410              var comp = Context.RenderComponent<MudTextField<string>>();
411              comp.Find("input").Change("Viva la ignorancia");
412              var textfield = comp.Instance;
413              textfield.Value.Should().Be("Viva la ignorancia");
414              textfield.Text.Should().Be("Viva la ignorancia");
415              await comp.InvokeAsync(async () => await textfield.Clear());
416              textfield.Value.Should().Be(null);
417              textfield.Text.Should().Be(null);
418          }
419          [Test]
420          public void TextField_CharacterCount()
421          {
422              var comp = Context.RenderComponent<MudTextField<string>>();
423              var inputControl = comp.FindComponent<MudInputControl>();
424              comp.Instance.Counter = null;
425              inputControl.Instance.CounterText.Should().Be("");
426              comp.Instance.Counter = 25;
427              comp.Find("input").Change("Test text");
428              inputControl.Instance.CounterText.Should().Be("9 / 25");
429              comp.Instance.Counter = 0;
430              comp.Find("input").Change("Test text with total of 56 characters a aaaaaaaaa aaaaaa");
431              inputControl.Instance.CounterText.Should().Be("56");
432              comp.Instance.Counter = 25;
433              comp.Instance.MaxLength = 30;
434              comp.Find("input").Change("Test text with total of25");
435              inputControl.Instance.CounterText.Should().Be("25 / 25");
436              comp.Find("input").Change("Test text with total of 56 characters a aaaaaaaaa aaaaaa");
437              inputControl.Instance.CounterText.Should().Be("56 / 25");
438          }
439          [Test]
440          public async Task TextField_TextUpdateSuppression()
441          {
442              var comp = Context.RenderComponent<MudTextField<string>>();
443              var input = comp.FindComponent<MudInput<string>>();
444              var textfield = comp.Instance;
445              comp.Find("input").Change("Vat of acid");
<span onclick='openModal()' class='match'>446              comp.Find("input").KeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", });
447              textfield.Value.Should().Be("Vat of acid");
448              textfield.Text.Should().Be("Vat of acid");
449              input.SetParam("Value", "");
450              input.Instance.Value.Should().Be("");
451              input.Instance.Text.Should().Be("Vat of acid");
452              comp.SetParam(nameof(MudBaseInput<string>.TextUpdateSuppression), false);
453              input.SetParam("Value", "In case of ladle");
454              input.Instance.Value.Should().Be("In case of ladle");
455              input.Instance.Text.Should().Be("In case of ladle");
</span>456              comp.SetParam(nameof(MudBaseInput<string>.TextUpdateSuppression), true);
457              input.SetParam("Value", "");
458              input.Instance.Value.Should().Be("");
459              input.Instance.Text.Should().Be("In case of ladle");
460              await comp.InvokeAsync(() => input.Instance.ForceRender(forceTextUpdate: true));
461              input.Instance.Value.Should().Be("");
462              input.Instance.Text.Should().Be("");
463          }
464          [Test]
465          public async Task TextField_Should_UpdateOnBoundValueChange_WhenFocused_WithTextUpdateSuppressionOff()
466          {
467              var comp = Context.RenderComponent<TextFieldUpdateViaBindingTest>();
468              var input = comp.FindComponent<MudInput<string>>();
469              comp.Find("input").KeyDown(new KeyboardEventArgs() { Key = "a", Type = "keydown", });
470              comp.Find("input").Input("The Stormlight Archive");
471              comp.Find("span").TrimmedText().Should().Be("value: The Stormlight Archive");
472              input.Instance.Value.Should().Be("The Stormlight Archive");
473              input.Instance.Text.Should().Be("The Stormlight Archive");
474              comp.Find("input").KeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", });
475              comp.WaitForAssertion(() => comp.Find("span").TrimmedText().Should().Be("value:"));
476              comp.WaitForAssertion(() => input.Instance.Value.Should().Be(""));
477              comp.WaitForAssertion(() => input.Instance.Text.Should().Be(""));
478          }
479          [Test]
480          public async Task TextField_ElementReferenceId_ShouldNot_BeEmpty()
481          {
482              var comp = Context.RenderComponent<MudTextField<string>>();
483              var inputId = comp.Instance.InputReference.ElementReference.Id;
484              Assert.IsNotEmpty(inputId);
485          }
486          class TestDataAnnotationModel
487          {
488              [Required(ErrorMessage = "The {0} field is required.")]
489              public string Foo1 { get; set; }
490              [Required(ErrorMessage = "The {0} field is required.")]
491              [Display(Name = FooTwoDisplayName)]
492              [Compare(nameof(Foo1), ErrorMessage = "'{0}' and '{1}' do not match.")]
493              public string Foo2 { get; set; }
494              public const string FooTwoDisplayName = "Foo two";
495          }
496          [Test]
497          public async Task TextField_Data_Annotation_Resolve_Name_Of_Field()
498          {
499              var model = new TestDataAnnotationModel();
500              var comp = Context.RenderComponent<MudTextField<string>>(ComponentParameter.CreateParameter("For", (Expression<Func<string>>)(() => model.Foo1)));
501              await comp.InvokeAsync(() => comp.Instance.Validate());
502              comp.Instance.Error.Should().BeTrue();
503              comp.Instance.ValidationErrors.Should().HaveCount(1);
504              comp.Instance.ValidationErrors[0].Should().Be($"The {nameof(TestDataAnnotationModel.Foo1)} field is required.");
505              comp.Instance.GetErrorText().Should().Be($"The {nameof(TestDataAnnotationModel.Foo1)} field is required.");
506              await comp.InvokeAsync(() =>
507              {
508                  comp.Instance.Value = "Foo";
509                  comp.Instance.Validate();
510              });
511              comp.Instance.Error.Should().BeFalse();
512              comp.Instance.ValidationErrors.Should().HaveCount(0);
513          }
514          [Test]
515          public async Task TextField_Data_Annotation_Resolve_Display_Name_Of_Field()
516          {
517              var model = new TestDataAnnotationModel();
518              var comp = Context.RenderComponent<MudTextField<string>>(ComponentParameter.CreateParameter("For", (Expression<Func<string>>)(() => model.Foo2)));
519              await comp.InvokeAsync(() => comp.Instance.Validate());
520              comp.Instance.Error.Should().BeTrue();
521              comp.Instance.ValidationErrors.Should().HaveCount(1);
522              comp.Instance.ValidationErrors[0].Should().Be($"The {TestDataAnnotationModel.FooTwoDisplayName} field is required.");
523              comp.Instance.GetErrorText().Should().Be($"The {TestDataAnnotationModel.FooTwoDisplayName} field is required.");
524          }
525          [Test]
526          public async Task TextField_Data_Annotation_Compare()
527          {
528              var model = new TestDataAnnotationModel();
529              var value = "Foo";
530              var comp = Context.RenderComponent<MudTextField<string>>(
531                  ComponentParameter.CreateParameter("For", (Expression<Func<string>>)(() => model.Foo2)),
532                  ComponentParameter.CreateParameter("Value", value));
533              await comp.InvokeAsync(() => comp.Instance.Validate());
534              comp.Instance.Error.Should().BeTrue();
535              comp.Instance.ValidationErrors.Should().HaveCount(1);
536              comp.Instance.ValidationErrors[0].Should().Be($"'{TestDataAnnotationModel.FooTwoDisplayName}' and '{nameof(TestDataAnnotationModel.Foo1)}' do not match.");
537              comp.Instance.GetErrorText().Should().Be($"'{TestDataAnnotationModel.FooTwoDisplayName}' and '{nameof(TestDataAnnotationModel.Foo1)}' do not match.");
538              model.Foo1 = value;
539              await comp.InvokeAsync(() =>
540              {
541                  comp.Instance.Validate();
542              });
543              comp.Instance.Error.Should().BeFalse();
544              comp.Instance.ValidationErrors.Should().HaveCount(0);
545              comp.WaitForAssertion(() => comp.Instance.GetInputType().Should().Be(InputType.Text));
546              await comp.InvokeAsync(async () => await comp.Instance.SelectAsync());
547              await comp.InvokeAsync(async () => await comp.Instance.SelectRangeAsync(0, 1));
548              comp.WaitForAssertion(() => comp.Instance.ValidationErrors.Should().HaveCount(0));
549          }
550          [Test]
551          public async Task TextField_OnlyValidateIfDirty_Is_True_Should_OnlyHaveInputErrorWhenValueChanged()
552          {
553              var comp = Context.RenderComponent<MudTextField<int?>>(
554                  ComponentParameter.CreateParameter("Required", true),
555                  ComponentParameter.CreateParameter("OnlyValidateIfDirty", true));
556              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
557              comp.Find("input").Blur();
558              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
559              comp.Find("input").Change("invalid");
560              comp.Find("input").Blur();
561              comp.FindAll("div.mud-input-error").Count.Should().Be(1);
562              comp.Find("div.mud-input-error").TextContent.Trim().Should().Be("Not a valid number");
563              comp.Find("input").Blur();
564              comp.FindAll("div.mud-input-error").Count.Should().Be(1);
565              comp.Find("div.mud-input-error").TextContent.Trim().Should().Be("Not a valid number");
566              await comp.InvokeAsync(() => comp.Instance.ResetAsync());
567              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
568              comp.Find("input").Blur();
569              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
570              comp.Find("input").Change("invalid");
571              comp.Find("input").Blur();
572              comp.FindAll("div.mud-input-error").Count.Should().Be(1);
573              comp.Find("div.mud-input-error").TextContent.Trim().Should().Be("Not a valid number");
574              comp.Find("input").Change(55);
575              comp.Find("input").Blur();
576              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
577          }
578          [Test]
579          public async Task TextField_OnlyValidateIfDirty_Is_False_Should_HaveInputErrorWhenFocusChanged()
580          {
581              var comp = Context.RenderComponent<MudTextField<int?>>(
582                  ComponentParameter.CreateParameter("Required", true),
583                  ComponentParameter.CreateParameter("OnlyValidateIfDirty", false));
584              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
585              comp.Find("input").Blur();
586              comp.FindAll("div.mud-input-error").Count.Should().Be(2);
587              comp.Find("div.mud-input-error").TextContent.Trim().Should().Be("Required");
588              comp.Find("input").Change("invalid");
589              comp.Find("input").Blur();
590              comp.FindAll("div.mud-input-error").Count.Should().Be(2);
591              comp.Find("div.mud-input-error").TextContent.Trim().Should().Be("Not a valid number");
592              await comp.InvokeAsync(() => comp.Instance.ResetAsync());
593              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
594              comp.Find("input").Blur();
595              comp.FindAll("div.mud-input-error").Count.Should().Be(2);
596              comp.Find("div.mud-input-error").TextContent.Trim().Should().Be("Required");
597              comp.Find("input").Change(55);
598              comp.Find("input").Blur();
599              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
600          }
601          [Test]
602          public void TextFieldLabelTest()
603          {
604              var value = new DisplayNameLabelClass();
605              var comp = Context.RenderComponent<MudTextField<string>>(x => x.Add(f => f.For, () => value.String));
606              comp.Instance.Label.Should().Be("String LabelAttribute"); 
607              var comp2 = Context.RenderComponent<MudTextField<string>>(x => x.Add(f => f.For, () => value.String).Add(l => l.Label, "Label Parameter"));
608              comp2.Instance.Label.Should().Be("Label Parameter"); 
609          }
610          [Test]
611          public async Task ReadOnlyTextFieldShouldNotValidate()
612          {
613              var comp = Context.RenderComponent<MudTextField<string>>(parameters => parameters
614              .Add(p => p.ReadOnly, true)
615              .Add(p => p.Required, true));
616              comp.Find("input").Blur();
617              comp.FindAll("div.mud-input-error").Count.Should().Be(0);
618          }
619          [Test]
620          public async Task OnBlurErrorContentCaughtException()
621          {
622              var comp = Context.RenderComponent<TextFieldErrorContenCaughtException>();
623              await comp.Find("input").BlurAsync(new FocusEventArgs());
624              var mudAlert = comp.FindComponent<MudAlert>();
625              var text = mudAlert.Find("div.mud-alert-message");
626              text.InnerHtml.Should().Be("Oh my! We caught an error and handled it!");
627          }
628          [Test]
629          public async Task OnKeyDownErrorContentCaughtException()
630          {
631              var comp = Context.RenderComponent<TextFieldErrorContenCaughtException>();
632              await comp.Find("input").KeyDownAsync(new KeyboardEventArgs { Key = "Enter", Type = "keydown" });
633              var mudAlert = comp.FindComponent<MudAlert>();
634              var text = mudAlert.Find("div.mud-alert-message");
635              text.InnerHtml.Should().Be("Oh my! We caught an error and handled it!");
636          }
637          [Test]
638          public async Task OnKeyUpErrorContentCaughtException()
639          {
640              var comp = Context.RenderComponent<TextFieldErrorContenCaughtException>();
641              await comp.Find("input").KeyUpAsync(new KeyboardEventArgs { Key = "Enter", Type = "keyup" });
642              var mudAlert = comp.FindComponent<MudAlert>();
643              var text = mudAlert.Find("div.mud-alert-message");
644              text.InnerHtml.Should().Be("Oh my! We caught an error and handled it!");
645          }
646      }
647  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-MudBadge.razor.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-TextFieldTests.cs</div>
                </div>
                <div class="column column_space"><pre><code>21          new CssBuilder("mud-badge")
22              .AddClass("mud-badge-dot", Dot)
23              .AddClass("mud-badge-bordered", Bordered)
24              .AddClass("mud-badge-icon", !string.IsNullOrEmpty(Icon) && !Dot)
25              .AddClass($"mud-badge-{Origin.ToDescriptionString().Replace("-", " ")}")
26              .AddClass($"mud-elevation-{Elevation.ToString()}")
27              .AddClass("mud-theme-" + Color.ToDescriptionString(), Color != Color.Default)
28              .AddClass("mud-badge-default", Color == Color.Default)
29              .AddClass("mud-badge-overlap", Overlap)
30              .AddClass(BadgeClass)
31          .Build();
</pre></code></div>
                <div class="column column_space"><pre><code>446              comp.Find("input").KeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", });
447              textfield.Value.Should().Be("Vat of acid");
448              textfield.Text.Should().Be("Vat of acid");
449              input.SetParam("Value", "");
450              input.Instance.Value.Should().Be("");
451              input.Instance.Text.Should().Be("Vat of acid");
452              comp.SetParam(nameof(MudBaseInput<string>.TextUpdateSuppression), false);
453              input.SetParam("Value", "In case of ladle");
454              input.Instance.Value.Should().Be("In case of ladle");
455              input.Instance.Text.Should().Be("In case of ladle");
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    