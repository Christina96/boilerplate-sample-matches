
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 42.18958611481976%, Tokens: 32</h2>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-TreeViewTest.cs</h3>
            <pre><code>1  using System;
2  using System.Collections.Generic;
3  using System.Linq;
4  using System.Threading.Tasks;
5  using Bunit;
6  using FluentAssertions;
7  using Microsoft.AspNetCore.Components;
8  using Microsoft.AspNetCore.Components.Web;
9  using MudBlazor.UnitTests.TestComponents;
10  using NUnit.Framework;
11  using static Bunit.ComponentParameterFactory;
12  namespace MudBlazor.UnitTests.Components
13  {
14      [TestFixture]
15      public class TreeViewTest : BunitTest
16      {
17          [Test]
18          public void TreeView_ClickWhileDisabled_DoesNotChangeSelection()
19          {
20              var comp = Context.RenderComponent<DisabledTreeViewTest>(new ComponentParameter[] { Parameter(nameof(MudTreeView<string>.Disabled), true) });
21              comp.Find("div.mud-treeview-item-content").Click();
22              comp.Instance.SelectedValue.Should().BeNull();
23              comp.Find("div.mud-treeview-item-content").DoubleClick();
24              comp.Instance.SelectedValue.Should().BeNull();
25          }
26          [Test]
27          public void TreeView_ClickWhileActive_DoesChangeSelection()
28          {
29              var comp = Context.RenderComponent<DisabledTreeViewTest>(new ComponentParameter[] { Parameter(nameof(MudTreeView<string>.Disabled), false) });
30              comp.Find("div.mud-treeview-item-content").Click();
31              comp.Instance.SelectedValue.Should().NotBeNull();
32              comp.Find("div.mud-treeview-item-content").Click();
33              comp.Instance.SelectedValue.Should().BeNull();
34              comp.Find("div.mud-treeview-item-content").DoubleClick();
35              comp.Instance.SelectedValue.Should().NotBeNull();
36          }
37          [Test]
38          public void Collapsed_ClickOnArrowButton_CheckClose()
39          {
40              var comp = Context.RenderComponent<TreeViewTest1>();
41              comp.FindAll("li.mud-treeview-item").Count.Should().Be(10);
42              comp.Find("button").Click();
43              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(1);
44              comp.Find("button").Click();
45              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(0);
46              comp.Find("div.mud-treeview-item-content").Click();
47              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(0);
48          }
49          [Test]
50          public void Collapsed_ClickOnTreeItem_CheckClose()
51          {
<span onclick='openModal()' class='match'>52              var comp = Context.RenderComponent<TreeViewTest2>();
53              comp.FindAll("li.mud-treeview-item").Count.Should().Be(10);
54              comp.Find("button").Click();
55              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(1);
56              comp.Find("button").Click();
57              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(0);
58              comp.Find("div.mud-treeview-item-content").Click();
59              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(1);
60              comp.Find("div.mud-treeview-item-content").Click();
61              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(0);
62          }
63          [Test]
64          public void Unselected_Select_CheckSelected_Deselect_CheckDeselected()
65          {
66              var comp = Context.RenderComponent<TreeViewTest1>();
67              comp.FindAll("li.mud-treeview-item").Count.Should().Be(10);
</span>68              comp.Find("button").Click();
69              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(1);
70              comp.FindAll("input.mud-checkbox-input").Count.Should().Be(10);
71              comp.Find("input.mud-checkbox-input").Change(true);
72              comp.Instance.SubItemSelected.Should().BeTrue();
73              comp.Instance.ParentItemSelected.Should().BeTrue();
74              comp.FindAll("input.mud-checkbox-input")[2].Change(false);
75              comp.Instance.SubItemSelected.Should().BeFalse();
76              comp.Instance.ParentItemSelected.Should().BeTrue();
77          }
78          [Test]
79          public void Normal_Activate_CheckActivated_ActivateAnother_CheckBoth()
80          {
81              var comp = Context.RenderComponent<TreeViewTest1>();
82              comp.FindAll("div.mud-treeview-item-content.mud-treeview-item-selected").Count.Should().Be(0);
83              comp.Find("div.mud-treeview-item-content").Click();
84              comp.Instance.Item1Activated.Should().BeTrue();
85              comp.Instance.Item2Activated.Should().BeFalse();
86              comp.FindAll("div.mud-treeview-item-content.mud-treeview-item-selected").Count.Should().Be(1);
87              comp.FindAll("div.mud-treeview-item-content")[4].Click();
88              comp.Instance.Item1Activated.Should().BeFalse();
89              comp.Instance.Item2Activated.Should().BeTrue();
90              comp.FindAll("div.mud-treeview-item-content.mud-treeview-item-selected").Count.Should().Be(1);
91          }
92          [Test]
93          public void Normal_Activate_CheckActivated_Deactivate_Check()
94          {
95              var comp = Context.RenderComponent<TreeViewTest1>();
96              comp.FindAll("div.mud-treeview-item-content.mud-treeview-item-selected").Count.Should().Be(0);
97              comp.Find("div.mud-treeview-item-content").Click();
98              comp.Instance.Item1Activated.Should().BeTrue();
99              comp.Instance.Item2Activated.Should().BeFalse();
100              comp.FindAll("div.mud-treeview-item-content.mud-treeview-item-selected").Count.Should().Be(1);
101              comp.Find("div.mud-treeview-item-content").Click();
102              comp.Instance.Item1Activated.Should().BeFalse();
103              comp.Instance.Item2Activated.Should().BeFalse();
104              comp.FindAll("div.mud-treeview-item-content.mud-treeview-item-selected").Count.Should().Be(0);
105          }
106          [Test]
107          public void RenderWithTemplate_CheckResult()
108          {
109              var comp = Context.RenderComponent<TreeViewTemplateTest>();
110              comp.FindAll("li.mud-treeview-item").Count.Should().Be(8);
111          }
112          [Test]
113          public void TreeViewServerTest()
114          {
115              var comp = Context.RenderComponent<TreeViewServerTest>();
116              comp.FindAll("li.mud-treeview-item").Count.Should().Be(4);
117              comp.FindAll("div.mud-treeview-item-content")[0].Click();
118              comp.FindAll("li.mud-treeview-item").Count.Should().Be(4);
119              comp.FindAll("div.mud-treeview-item-content")[3]
120                  .GetElementsByClassName("mud-treeview-item-arrow")[0]
121                  .ChildElementCount.Should().Be(0);
122              comp.FindAll("div.mud-treeview-item-content")[2].Click();
123              comp.FindAll("li.mud-treeview-item").Count.Should().Be(8);
124          }
125          [Test]
126          public async Task TreeView_OtherTest()
127          {
128              var comp = Context.RenderComponent<TreeViewTest2>();
129              var item = comp.FindComponent<MudTreeViewItem<string>>();
130  #pragma warning disable BL0005
131              await comp.InvokeAsync(() => item.Instance.Disabled = true);
132              comp.WaitForAssertion(() => item.Instance.Selected.Should().BeFalse());
133              await comp.InvokeAsync(() => item.Instance.Selected = true);
134              comp.WaitForAssertion(() => item.Instance.Selected.Should().BeTrue());
135              await comp.InvokeAsync(() => item.Instance.SelectItem(true));
136              comp.WaitForAssertion(() => item.Instance.Selected.Should().BeTrue());
137              comp.WaitForAssertion(() => item.Instance.ArrowExpanded.Should().BeFalse());
138              await comp.InvokeAsync(() => item.Instance.ArrowExpanded = true);
139              comp.WaitForAssertion(() => item.Instance.ArrowExpanded.Should().BeTrue());
140              await comp.InvokeAsync(() => item.Instance.ArrowExpanded = true);
141              comp.WaitForAssertion(() => item.Instance.ArrowExpanded.Should().BeTrue());
142              comp.WaitForAssertion(() => item.Instance.Expanded.Should().BeTrue());
143              await comp.InvokeAsync(() => item.Instance.OnItemExpanded(true));
144              comp.WaitForAssertion(() => item.Instance.Expanded.Should().BeTrue());
145              await comp.InvokeAsync(() => item.Instance.Select(false));
146          }
147          [Test]
148          public async Task TreeViewItem_DoubleClick_CheckExpanded()
149          {
150              var comp = Context.RenderComponent<TreeViewTest3>();
151              bool itemIsExpanded = false;
152              var item = comp.FindComponent<MudTreeViewItem<string>>();
153              await item.InvokeAsync(() =>
154                  item.Instance.OnDoubleClick =
155                      new EventCallback<MouseEventArgs>(null, (Action)(() => itemIsExpanded = !itemIsExpanded)));
156              comp.FindAll("li.mud-treeview-item").Count.Should().Be(10);
157              comp.Find("div.mud-treeview-item-content").DoubleClick();
158              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(1);
159              itemIsExpanded.Should().BeTrue();
160              comp.Find("div.mud-treeview-item-content").DoubleClick();
161              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(0);
162              itemIsExpanded.Should().BeFalse();
163          }
164          [Test]
165          public async Task TreeViewItem_DoubleClick_CheckSelected()
166          {
167              var comp = Context.RenderComponent<TreeViewTest3>();
168              string selectedItem = null;
169              var tree = comp.FindComponent<MudTreeView<string>>();
170              await tree.InvokeAsync(() =>
171                  tree.Instance.SelectedValueChanged =
172                      new EventCallback<string>(null, (Action<string>)((s) => selectedItem = s)));
173              comp.Find("div.mud-treeview-item-content").DoubleClick();
174              selectedItem.Should().Be("content");
175          }
176          [Test]
177          public async Task TreeViewItem_ProgrammaticallySelect()
178          {
179              var comp = Context.RenderComponent<TreeViewTest4>();
180              var treeView = comp.FindComponent<MudTreeView<string>>();
181              await comp.InvokeAsync(() => comp.Instance.SelectFirst());
182              comp.WaitForAssertion(() => comp.Instance.selectedValue.Should().Be("content"));
183              await comp.InvokeAsync(() => comp.Instance.SelectSecond());
184              comp.WaitForAssertion(() => comp.Instance.selectedValue.Should().Be("src"));
185              await comp.InvokeAsync(() => comp.Instance.DeselectSecond());
186              comp.WaitForAssertion(() => comp.Instance.selectedValue.Should().Be(null));
187          }
188          [Test]
189          public async Task TreeViewItem_BodyContent()
190          {
191              var comp = Context.RenderComponent<TreeViewTest5>();
192              var treeView = comp.FindComponent<MudTreeView<TreeViewTest5.TreeItemData>>();
193              var treeViewItem = comp.FindComponents<MudTreeViewItem<TreeViewTest5.TreeItemData>>()[2];
194              comp.FindAll("ul.mud-treeview").Count.Should().Be(5);
195              comp.FindAll("li.mud-treeview-item").Count.Should().Be(4);
196              comp.FindAll("div.mud-treeview-item-content").Count.Should().Be(4);
197              comp.FindAll("div.mud-treeview-item-arrow").Count.Should().Be(4);
198              comp.FindAll("div.mud-treeview-item-icon").Count.Should().Be(4);
199              comp.FindAll("div.mud-treeview-item-bodycontent").Count.Should().Be(4);
200              comp.FindAll("button.mud-treeview-item-arrow-expand").Count.Should().Be(4);
201              comp.FindAll("p.mud-typography")[0].InnerHtml.MarkupMatches("This is item one");
202              comp.FindAll("p.mud-typography")[1].InnerHtml.MarkupMatches("This is item two");
203              comp.FindAll("p.mud-typography")[2].InnerHtml.MarkupMatches("This is item three");
204              comp.FindAll("p.mud-typography")[3].InnerHtml.MarkupMatches("This is item six");
205              comp.FindAll("div").Count.Should().Be(32);
206              comp.FindAll("button").Count.Should().Be(12);
207              comp.Instance.SimulateUpdateRoot = true;
208  			treeView.SetParam("Items", await comp.Instance.LoadServerData(null));
209              comp.FindAll("p.mud-typography")[1].InnerHtml.MarkupMatches("This is item 2");
210              comp.FindAll("button.mud-treeview-item-arrow-expand")[2].Click();
211              comp.FindAll("p.mud-typography")[3].InnerHtml.MarkupMatches("This is item four");
212              comp.FindAll("p.mud-typography")[4].InnerHtml.MarkupMatches("This is item five");
213              comp.Instance.SimulateUpdate3 = true;
214              await treeViewItem.InvokeAsync(treeViewItem.Instance.ReloadAsync);
215              comp.FindAll("p.mud-typography")[3].InnerHtml.MarkupMatches("This is item 4");
216              comp.FindAll("p.mud-typography")[4].InnerHtml.MarkupMatches("This is item 5");
217          }
218      }
219  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-DialogTests.cs</h3>
            <pre><code>1  #pragma warning disable CS1998 
2  using System;
3  using System.Linq;
4  using System.Runtime.CompilerServices;
5  using System.Threading;
6  using System.Threading.Tasks;
7  using Bunit;
8  using FluentAssertions;
9  using Microsoft.AspNetCore.Components.Web;
10  using Microsoft.Extensions.DependencyInjection;
11  using MudBlazor.UnitTests.TestComponents;
12  using MudBlazor.UnitTests.TestComponents.Dialog;
13  using NUnit.Framework;
14  namespace MudBlazor.UnitTests.Components
15  {
16      [TestFixture]
17      public class DialogTests : BunitTest
18      {
19          [Test]
20          public async Task LifecycleTest()
21          {
22              var comp = Context.RenderComponent<MudDialogProvider>();
23              var service = Context.Services.GetService<IDialogService>() as DialogService;
24              service.Should().NotBe(null);
25              IDialogReference dialogReference = null;
26              await comp.InvokeAsync(async () =>
27              {
28                  dialogReference = service?.Show<DialogRender>();
29                  var result1 = await dialogReference.Result;
30                  dialogReference = service?.Show<DialogRender>();
31                  var result2 = await dialogReference.Result;
32              });
33              DialogRender.OnInitializedCount.Should().Be(2);
34              DialogRender.OnInitializedCount = 0;
35          }
36          [Test]
37          public async Task SimpleTest()
38          {
39              var comp = Context.RenderComponent<MudDialogProvider>();
40              comp.Markup.Trim().Should().BeEmpty();
41              var service = Context.Services.GetService<IDialogService>() as DialogService;
42              service.Should().NotBe(null);
43              IDialogReference dialogReference = null;
44              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
45              dialogReference.Should().NotBe(null);
46              comp.Find("div.mud-dialog-container").Should().NotBe(null);
47              comp.Find("p.mud-typography").TrimmedText().Should().Be("Wabalabadubdub!");
48              comp.Find("div.mud-overlay").Click();
49              comp.Markup.Trim().Should().BeEmpty();
50              var result = await dialogReference.Result;
51              result.Canceled.Should().BeTrue();
52              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
53              comp.FindAll("button")[0].Click();
54              result = await dialogReference.Result;
55              result.Canceled.Should().BeTrue();
56              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
57              comp.FindAll("button")[1].Click();
58              result = await dialogReference.Result;
59              result.Canceled.Should().BeFalse();
60              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
61              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
62              var cont = comp.FindAll("div.mud-dialog-container");
63              cont.Count.Should().Be(2);
64              await comp.InvokeAsync(() => comp.Instance.DismissAll());
65              cont = comp.FindAll("div.mud-dialog-container");
66              cont.Count.Should().Be(0);
67          }
68          [Test]
69          [Obsolete]
70          public async Task ObsoleteEquivalenceTest()
71          {
72              var value = "Test";
73              var result = new DialogResult(value, value.GetType(), false);
74              result.Canceled.Should().BeFalse();
75              result.Cancelled.Should().Be(result.Canceled);
76              result = new DialogResult(value, value.GetType(), true);
77              result.Canceled.Should().BeTrue();
78              result.Cancelled.Should().Be(result.Canceled);
79          }
80          [Test]
81          public async Task InlineDialogTest()
82          {
83              var comp = Context.RenderComponent<MudDialogProvider>();
84              comp.Markup.Trim().Should().BeEmpty();
85              var service = Context.Services.GetService<IDialogService>() as DialogService;
86              service.Should().NotBe(null);
87              var comp1 = Context.RenderComponent<TestInlineDialog>();
88              comp1.FindComponents<MudButton>().Count.Should().Be(1);
89              comp1.Find("button").Click();
90              comp1.WaitForAssertion(() =>
91                  comp.Find("div.mud-dialog-container").Should().NotBe(null)
92              );
93              comp.Find("p.mud-typography").TrimmedText().Should().Be("Wabalabadubdub!");
94              comp.Find("div.mud-dialog").GetAttribute("class").Should().Contain("mud-dialog-width-full");
95              comp.Find("button").Click();
96              comp.Markup.Trim().Should().BeEmpty();
97          }
98          [Test]
99          public async Task NestedInlineDialogTest()
100          {
101              var provider = Context.RenderComponent<MudDialogProvider>();
102              provider.Markup.Trim().Should().BeEmpty();
103              var service = Context.Services.GetService<IDialogService>() as DialogService;
104              service.Should().NotBe(null);
105              var comp = Context.RenderComponent<TestNestedInlineDialog>();
106              comp.FindComponents<MudButton>().Count.Should().Be(1);
107              comp.Find("button").Click();
108              comp.WaitForAssertion(() =>
109                  provider.Find("div.mud-dialog-container").Should().NotBe(null)
110              );
111              provider.Find("p.mud-typography").TrimmedText().Should().Be("Scorpiany!");
112              provider.FindComponents<MudText>().Count.Should().Be(2); 
113              provider.Find("button").Click(); 
114              comp.WaitForAssertion(() =>
115                  provider.Find(".nested").Should().NotBe(null)
116              );
117              provider.FindAll("p.mud-typography")[1].TrimmedText().Should().Be("Nested dialog!");
118              provider.FindComponents<MudText>().Count.Should().Be(4); 
119          }
120          [Test]
121          public async Task InlineDialog_Should_UpdateIsVisibleOnClose()
122          {
123              await ImproveChanceOfSuccess(async () =>
124              {
125                  var comp = Context.RenderComponent<MudDialogProvider>();
126                  comp.Markup.Trim().Should().BeEmpty();
127                  var service = Context.Services.GetService<IDialogService>() as DialogService;
128                  service.Should().NotBe(null);
129                  var comp1 = Context.RenderComponent<InlineDialogIsVisibleStateTest>();
130                  comp1.Find("button").Click();
<span onclick='openModal()' class='match'>131                  comp.WaitForAssertion(() => comp.Find("div.mud-dialog-container").Should().NotBe(null));
132                  comp.Find("div.mud-overlay").Click();
133                  comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
134                  comp1.Find("button").Click();
135                  comp.WaitForAssertion(() => comp.Find("div.mud-dialog-container").Should().NotBe(null),
136                      TimeSpan.FromSeconds(5));
137                  comp.WaitForAssertion(() => comp.Find("div.mud-overlay").Should().NotBeNull());
138                  comp.Find("div.mud-overlay").Click();
139                  comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
140              });
141          }
142          [Test]
143          public async Task InlineDialogShouldHonorClassAndStyle()
144          {
145              var comp = Context.RenderComponent<MudDialogProvider>();
146              comp.Markup.Trim().Should().BeEmpty();
</span>147              var service = Context.Services.GetService<IDialogService>() as DialogService;
148              service.Should().NotBe(null);
149              IDialogReference dialogReference = null;
150              await comp.InvokeAsync(() => dialogReference = service?.Show<TestInlineDialog>());
151              comp.WaitForAssertion(() => dialogReference.Should().NotBe(null));
152              comp.Find("button").Click();
153              comp.WaitForAssertion(() => comp.Find("div.mud-dialog").ClassList.Should().Contain("test-class"));
154              comp.Find("div.mud-dialog").Attributes["style"].Value.Should().Be("color: red;");
155              comp.Find("div.mud-dialog-content").Attributes["style"].Value.Should().Be("color: blue;");
156              comp.Find("div.mud-dialog-content").ClassList.Should().NotContain("test-class");
157              comp.Find("div.mud-dialog-content").ClassList.Should().Contain("content-class");
158              var dialogInstance = comp.FindComponent<MudDialog>().Instance;
159              dialogInstance.Tag.Should().Be("test-tag");
160          }
161          [Test]
162          public async Task InlineDialogShouldNotCloseAfterStateHasChanged()
163          {
164              var comp = Context.RenderComponent<MudDialogProvider>();
165              comp.Markup.Trim().Should().BeEmpty();
166              var service = Context.Services.GetService<IDialogService>() as DialogService;
167              service.Should().NotBe(null);
168              var comp1 = Context.RenderComponent<TestInlineDialog>();
169              comp1.Find("button").Click();
170              comp.Find("span.mud-rating-item").FirstElementChild.Click();
171              comp.WaitForAssertion(() => comp.Find("div.mud-dialog-container").Should().NotBe(null), TimeSpan.FromSeconds(5));
172          }
173          [Test]
174          public async Task DialogShouldUpdateTitleContent()
175          {
176              var comp = Context.RenderComponent<MudDialogProvider>();
177              comp.Markup.Trim().Should().BeEmpty();
178              var service = Context.Services.GetService<IDialogService>() as DialogService;
179              service.Should().NotBe(null);
180              IDialogReference dialogReference = null;
181              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogThatUpdatesItsTitle>());
182              dialogReference.Should().NotBe(null);
183              comp.Find("div.mud-dialog-content").TrimmedText().Should().Be("Body:");
184              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title:");
185              comp.FindAll("button")[1].Click();
186              comp.Find("div.mud-dialog-content").TrimmedText().Should().Be("Body: Test123");
187              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title: Test123");
188          }
189          [Test]
190          public async Task DialogShouldNotOverwriteParameters()
191          {
192              var comp = Context.RenderComponent<MudDialogProvider>();
193              comp.Markup.Trim().Should().BeEmpty();
194              var service = Context.Services.GetService<IDialogService>() as DialogService;
195              service.Should().NotBe(null);
196              IDialogReference dialogReference = null;
197              var parameters = new DialogParameters();
198              parameters.Add("TestValue", "test");
199              parameters.Add("Color_Test", Color.Error); 
200              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogWithParameters>(string.Empty, parameters));
201              dialogReference.Should().NotBe(null);
202              var textField = comp.FindComponent<MudInput<string>>().Instance;
203              textField.Text.Should().Be("test");
204              comp.Find("input").Change("new_test");
205              comp.Find("input").Blur();
206              textField.Text.Should().Be("new_test");
207              comp.FindAll("button")[0].Click();
208              ((DialogWithParameters)dialogReference.Dialog).TestValue.Should().Be("new_test");
209              ((DialogWithParameters)dialogReference.Dialog).ParamtersSetCounter.Should().Be(1);
210              textField.Text.Should().Be("new_test");
211          }
212          [Test]
213          public async Task DialogShouldHonorClassAndStyle()
214          {
215              var comp = Context.RenderComponent<MudDialogProvider>();
216              comp.Markup.Trim().Should().BeEmpty();
217              var service = Context.Services.GetService<IDialogService>() as DialogService;
218              service.Should().NotBe(null);
219              IDialogReference dialogReference = null;
220              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>());
221              dialogReference.Should().NotBe(null);
222              comp.Find("div.mud-dialog").ClassList.Should().Contain("test-class");
223              comp.Find("div.mud-dialog").Attributes["style"].Value.Should().Be("color: red;");
224              comp.Find("div.mud-dialog-content").Attributes["style"].Value.Should().Be("color: blue;");
225              comp.Find("div.mud-dialog-content").ClassList.Should().NotContain("test-class");
226              comp.Find("div.mud-dialog-content").ClassList.Should().Contain("content-class");
227          }
228          [Test]
229          public async Task PassingEventCallbackToDialogViaParameters()
230          {
231              var comp = Context.RenderComponent<MudDialogProvider>();
232              comp.Markup.Trim().Should().BeEmpty();
233              var service = Context.Services.GetService<IDialogService>() as DialogService;
234              service.Should().NotBe(null);
235              var testComp = Context.RenderComponent<DialogWithEventCallbackTest>();
236              testComp.Find("button").Click();
237              var tf = comp.FindComponent<MudTextField<string>>();
238              tf.Find("input").Input("User input ...");
239              testComp.WaitForAssertion(() =>
240                  testComp.Find("p").TextContent.Trim().Should().Be("Search Text:  User input ...")
241              );
242          }
243          [Test]
244          public async Task CustomDialogService()
245          {
246              Context.Services.Remove(Context.Services.FirstOrDefault(descriptor => descriptor.ServiceType == typeof(IDialogService)));
247              Context.Services.AddScoped<IDialogService>(sp => new CustomDialogService());
248              var comp = Context.RenderComponent<MudDialogProvider>();
249              comp.Markup.Trim().Should().BeEmpty();
250              var service = Context.Services.GetService<IDialogService>();
251              service.Should().NotBe(null);
252              service.Should().BeAssignableTo(typeof(CustomDialogService));
253              IDialogReference dialogReference = null;
254              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogThatUpdatesItsTitle>());
255              dialogReference.Should().NotBe(null);
256              dialogReference.Should().BeAssignableTo(typeof(CustomDialogReference));
257              var customDialogReference = (CustomDialogReference)dialogReference;
258              customDialogReference.AllowDismiss.Should().BeFalse();
259              comp.Find("div.mud-overlay").Click();
260              comp.WaitForAssertion(() => comp.Markup.Trim().Should().NotBeEmpty(), TimeSpan.FromSeconds(5));
261              customDialogReference.AllowDismiss = true;
262              comp.Find("div.mud-overlay").Click();
263              comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
264          }
265          [Test]
266          public async Task DialogShouldReturnTheReturnValue()
267          {
268              var comp = Context.RenderComponent<MudDialogProvider>();
269              comp.Markup.Trim().Should().BeEmpty();
270              var service = Context.Services.GetService<IDialogService>() as DialogService;
271              service.Should().NotBe(null);
272              IDialogReference dialogReference = null;
273              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogWithReturnValue>());
274              dialogReference.Should().NotBe(null);
275              comp.FindAll("button")[0].Click();
276              var rv = await dialogReference.GetReturnValueAsync<string>();
277              rv.Should().BeNull();
278              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogWithReturnValue>());
279              comp.FindAll("button")[1].Click();
280              rv = await dialogReference.GetReturnValueAsync<string>();
281              rv.Should().Be("Closed via OK");
282          }
283          [Test]
284          public async Task DialogKeyboardNavigation()
285          {
286              var comp = Context.RenderComponent<MudDialogProvider>();
287              comp.Markup.Trim().Should().BeEmpty();
288              var service = Context.Services.GetService<IDialogService>() as DialogService;
289              service.Should().NotBe(null);
290              IDialogReference dialogReference = null;
291              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>(string.Empty, new DialogOptions() { CloseOnEscapeKey = true }));
292              dialogReference.Should().NotBe(null);
293              var dialog1 = (DialogOkCancel)dialogReference.Dialog;
294              comp.Markup.Trim().Should().NotBeEmpty();
295              await comp.InvokeAsync(() => dialog1.MudDialog.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
296              comp.Markup.Trim().Should().BeEmpty();
297              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogOkCancel>(string.Empty, new DialogOptions() { CloseOnEscapeKey = false }));
298              dialogReference.Should().NotBe(null);
299              var dialog2 = (DialogOkCancel)dialogReference.Dialog;
300              comp.Markup.Trim().Should().NotBeEmpty();
301              await comp.InvokeAsync(() => dialog2.MudDialog.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
302              comp.Markup.Trim().Should().NotBeEmpty();
303          }
304          [Test]
305          public async Task DialogHandlesOnBackdropClickEvent()
306          {
307              var comp = Context.RenderComponent<MudDialogProvider>();
308              comp.Markup.Trim().Should().BeEmpty();
309              var service = Context.Services.GetService<IDialogService>() as DialogService;
310              service.Should().NotBe(null);
311              IDialogReference dialogReference = null;
312              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogWithOnBackdropClickEvent>());
313              dialogReference.Should().NotBe(null);
314              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title:");
315              comp.Find("div.mud-overlay").Click();
316              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title: Backdrop clicked");
317          }
318          [Test]
319          public async Task InlineDialogBug4871Test()
320          {
321              var comp = Context.RenderComponent<MudDialogProvider>();
322              comp.Markup.Trim().Should().BeEmpty();
323              var service = Context.Services.GetService<IDialogService>() as DialogService;
324              service.Should().NotBe(null);
325              var comp1 = Context.RenderComponent<TestInlineDialog>();
326              comp1.FindComponents<MudButton>().Count.Should().Be(1);
327              comp1.Find("button").Click();
328              comp1.WaitForAssertion(() =>
329                  comp.Find("div.mud-dialog-container").Should().NotBe(null)
330              );
331              comp.Find("p.mud-typography").TrimmedText().Should().Be("Wabalabadubdub!");
332              comp.Find("div.mud-dialog").GetAttribute("class").Should().Contain("mud-dialog-width-full");
333              comp.FindAll("button").Last().Click();
334              comp.WaitForAssertion(() => comp.FindComponent<MudMessageBox>());
335              var messageBox = comp.FindComponent<MudMessageBox>();
336              messageBox.Should().NotBeNull();
337              messageBox.Instance.YesText.Should().Be("BUG4871");
338          }
339          [Test]
340          public async Task DialogToggleFullscreenOptions()
341          {
342              var comp = Context.RenderComponent<MudDialogProvider>();
343              comp.Markup.Trim().Should().BeEmpty();
344              var service = Context.Services.GetService<IDialogService>() as DialogService;
345              service.Should().NotBe(null);
346              IDialogReference dialogReference = null;
347              await comp.InvokeAsync(() => dialogReference = service?.Show<DialogToggleFullscreen>());
348              dialogReference.Should().NotBe(null);
349              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-width-sm");
350              comp.Find("button").Click();
351              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-fullscreen");
352              comp.Find("button").Click();
353              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-width-sm");
354          }
355          [Test]
356          public async Task AsyncLifecycleTest()
357          {
358              var comp = Context.RenderComponent<MudDialogProvider>();
359              var service = Context.Services.GetService<IDialogService>() as DialogService;
360              service.Should().NotBe(null);
361              await comp.InvokeAsync(async () =>
362              {
363                  var dialogReference = await service!.ShowAsync<DialogRender>();
364                  await dialogReference.Result;
365                  dialogReference = await service.ShowAsync<DialogRender>();
366                  await dialogReference.Result;
367              });
368              DialogRender.OnInitializedCount.Should().Be(2);
369              DialogRender.OnInitializedCount = 0;
370          }
371          [Test]
372          public async Task AsyncSimpleTest()
373          {
374              var comp = Context.RenderComponent<MudDialogProvider>();
375              comp.Markup.Trim().Should().BeEmpty();
376              var service = Context.Services.GetService<IDialogService>() as DialogService;
377              service.Should().NotBe(null);
378              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
379              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
380              var dialogReference = await dialogReferenceLazy.Value;
381              dialogReference.Should().NotBe(null);
382              comp.Find("div.mud-dialog-container").Should().NotBe(null);
383              comp.Find("p.mud-typography").TrimmedText().Should().Be("Wabalabadubdub!");
384              comp.Find("div.mud-overlay").Click();
385              comp.Markup.Trim().Should().BeEmpty();
386              var result = await dialogReference.Result;
387              result.Canceled.Should().BeTrue();
388              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
389              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
390              dialogReference = await dialogReferenceLazy.Value;
391              comp.FindAll("button")[0].Click();
392              result = await dialogReference.Result;
393              result.Canceled.Should().BeTrue();
394              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
395              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
396              dialogReference = await dialogReferenceLazy.Value;
397              comp.FindAll("button")[1].Click();
398              result = result = await dialogReference.Result;
399              result.Canceled.Should().BeFalse();
400              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
401              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
402              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
403              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
404              var cont = comp.FindAll("div.mud-dialog-container");
405              cont.Count.Should().Be(2);
406              await comp.InvokeAsync(() => comp.Instance.DismissAll());
407              cont = comp.FindAll("div.mud-dialog-container");
408              cont.Count.Should().Be(0);
409          }
410          [Test]
411          public async Task InlineAsyncDialogShouldHonorClassAndStyle()
412          {
413              var comp = Context.RenderComponent<MudDialogProvider>();
414              comp.Markup.Trim().Should().BeEmpty();
415              var service = Context.Services.GetService<IDialogService>() as DialogService;
416              service.Should().NotBe(null);
417              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<TestInlineDialog>());
418              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
419              var dialogReference = await dialogReferenceLazy.Value;
420              comp.WaitForAssertion(() => dialogReference.Should().NotBe(null));
421              comp.Find("button").Click();
422              comp.WaitForAssertion(() => comp.Find("div.mud-dialog").ClassList.Should().Contain("test-class"));
423              comp.Find("div.mud-dialog").Attributes["style"].Value.Should().Be("color: red;");
424              comp.Find("div.mud-dialog-content").Attributes["style"].Value.Should().Be("color: blue;");
425              comp.Find("div.mud-dialog-content").ClassList.Should().NotContain("test-class");
426              comp.Find("div.mud-dialog-content").ClassList.Should().Contain("content-class");
427              var dialogInstance = comp.FindComponent<MudDialog>().Instance;
428              dialogInstance.Tag.Should().Be("test-tag");
429          }
430          [Test]
431          public async Task AsyncDialogShouldUpdateTitleContent()
432          {
433              var comp = Context.RenderComponent<MudDialogProvider>();
434              comp.Markup.Trim().Should().BeEmpty();
435              var service = Context.Services.GetService<IDialogService>() as DialogService;
436              service.Should().NotBe(null);
437              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogThatUpdatesItsTitle>());
438              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
439              var dialogReference = await dialogReferenceLazy.Value;
440              dialogReference.Should().NotBe(null);
441              comp.Find("div.mud-dialog-content").TrimmedText().Should().Be("Body:");
442              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title:");
443              comp.FindAll("button")[1].Click();
444              comp.Find("div.mud-dialog-content").TrimmedText().Should().Be("Body: Test123");
445              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title: Test123");
446          }
447          [Test]
448          public async Task AsyncDialogShouldNotOverwriteParameters()
449          {
450              var comp = Context.RenderComponent<MudDialogProvider>();
451              comp.Markup.Trim().Should().BeEmpty();
452              var service = Context.Services.GetService<IDialogService>() as DialogService;
453              service.Should().NotBe(null);
454              var parameters = new DialogParameters();
455              parameters.Add("TestValue", "test");
456              parameters.Add("Color_Test", Color.Error); 
457              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogWithParameters>(string.Empty, parameters));
458              await comp.InvokeAsync(()=> dialogReferenceLazy.Value);
459              var dialogReference = await dialogReferenceLazy.Value;
460              dialogReference.Should().NotBe(null);
461              var textField = comp.FindComponent<MudInput<string>>().Instance;
462              textField.Text.Should().Be("test");
463              comp.Find("input").Change("new_test");
464              comp.Find("input").Blur();
465              textField.Text.Should().Be("new_test");
466              comp.FindAll("button")[0].Click();
467              ((DialogWithParameters)dialogReference.Dialog).TestValue.Should().Be("new_test");
468              ((DialogWithParameters)dialogReference.Dialog).ParamtersSetCounter.Should().Be(1);
469              textField.Text.Should().Be("new_test");
470          }
471          [Test]
472          public async Task AsyncDialogShouldHonorClassAndStyle()
473          {
474              var comp = Context.RenderComponent<MudDialogProvider>();
475              comp.Markup.Trim().Should().BeEmpty();
476              var service = Context.Services.GetService<IDialogService>() as DialogService;
477              service.Should().NotBe(null);
478              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
479              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
480              var dialogReference = await dialogReferenceLazy.Value;
481              dialogReference.Should().NotBe(null);
482              comp.Find("div.mud-dialog").ClassList.Should().Contain("test-class");
483              comp.Find("div.mud-dialog").Attributes["style"].Value.Should().Be("color: red;");
484              comp.Find("div.mud-dialog-content").Attributes["style"].Value.Should().Be("color: blue;");
485              comp.Find("div.mud-dialog-content").ClassList.Should().NotContain("test-class");
486              comp.Find("div.mud-dialog-content").ClassList.Should().Contain("content-class");
487          }
488          [Test]
489          public async Task AsyncCustomDialogService()
490          {
491              Context.Services.Remove(Context.Services.FirstOrDefault(descriptor => descriptor.ServiceType == typeof(IDialogService)));
492              Context.Services.AddScoped<IDialogService>(sp => new CustomDialogService());
493              var comp = Context.RenderComponent<MudDialogProvider>();
494              comp.Markup.Trim().Should().BeEmpty();
495              var service = Context.Services.GetService<IDialogService>();
496              service.Should().NotBe(null);
497              service.Should().BeAssignableTo(typeof(CustomDialogService));
498              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogThatUpdatesItsTitle>());
499              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
500              var dialogReference = await dialogReferenceLazy.Value;
501              dialogReference.Should().NotBe(null);
502              dialogReference.Should().BeAssignableTo(typeof(CustomDialogReference));
503              var customDialogReference = (CustomDialogReference)dialogReference;
504              customDialogReference.AllowDismiss.Should().BeFalse();
505              comp.Find("div.mud-overlay").Click();
506              comp.WaitForAssertion(() => comp.Markup.Trim().Should().NotBeEmpty(), TimeSpan.FromSeconds(5));
507              customDialogReference.AllowDismiss = true;
508              comp.Find("div.mud-overlay").Click();
509              comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
510          }
511          [Test]
512          public async Task AsyncDialogShouldReturnTheReturnValue()
513          {
514              var comp = Context.RenderComponent<MudDialogProvider>();
515              comp.Markup.Trim().Should().BeEmpty();
516              var service = Context.Services.GetService<IDialogService>() as DialogService;
517              service.Should().NotBe(null);
518              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogWithReturnValue>());
519              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
520              var dialogReference = await dialogReferenceLazy.Value;
521              dialogReference.Should().NotBe(null);
522              comp.FindAll("button")[0].Click();
523              var rv = await dialogReference.GetReturnValueAsync<string>();
524              rv.Should().BeNull();
525              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogWithReturnValue>());
526              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
527              comp.FindAll("button")[1].Click();
528              dialogReference = await dialogReferenceLazy.Value;
529              rv = await dialogReference.GetReturnValueAsync<string>();
530              rv.Should().Be("Closed via OK");
531          }
532          [Test]
533          public async Task AsyncDialogKeyboardNavigation()
534          {
535              var comp = Context.RenderComponent<MudDialogProvider>();
536              comp.Markup.Trim().Should().BeEmpty();
537              var service = Context.Services.GetService<IDialogService>() as DialogService;
538              service.Should().NotBe(null);
539              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>(string.Empty, new DialogOptions() { CloseOnEscapeKey = true }));
540              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
541              dialogReferenceLazy.Value.Should().NotBe(null);
542              var dialogReference = await dialogReferenceLazy.Value;
543              var dialog1 = (DialogOkCancel)dialogReference.Dialog;
544              comp.Markup.Trim().Should().NotBeEmpty();
545              await comp.InvokeAsync(() => dialog1.MudDialog.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
546              comp.Markup.Trim().Should().BeEmpty();
547              dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>(string.Empty, new DialogOptions() { CloseOnEscapeKey = false }));
548              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
549              dialogReference = await dialogReferenceLazy.Value;
550              dialogReference.Should().NotBe(null);
551              var dialog2 = (DialogOkCancel)dialogReference.Dialog;
552              comp.Markup.Trim().Should().NotBeEmpty();
553              await comp.InvokeAsync(() => dialog2.MudDialog.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
554              comp.Markup.Trim().Should().NotBeEmpty();
555          }
556          [Test]
557          public async Task AsyncDialogHandlesOnBackdropClickEvent()
558          {
559              var comp = Context.RenderComponent<MudDialogProvider>();
560              comp.Markup.Trim().Should().BeEmpty();
561              var service = Context.Services.GetService<IDialogService>() as DialogService;
562              service.Should().NotBe(null);
563              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogWithOnBackdropClickEvent>());
564              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
565              var dialogReference = await dialogReferenceLazy.Value;
566              dialogReference.Should().NotBe(null);
567              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title:");
568              comp.Find("div.mud-overlay").Click();
569              comp.Find("div.mud-dialog-title").TrimmedText().Should().Be("Title: Backdrop clicked");
570          }
571          [Test]
572          public async Task AsyncDialogToggleFullscreenOptions()
573          {
574              var comp = Context.RenderComponent<MudDialogProvider>();
575              comp.Markup.Trim().Should().BeEmpty();
576              var service = Context.Services.GetService<IDialogService>() as DialogService;
577              service.Should().NotBe(null);
578              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogToggleFullscreen>());
579              await comp.InvokeAsync(() => dialogReferenceLazy.Value);
580              var dialogReference = await dialogReferenceLazy.Value;
581              dialogReference.Should().NotBe(null);
582              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-width-sm");
583              comp.Find("button").Click();
584              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-fullscreen");
585              comp.Find("button").Click();
586              comp.Find("div.mud-dialog").GetAttribute("class").Should().Be("mud-dialog mud-dialog-width-sm");
587          }
588          [Test]
589          public async Task ShowAsyncRenderCompleteTest()
590          {
591              var comp = Context.RenderComponent<MudDialogProvider>();
592              var service = Context.Services.GetService<IDialogService>();
593              var dialogReferenceLazy = new Lazy<Task<IDialogReference>>(() => service?.ShowAsync<DialogOkCancel>());
594              await comp.InvokeAsync(async () => await dialogReferenceLazy.Value);
595              var dialogReference = await dialogReferenceLazy.Value;
596              var result = await dialogReference.RenderCompleteTaskCompletionSource.Task;
597              result.Should().Be(true);
598          }
599          [Test]
600          public void MockIDialogReferenceShouldWork()
601          {
602              Func<IDialogReference> createMock = Moq.Mock.Of<IDialogReference>;
603              createMock.Should().NotThrow();
604          }
605      }
606      internal class CustomDialogService : DialogService
607      {
608          public override IDialogReference CreateReference() => new CustomDialogReference(Guid.NewGuid(), this);
609      }
610      internal class CustomDialogReference : DialogReference
611      {
612          public bool AllowDismiss { get; set; }
613          public CustomDialogReference(Guid dialogInstanceId, IDialogService dialogService) : base(dialogInstanceId, dialogService) { }
614          public override bool Dismiss(DialogResult result)
615          {
616              return AllowDismiss;
617          }
618      }
619  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-TreeViewTest.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-DialogTests.cs</div>
                </div>
                <div class="column column_space"><pre><code>52              var comp = Context.RenderComponent<TreeViewTest2>();
53              comp.FindAll("li.mud-treeview-item").Count.Should().Be(10);
54              comp.Find("button").Click();
55              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(1);
56              comp.Find("button").Click();
57              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(0);
58              comp.Find("div.mud-treeview-item-content").Click();
59              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(1);
60              comp.Find("div.mud-treeview-item-content").Click();
61              comp.FindAll("li.mud-treeview-item .mud-collapse-container.mud-collapse-entering").Count.Should().Be(0);
62          }
63          [Test]
64          public void Unselected_Select_CheckSelected_Deselect_CheckDeselected()
65          {
66              var comp = Context.RenderComponent<TreeViewTest1>();
67              comp.FindAll("li.mud-treeview-item").Count.Should().Be(10);
</pre></code></div>
                <div class="column column_space"><pre><code>131                  comp.WaitForAssertion(() => comp.Find("div.mud-dialog-container").Should().NotBe(null));
132                  comp.Find("div.mud-overlay").Click();
133                  comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
134                  comp1.Find("button").Click();
135                  comp.WaitForAssertion(() => comp.Find("div.mud-dialog-container").Should().NotBe(null),
136                      TimeSpan.FromSeconds(5));
137                  comp.WaitForAssertion(() => comp.Find("div.mud-overlay").Should().NotBeNull());
138                  comp.Find("div.mud-overlay").Click();
139                  comp.WaitForAssertion(() => comp.Markup.Trim().Should().BeEmpty(), TimeSpan.FromSeconds(5));
140              });
141          }
142          [Test]
143          public async Task InlineDialogShouldHonorClassAndStyle()
144          {
145              var comp = Context.RenderComponent<MudDialogProvider>();
146              comp.Markup.Trim().Should().BeEmpty();
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    