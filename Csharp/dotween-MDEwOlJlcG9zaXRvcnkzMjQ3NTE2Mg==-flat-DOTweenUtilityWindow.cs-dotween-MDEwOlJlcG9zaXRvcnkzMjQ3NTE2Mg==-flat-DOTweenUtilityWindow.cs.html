
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 23, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>dotween-MDEwOlJlcG9zaXRvcnkzMjQ3NTE2Mg==-flat-DOTweenUtilityWindow.cs</h3>
            <pre><code>1  using System;
2  using System.Collections.Generic;
3  using System.IO;
4  using DG.Tweening;
5  using DG.Tweening.Core;
6  using DG.Tweening.Core.Enums;
7  using UnityEditor;
8  using UnityEngine;
9  namespace DG.DOTweenEditor.UI
10  {
11      public class DOTweenUtilityWindow : EditorWindow
12      {
13          #region Events
14          public static event Action<bool> OnRequestDOTweenProMissingScriptsFix;
15          public static event Action<bool> OnRequestDOTweenTimelineMissingScriptsFix;
16          static void Dispatch_OnRequestDOTweenProMissingScriptsFix(bool currentSceneOnly)
17          {
18              if (OnRequestDOTweenProMissingScriptsFix != null) OnRequestDOTweenProMissingScriptsFix(currentSceneOnly);
19          }
20          static void Dispatch_OnRequestDOTweenTimelineMissingScriptsFix(bool currentSceneOnly)
21          {
22              if (OnRequestDOTweenTimelineMissingScriptsFix != null) OnRequestDOTweenTimelineMissingScriptsFix(currentSceneOnly);
23          }
24          #endregion
25          [MenuItem("Tools/Demigiant/" + _Title)]
26          static void ShowWindow() { Open(); }
27          const string _Title = "DOTween Utility Panel";
28          static readonly Vector2 _WinSize = new Vector2(370,650);
29          public const string Id = "DOTweenVersion";
30          public const string IdPro = "DOTweenProVersion";
31          static readonly float _HalfBtSize = _WinSize.x * 0.5f - 6;
32          bool _initialized;
33          DOTweenSettings _src;
34          Texture2D _headerImg, _footerImg;
35          Vector2 _headerSize, _footerSize;
36          string _innerTitle;
37          bool _setupRequired;
38          Vector2 _scrollVal;
39          int _selectedTab;
40          string[] _tabLabels = new[] { "Setup", "Preferences", "Utilities" };
41          string[] _settingsLocation = new[] {"Assets > Resources", "DOTween > Resources", "Demigiant > Resources"};
42          public static void Open()
43          {
44              EditorUtils.RetrieveDependenciesData(true);
45              DOTweenUtilityWindow window = EditorWindow.GetWindow<DOTweenUtilityWindow>(true, _Title, true);
46              window.minSize = _WinSize;
47              window.maxSize = _WinSize;
48              window.ShowUtility();
49              EditorPrefs.SetString(Id, DOTween.Version);
50              EditorPrefs.SetString(IdPro, EditorUtils.proVersion);
51          }
52          bool Init()
53          {
54              if (_initialized) return true;
55              if (_headerImg == null) {
56                  _headerImg = AssetDatabase.LoadAssetAtPath("Assets/" + EditorUtils.editorADBDir + "Imgs/Header.jpg", typeof(Texture2D)) as Texture2D;
57                  if (_headerImg == null) return false; 
58                  EditorUtils.SetEditorTexture(_headerImg, FilterMode.Bilinear, 512);
59                  _headerSize.x = _WinSize.x;
60                  _headerSize.y = (int)((_WinSize.x * _headerImg.height) / _headerImg.width);
61                  _footerImg = AssetDatabase.LoadAssetAtPath("Assets/" + EditorUtils.editorADBDir + (EditorGUIUtility.isProSkin ? "Imgs/Footer.png" : "Imgs/Footer_dark.png"), typeof(Texture2D)) as Texture2D;
62                  EditorUtils.SetEditorTexture(_footerImg, FilterMode.Bilinear, 256);
63                  _footerSize.x = _WinSize.x;
<span onclick='openModal()' class='match'>64                  _footerSize.y = (int)((_WinSize.x * _footerImg.height) / _footerImg.width);
65              }
</span>66              _initialized = true;
67              return true;
68          }
69          void OnHierarchyChange()
70          { Repaint(); }
71          void OnEnable()
72          {
73  #if COMPATIBLE
74              _innerTitle = "DOTween v" + DOTween.Version + " [Compatibility build]";
75  #else
76              _innerTitle = "DOTween v" + DOTween.Version + (TweenManager.isDebugBuild ? " [Debug build]" : " [Release build]");
77  #endif
78              if (EditorUtils.hasPro) _innerTitle += "\nDOTweenPro v" + EditorUtils.proVersion;
79              else _innerTitle += "\nDOTweenPro not installed";
80              if (EditorUtils.hasDOTweenTimeline) _innerTitle += "\nDOTweenTimeline v" + EditorUtils.dotweenTimelineVersion;
81              else _innerTitle += "\nDOTweenTimeline not installed";
82              Init();
83              _setupRequired = EditorUtils.DOTweenSetupRequired();
84          }
85          void OnDestroy()
86          {
87              if (_src != null) {
88                  _src.modules.showPanel = false;
89                  EditorUtility.SetDirty(_src);
90              }
91          }
92          void OnGUI()
93          {
94              if (!Init()) {
95                  GUILayout.Space(8);
96                  GUILayout.Label("Completing import process...");
97                  return;
98              }
99              Connect();
100              EditorGUIUtils.SetGUIStyles(_footerSize);
101              if (Application.isPlaying) {
102                  GUILayout.Space(40);
103                  GUILayout.BeginHorizontal();
104                  GUILayout.Space(40);
105                  GUILayout.Label("DOTween Utility Panel\nis disabled while in Play Mode", EditorGUIUtils.wrapCenterLabelStyle, GUILayout.ExpandWidth(true));
106                  GUILayout.Space(40);
107                  GUILayout.EndHorizontal();
108              } else {
109                  _scrollVal = GUILayout.BeginScrollView(_scrollVal);
110                  if (_src.modules.showPanel) {
111                      if (DOTweenUtilityWindowModules.Draw(this, _src)) {
112                          _setupRequired = EditorUtils.DOTweenSetupRequired();
113                          _src.modules.showPanel = false;
114                          EditorUtility.SetDirty(_src);
115                      }
116                  } else {
117                      Rect areaRect = new Rect(0, 0, _headerSize.x, 30);
118                      _selectedTab = GUI.Toolbar(areaRect, _selectedTab, _tabLabels);
119                      switch (_selectedTab) {
120                      case 1:
121                          float labelW = EditorGUIUtility.labelWidth;
122                          EditorGUIUtility.labelWidth = 160;
123                          DrawPreferencesGUI();
124                          EditorGUIUtility.labelWidth = labelW;
125                          break;
126                      case 2:
127                          DrawUtilsGUI();
128                          break;
129                      default:
130                          DrawSetupGUI();
131                          break;
132                      }
133                  }
134                  GUILayout.EndScrollView();
135              }
136              if (GUI.changed) EditorUtility.SetDirty(_src);
137          }
138          void DrawSetupGUI()
139          {
140              Rect areaRect = new Rect(0, 30, _headerSize.x, _headerSize.y);
141              GUI.DrawTexture(areaRect, _headerImg, ScaleMode.StretchToFill, false);
142              GUILayout.Space(areaRect.y + _headerSize.y + 2);
143              GUILayout.Label(_innerTitle, TweenManager.isDebugBuild ? EditorGUIUtils.redLabelStyle : EditorGUIUtils.boldLabelStyle);
144              if (_setupRequired) {
145                  GUI.backgroundColor = Color.red;
146                  GUILayout.BeginVertical(GUI.skin.box);
147                  GUILayout.Label("DOTWEEN SETUP REQUIRED", EditorGUIUtils.setupLabelStyle);
148                  GUILayout.EndVertical();
149                  GUI.backgroundColor = Color.white;
150              } else GUILayout.Space(8);
151              GUI.color = Color.green;
152              using (new GUILayout.HorizontalScope()) {
153                  GUILayout.FlexibleSpace();
154                  if (GUILayout.Button("<b>Setup DOTween...</b>\n(add/remove Modules)", EditorGUIUtils.btSetup, GUILayout.Width(200))) {
155                      DOTweenUtilityWindowModules.ApplyModulesSettings();
156                      ASMDEFManager.ApplyASMDEFSettings();
157                      _src.modules.showPanel = true;
158                      EditorUtility.SetDirty(_src);
159                      EditorUtils.DeleteLegacyNoModulesDOTweenFiles();
160                      DOTweenDefines.RemoveAllLegacyDefines();
161                      EditorUtils.DeleteDOTweenUpgradeManagerFiles();
162                      return;
163                  }
164                  GUILayout.FlexibleSpace();
165              }
166              GUI.color = Color.white;
167              GUILayout.Space(4);
168              using (new GUILayout.VerticalScope(GUI.skin.box)) {
169                  using (new GUILayout.HorizontalScope()) {
170                      GUILayout.FlexibleSpace();
171                      GUI.color = ASMDEFManager.hasModulesASMDEF ? Color.yellow : Color.cyan;
172                      if (GUILayout.Button(ASMDEFManager.hasModulesASMDEF ? "Remove ASMDEF..." : "Create ASMDEF...", EditorGUIUtils.btSetup, GUILayout.Width(200))) {
173                          if (ASMDEFManager.hasModulesASMDEF) {
174                              string msg = "This will remove:\n-DOTween/Modules/DOTween.Modules.asmdef";
175                              if (EditorUtils.hasPro) {
176                                  msg += "\n-DOTweenPro/DOTweenPro.Scripts.asmdef" +
177                                         "\n-DOTweenPro/Editor/DOTweenPro.EditorScripts.asmdef";
178                              }
179                              if (EditorUtils.hasDOTweenTimeline) {
180                                  msg += "\n-DOTweenTimeline/Scripts/DOTweenTimeline.Scripts.asmdef" +
181                                         "\n-DOTweenTimeline/Scripts/Editor/DOTweenTimeline.EditorScripts.asmdef";
182                              }
183                              if (EditorUtility.DisplayDialog("Remove ASMDEF", msg, "Ok", "Cancel")) ASMDEFManager.RemoveAllASMDEF();
184                          } else {
185                              string msg = "This will create:\n-DOTween/Modules/DOTween.Modules.asmdef";
186                              if (EditorUtils.hasPro) {
187                                  msg += "\n-DOTweenPro/DOTweenPro.Scripts.asmdef" +
188                                         "\n-DOTweenPro/Editor/DOTweenPro.EditorScripts.asmdef";
189                              }
190                              if (EditorUtils.hasDOTweenTimeline) {
191                                  msg += "\n-DOTweenTimeline/Scripts/DOTweenTimeline.Scripts.asmdef" +
192                                         "\n-DOTweenTimeline/Scripts/Editor/DOTweenTimeline.EditorScripts.asmdef";
193                              }
194                              if (EditorUtility.DisplayDialog("Create ASMDEF", msg, "Ok", "Cancel")) ASMDEFManager.CreateAllASMDEF();
195                          }
196                      }
197                      GUI.color = Color.white;
198                      GUILayout.FlexibleSpace();
199                  }
200                  GUILayout.Label(
201                      "ASMDEFs are useful if you need to reference the extra DOTween modules API (like [<i>UIelement</i>].DOColor)" +
202                      " from other ASMDEFs/Libraries instead of loose scripts," +
203                      " but remember to have those <b>ASMDEFs/Libraries reference DOTween ones</b>," +
204                      " <b>except for DOTween's Editor ASMDEFs</b> (DOTweenPro.EditorScripts) which <b>must never be referenced</b>" +
205                      " by your runtime code or runtime ASMDEFs.",
206                      EditorGUIUtils.wordWrapRichTextLabelStyle
207                  );
208              }
209              GUILayout.Space(3);
210              using (new GUILayout.HorizontalScope()) {
211                  if (GUILayout.Button("Website", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/index.php");
212                  if (GUILayout.Button("Get Started", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/getstarted.php");
213              }
214              using (new GUILayout.HorizontalScope()) {
215                  if (GUILayout.Button("Documentation", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/documentation.php");
216                  if (GUILayout.Button("Support", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/support.php");
217              }
218              using (new GUILayout.HorizontalScope()) {
219                  if (GUILayout.Button("Changelog", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/download.php");
220                  if (GUILayout.Button("Check Updates", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/download.php?v=" + DOTween.Version);
221              }
222              GUILayout.Space(4);
223              if (GUILayout.Button(_footerImg, EditorGUIUtils.btImgStyle)) Application.OpenURL("http:&bsol;&bsol;www.demigiant.com/");
224          }
225          void DrawPreferencesGUI()
226          {
227              GUILayout.Space(40);
228              if (GUILayout.Button("Reset", EditorGUIUtils.btBigStyle)) {
229                  _src.useSafeMode = true;
230                  _src.safeModeOptions.logBehaviour = SafeModeLogBehaviour.Warning;
231                  _src.safeModeOptions.nestedTweenFailureBehaviour = NestedTweenFailureBehaviour.TryToPreserveSequence;
232                  _src.showUnityEditorReport = false;
233                  _src.timeScale = 1;
234                  _src.unscaledTimeScale = 1;
235                  _src.useSmoothDeltaTime = false;
236                  _src.maxSmoothUnscaledTime = 0.15f;
237                  _src.rewindCallbackMode = RewindCallbackMode.FireIfPositionChanged;
238                  _src.logBehaviour = LogBehaviour.ErrorsOnly;
239                  _src.drawGizmos = true;
240                  _src.defaultRecyclable = false;
241                  _src.defaultAutoPlay = AutoPlay.All;
242                  _src.defaultUpdateType = UpdateType.Normal;
243                  _src.defaultTimeScaleIndependent = false;
244                  _src.defaultEaseType = Ease.OutQuad;
245                  _src.defaultEaseOvershootOrAmplitude = 1.70158f;
246                  _src.defaultEasePeriod = 0;
247                  _src.defaultAutoKill = true;
248                  _src.defaultLoopType = LoopType.Restart;
249                  _src.debugMode = false;
250                  _src.debugStoreTargetId = true;
251                  EditorUtility.SetDirty(_src);
252              }
253              GUILayout.Space(8);
254              _src.useSafeMode = EditorGUILayout.Toggle("Safe Mode", _src.useSafeMode);
255              if (_src.useSafeMode) {
256                  _src.safeModeOptions.logBehaviour = (SafeModeLogBehaviour)EditorGUILayout.EnumPopup(
257                      new GUIContent("└ Log Type On Capture", "Type of log to throw when safe mode captures an error"),
258                      _src.safeModeOptions.logBehaviour
259                  );
260                  _src.safeModeOptions.nestedTweenFailureBehaviour = (NestedTweenFailureBehaviour)EditorGUILayout.EnumPopup(
261                      new GUIContent("└ On Nested Tween Failure", "Behaviour in case a tween inside a Sequence fails"),
262                      _src.safeModeOptions.nestedTweenFailureBehaviour
263                  );
264              }
265              _src.timeScale = EditorGUILayout.FloatField("DOTween's TimeScale", _src.timeScale);
266              _src.unscaledTimeScale = EditorGUILayout.FloatField("└ Unscaled TimeScale", _src.unscaledTimeScale);
267              _src.useSmoothDeltaTime = EditorGUILayout.Toggle("Smooth DeltaTime", _src.useSmoothDeltaTime);
268              _src.maxSmoothUnscaledTime = EditorGUILayout.Slider("Max SmoothUnscaledTime", _src.maxSmoothUnscaledTime, 0.01f, 1f);
269              _src.rewindCallbackMode = (RewindCallbackMode)EditorGUILayout.EnumPopup("OnRewind Callback Mode", _src.rewindCallbackMode);
270              GUILayout.Space(-5);
271              GUILayout.BeginHorizontal();
272                  GUILayout.Space(EditorGUIUtility.labelWidth + 4);
273                  EditorGUILayout.HelpBox(
274                      _src.rewindCallbackMode == RewindCallbackMode.FireIfPositionChanged
275                          ? "When calling Rewind or PlayBackwards/SmoothRewind, OnRewind callbacks will be fired only if the tween isn't already rewinded"
276                          : _src.rewindCallbackMode == RewindCallbackMode.FireAlwaysWithRewind
277                              ? "When calling Rewind, OnRewind callbacks will always be fired, even if the tween is already rewinded."
278                              : "When calling Rewind or PlayBackwards/SmoothRewind, OnRewind callbacks will always be fired, even if the tween is already rewinded",
279                      MessageType.None
280                  );
281              GUILayout.EndHorizontal();
282              _src.showUnityEditorReport = EditorGUILayout.Toggle("Editor Report", _src.showUnityEditorReport);
283              _src.logBehaviour = (LogBehaviour)EditorGUILayout.EnumPopup("Log Behaviour", _src.logBehaviour);
284              _src.drawGizmos = EditorGUILayout.Toggle("Draw Path Gizmos", _src.drawGizmos);
285              DOTweenSettings.SettingsLocation prevSettingsLocation = _src.storeSettingsLocation;
286              _src.storeSettingsLocation = (DOTweenSettings.SettingsLocation)EditorGUILayout.Popup("Settings Location", (int)_src.storeSettingsLocation, _settingsLocation);
287              if (_src.storeSettingsLocation != prevSettingsLocation) {
288                  if (_src.storeSettingsLocation == DOTweenSettings.SettingsLocation.DemigiantDirectory && EditorUtils.demigiantDir == null) {
289                      EditorUtility.DisplayDialog("Change DOTween Settings Location", "Demigiant directory not present (must be the parent of DOTween's directory)", "Ok");
290                      if (prevSettingsLocation == DOTweenSettings.SettingsLocation.DemigiantDirectory) {
291                          _src.storeSettingsLocation = DOTweenSettings.SettingsLocation.AssetsDirectory;
292                          Connect(true);
293                      } else _src.storeSettingsLocation = prevSettingsLocation;
294                  } else Connect(true);
295              }
296              GUILayout.Space(8);
297              GUILayout.Label("DEFAULTS ▼");
298              _src.defaultRecyclable = EditorGUILayout.Toggle("Recycle Tweens", _src.defaultRecyclable);
299              _src.defaultAutoPlay = (AutoPlay)EditorGUILayout.EnumPopup("AutoPlay", _src.defaultAutoPlay);
300              _src.defaultUpdateType = (UpdateType)EditorGUILayout.EnumPopup("Update Type", _src.defaultUpdateType);
301              _src.defaultTimeScaleIndependent = EditorGUILayout.Toggle("TimeScale Independent", _src.defaultTimeScaleIndependent);
302              _src.defaultEaseType = (Ease)EditorGUILayout.EnumPopup("Ease", _src.defaultEaseType);
303              _src.defaultEaseOvershootOrAmplitude = EditorGUILayout.FloatField("Ease Overshoot", _src.defaultEaseOvershootOrAmplitude);
304              _src.defaultEasePeriod = EditorGUILayout.FloatField("Ease Period", _src.defaultEasePeriod);
305              _src.defaultAutoKill = EditorGUILayout.Toggle("AutoKill", _src.defaultAutoKill);
306              _src.defaultLoopType = (LoopType)EditorGUILayout.EnumPopup("Loop Type", _src.defaultLoopType);
307              GUILayout.Space(8);
308              _src.debugMode = EditorGUIUtils.ToggleButton(_src.debugMode, new GUIContent("DEBUG MODE", "Turns debug mode options on/off"), true);
309              if (_src.debugMode) {
310                  GUILayout.BeginVertical(GUI.skin.box);
311                  EditorGUI.BeginDisabledGroup(!_src.useSafeMode && _src.logBehaviour != LogBehaviour.ErrorsOnly);
312                  _src.debugStoreTargetId = EditorGUILayout.Toggle("Store GameObject's ID", _src.debugStoreTargetId);
313                  GUILayout.Label(
314                      "<b>Requires Safe Mode to be active + Default or Verbose LogBehaviour:</b>" +
315                      " when using DO shortcuts stores the relative gameObject's name so it can be returned along the warning logs" +
316                      " (helps with a clearer identification of the warning's target)",
317                      EditorGUIUtils.wordWrapRichTextLabelStyle
318                  );
319                  EditorGUI.EndDisabledGroup();
320                  GUILayout.EndVertical();
321              }
322          }
323          void DrawUtilsGUI()
324          {
325              GUILayout.Space(40);
326              if (EditorUtils.hasPro) {
327                  using (new GUILayout.VerticalScope(GUI.skin.box)) {
328                      GUILayout.Label("Fix <b>DOTweenPro</b> MissingScript References", EditorGUIUtils.wordWrapRichTextLabelStyle);
329                      if (GUILayout.Button("In <b>current</b> Scene", EditorGUIUtils.btSetup)) {
330                          if (EditorUtility.DisplayDialog("Fix MissingScript References",
331                              "Inspect current scene for missing DOTweenPro script References and fix them?\n\n(MAKE A BACKUP first!)", "Ok", "Cancel")
332                          ) Dispatch_OnRequestDOTweenProMissingScriptsFix(true);
333                      }
334                      if (GUILayout.Button("In <b>all</b> Scenes and Prefabs", EditorGUIUtils.btSetup)) {
335                          if (EditorUtility.DisplayDialog("Fix MissingScript References",
336                              "Inspect all your project's Prefabs and Scenes to find missing DOTweenPro script References and fix them?\n\n(MAKE A BACKUP first!)", "Ok", "Cancel")
337                          ) Dispatch_OnRequestDOTweenProMissingScriptsFix(false);
338                      }
339                      GUILayout.Space(4);
340                  }
341              }
342              if (EditorUtils.hasDOTweenTimeline) {
343                  using (new GUILayout.VerticalScope(GUI.skin.box)) {
344                      GUILayout.Label("Fix <b>DOTweenTimeline</b> MissingScript References", EditorGUIUtils.wordWrapRichTextLabelStyle);
345                      if (GUILayout.Button("In <b>current</b> Scene", EditorGUIUtils.btSetup)) {
346                          if (EditorUtility.DisplayDialog("Fix MissingScript References",
347                              "Inspect current scene for missing DOTweenTimeline script References and fix them?\n\n(MAKE A BACKUP first!)", "Ok", "Cancel")
348                          ) Dispatch_OnRequestDOTweenTimelineMissingScriptsFix(true);
349                      }
350                      if (GUILayout.Button("In <b>all</b> Scenes and Prefabs", EditorGUIUtils.btSetup)) {
351                          if (EditorUtility.DisplayDialog("Fix MissingScript References",
352                              "Inspect all your project's Prefabs and Scenes to find missing DOTweenTimeline script References and fix them?\n\n(MAKE A BACKUP first!)", "Ok", "Cancel")
353                          ) Dispatch_OnRequestDOTweenTimelineMissingScriptsFix(false);
354                      }
355                      GUILayout.Space(4);
356                  }
357              }
358          }
359          public static DOTweenSettings GetDOTweenSettings()
360          {
361              return ConnectToSource(null, false, false);
362          }
363          static DOTweenSettings ConnectToSource(DOTweenSettings src, bool createIfMissing, bool fullSetup)
364          {
365              LocationData assetsLD = new LocationData(EditorUtils.assetsPath + EditorUtils.pathSlash + "Resources");
366              LocationData dotweenLD = new LocationData(EditorUtils.dotweenDir + "Resources");
367              bool hasDemigiantDir = EditorUtils.demigiantDir != null;
368              LocationData demigiantLD = hasDemigiantDir ? new LocationData(EditorUtils.demigiantDir + "Resources") : new LocationData();
369              if (src == null) {
370                  src = EditorUtils.ConnectToSourceAsset<DOTweenSettings>(assetsLD.adbFilePath, false);
371                  if (src == null) src = EditorUtils.ConnectToSourceAsset<DOTweenSettings>(dotweenLD.adbFilePath, false);
372                  if (src == null && hasDemigiantDir) src = EditorUtils.ConnectToSourceAsset<DOTweenSettings>(demigiantLD.adbFilePath, false);
373              }
374              if (src == null) {
375                  if (!createIfMissing) return null; 
376                  if (!Directory.Exists(assetsLD.dir)) AssetDatabase.CreateFolder(assetsLD.adbParentDir, "Resources");
377                  src = EditorUtils.ConnectToSourceAsset<DOTweenSettings>(assetsLD.adbFilePath, true);
378              }
379              if (fullSetup) {
380                  DOTweenSettings.SettingsLocation settingsLoc = src.storeSettingsLocation;
381                  switch (settingsLoc) {
382                  case DOTweenSettings.SettingsLocation.AssetsDirectory:
383                      src = MoveSrc(new[] { dotweenLD, demigiantLD }, assetsLD);
384                      break;
385                  case DOTweenSettings.SettingsLocation.DOTweenDirectory:
386                      src = MoveSrc(new[] { assetsLD, demigiantLD }, dotweenLD);
387                      break;
388                  case DOTweenSettings.SettingsLocation.DemigiantDirectory:
389                      src = MoveSrc(new[] { assetsLD, dotweenLD }, demigiantLD);
390                      break;
391                  }
392              }
393              return src;
394          }
395          void Connect(bool forceReconnect = false)
396          {
397              if (_src != null && !forceReconnect) return;
398              _src = ConnectToSource(_src, true, true);
399          }
400          static DOTweenSettings MoveSrc(LocationData[] from, LocationData to)
401          {
402              if (!Directory.Exists(to.dir)) AssetDatabase.CreateFolder(to.adbParentDir, "Resources");
403              foreach (LocationData ld in from) {
404                  if (File.Exists(ld.filePath)) {
405                      AssetDatabase.MoveAsset(ld.adbFilePath, to.adbFilePath);
406                      AssetDatabase.DeleteAsset(ld.adbFilePath);
407                      if (Directory.GetDirectories(ld.dir).Length == 0 && Directory.GetFiles(ld.dir).Length == 0) {
408                          AssetDatabase.DeleteAsset(EditorUtils.FullPathToADBPath(ld.dir));
409                      }
410                  }
411              }
412              return EditorUtils.ConnectToSourceAsset<DOTweenSettings>(to.adbFilePath, true);
413          }
414          struct LocationData
415          {
416              public string dir; 
417              public string filePath;
418              public string adbFilePath;
419              public string adbParentDir; 
420              public LocationData(string srcDir) : this()
421              {
422                  dir = srcDir;
423                  filePath = dir + EditorUtils.pathSlash + DOTweenSettings.AssetFullFilename;
424                  adbFilePath = EditorUtils.FullPathToADBPath(filePath);
425                  adbParentDir = EditorUtils.FullPathToADBPath(dir.Substring(0, dir.LastIndexOf(EditorUtils.pathSlash)));
426              }
427          }
428      }
429  }
</code></pre>
        </div>
        <div class="column">
            <h3>dotween-MDEwOlJlcG9zaXRvcnkzMjQ3NTE2Mg==-flat-DOTweenUtilityWindow.cs</h3>
            <pre><code>1  using System;
2  using System.Collections.Generic;
3  using System.IO;
4  using DG.Tweening;
5  using DG.Tweening.Core;
6  using DG.Tweening.Core.Enums;
7  using UnityEditor;
8  using UnityEngine;
9  namespace DG.DOTweenEditor.UI
10  {
11      public class DOTweenUtilityWindow : EditorWindow
12      {
13          #region Events
14          public static event Action<bool> OnRequestDOTweenProMissingScriptsFix;
15          public static event Action<bool> OnRequestDOTweenTimelineMissingScriptsFix;
16          static void Dispatch_OnRequestDOTweenProMissingScriptsFix(bool currentSceneOnly)
17          {
18              if (OnRequestDOTweenProMissingScriptsFix != null) OnRequestDOTweenProMissingScriptsFix(currentSceneOnly);
19          }
20          static void Dispatch_OnRequestDOTweenTimelineMissingScriptsFix(bool currentSceneOnly)
21          {
22              if (OnRequestDOTweenTimelineMissingScriptsFix != null) OnRequestDOTweenTimelineMissingScriptsFix(currentSceneOnly);
23          }
24          #endregion
25          [MenuItem("Tools/Demigiant/" + _Title)]
26          static void ShowWindow() { Open(); }
27          const string _Title = "DOTween Utility Panel";
28          static readonly Vector2 _WinSize = new Vector2(370,650);
29          public const string Id = "DOTweenVersion";
30          public const string IdPro = "DOTweenProVersion";
31          static readonly float _HalfBtSize = _WinSize.x * 0.5f - 6;
32          bool _initialized;
33          DOTweenSettings _src;
34          Texture2D _headerImg, _footerImg;
35          Vector2 _headerSize, _footerSize;
36          string _innerTitle;
37          bool _setupRequired;
38          Vector2 _scrollVal;
39          int _selectedTab;
40          string[] _tabLabels = new[] { "Setup", "Preferences", "Utilities" };
41          string[] _settingsLocation = new[] {"Assets > Resources", "DOTween > Resources", "Demigiant > Resources"};
42          public static void Open()
43          {
44              EditorUtils.RetrieveDependenciesData(true);
45              DOTweenUtilityWindow window = EditorWindow.GetWindow<DOTweenUtilityWindow>(true, _Title, true);
46              window.minSize = _WinSize;
47              window.maxSize = _WinSize;
48              window.ShowUtility();
49              EditorPrefs.SetString(Id, DOTween.Version);
50              EditorPrefs.SetString(IdPro, EditorUtils.proVersion);
51          }
52          bool Init()
53          {
54              if (_initialized) return true;
55              if (_headerImg == null) {
56                  _headerImg = AssetDatabase.LoadAssetAtPath("Assets/" + EditorUtils.editorADBDir + "Imgs/Header.jpg", typeof(Texture2D)) as Texture2D;
57                  if (_headerImg == null) return false; 
58                  EditorUtils.SetEditorTexture(_headerImg, FilterMode.Bilinear, 512);
59                  _headerSize.x = _WinSize.x;
60                  _headerSize.y = (int)((_WinSize.x * _headerImg.height) / _headerImg.width);
61                  _footerImg = AssetDatabase.LoadAssetAtPath("Assets/" + EditorUtils.editorADBDir + (EditorGUIUtility.isProSkin ? "Imgs/Footer.png" : "Imgs/Footer_dark.png"), typeof(Texture2D)) as Texture2D;
62                  EditorUtils.SetEditorTexture(_footerImg, FilterMode.Bilinear, 256);
63                  _footerSize.x = _WinSize.x;
<span onclick='openModal()' class='match'>64                  _footerSize.y = (int)((_WinSize.x * _footerImg.height) / _footerImg.width);
65              }
</span>66              _initialized = true;
67              return true;
68          }
69          void OnHierarchyChange()
70          { Repaint(); }
71          void OnEnable()
72          {
73  #if COMPATIBLE
74              _innerTitle = "DOTween v" + DOTween.Version + " [Compatibility build]";
75  #else
76              _innerTitle = "DOTween v" + DOTween.Version + (TweenManager.isDebugBuild ? " [Debug build]" : " [Release build]");
77  #endif
78              if (EditorUtils.hasPro) _innerTitle += "\nDOTweenPro v" + EditorUtils.proVersion;
79              else _innerTitle += "\nDOTweenPro not installed";
80              if (EditorUtils.hasDOTweenTimeline) _innerTitle += "\nDOTweenTimeline v" + EditorUtils.dotweenTimelineVersion;
81              else _innerTitle += "\nDOTweenTimeline not installed";
82              Init();
83              _setupRequired = EditorUtils.DOTweenSetupRequired();
84          }
85          void OnDestroy()
86          {
87              if (_src != null) {
88                  _src.modules.showPanel = false;
89                  EditorUtility.SetDirty(_src);
90              }
91          }
92          void OnGUI()
93          {
94              if (!Init()) {
95                  GUILayout.Space(8);
96                  GUILayout.Label("Completing import process...");
97                  return;
98              }
99              Connect();
100              EditorGUIUtils.SetGUIStyles(_footerSize);
101              if (Application.isPlaying) {
102                  GUILayout.Space(40);
103                  GUILayout.BeginHorizontal();
104                  GUILayout.Space(40);
105                  GUILayout.Label("DOTween Utility Panel\nis disabled while in Play Mode", EditorGUIUtils.wrapCenterLabelStyle, GUILayout.ExpandWidth(true));
106                  GUILayout.Space(40);
107                  GUILayout.EndHorizontal();
108              } else {
109                  _scrollVal = GUILayout.BeginScrollView(_scrollVal);
110                  if (_src.modules.showPanel) {
111                      if (DOTweenUtilityWindowModules.Draw(this, _src)) {
112                          _setupRequired = EditorUtils.DOTweenSetupRequired();
113                          _src.modules.showPanel = false;
114                          EditorUtility.SetDirty(_src);
115                      }
116                  } else {
117                      Rect areaRect = new Rect(0, 0, _headerSize.x, 30);
118                      _selectedTab = GUI.Toolbar(areaRect, _selectedTab, _tabLabels);
119                      switch (_selectedTab) {
120                      case 1:
121                          float labelW = EditorGUIUtility.labelWidth;
122                          EditorGUIUtility.labelWidth = 160;
123                          DrawPreferencesGUI();
124                          EditorGUIUtility.labelWidth = labelW;
125                          break;
126                      case 2:
127                          DrawUtilsGUI();
128                          break;
129                      default:
130                          DrawSetupGUI();
131                          break;
132                      }
133                  }
134                  GUILayout.EndScrollView();
135              }
136              if (GUI.changed) EditorUtility.SetDirty(_src);
137          }
138          void DrawSetupGUI()
139          {
140              Rect areaRect = new Rect(0, 30, _headerSize.x, _headerSize.y);
141              GUI.DrawTexture(areaRect, _headerImg, ScaleMode.StretchToFill, false);
142              GUILayout.Space(areaRect.y + _headerSize.y + 2);
143              GUILayout.Label(_innerTitle, TweenManager.isDebugBuild ? EditorGUIUtils.redLabelStyle : EditorGUIUtils.boldLabelStyle);
144              if (_setupRequired) {
145                  GUI.backgroundColor = Color.red;
146                  GUILayout.BeginVertical(GUI.skin.box);
147                  GUILayout.Label("DOTWEEN SETUP REQUIRED", EditorGUIUtils.setupLabelStyle);
148                  GUILayout.EndVertical();
149                  GUI.backgroundColor = Color.white;
150              } else GUILayout.Space(8);
151              GUI.color = Color.green;
152              using (new GUILayout.HorizontalScope()) {
153                  GUILayout.FlexibleSpace();
154                  if (GUILayout.Button("<b>Setup DOTween...</b>\n(add/remove Modules)", EditorGUIUtils.btSetup, GUILayout.Width(200))) {
155                      DOTweenUtilityWindowModules.ApplyModulesSettings();
156                      ASMDEFManager.ApplyASMDEFSettings();
157                      _src.modules.showPanel = true;
158                      EditorUtility.SetDirty(_src);
159                      EditorUtils.DeleteLegacyNoModulesDOTweenFiles();
160                      DOTweenDefines.RemoveAllLegacyDefines();
161                      EditorUtils.DeleteDOTweenUpgradeManagerFiles();
162                      return;
163                  }
164                  GUILayout.FlexibleSpace();
165              }
166              GUI.color = Color.white;
167              GUILayout.Space(4);
168              using (new GUILayout.VerticalScope(GUI.skin.box)) {
169                  using (new GUILayout.HorizontalScope()) {
170                      GUILayout.FlexibleSpace();
171                      GUI.color = ASMDEFManager.hasModulesASMDEF ? Color.yellow : Color.cyan;
172                      if (GUILayout.Button(ASMDEFManager.hasModulesASMDEF ? "Remove ASMDEF..." : "Create ASMDEF...", EditorGUIUtils.btSetup, GUILayout.Width(200))) {
173                          if (ASMDEFManager.hasModulesASMDEF) {
174                              string msg = "This will remove:\n-DOTween/Modules/DOTween.Modules.asmdef";
175                              if (EditorUtils.hasPro) {
176                                  msg += "\n-DOTweenPro/DOTweenPro.Scripts.asmdef" +
177                                         "\n-DOTweenPro/Editor/DOTweenPro.EditorScripts.asmdef";
178                              }
179                              if (EditorUtils.hasDOTweenTimeline) {
180                                  msg += "\n-DOTweenTimeline/Scripts/DOTweenTimeline.Scripts.asmdef" +
181                                         "\n-DOTweenTimeline/Scripts/Editor/DOTweenTimeline.EditorScripts.asmdef";
182                              }
183                              if (EditorUtility.DisplayDialog("Remove ASMDEF", msg, "Ok", "Cancel")) ASMDEFManager.RemoveAllASMDEF();
184                          } else {
185                              string msg = "This will create:\n-DOTween/Modules/DOTween.Modules.asmdef";
186                              if (EditorUtils.hasPro) {
187                                  msg += "\n-DOTweenPro/DOTweenPro.Scripts.asmdef" +
188                                         "\n-DOTweenPro/Editor/DOTweenPro.EditorScripts.asmdef";
189                              }
190                              if (EditorUtils.hasDOTweenTimeline) {
191                                  msg += "\n-DOTweenTimeline/Scripts/DOTweenTimeline.Scripts.asmdef" +
192                                         "\n-DOTweenTimeline/Scripts/Editor/DOTweenTimeline.EditorScripts.asmdef";
193                              }
194                              if (EditorUtility.DisplayDialog("Create ASMDEF", msg, "Ok", "Cancel")) ASMDEFManager.CreateAllASMDEF();
195                          }
196                      }
197                      GUI.color = Color.white;
198                      GUILayout.FlexibleSpace();
199                  }
200                  GUILayout.Label(
201                      "ASMDEFs are useful if you need to reference the extra DOTween modules API (like [<i>UIelement</i>].DOColor)" +
202                      " from other ASMDEFs/Libraries instead of loose scripts," +
203                      " but remember to have those <b>ASMDEFs/Libraries reference DOTween ones</b>," +
204                      " <b>except for DOTween's Editor ASMDEFs</b> (DOTweenPro.EditorScripts) which <b>must never be referenced</b>" +
205                      " by your runtime code or runtime ASMDEFs.",
206                      EditorGUIUtils.wordWrapRichTextLabelStyle
207                  );
208              }
209              GUILayout.Space(3);
210              using (new GUILayout.HorizontalScope()) {
211                  if (GUILayout.Button("Website", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/index.php");
212                  if (GUILayout.Button("Get Started", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/getstarted.php");
213              }
214              using (new GUILayout.HorizontalScope()) {
215                  if (GUILayout.Button("Documentation", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/documentation.php");
216                  if (GUILayout.Button("Support", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/support.php");
217              }
218              using (new GUILayout.HorizontalScope()) {
219                  if (GUILayout.Button("Changelog", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/download.php");
220                  if (GUILayout.Button("Check Updates", EditorGUIUtils.btBigStyle, GUILayout.Width(_HalfBtSize))) Application.OpenURL("http:&bsol;&bsol;dotween.demigiant.com/download.php?v=" + DOTween.Version);
221              }
222              GUILayout.Space(4);
223              if (GUILayout.Button(_footerImg, EditorGUIUtils.btImgStyle)) Application.OpenURL("http:&bsol;&bsol;www.demigiant.com/");
224          }
225          void DrawPreferencesGUI()
226          {
227              GUILayout.Space(40);
228              if (GUILayout.Button("Reset", EditorGUIUtils.btBigStyle)) {
229                  _src.useSafeMode = true;
230                  _src.safeModeOptions.logBehaviour = SafeModeLogBehaviour.Warning;
231                  _src.safeModeOptions.nestedTweenFailureBehaviour = NestedTweenFailureBehaviour.TryToPreserveSequence;
232                  _src.showUnityEditorReport = false;
233                  _src.timeScale = 1;
234                  _src.unscaledTimeScale = 1;
235                  _src.useSmoothDeltaTime = false;
236                  _src.maxSmoothUnscaledTime = 0.15f;
237                  _src.rewindCallbackMode = RewindCallbackMode.FireIfPositionChanged;
238                  _src.logBehaviour = LogBehaviour.ErrorsOnly;
239                  _src.drawGizmos = true;
240                  _src.defaultRecyclable = false;
241                  _src.defaultAutoPlay = AutoPlay.All;
242                  _src.defaultUpdateType = UpdateType.Normal;
243                  _src.defaultTimeScaleIndependent = false;
244                  _src.defaultEaseType = Ease.OutQuad;
245                  _src.defaultEaseOvershootOrAmplitude = 1.70158f;
246                  _src.defaultEasePeriod = 0;
247                  _src.defaultAutoKill = true;
248                  _src.defaultLoopType = LoopType.Restart;
249                  _src.debugMode = false;
250                  _src.debugStoreTargetId = true;
251                  EditorUtility.SetDirty(_src);
252              }
253              GUILayout.Space(8);
254              _src.useSafeMode = EditorGUILayout.Toggle("Safe Mode", _src.useSafeMode);
255              if (_src.useSafeMode) {
256                  _src.safeModeOptions.logBehaviour = (SafeModeLogBehaviour)EditorGUILayout.EnumPopup(
257                      new GUIContent("└ Log Type On Capture", "Type of log to throw when safe mode captures an error"),
258                      _src.safeModeOptions.logBehaviour
259                  );
260                  _src.safeModeOptions.nestedTweenFailureBehaviour = (NestedTweenFailureBehaviour)EditorGUILayout.EnumPopup(
261                      new GUIContent("└ On Nested Tween Failure", "Behaviour in case a tween inside a Sequence fails"),
262                      _src.safeModeOptions.nestedTweenFailureBehaviour
263                  );
264              }
265              _src.timeScale = EditorGUILayout.FloatField("DOTween's TimeScale", _src.timeScale);
266              _src.unscaledTimeScale = EditorGUILayout.FloatField("└ Unscaled TimeScale", _src.unscaledTimeScale);
267              _src.useSmoothDeltaTime = EditorGUILayout.Toggle("Smooth DeltaTime", _src.useSmoothDeltaTime);
268              _src.maxSmoothUnscaledTime = EditorGUILayout.Slider("Max SmoothUnscaledTime", _src.maxSmoothUnscaledTime, 0.01f, 1f);
269              _src.rewindCallbackMode = (RewindCallbackMode)EditorGUILayout.EnumPopup("OnRewind Callback Mode", _src.rewindCallbackMode);
270              GUILayout.Space(-5);
271              GUILayout.BeginHorizontal();
272                  GUILayout.Space(EditorGUIUtility.labelWidth + 4);
273                  EditorGUILayout.HelpBox(
274                      _src.rewindCallbackMode == RewindCallbackMode.FireIfPositionChanged
275                          ? "When calling Rewind or PlayBackwards/SmoothRewind, OnRewind callbacks will be fired only if the tween isn't already rewinded"
276                          : _src.rewindCallbackMode == RewindCallbackMode.FireAlwaysWithRewind
277                              ? "When calling Rewind, OnRewind callbacks will always be fired, even if the tween is already rewinded."
278                              : "When calling Rewind or PlayBackwards/SmoothRewind, OnRewind callbacks will always be fired, even if the tween is already rewinded",
279                      MessageType.None
280                  );
281              GUILayout.EndHorizontal();
282              _src.showUnityEditorReport = EditorGUILayout.Toggle("Editor Report", _src.showUnityEditorReport);
283              _src.logBehaviour = (LogBehaviour)EditorGUILayout.EnumPopup("Log Behaviour", _src.logBehaviour);
284              _src.drawGizmos = EditorGUILayout.Toggle("Draw Path Gizmos", _src.drawGizmos);
285              DOTweenSettings.SettingsLocation prevSettingsLocation = _src.storeSettingsLocation;
286              _src.storeSettingsLocation = (DOTweenSettings.SettingsLocation)EditorGUILayout.Popup("Settings Location", (int)_src.storeSettingsLocation, _settingsLocation);
287              if (_src.storeSettingsLocation != prevSettingsLocation) {
288                  if (_src.storeSettingsLocation == DOTweenSettings.SettingsLocation.DemigiantDirectory && EditorUtils.demigiantDir == null) {
289                      EditorUtility.DisplayDialog("Change DOTween Settings Location", "Demigiant directory not present (must be the parent of DOTween's directory)", "Ok");
290                      if (prevSettingsLocation == DOTweenSettings.SettingsLocation.DemigiantDirectory) {
291                          _src.storeSettingsLocation = DOTweenSettings.SettingsLocation.AssetsDirectory;
292                          Connect(true);
293                      } else _src.storeSettingsLocation = prevSettingsLocation;
294                  } else Connect(true);
295              }
296              GUILayout.Space(8);
297              GUILayout.Label("DEFAULTS ▼");
298              _src.defaultRecyclable = EditorGUILayout.Toggle("Recycle Tweens", _src.defaultRecyclable);
299              _src.defaultAutoPlay = (AutoPlay)EditorGUILayout.EnumPopup("AutoPlay", _src.defaultAutoPlay);
300              _src.defaultUpdateType = (UpdateType)EditorGUILayout.EnumPopup("Update Type", _src.defaultUpdateType);
301              _src.defaultTimeScaleIndependent = EditorGUILayout.Toggle("TimeScale Independent", _src.defaultTimeScaleIndependent);
302              _src.defaultEaseType = (Ease)EditorGUILayout.EnumPopup("Ease", _src.defaultEaseType);
303              _src.defaultEaseOvershootOrAmplitude = EditorGUILayout.FloatField("Ease Overshoot", _src.defaultEaseOvershootOrAmplitude);
304              _src.defaultEasePeriod = EditorGUILayout.FloatField("Ease Period", _src.defaultEasePeriod);
305              _src.defaultAutoKill = EditorGUILayout.Toggle("AutoKill", _src.defaultAutoKill);
306              _src.defaultLoopType = (LoopType)EditorGUILayout.EnumPopup("Loop Type", _src.defaultLoopType);
307              GUILayout.Space(8);
308              _src.debugMode = EditorGUIUtils.ToggleButton(_src.debugMode, new GUIContent("DEBUG MODE", "Turns debug mode options on/off"), true);
309              if (_src.debugMode) {
310                  GUILayout.BeginVertical(GUI.skin.box);
311                  EditorGUI.BeginDisabledGroup(!_src.useSafeMode && _src.logBehaviour != LogBehaviour.ErrorsOnly);
312                  _src.debugStoreTargetId = EditorGUILayout.Toggle("Store GameObject's ID", _src.debugStoreTargetId);
313                  GUILayout.Label(
314                      "<b>Requires Safe Mode to be active + Default or Verbose LogBehaviour:</b>" +
315                      " when using DO shortcuts stores the relative gameObject's name so it can be returned along the warning logs" +
316                      " (helps with a clearer identification of the warning's target)",
317                      EditorGUIUtils.wordWrapRichTextLabelStyle
318                  );
319                  EditorGUI.EndDisabledGroup();
320                  GUILayout.EndVertical();
321              }
322          }
323          void DrawUtilsGUI()
324          {
325              GUILayout.Space(40);
326              if (EditorUtils.hasPro) {
327                  using (new GUILayout.VerticalScope(GUI.skin.box)) {
328                      GUILayout.Label("Fix <b>DOTweenPro</b> MissingScript References", EditorGUIUtils.wordWrapRichTextLabelStyle);
329                      if (GUILayout.Button("In <b>current</b> Scene", EditorGUIUtils.btSetup)) {
330                          if (EditorUtility.DisplayDialog("Fix MissingScript References",
331                              "Inspect current scene for missing DOTweenPro script References and fix them?\n\n(MAKE A BACKUP first!)", "Ok", "Cancel")
332                          ) Dispatch_OnRequestDOTweenProMissingScriptsFix(true);
333                      }
334                      if (GUILayout.Button("In <b>all</b> Scenes and Prefabs", EditorGUIUtils.btSetup)) {
335                          if (EditorUtility.DisplayDialog("Fix MissingScript References",
336                              "Inspect all your project's Prefabs and Scenes to find missing DOTweenPro script References and fix them?\n\n(MAKE A BACKUP first!)", "Ok", "Cancel")
337                          ) Dispatch_OnRequestDOTweenProMissingScriptsFix(false);
338                      }
339                      GUILayout.Space(4);
340                  }
341              }
342              if (EditorUtils.hasDOTweenTimeline) {
343                  using (new GUILayout.VerticalScope(GUI.skin.box)) {
344                      GUILayout.Label("Fix <b>DOTweenTimeline</b> MissingScript References", EditorGUIUtils.wordWrapRichTextLabelStyle);
345                      if (GUILayout.Button("In <b>current</b> Scene", EditorGUIUtils.btSetup)) {
346                          if (EditorUtility.DisplayDialog("Fix MissingScript References",
347                              "Inspect current scene for missing DOTweenTimeline script References and fix them?\n\n(MAKE A BACKUP first!)", "Ok", "Cancel")
348                          ) Dispatch_OnRequestDOTweenTimelineMissingScriptsFix(true);
349                      }
350                      if (GUILayout.Button("In <b>all</b> Scenes and Prefabs", EditorGUIUtils.btSetup)) {
351                          if (EditorUtility.DisplayDialog("Fix MissingScript References",
352                              "Inspect all your project's Prefabs and Scenes to find missing DOTweenTimeline script References and fix them?\n\n(MAKE A BACKUP first!)", "Ok", "Cancel")
353                          ) Dispatch_OnRequestDOTweenTimelineMissingScriptsFix(false);
354                      }
355                      GUILayout.Space(4);
356                  }
357              }
358          }
359          public static DOTweenSettings GetDOTweenSettings()
360          {
361              return ConnectToSource(null, false, false);
362          }
363          static DOTweenSettings ConnectToSource(DOTweenSettings src, bool createIfMissing, bool fullSetup)
364          {
365              LocationData assetsLD = new LocationData(EditorUtils.assetsPath + EditorUtils.pathSlash + "Resources");
366              LocationData dotweenLD = new LocationData(EditorUtils.dotweenDir + "Resources");
367              bool hasDemigiantDir = EditorUtils.demigiantDir != null;
368              LocationData demigiantLD = hasDemigiantDir ? new LocationData(EditorUtils.demigiantDir + "Resources") : new LocationData();
369              if (src == null) {
370                  src = EditorUtils.ConnectToSourceAsset<DOTweenSettings>(assetsLD.adbFilePath, false);
371                  if (src == null) src = EditorUtils.ConnectToSourceAsset<DOTweenSettings>(dotweenLD.adbFilePath, false);
372                  if (src == null && hasDemigiantDir) src = EditorUtils.ConnectToSourceAsset<DOTweenSettings>(demigiantLD.adbFilePath, false);
373              }
374              if (src == null) {
375                  if (!createIfMissing) return null; 
376                  if (!Directory.Exists(assetsLD.dir)) AssetDatabase.CreateFolder(assetsLD.adbParentDir, "Resources");
377                  src = EditorUtils.ConnectToSourceAsset<DOTweenSettings>(assetsLD.adbFilePath, true);
378              }
379              if (fullSetup) {
380                  DOTweenSettings.SettingsLocation settingsLoc = src.storeSettingsLocation;
381                  switch (settingsLoc) {
382                  case DOTweenSettings.SettingsLocation.AssetsDirectory:
383                      src = MoveSrc(new[] { dotweenLD, demigiantLD }, assetsLD);
384                      break;
385                  case DOTweenSettings.SettingsLocation.DOTweenDirectory:
386                      src = MoveSrc(new[] { assetsLD, demigiantLD }, dotweenLD);
387                      break;
388                  case DOTweenSettings.SettingsLocation.DemigiantDirectory:
389                      src = MoveSrc(new[] { assetsLD, dotweenLD }, demigiantLD);
390                      break;
391                  }
392              }
393              return src;
394          }
395          void Connect(bool forceReconnect = false)
396          {
397              if (_src != null && !forceReconnect) return;
398              _src = ConnectToSource(_src, true, true);
399          }
400          static DOTweenSettings MoveSrc(LocationData[] from, LocationData to)
401          {
402              if (!Directory.Exists(to.dir)) AssetDatabase.CreateFolder(to.adbParentDir, "Resources");
403              foreach (LocationData ld in from) {
404                  if (File.Exists(ld.filePath)) {
405                      AssetDatabase.MoveAsset(ld.adbFilePath, to.adbFilePath);
406                      AssetDatabase.DeleteAsset(ld.adbFilePath);
407                      if (Directory.GetDirectories(ld.dir).Length == 0 && Directory.GetFiles(ld.dir).Length == 0) {
408                          AssetDatabase.DeleteAsset(EditorUtils.FullPathToADBPath(ld.dir));
409                      }
410                  }
411              }
412              return EditorUtils.ConnectToSourceAsset<DOTweenSettings>(to.adbFilePath, true);
413          }
414          struct LocationData
415          {
416              public string dir; 
417              public string filePath;
418              public string adbFilePath;
419              public string adbParentDir; 
420              public LocationData(string srcDir) : this()
421              {
422                  dir = srcDir;
423                  filePath = dir + EditorUtils.pathSlash + DOTweenSettings.AssetFullFilename;
424                  adbFilePath = EditorUtils.FullPathToADBPath(filePath);
425                  adbParentDir = EditorUtils.FullPathToADBPath(dir.Substring(0, dir.LastIndexOf(EditorUtils.pathSlash)));
426              }
427          }
428      }
429  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from dotween-MDEwOlJlcG9zaXRvcnkzMjQ3NTE2Mg==-flat-DOTweenUtilityWindow.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from dotween-MDEwOlJlcG9zaXRvcnkzMjQ3NTE2Mg==-flat-DOTweenUtilityWindow.cs</div>
                </div>
                <div class="column column_space"><pre><code>64                  _footerSize.y = (int)((_WinSize.x * _footerImg.height) / _footerImg.width);
65              }
</pre></code></div>
                <div class="column column_space"><pre><code>64                  _footerSize.y = (int)((_WinSize.x * _footerImg.height) / _footerImg.width);
65              }
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    