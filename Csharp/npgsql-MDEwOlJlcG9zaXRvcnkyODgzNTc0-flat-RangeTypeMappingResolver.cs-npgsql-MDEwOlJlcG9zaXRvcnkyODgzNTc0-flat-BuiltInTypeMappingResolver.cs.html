
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 16, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>npgsql-MDEwOlJlcG9zaXRvcnkyODgzNTc0-flat-RangeTypeMappingResolver.cs</h3>
            <pre><code>1  using System;
2  using System.Collections.Generic;
3  using Npgsql.Internal.TypeHandling;
4  using Npgsql.Internal.TypeMapping;
5  using Npgsql.PostgresTypes;
6  using NpgsqlTypes;
7  using static Npgsql.Util.Statics;
8  namespace Npgsql.TypeMapping;
9  sealed class RangeTypeMappingResolver : TypeMappingResolver
10  {
11      static readonly Dictionary<string, TypeMappingInfo> Mappings = new()
12      {
13          { "int4range",                     new(NpgsqlDbType.IntegerRange,     "int4range") },
14          { "int8range",                     new(NpgsqlDbType.BigIntRange,      "int8range") },
15          { "numrange",                      new(NpgsqlDbType.NumericRange,     "numrange") },
16          { "daterange",                     new(NpgsqlDbType.DateRange,        "daterange") },
17          { "tsrange",                       new(NpgsqlDbType.TimestampRange,   "tsrange") },
18          { "tstzrange",                     new(NpgsqlDbType.TimestampTzRange, "tstzrange") },
19          { "int4multirange",                new(NpgsqlDbType.IntegerMultirange,     "int4range") },
20          { "int8multirange",                new(NpgsqlDbType.BigIntMultirange,      "int8range") },
21          { "nummultirange",                 new(NpgsqlDbType.NumericMultirange,     "numrange") },
22          { "datemultirange",                new(NpgsqlDbType.DateMultirange,        "datemultirange") },
23          { "tsmultirange",                  new(NpgsqlDbType.TimestampMultirange,   "tsmultirange") },
24          { "tstzmultirange",                new(NpgsqlDbType.TimestampTzMultirange, "tstzmultirange") }
25      };
26      static readonly Dictionary<Type, string> ClrTypeToDataTypeNameTable = new()
27      {
28          { typeof(NpgsqlRange<int>), "int4range" },
29          { typeof(NpgsqlRange<long>), "int8range" },
30          { typeof(NpgsqlRange<decimal>), "numrange" },
31  #if NET6_0_OR_GREATER
32          { typeof(NpgsqlRange<DateOnly>), "daterange" },
33  #endif
34          { typeof(NpgsqlRange<int>[]), "int4multirange" },
35          { typeof(List<NpgsqlRange<int>>), "int4multirange" },
36          { typeof(NpgsqlRange<long>[]), "int8multirange" },
37          { typeof(List<NpgsqlRange<long>>), "int8multirange" },
38          { typeof(NpgsqlRange<decimal>[]), "nummultirange" },
39          { typeof(List<NpgsqlRange<decimal>>), "nummultirange" },
40  #if NET6_0_OR_GREATER
41          { typeof(NpgsqlRange<DateOnly>[]), "datemultirange" },
42          { typeof(List<NpgsqlRange<DateOnly>>), "datemultirange" },
43  #endif
44      };
45      public override string? GetDataTypeNameByClrType(Type clrType)
<span onclick='openModal()' class='match'>46          => ClrTypeToDataTypeNameTable.TryGetValue(clrType, out var dataTypeName) ? dataTypeName : null;
47      public override string? GetDataTypeNameByValueDependentValue(object value)
</span>48      {
49          if (LegacyTimestampBehavior)
50              return null;
51          return value switch
52          {
53              NpgsqlRange<DateTime> range => GetRangeKind(range) == DateTimeKind.Utc ? "tstzrange" : "tsrange",
54              NpgsqlRange<DateTime>[] multirange => GetMultirangeKind(multirange) == DateTimeKind.Utc ? "tstzmultirange" : "tsmultirange",
55              _ => null
56          };
57      }
58      public override TypeMappingInfo? GetMappingByDataTypeName(string dataTypeName)
59          => Mappings.TryGetValue(dataTypeName, out var mapping) ? mapping : null;
60      public override TypeMappingInfo? GetMappingByPostgresType(TypeMapper mapper, PostgresType type)
61      {
62          switch (type)
63          {
64          case PostgresRangeType pgRangeType:
65          {
66              if (mapper.TryGetMapping(pgRangeType.Subtype, out var subtypeMapping))
67              {
68                  return new(subtypeMapping.NpgsqlDbType | NpgsqlDbType.Range, type.DisplayName);
69              }
70              break;
71          }
72          case PostgresMultirangeType pgMultirangeType:
73          {
74              if (mapper.TryGetMapping(pgMultirangeType.Subrange.Subtype, out var subtypeMapping))
75              {
76                  return new(subtypeMapping.NpgsqlDbType | NpgsqlDbType.Multirange, type.DisplayName);
77              }
78              break;
79          }
80          }
81          return null;
82      }
83      static DateTimeKind GetRangeKind(NpgsqlRange<DateTime> range)
84          => !range.LowerBoundInfinite
85              ? range.LowerBound.Kind
86              : !range.UpperBoundInfinite
87                  ? range.UpperBound.Kind
88                  : DateTimeKind.Unspecified;
89      static DateTimeKind GetMultirangeKind(IList<NpgsqlRange<DateTime>> multirange)
90      {
91          for (var i = 0; i < multirange.Count; i++)
92              if (!multirange[i].IsEmpty)
93                  return GetRangeKind(multirange[i]);
94          return DateTimeKind.Unspecified;
95      }
96  }
</code></pre>
        </div>
        <div class="column">
            <h3>npgsql-MDEwOlJlcG9zaXRvcnkyODgzNTc0-flat-BuiltInTypeMappingResolver.cs</h3>
            <pre><code>1  using System;
2  using System.Collections;
3  using System.Collections.Generic;
4  using System.Collections.Immutable;
5  using System.Collections.Specialized;
6  using System.Net;
7  using System.Net.NetworkInformation;
8  using System.Numerics;
9  using Npgsql.Internal.TypeHandling;
10  using Npgsql.Internal.TypeMapping;
11  using NpgsqlTypes;
12  using static Npgsql.Util.Statics;
13  namespace Npgsql.TypeMapping;
14  sealed class BuiltInTypeMappingResolver : TypeMappingResolver
15  {
16      static readonly Type ReadOnlyIPAddressType = IPAddress.Loopback.GetType();
17      static readonly Dictionary<string, TypeMappingInfo> Mappings = new()
18      {
19          { "smallint",         new(NpgsqlDbType.Smallint, "smallint",         typeof(short), typeof(byte), typeof(sbyte)) },
20          { "integer",          new(NpgsqlDbType.Integer,  "integer",          typeof(int)) },
21          { "int",              new(NpgsqlDbType.Integer,  "integer",          typeof(int)) },
22          { "bigint",           new(NpgsqlDbType.Bigint,   "bigint",           typeof(long)) },
23          { "real",             new(NpgsqlDbType.Real,     "real",             typeof(float)) },
24          { "double precision", new(NpgsqlDbType.Double,   "double precision", typeof(double)) },
25          { "numeric",          new(NpgsqlDbType.Numeric,  "numeric",          typeof(decimal), typeof(BigInteger)) },
26          { "decimal",          new(NpgsqlDbType.Numeric,  "numeric",          typeof(decimal), typeof(BigInteger)) },
27          { "money",            new(NpgsqlDbType.Money,    "money") },
28          { "text",              new(NpgsqlDbType.Text,      "text", typeof(string), typeof(char[]), typeof(char), typeof(ArraySegment<char>)) },
29          { "xml",               new(NpgsqlDbType.Xml,       "xml") },
30          { "character varying", new(NpgsqlDbType.Varchar,   "character varying") },
31          { "varchar",           new(NpgsqlDbType.Varchar,   "character varying") },
32          { "character",         new(NpgsqlDbType.Char,      "character") },
33          { "name",              new(NpgsqlDbType.Name,      "name") },
34          { "refcursor",         new(NpgsqlDbType.Refcursor, "refcursor") },
35          { "citext",            new(NpgsqlDbType.Citext,    "citext") },
36          { "jsonb",             new(NpgsqlDbType.Jsonb,     "jsonb") },
37          { "json",              new(NpgsqlDbType.Json,      "json") },
38          { "jsonpath",          new(NpgsqlDbType.JsonPath,  "jsonpath") },
39          { "timestamp without time zone", new(NpgsqlDbType.Timestamp,   "timestamp without time zone", typeof(DateTime)) },
40          { "timestamp",                   new(NpgsqlDbType.Timestamp,   "timestamp without time zone", typeof(DateTime)) },
41          { "timestamp with time zone",    new(NpgsqlDbType.TimestampTz, "timestamp with time zone",    typeof(DateTimeOffset)) },
42          { "timestamptz",                 new(NpgsqlDbType.TimestampTz, "timestamp with time zone",    typeof(DateTimeOffset)) },
43          { "date",                        new(NpgsqlDbType.Date,        "date"
44  #if NET6_0_OR_GREATER
45              , typeof(DateOnly)
46  #endif
47          ) },
48          { "time without time zone",      new(NpgsqlDbType.Time,        "time without time zone"
49  #if NET6_0_OR_GREATER
50              , typeof(TimeOnly)
51  #endif
52          ) },
53          { "time",                        new(NpgsqlDbType.Time,        "time without time zone"
54  #if NET6_0_OR_GREATER
55              , typeof(TimeOnly)
56  #endif
57          ) },
58          { "time with time zone",         new(NpgsqlDbType.TimeTz,      "time with time zone") },
59          { "timetz",                      new(NpgsqlDbType.TimeTz,      "time with time zone") },
60          { "interval",                    new(NpgsqlDbType.Interval,    "interval", typeof(TimeSpan)) },
61          { "timestamp without time zone[]", new(NpgsqlDbType.Array | NpgsqlDbType.Timestamp,   "timestamp without time zone[]") },
62          { "timestamp with time zone[]",    new(NpgsqlDbType.Array | NpgsqlDbType.TimestampTz, "timestamp with time zone[]") },
63          { "cidr",      new(NpgsqlDbType.Cidr,     "cidr") },
64  #pragma warning disable 618
65          { "inet",      new(NpgsqlDbType.Inet,     "inet", typeof(IPAddress), typeof((IPAddress Address, int Subnet)), typeof(NpgsqlInet), ReadOnlyIPAddressType) },
66  #pragma warning restore 618
67          { "macaddr",   new(NpgsqlDbType.MacAddr,  "macaddr", typeof(PhysicalAddress)) },
68          { "macaddr8",  new(NpgsqlDbType.MacAddr8, "macaddr8") },
69          { "box",      new(NpgsqlDbType.Box,     "box",     typeof(NpgsqlBox)) },
70          { "circle",   new(NpgsqlDbType.Circle,  "circle",  typeof(NpgsqlCircle)) },
71          { "line",     new(NpgsqlDbType.Line,    "line",    typeof(NpgsqlLine)) },
72          { "lseg",     new(NpgsqlDbType.LSeg,    "lseg",    typeof(NpgsqlLSeg)) },
73          { "path",     new(NpgsqlDbType.Path,    "path",    typeof(NpgsqlPath)) },
74          { "point",    new(NpgsqlDbType.Point,   "point",   typeof(NpgsqlPoint)) },
75          { "polygon",  new(NpgsqlDbType.Polygon, "polygon", typeof(NpgsqlPolygon)) },
76          { "lquery",     new(NpgsqlDbType.LQuery,    "lquery") },
77          { "ltree",      new(NpgsqlDbType.LTree,     "ltree") },
78          { "ltxtquery",  new(NpgsqlDbType.LTxtQuery, "ltxtquery") },
79          { "oid",        new(NpgsqlDbType.Oid,       "oid") },
80          { "xid",        new(NpgsqlDbType.Xid,       "xid") },
81          { "xid8",       new(NpgsqlDbType.Xid8,      "xid8") },
82          { "cid",        new(NpgsqlDbType.Cid,       "cid") },
83          { "regtype",    new(NpgsqlDbType.Regtype,   "regtype") },
84          { "regconfig",  new(NpgsqlDbType.Regconfig, "regconfig") },
85          { "boolean",     new(NpgsqlDbType.Boolean, "boolean", typeof(bool)) },
86          { "bool",        new(NpgsqlDbType.Boolean, "boolean", typeof(bool)) },
87          { "bytea",       new(NpgsqlDbType.Bytea,   "bytea", typeof(byte[]), typeof(ArraySegment<byte>)
88  #if !NETSTANDARD2_0
89              , typeof(ReadOnlyMemory<byte>), typeof(Memory<byte>)
90  #endif
91          ) },
92          { "uuid",        new(NpgsqlDbType.Uuid,    "uuid", typeof(Guid)) },
93          { "bit varying", new(NpgsqlDbType.Varbit,  "bit varying", typeof(BitArray), typeof(BitVector32)) },
94          { "varbit",      new(NpgsqlDbType.Varbit,  "bit varying", typeof(BitArray), typeof(BitVector32)) },
95          { "bit",         new(NpgsqlDbType.Bit,     "bit") },
96          { "hstore",      new(NpgsqlDbType.Hstore,  "hstore", typeof(Dictionary<string, string?>), typeof(IDictionary<string, string?>), typeof(ImmutableDictionary<string, string?>)) },
97          { "int2vector",  new(NpgsqlDbType.Int2Vector,   "int2vector") },
98          { "oidvector",   new(NpgsqlDbType.Oidvector,    "oidvector") },
99          { "pg_lsn",      new(NpgsqlDbType.PgLsn,        "pg_lsn", typeof(NpgsqlLogSequenceNumber)) },
100          { "tid",         new(NpgsqlDbType.Tid,          "tid", typeof(NpgsqlTid)) },
101          { "char",        new(NpgsqlDbType.InternalChar, "char") },
102          { "unknown",  new(NpgsqlDbType.Unknown, "unknown") },
103      };
104      static readonly Dictionary<Type, string> ClrTypeToDataTypeNameTable;
105      static BuiltInTypeMappingResolver()
106      {
107          ClrTypeToDataTypeNameTable = new()
108          {
109              { typeof(byte),       "smallint" },
110              { typeof(short),      "smallint" },
111              { typeof(int),        "integer" },
112              { typeof(long),       "bigint" },
113              { typeof(float),      "real" },
114              { typeof(double),     "double precision" },
115              { typeof(decimal),    "decimal" },
116              { typeof(BigInteger), "decimal" },
117              { typeof(string),             "text" },
118              { typeof(char[]),             "text" },
119              { typeof(char),               "text" },
120              { typeof(ArraySegment<char>), "text" },
121              { typeof(DateTime),       "timestamp without time zone" },
122              { typeof(DateTimeOffset), "timestamp with time zone" },
123  #if NET6_0_OR_GREATER
124              { typeof(DateOnly),       "date" },
125              { typeof(TimeOnly),       "time without time zone" },
126  #endif
127              { typeof(TimeSpan),       "interval" },
128              { typeof(NpgsqlInterval), "interval" },
129              { typeof(IPAddress),                       "inet" },
130              { typeof((IPAddress Address, int Subnet)), "inet" },
131  #pragma warning disable 618
132              { typeof(NpgsqlInet),                      "inet" },
133  #pragma warning restore 618
134              { typeof(PhysicalAddress),                 "macaddr" },
135              { typeof(NpgsqlBox),     "box" },
136              { typeof(NpgsqlCircle),  "circle" },
137              { typeof(NpgsqlLine),    "line" },
138              { typeof(NpgsqlLSeg),    "lseg" },
139              { typeof(NpgsqlPath),    "path" },
140              { typeof(NpgsqlPoint),   "point" },
141              { typeof(NpgsqlPolygon), "polygon" },
142              { typeof(bool),                 "boolean" },
143              { typeof(byte[]),               "bytea" },
144              { typeof(ArraySegment<byte>),   "bytea" },
145  #if !NETSTANDARD2_0
146              { typeof(ReadOnlyMemory<byte>), "bytea" },
147              { typeof(Memory<byte>),         "bytea" },
148  #endif
149              { typeof(Guid),                                "uuid" },
150              { typeof(BitArray),                            "bit varying" },
151              { typeof(BitVector32),                         "bit varying" },
152              { typeof(Dictionary<string, string>),          "hstore" },
153              { typeof(ImmutableDictionary<string, string>), "hstore" },
154              { typeof(NpgsqlLogSequenceNumber), "pg_lsn" },
155              { typeof(NpgsqlTid),               "tid" },
156              { typeof(DBNull),                  "unknown" }
157          };
158          if (ReadOnlyIPAddressType != typeof(IPAddress))
159              ClrTypeToDataTypeNameTable[ReadOnlyIPAddressType] = "inet";
160          if (LegacyTimestampBehavior)
161              ClrTypeToDataTypeNameTable[typeof(DateTime)] = "timestamp without time zone";
162      }
163      public override string? GetDataTypeNameByClrType(Type clrType)
164          => ClrTypeToDataTypeName(clrType);
165      internal static string? ClrTypeToDataTypeName(Type clrType)
166          => ClrTypeToDataTypeNameTable.TryGetValue(clrType, out var dataTypeName) ? dataTypeName : null;
167      public override string? GetDataTypeNameByValueDependentValue(object value)
168      {
169          if (LegacyTimestampBehavior)
170              return null;
171          return value switch
172          {
173              DateTime dateTime => dateTime.Kind == DateTimeKind.Utc ? "timestamp with time zone" : "timestamp without time zone",
174              IList<DateTime> array => array.Count == 0
175                  ? "timestamp without time zone[]"
176                  : array[0].Kind == DateTimeKind.Utc ? "timestamp with time zone[]" : "timestamp without time zone[]",
177              _ => null
178          };
179      }
180      public override TypeMappingInfo? GetMappingByDataTypeName(string dataTypeName)
<span onclick='openModal()' class='match'>181          => Mappings.TryGetValue(dataTypeName, out var mapping) ? mapping : null;
182  }
</span></code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from npgsql-MDEwOlJlcG9zaXRvcnkyODgzNTc0-flat-RangeTypeMappingResolver.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from npgsql-MDEwOlJlcG9zaXRvcnkyODgzNTc0-flat-BuiltInTypeMappingResolver.cs</div>
                </div>
                <div class="column column_space"><pre><code>46          => ClrTypeToDataTypeNameTable.TryGetValue(clrType, out var dataTypeName) ? dataTypeName : null;
47      public override string? GetDataTypeNameByValueDependentValue(object value)
</pre></code></div>
                <div class="column column_space"><pre><code>181          => Mappings.TryGetValue(dataTypeName, out var mapping) ? mapping : null;
182  }
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    