
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 9.75609756097561%, Tokens: 13</h2>
        <div class="column">
            <h3>Security-MDEwOlJlcG9zaXRvcnkxNzcyMzY5OQ==-flat-Startup_10.cs</h3>
            <pre><code>1  using System;
2  using System.Collections.Generic;
3  using System.Globalization;
4  using System.IdentityModel.Tokens.Jwt;
5  using System.Linq;
6  using System.Net.Http;
7  using System.Text.Encodings.Web;
8  using System.Threading.Tasks;
9  using Microsoft.AspNetCore.Authentication;
10  using Microsoft.AspNetCore.Authentication.Cookies;
11  using Microsoft.AspNetCore.Authentication.OpenIdConnect;
12  using Microsoft.AspNetCore.Builder;
13  using Microsoft.AspNetCore.Hosting;
14  using Microsoft.AspNetCore.Http;
15  using Microsoft.Extensions.Configuration;
16  using Microsoft.Extensions.DependencyInjection;
17  using Microsoft.Extensions.Options;
18  using Microsoft.IdentityModel.Protocols.OpenIdConnect;
19  using Newtonsoft.Json.Linq;
20  namespace OpenIdConnectSample
21  {
22      public class Startup
23      {
24          public Startup(IHostingEnvironment env)
25          {
26              Environment = env;
27              var builder = new ConfigurationBuilder()
28                  .SetBasePath(env.ContentRootPath);
29              if (env.IsDevelopment())
30              {
31                  builder.AddUserSecrets<Startup>();
32              }
33              builder.AddEnvironmentVariables();
34              Configuration = builder.Build();
35          }
36          public IConfiguration Configuration { get; set; }
37          public IHostingEnvironment Environment { get; set; }
38          public void ConfigureServices(IServiceCollection services)
39          {
40              JwtSecurityTokenHandler.DefaultInboundClaimTypeMap.Clear();
41              services.AddAuthentication(sharedOptions =>
42              {
43                  sharedOptions.DefaultAuthenticateScheme = CookieAuthenticationDefaults.AuthenticationScheme;
44                  sharedOptions.DefaultSignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;
45                  sharedOptions.DefaultChallengeScheme = OpenIdConnectDefaults.AuthenticationScheme;
46              })
47                  .AddCookie()
48                  .AddOpenIdConnect(o =>
49              {
50                  o.ClientId = Configuration["oidc:clientid"];
51                  o.ClientSecret = Configuration["oidc:clientsecret"]; 
52                  o.Authority = Configuration["oidc:authority"];
53                  o.ResponseType = OpenIdConnectResponseType.CodeIdToken;
54                  o.SaveTokens = true;
55                  o.GetClaimsFromUserInfoEndpoint = true;
56                  o.AccessDeniedPath = "/access-denied-from-remote";
57                  o.ClaimActions.MapAllExcept("aud", "iss", "iat", "nbf", "exp", "aio", "c_hash", "uti", "nonce");
58                  o.Events = new OpenIdConnectEvents()
59                  {
60                      OnAuthenticationFailed = c =>
61                      {
62                          c.HandleResponse();
63                          c.Response.StatusCode = 500;
64                          c.Response.ContentType = "text/plain";
65                          if (Environment.IsDevelopment())
66                          {
67                              return c.Response.WriteAsync(c.Exception.ToString());
68                          }
69                          return c.Response.WriteAsync("An error occurred processing your authentication.");
70                      }
71                  };
72              });
73          }
74          public void Configure(IApplicationBuilder app, IOptionsMonitor<OpenIdConnectOptions> optionsMonitor)
75          {
76              app.UseDeveloperExceptionPage();
77              app.UseAuthentication();
78              app.Run(async context =>
79              {
80                  var response = context.Response;
81                  if (context.Request.Path.Equals("/signedout"))
82                  {
83                      await WriteHtmlAsync(response, async res =>
84                      {
85                          await res.WriteAsync($"<h1>You have been signed out.</h1>");
86                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/\">Home</a>");
87                      });
88                      return;
89                  }
90                  if (context.Request.Path.Equals("/signout"))
91                  {
92                      await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
93                      await WriteHtmlAsync(response, async res =>
94                      {
95                          await res.WriteAsync($"<h1>Signed out {HtmlEncode(context.User.Identity.Name)}</h1>");
96                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/\">Home</a>");
97                      });
98                      return;
99                  }
100                  if (context.Request.Path.Equals("/signout-remote"))
101                  {
102                      await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
103                      await context.SignOutAsync(OpenIdConnectDefaults.AuthenticationScheme, new AuthenticationProperties()
104                      {
105                          RedirectUri = "/signedout"
106                      });
107                      return;
108                  }
109                  if (context.Request.Path.Equals("/access-denied-from-remote"))
110                  {
111                      await WriteHtmlAsync(response, async res =>
112                      {
113                          await res.WriteAsync($"<h1>Access Denied error received from the remote authorization server</h1>");
114                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/\">Home</a>");
115                      });
116                      return;
117                  }
118                  if (context.Request.Path.Equals("/Account/AccessDenied"))
119                  {
120                      await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
121                      await WriteHtmlAsync(response, async res =>
122                      {
123                          await res.WriteAsync($"<h1>Access Denied for user {HtmlEncode(context.User.Identity.Name)} to resource '{HtmlEncode(context.Request.Query["ReturnUrl"])}'</h1>");
124                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/signout\">Sign Out</a>");
125                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/\">Home</a>");
126                      });
127                      return;
128                  }
129                  var userResult = await context.AuthenticateAsync();
130                  var user = userResult.Principal;
131                  var props = userResult.Properties;
132                  if (user == null || !user.Identities.Any(identity => identity.IsAuthenticated))
133                  {
134                      await context.ChallengeAsync();
135                      return;
136                  }
137                  if (context.Request.Path.Equals("/restricted") && !user.Identities.Any(identity => identity.HasClaim("special", "true")))
138                  {
139                      await context.ForbidAsync();
140                      return;
141                  }
142                  if (context.Request.Path.Equals("/refresh"))
143                  {
144                      var refreshToken = props.GetTokenValue("refresh_token");
145                      if (string.IsNullOrEmpty(refreshToken))
146                      {
147                          await WriteHtmlAsync(response, async res =>
148                          {
149                              await res.WriteAsync($"No refresh_token is available.<br>");
150                              await res.WriteAsync("<a class=\"btn btn-link\" href=\"/signout\">Sign Out</a>");
151                          });
152                          return;
153                      }
154                      var options = optionsMonitor.Get(OpenIdConnectDefaults.AuthenticationScheme);
155                      var metadata = await options.ConfigurationManager.GetConfigurationAsync(context.RequestAborted);
156                      var pairs = new Dictionary<string, string>()
157                      {
158                          { "client_id", options.ClientId },
159                          { "client_secret", options.ClientSecret },
160                          { "grant_type", "refresh_token" },
161                          { "refresh_token", refreshToken }
162                      };
163                      var content = new FormUrlEncodedContent(pairs);
164                      var tokenResponse = await options.Backchannel.PostAsync(metadata.TokenEndpoint, content, context.RequestAborted);
165                      tokenResponse.EnsureSuccessStatusCode();
166                      var payload = JObject.Parse(await tokenResponse.Content.ReadAsStringAsync());
167                      props.UpdateTokenValue("access_token", payload.Value<string>("access_token"));
168                      props.UpdateTokenValue("refresh_token", payload.Value<string>("refresh_token"));
169                      if (int.TryParse(payload.Value<string>("expires_in"), NumberStyles.Integer, CultureInfo.InvariantCulture, out var seconds))
170                      {
171                          var expiresAt = DateTimeOffset.UtcNow + TimeSpan.FromSeconds(seconds);
172                          props.UpdateTokenValue("expires_at", expiresAt.ToString("o", CultureInfo.InvariantCulture));
173                      }
<span onclick='openModal()' class='match'>174                      await context.SignInAsync(user, props);
175                      await WriteHtmlAsync(response, async res =>
176                      {
177                          await res.WriteAsync($"<h1>Refreshed.</h1>");
178                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/refresh\">Refresh tokens</a>");
179                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/\">Home</a>");
180                          await res.WriteAsync("<h2>Tokens:</h2>");
181                          await WriteTableHeader(res, new string[] { "Token Type", "Value" }, props.GetTokens().Select(token => new string[] { token.Name, token.Value }));
182                          await res.WriteAsync("<h2>Payload:</h2>");
183                          await res.WriteAsync(HtmlEncoder.Default.Encode(payload.ToString()).Replace(",", ",<br>") + "<br>");
</span>184                      });
185                      return;
186                  }
187                  if (context.Request.Path.Equals("/login-challenge"))
188                  {
189                      await context.ChallengeAsync(OpenIdConnectDefaults.AuthenticationScheme, new OpenIdConnectChallengeProperties()
190                      {
191                          Prompt = "login",
192                      });
193                      return;
194                  }
195                  await WriteHtmlAsync(response, async res =>
196                  {
197                      await res.WriteAsync($"<h1>Hello Authenticated User {HtmlEncode(user.Identity.Name)}</h1>");
198                      await res.WriteAsync("<a class=\"btn btn-default\" href=\"/refresh\">Refresh tokens</a>");
199                      await res.WriteAsync("<a class=\"btn btn-default\" href=\"/restricted\">Restricted</a>");
200                      await res.WriteAsync("<a class=\"btn btn-default\" href=\"/login-challenge\">Login challenge</a>");
201                      await res.WriteAsync("<a class=\"btn btn-default\" href=\"/signout\">Sign Out</a>");
202                      await res.WriteAsync("<a class=\"btn btn-default\" href=\"/signout-remote\">Sign Out Remote</a>");
203                      await res.WriteAsync("<h2>Claims:</h2>");
204                      await WriteTableHeader(res, new string[] { "Claim Type", "Value" }, context.User.Claims.Select(c => new string[] { c.Type, c.Value }));
205                      await res.WriteAsync("<h2>Tokens:</h2>");
206                      await WriteTableHeader(res, new string[] { "Token Type", "Value" }, props.GetTokens().Select(token => new string[] { token.Name, token.Value }));
207                  });
208              });
209          }
210          private static async Task WriteHtmlAsync(HttpResponse response, Func<HttpResponse, Task> writeContent)
211          {
212              var bootstrap = "<link rel=\"stylesheet\" href=\"https:&bsol;&bsol;maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css\" integrity=\"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u\" crossorigin=\"anonymous\">";
213              response.ContentType = "text/html";
214              await response.WriteAsync($"<html><head>{bootstrap}</head><body><div class=\"container\">");
215              await writeContent(response);
216              await response.WriteAsync("</div></body></html>");
217          }
218          private static async Task WriteTableHeader(HttpResponse response, IEnumerable<string> columns, IEnumerable<IEnumerable<string>> data)
219          {
220              await response.WriteAsync("<table class=\"table table-condensed\">");
221              await response.WriteAsync("<tr>");
222              foreach (var column in columns)
223              {
224                  await response.WriteAsync($"<th>{HtmlEncode(column)}</th>");
225              }
226              await response.WriteAsync("</tr>");
227              foreach (var row in data)
228              {
229                  await response.WriteAsync("<tr>");
230                  foreach (var column in row)
231                  {
232                      await response.WriteAsync($"<td>{HtmlEncode(column)}</td>");
233                  }
234                  await response.WriteAsync("</tr>");
235              }
236              await response.WriteAsync("</table>");
237          }
238          private static string HtmlEncode(string content) =>
239              string.IsNullOrEmpty(content) ? string.Empty : HtmlEncoder.Default.Encode(content);
240      }
241  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-HiddenTests.cs</h3>
            <pre><code>1  #pragma warning disable CS1998 
2  using System;
3  using System.Threading.Tasks;
4  using Bunit;
5  using FluentAssertions;
6  using Microsoft.Extensions.DependencyInjection;
7  using Microsoft.JSInterop;
8  using Microsoft.JSInterop.Infrastructure;
9  using Moq;
10  using MudBlazor.Services;
11  using MudBlazor.UnitTests.TestComponents;
12  using NUnit.Framework;
13  namespace MudBlazor.UnitTests.Components
14  {
15      [TestFixture]
16      public class HiddenTests : BunitTest
17      {
18          [Test]
19          [TestCase(false, false, false)]
20          [TestCase(false, true, true)]
21          [TestCase(true, false, true)]
22          [TestCase(true, true, false)]
23          public void Content_Visible(bool mediaResult, bool invert, bool isHidden)
24          {
25              var listenerMock = new Mock<IBreakpointService>();
26              listenerMock.Setup(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>())).ReturnsAsync(new BreakpointServiceSubscribeResult(Guid.NewGuid(), Breakpoint.Md)).Verifiable();
27              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md)).Returns(mediaResult).Verifiable();
28              Context.Services.AddSingleton(sp => listenerMock.Object);
29              var comp = Context.RenderComponent<SimpleMudHiddenTest>(p =>
30              {
31                  p.Add(x => x.Breakpoint, Breakpoint.Lg);
32                  p.Add(x => x.Invert, invert);
33              });
34              if (isHidden == true)
35              {
36                  Assert.Throws<ElementNotFoundException>(() => comp.Find("p"));
37              }
38              else
39              {
40                  comp.Find("p").TextContent.Should().Be("MudHidden content");
41              }
42              listenerMock.Verify();
43          }
44          [Test]
45          public void SizeChanged()
46          {
47              Action<Breakpoint> callback = null;
48              var listenerMock = new Mock<IBreakpointService>();
49              listenerMock.Setup(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>()))
50                  .ReturnsAsync(new BreakpointServiceSubscribeResult(Guid.NewGuid(), Breakpoint.Md))
51                  .Callback<Action<Breakpoint>>(x => callback = x)
<span onclick='openModal()' class='match'>52                  .Verifiable();
53              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md)).Returns(false).Verifiable();
54              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Xs)).Returns(true).Verifiable();
55              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Xl)).Returns(false).Verifiable();
</span>56              Context.Services.AddSingleton(sp => listenerMock.Object);
57              var comp = Context.RenderComponent<SimpleMudHiddenTest>(p =>
58              {
59                  p.Add(x => x.Breakpoint, Breakpoint.Lg);
60                  p.Add(x => x.Invert, false);
61              });
62              comp.Find("p").TextContent.Should().Be("MudHidden content");
63              comp.InvokeAsync(() => callback.Invoke(Breakpoint.Xs));
64              Assert.Throws<ElementNotFoundException>(() => comp.Find("p"));
65              comp.InvokeAsync(() => callback.Invoke(Breakpoint.Xl));
66              comp.Find("p").TextContent.Should().Be("MudHidden content");
67              comp.Instance.HiddenChangedHistory.Should().HaveCount(3).And.BeEquivalentTo(new[] { false, true, false });
68              listenerMock.Verify();
69          }
70          [Test]
71          public void InvertChangedAfterInitializing()
72          {
73              var listenerMock = new Mock<IBreakpointService>();
74              listenerMock.Setup(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>())).ReturnsAsync(new BreakpointServiceSubscribeResult(Guid.NewGuid(), Breakpoint.Md)).Verifiable();
75              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md)).Returns(false).Verifiable();
76              Context.Services.AddSingleton(sp => listenerMock.Object);
77              var comp = Context.RenderComponent<SimpleMudHiddenTest>(p =>
78              {
79                  p.Add(x => x.Breakpoint, Breakpoint.Lg);
80                  p.Add(x => x.Invert, false);
81              });
82              comp.Find("p").TextContent.Should().Be("MudHidden content");
83              comp.SetParametersAndRender(p => p.Add(x => x.Invert, true));
84              Assert.Throws<ElementNotFoundException>(() => comp.Find("p"));
85              listenerMock.Verify(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md), Times.Exactly(4));
86              listenerMock.Verify();
87          }
88          [Test]
89          public void ReferenceBreakpointChangedAfterInitializing()
90          {
91              var listenerMock = new Mock<IBreakpointService>();
92              listenerMock.Setup(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>())).ReturnsAsync(new BreakpointServiceSubscribeResult(Guid.NewGuid(), Breakpoint.Md)).Verifiable();
93              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md)).Returns(false).Verifiable();
94              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Xs, Breakpoint.Md)).Returns(true).Verifiable();
95              Context.Services.AddSingleton(sp => listenerMock.Object);
96              var comp = Context.RenderComponent<SimpleMudHiddenTest>(p =>
97              {
98                  p.Add(x => x.Breakpoint, Breakpoint.Lg);
99                  p.Add(x => x.Invert, false);
100              });
101              comp.Find("p").TextContent.Should().Be("MudHidden content");
102              comp.SetParametersAndRender(p => p.Add(x => x.Breakpoint, Breakpoint.Xs));
103              Assert.Throws<ElementNotFoundException>(() => comp.Find("p"));
104              listenerMock.Verify(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md), Times.Exactly(2));
105              listenerMock.Verify(x => x.IsMediaSize(Breakpoint.Xs, Breakpoint.Md), Times.Exactly(2));
106              listenerMock.Verify();
107          }
108          [Test]
109          public void SizeChangedToNone()
110          {
111              Action<Breakpoint> callback = null;
112              var listenerMock = new Mock<IBreakpointService>();
113              listenerMock.Setup(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>()))
114                  .ReturnsAsync(new BreakpointServiceSubscribeResult(Guid.NewGuid(), Breakpoint.Md))
115                  .Callback<Action<Breakpoint>>(x => callback = x)
116                  .Verifiable();
117              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md)).Returns(false).Verifiable();
118              Context.Services.AddSingleton(sp => listenerMock.Object);
119              var comp = Context.RenderComponent<SimpleMudHiddenTest>(p =>
120              {
121                  p.Add(x => x.Breakpoint, Breakpoint.Lg);
122                  p.Add(x => x.Invert, false);
123              });
124              comp.Find("p").TextContent.Should().Be("MudHidden content");
125              comp.InvokeAsync(() => callback.Invoke(Breakpoint.None));
126              comp.Find("p").TextContent.Should().Be("MudHidden content");
127              comp.Instance.HiddenChangedHistory.Should().ContainSingle().And.BeEquivalentTo(new[] { false });
128              listenerMock.Verify();
129          }
130          [Test]
131          public void WithinMudBreakpointProvider()
132          {
133              var listenerMock = new Mock<IBreakpointService>();
134              listenerMock.Setup(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>()))
135                  .ReturnsAsync(new BreakpointServiceSubscribeResult(Guid.NewGuid(), Breakpoint.Md))
136                  .Verifiable();
137              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md)).Returns(false).Verifiable();
138              Context.Services.AddSingleton(sp => listenerMock.Object);
139              var comp = Context.RenderComponent<BreakpointProviderWithMudHiddenTest>(p =>
140              {
141                  p.Add(x => x.Breakpoint, Breakpoint.Lg);
142              });
143              var items = comp.FindAll("p");
144              items.Should().HaveCount(4);
145              for (int i = 0; i < 4; i++)
146              {
147                  var item = items[i];
148                  item.TextContent.Should().Be($"MudHidden content {i + 1}");
149              }
150              listenerMock.Verify(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>()), Times.Once());
151              listenerMock.Verify(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md), Times.Exactly(8));
152              listenerMock.Verify();
153          }
154          [Test]
155          public void WithinMudBreakpointProvider_UpdateBreakpointValue()
156          {
157              Action<Breakpoint> callback = null;
158              var listenerMock = new Mock<IBreakpointService>();
159              listenerMock.Setup(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>()))
160                  .ReturnsAsync(new BreakpointServiceSubscribeResult(Guid.NewGuid(), Breakpoint.Md))
161                  .Callback<Action<Breakpoint>>(x => callback = x)
162                  .Verifiable();
163              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md)).Returns(false).Verifiable();
164              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Xs)).Returns(true).Verifiable();
165              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Sm)).Returns(false).Verifiable();
166              Context.Services.AddSingleton(sp => listenerMock.Object);
167              var comp = Context.RenderComponent<BreakpointProviderWithMudHiddenTest>(p =>
168              {
169                  p.Add(x => x.Breakpoint, Breakpoint.Lg);
170              });
171              var items = comp.FindAll("p");
172              items.Should().HaveCount(4);
173              for (int i = 0; i < 4; i++)
174              {
175                  var item = items[i];
176                  item.TextContent.Should().Be($"MudHidden content {i + 1}");
177              }
178              comp.InvokeAsync(() => callback(Breakpoint.Xs));
179              items = comp.FindAll("p");
180              items.Should().BeEmpty();
181              comp.InvokeAsync(() => callback(Breakpoint.Sm));
182              items = comp.FindAll("p");
183              items.Should().HaveCount(4);
184              for (int i = 0; i < 4; i++)
185              {
186                  var item = items[i];
187                  item.TextContent.Should().Be($"MudHidden content {i + 1}");
188              }
189              comp.Instance.BreakpointChangedHistory.Should().HaveCount(3).And.BeEquivalentTo(new[] { Breakpoint.Md, Breakpoint.Xs, Breakpoint.Sm });
190              listenerMock.Verify(x => x.SubscribeAsync(It.IsAny<Action<Breakpoint>>()), Times.Once());
191              listenerMock.Verify(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md), Times.Exactly(8));
192              listenerMock.Verify(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Xs), Times.Exactly(16));
193              listenerMock.Verify(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Sm), Times.Exactly(16));
194              listenerMock.Verify();
195          }
196          [Test]
197          public void TestSemaphore_RenderInParallel()
198          {
199              Mock<IBrowserWindowSizeProvider> sizeMock = new Mock<IBrowserWindowSizeProvider>(MockBehavior.Strict);
200              sizeMock.Setup(x => x.GetBrowserWindowSize()).ReturnsAsync(new BrowserWindowSize { Width = 1920 });
201              Mock<IJSRuntime> _jsruntimeMock = new Mock<IJSRuntime>(MockBehavior.Strict);
202              _jsruntimeMock.Setup(x => x.InvokeAsync<IJSVoidResult>("mudResizeListenerFactory.listenForResize", It.IsAny<object[]>()))
203                  .ReturnsAsync(Mock.Of<IJSVoidResult>(), TimeSpan.FromMilliseconds(200)).Verifiable();
204              _jsruntimeMock.Setup(x => x.InvokeAsync<IJSVoidResult>("mudResizeListenerFactory.cancelListeners", It.IsAny<object[]>()))
205      .ReturnsAsync(Mock.Of<IJSVoidResult>);
206              BreakpointService service = new BreakpointService(_jsruntimeMock.Object, sizeMock.Object);
207              Context.Services.AddSingleton<IBreakpointService, BreakpointService>(sp => service);
208              var comp = Context.RenderComponent<RenderMultipleHiddenInParallel>();
209              comp.WaitForAssertion(() => comp.FindAll(".xl").Should().HaveCount(10), TimeSpan.FromSeconds(1));
210              comp.WaitForAssertion(() => comp.FindAll(".lg-and-up").Should().HaveCount(10), TimeSpan.FromSeconds(1));
211              comp.WaitForAssertion(() => comp.FindAll(".md-and-up").Should().HaveCount(10), TimeSpan.FromSeconds(1));
212              comp.WaitForAssertion(() => comp.FindAll(".sm-and-up").Should().HaveCount(10), TimeSpan.FromSeconds(1));
213          }
214      }
215  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Security-MDEwOlJlcG9zaXRvcnkxNzcyMzY5OQ==-flat-Startup_10.cs</div>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-HiddenTests.cs</div>
                <div class="column column_space"><pre><code>174                      await context.SignInAsync(user, props);
175                      await WriteHtmlAsync(response, async res =>
176                      {
177                          await res.WriteAsync($"<h1>Refreshed.</h1>");
178                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/refresh\">Refresh tokens</a>");
179                          await res.WriteAsync("<a class=\"btn btn-default\" href=\"/\">Home</a>");
180                          await res.WriteAsync("<h2>Tokens:</h2>");
181                          await WriteTableHeader(res, new string[] { "Token Type", "Value" }, props.GetTokens().Select(token => new string[] { token.Name, token.Value }));
182                          await res.WriteAsync("<h2>Payload:</h2>");
183                          await res.WriteAsync(HtmlEncoder.Default.Encode(payload.ToString()).Replace(",", ",<br>") + "<br>");
</pre></code></div>
                <div class="column column_space"><pre><code>52                  .Verifiable();
53              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Md)).Returns(false).Verifiable();
54              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Xs)).Returns(true).Verifiable();
55              listenerMock.Setup(x => x.IsMediaSize(Breakpoint.Lg, Breakpoint.Xl)).Returns(false).Verifiable();
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    