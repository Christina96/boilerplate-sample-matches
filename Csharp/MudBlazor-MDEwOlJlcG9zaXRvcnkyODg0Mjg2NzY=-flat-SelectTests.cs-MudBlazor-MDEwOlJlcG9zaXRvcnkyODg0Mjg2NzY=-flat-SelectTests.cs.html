
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 22, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-SelectTests.cs</h3>
            <pre><code>1  #pragma warning disable CS1998 
2  #pragma warning disable IDE1006 
3  #pragma warning disable BL0005 
4  using System;
5  using System.Collections.Generic;
6  using System.Linq;
7  using System.Threading.Tasks;
8  using Bunit;
9  using FluentAssertions;
10  using Microsoft.AspNetCore.Components.Web;
11  using MudBlazor.UnitTests.TestComponents;
12  using MudBlazor.UnitTests.TestComponents.Select;
13  using NUnit.Framework;
14  using static MudBlazor.UnitTests.TestComponents.SelectWithEnumTest;
15  namespace MudBlazor.UnitTests.Components
16  {
17      [TestFixture]
18      public class SelectTests : BunitTest
19      {
20          [Test]
21          public async Task SelectTest_CheckListClass()
22          {
23              var comp = Context.RenderComponent<SelectRequiredTest>();
24              var select = comp.FindComponent<MudSelect<string>>();
25              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter" }));
26              await comp.InvokeAsync(() => select.SetParam("ListClass", "my-list-class"));
27              var list = comp.FindComponent<MudList>();
28              comp.WaitForAssertion(() => comp.Markup.Should().Contain("my-list-class"));
29          }
30          [Test]
31          public void SelectLabelFor()
32          {
33              var comp = Context.RenderComponent<SelectRequiredTest>();
34              var label = comp.FindAll(".mud-input-label");
35              label[0].Attributes.GetNamedItem("for")?.Value.Should().Be("selectLabelTest");
36          }
37          [Test]
38          public async Task SelectTest1()
39          {
40              var comp = Context.RenderComponent<SelectTest1>();
41              var select = comp.FindComponent<MudSelect<string>>();
42              var menu = comp.Find("div.mud-popover");
43              var input = comp.Find("div.mud-input-control");
44              menu.ClassList.Should().Contain("select-popover-class");
45              select.Instance.Value.Should().BeNullOrEmpty();
46              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
47              input.Click();
48              menu.ClassList.Should().Contain("mud-popover-open");
49              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
50              var items = comp.FindAll("div.mud-list-item").ToArray();
51              items[1].Click();
52              comp.WaitForAssertion(() => menu.ClassList.Should().NotContain("mud-popover-open"));
53              select.Instance.Value.Should().Be("2");
54              input.Click();
55              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
56              items = comp.FindAll("div.mud-list-item").ToArray();
57              items[0].Click();
58              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
59              var @switch = comp.FindComponent<MudSwitch<bool>>();
60              @switch.Instance.Checked = true;
61              await comp.InvokeAsync(() => select.Instance.OnBlurAsync(new FocusEventArgs()));
62              comp.WaitForAssertion(() => @switch.Instance.Checked.Should().Be(false));
63          }
64          [Test]
65          public async Task MultiSelectTest1()
66          {
67              await ImproveChanceOfSuccess(async () =>
68              {
69                  var comp = Context.RenderComponent<MultiSelectTest1>();
70                  var select = comp.FindComponent<MudSelect<string>>();
71                  var menu = comp.Find("div.mud-popover");
72                  var input = comp.Find("div.mud-input-control");
73                  select.Instance.Value.Should().BeNullOrEmpty();
74                  comp.WaitForAssertion(() =>
75                      comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
76                  input.Click();
77                  menu.ClassList.Should().Contain("mud-popover-open");
78                  comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
79                  var items = comp.FindAll("div.mud-list-item").ToArray();
80                  items[1].Click();
81                  menu.ClassList.Should().Contain("mud-popover-open");
82                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2"));
83                  items[0].Click();
84                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 1"));
85                  items[2].Click();
86                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 1, 3"));
87                  items[0].Click();
88                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 3"));
89                  select.Instance.SelectedValues.Count().Should().Be(2);
90                  select.Instance.SelectedValues.Should().Contain("2");
91                  select.Instance.SelectedValues.Should().Contain("3");
92                  const string @unchecked =
93                      "M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z";
94                  const string @checked =
95                      "M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z";
96                  comp.WaitForAssertion(() =>
97                      comp.FindAll("div.mud-list-item path")[1].Attributes["d"].Value.Should().Be(@unchecked));
98                  comp.FindAll("div.mud-list-item path")[3].Attributes["d"].Value.Should().Be(@checked);
99                  comp.FindAll("div.mud-list-item path")[5].Attributes["d"].Value.Should().Be(@checked);
100                  await comp.InvokeAsync(() =>
101                  {
102                      select.Instance.SelectedValues = new HashSet<string>() { "1", "2" };
103                  });
104                  comp.WaitForAssertion(() =>
105                      comp.FindAll("div.mud-list-item path")[1].Attributes["d"].Value.Should().Be(@checked));
106                  comp.FindAll("div.mud-list-item path")[3].Attributes["d"].Value.Should().Be(@checked);
107                  comp.FindAll("div.mud-list-item path")[5].Attributes["d"].Value.Should().Be(@unchecked);
108              });
109          }
110          [Test]
111          public async Task SelectWithEnumTest()
112          {
113              var comp = Context.RenderComponent<SelectWithEnumTest>();
114              var select = comp.FindComponent<MudSelect<MyEnum>>();
115              var input = comp.Find("div.mud-input-control");
116              select.Instance.Value.Should().Be(default(MyEnum));
117              select.Instance.Text.Should().Be(default(MyEnum).ToString());
118              comp.Find("input").Attributes["value"]?.Value.Should().Be("First");
119              comp.RenderCount.Should().Be(1);
120              input.Click();
121              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
122              var items = comp.FindAll("div.mud-list-item").ToArray();
123              items[1].Click();
124              comp.WaitForAssertion(() => comp.Find("input").Attributes["value"]?.Value.Should().Be("Second"));
125          }
126          [Test]
127          public void SelectUnrepresentableValueTest()
128          {
129              var comp = Context.RenderComponent<SelectUnrepresentableValueTest>();
130              var select = comp.FindComponent<MudSelect<int>>();
131              var input = comp.Find("div.mud-input-control");
132              select.Instance.Value.Should().Be(17);
133              select.Instance.Text.Should().Be("17");
134              comp.Find("input").Attributes["value"]?.Value.Should().Be("17");
135              input.Click();
136              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
137              var items = comp.FindAll("div.mud-list-item").ToArray();
138              items[1].Click();
139              comp.WaitForAssertion(() => comp.Find("div.mud-input-slot").TextContent.Trim().Should().Be("Two"));
140              select.Instance.Value.Should().Be(2);
141              select.Instance.Text.Should().Be("2");
142          }
143          [Test]
144          public async Task SelectUnrepresentableValueTest2()
145          {
146              var comp = Context.RenderComponent<SelectUnrepresentableValueTest2>();
147              var select = comp.FindComponent<MudSelect<int>>();
148              var input = comp.Find("div.mud-input-control");
149              select.Instance.Value.Should().Be(17);
150              select.Instance.Text.Should().Be("17");
151              await Task.Delay(100);
152              comp.FindComponent<MudInput<string>>().Instance.Value.Should().Be(null);
153              comp.FindComponent<MudInput<string>>().Instance.InputType.Should().Be(InputType.Hidden);
154              input.Click();
155              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
156              var items = comp.FindAll("div.mud-list-item").ToArray();
157              items[1].Click();
158              comp.WaitForAssertion(() => select.Instance.Value.Should().Be(2));
159              select.Instance.Text.Should().Be("2");
160              comp.FindComponent<MudInput<string>>().Instance.Value.Should().Be("2");
161              comp.FindComponent<MudInput<string>>().Instance.InputType.Should().Be(InputType.Text); 
162          }
163          [Test]
164          public void SelectWithoutItemPresentersTest()
165          {
166              var comp = Context.RenderComponent<SelectWithoutItemPresentersTest>();
167              var select = comp.FindComponent<MudSelect<int>>();
168              var input = comp.Find("div.mud-input-control");
169              select.Instance.Value.Should().Be(1);
170              select.Instance.Text.Should().Be("1");
171              comp.Find("div.mud-input-slot").Attributes["style"].Value.Should().Contain("display:none");
172              comp.RenderCount.Should().Be(1);
173              input.Click();
174              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
175              var items = comp.FindAll("div.mud-list-item").ToArray();
176              items[1].Click();
177              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
178              comp.WaitForAssertion(() => comp.Find("div.mud-input-slot").Attributes["style"].Value.Should().Contain("display:none"));
179              select.Instance.Value.Should().Be(2);
180              select.Instance.Text.Should().Be("2");
181          }
182          [Test]
183          public void Select_Should_FireTextChangedWithNewValue()
184          {
185              var comp = Context.RenderComponent<SelectTest1>();
186              var select = comp.FindComponent<MudSelect<string>>();
187              string text = null;
188              select.SetCallback(s => s.TextChanged, x => text = x);
189              var menu = comp.Find("div.mud-popover");
190              var input = comp.Find("div.mud-input-control");
191              select.Instance.Value.Should().BeNullOrEmpty();
192              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
193              input.Click();
194              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
195              menu.ClassList.Should().Contain("mud-popover-open");
196              var items = comp.FindAll("div.mud-list-item").ToArray();
197              items[1].Click();
198              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
199              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
200              select.Instance.Text.Should().Be("2");
201              text.Should().Be("2");
202              input.Click();
203              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
204              items = comp.FindAll("div.mud-list-item").ToArray();
205              items[0].Click();
206              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
207              select.Instance.Text.Should().Be("1");
208              text.Should().Be("1");
209          }
210          [Test]
211          public void SingleSelect_Should_FireTextChangedBeforeSelectedValuesChanged()
212          {
213              var comp = Context.RenderComponent<SelectTest1>();
214              var select = comp.FindComponent<MudSelect<string>>();
215              string text = null;
216              IEnumerable<string> selectedValues = null;
217              var eventCounter = 0;
218              var textChangedCount = 0;
219              var selectedValuesChangedCount = 0;
220              select.SetCallback(s => s.TextChanged, x =>
221                {
222                    textChangedCount = eventCounter++;
223                    text = x;
224                });
225              select.SetCallback(s => s.SelectedValuesChanged, x =>
226                {
227                    selectedValuesChangedCount = eventCounter++;
228                    selectedValues = x;
229                });
230              var menu = comp.Find("div.mud-popover");
231              var input = comp.Find("div.mud-input-control");
232              select.Instance.Value.Should().BeNullOrEmpty();
233              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
234              input.Click();
235              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
236              menu.ClassList.Should().Contain("mud-popover-open");
237              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
238              var items = comp.FindAll("div.mud-list-item").ToArray();
239              items[1].Click();
240              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
241              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
242              select.Instance.Text.Should().Be("2");
243              text.Should().Be("2");
244              selectedValuesChangedCount.Should().Be(1);
245              textChangedCount.Should().Be(0);
246              string.Join(",", selectedValues).Should().Be("2");
247              input.Click();
248              comp.WaitForAssertion(()=>comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
249              items = comp.FindAll("div.mud-list-item").ToArray();
250              items[0].Click();
251              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
252              select.Instance.Text.Should().Be("1");
253              text.Should().Be("1");
254              string.Join(",", selectedValues).Should().Be("1");
255              comp.WaitForAssertion(() => selectedValuesChangedCount.Should().Be(3));
256              comp.WaitForAssertion(() => textChangedCount.Should().Be(2));
257          }
258          [Test]
259          public void MulitSelect_Should_FireTextChangedBeforeSelectedValuesChanged()
260          {
261              var comp = Context.RenderComponent<SelectTest1>();
262              var select = comp.FindComponent<MudSelect<string>>();
263              string text = null;
264              IEnumerable<string> selectedValues = null;
265              var eventCounter = 0;
266              var textChangedCount = 0;
267              var selectedValuesChangedCount = 0;
268              select.SetParam(s => s.MultiSelection, true);
269              select.SetCallback(s => s.TextChanged, x =>
270                {
271                    textChangedCount = eventCounter++;
272                    text = x;
273                });
274              select.SetCallback(s => s.SelectedValuesChanged, x =>
275                {
276                    selectedValuesChangedCount = eventCounter++;
277                    selectedValues = x;
278                });
279              var selectElement = comp.Find("div.mud-input-control");
280              selectElement.Click();
281              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
282              var items = comp.FindAll("div.mud-list-item").ToArray();
283              items[1].Click();
284              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
285              select.Instance.Text.Should().Be("2");
286              text.Should().Be("2");
287              selectedValuesChangedCount.Should().Be(1);
288              textChangedCount.Should().Be(0);
289              string.Join(",", selectedValues).Should().Be("2");
290              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
291              items = comp.FindAll("div.mud-list-item").ToArray();
292              items[0].Click();
293              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2, 1"));
294              select.Instance.Text.Should().Be("2, 1");
295              text.Should().Be("2, 1");
296              string.Join(",", selectedValues).Should().Be("2,1");
297              selectedValuesChangedCount.Should().Be(3);
298              textChangedCount.Should().Be(2);
299          }
300          [Test]
301          public async Task Select_Should_FireOnBlur()
302          {
303              var comp = Context.RenderComponent<SelectTest1>();
304              var select = comp.FindComponent<MudSelect<string>>();
305              var eventCounter = 0;
306              select.SetCallback(s => s.OnBlur, x => eventCounter++);
307              await comp.InvokeAsync(async () =>
308              {
309                  await select.Instance.OpenMenu();
310                  await select.Instance.CloseMenu();
311              });
312              eventCounter.Should().Be(1);
313          }
314          [Test]
315          public void Disabled_SelectItem_Should_Be_Respected()
316          {
317              var comp = Context.RenderComponent<SelectTest1>();
318              var select = comp.FindComponent<MudSelect<string>>();
319              var selectElement = comp.Find("div.mud-input-control");
320              selectElement.Click();
321              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item-disabled").Count.Should().Be(1));
322              comp.FindAll("div.mud-list-item-disabled")[0].Click();
323              comp.WaitForAssertion(() => select.Instance.Value.Should().BeNull());
324          }
325          [Test]
326          public async Task MultiSelect_ShouldCallValidationFunc()
327          {
328              await ImproveChanceOfSuccess(async () =>
329              {
330                  var comp = Context.RenderComponent<MultiSelectTest1>();
331                  var select = comp.FindComponent<MudSelect<string>>();
332                  string validatedValue = null;
333                  select.SetParam(x => x.Validation, new Func<string, bool>(value =>
334                  {
335                      validatedValue = value; 
336                      return true;
337                  }));
338                  var menu = comp.Find("div.mud-popover");
339                  var input = comp.Find("div.mud-input-control");
340                  select.Instance.Value.Should().BeNullOrEmpty();
341                  comp.WaitForAssertion(() =>
342                      comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
343                  input.Click();
344                  comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
345                  comp.WaitForAssertion(() => menu.ClassList.Should().Contain("mud-popover-open"));
346                  var items = comp.FindAll("div.mud-list-item").ToArray();
347                  items[1].Click();
348                  comp.WaitForAssertion(() => menu.ClassList.Should().Contain("mud-popover-open"));
349                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2"));
350                  validatedValue.Should().Be("2");
351                  items[0].Click();
352                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 1"));
353                  validatedValue.Should().Be("2, 1");
354                  items[2].Click();
355                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 1, 3"));
356                  validatedValue.Should().Be("2, 1, 3");
357                  items[0].Click();
358                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 3"));
359                  validatedValue.Should().Be("2, 3");
360              });
361          }
362          [Test]
363          public void MultiSelect_SelectAll()
364          {
365              var comp = Context.RenderComponent<MultiSelectTest2>();
366              var select = comp.FindComponent<MudSelect<string>>();
367              string validatedValue = null;
368              select.SetParam(x => x.Validation, (object)new Func<string, bool>(value =>
369              {
370                  validatedValue = value; 
371                  return true;
372              }));
373              var menu = comp.Find("div.mud-popover");
374              var input = comp.Find("div.mud-input-control");
375              input.Click();
376              menu.ClassList.Should().Contain("mud-popover-open");
377              comp.FindAll("div.mud-list-item")[0].Click();
378              comp.WaitForAssertion(() => select.Instance.Text.Should().Be("FirstA^SecondA^ThirdA"));
379              validatedValue.Should().Be("FirstA^SecondA^ThirdA");
380          }
381          [Test]
382          public void MultiSelect_SelectAll2()
383          {
384              var comp = Context.RenderComponent<MultiSelectTest3>();
385              var select = comp.FindComponent<MudSelect<string>>();
386              var menu = comp.Find("div.mud-popover");
387              var input = comp.Find("div.mud-input-control");
388              input.Click();
389              menu.ClassList.Should().Contain("mud-popover-open");
390              var selectAllItem = comp.FindComponent<MudListItem>();
391              selectAllItem.Instance.Icon.Should().Be("<path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/>");
392              var items = comp.FindComponents<MudSelectItem<string>>().Where(x=>x.Instance.HideContent==false).ToArray();
393              items.Should().HaveCount(7);
394              foreach (var item in items)
395              {
396                  item.Instance.IsSelected.Should().BeTrue();
397                  item.FindComponent<MudListItem>().Instance.Icon.Should().Be("<path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/>");
398              }
399              var shadowItems = comp.FindComponents<MudSelectItem<string>>().Where(x => x.Instance.HideContent == true).ToArray();
400              foreach (var item in shadowItems)
401              {
402                  Assert.Throws<Bunit.Rendering.ComponentNotFoundException>(() => item.FindComponent<MudListItem>());
403              }
404          }
405          [Test]
406          public void MultiSelect_SelectAll3()
407          {
408              var comp = Context.RenderComponent<MultiSelectTest4>();
409              var select = comp.FindComponent<MudSelect<string>>();
410              var menu = comp.Find("div.mud-popover");
411              var input = comp.Find("div.mud-input-control");
412              input.Click();
413              menu.ClassList.Should().Contain("mud-popover-open");
414              var mudListItem = comp.FindComponent<MudListItem>();
415              mudListItem.Instance.Icon.Should().Be("<path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\"/>");
416          }
417          [Test]
418          public void SingleSelect_Should_CallValidationFunc()
419          {
420              var comp = Context.RenderComponent<SelectTest1>();
421              var select = comp.FindComponent<MudSelect<string>>();
422              string validatedValue = null;
423              select.SetParam(x => x.Validation, (object)new Func<string, bool>(value =>
424              {
425                  validatedValue = value; 
426                  return true;
427              }));
428              var menu = comp.Find("div.mud-popover");
429              var input = comp.Find("div.mud-input-control");
430              select.Instance.Value.Should().BeNullOrEmpty();
431              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
432              input.Click();
433              menu.ClassList.Should().Contain("mud-popover-open");
434              comp.WaitForAssertion(()=> comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
435              comp.FindAll("div.mud-list-item")[1].Click();
436              comp.WaitForAssertion(() => menu.ClassList.Should().NotContain("mud-popover-open"));
437              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
438              select.Instance.Text.Should().Be("2");
439              validatedValue.Should().Be("2");
440              input.Click();
441              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
442              comp.FindAll("div.mud-list-item")[0].Click();
443              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
444              select.Instance.Text.Should().Be("1");
445              validatedValue.Should().Be("1");
446          }
447          [Test]
448          public async Task MultiSelect_Initial_Values()
449          {
450              var comp = Context.RenderComponent<MultiSelectWithInitialValues>();
451              var input = comp.Find("input");
452              var value = input.Attributes.Where(a => a.LocalName == "value").First().Value;
453              value.Should().Be("FirstA, SecondA");
454          }
455          [Test]
456          public async Task MultiSelectCustomizedTextTest()
457          {
458              var comp = Context.RenderComponent<MultiSelectCustomizedTextTest>();
459              var input = comp.Find("input");
460              var value = input.Attributes.Where(a => a.LocalName == "value").First().Value;
461              value.Should().Be("Selected values: FirstA, SecondA");
462          }
463          [Test]
464          public async Task SelectClearableTest()
465          {
466              var comp = Context.RenderComponent<SelectClearableTest>();
467              var select = comp.FindComponent<MudSelect<string>>();
468              var input = comp.Find("div.mud-input-control");
469              comp.FindAll("button").Should().BeEmpty();
470              input.Click();
471              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
472              var items = comp.FindAll("div.mud-list-item").ToArray();
473              items[1].Click();
474              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
475              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
476              comp.Find("button").Should().NotBeNull();
477              comp.Find("button").Click();
478              comp.WaitForAssertion(() => select.Instance.Value.Should().BeNullOrEmpty());
479              comp.FindAll("button").Should().BeEmpty();
480              comp.Instance.ClearButtonClicked.Should().BeTrue();
481          }
482          [Test]
483          public void SelectReselectTest()
484          {
485              var comp = Context.RenderComponent<ReselectValueTest>();
486              var select = comp.FindComponent<MudSelect<string>>();
487              var menu = comp.Find("div.mud-popover");
488              var input = comp.Find("div.mud-input-control");
489              input.Click();
490              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
491              select.Instance.Value.Should().Be("Apple");
492              var items = comp.FindAll("div.mud-list-item").ToArray();
493              items[1].Click();
494              comp.WaitForAssertion(() => menu.ClassList.Should().NotContain("mud-popover-open"));
495              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Orange"));
496              comp.Instance.ChangeCount.Should().Be(1);
497              input.Click();
498              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
499              items = comp.FindAll("div.mud-list-item").ToArray();
500              items[1].Click();
501              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Orange"));
502              comp.Instance.ChangeCount.Should().Be(1);
503          }
504          #region DataAttribute validation
505          [Test]
506          public async Task TextField_Should_Validate_Data_Attribute_Fail()
507          {
508              var comp = Context.RenderComponent<SelectValidationDataAttrTest>();
509              var selectcomp = comp.FindComponent<MudSelect<string>>();
510              var select = selectcomp.Instance;
511              await comp.InvokeAsync(() => select.SelectOption("Quux"));
512              select.Value.Should().Be("Quux");
513              select.Text.Should().Be("Quux");
514              await comp.InvokeAsync(() => select.Validate());
515              select.ValidationErrors.Should().NotBeEmpty();
516              select.ValidationErrors.Should().HaveCount(1);
517              select.ValidationErrors[0].Should().Be("Should not be longer than 3");
518          }
519          [Test]
520          public async Task TextField_Should_Validate_Data_Attribute_Success()
521          {
522              var comp = Context.RenderComponent<SelectValidationDataAttrTest>();
523              var selectcomp = comp.FindComponent<MudSelect<string>>();
524              var select = selectcomp.Instance;
525              await comp.InvokeAsync(() => select.SelectOption("Qux"));
526              select.Value.Should().Be("Qux");
527              select.Text.Should().Be("Qux");
528              await comp.InvokeAsync(() => select.Validate());
529              select.ValidationErrors.Should().BeEmpty();
530          }
531          #endregion
532          [Test]
533          public async Task Select_Should_SetRequiredTrue()
534          {
535              var comp = Context.RenderComponent<SelectRequiredTest>();
536              var select = comp.FindComponent<MudSelect<string>>().Instance;
537              select.Required.Should().BeTrue();
538              await comp.InvokeAsync(() => select.Validate());
539              select.ValidationErrors.First().Should().Be("Required");
540          }
541          [Test]
542          public async Task Select_Should_HilightSelectedValue()
543          {
544              var comp = Context.RenderComponent<SelectTest1>();
545              var select = comp.FindComponent<MudSelect<string>>();
546              var input = comp.Find("div.mud-input-control");
547              comp.Find("div.mud-popover").ClassList.Should().Contain("select-popover-class");
548              select.Instance.Value.Should().BeNullOrEmpty();
549              comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open");
550              comp.Find("div.mud-input-control").Click();
551              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
552              comp.WaitForAssertion(() => comp.FindAll("div.mud-selected-item").Count.Should().Be(0));
553              comp.FindAll("div.mud-list-item")[1].Click();
554              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
555              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
556              comp.Find("div.mud-input-control").Click();
557              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
558              comp.WaitForAssertion(() => comp.FindAll("div.mud-selected-item").Count.Should().Be(1));
559              comp.FindAll("div.mud-list-item")[1].ToMarkup().Should().Contain("mud-selected-item");
560              await comp.InvokeAsync(() => select.Instance.CloseMenu());
561              select.SetParam(nameof(MudSelect<string>.Value), null);
562              await comp.InvokeAsync(() => select.Instance.OpenMenu());
563              comp.WaitForAssertion(() => comp.FindAll("div.mud-selected-item").Count.Should().Be(0));
564          }
565          [Test]
566          public void Select_Should_HilightInitiallySelectedValue()
567          {
568              var comp = Context.RenderComponent<SelectTest2>();
569              var select = comp.FindComponent<MudSelect<string>>();
570              comp.Find("div.mud-popover").ClassList.Should().Contain("select-popover-class");
571              select.Instance.Value.Should().Be("2");
572              comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open");
573              comp.Find("div.mud-input-control").Click();
574              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
575              comp.WaitForAssertion(()=>comp.FindAll("div.mud-selected-item").Count.Should().Be(1));
576              comp.FindAll("div.mud-list-item")[1].ToMarkup().Should().Contain("mud-selected-item");
577              comp.FindAll("div.mud-list-item")[0].Click();
578              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
579              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
580              comp.Find("div.mud-input-control").Click();
581              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
582              comp.WaitForAssertion(() => comp.FindAll("div.mud-selected-item").Count.Should().Be(1));
583              comp.FindAll("div.mud-list-item")[0].ToMarkup().Should().Contain("mud-selected-item");
584              comp.Find("div.mud-input-control").Click();
585              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
586          }
587          [Test]
588          public async Task Select_Should_AllowReloadingItems()
589          {
590              var comp = Context.RenderComponent<ReloadSelectItemsTest>();
591              var select = comp.FindComponent<MudSelect<string>>();
592              comp.Find("div.mud-input-control").Click();
593              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
594              comp.FindAll("div.mud-list-item")[0].Click();
595              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
596              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("American Samoa"));
597              comp.Find("div.mud-input-control").Click();
598              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
599              comp.FindAll("div.mud-list-item")[1].Click();
600              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
601              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Arizona"));
602              comp.Find("div.mud-input-control").Click();
603              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
604              comp.FindAll("div.mud-list-item")[2].Click();
605              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
606              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Arkansas"));
607              comp.Find(".reload").Click();
608              comp.Find("div.mud-input-control").Click();
609              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
610              comp.FindAll("div.mud-list-item")[0].Click();
611              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
612              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Alabama"));
613              comp.Find("div.mud-input-control").Click();
614              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
615              comp.FindAll("div.mud-list-item")[1].Click();
616              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
617              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Alaska"));
618              comp.Find("div.mud-input-control").Click();
619              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
620              comp.FindAll("div.mud-list-item")[2].Click();
621              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
622              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("American Samoa"));
623          }
624          [Test]
625          public async Task SelectTest_ToggleOpenCloseMenuMethods()
626          {
627              var comp = Context.RenderComponent<SelectTest1>();
628              var select = comp.FindComponent<MudSelect<string>>();
629              await comp.InvokeAsync(() => select.Instance.ToggleMenu());
630              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
631              select.SetParam("Disabled", true);
632              await comp.InvokeAsync(() => select.Instance.ToggleMenu());
633              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
634              await comp.InvokeAsync(() => select.Instance.Add(null));
635              comp.WaitForAssertion(() => select.Instance._items.Count.Should().Be(4));
636              select.SetParam("Disabled", false);
637              await comp.InvokeAsync(() => select.Instance.ToggleMenu());
638              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
639              select.SetParam("Disabled", true);
640              await comp.InvokeAsync(() => select.Instance.ToggleMenu());
641              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
642              await comp.InvokeAsync(() => select.Instance.OpenMenu());
643              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
644          }
645          [Test]
646          public async Task SelectTest_KeyboardNavigation_SingleSelect()
647          {
648              var comp = Context.RenderComponent<SelectTest1>();
649              var select = comp.FindComponent<MudSelect<string>>();
650              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
651              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
652              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
653              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
654              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = " ", Type = "keydown", }));
655              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
656              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
657              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
658              comp.WaitForAssertion(() => select.Instance.Value.Should().Be(null));
659              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", AltKey = true, Type = "keydown", }));
660              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
661              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowUp", AltKey = true, Type = "keydown", }));
662              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
663              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
664              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
665              comp.WaitForAssertion(() => select.Instance.Value.Should().Be(null));
666              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "NumpadEnter", Type = "keydown", }));
667              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
668              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowUp", Type = "keydown", }));
669              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
670              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
671              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
672              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "End", Type = "keydown", }));
673              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("3"));
674              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowUp", Type = "keydown", }));
675              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
676              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Home", Type = "keydown", }));
677              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
678              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowUp", Type = "keydown", }));
679              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
680              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "End", Type = "keydown", }));
681              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
682              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("3"));
683              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "2", Type = "keydown", }));
684              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
685              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "2", Type = "keydown", }));
686              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
687              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().HaveCount(1));
688              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = " ", Type = "keydown", }));
689              comp.Render(); 
690              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
691          }
692          [Test]
693          public async Task SelectTest_KeyboardNavigation_MultiSelect()
694          {
695              var comp = Context.RenderComponent<MultiSelectTest3>();
696              var select = comp.FindComponent<MudSelect<string>>();
697              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = " ", Type = "keydown", }));
698              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
699              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "a", CtrlKey = true, Type = "keydown", }));
700              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("0 feline has been selected"));
701              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "A", CtrlKey = true, Type = "keydown", }));
702              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("7 felines have been selected"));
703              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
704              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
705              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("6 felines have been selected"));
706              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "A", CtrlKey = true, Type = "keydown", }));
707              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("7 felines have been selected"));
708              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
709              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
710              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
711              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
712              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
713              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
714              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().Contain("Jaguar"));
715              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Home", Type = "keydown", }));
716              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "NumpadEnter", Type = "keydown", }));
717              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().NotContain("Jaguar"));
718              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
719              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
720              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().Contain("Leopard"));
721              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "End", Type = "keydown", }));
722              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
723              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().NotContain("Tiger"));
724              select.SetParam("Disabled", true);
725              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
726              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().NotContain("Tiger"));
727              select.SetParam("Disabled", false);
728              await comp.InvokeAsync(() => select.Instance.HandleKeyUp(new KeyboardEventArgs() { Key = "Enter", Type = "keyup", }));
729              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().NotContain("Tiger"));
730              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Tab", Type = "keydown", }));
731              await comp.InvokeAsync(() => select.Instance.OnKeyUp.InvokeAsync(new KeyboardEventArgs() { Key = "Tab" }));
732              comp.Render(); 
733              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
734          }
735          [Test]
736          public async Task SelectTest_KeyboardNavigation_MultiSelect_Focus()
737          {
738              var comp = Context.RenderComponent<MultiSelectTest6>();
739              var select = comp.FindComponent<MudSelect<string>>();
740              var mudSelectElement = comp.Find(".mud-select");
741              comp.Find("div.mud-input-control").Click();
742              select.Instance._isOpen.Should().BeTrue();
743              var items = comp.FindAll("div.mud-list-item").ToArray();
744              items[0].Click();
745              items[2].Click();
746              mudSelectElement.FocusOut();
747              comp.WaitForAssertion(() => select.Instance.Text.Should().Be("Alaska, Alabama, American Samoa"));
748              Context.JSInterop.VerifyFocusAsyncInvoke();
749          }
750          [Test]
751          public async Task SelectTest_ItemlessSelect()
752          {
753              var comp = Context.RenderComponent<MudSelect<string>>();
754              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = " ", Type = "keydown", }));
755              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
756              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Home", Type = "keydown", }));
757              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "End", Type = "keydown", }));
758              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
759              comp.WaitForAssertion(() => comp.Instance.SelectedValues.Should().HaveCount(0));
760              comp.WaitForAssertion(() => comp.Instance.Value.Should().Be(null));
761          }
762          [Test]
763          public void MultiSelectWithCustomComparerTest()
764          {
765              var comp = Context.RenderComponent<MultiSelectWithCustomComparerTest>();
766              comp.Find("button").Click();
767              comp.Find("input").GetAttribute("value").Should().Be("Selected Cafe Latte, Selected Espresso");
768              comp.Find("div.mud-input-control").Click();
769              const string @unchecked =
770                  "M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z";
771              const string @checked =
772                  "M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z";
773              var icons = comp.FindAll("div.mud-list-item path").ToArray();
<span onclick='openModal()' class='match'>774              icons[1].Attributes["d"].Value.Should().Be(@unchecked);
775              icons[3].Attributes["d"].Value.Should().Be(@checked);
</span>776              icons[5].Attributes["d"].Value.Should().Be(@checked);
777              icons[7].Attributes["d"].Value.Should().Be(@unchecked);
778          }
779          [Test]
780          public void Select_Item_Collection_Should_Match_Number_Of_Select_Options()
781          {
782              var comp = Context.RenderComponent<SelectTest1>();
783              var sut = comp.FindComponent<MudSelect<string>>();
784              var input = comp.Find("div.mud-input-control");
785              input.Click();
786              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
787              sut.Instance.Items.Should().HaveCountGreaterOrEqualTo(4);
788          }
789          [Test]
790          public async Task Select_ValueChangeEventCountTest()
791          {
792              var comp = Context.RenderComponent<SelectEventCountTest>(x =>
793              {
794                  x.Add(c => c.MultiSelection, false);
795              });
796              var select = comp.FindComponent<MudSelect<string>>();
797              var input = comp.Find("div.mud-input-control");
798              comp.Instance.ValueChangeCount.Should().Be(0);
799              comp.Instance.ValuesChangeCount.Should().Be(0);
800              await comp.InvokeAsync(() => select.SetParam("Value", "1"));
801              await comp.InvokeAsync(() => select.Instance.ForceUpdate());
802              comp.WaitForAssertion(() => comp.Instance.ValueChangeCount.Should().Be(1));
803              comp.Instance.ValuesChangeCount.Should().Be(1);
804              select.Instance.Value.Should().Be("1");
805              await comp.InvokeAsync(() => select.SetParam("Value", "2"));
806              comp.WaitForAssertion(() => comp.Instance.ValueChangeCount.Should().Be(1));
807              comp.Instance.ValuesChangeCount.Should().Be(1);
808              select.Instance.Value.Should().Be("2");
809          }
810          [Test]
811          public async Task MultiSelectWithRequiredValue()
812          {
813              var comp = Context.RenderComponent<MultiSelectTestRequiredValue>();
814              var select = comp.FindComponent<MudSelect<string>>().Instance;
815              select.Required.Should().BeTrue();
816              await comp.InvokeAsync(() => select.Validate());
817              select.ValidationErrors.First().Should().Be("Required");
818              var selectWithT = comp.FindComponent<MudSelect<MultiSelectTestRequiredValue.TestClass>>().Instance;
819              selectWithT.Required.Should().BeTrue();
820              await comp.InvokeAsync(() => selectWithT.Validate());
821              selectWithT.ValidationErrors.First().Should().Be("Required");
822              var inputs = comp.FindAll("div.mud-input-control");
823              inputs[0].Click();
824              var items = comp.FindAll("div.mud-list-item").ToArray();
825              items[1].Click();
826              await comp.InvokeAsync(() => select.Validate());
827              select.ValidationErrors.Count.Should().Be(0);
828              inputs[1].Click();
829              comp.WaitForState(() => comp.FindAll("div.mud-list-item").Count == 5);
830              items = comp.FindAll("div.mud-list-item").ToArray();
831              items[3].Click();
832              await comp.InvokeAsync(() => selectWithT.Validate());
833              selectWithT.ValidationErrors.Count.Should().Be(0);
834          }
835          [Test]
836          public async Task MultiSelectAttributesOrder()
837          {
838              var comp = Context.RenderComponent<MultiSelectTest5>();
839              var select = comp.FindComponent<MudSelect<string>>().Instance;
840              select.SelectedValues.Count().Should().Be(2);
841              select.Text.Should().Be("Programista, test");
842              await comp.InvokeAsync(() =>
843              {
844                  select.SelectedValues = new List<string> { "test" };
845              });
846              select.SelectedValues.Count().Should().Be(1);
847              select.Text.Should().Be("test");
848          }
849      }
850  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-SelectTests.cs</h3>
            <pre><code>1  #pragma warning disable CS1998 
2  #pragma warning disable IDE1006 
3  #pragma warning disable BL0005 
4  using System;
5  using System.Collections.Generic;
6  using System.Linq;
7  using System.Threading.Tasks;
8  using Bunit;
9  using FluentAssertions;
10  using Microsoft.AspNetCore.Components.Web;
11  using MudBlazor.UnitTests.TestComponents;
12  using MudBlazor.UnitTests.TestComponents.Select;
13  using NUnit.Framework;
14  using static MudBlazor.UnitTests.TestComponents.SelectWithEnumTest;
15  namespace MudBlazor.UnitTests.Components
16  {
17      [TestFixture]
18      public class SelectTests : BunitTest
19      {
20          [Test]
21          public async Task SelectTest_CheckListClass()
22          {
23              var comp = Context.RenderComponent<SelectRequiredTest>();
24              var select = comp.FindComponent<MudSelect<string>>();
25              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter" }));
26              await comp.InvokeAsync(() => select.SetParam("ListClass", "my-list-class"));
27              var list = comp.FindComponent<MudList>();
28              comp.WaitForAssertion(() => comp.Markup.Should().Contain("my-list-class"));
29          }
30          [Test]
31          public void SelectLabelFor()
32          {
33              var comp = Context.RenderComponent<SelectRequiredTest>();
34              var label = comp.FindAll(".mud-input-label");
35              label[0].Attributes.GetNamedItem("for")?.Value.Should().Be("selectLabelTest");
36          }
37          [Test]
38          public async Task SelectTest1()
39          {
40              var comp = Context.RenderComponent<SelectTest1>();
41              var select = comp.FindComponent<MudSelect<string>>();
42              var menu = comp.Find("div.mud-popover");
43              var input = comp.Find("div.mud-input-control");
44              menu.ClassList.Should().Contain("select-popover-class");
45              select.Instance.Value.Should().BeNullOrEmpty();
46              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
47              input.Click();
48              menu.ClassList.Should().Contain("mud-popover-open");
49              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
50              var items = comp.FindAll("div.mud-list-item").ToArray();
51              items[1].Click();
52              comp.WaitForAssertion(() => menu.ClassList.Should().NotContain("mud-popover-open"));
53              select.Instance.Value.Should().Be("2");
54              input.Click();
55              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
56              items = comp.FindAll("div.mud-list-item").ToArray();
57              items[0].Click();
58              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
59              var @switch = comp.FindComponent<MudSwitch<bool>>();
60              @switch.Instance.Checked = true;
61              await comp.InvokeAsync(() => select.Instance.OnBlurAsync(new FocusEventArgs()));
62              comp.WaitForAssertion(() => @switch.Instance.Checked.Should().Be(false));
63          }
64          [Test]
65          public async Task MultiSelectTest1()
66          {
67              await ImproveChanceOfSuccess(async () =>
68              {
69                  var comp = Context.RenderComponent<MultiSelectTest1>();
70                  var select = comp.FindComponent<MudSelect<string>>();
71                  var menu = comp.Find("div.mud-popover");
72                  var input = comp.Find("div.mud-input-control");
73                  select.Instance.Value.Should().BeNullOrEmpty();
74                  comp.WaitForAssertion(() =>
75                      comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
76                  input.Click();
77                  menu.ClassList.Should().Contain("mud-popover-open");
78                  comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
79                  var items = comp.FindAll("div.mud-list-item").ToArray();
80                  items[1].Click();
81                  menu.ClassList.Should().Contain("mud-popover-open");
82                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2"));
83                  items[0].Click();
84                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 1"));
85                  items[2].Click();
86                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 1, 3"));
87                  items[0].Click();
88                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 3"));
89                  select.Instance.SelectedValues.Count().Should().Be(2);
90                  select.Instance.SelectedValues.Should().Contain("2");
91                  select.Instance.SelectedValues.Should().Contain("3");
92                  const string @unchecked =
93                      "M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z";
94                  const string @checked =
95                      "M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z";
96                  comp.WaitForAssertion(() =>
97                      comp.FindAll("div.mud-list-item path")[1].Attributes["d"].Value.Should().Be(@unchecked));
98                  comp.FindAll("div.mud-list-item path")[3].Attributes["d"].Value.Should().Be(@checked);
99                  comp.FindAll("div.mud-list-item path")[5].Attributes["d"].Value.Should().Be(@checked);
100                  await comp.InvokeAsync(() =>
101                  {
102                      select.Instance.SelectedValues = new HashSet<string>() { "1", "2" };
103                  });
104                  comp.WaitForAssertion(() =>
105                      comp.FindAll("div.mud-list-item path")[1].Attributes["d"].Value.Should().Be(@checked));
106                  comp.FindAll("div.mud-list-item path")[3].Attributes["d"].Value.Should().Be(@checked);
107                  comp.FindAll("div.mud-list-item path")[5].Attributes["d"].Value.Should().Be(@unchecked);
108              });
109          }
110          [Test]
111          public async Task SelectWithEnumTest()
112          {
113              var comp = Context.RenderComponent<SelectWithEnumTest>();
114              var select = comp.FindComponent<MudSelect<MyEnum>>();
115              var input = comp.Find("div.mud-input-control");
116              select.Instance.Value.Should().Be(default(MyEnum));
117              select.Instance.Text.Should().Be(default(MyEnum).ToString());
118              comp.Find("input").Attributes["value"]?.Value.Should().Be("First");
119              comp.RenderCount.Should().Be(1);
120              input.Click();
121              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
122              var items = comp.FindAll("div.mud-list-item").ToArray();
123              items[1].Click();
124              comp.WaitForAssertion(() => comp.Find("input").Attributes["value"]?.Value.Should().Be("Second"));
125          }
126          [Test]
127          public void SelectUnrepresentableValueTest()
128          {
129              var comp = Context.RenderComponent<SelectUnrepresentableValueTest>();
130              var select = comp.FindComponent<MudSelect<int>>();
131              var input = comp.Find("div.mud-input-control");
132              select.Instance.Value.Should().Be(17);
133              select.Instance.Text.Should().Be("17");
134              comp.Find("input").Attributes["value"]?.Value.Should().Be("17");
135              input.Click();
136              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
137              var items = comp.FindAll("div.mud-list-item").ToArray();
138              items[1].Click();
139              comp.WaitForAssertion(() => comp.Find("div.mud-input-slot").TextContent.Trim().Should().Be("Two"));
140              select.Instance.Value.Should().Be(2);
141              select.Instance.Text.Should().Be("2");
142          }
143          [Test]
144          public async Task SelectUnrepresentableValueTest2()
145          {
146              var comp = Context.RenderComponent<SelectUnrepresentableValueTest2>();
147              var select = comp.FindComponent<MudSelect<int>>();
148              var input = comp.Find("div.mud-input-control");
149              select.Instance.Value.Should().Be(17);
150              select.Instance.Text.Should().Be("17");
151              await Task.Delay(100);
152              comp.FindComponent<MudInput<string>>().Instance.Value.Should().Be(null);
153              comp.FindComponent<MudInput<string>>().Instance.InputType.Should().Be(InputType.Hidden);
154              input.Click();
155              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
156              var items = comp.FindAll("div.mud-list-item").ToArray();
157              items[1].Click();
158              comp.WaitForAssertion(() => select.Instance.Value.Should().Be(2));
159              select.Instance.Text.Should().Be("2");
160              comp.FindComponent<MudInput<string>>().Instance.Value.Should().Be("2");
161              comp.FindComponent<MudInput<string>>().Instance.InputType.Should().Be(InputType.Text); 
162          }
163          [Test]
164          public void SelectWithoutItemPresentersTest()
165          {
166              var comp = Context.RenderComponent<SelectWithoutItemPresentersTest>();
167              var select = comp.FindComponent<MudSelect<int>>();
168              var input = comp.Find("div.mud-input-control");
169              select.Instance.Value.Should().Be(1);
170              select.Instance.Text.Should().Be("1");
171              comp.Find("div.mud-input-slot").Attributes["style"].Value.Should().Contain("display:none");
172              comp.RenderCount.Should().Be(1);
173              input.Click();
174              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
175              var items = comp.FindAll("div.mud-list-item").ToArray();
176              items[1].Click();
177              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
178              comp.WaitForAssertion(() => comp.Find("div.mud-input-slot").Attributes["style"].Value.Should().Contain("display:none"));
179              select.Instance.Value.Should().Be(2);
180              select.Instance.Text.Should().Be("2");
181          }
182          [Test]
183          public void Select_Should_FireTextChangedWithNewValue()
184          {
185              var comp = Context.RenderComponent<SelectTest1>();
186              var select = comp.FindComponent<MudSelect<string>>();
187              string text = null;
188              select.SetCallback(s => s.TextChanged, x => text = x);
189              var menu = comp.Find("div.mud-popover");
190              var input = comp.Find("div.mud-input-control");
191              select.Instance.Value.Should().BeNullOrEmpty();
192              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
193              input.Click();
194              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
195              menu.ClassList.Should().Contain("mud-popover-open");
196              var items = comp.FindAll("div.mud-list-item").ToArray();
197              items[1].Click();
198              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
199              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
200              select.Instance.Text.Should().Be("2");
201              text.Should().Be("2");
202              input.Click();
203              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
204              items = comp.FindAll("div.mud-list-item").ToArray();
205              items[0].Click();
206              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
207              select.Instance.Text.Should().Be("1");
208              text.Should().Be("1");
209          }
210          [Test]
211          public void SingleSelect_Should_FireTextChangedBeforeSelectedValuesChanged()
212          {
213              var comp = Context.RenderComponent<SelectTest1>();
214              var select = comp.FindComponent<MudSelect<string>>();
215              string text = null;
216              IEnumerable<string> selectedValues = null;
217              var eventCounter = 0;
218              var textChangedCount = 0;
219              var selectedValuesChangedCount = 0;
220              select.SetCallback(s => s.TextChanged, x =>
221                {
222                    textChangedCount = eventCounter++;
223                    text = x;
224                });
225              select.SetCallback(s => s.SelectedValuesChanged, x =>
226                {
227                    selectedValuesChangedCount = eventCounter++;
228                    selectedValues = x;
229                });
230              var menu = comp.Find("div.mud-popover");
231              var input = comp.Find("div.mud-input-control");
232              select.Instance.Value.Should().BeNullOrEmpty();
233              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
234              input.Click();
235              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
236              menu.ClassList.Should().Contain("mud-popover-open");
237              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
238              var items = comp.FindAll("div.mud-list-item").ToArray();
239              items[1].Click();
240              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
241              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
242              select.Instance.Text.Should().Be("2");
243              text.Should().Be("2");
244              selectedValuesChangedCount.Should().Be(1);
245              textChangedCount.Should().Be(0);
246              string.Join(",", selectedValues).Should().Be("2");
247              input.Click();
248              comp.WaitForAssertion(()=>comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
249              items = comp.FindAll("div.mud-list-item").ToArray();
250              items[0].Click();
251              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
252              select.Instance.Text.Should().Be("1");
253              text.Should().Be("1");
254              string.Join(",", selectedValues).Should().Be("1");
255              comp.WaitForAssertion(() => selectedValuesChangedCount.Should().Be(3));
256              comp.WaitForAssertion(() => textChangedCount.Should().Be(2));
257          }
258          [Test]
259          public void MulitSelect_Should_FireTextChangedBeforeSelectedValuesChanged()
260          {
261              var comp = Context.RenderComponent<SelectTest1>();
262              var select = comp.FindComponent<MudSelect<string>>();
263              string text = null;
264              IEnumerable<string> selectedValues = null;
265              var eventCounter = 0;
266              var textChangedCount = 0;
267              var selectedValuesChangedCount = 0;
268              select.SetParam(s => s.MultiSelection, true);
269              select.SetCallback(s => s.TextChanged, x =>
270                {
271                    textChangedCount = eventCounter++;
272                    text = x;
273                });
274              select.SetCallback(s => s.SelectedValuesChanged, x =>
275                {
276                    selectedValuesChangedCount = eventCounter++;
277                    selectedValues = x;
278                });
279              var selectElement = comp.Find("div.mud-input-control");
280              selectElement.Click();
281              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
282              var items = comp.FindAll("div.mud-list-item").ToArray();
283              items[1].Click();
284              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
285              select.Instance.Text.Should().Be("2");
286              text.Should().Be("2");
287              selectedValuesChangedCount.Should().Be(1);
288              textChangedCount.Should().Be(0);
289              string.Join(",", selectedValues).Should().Be("2");
290              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
291              items = comp.FindAll("div.mud-list-item").ToArray();
292              items[0].Click();
293              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2, 1"));
294              select.Instance.Text.Should().Be("2, 1");
295              text.Should().Be("2, 1");
296              string.Join(",", selectedValues).Should().Be("2,1");
297              selectedValuesChangedCount.Should().Be(3);
298              textChangedCount.Should().Be(2);
299          }
300          [Test]
301          public async Task Select_Should_FireOnBlur()
302          {
303              var comp = Context.RenderComponent<SelectTest1>();
304              var select = comp.FindComponent<MudSelect<string>>();
305              var eventCounter = 0;
306              select.SetCallback(s => s.OnBlur, x => eventCounter++);
307              await comp.InvokeAsync(async () =>
308              {
309                  await select.Instance.OpenMenu();
310                  await select.Instance.CloseMenu();
311              });
312              eventCounter.Should().Be(1);
313          }
314          [Test]
315          public void Disabled_SelectItem_Should_Be_Respected()
316          {
317              var comp = Context.RenderComponent<SelectTest1>();
318              var select = comp.FindComponent<MudSelect<string>>();
319              var selectElement = comp.Find("div.mud-input-control");
320              selectElement.Click();
321              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item-disabled").Count.Should().Be(1));
322              comp.FindAll("div.mud-list-item-disabled")[0].Click();
323              comp.WaitForAssertion(() => select.Instance.Value.Should().BeNull());
324          }
325          [Test]
326          public async Task MultiSelect_ShouldCallValidationFunc()
327          {
328              await ImproveChanceOfSuccess(async () =>
329              {
330                  var comp = Context.RenderComponent<MultiSelectTest1>();
331                  var select = comp.FindComponent<MudSelect<string>>();
332                  string validatedValue = null;
333                  select.SetParam(x => x.Validation, new Func<string, bool>(value =>
334                  {
335                      validatedValue = value; 
336                      return true;
337                  }));
338                  var menu = comp.Find("div.mud-popover");
339                  var input = comp.Find("div.mud-input-control");
340                  select.Instance.Value.Should().BeNullOrEmpty();
341                  comp.WaitForAssertion(() =>
342                      comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
343                  input.Click();
344                  comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
345                  comp.WaitForAssertion(() => menu.ClassList.Should().Contain("mud-popover-open"));
346                  var items = comp.FindAll("div.mud-list-item").ToArray();
347                  items[1].Click();
348                  comp.WaitForAssertion(() => menu.ClassList.Should().Contain("mud-popover-open"));
349                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2"));
350                  validatedValue.Should().Be("2");
351                  items[0].Click();
352                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 1"));
353                  validatedValue.Should().Be("2, 1");
354                  items[2].Click();
355                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 1, 3"));
356                  validatedValue.Should().Be("2, 1, 3");
357                  items[0].Click();
358                  comp.WaitForAssertion(() => select.Instance.Text.Should().Be("2, 3"));
359                  validatedValue.Should().Be("2, 3");
360              });
361          }
362          [Test]
363          public void MultiSelect_SelectAll()
364          {
365              var comp = Context.RenderComponent<MultiSelectTest2>();
366              var select = comp.FindComponent<MudSelect<string>>();
367              string validatedValue = null;
368              select.SetParam(x => x.Validation, (object)new Func<string, bool>(value =>
369              {
370                  validatedValue = value; 
371                  return true;
372              }));
373              var menu = comp.Find("div.mud-popover");
374              var input = comp.Find("div.mud-input-control");
375              input.Click();
376              menu.ClassList.Should().Contain("mud-popover-open");
377              comp.FindAll("div.mud-list-item")[0].Click();
378              comp.WaitForAssertion(() => select.Instance.Text.Should().Be("FirstA^SecondA^ThirdA"));
379              validatedValue.Should().Be("FirstA^SecondA^ThirdA");
380          }
381          [Test]
382          public void MultiSelect_SelectAll2()
383          {
384              var comp = Context.RenderComponent<MultiSelectTest3>();
385              var select = comp.FindComponent<MudSelect<string>>();
386              var menu = comp.Find("div.mud-popover");
387              var input = comp.Find("div.mud-input-control");
388              input.Click();
389              menu.ClassList.Should().Contain("mud-popover-open");
390              var selectAllItem = comp.FindComponent<MudListItem>();
391              selectAllItem.Instance.Icon.Should().Be("<path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/>");
392              var items = comp.FindComponents<MudSelectItem<string>>().Where(x=>x.Instance.HideContent==false).ToArray();
393              items.Should().HaveCount(7);
394              foreach (var item in items)
395              {
396                  item.Instance.IsSelected.Should().BeTrue();
397                  item.FindComponent<MudListItem>().Instance.Icon.Should().Be("<path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"/>");
398              }
399              var shadowItems = comp.FindComponents<MudSelectItem<string>>().Where(x => x.Instance.HideContent == true).ToArray();
400              foreach (var item in shadowItems)
401              {
402                  Assert.Throws<Bunit.Rendering.ComponentNotFoundException>(() => item.FindComponent<MudListItem>());
403              }
404          }
405          [Test]
406          public void MultiSelect_SelectAll3()
407          {
408              var comp = Context.RenderComponent<MultiSelectTest4>();
409              var select = comp.FindComponent<MudSelect<string>>();
410              var menu = comp.Find("div.mud-popover");
411              var input = comp.Find("div.mud-input-control");
412              input.Click();
413              menu.ClassList.Should().Contain("mud-popover-open");
414              var mudListItem = comp.FindComponent<MudListItem>();
415              mudListItem.Instance.Icon.Should().Be("<path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\"/>");
416          }
417          [Test]
418          public void SingleSelect_Should_CallValidationFunc()
419          {
420              var comp = Context.RenderComponent<SelectTest1>();
421              var select = comp.FindComponent<MudSelect<string>>();
422              string validatedValue = null;
423              select.SetParam(x => x.Validation, (object)new Func<string, bool>(value =>
424              {
425                  validatedValue = value; 
426                  return true;
427              }));
428              var menu = comp.Find("div.mud-popover");
429              var input = comp.Find("div.mud-input-control");
430              select.Instance.Value.Should().BeNullOrEmpty();
431              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
432              input.Click();
433              menu.ClassList.Should().Contain("mud-popover-open");
434              comp.WaitForAssertion(()=> comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
435              comp.FindAll("div.mud-list-item")[1].Click();
436              comp.WaitForAssertion(() => menu.ClassList.Should().NotContain("mud-popover-open"));
437              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
438              select.Instance.Text.Should().Be("2");
439              validatedValue.Should().Be("2");
440              input.Click();
441              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
442              comp.FindAll("div.mud-list-item")[0].Click();
443              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
444              select.Instance.Text.Should().Be("1");
445              validatedValue.Should().Be("1");
446          }
447          [Test]
448          public async Task MultiSelect_Initial_Values()
449          {
450              var comp = Context.RenderComponent<MultiSelectWithInitialValues>();
451              var input = comp.Find("input");
452              var value = input.Attributes.Where(a => a.LocalName == "value").First().Value;
453              value.Should().Be("FirstA, SecondA");
454          }
455          [Test]
456          public async Task MultiSelectCustomizedTextTest()
457          {
458              var comp = Context.RenderComponent<MultiSelectCustomizedTextTest>();
459              var input = comp.Find("input");
460              var value = input.Attributes.Where(a => a.LocalName == "value").First().Value;
461              value.Should().Be("Selected values: FirstA, SecondA");
462          }
463          [Test]
464          public async Task SelectClearableTest()
465          {
466              var comp = Context.RenderComponent<SelectClearableTest>();
467              var select = comp.FindComponent<MudSelect<string>>();
468              var input = comp.Find("div.mud-input-control");
469              comp.FindAll("button").Should().BeEmpty();
470              input.Click();
471              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
472              var items = comp.FindAll("div.mud-list-item").ToArray();
473              items[1].Click();
474              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
475              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
476              comp.Find("button").Should().NotBeNull();
477              comp.Find("button").Click();
478              comp.WaitForAssertion(() => select.Instance.Value.Should().BeNullOrEmpty());
479              comp.FindAll("button").Should().BeEmpty();
480              comp.Instance.ClearButtonClicked.Should().BeTrue();
481          }
482          [Test]
483          public void SelectReselectTest()
484          {
485              var comp = Context.RenderComponent<ReselectValueTest>();
486              var select = comp.FindComponent<MudSelect<string>>();
487              var menu = comp.Find("div.mud-popover");
488              var input = comp.Find("div.mud-input-control");
489              input.Click();
490              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
491              select.Instance.Value.Should().Be("Apple");
492              var items = comp.FindAll("div.mud-list-item").ToArray();
493              items[1].Click();
494              comp.WaitForAssertion(() => menu.ClassList.Should().NotContain("mud-popover-open"));
495              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Orange"));
496              comp.Instance.ChangeCount.Should().Be(1);
497              input.Click();
498              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
499              items = comp.FindAll("div.mud-list-item").ToArray();
500              items[1].Click();
501              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Orange"));
502              comp.Instance.ChangeCount.Should().Be(1);
503          }
504          #region DataAttribute validation
505          [Test]
506          public async Task TextField_Should_Validate_Data_Attribute_Fail()
507          {
508              var comp = Context.RenderComponent<SelectValidationDataAttrTest>();
509              var selectcomp = comp.FindComponent<MudSelect<string>>();
510              var select = selectcomp.Instance;
511              await comp.InvokeAsync(() => select.SelectOption("Quux"));
512              select.Value.Should().Be("Quux");
513              select.Text.Should().Be("Quux");
514              await comp.InvokeAsync(() => select.Validate());
515              select.ValidationErrors.Should().NotBeEmpty();
516              select.ValidationErrors.Should().HaveCount(1);
517              select.ValidationErrors[0].Should().Be("Should not be longer than 3");
518          }
519          [Test]
520          public async Task TextField_Should_Validate_Data_Attribute_Success()
521          {
522              var comp = Context.RenderComponent<SelectValidationDataAttrTest>();
523              var selectcomp = comp.FindComponent<MudSelect<string>>();
524              var select = selectcomp.Instance;
525              await comp.InvokeAsync(() => select.SelectOption("Qux"));
526              select.Value.Should().Be("Qux");
527              select.Text.Should().Be("Qux");
528              await comp.InvokeAsync(() => select.Validate());
529              select.ValidationErrors.Should().BeEmpty();
530          }
531          #endregion
532          [Test]
533          public async Task Select_Should_SetRequiredTrue()
534          {
535              var comp = Context.RenderComponent<SelectRequiredTest>();
536              var select = comp.FindComponent<MudSelect<string>>().Instance;
537              select.Required.Should().BeTrue();
538              await comp.InvokeAsync(() => select.Validate());
539              select.ValidationErrors.First().Should().Be("Required");
540          }
541          [Test]
542          public async Task Select_Should_HilightSelectedValue()
543          {
544              var comp = Context.RenderComponent<SelectTest1>();
545              var select = comp.FindComponent<MudSelect<string>>();
546              var input = comp.Find("div.mud-input-control");
547              comp.Find("div.mud-popover").ClassList.Should().Contain("select-popover-class");
548              select.Instance.Value.Should().BeNullOrEmpty();
549              comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open");
550              comp.Find("div.mud-input-control").Click();
551              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
552              comp.WaitForAssertion(() => comp.FindAll("div.mud-selected-item").Count.Should().Be(0));
553              comp.FindAll("div.mud-list-item")[1].Click();
554              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
555              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
556              comp.Find("div.mud-input-control").Click();
557              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
558              comp.WaitForAssertion(() => comp.FindAll("div.mud-selected-item").Count.Should().Be(1));
559              comp.FindAll("div.mud-list-item")[1].ToMarkup().Should().Contain("mud-selected-item");
560              await comp.InvokeAsync(() => select.Instance.CloseMenu());
561              select.SetParam(nameof(MudSelect<string>.Value), null);
562              await comp.InvokeAsync(() => select.Instance.OpenMenu());
563              comp.WaitForAssertion(() => comp.FindAll("div.mud-selected-item").Count.Should().Be(0));
564          }
565          [Test]
566          public void Select_Should_HilightInitiallySelectedValue()
567          {
568              var comp = Context.RenderComponent<SelectTest2>();
569              var select = comp.FindComponent<MudSelect<string>>();
570              comp.Find("div.mud-popover").ClassList.Should().Contain("select-popover-class");
571              select.Instance.Value.Should().Be("2");
572              comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open");
573              comp.Find("div.mud-input-control").Click();
574              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
575              comp.WaitForAssertion(()=>comp.FindAll("div.mud-selected-item").Count.Should().Be(1));
576              comp.FindAll("div.mud-list-item")[1].ToMarkup().Should().Contain("mud-selected-item");
577              comp.FindAll("div.mud-list-item")[0].Click();
578              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
579              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
580              comp.Find("div.mud-input-control").Click();
581              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
582              comp.WaitForAssertion(() => comp.FindAll("div.mud-selected-item").Count.Should().Be(1));
583              comp.FindAll("div.mud-list-item")[0].ToMarkup().Should().Contain("mud-selected-item");
584              comp.Find("div.mud-input-control").Click();
585              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
586          }
587          [Test]
588          public async Task Select_Should_AllowReloadingItems()
589          {
590              var comp = Context.RenderComponent<ReloadSelectItemsTest>();
591              var select = comp.FindComponent<MudSelect<string>>();
592              comp.Find("div.mud-input-control").Click();
593              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
594              comp.FindAll("div.mud-list-item")[0].Click();
595              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
596              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("American Samoa"));
597              comp.Find("div.mud-input-control").Click();
598              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
599              comp.FindAll("div.mud-list-item")[1].Click();
600              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
601              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Arizona"));
602              comp.Find("div.mud-input-control").Click();
603              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
604              comp.FindAll("div.mud-list-item")[2].Click();
605              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
606              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Arkansas"));
607              comp.Find(".reload").Click();
608              comp.Find("div.mud-input-control").Click();
609              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
610              comp.FindAll("div.mud-list-item")[0].Click();
611              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
612              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Alabama"));
613              comp.Find("div.mud-input-control").Click();
614              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
615              comp.FindAll("div.mud-list-item")[1].Click();
616              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
617              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("Alaska"));
618              comp.Find("div.mud-input-control").Click();
619              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
620              comp.FindAll("div.mud-list-item")[2].Click();
621              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
622              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("American Samoa"));
623          }
624          [Test]
625          public async Task SelectTest_ToggleOpenCloseMenuMethods()
626          {
627              var comp = Context.RenderComponent<SelectTest1>();
628              var select = comp.FindComponent<MudSelect<string>>();
629              await comp.InvokeAsync(() => select.Instance.ToggleMenu());
630              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
631              select.SetParam("Disabled", true);
632              await comp.InvokeAsync(() => select.Instance.ToggleMenu());
633              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
634              await comp.InvokeAsync(() => select.Instance.Add(null));
635              comp.WaitForAssertion(() => select.Instance._items.Count.Should().Be(4));
636              select.SetParam("Disabled", false);
637              await comp.InvokeAsync(() => select.Instance.ToggleMenu());
638              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
639              select.SetParam("Disabled", true);
640              await comp.InvokeAsync(() => select.Instance.ToggleMenu());
641              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
642              await comp.InvokeAsync(() => select.Instance.OpenMenu());
643              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
644          }
645          [Test]
646          public async Task SelectTest_KeyboardNavigation_SingleSelect()
647          {
648              var comp = Context.RenderComponent<SelectTest1>();
649              var select = comp.FindComponent<MudSelect<string>>();
650              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
651              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
652              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
653              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
654              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = " ", Type = "keydown", }));
655              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
656              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
657              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
658              comp.WaitForAssertion(() => select.Instance.Value.Should().Be(null));
659              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", AltKey = true, Type = "keydown", }));
660              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
661              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowUp", AltKey = true, Type = "keydown", }));
662              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
663              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
664              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
665              comp.WaitForAssertion(() => select.Instance.Value.Should().Be(null));
666              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "NumpadEnter", Type = "keydown", }));
667              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
668              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowUp", Type = "keydown", }));
669              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
670              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
671              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
672              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "End", Type = "keydown", }));
673              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("3"));
674              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowUp", Type = "keydown", }));
675              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
676              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Home", Type = "keydown", }));
677              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
678              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowUp", Type = "keydown", }));
679              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("1"));
680              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "End", Type = "keydown", }));
681              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
682              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("3"));
683              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "2", Type = "keydown", }));
684              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
685              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "2", Type = "keydown", }));
686              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("2"));
687              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().HaveCount(1));
688              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = " ", Type = "keydown", }));
689              comp.Render(); 
690              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
691          }
692          [Test]
693          public async Task SelectTest_KeyboardNavigation_MultiSelect()
694          {
695              var comp = Context.RenderComponent<MultiSelectTest3>();
696              var select = comp.FindComponent<MudSelect<string>>();
697              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = " ", Type = "keydown", }));
698              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
699              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "a", CtrlKey = true, Type = "keydown", }));
700              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("0 feline has been selected"));
701              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "A", CtrlKey = true, Type = "keydown", }));
702              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("7 felines have been selected"));
703              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
704              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
705              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("6 felines have been selected"));
706              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "A", CtrlKey = true, Type = "keydown", }));
707              comp.WaitForAssertion(() => select.Instance.Value.Should().Be("7 felines have been selected"));
708              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Escape", Type = "keydown", }));
709              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
710              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
711              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().Contain("mud-popover-open"));
712              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
713              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
714              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().Contain("Jaguar"));
715              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Home", Type = "keydown", }));
716              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "NumpadEnter", Type = "keydown", }));
717              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().NotContain("Jaguar"));
718              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
719              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
720              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().Contain("Leopard"));
721              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "End", Type = "keydown", }));
722              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
723              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().NotContain("Tiger"));
724              select.SetParam("Disabled", true);
725              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
726              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().NotContain("Tiger"));
727              select.SetParam("Disabled", false);
728              await comp.InvokeAsync(() => select.Instance.HandleKeyUp(new KeyboardEventArgs() { Key = "Enter", Type = "keyup", }));
729              comp.WaitForAssertion(() => select.Instance.SelectedValues.Should().NotContain("Tiger"));
730              await comp.InvokeAsync(() => select.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Tab", Type = "keydown", }));
731              await comp.InvokeAsync(() => select.Instance.OnKeyUp.InvokeAsync(new KeyboardEventArgs() { Key = "Tab" }));
732              comp.Render(); 
733              comp.WaitForAssertion(() => comp.Find("div.mud-popover").ClassList.Should().NotContain("mud-popover-open"));
734          }
735          [Test]
736          public async Task SelectTest_KeyboardNavigation_MultiSelect_Focus()
737          {
738              var comp = Context.RenderComponent<MultiSelectTest6>();
739              var select = comp.FindComponent<MudSelect<string>>();
740              var mudSelectElement = comp.Find(".mud-select");
741              comp.Find("div.mud-input-control").Click();
742              select.Instance._isOpen.Should().BeTrue();
743              var items = comp.FindAll("div.mud-list-item").ToArray();
744              items[0].Click();
745              items[2].Click();
746              mudSelectElement.FocusOut();
747              comp.WaitForAssertion(() => select.Instance.Text.Should().Be("Alaska, Alabama, American Samoa"));
748              Context.JSInterop.VerifyFocusAsyncInvoke();
749          }
750          [Test]
751          public async Task SelectTest_ItemlessSelect()
752          {
753              var comp = Context.RenderComponent<MudSelect<string>>();
754              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = " ", Type = "keydown", }));
755              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "ArrowDown", Type = "keydown", }));
756              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Home", Type = "keydown", }));
757              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "End", Type = "keydown", }));
758              await comp.InvokeAsync(() => comp.Instance.HandleKeyDown(new KeyboardEventArgs() { Key = "Enter", Type = "keydown", }));
759              comp.WaitForAssertion(() => comp.Instance.SelectedValues.Should().HaveCount(0));
760              comp.WaitForAssertion(() => comp.Instance.Value.Should().Be(null));
761          }
762          [Test]
763          public void MultiSelectWithCustomComparerTest()
764          {
765              var comp = Context.RenderComponent<MultiSelectWithCustomComparerTest>();
766              comp.Find("button").Click();
767              comp.Find("input").GetAttribute("value").Should().Be("Selected Cafe Latte, Selected Espresso");
768              comp.Find("div.mud-input-control").Click();
769              const string @unchecked =
770                  "M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z";
771              const string @checked =
772                  "M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z";
773              var icons = comp.FindAll("div.mud-list-item path").ToArray();
<span onclick='openModal()' class='match'>774              icons[1].Attributes["d"].Value.Should().Be(@unchecked);
775              icons[3].Attributes["d"].Value.Should().Be(@checked);
</span>776              icons[5].Attributes["d"].Value.Should().Be(@checked);
777              icons[7].Attributes["d"].Value.Should().Be(@unchecked);
778          }
779          [Test]
780          public void Select_Item_Collection_Should_Match_Number_Of_Select_Options()
781          {
782              var comp = Context.RenderComponent<SelectTest1>();
783              var sut = comp.FindComponent<MudSelect<string>>();
784              var input = comp.Find("div.mud-input-control");
785              input.Click();
786              comp.WaitForAssertion(() => comp.FindAll("div.mud-list-item").Count.Should().BeGreaterThan(0));
787              sut.Instance.Items.Should().HaveCountGreaterOrEqualTo(4);
788          }
789          [Test]
790          public async Task Select_ValueChangeEventCountTest()
791          {
792              var comp = Context.RenderComponent<SelectEventCountTest>(x =>
793              {
794                  x.Add(c => c.MultiSelection, false);
795              });
796              var select = comp.FindComponent<MudSelect<string>>();
797              var input = comp.Find("div.mud-input-control");
798              comp.Instance.ValueChangeCount.Should().Be(0);
799              comp.Instance.ValuesChangeCount.Should().Be(0);
800              await comp.InvokeAsync(() => select.SetParam("Value", "1"));
801              await comp.InvokeAsync(() => select.Instance.ForceUpdate());
802              comp.WaitForAssertion(() => comp.Instance.ValueChangeCount.Should().Be(1));
803              comp.Instance.ValuesChangeCount.Should().Be(1);
804              select.Instance.Value.Should().Be("1");
805              await comp.InvokeAsync(() => select.SetParam("Value", "2"));
806              comp.WaitForAssertion(() => comp.Instance.ValueChangeCount.Should().Be(1));
807              comp.Instance.ValuesChangeCount.Should().Be(1);
808              select.Instance.Value.Should().Be("2");
809          }
810          [Test]
811          public async Task MultiSelectWithRequiredValue()
812          {
813              var comp = Context.RenderComponent<MultiSelectTestRequiredValue>();
814              var select = comp.FindComponent<MudSelect<string>>().Instance;
815              select.Required.Should().BeTrue();
816              await comp.InvokeAsync(() => select.Validate());
817              select.ValidationErrors.First().Should().Be("Required");
818              var selectWithT = comp.FindComponent<MudSelect<MultiSelectTestRequiredValue.TestClass>>().Instance;
819              selectWithT.Required.Should().BeTrue();
820              await comp.InvokeAsync(() => selectWithT.Validate());
821              selectWithT.ValidationErrors.First().Should().Be("Required");
822              var inputs = comp.FindAll("div.mud-input-control");
823              inputs[0].Click();
824              var items = comp.FindAll("div.mud-list-item").ToArray();
825              items[1].Click();
826              await comp.InvokeAsync(() => select.Validate());
827              select.ValidationErrors.Count.Should().Be(0);
828              inputs[1].Click();
829              comp.WaitForState(() => comp.FindAll("div.mud-list-item").Count == 5);
830              items = comp.FindAll("div.mud-list-item").ToArray();
831              items[3].Click();
832              await comp.InvokeAsync(() => selectWithT.Validate());
833              selectWithT.ValidationErrors.Count.Should().Be(0);
834          }
835          [Test]
836          public async Task MultiSelectAttributesOrder()
837          {
838              var comp = Context.RenderComponent<MultiSelectTest5>();
839              var select = comp.FindComponent<MudSelect<string>>().Instance;
840              select.SelectedValues.Count().Should().Be(2);
841              select.Text.Should().Be("Programista, test");
842              await comp.InvokeAsync(() =>
843              {
844                  select.SelectedValues = new List<string> { "test" };
845              });
846              select.SelectedValues.Count().Should().Be(1);
847              select.Text.Should().Be("test");
848          }
849      }
850  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-SelectTests.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-SelectTests.cs</div>
                </div>
                <div class="column column_space"><pre><code>774              icons[1].Attributes["d"].Value.Should().Be(@unchecked);
775              icons[3].Attributes["d"].Value.Should().Be(@checked);
</pre></code></div>
                <div class="column column_space"><pre><code>774              icons[1].Attributes["d"].Value.Should().Be(@unchecked);
775              icons[3].Attributes["d"].Value.Should().Be(@checked);
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    