
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 22.317596566523605%, Tokens: 11</h2>
        <div class="column">
            <h3>runner-MDEwOlJlcG9zaXRvcnkxODQyODY4NzU=-flat-SequenceDefinition.cs</h3>
            <pre><code>1  using System;
2  using GitHub.DistributedTask.ObjectTemplating.Tokens;
3  namespace GitHub.DistributedTask.ObjectTemplating.Schema
4  {
5      internal sealed class SequenceDefinition : Definition
6      {
7          internal SequenceDefinition()
8          {
9          }
10          internal SequenceDefinition(MappingToken definition)
11              : base(definition)
12          {
13              foreach (var definitionPair in definition)
14              {
15                  var definitionKey = definitionPair.Key.AssertString($"{TemplateConstants.Definition} key");
16                  switch (definitionKey.Value)
17                  {
18                      case TemplateConstants.Sequence:
19                          var mapping = definitionPair.Value.AssertMapping($"{TemplateConstants.Definition} {TemplateConstants.Sequence}");
20                          foreach (var mappingPair in mapping)
21                          {
22                              var mappingKey = mappingPair.Key.AssertString($"{TemplateConstants.Definition} {TemplateConstants.Sequence} key");
23                              switch (mappingKey.Value)
24                              {
25                                  case TemplateConstants.ItemType:
26                                      var itemType = mappingPair.Value.AssertString($"{TemplateConstants.Definition} {TemplateConstants.Sequence} {TemplateConstants.ItemType}");
27                                      ItemType = itemType.Value;
28                                      break;
29                                  default:
30                                      mappingKey.AssertUnexpectedValue($"{TemplateConstants.Definition} {TemplateConstants.Sequence} key");
31                                      break;
32                              }
33                          }
<span onclick='openModal()' class='match'>34                          break;
35                      default:
36                          definitionKey.AssertUnexpectedValue($"{TemplateConstants.Definition} key");
37                          break;
38                  }
39              }
40          }
41          internal override DefinitionType DefinitionType => DefinitionType.Sequence;
42          internal String ItemType { get; set; }
</span>43          internal override void Validate(
44              TemplateSchema schema,
45              String name)
46          {
47              if (String.IsNullOrEmpty(ItemType))
48              {
49                  throw new ArgumentException($"'{name}' does not define '{TemplateConstants.ItemType}'");
50              }
51              schema.GetDefinition(ItemType);
52          }
53      }
54  }
</code></pre>
        </div>
        <div class="column">
            <h3>runner-MDEwOlJlcG9zaXRvcnkxODQyODY4NzU=-flat-OneOfDefinition.cs</h3>
            <pre><code>1  using System;
2  using System.Collections.Generic;
3  using GitHub.DistributedTask.ObjectTemplating.Tokens;
4  namespace GitHub.DistributedTask.ObjectTemplating.Schema
5  {
6      internal sealed class OneOfDefinition : Definition
7      {
8          internal OneOfDefinition()
9          {
10          }
11          internal OneOfDefinition(MappingToken definition)
12              : base(definition)
13          {
14              foreach (var definitionPair in definition)
15              {
16                  var definitionKey = definitionPair.Key.AssertString($"{TemplateConstants.Definition} key");
17                  switch (definitionKey.Value)
18                  {
19                      case TemplateConstants.OneOf:
20                          var oneOf = definitionPair.Value.AssertSequence(TemplateConstants.OneOf);
21                          foreach (var oneOfItem in oneOf)
22                          {
23                              var reference = oneOfItem.AssertString(TemplateConstants.OneOf);
24                              OneOf.Add(reference.Value);
25                          }
<span onclick='openModal()' class='match'>26                          break;
27                      default:
28                          definitionKey.AssertUnexpectedValue($"{TemplateConstants.Definition} key");
29                          break;
30                  }
31              }
32          }
33          internal override DefinitionType DefinitionType => DefinitionType.Mapping;
34          internal List<String> OneOf { get; } = new List<String>();
</span>35          internal override void Validate(
36              TemplateSchema schema,
37              String name)
38          {
39              if (OneOf.Count == 0)
40              {
41                  throw new ArgumentException($"'{name}' does not contain any references");
42              }
43              var foundLooseKeyType = false;
44              var mappingDefinitions = default(List<MappingDefinition>);
45              var sequenceDefinition = default(SequenceDefinition);
46              var nullDefinition = default(NullDefinition);
47              var booleanDefinition = default(BooleanDefinition);
48              var numberDefinition = default(NumberDefinition);
49              var stringDefinitions = default(List<StringDefinition>);
50              foreach (var nestedType in OneOf)
51              {
52                  var nestedDefinition = schema.GetDefinition(nestedType);
53                  if (nestedDefinition.ReaderContext.Length > 0)
54                  {
55                      throw new ArgumentException($"'{name}' is a one-of definition and references another definition that defines context. This is currently not supported.");
56                  }
57                  if (nestedDefinition is MappingDefinition mappingDefinition)
58                  {
59                      if (mappingDefinitions == null)
60                      {
61                          mappingDefinitions = new List<MappingDefinition>();
62                      }
63                      mappingDefinitions.Add(mappingDefinition);
64                      if (!String.IsNullOrEmpty(mappingDefinition.LooseKeyType))
65                      {
66                          foundLooseKeyType = true;
67                      }
68                  }
69                  else if (nestedDefinition is SequenceDefinition s)
70                  {
71                      if (sequenceDefinition != null)
72                      {
73                          throw new ArgumentException($"'{name}' refers to more than one '{TemplateConstants.Sequence}'");
74                      }
75                      sequenceDefinition = s;
76                  }
77                  else if (nestedDefinition is NullDefinition n)
78                  {
79                      if (nullDefinition != null)
80                      {
81                          throw new ArgumentException($"'{name}' refers to more than one '{TemplateConstants.Null}'");
82                      }
83                      nullDefinition = n;
84                  }
85                  else if (nestedDefinition is BooleanDefinition b)
86                  {
87                      if (booleanDefinition != null)
88                      {
89                          throw new ArgumentException($"'{name}' refers to more than one '{TemplateConstants.Boolean}'");
90                      }
91                      booleanDefinition = b;
92                  }
93                  else if (nestedDefinition is NumberDefinition num)
94                  {
95                      if (numberDefinition != null)
96                      {
97                          throw new ArgumentException($"'{name}' refers to more than one '{TemplateConstants.Number}'");
98                      }
99                      numberDefinition = num;
100                  }
101                  else if (nestedDefinition is StringDefinition stringDefinition)
102                  {
103                      if (stringDefinitions == null)
104                      {
105                          stringDefinitions = new List<StringDefinition>();
106                      }
107                      else if ((stringDefinitions.Count == 1 && String.IsNullOrEmpty(stringDefinitions[0].Constant))
108                          || String.IsNullOrEmpty(stringDefinition.Constant))
109                      {
110                          throw new ArgumentException($"'{name}' refers to more than one '{TemplateConstants.Scalar}', but some do not set '{TemplateConstants.Constant}'");
111                      }
112                      stringDefinitions.Add(stringDefinition);
113                  }
114                  else
115                  {
116                      throw new ArgumentException($"'{name}' refers to a '{nestedDefinition.DefinitionType}' definition");
117                  }
118              }
119              if (mappingDefinitions?.Count > 1)
120              {
121                  if (foundLooseKeyType)
122                  {
123                      throw new ArgumentException($"'{name}' refers to two mappings that both set '{TemplateConstants.LooseKeyType}'");
124                  }
125                  var seenProperties = new Dictionary<String, PropertyValue>(StringComparer.Ordinal);
126                  foreach (var mappingDefinition in mappingDefinitions)
127                  {
128                      foreach (var newProperty in GetMergedProperties(schema, mappingDefinition))
129                      {
130                          if (seenProperties.TryGetValue(newProperty.Key, out PropertyValue existingProperty))
131                          {
132                              if (String.Equals(existingProperty.Type, newProperty.Value.Type, StringComparison.Ordinal))
133                              {
134                                  continue;
135                              }
136                              throw new ArgumentException($"'{name}' contains two mappings with the same property, but each refers to a different type. All matching properties must refer to the same type.");
137                          }
138                          else
139                          {
140                              seenProperties.Add(newProperty.Key, newProperty.Value);
141                          }
142                      }
143                  }
144              }
145          }
146          private static IEnumerable<KeyValuePair<String, PropertyValue>> GetMergedProperties(
147              TemplateSchema schema,
148              MappingDefinition mapping)
149          {
150              foreach (var property in mapping.Properties)
151              {
152                  yield return property;
153              }
154              if (!String.IsNullOrEmpty(mapping.Inherits))
155              {
156                  var inherited = schema.GetDefinition(mapping.Inherits) as MappingDefinition;
157                  if (!String.IsNullOrEmpty(inherited.Inherits))
158                  {
159                      throw new NotSupportedException("Multiple levels of inheritance is not supported");
160                  }
161                  foreach (var property in inherited.Properties)
162                  {
163                      if (!mapping.Properties.ContainsKey(property.Key))
164                      {
165                          yield return property;
166                      }
167                  }
168              }
169          }
170      }
171  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from runner-MDEwOlJlcG9zaXRvcnkxODQyODY4NzU=-flat-SequenceDefinition.cs</div>
                <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from runner-MDEwOlJlcG9zaXRvcnkxODQyODY4NzU=-flat-OneOfDefinition.cs</div>
                <div class="column column_space"><pre><code>34                          break;
35                      default:
36                          definitionKey.AssertUnexpectedValue($"{TemplateConstants.Definition} key");
37                          break;
38                  }
39              }
40          }
41          internal override DefinitionType DefinitionType => DefinitionType.Sequence;
42          internal String ItemType { get; set; }
</pre></code></div>
                <div class="column column_space"><pre><code>26                          break;
27                      default:
28                          definitionKey.AssertUnexpectedValue($"{TemplateConstants.Definition} key");
29                          break;
30                  }
31              }
32          }
33          internal override DefinitionType DefinitionType => DefinitionType.Mapping;
34          internal List<String> OneOf { get; } = new List<String>();
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    