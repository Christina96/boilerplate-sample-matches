
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Tokens: 12, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-MudDialogInstance.razor.cs</h3>
            <pre><code>1  using System;
2  using System.Threading.Tasks;
3  using Microsoft.AspNetCore.Components;
4  using Microsoft.AspNetCore.Components.Web;
5  using MudBlazor.Extensions;
6  using MudBlazor.Services;
7  using MudBlazor.Utilities;
8  namespace MudBlazor
9  {
10      public partial class MudDialogInstance : MudComponentBase, IDisposable
11      {
12          private DialogOptions _options = new();
13          private string _elementId = "dialog_" + Guid.NewGuid().ToString().Substring(0, 8);
14          private IKeyInterceptor _keyInterceptor;
15          [Inject] private IKeyInterceptorFactory _keyInterceptorFactory { get; set; }
16          [CascadingParameter(Name = "RightToLeft")] public bool RightToLeft { get; set; }
17          [CascadingParameter] private MudDialogProvider Parent { get; set; }
18          [CascadingParameter] private DialogOptions GlobalDialogOptions { get; set; } = new DialogOptions();
19          [Parameter]
20          [Category(CategoryTypes.Dialog.Misc)]  
21          public DialogOptions Options
22          {
23              get
24              {
25                  if (_options == null)
26                      _options = new DialogOptions();
27                  return _options;
28              }
29              set => _options = value;
30          }
31          [Parameter]
32          [Category(CategoryTypes.Dialog.Behavior)]
33          public string Title { get; set; }
34          [Parameter]
35          [Category(CategoryTypes.Dialog.Behavior)]
36          public RenderFragment TitleContent { get; set; }
37          [Parameter]
38          [Category(CategoryTypes.Dialog.Behavior)]
39          public RenderFragment Content { get; set; }
40          [Parameter]
41          [Category(CategoryTypes.Dialog.Behavior)]
42          public Guid Id { get; set; }
43          [Parameter]
44          [Category(CategoryTypes.Dialog.Appearance)]
45          public string CloseIcon { get; set; } = Icons.Material.Filled.Close;
46          private string Position { get; set; }
47          private string DialogMaxWidth { get; set; }
48          private bool DisableBackdropClick { get; set; }
49          private bool CloseOnEscapeKey { get; set; }
50          private bool NoHeader { get; set; }
51          private bool CloseButton { get; set; }
52          private bool FullScreen { get; set; }
53          private bool FullWidth { get; set; }
54          protected override void OnInitialized()
55          {
56              ConfigureInstance();
57          }
58          protected override async Task OnAfterRenderAsync(bool firstRender)
59          {
60              if (firstRender)
61              {
62                  if (CloseOnEscapeKey)
63                  {
64                      _keyInterceptor = _keyInterceptorFactory.Create();
65                      await _keyInterceptor.Connect(_elementId, new KeyInterceptorOptions()
66                      {
67                          TargetClass = "mud-dialog",
68                          Keys = {
69                              new KeyOptions { Key="Escape", SubscribeDown = true },
70                          },
71                      });
72                      _keyInterceptor.KeyDown += HandleKeyDown;
73                  }
74              }
75              await base.OnAfterRenderAsync(firstRender);
76          }
77          internal void HandleKeyDown(KeyboardEventArgs args)
78          {
79               switch (args.Key)
80              {
81                  case "Escape":
82                      if (CloseOnEscapeKey)
83                      {
84                          Cancel();
85                      }
86                      break;
87              }
88          }
89          public void SetOptions(DialogOptions options)
90          {
91              Options = options;
92              ConfigureInstance();
93              StateHasChanged();
94          }
95          public void SetTitle(string title)
96          {
97              Title = title;
98              StateHasChanged();
99          }
100          public void Close()
101          {
102              Close(DialogResult.Ok<object>(null));
103          }
104          public void Close(DialogResult dialogResult)
105          {
106              Parent.DismissInstance(Id, dialogResult);
107          }
108          public void Close<T>(T returnValue)
109          {
110              var dialogResult = DialogResult.Ok<T>(returnValue);
111              Parent.DismissInstance(Id, dialogResult);
112          }
113          public void Cancel()
114          {
115              Close(DialogResult.Cancel());
116          }
117          private void ConfigureInstance()
118          {
119              Position = SetPosition();
120              DialogMaxWidth = SetMaxWidth();
121              NoHeader = SetHideHeader();
122              CloseButton = SetCloseButton();
123              FullWidth = SetFullWidth();
124              FullScreen = SetFulScreen();
125              DisableBackdropClick = SetDisableBackdropClick();
126              CloseOnEscapeKey = SetCloseOnEscapeKey();
127              Class = Classname;
128              BackgroundClassname = new CssBuilder("mud-overlay-dialog").AddClass(Options.ClassBackground).Build();
129          }
130          private string SetPosition()
131          {
132              DialogPosition position;
133              if (Options.Position.HasValue)
134              {
135                  position = Options.Position.Value;
136              }
137              else if (GlobalDialogOptions.Position.HasValue)
138              {
139                  position = GlobalDialogOptions.Position.Value;
140              }
141              else
142              {
143                  position = DialogPosition.Center;
144              }
145              return $"mud-dialog-{position.ToDescriptionString()}";
146          }
147          private string SetMaxWidth()
148          {
149              MaxWidth maxWidth;
150              if (Options.MaxWidth.HasValue)
151              {
152                  maxWidth = Options.MaxWidth.Value;
153              }
154              else if (GlobalDialogOptions.MaxWidth.HasValue)
155              {
156                  maxWidth = GlobalDialogOptions.MaxWidth.Value;
157              }
158              else
159              {
<span onclick='openModal()' class='match'>160                  maxWidth = MaxWidth.Small;
161              }
162              return $"mud-dialog-width-{maxWidth.ToDescriptionString()}";
163          }
164          private bool SetFullWidth()
</span>165          {
166              if (Options.FullWidth.HasValue)
167                  return Options.FullWidth.Value;
168              if (GlobalDialogOptions.FullWidth.HasValue)
169                  return GlobalDialogOptions.FullWidth.Value;
170              return false;
171          }
172          private bool SetFulScreen()
173          {
174              if (Options.FullScreen.HasValue)
175                  return Options.FullScreen.Value;
176              if (GlobalDialogOptions.FullScreen.HasValue)
177                  return GlobalDialogOptions.FullScreen.Value;
178              return false;
179          }
180          protected string Classname =>
181              new CssBuilder("mud-dialog")
182                  .AddClass(DialogMaxWidth, !FullScreen)
183                  .AddClass("mud-dialog-width-full", FullWidth && !FullScreen)
184                  .AddClass("mud-dialog-fullscreen", FullScreen)
185                  .AddClass("mud-dialog-rtl", RightToLeft)
186                  .AddClass(_dialog?.Class)
187              .Build();
188          protected string BackgroundClassname { get; set; } = "mud-overlay-dialog";
189          private bool SetHideHeader()
190          {
191              if (Options.NoHeader.HasValue)
192                  return Options.NoHeader.Value;
193              if (GlobalDialogOptions.NoHeader.HasValue)
194                  return GlobalDialogOptions.NoHeader.Value;
195              return false;
196          }
197          private bool SetCloseButton()
198          {
199              if (Options.CloseButton.HasValue)
200                  return Options.CloseButton.Value;
201              if (GlobalDialogOptions.CloseButton.HasValue)
202                  return GlobalDialogOptions.CloseButton.Value;
203              return false;
204          }
205          private bool SetDisableBackdropClick()
206          {
207              if (Options.DisableBackdropClick.HasValue)
208                  return Options.DisableBackdropClick.Value;
209              if (GlobalDialogOptions.DisableBackdropClick.HasValue)
210                  return GlobalDialogOptions.DisableBackdropClick.Value;
211              return false;
212          }
213          private bool SetCloseOnEscapeKey()
214          {
215              if (Options.CloseOnEscapeKey.HasValue)
216                  return Options.CloseOnEscapeKey.Value;
217              if (GlobalDialogOptions.CloseOnEscapeKey.HasValue)
218                  return GlobalDialogOptions.CloseOnEscapeKey.Value;
219              return false;
220          }
221          private async Task HandleBackgroundClickAsync(MouseEventArgs args)
222          {
223              if (DisableBackdropClick)
224                  return;
225              if (_dialog is null || !_dialog.OnBackdropClick.HasDelegate)
226              {
227                  Cancel();
228                  return;
229              }
230              await _dialog.OnBackdropClick.InvokeAsync(args);
231          }
232          private MudDialog _dialog;
233          private bool _disposedValue;
234          public void Register(MudDialog dialog)
235          {
236              if (dialog == null)
237                  return;
238              _dialog = dialog;
239              Class = dialog.Class;
240              Style = dialog.Style;
241              TitleContent = dialog.TitleContent;
242              StateHasChanged();
243          }
244          [Obsolete($"Use {nameof(StateHasChanged)}. This method will be removed in v7.")]
245          public void ForceRender() => StateHasChanged();
246          public new void StateHasChanged() => base.StateHasChanged();
247          public void CancelAll()
248          {
249              Parent?.DismissAll();
250          }
251          protected virtual void Dispose(bool disposing)
252          {
253              if (!_disposedValue)
254              {
255                  if (disposing)
256                  {
257                      if (_keyInterceptor != null)
258                      {
259                          _keyInterceptor.KeyDown -= HandleKeyDown;
260                          _keyInterceptor.Dispose();
261                      }
262                  }
263                  _disposedValue = true;
264              }
265          }
266          public void Dispose()
267          {
268              Dispose(disposing: true);
269              GC.SuppressFinalize(this);
270          }
271      }
272  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-MudDialogInstance.razor.cs</h3>
            <pre><code>1  using System;
2  using System.Threading.Tasks;
3  using Microsoft.AspNetCore.Components;
4  using Microsoft.AspNetCore.Components.Web;
5  using MudBlazor.Extensions;
6  using MudBlazor.Services;
7  using MudBlazor.Utilities;
8  namespace MudBlazor
9  {
10      public partial class MudDialogInstance : MudComponentBase, IDisposable
11      {
12          private DialogOptions _options = new();
13          private string _elementId = "dialog_" + Guid.NewGuid().ToString().Substring(0, 8);
14          private IKeyInterceptor _keyInterceptor;
15          [Inject] private IKeyInterceptorFactory _keyInterceptorFactory { get; set; }
16          [CascadingParameter(Name = "RightToLeft")] public bool RightToLeft { get; set; }
17          [CascadingParameter] private MudDialogProvider Parent { get; set; }
18          [CascadingParameter] private DialogOptions GlobalDialogOptions { get; set; } = new DialogOptions();
19          [Parameter]
20          [Category(CategoryTypes.Dialog.Misc)]  
21          public DialogOptions Options
22          {
23              get
24              {
25                  if (_options == null)
26                      _options = new DialogOptions();
27                  return _options;
28              }
29              set => _options = value;
30          }
31          [Parameter]
32          [Category(CategoryTypes.Dialog.Behavior)]
33          public string Title { get; set; }
34          [Parameter]
35          [Category(CategoryTypes.Dialog.Behavior)]
36          public RenderFragment TitleContent { get; set; }
37          [Parameter]
38          [Category(CategoryTypes.Dialog.Behavior)]
39          public RenderFragment Content { get; set; }
40          [Parameter]
41          [Category(CategoryTypes.Dialog.Behavior)]
42          public Guid Id { get; set; }
43          [Parameter]
44          [Category(CategoryTypes.Dialog.Appearance)]
45          public string CloseIcon { get; set; } = Icons.Material.Filled.Close;
46          private string Position { get; set; }
47          private string DialogMaxWidth { get; set; }
48          private bool DisableBackdropClick { get; set; }
49          private bool CloseOnEscapeKey { get; set; }
50          private bool NoHeader { get; set; }
51          private bool CloseButton { get; set; }
52          private bool FullScreen { get; set; }
53          private bool FullWidth { get; set; }
54          protected override void OnInitialized()
55          {
56              ConfigureInstance();
57          }
58          protected override async Task OnAfterRenderAsync(bool firstRender)
59          {
60              if (firstRender)
61              {
62                  if (CloseOnEscapeKey)
63                  {
64                      _keyInterceptor = _keyInterceptorFactory.Create();
65                      await _keyInterceptor.Connect(_elementId, new KeyInterceptorOptions()
66                      {
67                          TargetClass = "mud-dialog",
68                          Keys = {
69                              new KeyOptions { Key="Escape", SubscribeDown = true },
70                          },
71                      });
72                      _keyInterceptor.KeyDown += HandleKeyDown;
73                  }
74              }
75              await base.OnAfterRenderAsync(firstRender);
76          }
77          internal void HandleKeyDown(KeyboardEventArgs args)
78          {
79               switch (args.Key)
80              {
81                  case "Escape":
82                      if (CloseOnEscapeKey)
83                      {
84                          Cancel();
85                      }
86                      break;
87              }
88          }
89          public void SetOptions(DialogOptions options)
90          {
91              Options = options;
92              ConfigureInstance();
93              StateHasChanged();
94          }
95          public void SetTitle(string title)
96          {
97              Title = title;
98              StateHasChanged();
99          }
100          public void Close()
101          {
102              Close(DialogResult.Ok<object>(null));
103          }
104          public void Close(DialogResult dialogResult)
105          {
106              Parent.DismissInstance(Id, dialogResult);
107          }
108          public void Close<T>(T returnValue)
109          {
110              var dialogResult = DialogResult.Ok<T>(returnValue);
111              Parent.DismissInstance(Id, dialogResult);
112          }
113          public void Cancel()
114          {
115              Close(DialogResult.Cancel());
116          }
117          private void ConfigureInstance()
118          {
119              Position = SetPosition();
120              DialogMaxWidth = SetMaxWidth();
121              NoHeader = SetHideHeader();
122              CloseButton = SetCloseButton();
123              FullWidth = SetFullWidth();
124              FullScreen = SetFulScreen();
125              DisableBackdropClick = SetDisableBackdropClick();
126              CloseOnEscapeKey = SetCloseOnEscapeKey();
127              Class = Classname;
128              BackgroundClassname = new CssBuilder("mud-overlay-dialog").AddClass(Options.ClassBackground).Build();
129          }
130          private string SetPosition()
131          {
132              DialogPosition position;
133              if (Options.Position.HasValue)
134              {
135                  position = Options.Position.Value;
136              }
137              else if (GlobalDialogOptions.Position.HasValue)
138              {
139                  position = GlobalDialogOptions.Position.Value;
140              }
141              else
142              {
143                  position = DialogPosition.Center;
144              }
145              return $"mud-dialog-{position.ToDescriptionString()}";
146          }
147          private string SetMaxWidth()
148          {
149              MaxWidth maxWidth;
150              if (Options.MaxWidth.HasValue)
151              {
152                  maxWidth = Options.MaxWidth.Value;
153              }
154              else if (GlobalDialogOptions.MaxWidth.HasValue)
155              {
156                  maxWidth = GlobalDialogOptions.MaxWidth.Value;
157              }
158              else
159              {
<span onclick='openModal()' class='match'>160                  maxWidth = MaxWidth.Small;
161              }
162              return $"mud-dialog-width-{maxWidth.ToDescriptionString()}";
163          }
164          private bool SetFullWidth()
</span>165          {
166              if (Options.FullWidth.HasValue)
167                  return Options.FullWidth.Value;
168              if (GlobalDialogOptions.FullWidth.HasValue)
169                  return GlobalDialogOptions.FullWidth.Value;
170              return false;
171          }
172          private bool SetFulScreen()
173          {
174              if (Options.FullScreen.HasValue)
175                  return Options.FullScreen.Value;
176              if (GlobalDialogOptions.FullScreen.HasValue)
177                  return GlobalDialogOptions.FullScreen.Value;
178              return false;
179          }
180          protected string Classname =>
181              new CssBuilder("mud-dialog")
182                  .AddClass(DialogMaxWidth, !FullScreen)
183                  .AddClass("mud-dialog-width-full", FullWidth && !FullScreen)
184                  .AddClass("mud-dialog-fullscreen", FullScreen)
185                  .AddClass("mud-dialog-rtl", RightToLeft)
186                  .AddClass(_dialog?.Class)
187              .Build();
188          protected string BackgroundClassname { get; set; } = "mud-overlay-dialog";
189          private bool SetHideHeader()
190          {
191              if (Options.NoHeader.HasValue)
192                  return Options.NoHeader.Value;
193              if (GlobalDialogOptions.NoHeader.HasValue)
194                  return GlobalDialogOptions.NoHeader.Value;
195              return false;
196          }
197          private bool SetCloseButton()
198          {
199              if (Options.CloseButton.HasValue)
200                  return Options.CloseButton.Value;
201              if (GlobalDialogOptions.CloseButton.HasValue)
202                  return GlobalDialogOptions.CloseButton.Value;
203              return false;
204          }
205          private bool SetDisableBackdropClick()
206          {
207              if (Options.DisableBackdropClick.HasValue)
208                  return Options.DisableBackdropClick.Value;
209              if (GlobalDialogOptions.DisableBackdropClick.HasValue)
210                  return GlobalDialogOptions.DisableBackdropClick.Value;
211              return false;
212          }
213          private bool SetCloseOnEscapeKey()
214          {
215              if (Options.CloseOnEscapeKey.HasValue)
216                  return Options.CloseOnEscapeKey.Value;
217              if (GlobalDialogOptions.CloseOnEscapeKey.HasValue)
218                  return GlobalDialogOptions.CloseOnEscapeKey.Value;
219              return false;
220          }
221          private async Task HandleBackgroundClickAsync(MouseEventArgs args)
222          {
223              if (DisableBackdropClick)
224                  return;
225              if (_dialog is null || !_dialog.OnBackdropClick.HasDelegate)
226              {
227                  Cancel();
228                  return;
229              }
230              await _dialog.OnBackdropClick.InvokeAsync(args);
231          }
232          private MudDialog _dialog;
233          private bool _disposedValue;
234          public void Register(MudDialog dialog)
235          {
236              if (dialog == null)
237                  return;
238              _dialog = dialog;
239              Class = dialog.Class;
240              Style = dialog.Style;
241              TitleContent = dialog.TitleContent;
242              StateHasChanged();
243          }
244          [Obsolete($"Use {nameof(StateHasChanged)}. This method will be removed in v7.")]
245          public void ForceRender() => StateHasChanged();
246          public new void StateHasChanged() => base.StateHasChanged();
247          public void CancelAll()
248          {
249              Parent?.DismissAll();
250          }
251          protected virtual void Dispose(bool disposing)
252          {
253              if (!_disposedValue)
254              {
255                  if (disposing)
256                  {
257                      if (_keyInterceptor != null)
258                      {
259                          _keyInterceptor.KeyDown -= HandleKeyDown;
260                          _keyInterceptor.Dispose();
261                      }
262                  }
263                  _disposedValue = true;
264              }
265          }
266          public void Dispose()
267          {
268              Dispose(disposing: true);
269              GC.SuppressFinalize(this);
270          }
271      }
272  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-MudDialogInstance.razor.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-MudDialogInstance.razor.cs</div>
                </div>
                <div class="column column_space"><pre><code>160                  maxWidth = MaxWidth.Small;
161              }
162              return $"mud-dialog-width-{maxWidth.ToDescriptionString()}";
163          }
164          private bool SetFullWidth()
</pre></code></div>
                <div class="column column_space"><pre><code>160                  maxWidth = MaxWidth.Small;
161              }
162              return $"mud-dialog-width-{maxWidth.ToDescriptionString()}";
163          }
164          private bool SetFullWidth()
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    