
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 20.168067226890756%, Tokens: 12, <button onclick='openModal()' class='match'></button></h2>
        <div class="column">
            <h3>runner-MDEwOlJlcG9zaXRvcnkxODQyODY4NzU=-flat-JobRunnerL0.cs</h3>
            <pre><code>1  using GitHub.DistributedTask.WebApi;
2  using GitHub.Runner.Worker;
3  using Moq;
4  using System;
5  using System.Collections.Generic;
6  using System.Runtime.CompilerServices;
7  using System.Threading.Tasks;
8  using Xunit;
9  using System.Threading;
10  using Pipelines = GitHub.DistributedTask.Pipelines;
11  namespace GitHub.Runner.Common.Tests.Worker
12  {
13      public sealed class JobRunnerL0
14      {
15          private IExecutionContext _jobEc;
16          private JobRunner _jobRunner;
17          private List<IStep> _initResult = new();
18          private CancellationTokenSource _tokenSource;
19          private Mock<IJobServer> _jobServer;
20          private Mock<IRunServer> _runServer;
21          private Mock<IJobServerQueue> _jobServerQueue;
22          private Mock<IConfigurationStore> _config;
23          private Mock<IExtensionManager> _extensions;
24          private Mock<IStepsRunner> _stepRunner;
25          private Mock<IJobExtension> _jobExtension;
26          private Mock<IPagingLogger> _logger;
27          private Mock<ITempDirectoryManager> _temp;
28          private Mock<IDiagnosticLogManager> _diagnosticLogManager;
<span onclick='openModal()' class='match'>29          private TestHostContext CreateTestContext([CallerMemberName] String testName = "")
30          {
31              var hc = new TestHostContext(this, testName);
32              _jobEc = new Runner.Worker.ExecutionContext();
33              _config = new Mock<IConfigurationStore>();
34              _extensions = new Mock<IExtensionManager>();
35              _jobExtension = new Mock<IJobExtension>();
36              _jobServer = new Mock<IJobServer>();
37              _runServer = new Mock<IRunServer>();
38              _jobServerQueue = new Mock<IJobServerQueue>();
39              _stepRunner = new Mock<IStepsRunner>();
40              _logger = new Mock<IPagingLogger>();
41              _temp = new Mock<ITempDirectoryManager>();
42              _diagnosticLogManager = new Mock<IDiagnosticLogManager>();
43              if (_tokenSource != null)
44              {
45                  _tokenSource.Dispose();
46                  _tokenSource = null;
47              }
48              _tokenSource = new CancellationTokenSource();
49              _jobRunner = new JobRunner();
50              _jobRunner.Initialize(hc);
51              _initResult.Clear();
52              _jobExtension.Setup(x => x.InitializeJob(It.IsAny<IExecutionContext>(), It.IsAny<Pipelines.AgentJobRequestMessage>())).
53                  Returns(Task.FromResult(_initResult));
54              var settings = new RunnerSettings
55              {
56                  AgentId = 1,
57                  AgentName = "agent1",
58                  ServerUrl = "https:&bsol;&bsol;pipelines.actions.githubusercontent.com",
59                  WorkFolder = "_work",
60              };
61              _config.Setup(x => x.GetSettings())
62                  .Returns(settings);
63              _logger.Setup(x => x.Setup(It.IsAny<Guid>(), It.IsAny<Guid>()));
64              hc.SetSingleton(_config.Object);
65              hc.SetSingleton(_jobServer.Object);
66              hc.SetSingleton(_runServer.Object);
67              hc.SetSingleton(_jobServerQueue.Object);
68              hc.SetSingleton(_stepRunner.Object);
69              hc.SetSingleton(_extensions.Object);
70              hc.SetSingleton(_temp.Object);
71              hc.SetSingleton(_diagnosticLogManager.Object);
72              hc.EnqueueInstance<IExecutionContext>(_jobEc);
73              hc.EnqueueInstance<IPagingLogger>(_logger.Object);
74              hc.EnqueueInstance<IJobExtension>(_jobExtension.Object);
75              return hc;
76          }
77          private Pipelines.AgentJobRequestMessage GetMessage(String messageType = JobRequestMessageTypes.PipelineAgentJobRequest, [CallerMemberName] String testName = "")
78          {
79              TaskOrchestrationPlanReference plan = new();
80              TimelineReference timeline = new Timeline(Guid.NewGuid());
81              Guid jobId = Guid.NewGuid();
82              var message = new Pipelines.AgentJobRequestMessage(
83                  plan,
84                  timeline,
85                  jobId,
86                  testName,
87                  testName, null, null, null, new Dictionary<string, VariableValue>(), new List<MaskHint>(), new Pipelines.JobResources(), new Pipelines.ContextData.DictionaryContextData(), new Pipelines.WorkspaceOptions(), new List<Pipelines.ActionStep>(), null, null, null, null,
88                  messageType: messageType);
89              message.Variables[Constants.Variables.System.Culture] = "en-US";
90              message.Resources.Endpoints.Add(new ServiceEndpoint()
91              {
92                  Name = WellKnownServiceEndpointNames.SystemVssConnection,
93                  Url = new Uri("https:&bsol;&bsol;pipelines.actions.githubusercontent.com"),
94                  Authorization = new EndpointAuthorization()
95                  {
96                      Scheme = "Test",
97                      Parameters = {
98                          {"AccessToken", "token"}
99                      }
100                  },
101              });
102              message.Resources.Repositories.Add(new Pipelines.RepositoryResource()
103              {
104                  Alias = Pipelines.PipelineConstants.SelfAlias,
105                  Id = "github",
106                  Version = "sha1"
107              });
108              message.ContextData.Add("github", new Pipelines.ContextData.DictionaryContextData());
109              return message;
110          }
111          [Fact]
112          [Trait("Level", "L0")]
113          [Trait("Category", "Worker")]
114          public async Task JobExtensionInitializeFailure()
115          {
116              using (TestHostContext hc = CreateTestContext())
117              {
118                  _jobExtension.Setup(x => x.InitializeJob(It.IsAny<IExecutionContext>(), It.IsAny<Pipelines.AgentJobRequestMessage>()))
119                      .Throws(new Exception());
120                  await _jobRunner.RunAsync(GetMessage(), _tokenSource.Token);
121                  Assert.Equal(TaskResult.Failed, _jobEc.Result);
122                  _stepRunner.Verify(x => x.RunAsync(It.IsAny<IExecutionContext>()), Times.Never);
123              }
124          }
125          [Fact]
126          [Trait("Level", "L0")]
127          [Trait("Category", "Worker")]
128          public async Task JobExtensionInitializeCancelled()
129          {
130              using (TestHostContext hc = CreateTestContext())
131              {
132                  _jobExtension.Setup(x => x.InitializeJob(It.IsAny<IExecutionContext>(), It.IsAny<Pipelines.AgentJobRequestMessage>()))
133                      .Throws(new OperationCanceledException());
134                  _tokenSource.Cancel();
135                  await _jobRunner.RunAsync(GetMessage(), _tokenSource.Token);
136                  Assert.Equal(TaskResult.Canceled, _jobEc.Result);
137                  _stepRunner.Verify(x => x.RunAsync(It.IsAny<IExecutionContext>()), Times.Never);
138              }
139          }
140          [Fact]
141          [Trait("Level", "L0")]
142          [Trait("Category", "Worker")]
</span>143          public async Task WorksWithRunnerJobRequestMessageType()
144          {
145              using (TestHostContext hc = CreateTestContext())
146              {
147                  var message = GetMessage(JobRequestMessageTypes.RunnerJobRequest);
148                  await _jobRunner.RunAsync(message, _tokenSource.Token);
149                  Assert.Equal(TaskResult.Succeeded, _jobEc.Result);
150              }
151          }
152      }
153  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-TypeIdentifierTests.cs</h3>
            <pre><code>1  using System;
2  using System.Numerics;
3  using FluentAssertions;
4  using NUnit.Framework;
5  namespace MudBlazor.UnitTests.Other
6  {
7      [TestFixture]
8      public class TypeIdentifierTests
9      {
10          [Test]
11          [TestCase(null, false)]
12          [TestCase(typeof(int), false)]
13          [TestCase(typeof(int?), false)]
14          [TestCase(typeof(string), true)]
15          public void IsString_Test(Type type, bool expected)
16          {
17              var isString = TypeIdentifier.IsString(type);
18              isString.Should().Be(expected);
19          }
<span onclick='openModal()' class='match'>20          [Test]
21          [TestCase(null, false)]
22          [TestCase(typeof(DateTime), false)]
23          [TestCase(typeof(DateTime?), false)]
24          [TestCase(typeof(int), true)]
25          [TestCase(typeof(double), true)]
26          [TestCase(typeof(decimal), true)]
27          [TestCase(typeof(long), true)]
28          [TestCase(typeof(short), true)]
29          [TestCase(typeof(sbyte), true)]
30          [TestCase(typeof(byte), true)]
31          [TestCase(typeof(ulong), true)]
</span>32          [TestCase(typeof(ushort), true)]
33          [TestCase(typeof(uint), true)]
34          [TestCase(typeof(float), true)]
35          [TestCase(typeof(BigInteger), true)]
36          [TestCase(typeof(int?), true)]
37          [TestCase(typeof(double?), true)]
38          [TestCase(typeof(decimal?), true)]
39          [TestCase(typeof(long?), true)]
40          [TestCase(typeof(short?), true)]
41          [TestCase(typeof(sbyte?), true)]
42          [TestCase(typeof(byte?), true)]
43          [TestCase(typeof(ulong?), true)]
44          [TestCase(typeof(ushort?), true)]
45          [TestCase(typeof(uint?), true)]
46          [TestCase(typeof(float?), true)]
47          [TestCase(typeof(BigInteger?), true)]
48          public void IsNumber_Test(Type type, bool expected)
49          {
50              var isNumber = TypeIdentifier.IsNumber(type);
51              isNumber.Should().Be(expected);
52          }
53          [Test]
54          [TestCase(null, false)]
55          [TestCase(typeof(int), false)]
56          [TestCase(typeof(int?), false)]
57          [TestCase(typeof(Adornment), true)]
58          [TestCase(typeof(Adornment?), true)]
59          public void IsEnum_Test(Type type, bool expected)
60          {
61              var isEnum = TypeIdentifier.IsEnum(type);
62              isEnum.Should().Be(expected);
63          }
64          [Test]
65          [TestCase(null, false)]
66          [TestCase(typeof(int), false)]
67          [TestCase(typeof(int?), false)]
68          [TestCase(typeof(DateTime), true)]
69          [TestCase(typeof(DateTime?), true)]
70          public void IsDateTime_Test(Type type, bool expected)
71          {
72              var isDateTime = TypeIdentifier.IsDateTime(type);
73              isDateTime.Should().Be(expected);
74          }
75          [Test]
76          [TestCase(null, false)]
77          [TestCase(typeof(int), false)]
78          [TestCase(typeof(int?), false)]
79          [TestCase(typeof(bool), true)]
80          [TestCase(typeof(bool?), true)]
81          public void IsBoolean_Test(Type type, bool expected)
82          {
83              var isBoolean = TypeIdentifier.IsBoolean(type);
84              isBoolean.Should().Be(expected);
85          }
86          [Test]
87          [TestCase(null, false)]
88          [TestCase(typeof(int), false)]
89          [TestCase(typeof(int?), false)]
90          [TestCase(typeof(Guid), true)]
91          [TestCase(typeof(Guid?), true)]
92          public void IsGuid_Test(Type type, bool expected)
93          {
94              var isGuid = TypeIdentifier.IsGuid(type);
95              isGuid.Should().Be(expected);
96          }
97      }
98  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from runner-MDEwOlJlcG9zaXRvcnkxODQyODY4NzU=-flat-JobRunnerL0.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-TypeIdentifierTests.cs</div>
                </div>
                <div class="column column_space"><pre><code>29          private TestHostContext CreateTestContext([CallerMemberName] String testName = "")
30          {
31              var hc = new TestHostContext(this, testName);
32              _jobEc = new Runner.Worker.ExecutionContext();
33              _config = new Mock<IConfigurationStore>();
34              _extensions = new Mock<IExtensionManager>();
35              _jobExtension = new Mock<IJobExtension>();
36              _jobServer = new Mock<IJobServer>();
37              _runServer = new Mock<IRunServer>();
38              _jobServerQueue = new Mock<IJobServerQueue>();
39              _stepRunner = new Mock<IStepsRunner>();
40              _logger = new Mock<IPagingLogger>();
41              _temp = new Mock<ITempDirectoryManager>();
42              _diagnosticLogManager = new Mock<IDiagnosticLogManager>();
43              if (_tokenSource != null)
44              {
45                  _tokenSource.Dispose();
46                  _tokenSource = null;
47              }
48              _tokenSource = new CancellationTokenSource();
49              _jobRunner = new JobRunner();
50              _jobRunner.Initialize(hc);
51              _initResult.Clear();
52              _jobExtension.Setup(x => x.InitializeJob(It.IsAny<IExecutionContext>(), It.IsAny<Pipelines.AgentJobRequestMessage>())).
53                  Returns(Task.FromResult(_initResult));
54              var settings = new RunnerSettings
55              {
56                  AgentId = 1,
57                  AgentName = "agent1",
58                  ServerUrl = "https:&bsol;&bsol;pipelines.actions.githubusercontent.com",
59                  WorkFolder = "_work",
60              };
61              _config.Setup(x => x.GetSettings())
62                  .Returns(settings);
63              _logger.Setup(x => x.Setup(It.IsAny<Guid>(), It.IsAny<Guid>()));
64              hc.SetSingleton(_config.Object);
65              hc.SetSingleton(_jobServer.Object);
66              hc.SetSingleton(_runServer.Object);
67              hc.SetSingleton(_jobServerQueue.Object);
68              hc.SetSingleton(_stepRunner.Object);
69              hc.SetSingleton(_extensions.Object);
70              hc.SetSingleton(_temp.Object);
71              hc.SetSingleton(_diagnosticLogManager.Object);
72              hc.EnqueueInstance<IExecutionContext>(_jobEc);
73              hc.EnqueueInstance<IPagingLogger>(_logger.Object);
74              hc.EnqueueInstance<IJobExtension>(_jobExtension.Object);
75              return hc;
76          }
77          private Pipelines.AgentJobRequestMessage GetMessage(String messageType = JobRequestMessageTypes.PipelineAgentJobRequest, [CallerMemberName] String testName = "")
78          {
79              TaskOrchestrationPlanReference plan = new();
80              TimelineReference timeline = new Timeline(Guid.NewGuid());
81              Guid jobId = Guid.NewGuid();
82              var message = new Pipelines.AgentJobRequestMessage(
83                  plan,
84                  timeline,
85                  jobId,
86                  testName,
87                  testName, null, null, null, new Dictionary<string, VariableValue>(), new List<MaskHint>(), new Pipelines.JobResources(), new Pipelines.ContextData.DictionaryContextData(), new Pipelines.WorkspaceOptions(), new List<Pipelines.ActionStep>(), null, null, null, null,
88                  messageType: messageType);
89              message.Variables[Constants.Variables.System.Culture] = "en-US";
90              message.Resources.Endpoints.Add(new ServiceEndpoint()
91              {
92                  Name = WellKnownServiceEndpointNames.SystemVssConnection,
93                  Url = new Uri("https:&bsol;&bsol;pipelines.actions.githubusercontent.com"),
94                  Authorization = new EndpointAuthorization()
95                  {
96                      Scheme = "Test",
97                      Parameters = {
98                          {"AccessToken", "token"}
99                      }
100                  },
101              });
102              message.Resources.Repositories.Add(new Pipelines.RepositoryResource()
103              {
104                  Alias = Pipelines.PipelineConstants.SelfAlias,
105                  Id = "github",
106                  Version = "sha1"
107              });
108              message.ContextData.Add("github", new Pipelines.ContextData.DictionaryContextData());
109              return message;
110          }
111          [Fact]
112          [Trait("Level", "L0")]
113          [Trait("Category", "Worker")]
114          public async Task JobExtensionInitializeFailure()
115          {
116              using (TestHostContext hc = CreateTestContext())
117              {
118                  _jobExtension.Setup(x => x.InitializeJob(It.IsAny<IExecutionContext>(), It.IsAny<Pipelines.AgentJobRequestMessage>()))
119                      .Throws(new Exception());
120                  await _jobRunner.RunAsync(GetMessage(), _tokenSource.Token);
121                  Assert.Equal(TaskResult.Failed, _jobEc.Result);
122                  _stepRunner.Verify(x => x.RunAsync(It.IsAny<IExecutionContext>()), Times.Never);
123              }
124          }
125          [Fact]
126          [Trait("Level", "L0")]
127          [Trait("Category", "Worker")]
128          public async Task JobExtensionInitializeCancelled()
129          {
130              using (TestHostContext hc = CreateTestContext())
131              {
132                  _jobExtension.Setup(x => x.InitializeJob(It.IsAny<IExecutionContext>(), It.IsAny<Pipelines.AgentJobRequestMessage>()))
133                      .Throws(new OperationCanceledException());
134                  _tokenSource.Cancel();
135                  await _jobRunner.RunAsync(GetMessage(), _tokenSource.Token);
136                  Assert.Equal(TaskResult.Canceled, _jobEc.Result);
137                  _stepRunner.Verify(x => x.RunAsync(It.IsAny<IExecutionContext>()), Times.Never);
138              }
139          }
140          [Fact]
141          [Trait("Level", "L0")]
142          [Trait("Category", "Worker")]
</pre></code></div>
                <div class="column column_space"><pre><code>20          [Test]
21          [TestCase(null, false)]
22          [TestCase(typeof(DateTime), false)]
23          [TestCase(typeof(DateTime?), false)]
24          [TestCase(typeof(int), true)]
25          [TestCase(typeof(double), true)]
26          [TestCase(typeof(decimal), true)]
27          [TestCase(typeof(long), true)]
28          [TestCase(typeof(short), true)]
29          [TestCase(typeof(sbyte), true)]
30          [TestCase(typeof(byte), true)]
31          [TestCase(typeof(ulong), true)]
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    