
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 9.863013698630137%, Tokens: 10</h2>
        <div class="column">
            <h3>Security-MDEwOlJlcG9zaXRvcnkxNzcyMzY5OQ==-flat-OAuthTests.cs</h3>
            <pre><code>1  using Microsoft.AspNetCore.Authentication.Cookies;
2  using Microsoft.AspNetCore.Builder;
3  using Microsoft.AspNetCore.Hosting;
4  using Microsoft.AspNetCore.Http;
5  using Microsoft.AspNetCore.TestHost;
6  using Microsoft.Extensions.DependencyInjection;
7  using System;
8  using System.Collections.Generic;
9  using System.Net;
10  using System.Threading.Tasks;
11  using Xunit;
12  namespace Microsoft.AspNetCore.Authentication.OAuth
13  {
14      public class OAuthTests : RemoteAuthenticationTests<OAuthOptions>
15      {
16          protected override string DefaultScheme => OAuthDefaults.DisplayName;
17          protected override Type HandlerType => typeof(OAuthHandler<OAuthOptions>);
18          protected override bool SupportsSignIn { get => false; }
19          protected override bool SupportsSignOut { get => false; }
20          protected override void RegisterAuth(AuthenticationBuilder services, Action<OAuthOptions> configure)
21          {
<span onclick='openModal()' class='match'>22              services.AddOAuth(DefaultScheme, o =>
23              {
24                  ConfigureDefaults(o);
25                  configure.Invoke(o);
26              });
27          }
28          [Fact]
29          public async Task ThrowsIfClientIdMissing()
30          {
31              var server = CreateServer(
32                  services => services.AddAuthentication().AddOAuth("weeblie", o =>
</span>33                  {
34                      o.SignInScheme = "whatever";
35                      o.CallbackPath = "/";
36                      o.ClientSecret = "whatever";
37                      o.TokenEndpoint = "/";
38                      o.AuthorizationEndpoint = "/";
39                  }));
40              await Assert.ThrowsAsync<ArgumentException>("ClientId", () => server.SendAsync("http:&bsol;&bsol;example.com/"));
41          }
42          [Fact]
43          public async Task ThrowsIfClientSecretMissing()
44          {
45              var server = CreateServer(
46                  services => services.AddAuthentication().AddOAuth("weeblie", o =>
47                  {
48                      o.SignInScheme = "whatever";
49                      o.ClientId = "Whatever;";
50                      o.CallbackPath = "/";
51                      o.TokenEndpoint = "/";
52                      o.AuthorizationEndpoint = "/";
53                  }));
54              await Assert.ThrowsAsync<ArgumentException>("ClientSecret", () => server.SendAsync("http:&bsol;&bsol;example.com/"));
55          }
56          [Fact]
57          public async Task ThrowsIfCallbackPathMissing()
58          {
59              var server = CreateServer(
60                  services => services.AddAuthentication().AddOAuth("weeblie", o =>
61                  {
62                      o.ClientId = "Whatever;";
63                      o.ClientSecret = "Whatever;";
64                      o.TokenEndpoint = "/";
65                      o.AuthorizationEndpoint = "/";
66                      o.SignInScheme = "eh";
67                  }));
68              await Assert.ThrowsAsync<ArgumentException>("CallbackPath", () => server.SendAsync("http:&bsol;&bsol;example.com/"));
69          }
70          [Fact]
71          public async Task ThrowsIfTokenEndpointMissing()
72          {
73              var server = CreateServer(
74                  services => services.AddAuthentication().AddOAuth("weeblie", o =>
75                  {
76                      o.ClientId = "Whatever;";
77                      o.ClientSecret = "Whatever;";
78                      o.CallbackPath = "/";
79                      o.AuthorizationEndpoint = "/";
80                      o.SignInScheme = "eh";
81                  }));
82              await Assert.ThrowsAsync<ArgumentException>("TokenEndpoint", () => server.SendAsync("http:&bsol;&bsol;example.com/"));
83          }
84          [Fact]
85          public async Task ThrowsIfAuthorizationEndpointMissing()
86          {
87              var server = CreateServer(
88                  services => services.AddAuthentication().AddOAuth("weeblie", o =>
89                  {
90                      o.ClientId = "Whatever;";
91                      o.ClientSecret = "Whatever;";
92                      o.CallbackPath = "/";
93                      o.TokenEndpoint = "/";
94                      o.SignInScheme = "eh";
95                  }));
96              await Assert.ThrowsAsync<ArgumentException>("AuthorizationEndpoint", () => server.SendAsync("http:&bsol;&bsol;example.com/"));
97          }
98          [Fact]
99          public async Task RedirectToIdentityProvider_SetsCorrelationIdCookiePath_ToCallBackPath()
100          {
101              var server = CreateServer(
102                  s => s.AddAuthentication().AddOAuth(
103                      "Weblie",
104                      opt =>
105                      {
106                          ConfigureDefaults(opt);
107                      }),
108                  async ctx =>
109                  {
110                      await ctx.ChallengeAsync("Weblie");
111                      return true;
112                  });
113              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/challenge");
114              var res = transaction.Response;
115              Assert.Equal(HttpStatusCode.Redirect, res.StatusCode);
116              Assert.NotNull(res.Headers.Location);
117              var setCookie = Assert.Single(res.Headers, h => h.Key == "Set-Cookie");
118              var correlation = Assert.Single(setCookie.Value, v => v.StartsWith(".AspNetCore.Correlation."));
119              Assert.Contains("path=/oauth-callback", correlation);
120          }
121          [Fact]
122          public async Task RedirectToAuthorizeEndpoint_CorrelationIdCookieOptions_CanBeOverriden()
123          {
124              var server = CreateServer(
125                  s => s.AddAuthentication().AddOAuth(
126                      "Weblie",
127                      opt =>
128                      {
129                          ConfigureDefaults(opt);
130                          opt.CorrelationCookie.Path = "/";
131                      }),
132                  async ctx =>
133                  {
134                      await ctx.ChallengeAsync("Weblie");
135                      return true;
136                  });
137              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/challenge");
138              var res = transaction.Response;
139              Assert.Equal(HttpStatusCode.Redirect, res.StatusCode);
140              Assert.NotNull(res.Headers.Location);
141              var setCookie = Assert.Single(res.Headers, h => h.Key == "Set-Cookie");
142              var correlation = Assert.Single(setCookie.Value, v => v.StartsWith(".AspNetCore.Correlation."));
143              Assert.Contains("path=/", correlation);
144          }
145          [Fact]
146          public async Task RedirectToAuthorizeEndpoint_HasScopeAsConfigured()
147          {
148              var server = CreateServer(
149                  s => s.AddAuthentication().AddOAuth(
150                      "Weblie",
151                      opt =>
152                      {
153                          ConfigureDefaults(opt);
154                          opt.Scope.Clear();
155                          opt.Scope.Add("foo");
156                          opt.Scope.Add("bar");
157                      }),
158                  async ctx =>
159                  {
160                      await ctx.ChallengeAsync("Weblie");
161                      return true;
162                  });
163              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/challenge");
164              var res = transaction.Response;
165              Assert.Equal(HttpStatusCode.Redirect, res.StatusCode);
166              Assert.Contains("scope=foo%20bar", res.Headers.Location.Query);
167          }
168          [Fact]
169          public async Task RedirectToAuthorizeEndpoint_HasScopeAsOverwritten()
170          {
171              var server = CreateServer(
172                  s => s.AddAuthentication().AddOAuth(
173                      "Weblie",
174                      opt =>
175                      {
176                          ConfigureDefaults(opt);
177                          opt.Scope.Clear();
178                          opt.Scope.Add("foo");
179                          opt.Scope.Add("bar");
180                      }),
181                  async ctx =>
182                  {
183                      var properties = new OAuthChallengeProperties();
184                      properties.SetScope("baz", "qux");
185                      await ctx.ChallengeAsync("Weblie", properties);
186                      return true;
187                  });
188              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/challenge");
189              var res = transaction.Response;
190              Assert.Equal(HttpStatusCode.Redirect, res.StatusCode);
191              Assert.Contains("scope=baz%20qux", res.Headers.Location.Query);
192          }
193          [Fact]
194          public async Task RedirectToAuthorizeEndpoint_HasScopeAsOverwrittenWithBaseAuthenticationProperties()
195          {
196              var server = CreateServer(
197                  s => s.AddAuthentication().AddOAuth(
198                      "Weblie",
199                      opt =>
200                      {
201                          ConfigureDefaults(opt);
202                          opt.Scope.Clear();
203                          opt.Scope.Add("foo");
204                          opt.Scope.Add("bar");
205                      }),
206                  async ctx =>
207                  {
208                      var properties = new AuthenticationProperties();
209                      properties.SetParameter(OAuthChallengeProperties.ScopeKey, new string[] { "baz", "qux" });
210                      await ctx.ChallengeAsync("Weblie", properties);
211                      return true;
212                  });
213              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/challenge");
214              var res = transaction.Response;
215              Assert.Equal(HttpStatusCode.Redirect, res.StatusCode);
216              Assert.Contains("scope=baz%20qux", res.Headers.Location.Query);
217          }
218          protected override void ConfigureDefaults(OAuthOptions o)
219          {
220              o.ClientId = "Test Id";
221              o.ClientSecret = "secret";
222              o.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;
223              o.AuthorizationEndpoint = "https:&bsol;&bsol;example.com/provider/login";
224              o.TokenEndpoint = "https:&bsol;&bsol;example.com/provider/token";
225              o.CallbackPath = "/oauth-callback";
226          }
227          [Fact]
228          public async Task HandleRequestAsync_RedirectsToAccessDeniedPathWhenExplicitlySet()
229          {
230              var server = CreateServer(
231                  s => s.AddAuthentication().AddOAuth(
232                      "Weblie",
233                      opt =>
234                      {
235                          opt.ClientId = "Test Id";
236                          opt.ClientSecret = "secret";
237                          opt.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;
238                          opt.AuthorizationEndpoint = "https:&bsol;&bsol;example.com/provider/login";
239                          opt.TokenEndpoint = "https:&bsol;&bsol;example.com/provider/token";
240                          opt.CallbackPath = "/oauth-callback";
241                          opt.AccessDeniedPath = "/access-denied";
242                          opt.StateDataFormat = new TestStateDataFormat();
243                          opt.Events.OnRemoteFailure = context => throw new InvalidOperationException("This event should not be called.");
244                      }));
245              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/oauth-callback?error=access_denied&state=protected_state",
246                  ".AspNetCore.Correlation.Weblie.correlationId=N");
247              Assert.Equal(HttpStatusCode.Redirect, transaction.Response.StatusCode);
248              Assert.Equal("/access-denied?ReturnUrl=http%3A%2F%2Ftesthost%2Fredirect", transaction.Response.Headers.Location.ToString());
249          }
250          [Fact]
251          public async Task HandleRequestAsync_InvokesAccessDeniedEvent()
252          {
253              var server = CreateServer(
254                  s => s.AddAuthentication().AddOAuth(
255                      "Weblie",
256                      opt =>
257                      {
258                          opt.ClientId = "Test Id";
259                          opt.ClientSecret = "secret";
260                          opt.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;
261                          opt.AuthorizationEndpoint = "https:&bsol;&bsol;example.com/provider/login";
262                          opt.TokenEndpoint = "https:&bsol;&bsol;example.com/provider/token";
263                          opt.CallbackPath = "/oauth-callback";
264                          opt.StateDataFormat = new TestStateDataFormat();
265                          opt.Events = new OAuthEvents()
266                          {
267                              OnAccessDenied = context =>
268                              {
269                                  Assert.Equal("testvalue", context.Properties.Items["testkey"]);
270                                  context.Response.StatusCode = StatusCodes.Status406NotAcceptable;
271                                  context.HandleResponse();
272                                  return Task.CompletedTask;
273                              }
274                          };
275                      }));
276              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/oauth-callback?error=access_denied&state=protected_state",
277                  ".AspNetCore.Correlation.Weblie.correlationId=N");
278              Assert.Equal(HttpStatusCode.NotAcceptable, transaction.Response.StatusCode);
279              Assert.Null(transaction.Response.Headers.Location);
280          }
281          [Fact]
282          public async Task HandleRequestAsync_InvokesRemoteFailureEventWhenAccessDeniedPathIsNotExplicitlySet()
283          {
284              var server = CreateServer(
285                  s => s.AddAuthentication().AddOAuth(
286                      "Weblie",
287                      opt =>
288                      {
289                          opt.ClientId = "Test Id";
290                          opt.ClientSecret = "secret";
291                          opt.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;
292                          opt.AuthorizationEndpoint = "https:&bsol;&bsol;example.com/provider/login";
293                          opt.TokenEndpoint = "https:&bsol;&bsol;example.com/provider/token";
294                          opt.CallbackPath = "/oauth-callback";
295                          opt.StateDataFormat = new TestStateDataFormat();
296                          opt.Events = new OAuthEvents()
297                          {
298                              OnRemoteFailure = context =>
299                              {
300                                  Assert.Equal("Access was denied by the resource owner or by the remote server.", context.Failure.Message);
301                                  Assert.Equal("testvalue", context.Properties.Items["testkey"]);
302                                  context.Response.StatusCode = StatusCodes.Status406NotAcceptable;
303                                  context.HandleResponse();
304                                  return Task.CompletedTask;
305                              }
306                          };
307                      }));
308              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/oauth-callback?error=access_denied&state=protected_state",
309                  ".AspNetCore.Correlation.Weblie.correlationId=N");
310              Assert.Equal(HttpStatusCode.NotAcceptable, transaction.Response.StatusCode);
311              Assert.Null(transaction.Response.Headers.Location);
312          }
313          [Fact]
314          public async Task RemoteAuthenticationFailed_OAuthError_IncludesProperties()
315          {
316              var server = CreateServer(
317                  s => s.AddAuthentication().AddOAuth(
318                      "Weblie",
319                      opt =>
320                      {
321                          opt.ClientId = "Test Id";
322                          opt.ClientSecret = "secret";
323                          opt.SignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;
324                          opt.AuthorizationEndpoint = "https:&bsol;&bsol;example.com/provider/login";
325                          opt.TokenEndpoint = "https:&bsol;&bsol;example.com/provider/token";
326                          opt.CallbackPath = "/oauth-callback";
327                          opt.StateDataFormat = new TestStateDataFormat();
328                          opt.Events = new OAuthEvents()
329                          {
330                              OnRemoteFailure = context =>
331                              {
332                                  Assert.Contains("custom_error", context.Failure.Message);
333                                  Assert.Equal("testvalue", context.Properties.Items["testkey"]);
334                                  context.Response.StatusCode = StatusCodes.Status406NotAcceptable;
335                                  context.HandleResponse();
336                                  return Task.CompletedTask;
337                              }
338                          };
339                      }));
340              var transaction = await server.SendAsync("https:&bsol;&bsol;www.example.com/oauth-callback?error=custom_error&state=protected_state",
341                  ".AspNetCore.Correlation.Weblie.correlationId=N");
342              Assert.Equal(HttpStatusCode.NotAcceptable, transaction.Response.StatusCode);
343              Assert.Null(transaction.Response.Headers.Location);
344          }
345          private static TestServer CreateServer(Action<IServiceCollection> configureServices, Func<HttpContext, Task<bool>> handler = null)
346          {
347              var builder = new WebHostBuilder()
348                  .Configure(app =>
349                  {
350                      app.UseAuthentication();
351                      app.Use(async (context, next) =>
352                      {
353                          if (handler == null || ! await handler(context))
354                          {
355                              await next();
356                          }
357                      });
358                  })
359                  .ConfigureServices(configureServices);
360              return new TestServer(builder);
361          }
362          private class TestStateDataFormat : ISecureDataFormat<AuthenticationProperties>
363          {
364              private AuthenticationProperties Data { get; set; }
365              public string Protect(AuthenticationProperties data)
366              {
367                  return "protected_state";
368              }
369              public string Protect(AuthenticationProperties data, string purpose)
370              {
371                  throw new NotImplementedException();
372              }
373              public AuthenticationProperties Unprotect(string protectedText)
374              {
375                  Assert.Equal("protected_state", protectedText);
376                  var properties = new AuthenticationProperties(new Dictionary<string, string>()
377                  {
378                      { ".xsrf", "correlationId" },
379                      { "testkey", "testvalue" }
380                  });
381                  properties.RedirectUri = "http:&bsol;&bsol;testhost/redirect";
382                  return properties;
383              }
384              public AuthenticationProperties Unprotect(string protectedText, string purpose)
385              {
386                  throw new NotImplementedException();
387              }
388          }
389      }
390  }
</code></pre>
        </div>
        <div class="column">
            <h3>MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-CarouselTests.cs</h3>
            <pre><code>1  #pragma warning disable BL0005 
2  using System;
3  using System.Collections.Generic;
4  using System.Linq;
5  using System.Threading.Tasks;
6  using Bunit;
7  using FluentAssertions;
8  using Microsoft.AspNetCore.Components.Web;
9  using MudBlazor.UnitTests.TestComponents;
10  using NUnit.Framework;
11  namespace MudBlazor.UnitTests.Components
12  {
13      [TestFixture]
14      public class CarouselTests : BunitTest
15      {
16          [Test]
17          public async Task CarouselTest1()
18          {
19              var comp = Context.RenderComponent<CarouselTest>();
20              var carousel = comp.FindComponent<MudCarousel<object>>().Instance;
21              carousel.Should().NotBeNull();
22              comp.WaitForAssertion(() => comp.FindAll("div.mud-carousel-item").Count.Should().Be(1));
23              comp.FindAll("div.fake-class-item1").Count.Should().Be(1);
24              comp.FindAll("div.fake-class-item2").Count.Should().Be(0);
25              comp.FindAll("div.fake-class-item3").Count.Should().Be(0);
26              comp.FindAll("button.mud-icon-button").Count.Should().Be(5); 
27              carousel.LastContainer.Should().BeNull();
28              carousel.SelectedIndex.Should().Be(0);
29              carousel.SelectedContainer.Should().Be(carousel.Items[0]);
30              var last = carousel.SelectedContainer;
31              await comp.InvokeAsync(() => carousel.Next());
32              carousel.SelectedIndex.Should().Be(1);
33              carousel.SelectedContainer.Should().Be(carousel.Items[1]);
34              carousel.SelectedItem.Should().Be(carousel.Items[1]);
35              carousel.LastContainer.Should().Be(last);
36              comp.FindAll("div.fake-class-item1").Count.Should().Be(1); 
37              comp.FindAll("div.fake-class-item2").Count.Should().Be(1);
38              comp.FindAll("div.fake-class-item3").Count.Should().Be(0);
39              last = carousel.SelectedContainer;
40              await comp.InvokeAsync(() => carousel.Previous());
41              carousel.SelectedIndex.Should().Be(0);
42              carousel.SelectedContainer.Should().Be(carousel.Items[0]);
43              carousel.SelectedItem.Should().Be(carousel.Items[0]);
44              carousel.LastContainer.Should().Be(last);
45              comp.FindAll("div.fake-class-item1").Count.Should().Be(1);
46              comp.FindAll("div.fake-class-item2").Count.Should().Be(1);
47              comp.FindAll("div.fake-class-item3").Count.Should().Be(0);
48              last = carousel.SelectedContainer;
49              await comp.InvokeAsync(() => carousel.MoveTo(2));
50              carousel.SelectedIndex.Should().Be(2);
51              carousel.SelectedContainer.Should().Be(carousel.Items[2]);
52              carousel.SelectedItem.Should().Be(carousel.Items[2]);
53              carousel.LastContainer.Should().Be(last);
54              comp.FindAll("div.fake-class-item1").Count.Should().Be(1);
55              comp.FindAll("div.fake-class-item2").Count.Should().Be(0);
56              comp.FindAll("div.fake-class-item3").Count.Should().Be(1);
57              last = carousel.SelectedContainer;
58              await comp.InvokeAsync(() => carousel.Next());
59              carousel.SelectedIndex.Should().Be(0);
60              carousel.SelectedContainer.Should().Be(carousel.Items[0]);
61              carousel.SelectedItem.Should().Be(carousel.Items[0]);
62              carousel.LastContainer.Should().Be(last);
63              comp.FindAll("div.fake-class-item1").Count.Should().Be(1);
64              comp.FindAll("div.fake-class-item2").Count.Should().Be(0);
65              comp.FindAll("div.fake-class-item3").Count.Should().Be(1);
66              last = carousel.SelectedContainer;
67              await comp.InvokeAsync(() => carousel.Previous());
68              carousel.SelectedIndex.Should().Be(2);
69              carousel.SelectedContainer.Should().Be(carousel.Items[2]);
70              carousel.SelectedItem.Should().Be(carousel.Items[2]);
71              carousel.LastContainer.Should().Be(last);
72              comp.FindAll("div.fake-class-item1").Count.Should().Be(1);
73              comp.FindAll("div.fake-class-item2").Count.Should().Be(0);
74              comp.FindAll("div.fake-class-item3").Count.Should().Be(1);
75              await comp.InvokeAsync(() => carousel.MoveTo(1)); 
76              carousel.SelectedIndex.Should().Be(1);
77              carousel.SelectedContainer.Should().Be(carousel.Items[1]);
78              carousel.SelectedItem.Should().Be(carousel.Items[1]);
79              await comp.InvokeAsync(() => carousel.Next()); 
80              carousel.SelectedIndex.Should().Be(2);
81              carousel.SelectedContainer.Should().Be(carousel.Items[2]);
82              carousel.SelectedItem.Should().Be(carousel.Items[2]);
83              comp.FindAll("div.fake-class-item1").Count.Should().Be(0);
84              comp.FindAll("div.fake-class-item2").Count.Should().Be(1);
85              comp.FindAll("div.fake-class-item3").Count.Should().Be(1);
86              last = carousel.SelectedContainer;
87              await comp.InvokeAsync(() => carousel.SelectedIndex = 0);
88              carousel.SelectedIndex.Should().Be(0);
89              carousel.SelectedContainer.Should().Be(carousel.Items[0]);
90              carousel.SelectedItem.Should().Be(carousel.Items[0]);
91              carousel.LastContainer.Should().Be(last);
92              comp.FindAll("div.fake-class-item1").Count.Should().Be(1);
93              comp.FindAll("div.fake-class-item2").Count.Should().Be(0);
94              comp.FindAll("div.fake-class-item3").Count.Should().Be(1);
95              last = carousel.SelectedContainer;
96              var swipe = comp.Find("div.mud-carousel-swipe");
97              TouchPoint[] _startPoints = { new() { ClientY = 0, ClientX = 150 } };
98              swipe.TouchStart(0, _startPoints);
99              TouchPoint[] _endPoints = { new() { ClientY = 0, ClientX = 20 } };
100              swipe.TouchEnd(0, null, null, _endPoints);
101              carousel.SelectedIndex.Should().Be(1);
102              carousel.SelectedContainer.Should().Be(carousel.Items[1]);
103              carousel.SelectedItem.Should().Be(carousel.Items[1]);
104              carousel.LastContainer.Should().Be(last);
105              comp.FindAll("div.fake-class-item1").Count.Should().Be(1);
106              comp.FindAll("div.fake-class-item2").Count.Should().Be(1);
107              comp.FindAll("div.fake-class-item3").Count.Should().Be(0);
108              last = carousel.SelectedContainer;
109              _startPoints[0].ClientX = 20;
110              swipe.TouchStart(0, _startPoints);
111              _endPoints[0].ClientX = 150;
112              swipe.TouchEnd(0, null, null, _endPoints);
113              carousel.SelectedIndex.Should().Be(0);
114              carousel.SelectedContainer.Should().Be(carousel.Items[0]);
115              carousel.SelectedItem.Should().Be(carousel.Items[0]);
116              carousel.LastContainer.Should().Be(last);
117              comp.FindAll("div.fake-class-item1").Count.Should().Be(1);
118              comp.FindAll("div.fake-class-item2").Count.Should().Be(1);
119              comp.FindAll("div.fake-class-item3").Count.Should().Be(0);
120          }
121          [Test]
122          public void CarouselTest_RenderingOptions()
123          {
124              var comp = Context.RenderComponent<MudCarousel<object>>();
125              comp.FindAll("button.mud-icon-button").Count.Should().Be(2); 
126              comp.Instance.Items.Add(new());
127              comp.Instance.Items.Add(new());
128              comp.Instance.Items.Add(new());
129              comp.Render();
130              comp.FindAll("button.mud-icon-button").Count.Should().Be(5); 
131              comp.SetParam(p => p.ShowArrows, false);
132              comp.FindAll("button.mud-icon-button").Count.Should().Be(3);
133              comp.SetParam(p => p.ShowBullets, false);
134              comp.FindAll("button.mud-icon-button").Count.Should().Be(0);
135              comp.SetParam(p => p.ShowArrows, true);
136              comp.FindAll("button.mud-icon-button").Count.Should().Be(2);
137              comp.SetParam(p => p.ShowBullets, true);
138              comp.FindAll("button.mud-icon-button").Count.Should().Be(5);
139              comp.SetParam(p => p.BulletsClass, "fake-delimiter-class");
140              comp.SetParam(p => p.NavigationButtonsClass, "fake-navigation-class");
141              comp.FindAll("button.fake-delimiter-class").Count.Should().Be(3);
142              comp.FindAll("button.fake-navigation-class").Count.Should().Be(2);
143              comp.SetParam(p => p.BulletsClass, null);
144              comp.SetParam(p => p.NavigationButtonsClass, null);
145              comp.FindAll("button.fake-delimiter-class").Count.Should().Be(0);
146              comp.FindAll("button.fake-navigation-class").Count.Should().Be(0);
147          }
148          [Test]
149          public async Task CarouselTest_AutoCycle()
150          {
151              var comp = Context.RenderComponent<MudCarousel<object>>();
152              comp.Instance.Items.Add(new());
153              comp.Instance.Items.Add(new());
154              comp.Instance.Items.Add(new());
155              comp.SetParam(p => p.AutoCycle, true);
156              await comp.InvokeAsync(() => comp.Instance.MoveTo(0));
157              comp.Render();
158              for (var interval = 150; interval <= 300; interval += 150)
159              {
160                  comp.SetParam(p => p.AutoCycleTime, TimeSpan.FromMilliseconds(interval));
161                  await Task.Delay(interval);
162                  comp.WaitForAssertion(() => comp.Instance.SelectedIndex.Should().Be(1), TimeSpan.FromMilliseconds(3000));
163                  comp.Instance.SelectedContainer.Should().Be(comp.Instance.Items[1]);
164                  await Task.Delay(interval);
165                  comp.WaitForAssertion(() => comp.Instance.SelectedIndex.Should().Be(2), TimeSpan.FromMilliseconds(3000));
166                  comp.Instance.SelectedContainer.Should().Be(comp.Instance.Items[2]);
167                  await Task.Delay(interval);
168                  comp.WaitForAssertion(() => comp.Instance.SelectedIndex.Should().Be(0), TimeSpan.FromMilliseconds(3000));
169                  comp.Instance.SelectedContainer.Should().Be(comp.Instance.Items[0]);
170              }
171          }
172          [Test]
173          public void CarouselTest_SelectedIndexTransition()
174          {
175              var comp = Context.RenderComponent<CarouselTest>();
176              comp.Instance.SelectedIndex = 0;
177              comp.Render();
178              comp.Find(".mud-carousel-transition-slide-next-enter.fake-class-item1");
179              comp.FindAll(".mud-carousel-item").Should().HaveCount(1);
180              comp.Instance.SelectedIndex = 2;
181              comp.Render();
182              comp.Find(".mud-carousel-transition-slide-next-exit.fake-class-item1");
183              comp.Find(".mud-carousel-transition-slide-next-enter.fake-class-item3");
184              comp.Instance.SelectedIndex = 0;
<span onclick='openModal()' class='match'>185              comp.Render();
186              comp.Find(".mud-carousel-transition-slide-prev-exit.fake-class-item3");
187              comp.Find(".mud-carousel-transition-slide-prev-enter.fake-class-item1");
188          }
189          [Test]
190          public async Task CarouselTest_DisableSwipeGesture()
191          {
192              var comp = Context.RenderComponent<MudCarousel<object>>();
193              comp.Instance.Items.Add(new());
194              comp.Instance.Items.Add(new());
195              comp.Instance.Items.Add(new());
196              await comp.InvokeAsync(() => comp.Instance.MoveTo(0));
</span>197              var mudSwipeArea = comp.FindComponent<MudSwipeArea>().Instance;
198              comp.Instance.EnableSwipeGesture = false;
199              await comp.InvokeAsync(() => mudSwipeArea.OnSwipe(SwipeDirection.RightToLeft));
200              comp.Instance.SelectedIndex.Should().Be(0);
201              comp.Instance.EnableSwipeGesture = true;
202              await comp.InvokeAsync(() => mudSwipeArea.OnSwipe(SwipeDirection.RightToLeft));
203              comp.Instance.SelectedIndex.Should().Be(1);
204          }
205          [Test]
206          public void CarouselTest_DataBinding()
207          {
208              var comp = Context.RenderComponent<CarouselBindingTest>();
209              var carousel = comp.FindComponent<MudCarousel<string>>().Instance;
210              carousel.Should().NotBeNull();
211              carousel.MoveTo(0);
212              var source = carousel.ItemsSource;
213              source.Count().Should().Be(5);
214              carousel.Items.Count.Should().Be(5);
215              carousel.SelectedIndex.Should().Be(0);
216              ((IList<string>)source).Add("Item added by hand");
217              source.Count().Should().Be(6);
218              carousel.Items.Count.Should().Be(5); 
219              comp.Render();
220              carousel.Items.Count.Should().Be(6);
221              ((IList<string>)source).RemoveAt(source.Count() - 1);
222              source.Count().Should().Be(5);
223              carousel.Items.Count.Should().Be(6); 
224              comp.Render();
225              carousel.Items.Count.Should().Be(5);
226          }
227      }
228  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Security-MDEwOlJlcG9zaXRvcnkxNzcyMzY5OQ==-flat-OAuthTests.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from MudBlazor-MDEwOlJlcG9zaXRvcnkyODg0Mjg2NzY=-flat-CarouselTests.cs</div>
                </div>
                <div class="column column_space"><pre><code>22              services.AddOAuth(DefaultScheme, o =>
23              {
24                  ConfigureDefaults(o);
25                  configure.Invoke(o);
26              });
27          }
28          [Fact]
29          public async Task ThrowsIfClientIdMissing()
30          {
31              var server = CreateServer(
32                  services => services.AddAuthentication().AddOAuth("weeblie", o =>
</pre></code></div>
                <div class="column column_space"><pre><code>185              comp.Render();
186              comp.Find(".mud-carousel-transition-slide-prev-exit.fake-class-item3");
187              comp.Find(".mud-carousel-transition-slide-prev-enter.fake-class-item1");
188          }
189          [Test]
190          public async Task CarouselTest_DisableSwipeGesture()
191          {
192              var comp = Context.RenderComponent<MudCarousel<object>>();
193              comp.Instance.Items.Add(new());
194              comp.Instance.Items.Add(new());
195              comp.Instance.Items.Add(new());
196              await comp.InvokeAsync(() => comp.Instance.MoveTo(0));
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    