
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <title>Code Files</title>
            <style>
                .column {
                    width: 47%;
                    float: left;
                    padding: 12px;
                    border: 2px solid #ffd0d0;
                }
        
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    overflow: auto;
                    background-color: rgb(0, 0, 0);
                    background-color: rgba(0, 0, 0, 0.4);
                }
    
                .modal-content {
                    height: 250%;
                    background-color: #fefefe;
                    margin: 5% auto;
                    padding: 20px;
                    border: 1px solid #888;
                    width: 80%;
                }
    
                .close {
                    color: #aaa;
                    float: right;
                    font-size: 20px;
                    font-weight: bold;
                    text-align: right;
                }
    
                .close:hover, .close:focus {
                    color: black;
                    text-decoration: none;
                    cursor: pointer;
                }
    
                .row {
                    float: right;
                    width: 100%;
                }
    
                .column_space  {
                    white - space: pre-wrap;
                }
                 
                pre {
                    width: 100%;
                    overflow-y: auto;
                    background: #f8fef2;
                }
                
                .match {
                    cursor:pointer; 
                    background-color:#00ffbb;
                }
        </style>
    </head>
    <body>
        <h2>Similarity: 39.25233644859813%, Tokens: 21</h2>
        <div class="column">
            <h3>runner-MDEwOlJlcG9zaXRvcnkxODQyODY4NzU=-flat-RunnerPluginManager.cs</h3>
            <pre><code>1  using GitHub.DistributedTask.WebApi;
2  using GitHub.Runner.Sdk;
3  using GitHub.Runner.Common.Util;
4  using GitHub.Services.WebApi;
5  using System;
6  using System.Collections.Generic;
7  using System.IO;
8  using System.Reflection;
9  using System.Runtime.Loader;
10  using System.Threading;
11  using System.Threading.Tasks;
12  using System.Text;
13  using GitHub.DistributedTask.Pipelines.ContextData;
14  using System.Threading.Channels;
15  using GitHub.Runner.Common;
16  using System.Linq;
17  namespace GitHub.Runner.Worker
18  {
19      [ServiceLocator(Default = typeof(RunnerPluginManager))]
20      public interface IRunnerPluginManager : IRunnerService
21      {
22          RunnerPluginActionInfo GetPluginAction(string plugin);
23          Task RunPluginActionAsync(IExecutionContext context, string plugin, Dictionary<string, string> inputs, Dictionary<string, string> environment, Variables runtimeVariables, EventHandler<ProcessDataReceivedEventArgs> outputHandler);
24      }
25      public sealed class RunnerPluginManager : RunnerService, IRunnerPluginManager
26      {
27          private readonly Dictionary<string, RunnerPluginActionInfo> _actionPlugins = new(StringComparer.OrdinalIgnoreCase)
28          {
29              {
30                  "checkout",
31                  new RunnerPluginActionInfo()
32                  {
33                      Description = "Get sources from a Git repository",
34                      FriendlyName = "Get sources",
35                      PluginTypeName = "GitHub.Runner.Plugins.Repository.v1_0.CheckoutTask, Runner.Plugins"
36                  }
37              },
38              {
39                  "checkoutV1_1",
40                  new RunnerPluginActionInfo()
41                  {
42                      Description = "Get sources from a Git repository",
43                      FriendlyName = "Get sources",
44                      PluginTypeName = "GitHub.Runner.Plugins.Repository.v1_1.CheckoutTask, Runner.Plugins",
45                      PostPluginTypeName = "GitHub.Runner.Plugins.Repository.v1_1.CleanupTask, Runner.Plugins"
46                  }
47              },
48              {
49                  "publish",
50                  new RunnerPluginActionInfo()
51                  {
52                      PluginTypeName = "GitHub.Runner.Plugins.Artifact.PublishArtifact, Runner.Plugins"
53                  }
54              },
55              {
56                  "download",
57                  new RunnerPluginActionInfo()
58                  {
59                      PluginTypeName = "GitHub.Runner.Plugins.Artifact.DownloadArtifact, Runner.Plugins"
60                  }
61              }
62          };
63          public RunnerPluginActionInfo GetPluginAction(string plugin)
64          {
65              if (_actionPlugins.ContainsKey(plugin))
66              {
67                  return _actionPlugins[plugin];
68              }
69              else
70              {
71                  return null;
72              }
73          }
74          public async Task RunPluginActionAsync(IExecutionContext context, string plugin, Dictionary<string, string> inputs, Dictionary<string, string> environment, Variables runtimeVariables, EventHandler<ProcessDataReceivedEventArgs> outputHandler)
75          {
76              ArgUtil.NotNullOrEmpty(plugin, nameof(plugin));
77              if (!_actionPlugins.Any(x => x.Value.PluginTypeName == plugin || x.Value.PostPluginTypeName == plugin))
78              {
79                  throw new NotSupportedException(plugin);
80              }
81              string workingDirectory = HostContext.GetDirectory(WellKnownDirectory.Work);
82              ArgUtil.Directory(workingDirectory, nameof(workingDirectory));
83              string file = Path.Combine(HostContext.GetDirectory(WellKnownDirectory.Bin), $"Runner.PluginHost{IOUtil.ExeExtension}");
84              ArgUtil.File(file, $"Runner.PluginHost{IOUtil.ExeExtension}");
85              string arguments = $"action \"{plugin}\"";
86              RunnerActionPluginExecutionContext pluginContext = new()
87              {
88                  Inputs = inputs,
89                  Endpoints = context.Global.Endpoints,
90                  Context = context.ExpressionValues
91              };
92              foreach (var variable in context.Global.Variables.AllVariables)
93              {
94                  pluginContext.Variables[variable.Name] = new VariableValue(variable.Value, variable.Secret);
95              }
96              using (var processInvoker = HostContext.CreateService<IProcessInvoker>())
97              {
98                  var redirectStandardIn = Channel.CreateUnbounded<string>(new UnboundedChannelOptions() { SingleReader = true, SingleWriter = true });
99                  redirectStandardIn.Writer.TryWrite(JsonUtility.ToString(pluginContext));
100                  processInvoker.OutputDataReceived += outputHandler;
101                  processInvoker.ErrorDataReceived += outputHandler;
102                  await processInvoker.ExecuteAsync(workingDirectory: workingDirectory,
103                                                    fileName: file,
104                                                    arguments: arguments,
105                                                    environment: environment,
106                                                    requireExitCodeZero: true,
107                                                    outputEncoding: Encoding.UTF8,
108                                                    killProcessOnCancel: false,
109                                                    redirectStandardIn: redirectStandardIn,
110                                                    cancellationToken: context.CancellationToken);
111              }
112          }
113          private Assembly ResolveAssembly(AssemblyLoadContext context, AssemblyName assembly)
114          {
115              string assemblyFilename = assembly.Name + ".dll";
116              return context.LoadFromAssemblyPath(Path.Combine(HostContext.GetDirectory(WellKnownDirectory.Bin), assemblyFilename));
117          }
118      }
119      public class RunnerPluginActionInfo
120      {
<span onclick='openModal()' class='match'>121          public string Description { get; set; }
122          public string FriendlyName { get; set; }
123          public string PluginTypeName { get; set; }
</span>124          public string PostPluginTypeName { get; set; }
125      }
126  }
</code></pre>
        </div>
        <div class="column">
            <h3>Security-MDEwOlJlcG9zaXRvcnkxNzcyMzY5OQ==-flat-TestAuthenticationService.cs</h3>
            <pre><code>1  using System;
2  using System.Linq;
3  using System.Security.Claims;
4  using System.Threading.Tasks;
5  using Microsoft.AspNetCore.Authentication;
6  using Microsoft.AspNetCore.Http;
7  namespace Microsoft.AspNetCore.Authorization.Test.TestObjects
8  {
9      public class TestAuthenticationService : IAuthenticationService
10      {
11          public bool ChallengeCalled => ChallengeCount > 0;
12          public bool ForbidCalled => ForbidCount > 0;
13          public bool AuthenticateCalled => AuthenticateCount > 0;
<span onclick='openModal()' class='match'>14          public int ChallengeCount { get; private set; }
15          public int ForbidCount { get; private set; }
16          public int AuthenticateCount { get; private set; }
</span>17          public Task<AuthenticateResult> AuthenticateAsync(HttpContext context, string scheme)
18          {
19              AuthenticateCount++;
20              var identity = context.User.Identities.SingleOrDefault(i => i.AuthenticationType == scheme);
21              if (identity != null)
22              {
23                  return Task.FromResult(AuthenticateResult.Success(new AuthenticationTicket(new ClaimsPrincipal(identity), scheme)));
24              }
25              return Task.FromResult(AuthenticateResult.Fail("Denied"));
26          }
27          public Task ChallengeAsync(HttpContext context, string scheme, AuthenticationProperties properties)
28          {
29              ChallengeCount++;
30              return Task.CompletedTask;
31          }
32          public Task ForbidAsync(HttpContext context, string scheme, AuthenticationProperties properties)
33          {
34              ForbidCount++;
35              return Task.CompletedTask;
36          }
37          public Task SignInAsync(HttpContext context, string scheme, ClaimsPrincipal principal, AuthenticationProperties properties)
38          {
39              throw new NotImplementedException();
40          }
41          public Task SignOutAsync(HttpContext context, string scheme, AuthenticationProperties properties)
42          {
43              throw new NotImplementedException();
44          }
45      }
46  }
</code></pre>
        </div>
    
        <!-- The Modal -->
        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="row close">&times;</span>
                <div class='row'>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from runner-MDEwOlJlcG9zaXRvcnkxODQyODY4NzU=-flat-RunnerPluginManager.cs</div>
                    <div class="column" style="font-weight: bold;text-decoration: underline">Fragment from Security-MDEwOlJlcG9zaXRvcnkxNzcyMzY5OQ==-flat-TestAuthenticationService.cs</div>
                </div>
                <div class="column column_space"><pre><code>121          public string Description { get; set; }
122          public string FriendlyName { get; set; }
123          public string PluginTypeName { get; set; }
</pre></code></div>
                <div class="column column_space"><pre><code>14          public int ChallengeCount { get; private set; }
15          public int ForbidCount { get; private set; }
16          public int AuthenticateCount { get; private set; }
</pre></code></div>
            </div>
        </div>
        <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        
        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");
        
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks the button, open the modal
        function openModal(){
          modal.style.display = "block";
        }
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        } }
        
        </script>
    </body>
    </html>
    